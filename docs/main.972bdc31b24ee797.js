(self.webpackChunkappDevice=self.webpackChunkappDevice||[]).push([[179],{562:(d0,Bh,Nh)=>{"use strict";function bn(e){return"function"==typeof e}function Kp(e){const t=e(r=>{Error.call(r),r.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const u0=Kp(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((r,a)=>`${a+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function ge(e,n){if(e){const t=e.indexOf(n);0<=t&&e.splice(t,1)}}class lt{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const c of t)c.remove(this);else t.remove(this);const{initialTeardown:r}=this;if(bn(r))try{r()}catch(c){n=c instanceof u0?c.errors:[c]}const{_finalizers:a}=this;if(a){this._finalizers=null;for(const c of a)try{mi(c)}catch(h){n=n??[],h instanceof u0?n=[...n,...h.errors]:n.push(h)}}if(n)throw new u0(n)}}add(n){var t;if(n&&n!==this)if(this.closed)mi(n);else{if(n instanceof lt){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(n)}}_hasParent(n){const{_parentage:t}=this;return t===n||Array.isArray(t)&&t.includes(n)}_addParent(n){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n}_removeParent(n){const{_parentage:t}=this;t===n?this._parentage=null:Array.isArray(t)&&ge(t,n)}remove(n){const{_finalizers:t}=this;t&&ge(t,n),n instanceof lt&&n._removeParent(this)}}lt.EMPTY=(()=>{const e=new lt;return e.closed=!0,e})();const Va=lt.EMPTY;function Dl(e){return e instanceof lt||e&&"closed"in e&&bn(e.remove)&&bn(e.add)&&bn(e.unsubscribe)}function mi(e){bn(e)?e():e.unsubscribe()}const Js={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ja={setTimeout(e,n,...t){const{delegate:r}=ja;return r?.setTimeout?r.setTimeout(e,n,...t):setTimeout(e,n,...t)},clearTimeout(e){const{delegate:n}=ja;return(n?.clearTimeout||clearTimeout)(e)},delegate:void 0};function mc(e){ja.setTimeout(()=>{const{onUnhandledError:n}=Js;if(!n)throw e;n(e)})}function Qc(){}const Jc=Ds("C",void 0,void 0);function Ds(e,n,t){return{kind:e,value:n,error:t}}let kl=null;function Sl(e){if(Js.useDeprecatedSynchronousErrorHandling){const n=!kl;if(n&&(kl={errorThrown:!1,error:null}),e(),n){const{errorThrown:t,error:r}=kl;if(kl=null,t)throw r}}else e()}class td extends lt{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Dl(n)&&n.add(this)):this.destination=h0}static create(n,t,r){return new Qd(n,t,r)}next(n){this.isStopped?jr(function Qp(e){return Ds("N",e,void 0)}(n),this):this._next(n)}error(n){this.isStopped?jr(function I_(e){return Ds("E",void 0,e)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?jr(Jc,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Tl=Function.prototype.bind;function ot(e,n){return Tl.call(e,n)}class Ni{constructor(n){this.partialObserver=n}next(n){const{partialObserver:t}=this;if(t.next)try{t.next(n)}catch(r){El(r)}}error(n){const{partialObserver:t}=this;if(t.error)try{t.error(n)}catch(r){El(r)}else El(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(t){El(t)}}}class Qd extends td{constructor(n,t,r){let a;if(super(),bn(n)||!n)a={next:n??void 0,error:t??void 0,complete:r??void 0};else{let c;this&&Js.useDeprecatedNextContext?(c=Object.create(n),c.unsubscribe=()=>this.unsubscribe(),a={next:n.next&&ot(n.next,c),error:n.error&&ot(n.error,c),complete:n.complete&&ot(n.complete,c)}):a=n}this.destination=new Ni(a)}}function El(e){Js.useDeprecatedSynchronousErrorHandling?function R_(e){Js.useDeprecatedSynchronousErrorHandling&&kl&&(kl.errorThrown=!0,kl.error=e)}(e):mc(e)}function jr(e,n){const{onStoppedNotification:t}=Js;t&&ja.setTimeout(()=>t(e,n))}const h0={closed:!0,next:Qc,error:function ni(e){throw e},complete:Qc},ed="function"==typeof Symbol&&Symbol.observable||"@@observable";function Al(e){return e}function id(e){return 0===e.length?Al:1===e.length?e[0]:function(t){return e.reduce((r,a)=>a(r),t)}}let en=(()=>{class e{constructor(t){t&&(this._subscribe=t)}lift(t){const r=new e;return r.source=this,r.operator=t,r}subscribe(t,r,a){const c=function Rl(e){return e&&e instanceof td||function Il(e){return e&&bn(e.next)&&bn(e.error)&&bn(e.complete)}(e)&&Dl(e)}(t)?t:new Qd(t,r,a);return Sl(()=>{const{operator:h,source:f}=this;c.add(h?h.call(c,f):f?this._subscribe(c):this._trySubscribe(c))}),c}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return new(r=he(r))((a,c)=>{const h=new Qd({next:f=>{try{t(f)}catch(b){c(b),h.unsubscribe()}},error:c,complete:a});this.subscribe(h)})}_subscribe(t){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(t)}[ed](){return this}pipe(...t){return id(t)(this)}toPromise(t){return new(t=he(t))((r,a)=>{let c;this.subscribe(h=>c=h,h=>a(h),()=>r(c))})}}return e.create=n=>new e(n),e})();function he(e){var n;return null!==(n=e??Js.Promise)&&void 0!==n?n:Promise}const tu=Kp(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let we=(()=>{class e extends en{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const r=new se(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new tu}next(t){Sl(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(t)}})}error(t){Sl(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Sl(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:r,isStopped:a,observers:c}=this;return r||a?Va:(this.currentObservers=null,c.push(t),new lt(()=>{this.currentObservers=null,ge(c,t)}))}_checkFinalizedStatuses(t){const{hasError:r,thrownError:a,isStopped:c}=this;r?t.error(a):c&&t.complete()}asObservable(){const t=new en;return t.source=this,t}}return e.create=(n,t)=>new se(n,t),e})();class se extends we{constructor(n,t){super(),this.destination=n,this.source=t}next(n){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,n)}error(n){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,n)}complete(){var n,t;null===(t=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===t||t.call(n)}_subscribe(n){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(n))&&void 0!==r?r:Va}}function is(e){return bn(e?.lift)}function pr(e){return n=>{if(is(n))return n.lift(function(t){try{return e(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function jn(e,n,t,r,a){return new P_(e,n,t,r,a)}class P_ extends td{constructor(n,t,r,a,c,h){super(n),this.onFinalize=c,this.shouldUnsubscribe=h,this._next=t?function(f){try{t(f)}catch(b){n.error(b)}}:super._next,this._error=a?function(f){try{a(f)}catch(b){n.error(b)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(f){n.error(f)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function Ti(e,n){return pr((t,r)=>{let a=0;t.subscribe(jn(r,c=>{r.next(e.call(n,c,a++))}))})}function En(e){return this instanceof En?(this.v=e,this):new En(e)}function Ho(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function We(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(c){t[c]=e[c]&&function(h){return new Promise(function(f,b){!function a(c,h,f,b){Promise.resolve(b).then(function(x){c({value:x,done:f})},h)}(f,b,(h=e[c](h)).done,h.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const jt=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function qt(e){return bn(e?.then)}function Qt(e){return bn(e[ed])}function $t(e){return Symbol.asyncIterator&&bn(e?.[Symbol.asyncIterator])}function ce(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ai=function Zt(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function un(e){return bn(e?.[ai])}function Ae(e){return function An(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,r=t.apply(e,n||[]),c=[];return a={},h("next"),h("throw"),h("return"),a[Symbol.asyncIterator]=function(){return this},a;function h(I){r[I]&&(a[I]=function(L){return new Promise(function(N,V){c.push([I,L,N,V])>1||f(I,L)})})}function f(I,L){try{!function b(I){I.value instanceof En?Promise.resolve(I.value.v).then(x,M):T(c[0][2],I)}(r[I](L))}catch(N){T(c[0][3],N)}}function x(I){f("next",I)}function M(I){f("throw",I)}function T(I,L){I(L),c.shift(),c.length&&f(c[0][0],c[0][1])}}(this,arguments,function*(){const t=e.getReader();try{for(;;){const{value:r,done:a}=yield En(t.read());if(a)return yield En(void 0);yield yield En(r)}}finally{t.releaseLock()}})}function nn(e){return bn(e?.getReader)}function qi(e){if(e instanceof en)return e;if(null!=e){if(Qt(e))return function lr(e){return new en(n=>{const t=e[ed]();if(bn(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(jt(e))return function Tr(e){return new en(n=>{for(let t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}(e);if(qt(e))return function Lo(e){return new en(n=>{e.then(t=>{n.closed||(n.next(t),n.complete())},t=>n.error(t)).then(null,mc)})}(e);if($t(e))return Ur(e);if(un(e))return function va(e){return new en(n=>{for(const t of e)if(n.next(t),n.closed)return;n.complete()})}(e);if(nn(e))return function rs(e){return Ur(Ae(e))}(e)}throw ce(e)}function Ur(e){return new en(n=>{(function Bo(e,n){var t,r,a,c;return function ye(e,n,t,r){return new(t||(t=Promise))(function(c,h){function f(M){try{x(r.next(M))}catch(T){h(T)}}function b(M){try{x(r.throw(M))}catch(T){h(T)}}function x(M){M.done?c(M.value):function a(c){return c instanceof t?c:new t(function(h){h(c)})}(M.value).then(f,b)}x((r=r.apply(e,n||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Ho(e);!(r=yield t.next()).done;)if(n.next(r.value),n.closed)return}catch(h){a={error:h}}finally{try{r&&!r.done&&(c=t.return)&&(yield c.call(t))}finally{if(a)throw a.error}}n.complete()})})(e,n).catch(t=>n.error(t))})}function Ss(e,n,t,r=0,a=!1){const c=n.schedule(function(){t(),a?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(c),!a)return c}function xr(e,n,t=1/0){return bn(n)?xr((r,a)=>Ti((c,h)=>n(r,c,a,h))(qi(e(r,a))),t):("number"==typeof n&&(t=n),pr((r,a)=>function od(e,n,t,r,a,c,h,f){const b=[];let x=0,M=0,T=!1;const I=()=>{T&&!b.length&&!x&&n.complete()},L=V=>x<r?N(V):b.push(V),N=V=>{c&&n.next(V),x++;let $=!1;qi(t(V,M++)).subscribe(jn(n,nt=>{a?.(nt),c?L(nt):n.next(nt)},()=>{$=!0},void 0,()=>{if($)try{for(x--;b.length&&x<r;){const nt=b.shift();h?Ss(n,h,()=>N(nt)):N(nt)}I()}catch(nt){n.error(nt)}}))};return e.subscribe(jn(n,L,()=>{T=!0,I()})),()=>{f?.()}}(r,a,e,t)))}function sd(e=1/0){return xr(Al,e)}const xa=new en(e=>e.complete());function iD(e){return e&&bn(e.schedule)}function O_(e){return e[e.length-1]}function nD(e){return bn(O_(e))?e.pop():void 0}function ad(e){return iD(O_(e))?e.pop():void 0}function Jp(e,n=0){return pr((t,r)=>{t.subscribe(jn(r,a=>Ss(r,e,()=>r.next(a),n),()=>Ss(r,e,()=>r.complete(),n),a=>Ss(r,e,()=>r.error(a),n)))})}function m0(e,n=0){return pr((t,r)=>{r.add(e.schedule(()=>t.subscribe(r),n))})}function F_(e,n){if(!e)throw new Error("Iterable cannot be null");return new en(t=>{Ss(t,n,()=>{const r=e[Symbol.asyncIterator]();Ss(t,n,()=>{r.next().then(a=>{a.done?t.complete():t.next(a.value)})},0,!0)})})}function Er(e,n){return n?function f0(e,n){if(null!=e){if(Qt(e))return function gR(e,n){return qi(e).pipe(m0(n),Jp(n))}(e,n);if(jt(e))return function oD(e,n){return new en(t=>{let r=0;return n.schedule(function(){r===e.length?t.complete():(t.next(e[r++]),t.closed||this.schedule())})})}(e,n);if(qt(e))return function _R(e,n){return qi(e).pipe(m0(n),Jp(n))}(e,n);if($t(e))return F_(e,n);if(un(e))return function sD(e,n){return new en(t=>{let r;return Ss(t,n,()=>{r=e[ai](),Ss(t,n,()=>{let a,c;try{({value:a,done:c}=r.next())}catch(h){return void t.error(h)}c?t.complete():t.next(a)},0,!0)}),()=>bn(r?.return)&&r.return()})}(e,n);if(nn(e))return function p0(e,n){return F_(Ae(e),n)}(e,n)}throw ce(e)}(e,n):qi(e)}function wr(...e){const n=ad(e),t=function rD(e,n){return"number"==typeof O_(e)?e.pop():n}(e,1/0),r=e;return r.length?1===r.length?qi(r[0]):sd(t)(Er(r,n)):xa}class Yr extends we{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const t=super._subscribe(n);return!t.closed&&n.next(this._value),t}getValue(){const{hasError:n,thrownError:t,_value:r}=this;if(n)throw t;return this._throwIfClosed(),r}next(n){super.next(this._value=n)}}function Le(...e){return Er(e,ad(e))}function tf(e={}){const{connector:n=(()=>new we),resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:a=!0}=e;return c=>{let h,f,b,x=0,M=!1,T=!1;const I=()=>{f?.unsubscribe(),f=void 0},L=()=>{I(),h=b=void 0,M=T=!1},N=()=>{const V=h;L(),V?.unsubscribe()};return pr((V,$)=>{x++,!T&&!M&&I();const nt=b=b??n();$.add(()=>{x--,0===x&&!T&&!M&&(f=Ze(N,a))}),nt.subscribe($),!h&&x>0&&(h=new Qd({next:tt=>nt.next(tt),error:tt=>{T=!0,I(),f=Ze(L,t,tt),nt.error(tt)},complete:()=>{M=!0,I(),f=Ze(L,r),nt.complete()}}),qi(V).subscribe(h))})(c)}}function Ze(e,n,...t){if(!0===n)return void e();if(!1===n)return;const r=new Qd({next:()=>{r.unsubscribe(),e()}});return qi(n(...t)).subscribe(r)}function Ci(e,n){return pr((t,r)=>{let a=null,c=0,h=!1;const f=()=>h&&!a&&r.complete();t.subscribe(jn(r,b=>{a?.unsubscribe();let x=0;const M=c++;qi(e(b,M)).subscribe(a=jn(r,T=>r.next(n?n(b,T,M,x++):T),()=>{a=null,f()}))},()=>{h=!0,f()}))})}function wa(e,n=Al){return e=e??eu,pr((t,r)=>{let a,c=!0;t.subscribe(jn(r,h=>{const f=n(h);(c||!e(a,f))&&(c=!1,a=f,r.next(h))}))})}function eu(e,n){return e===n}function In(e){for(let n in e)if(e[n]===In)return n;throw Error("Could not find renamed property on target object.")}function ef(e,n){for(const t in n)n.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function io(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(io).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const n=e.toString();if(null==n)return""+n;const t=n.indexOf("\n");return-1===t?n:n.substring(0,t)}function L_(e,n){return null==e||""===e?null===n?"":n:null==n||""===n?e:e+" "+n}const g0=In({__forward_ref__:In});function rn(e){return e.__forward_ref__=rn,e.toString=function(){return io(this())},e}function Mi(e){return Hh(e)?e():e}function Hh(e){return"function"==typeof e&&e.hasOwnProperty(g0)&&e.__forward_ref__===rn}function B_(e){return e&&!!e.\u0275providers}const _0="https://g.co/ng/security#xss";class Rt extends Error{constructor(n,t){super(function Bt(e,n){return`NG0${Math.abs(e)}${n?": "+n:""}`}(n,t)),this.code=n}}function Yt(e){return"string"==typeof e?e:null==e?"":String(e)}function Ha(e,n){throw new Rt(-201,!1)}function os(e,n){null==e&&function vi(e,n,t,r){throw new Error(`ASSERTION ERROR: ${e}`+(null==r?"":` [Expected=> ${t} ${r} ${n} <=Actual]`))}(n,e,null,"!=")}function Jt(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Je(e){return{providers:e.providers||[],imports:e.imports||[]}}function cd(e){return y0(e,nu)||y0(e,ss)}function y0(e,n){return e.hasOwnProperty(n)?e[n]:null}function Gh(e){return e&&(e.hasOwnProperty(rf)||e.hasOwnProperty(di))?e[rf]:null}const nu=In({\u0275prov:In}),rf=In({\u0275inj:In}),ss=In({ngInjectableDef:In}),di=In({ngInjectorDef:In});var hn=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(hn||{});let sf;function fr(e){const n=sf;return sf=e,n}function v0(e,n,t){const r=cd(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:t&hn.Optional?null:void 0!==n?n:void Ha(io(e))}const zi=globalThis;class kt{constructor(n,t){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Jt({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const qh={},_c="__NG_DI_FLAG__",H_="ngTempTokenPath",$_=/\n/gm,dD="__source";let Yh;function Ca(e){const n=Yh;return Yh=e,n}function vR(e,n=hn.Default){if(void 0===Yh)throw new Rt(-203,!1);return null===Yh?v0(e,void 0,n):Yh.get(e,n&hn.Optional?null:void 0,n)}function vt(e,n=hn.Default){return(function as(){return sf}()||vR)(Mi(e),n)}function oe(e,n=hn.Default){return vt(e,Wa(n))}function Wa(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function w0(e){const n=[];for(let t=0;t<e.length;t++){const r=Mi(e[t]);if(Array.isArray(r)){if(0===r.length)throw new Rt(900,!1);let a,c=hn.Default;for(let h=0;h<r.length;h++){const f=r[h],b=xR(f);"number"==typeof b?-1===b?a=f.token:c|=b:a=f}n.push(vt(a,c))}else n.push(vt(r))}return n}function uf(e,n){return e[_c]=n,e.prototype[_c]=n,e}function xR(e){return e[_c]}function qa(e){return{toString:e}.toString()}var hf=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(hf||{}),ea=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(ea||{});const Ya={},Rn=[],dd=In({\u0275cmp:In}),mf=In({\u0275dir:In}),G_=In({\u0275pipe:In}),W_=In({\u0275mod:In}),Ol=In({\u0275fac:In}),ou=In({__NG_ELEMENT_ID__:In}),pt=In({__NG_ENV_ID__:In});function C0(e,n,t){let r=e.length;for(;;){const a=e.indexOf(n,t);if(-1===a)return a;if(0===a||e.charCodeAt(a-1)<=32){const c=n.length;if(a+c===r||e.charCodeAt(a+c)<=32)return a}t=a+1}}function pf(e,n,t){let r=0;for(;r<t.length;){const a=t[r];if("number"==typeof a){if(0!==a)break;r++;const c=t[r++],h=t[r++],f=t[r++];e.setAttribute(n,h,f,c)}else{const c=a,h=t[++r];M0(c)?e.setProperty(n,c,h):e.setAttribute(n,c,h),r++}}return r}function q_(e){return 3===e||4===e||6===e}function M0(e){return 64===e.charCodeAt(0)}function ud(e,n){if(null!==n&&0!==n.length)if(null===e||0===e.length)e=n.slice();else{let t=-1;for(let r=0;r<n.length;r++){const a=n[r];"number"==typeof a?t=a:0===t||Fl(e,t,a,null,-1===t||2===t?n[++r]:null)}}return e}function Fl(e,n,t,r,a){let c=0,h=e.length;if(-1===n)h=-1;else for(;c<e.length;){const f=e[c++];if("number"==typeof f){if(f===n){h=-1;break}if(f>n){h=c-1;break}}}for(;c<e.length;){const f=e[c];if("number"==typeof f)break;if(f===t){if(null===r)return void(null!==a&&(e[c+1]=a));if(r===e[c+1])return void(e[c+2]=a)}c++,null!==r&&c++,null!==a&&c++}-1!==h&&(e.splice(h,0,n),c=h+1),e.splice(c++,0,t),null!==r&&e.splice(c++,0,r),null!==a&&e.splice(c++,0,a)}const Y_="ng-template";function su(e,n,t){let r=0,a=!0;for(;r<e.length;){let c=e[r++];if("string"==typeof c&&a){const h=e[r++];if(t&&"class"===c&&-1!==C0(h.toLowerCase(),n,0))return!0}else{if(1===c){for(;r<e.length&&"string"==typeof(c=e[r++]);)if(c.toLowerCase()===n)return!0;return!1}"number"==typeof c&&(a=!1)}}return!1}function ff(e){return 4===e.type&&e.value!==Y_}function Zh(e,n,t){return n===(4!==e.type||t?e.value:Y_)}function D0(e,n,t){let r=4;const a=e.attrs||[],c=function CR(e){for(let n=0;n<e.length;n++)if(q_(e[n]))return n;return e.length}(a);let h=!1;for(let f=0;f<n.length;f++){const b=n[f];if("number"!=typeof b){if(!h)if(4&r){if(r=2|1&r,""!==b&&!Zh(e,b,t)||""===b&&1===n.length){if(Za(r))return!1;h=!0}}else{const x=8&r?b:n[++f];if(8&r&&null!==e.attrs){if(!su(e.attrs,x,t)){if(Za(r))return!1;h=!0}continue}const T=hD(8&r?"class":b,a,ff(e),t);if(-1===T){if(Za(r))return!1;h=!0;continue}if(""!==x){let I;I=T>c?"":a[T+1].toLowerCase();const L=8&r?I:null;if(L&&-1!==C0(L,x,0)||2&r&&x!==I){if(Za(r))return!1;h=!0}}}}else{if(!h&&!Za(r)&&!Za(b))return!1;if(h&&Za(b))continue;h=!1,r=b|1&r}}return Za(r)||h}function Za(e){return 0==(1&e)}function hD(e,n,t,r){if(null===n)return-1;let a=0;if(r||!t){let c=!1;for(;a<n.length;){const h=n[a];if(h===e)return a;if(3===h||6===h)c=!0;else{if(1===h||2===h){let f=n[++a];for(;"string"==typeof f;)f=n[++a];continue}if(4===h)break;if(0===h){a+=4;continue}}a+=c?1:2}return-1}return function MR(e,n){let t=e.indexOf(4);if(t>-1)for(t++;t<e.length;){const r=e[t];if("number"==typeof r)return-1;if(r===n)return t;t++}return-1}(n,e)}function k0(e,n,t=!1){for(let r=0;r<n.length;r++)if(D0(e,n[r],t))return!0;return!1}function DR(e,n){t:for(let t=0;t<n.length;t++){const r=n[t];if(e.length===r.length){for(let a=0;a<e.length;a++)if(e[a]!==r[a])continue t;return!0}}return!1}function mD(e,n){return e?":not("+n.trim()+")":n}function pD(e){let n=e[0],t=1,r=2,a="",c=!1;for(;t<e.length;){let h=e[t];if("string"==typeof h)if(2&r){const f=e[++t];a+="["+h+(f.length>0?'="'+f+'"':"")+"]"}else 8&r?a+="."+h:4&r&&(a+=" "+h);else""!==a&&!Za(h)&&(n+=mD(c,a),a=""),r=h,c=c||!Za(r);t++}return""!==a&&(n+=mD(c,a)),n}function Ye(e){return qa(()=>{const n=E0(e),t={...n,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===hf.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||ea.Emulated,styles:e.styles||Rn,_:null,schemas:e.schemas||null,tView:null,id:""};Q_(t);const r=e.dependencies;return t.directiveDefs=lu(r,!1),t.pipeDefs=lu(r,!0),t.id=function I0(e){let n=0;const t=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const a of t)n=Math.imul(31,n)+a.charCodeAt(0)<<0;return n+=2147483648,"c"+n}(t),t})}function T0(e){return yn(e)||$r(e)}function X_(e){return null!==e}function ei(e){return qa(()=>({type:e.type,bootstrap:e.bootstrap||Rn,declarations:e.declarations||Rn,imports:e.imports||Rn,exports:e.exports||Rn,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function K_(e,n){if(null==e)return Ya;const t={};for(const r in e)if(e.hasOwnProperty(r)){let a=e[r],c=a;Array.isArray(a)&&(c=a[1],a=a[0]),t[a]=r,n&&(n[a]=c)}return t}function Mt(e){return qa(()=>{const n=E0(e);return Q_(n),n})}function ko(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,standalone:!0===e.standalone,onDestroy:e.type.prototype.ngOnDestroy||null}}function yn(e){return e[dd]||null}function $r(e){return e[mf]||null}function No(e){return e[G_]||null}function ls(e,n){const t=e[W_]||null;if(!t&&!0===n)throw new Error(`Type ${io(e)} does not have '\u0275mod' property.`);return t}function E0(e){const n={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:e.inputs||Ya,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||Rn,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:K_(e.inputs,n),outputs:K_(e.outputs)}}function Q_(e){e.features?.forEach(n=>n(e))}function lu(e,n){if(!e)return null;const t=n?No:T0;return()=>("function"==typeof e?e():e).map(r=>t(r)).filter(X_)}const _e=0,Ie=1,Vi=2,gr=3,Ma=4,Xh=5,Zr=6,cu=7,Xr=8,hd=9,Kh=10,Bi=11,du=12,J_=13,md=14,Gr=15,Qh=16,Jh=17,Ts=18,bc=19,R0=20,Xa=21,Ka=22,Es=23,uu=24,fn=25,tb=1,eb=2,Ll=7,em=9,zo=11;function As(e){return Array.isArray(e)&&"object"==typeof e[tb]}function Vo(e){return Array.isArray(e)&&!0===e[tb]}function P0(e){return 0!=(4&e.flags)}function Bl(e){return e.componentOffset>-1}function ib(e){return 1==(1&e.flags)}function Da(e){return!!e.template}function nb(e){return 0!=(512&e[Vi])}function gd(e,n){return e.hasOwnProperty(Ol)?e[Ol]:null}let ho=null,hu=!1;function ka(e){const n=ho;return ho=e,n}const F0={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function CD(e){if(!_d(e)||e.dirty){if(!e.producerMustRecompute(e)&&!yc(e))return void(e.dirty=!1);e.producerRecomputeValue(e),e.dirty=!1}}function DD(e){e.dirty=!0,function MD(e){if(void 0===e.liveConsumerNode)return;const n=hu;hu=!0;try{for(const t of e.liveConsumerNode)t.dirty||DD(t)}finally{hu=n}}(e),e.consumerMarkedDirty?.(e)}function _f(e){return e&&(e.nextProducerIndex=0),ka(e)}function om(e,n){if(ka(n),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(_d(e))for(let t=e.nextProducerIndex;t<e.producerNode.length;t++)sm(e.producerNode[t],e.producerIndexOfThis[t]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function yc(e){xc(e);for(let n=0;n<e.producerNode.length;n++){const t=e.producerNode[n],r=e.producerLastReadVersion[n];if(r!==t.version||(CD(t),r!==t.version))return!0}return!1}function sb(e){if(xc(e),_d(e))for(let n=0;n<e.producerNode.length;n++)sm(e.producerNode[n],e.producerIndexOfThis[n]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function sm(e,n){if(function ia(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}(e),xc(e),1===e.liveConsumerNode.length)for(let r=0;r<e.producerNode.length;r++)sm(e.producerNode[r],e.producerIndexOfThis[r]);const t=e.liveConsumerNode.length-1;if(e.liveConsumerNode[n]=e.liveConsumerNode[t],e.liveConsumerIndexOfThis[n]=e.liveConsumerIndexOfThis[t],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,n<e.liveConsumerNode.length){const r=e.liveConsumerIndexOfThis[n],a=e.liveConsumerNode[n];xc(a),a.producerIndexOfThis[r]=n}}function _d(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function xc(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}let ab=null;const V0=()=>{},AD=(()=>({...F0,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:e=>{e.schedule(e.ref)},hasRun:!1,cleanupFn:V0}))();class ID{constructor(n,t,r){this.previousValue=n,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}}function Bn(){return pu}function pu(e){return e.type.prototype.ngOnChanges&&(e.setInput=PD),RD}function RD(){const e=j0(this),n=e?.current;if(n){const t=e.previous;if(t===Ya)e.previous=n;else for(let r in n)t[r]=n[r];e.current=null,this.ngOnChanges(n)}}function PD(e,n,t,r){const a=this.declaredInputs[t],c=j0(e)||function FD(e,n){return e[OD]=n}(e,{previous:Ya,current:null}),h=c.current||(c.current={}),f=c.previous,b=f[a];h[a]=new ID(b&&b.currentValue,n,f===Ya),e[r]=n}Bn.ngInherit=!0;const OD="__ngSimpleChanges__";function j0(e){return e[OD]||null}const Qa=function(e,n,t){},U0="svg";function cr(e){for(;Array.isArray(e);)e=e[_e];return e}function wc(e,n){return cr(n[e])}function Rs(e,n){return cr(n[e.index])}function BD(e,n){return e.data[n]}function lm(e,n){return e[n]}function na(e,n){const t=n[e];return As(t)?t:t[_e]}function bd(e,n){return null==n?null:e[n]}function ND(e){e[Jh]=0}function Ja(e){1024&e[Vi]||(e[Vi]|=1024,zD(e,1))}function xf(e){1024&e[Vi]&&(e[Vi]&=-1025,zD(e,-1))}function zD(e,n){let t=e[gr];if(null===t)return;t[Xh]+=n;let r=t;for(t=t[gr];null!==t&&(1===n&&1===r[Xh]||-1===n&&0===r[Xh]);)t[Xh]+=n,r=t,t=t[gr]}const _i={lFrame:So(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function fu(){return _i.bindingsEnabled}function ue(){return null!==_i.skipHydrationRootTNode}function Wt(){return _i.lFrame.lView}function Dn(){return _i.lFrame.tView}function $n(e){return _i.lFrame.contextLView=e,e[Xr]}function Nn(e){return _i.lFrame.contextLView=null,e}function mo(){let e=ub();for(;null!==e&&64===e.type;)e=e.parent;return e}function ub(){return _i.lFrame.currentTNode}function Ir(e,n){const t=_i.lFrame;t.currentTNode=e,t.isParent=n}function zl(){return _i.lFrame.isParent}function hb(){_i.lFrame.isParent=!1}function $o(){const e=_i.lFrame;let n=e.bindingRootIndex;return-1===n&&(n=e.bindingRootIndex=e.tView.bindingStartIndex),n}function Mc(){return _i.lFrame.bindingIndex++}function tl(e){const n=_i.lFrame,t=n.bindingIndex;return n.bindingIndex=n.bindingIndex+e,t}function $D(e,n){const t=_i.lFrame;t.bindingIndex=t.bindingRootIndex=e,yd(n)}function yd(e){_i.lFrame.currentDirectiveIndex=e}function _u(e){const n=_i.lFrame.currentDirectiveIndex;return-1===n?null:e[n]}function Ft(){return _i.lFrame.currentQueryIndex}function ke(e){_i.lFrame.currentQueryIndex=e}function Mf(e){const n=e[Ie];return 2===n.type?n.declTNode:1===n.type?e[Zr]:null}function Gn(e,n,t){if(t&hn.SkipSelf){let a=n,c=e;for(;!(a=a.parent,null!==a||t&hn.Host||(a=Mf(c),null===a||(c=c[md],10&a.type))););if(null===a)return!1;n=a,e=c}const r=_i.lFrame=Y0();return r.currentTNode=n,r.lView=e,!0}function dm(e){const n=Y0(),t=e[Ie];_i.lFrame=n,n.currentTNode=t.firstChild,n.lView=e,n.tView=t,n.contextLView=e,n.bindingIndex=t.bindingStartIndex,n.inI18n=!1}function Y0(){const e=_i.lFrame,n=null===e?null:e.child;return null===n?So(e):n}function So(e){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=n),n}function Df(){const e=_i.lFrame;return _i.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Z0=Df;function cs(){const e=Df();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function To(){return _i.lFrame.selectedIndex}function vn(e){_i.lFrame.selectedIndex=e}function Xe(){const e=_i.lFrame;return BD(e.tView,e.selectedIndex)}function Ps(){_i.lFrame.currentNamespace=U0}function Vl(){!function bu(){_i.lFrame.currentNamespace=null}()}let fb=!0;function Sa(){return fb}function ds(e){fb=e}function yu(e,n){for(let t=n.directiveStart,r=n.directiveEnd;t<r;t++){const c=e.data[t].type.prototype,{ngAfterContentInit:h,ngAfterContentChecked:f,ngAfterViewInit:b,ngAfterViewChecked:x,ngOnDestroy:M}=c;h&&(e.contentHooks??=[]).push(-t,h),f&&((e.contentHooks??=[]).push(t,f),(e.contentCheckHooks??=[]).push(t,f)),b&&(e.viewHooks??=[]).push(-t,b),x&&((e.viewHooks??=[]).push(t,x),(e.viewCheckHooks??=[]).push(t,x)),null!=M&&(e.destroyHooks??=[]).push(t,M)}}function um(e,n,t){Dc(e,n,3,t)}function hm(e,n,t,r){(3&e[Vi])===t&&Dc(e,n,t,r)}function kf(e,n){let t=e[Vi];(3&t)===n&&(t&=8191,t+=1,e[Vi]=t)}function Dc(e,n,t,r){const c=r??-1,h=n.length-1;let f=0;for(let b=void 0!==r?65535&e[Jh]:0;b<h;b++)if("number"==typeof n[b+1]){if(f=n[b],null!=r&&f>=r)break}else n[b]<0&&(e[Jh]+=65536),(f<c||-1==c)&&(bb(e,t,n,b),e[Jh]=(4294901760&e[Jh])+b+2),b++}function _b(e,n){Qa(4,e,n);const t=ka(null);try{n.call(e)}finally{ka(t),Qa(5,e,n)}}function bb(e,n,t,r){const a=t[r]<0,c=t[r+1],f=e[a?-t[r]:t[r]];a?e[Vi]>>13<e[Jh]>>16&&(3&e[Vi])===n&&(e[Vi]+=8192,_b(f,c)):_b(f,c)}const vd=-1;class vu{constructor(n,t,r){this.factory=n,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}}function kc(e){return e!==vd}function Sc(e){return 32767&e}function xd(e,n){let t=function K0(e){return e>>16}(e),r=n;for(;t>0;)r=r[md],t--;return r}let Tf=!0;function Ef(e){const n=Tf;return Tf=e,n}const Q0=255,J0=5;let YD=0;const el={};function Af(e,n){const t=tx(e,n);if(-1!==t)return t;const r=n[Ie];r.firstCreatePass&&(e.injectorIndex=n.length,xb(r.data,e),xb(n,null),xb(r.blueprint,null));const a=If(e,n),c=e.injectorIndex;if(kc(a)){const h=Sc(a),f=xd(a,n),b=f[Ie].data;for(let x=0;x<8;x++)n[c+x]=f[h+x]|b[h+x]}return n[c+8]=a,c}function xb(e,n){e.push(0,0,0,0,0,0,0,0,n)}function tx(e,n){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===n[e.injectorIndex+8]?-1:e.injectorIndex}function If(e,n){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let t=0,r=null,a=n;for(;null!==a;){if(r=Pt(a),null===r)return vd;if(t++,a=a[md],-1!==r.injectorIndex)return r.injectorIndex|t<<16}return vd}function ex(e,n,t){!function ZD(e,n,t){let r;"string"==typeof t?r=t.charCodeAt(0)||0:t.hasOwnProperty(ou)&&(r=t[ou]),null==r&&(r=t[ou]=YD++);const a=r&Q0;n.data[e+(a>>J0)]|=1<<a}(e,n,t)}function on(e,n,t){if(t&hn.Optional||void 0!==e)return e;Ha()}function ix(e,n,t,r){if(t&hn.Optional&&void 0===r&&(r=null),!(t&(hn.Self|hn.Host))){const a=e[hd],c=fr(void 0);try{return a?a.get(n,r,t&hn.Optional):v0(n,r,t&hn.Optional)}finally{fr(c)}}return on(r,0,t)}function XD(e,n,t,r=hn.Default,a){if(null!==e){if(2048&n[Vi]&&!(r&hn.Self)){const h=function fi(e,n,t,r,a){let c=e,h=n;for(;null!==c&&null!==h&&2048&h[Vi]&&!(512&h[Vi]);){const f=KD(c,h,t,r|hn.Self,el);if(f!==el)return f;let b=c.parent;if(!b){const x=h[R0];if(x){const M=x.get(t,el,r);if(M!==el)return M}b=Pt(h),h=h[md]}c=b}return a}(e,n,t,r,el);if(h!==el)return h}const c=KD(e,n,t,r,el);if(c!==el)return c}return ix(n,t,r,a)}function KD(e,n,t,r,a){const c=function QD(e){if("string"==typeof e)return e.charCodeAt(0)||0;const n=e.hasOwnProperty(ou)?e[ou]:void 0;return"number"==typeof n?n>=0?n&Q0:rx:n}(t);if("function"==typeof c){if(!Gn(n,e,r))return r&hn.Host?on(a,0,r):ix(n,t,r,a);try{let h;if(h=c(r),null!=h||r&hn.Optional)return h;Ha()}finally{Z0()}}else if("number"==typeof c){let h=null,f=tx(e,n),b=vd,x=r&hn.Host?n[Gr][Zr]:null;for((-1===f||r&hn.SkipSelf)&&(b=-1===f?If(e,n):n[f+8],b!==vd&&JD(r,!1)?(h=n[Ie],f=Sc(b),n=xd(b,n)):f=-1);-1!==f;){const M=n[Ie];if(nx(c,f,M.data)){const T=wb(f,n,t,h,r,x);if(T!==el)return T}b=n[f+8],b!==vd&&JD(r,n[Ie].data[f+8]===x)&&nx(c,f,n)?(h=M,f=Sc(b),n=xd(b,n)):f=-1}}return a}function wb(e,n,t,r,a,c){const h=n[Ie],f=h.data[e+8],M=Rf(f,h,t,null==r?Bl(f)&&Tf:r!=h&&0!=(3&f.type),a&hn.Host&&c===f);return null!==M?wu(n,h,M,f):el}function Rf(e,n,t,r,a){const c=e.providerIndexes,h=n.data,f=1048575&c,b=e.directiveStart,M=c>>20,I=a?f+M:e.directiveEnd;for(let L=r?f:f+M;L<I;L++){const N=h[L];if(L<b&&t===N||L>=b&&N.type===t)return L}if(a){const L=h[b];if(L&&Da(L)&&L.type===t)return b}return null}function wu(e,n,t,r){let a=e[t];const c=n.data;if(function Cr(e){return e instanceof vu}(a)){const h=a;h.resolving&&function ct(e,n){const t=n?`. Dependency path: ${n.join(" > ")} > ${e}`:"";throw new Rt(-200,`Circular dependency in DI detected for ${e}${t}`)}(function gi(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Yt(e)}(c[t]));const f=Ef(h.canSeeViewProviders);h.resolving=!0;const x=h.injectImpl?fr(h.injectImpl):null;Gn(e,r,hn.Default);try{a=e[t]=h.factory(void 0,c,e,r),n.firstCreatePass&&t>=r.directiveStart&&function gb(e,n,t){const{ngOnChanges:r,ngOnInit:a,ngDoCheck:c}=n.type.prototype;if(r){const h=pu(n);(t.preOrderHooks??=[]).push(e,h),(t.preOrderCheckHooks??=[]).push(e,h)}a&&(t.preOrderHooks??=[]).push(0-e,a),c&&((t.preOrderHooks??=[]).push(e,c),(t.preOrderCheckHooks??=[]).push(e,c))}(t,c[t],n)}finally{null!==x&&fr(x),Ef(f),h.resolving=!1,Z0()}}return a}function nx(e,n,t){return!!(t[n+(e>>J0)]&1<<e)}function JD(e,n){return!(e&hn.Self||e&hn.Host&&n)}class Go{constructor(n,t){this._tNode=n,this._lView=t}get(n,t,r){return XD(this._tNode,this._lView,n,Wa(r),t)}}function rx(){return new Go(mo(),Wt())}function bi(e){return qa(()=>{const n=e.prototype.constructor,t=n[Ol]||il(n),r=Object.prototype;let a=Object.getPrototypeOf(e.prototype).constructor;for(;a&&a!==r;){const c=a[Ol]||il(a);if(c&&c!==t)return c;a=Object.getPrototypeOf(a)}return c=>new c})}function il(e){return Hh(e)?()=>{const n=il(Mi(e));return n&&n()}:gd(e)}function Pt(e){const n=e[Ie],t=n.type;return 2===t?n.declTNode:1===t?e[Zr]:null}function Ue(e){return function KR(e,n){if("class"===n)return e.classes;if("style"===n)return e.styles;const t=e.attrs;if(t){const r=t.length;let a=0;for(;a<r;){const c=t[a];if(q_(c))break;if(0===c)a+=2;else if("number"==typeof c)for(a++;a<r&&"string"==typeof t[a];)a++;else{if(c===n)return t[a+1];a+=2}}}return null}(mo(),e)}const po="__parameters__";function mm(e,n,t){return qa(()=>{const r=function ti(e){return function(...t){if(e){const r=e(...t);for(const a in r)this[a]=r[a]}}}(n);function a(...c){if(this instanceof a)return r.apply(this,c),this;const h=new a(...c);return f.annotation=h,f;function f(b,x,M){const T=b.hasOwnProperty(po)?b[po]:Object.defineProperty(b,po,{value:[]})[po];for(;T.length<=M;)T.push(null);return(T[M]=T[M]||[]).push(h),b}}return t&&(a.prototype=Object.create(t.prototype)),a.prototype.ngMetadataName=e,a.annotationCls=a,a})}function go(e,n){e.forEach(t=>Array.isArray(t)?go(t,n):n(t))}function Wr(e,n,t){n>=e.length?e.push(t):e.splice(n,0,t)}function Mr(e,n){return n>=e.length-1?e.pop():e.splice(n,1)[0]}function pm(e,n){const t=[];for(let r=0;r<e;r++)t.push(n);return t}function us(e,n,t){let r=Du(e,n);return r>=0?e[1|r]=t:(r=~r,function eP(e,n,t,r){let a=e.length;if(a==n)e.push(t,r);else if(1===a)e.push(r,e[0]),e[0]=t;else{for(a--,e.push(e[a-1],e[a]);a>n;)e[a]=e[a-2],a--;e[n]=t,e[n+1]=r}}(e,r,n,t)),r}function Ul(e,n){const t=Du(e,n);if(t>=0)return e[1|t]}function Du(e,n){return function ox(e,n,t){let r=0,a=e.length>>t;for(;a!==r;){const c=r+(a-r>>1),h=e[c<<t];if(n===h)return c<<t;h>n?a=c:r=c+1}return~(a<<t)}(e,n,1)}const aa=uf(mm("Optional"),8),rl=uf(mm("SkipSelf"),4);function Wo(e){return 128==(128&e.flags)}var ol=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(ol||{});const mx=/^>|^->|<!--|-->|--!>|<!-$/g,xk=/(<|>)/g,wk="\u200b$1\u200b";const kb=new Map;let Sb=0;const Tb="__ngContext__";function Yo(e,n){As(n)?(e[Tb]=n[bc],function Mk(e){kb.set(e[bc],e)}(n)):e[Tb]=n}let jf;function Ib(e,n){return jf(e,n)}function _m(e){const n=e[gr];return Vo(n)?n[gr]:n}function Uf(e){return Rb(e[du])}function ui(e){return Rb(e[Ma])}function Rb(e){for(;null!==e&&!Vo(e);)e=e[Ma];return e}function Ea(e,n,t,r,a){if(null!=r){let c,h=!1;Vo(r)?c=r:As(r)&&(h=!0,r=r[_e]);const f=cr(r);0===e&&null!==t?null==a?at(n,t,f):Tu(n,t,f,a||null,!0):1===e&&null!==t?Tu(n,t,f,a||null,!0):2===e?function Bb(e,n,t){const r=Fb(e,n);r&&function _o(e,n,t,r){e.removeChild(n,t,r)}(e,r,n,t)}(n,f,h):3===e&&n.destroyNode(f),null!=c&&function Nb(e,n,t,r,a){const c=t[Ll];c!==cr(t)&&Ea(n,e,r,c,a);for(let f=zo;f<t.length;f++){const b=t[f];Ri(b[Ie],b,e,n,r,c)}}(n,e,c,t,a)}}function Pb(e,n){return e.createComment(function px(e){return e.replace(mx,n=>n.replace(xk,wk))}(n))}function $f(e,n,t){return e.createElement(n,t)}function Ob(e,n){const t=e[em],r=t.indexOf(n);xf(n),t.splice(r,1)}function Qi(e,n){if(e.length<=zo)return;const t=zo+n,r=e[t];if(r){const a=r[Qh];null!==a&&a!==e&&Ob(a,r),n>0&&(e[t-1][Ma]=r[Ma]);const c=Mr(e,zo+n);!function Ok(e,n){Ri(e,n,n[Bi],2,null,null),n[_e]=null,n[Zr]=null}(r[Ie],r);const h=c[Ts];null!==h&&h.detachView(c[Ie]),r[gr]=null,r[Ma]=null,r[Vi]&=-129}return r}function bx(e,n){if(!(256&n[Vi])){const t=n[Bi];n[Es]&&sb(n[Es]),n[uu]&&sb(n[uu]),t.destroyNode&&Ri(e,n,t,3,null,null),function Bk(e){let n=e[du];if(!n)return yx(e[Ie],e);for(;n;){let t=null;if(As(n))t=n[du];else{const r=n[zo];r&&(t=r)}if(!t){for(;n&&!n[Ma]&&n!==e;)As(n)&&yx(n[Ie],n),n=n[gr];null===n&&(n=e),As(n)&&yx(n[Ie],n),t=n&&n[Ma]}n=t}}(n)}}function yx(e,n){if(!(256&n[Vi])){n[Vi]&=-129,n[Vi]|=256,function hP(e,n){let t;if(null!=e&&null!=(t=e.destroyHooks))for(let r=0;r<t.length;r+=2){const a=n[t[r]];if(!(a instanceof vu)){const c=t[r+1];if(Array.isArray(c))for(let h=0;h<c.length;h+=2){const f=a[c[h]],b=c[h+1];Qa(4,f,b);try{b.call(f)}finally{Qa(5,f,b)}}else{Qa(4,a,c);try{c.call(a)}finally{Qa(5,a,c)}}}}}(e,n),function bm(e,n){const t=e.cleanup,r=n[cu];if(null!==t)for(let c=0;c<t.length-1;c+=2)if("string"==typeof t[c]){const h=t[c+3];h>=0?r[h]():r[-h].unsubscribe(),c+=2}else t[c].call(r[t[c+1]]);null!==r&&(n[cu]=null);const a=n[Xa];if(null!==a){n[Xa]=null;for(let c=0;c<a.length;c++)(0,a[c])()}}(e,n),1===n[Ie].type&&n[Bi].destroy();const t=n[Qh];if(null!==t&&Vo(n[gr])){t!==n[gr]&&Ob(t,n);const r=n[Ts];null!==r&&r.detachView(e)}!function Dk(e){kb.delete(e[bc])}(n)}}function vx(e,n,t){return function Zo(e,n,t){let r=n;for(;null!==r&&40&r.type;)r=(n=r).parent;if(null===r)return t[_e];{const{componentOffset:a}=r;if(a>-1){const{encapsulation:c}=e.data[r.directiveStart+a];if(c===ea.None||c===ea.Emulated)return null}return Rs(r,t)}}(e,n.parent,t)}function Tu(e,n,t,r,a){e.insertBefore(n,t,r,a)}function at(e,n,t){e.appendChild(n,t)}function zk(e,n,t,r,a){null!==r?Tu(e,n,t,r,a):at(e,n,t)}function Fb(e,n){return e.parentNode(n)}function Z(e,n,t){return xx(e,n,t)}let Aa,Yf,Dd,ps,xx=function Vk(e,n,t){return 40&e.type?Rs(e,t):null};function Eu(e,n,t,r){const a=vx(e,r,n),c=n[Bi],f=Z(r.parent||n[Zr],r,n);if(null!=a)if(Array.isArray(t))for(let b=0;b<t.length;b++)zk(c,a,t[b],f,!1);else zk(c,a,t,f,!1);void 0!==Aa&&Aa(c,r,n,t,a)}function ym(e,n){if(null!==n){const t=n.type;if(3&t)return Rs(n,e);if(4&t)return Lb(-1,e[n.index]);if(8&t){const r=n.child;if(null!==r)return ym(e,r);{const a=e[n.index];return Vo(a)?Lb(-1,a):cr(a)}}if(32&t)return Ib(n,e)()||cr(e[n.index]);{const r=Ac(e,n);return null!==r?Array.isArray(r)?r[0]:ym(_m(e[Gr]),r):ym(e,n.next)}}return null}function Ac(e,n){return null!==n?e[Gr][Zr].projection[n.projection]:null}function Lb(e,n){const t=zo+e+1;if(t<n.length){const r=n[t],a=r[Ie].firstChild;if(null!==a)return ym(r,a)}return n[Ll]}function Gf(e,n,t,r,a,c,h){for(;null!=t;){const f=r[t.index],b=t.type;if(h&&0===n&&(f&&Yo(cr(f),r),t.flags|=2),32!=(32&t.flags))if(8&b)Gf(e,n,t.child,r,a,c,!1),Ea(n,e,a,f,c);else if(32&b){const x=Ib(t,r);let M;for(;M=x();)Ea(n,e,a,M,c);Ea(n,e,a,f,c)}else 16&b?wx(e,n,r,t,a,c):Ea(n,e,a,f,c);t=h?t.projectionNext:t.next}}function Ri(e,n,t,r,a,c){Gf(t,r,e.firstChild,n,a,c,!1)}function wx(e,n,t,r,a,c){const h=t[Gr],b=h[Zr].projection[r.projection];if(Array.isArray(b))for(let x=0;x<b.length;x++)Ea(n,e,a,b[x],c);else{let x=b;const M=h[gr];Wo(r)&&(x.flags|=128),Gf(e,n,x,M,a,c,!0)}}function Mx(e,n,t){""===t?e.removeAttribute(n,"class"):e.setAttribute(n,"class",t)}function Dx(e,n,t){const{mergedAttrs:r,classes:a,styles:c}=t;null!==r&&pf(e,n,r),null!==a&&Mx(e,n,a),null!==c&&function qf(e,n,t){e.setAttribute(n,"style",t)}(e,n,c)}function gn(e){return function al(){if(void 0===Yf&&(Yf=null,zi.trustedTypes))try{Yf=zi.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Yf}()?.createHTML(e)||e}function Uk(e){return function Sx(){if(void 0===ps&&(ps=null,zi.trustedTypes))try{ps=zi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return ps}()?.createScriptURL(e)||e}class Ic{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${_0})`}}class da extends Ic{getTypeName(){return"HTML"}}class Rc extends Ic{getTypeName(){return"Style"}}class Hk extends Ic{getTypeName(){return"Script"}}class $k extends Ic{getTypeName(){return"URL"}}class Ex extends Ic{getTypeName(){return"ResourceURL"}}function Xo(e){return e instanceof Ic?e.changingThisBreaksApplicationSecurity:e}function Ia(e,n){const t=function vm(e){return e instanceof Ic&&e.getTypeName()||null}(e);if(null!=t&&t!==n){if("ResourceURL"===t&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${t} (see ${_0})`)}return t===n}class Ax{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const t=(new window.DOMParser).parseFromString(gn(n),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(n):(t.removeChild(t.firstChild),t)}catch{return null}}}class Wk{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const t=this.inertDocument.createElement("template");return t.innerHTML=gn(n),t}}const Yk=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Dr(e){return(e=String(e)).match(Yk)?e:"unsafe:"+e}function Wl(e){const n={};for(const t of e.split(","))n[t]=!0;return n}function xm(...e){const n={};for(const t of e)for(const r in t)t.hasOwnProperty(r)&&(n[r]=!0);return n}const Ix=Wl("area,br,col,hr,img,wbr"),Zk=Wl("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Rx=Wl("rp,rt"),Ox=xm(Ix,xm(Zk,Wl("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),xm(Rx,Wl("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),xm(Rx,Zk)),Fx=Wl("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),jb=xm(Fx,Wl("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Wl("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Sd=Wl("script,style,template");class qe{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let t=n.firstChild,r=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?r=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,r&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let a=this.checkClobberedElement(t,t.nextSibling);if(a){t=a;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(n){const t=n.nodeName.toLowerCase();if(!Ox.hasOwnProperty(t))return this.sanitizedSomething=!0,!Sd.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const r=n.attributes;for(let a=0;a<r.length;a++){const c=r.item(a),h=c.name,f=h.toLowerCase();if(!jb.hasOwnProperty(f)){this.sanitizedSomething=!0;continue}let b=c.value;Fx[f]&&(b=Dr(b)),this.buf.push(" ",h,'="',Jf(b),'"')}return this.buf.push(">"),!0}endElement(n){const t=n.nodeName.toLowerCase();Ox.hasOwnProperty(t)&&!Ix.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(n){this.buf.push(Jf(n))}checkClobberedElement(n,t){if(t&&(n.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return t}}const _P=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,bP=/([^\#-~ |!])/g;function Jf(e){return e.replace(/&/g,"&amp;").replace(_P,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(bP,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let dr;function Rr(e,n){let t=null;try{dr=dr||function Vb(e){const n=new Wk(e);return function qk(){try{return!!(new window.DOMParser).parseFromString(gn(""),"text/html")}catch{return!1}}()?new Ax(n):n}(e);let r=n?String(n):"";t=dr.getInertBodyElement(r);let a=5,c=r;do{if(0===a)throw new Error("Failed to sanitize html because the input is unstable");a--,r=c,c=t.innerHTML,t=dr.getInertBodyElement(r)}while(r!==c);return gn((new qe).sanitizeChildren(sn(t)||t))}finally{if(t){const r=sn(t)||t;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function sn(e){return"content"in e&&function Ls(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var an=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(an||{});function Lx(e){const n=Au();return n?n.sanitize(an.URL,e)||"":Ia(e,"URL")?Xo(e):Dr(Yt(e))}function Pc(e){const n=Au();if(n)return Uk(n.sanitize(an.RESOURCE_URL,e)||"");if(Ia(e,"ResourceURL"))return Uk(Xo(e));throw new Rt(904,!1)}function Au(){const e=Wt();return e&&e[Kh].sanitizer}const wm=new kt("ENVIRONMENT_INITIALIZER"),Qk=new kt("INJECTOR",-1),ll=new kt("INJECTOR_DEF_TYPES");class ql{get(n,t=qh){if(t===qh){const r=new Error(`NullInjectorError: No provider for ${io(n)}!`);throw r.name="NullInjectorError",r}return t}}function Ub(...e){return{\u0275providers:Hb(0,e),\u0275fromNgModule:!0}}function Hb(e,...n){const t=[],r=new Set;let a;const c=h=>{t.push(h)};return go(n,h=>{const f=h;$b(f,c,[],r)&&(a||=[],a.push(f))}),void 0!==a&&Vx(a,c),t}function Vx(e,n){for(let t=0;t<e.length;t++){const{ngModule:r,providers:a}=e[t];jx(a,c=>{n(c,r)})}}function $b(e,n,t,r){if(!(e=Mi(e)))return!1;let a=null,c=Gh(e);const h=!c&&yn(e);if(c||h){if(h&&!h.standalone)return!1;a=e}else{const b=e.ngModule;if(c=Gh(b),!c)return!1;a=b}const f=r.has(a);if(h){if(f)return!1;if(r.add(a),h.dependencies){const b="function"==typeof h.dependencies?h.dependencies():h.dependencies;for(const x of b)$b(x,n,t,r)}}else{if(!c)return!1;{if(null!=c.imports&&!f){let x;r.add(a);try{go(c.imports,M=>{$b(M,n,t,r)&&(x||=[],x.push(M))})}finally{}void 0!==x&&Vx(x,n)}if(!f){const x=gd(a)||(()=>new a);n({provide:a,useFactory:x,deps:Rn},a),n({provide:ll,useValue:a,multi:!0},a),n({provide:wm,useValue:()=>vt(a),multi:!0},a)}const b=c.providers;if(null!=b&&!f){const x=e;jx(b,M=>{n(M,x)})}}}return a!==e&&void 0!==e.providers}function jx(e,n){for(let t of e)B_(t)&&(t=t.\u0275providers),Array.isArray(t)?jx(t,n):n(t)}const Ux=In({provide:String,useValue:In});function Hx(e){return null!==e&&"object"==typeof e&&Ux in e}function Td(e){return"function"==typeof e}const Wb=new kt("Set Injector scope."),qb={},Mm={};let eg;function Oc(){return void 0===eg&&(eg=new ql),eg}class Ko{}class Iu extends Ko{get destroyed(){return this._destroyed}constructor(n,t,r,a){super(),this.parent=t,this.source=r,this.scopes=a,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Zb(n,h=>this.processProvider(h)),this.records.set(Qk,Dm(void 0,this)),a.has("environment")&&this.records.set(Ko,Dm(void 0,this));const c=this.records.get(Wb);null!=c&&"string"==typeof c.value&&this.scopes.add(c.value),this.injectorDefTypes=new Set(this.get(ll.multi,Rn,hn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of n)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();const t=Ca(this),r=fr(void 0);try{return n()}finally{Ca(t),fr(r)}}get(n,t=qh,r=hn.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(pt))return n[pt](this);r=Wa(r);const c=Ca(this),h=fr(void 0);try{if(!(r&hn.SkipSelf)){let b=this.records.get(n);if(void 0===b){const x=function wP(e){return"function"==typeof e||"object"==typeof e&&e instanceof kt}(n)&&cd(n);b=x&&this.injectableDefInScope(x)?Dm(Yb(n),qb):null,this.records.set(n,b)}if(null!=b)return this.hydrate(n,b)}return(r&hn.Self?Oc():this.parent).get(n,t=r&hn.Optional&&t===qh?null:t)}catch(f){if("NullInjectorError"===f.name){if((f[H_]=f[H_]||[]).unshift(io(n)),c)throw f;return function uD(e,n,t,r){const a=e[H_];throw n[dD]&&a.unshift(n[dD]),e.message=function wR(e,n,t,r=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let a=io(n);if(Array.isArray(n))a=n.map(io).join(" -> ");else if("object"==typeof n){let c=[];for(let h in n)if(n.hasOwnProperty(h)){let f=n[h];c.push(h+":"+("string"==typeof f?JSON.stringify(f):io(f)))}a=`{${c.join(", ")}}`}return`${t}${r?"("+r+")":""}[${a}]: ${e.replace($_,"\n  ")}`}("\n"+e.message,a,t,r),e.ngTokenPath=a,e[H_]=null,e}(f,n,"R3InjectorError",this.source)}throw f}finally{fr(h),Ca(c)}}resolveInjectorInitializers(){const n=Ca(this),t=fr(void 0);try{const a=this.get(wm.multi,Rn,hn.Self);for(const c of a)c()}finally{Ca(n),fr(t)}}toString(){const n=[],t=this.records;for(const r of t.keys())n.push(io(r));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Rt(205,!1)}processProvider(n){let t=Td(n=Mi(n))?n:Mi(n&&n.provide);const r=function xP(e){return Hx(e)?Dm(void 0,e.useValue):Dm(Jk(e),qb)}(n);if(Td(n)||!0!==n.multi)this.records.get(t);else{let a=this.records.get(t);a||(a=Dm(void 0,qb,!0),a.factory=()=>w0(a.multi),this.records.set(t,a)),t=n,a.multi.push(n)}this.records.set(t,r)}hydrate(n,t){return t.value===qb&&(t.value=Mm,t.value=t.factory()),"object"==typeof t.value&&t.value&&function eS(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(n){if(!n.providedIn)return!1;const t=Mi(n.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(n){const t=this._onDestroyHooks.indexOf(n);-1!==t&&this._onDestroyHooks.splice(t,1)}}function Yb(e){const n=cd(e),t=null!==n?n.factory:gd(e);if(null!==t)return t;if(e instanceof kt)throw new Rt(204,!1);if(e instanceof Function)return function vP(e){const n=e.length;if(n>0)throw pm(n,"?"),new Rt(204,!1);const t=function V_(e){return e&&(e[nu]||e[ss])||null}(e);return null!==t?()=>t.factory(e):()=>new e}(e);throw new Rt(204,!1)}function Jk(e,n,t){let r;if(Td(e)){const a=Mi(e);return gd(a)||Yb(a)}if(Hx(e))r=()=>Mi(e.useValue);else if(function $x(e){return!(!e||!e.useFactory)}(e))r=()=>e.useFactory(...w0(e.deps||[]));else if(function Gb(e){return!(!e||!e.useExisting)}(e))r=()=>vt(Mi(e.useExisting));else{const a=Mi(e&&(e.useClass||e.provide));if(!function tS(e){return!!e.deps}(e))return gd(a)||Yb(a);r=()=>new a(...w0(e.deps))}return r}function Dm(e,n,t=!1){return{factory:e,value:n,multi:t?[]:void 0}}function Zb(e,n){for(const t of e)Array.isArray(t)?Zb(t,n):t&&B_(t)?Zb(t.\u0275providers,n):n(t)}const ig=new kt("AppId",{providedIn:"root",factory:()=>CP}),CP="ng",Gx=new kt("Platform Initializer"),Fc=new kt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Pr=new kt("AnimationModuleType"),cl=new kt("CSP nonce",{providedIn:"root",factory:()=>function jo(){if(void 0!==Dd)return Dd;if(typeof document<"u")return document;throw new Rt(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let iS=(e,n,t)=>null;function Id(e,n,t=!1){return iS(e,n,t)}class Jx{}class sg{}class ew{resolveComponentFactory(n){throw function tw(e){const n=Error(`No component factory found for ${io(e)}.`);return n.ngComponent=e,n}(n)}}let Lc=(()=>{class e{static#t=this.NULL=new ew}return e})();function EP(){return Tm(mo(),Wt())}function Tm(e,n){return new Me(Rs(e,n))}let Me=(()=>{class e{constructor(t){this.nativeElement=t}static#t=this.__NG_ELEMENT_ID__=EP}return e})();function AP(e){return e instanceof Me?e.nativeElement:e}class ag{}let Bc=(()=>{class e{constructor(){this.destroyNode=null}static#t=this.__NG_ELEMENT_ID__=()=>function IP(){const e=Wt(),t=na(mo().index,e);return(As(t)?t:e)[Bi]}()}return e})(),RP=(()=>{class e{static#t=this.\u0275prov=Jt({token:e,providedIn:"root",factory:()=>null})}return e})();class Yl{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const PP=new Yl("16.2.12"),ey={};function cg(e,n=null,t=null,r){const a=sw(e,n,t,r);return a.resolveInjectorInitializers(),a}function sw(e,n=null,t=null,r,a=new Set){const c=[t||Rn,Ub(e)];return r=r||("object"==typeof e?void 0:io(e)),new Iu(c,n||Oc(),r||null,a)}let oo=(()=>{class e{static#t=this.THROW_IF_NOT_FOUND=qh;static#e=this.NULL=new ql;static create(t,r){if(Array.isArray(t))return cg({name:""},r,t,"");{const a=t.name??"";return cg({name:a},t.parent,t.providers,a)}}static#i=this.\u0275prov=Jt({token:e,providedIn:"any",factory:()=>vt(Qk)});static#n=this.__NG_ELEMENT_ID__=-1}return e})();function Pn(e){return e.ngOriginalError}class Bs{constructor(){this._console=console}handleError(n){const t=this._findOriginalError(n);this._console.error("ERROR",n),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(n){let t=n&&Pn(n);for(;t&&Pn(t);)t=Pn(t);return t||null}}function ny(e){return n=>{setTimeout(e,void 0,n)}}const me=class Em extends we{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,t,r){let a=n,c=t||(()=>null),h=r;if(n&&"object"==typeof n){const b=n;a=b.next?.bind(b),c=b.error?.bind(b),h=b.complete?.bind(b)}this.__isAsync&&(c=ny(c),a&&(a=ny(a)),h&&(h=ny(h)));const f=super.subscribe({next:a,error:c,complete:h});return n instanceof lt&&n.add(f),f}};function uS(...e){}class Re{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new me(!1),this.onMicrotaskEmpty=new me(!1),this.onStable=new me(!1),this.onError=new me(!1),typeof Zone>"u")throw new Rt(908,!1);Zone.assertZonePatched();const a=this;a._nesting=0,a._outer=a._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(a._inner=a._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(a._inner=a._inner.fork(Zone.longStackTraceZoneSpec)),a.shouldCoalesceEventChangeDetection=!r&&t,a.shouldCoalesceRunChangeDetection=r,a.lastRequestAnimationFrameId=-1,a.nativeRequestAnimationFrame=function BP(){const e="function"==typeof zi.requestAnimationFrame;let n=zi[e?"requestAnimationFrame":"setTimeout"],t=zi[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&t){const r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r);const a=t[Zone.__symbol__("OriginalDelegate")];a&&(t=a)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function VP(e){const n=()=>{!function zP(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(zi,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Am(e),e.isCheckStableRunning=!0,cw(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Am(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,a,c,h,f)=>{if(function jP(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(f))return t.invokeTask(a,c,h,f);try{return Lu(e),t.invokeTask(a,c,h,f)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===c.type||e.shouldCoalesceRunChangeDetection)&&n(),dw(e)}},onInvoke:(t,r,a,c,h,f,b)=>{try{return Lu(e),t.invoke(a,c,h,f,b)}finally{e.shouldCoalesceRunChangeDetection&&n(),dw(e)}},onHasTask:(t,r,a,c)=>{t.hasTask(a,c),r===a&&("microTask"==c.change?(e._hasPendingMicrotasks=c.microTask,Am(e),cw(e)):"macroTask"==c.change&&(e.hasPendingMacrotasks=c.macroTask))},onHandleError:(t,r,a,c)=>(t.handleError(a,c),e.runOutsideAngular(()=>e.onError.emit(c)),!1)})}(a)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Re.isInAngularZone())throw new Rt(909,!1)}static assertNotInAngularZone(){if(Re.isInAngularZone())throw new Rt(909,!1)}run(n,t,r){return this._inner.run(n,t,r)}runTask(n,t,r,a){const c=this._inner,h=c.scheduleEventTask("NgZoneEvent: "+a,n,NP,uS,uS);try{return c.runTask(h,t,r)}finally{c.cancelTask(h)}}runGuarded(n,t,r){return this._inner.runGuarded(n,t,r)}runOutsideAngular(n){return this._outer.run(n)}}const NP={};function cw(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Am(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function Lu(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function dw(e){e._nesting--,cw(e)}class ry{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new me,this.onMicrotaskEmpty=new me,this.onStable=new me,this.onError=new me}run(n,t,r){return n.apply(t,r)}runGuarded(n,t,r){return n.apply(t,r)}runOutsideAngular(n){return n()}runTask(n,t,r,a){return n.apply(t,r)}}const hS=new kt("",{providedIn:"root",factory:uw});function uw(){const e=oe(Re);let n=!0;return wr(new en(a=>{n=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{a.next(n),a.complete()})}),new en(a=>{let c;e.runOutsideAngular(()=>{c=e.onStable.subscribe(()=>{Re.assertNotInAngularZone(),queueMicrotask(()=>{!n&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(n=!0,a.next(!0))})})});const h=e.onUnstable.subscribe(()=>{Re.assertInAngularZone(),n&&(n=!1,e.runOutsideAngular(()=>{a.next(!1)}))});return()=>{c.unsubscribe(),h.unsubscribe()}}).pipe(tf()))}function Zl(e){return e instanceof Function?e():e}let mw=(()=>{class e{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#t=this.\u0275prov=Jt({token:e,providedIn:"root",factory:()=>new e})}return e})();function Od(e){for(;e;){e[Vi]|=64;const n=_m(e);if(nb(e)&&!n)return e;e=n}return null}const sy=new kt("",{providedIn:"root",factory:()=>!1});let Ns=null;function ay(e,n){return e[n]??wS()}function Im(e,n){const t=wS();t.producerNode?.length&&(e[n]=Ns,t.lView=e,Ns=xS())}const Xl={...F0,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{Od(e.lView)},lView:null};function xS(){return Object.create(Xl)}function wS(){return Ns??=xS(),Ns}const Oi={};function St(e){CS(Dn(),Wt(),To()+e,!1)}function CS(e,n,t,r){if(!r)if(3==(3&n[Vi])){const c=e.preOrderCheckHooks;null!==c&&um(n,c,t)}else{const c=e.preOrderHooks;null!==c&&hm(n,c,0,t)}vn(t)}function z(e,n=hn.Default){const t=Wt();return null===t?vt(e,n):XD(mo(),t,Mi(e),n)}function dl(){throw new Error("invalid")}function ly(e,n,t,r,a,c,h,f,b,x,M){const T=n.blueprint.slice();return T[_e]=a,T[Vi]=140|r,(null!==x||e&&2048&e[Vi])&&(T[Vi]|=2048),ND(T),T[gr]=T[md]=e,T[Xr]=t,T[Kh]=h||e&&e[Kh],T[Bi]=f||e&&e[Bi],T[hd]=b||e&&e[hd]||null,T[Zr]=c,T[bc]=function Ck(){return Sb++}(),T[Ka]=M,T[R0]=x,T[Gr]=2==n.type?e[Gr]:T,T}function Vu(e,n,t,r,a){let c=e.data[n];if(null===c)c=function On(e,n,t,r,a){const c=ub(),h=zl(),b=e.data[n]=function TS(e,n,t,r,a,c){let h=n?n.injectorIndex:-1,f=0;return ue()&&(f|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:h,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:f,providerIndexes:0,value:a,attrs:c,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,h?c:c&&c.parent,t,n,r,a);return null===e.firstChild&&(e.firstChild=b),null!==c&&(h?null==c.child&&null!==b.parent&&(c.child=b):null===c.next&&(c.next=b,b.prev=c)),b}(e,n,t,r,a),function Cf(){return _i.lFrame.inI18n}()&&(c.flags|=32);else if(64&c.type){c.type=t,c.value=r,c.attrs=a;const h=function gu(){const e=_i.lFrame,n=e.currentTNode;return e.isParent?n:n.parent}();c.injectorIndex=null===h?-1:h.injectorIndex}return Ir(c,!0),c}function Rm(e,n,t,r){if(0===t)return-1;const a=n.length;for(let c=0;c<t;c++)n.push(r),e.blueprint.push(r),e.data.push(null);return a}function Pm(e,n,t,r,a){const c=ay(n,Es),h=To(),f=2&r;try{vn(-1),f&&n.length>fn&&CS(e,n,fn,!1),Qa(f?2:0,a);const x=f?c:null,M=_f(x);try{null!==x&&(x.dirty=!1),t(r,a)}finally{om(x,M)}}finally{f&&null===n[Es]&&Im(n,Es),vn(h),Qa(f?3:1,a)}}function Fd(e,n,t){if(P0(n)){const r=ka(null);try{const c=n.directiveEnd;for(let h=n.directiveStart;h<c;h++){const f=e.data[h];f.contentQueries&&f.contentQueries(1,t[h],h)}}finally{ka(r)}}}function dg(e,n,t){fu()&&(function IS(e,n,t,r){const a=t.directiveStart,c=t.directiveEnd;Bl(t)&&function FS(e,n,t){const r=Rs(n,e),a=MS(t);let h=16;t.signals?h=4096:t.onPush&&(h=64);const f=Nm(e,ly(e,a,null,h,r,n,null,e[Kh].rendererFactory.createRenderer(r,t),null,null,null));e[n.index]=f}(n,t,e.data[a+t.componentOffset]),e.firstCreatePass||Af(t,n),Yo(r,n);const h=t.initialInputs;for(let f=a;f<c;f++){const b=e.data[f],x=wu(n,e,f,t);Yo(x,n),null!==h&&QP(0,f-a,x,b,0,h),Da(b)&&(na(t.index,n)[Xr]=wu(n,e,f,t))}}(e,n,t,Rs(t,n)),64==(64&t.flags)&&Fm(e,n,t))}function Om(e,n,t=Rs){const r=n.localNames;if(null!==r){let a=n.index+1;for(let c=0;c<r.length;c+=2){const h=r[c+1],f=-1===h?t(n,e):e[h];e[a++]=f}}}function MS(e){const n=e.tView;return null===n||n.incompleteFirstPass?e.tView=cy(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):n}function cy(e,n,t,r,a,c,h,f,b,x,M){const T=fn+r,I=T+a,L=function DS(e,n){const t=[];for(let r=0;r<n;r++)t.push(r<e?null:Oi);return t}(T,I),N="function"==typeof x?x():x;return L[Ie]={type:e,blueprint:L,template:t,queries:null,viewQuery:f,declTNode:n,data:L.slice().fill(null,T),bindingStartIndex:T,expandoStartIndex:I,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof c?c():c,pipeRegistry:"function"==typeof h?h():h,firstChild:null,schemas:b,consts:N,incompleteFirstPass:!1,ssrId:M}}let fw=e=>null;function Kl(e,n,t,r){for(let a in e)if(e.hasOwnProperty(a)){t=null===t?{}:t;const c=e[a];null===r?gw(t,n,a,c):r.hasOwnProperty(a)&&gw(t,n,r[a],c)}return t}function gw(e,n,t,r){e.hasOwnProperty(t)?e[t].push(n,r):e[t]=[n,r]}function zs(e,n,t,r,a,c,h,f){const b=Rs(n,t);let M,x=n.inputs;!f&&null!=x&&(M=x[r])?(Ql(e,t,M,r,a),Bl(n)&&function ZP(e,n){const t=na(n,e);16&t[Vi]||(t[Vi]|=64)}(t,n.index)):3&n.type&&(r=function AS(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),a=null!=h?h(a,n.value||"",r):a,c.setProperty(b,r,a))}function uy(e,n,t,r){if(fu()){const a=null===r?null:{"":-1},c=function PS(e,n){const t=e.directiveRegistry;let r=null,a=null;if(t)for(let c=0;c<t.length;c++){const h=t[c];if(k0(n,h.selectors,!1))if(r||(r=[]),Da(h))if(null!==h.findHostDirectiveDefs){const f=[];a=a||new Map,h.findHostDirectiveDefs(h,f,a),r.unshift(...f,h),ua(e,n,f.length)}else r.unshift(h),ua(e,n,0);else a=a||new Map,h.findHostDirectiveDefs?.(h,r,a),r.push(h)}return null===r?null:[r,a]}(e,t);let h,f;null===c?h=f=null:[h,f]=c,null!==h&&hy(e,n,t,h,a,f),a&&function Lm(e,n,t){if(n){const r=e.localNames=[];for(let a=0;a<n.length;a+=2){const c=t[n[a+1]];if(null==c)throw new Rt(-301,!1);r.push(n[a],c)}}}(t,r,a)}t.mergedAttrs=ud(t.mergedAttrs,t.attrs)}function hy(e,n,t,r,a,c){for(let x=0;x<r.length;x++)ex(Af(t,n),e,r[x].type);!function OS(e,n,t){e.flags|=1,e.directiveStart=n,e.directiveEnd=n+t,e.providerIndexes=n}(t,e.data.length,r.length);for(let x=0;x<r.length;x++){const M=r[x];M.providersResolver&&M.providersResolver(M)}let h=!1,f=!1,b=Rm(e,n,r.length,null);for(let x=0;x<r.length;x++){const M=r[x];t.mergedAttrs=ud(t.mergedAttrs,M.hostAttrs),my(e,t,n,b,M),Ld(b,M,a),null!==M.contentQueries&&(t.flags|=4),(null!==M.hostBindings||null!==M.hostAttrs||0!==M.hostVars)&&(t.flags|=64);const T=M.type.prototype;!h&&(T.ngOnChanges||T.ngOnInit||T.ngDoCheck)&&((e.preOrderHooks??=[]).push(t.index),h=!0),!f&&(T.ngOnChanges||T.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(t.index),f=!0),b++}!function ES(e,n,t){const a=n.directiveEnd,c=e.data,h=n.attrs,f=[];let b=null,x=null;for(let M=n.directiveStart;M<a;M++){const T=c[M],I=t?t.get(T):null,N=I?I.outputs:null;b=Kl(T.inputs,M,b,I?I.inputs:null),x=Kl(T.outputs,M,x,N);const V=null===b||null===h||ff(n)?null:JP(b,M,h);f.push(V)}null!==b&&(b.hasOwnProperty("class")&&(n.flags|=8),b.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=f,n.inputs=b,n.outputs=x}(e,t,c)}function Fm(e,n,t){const r=t.directiveStart,a=t.directiveEnd,c=t.index,h=function YR(){return _i.lFrame.currentDirectiveIndex}();try{vn(c);for(let f=r;f<a;f++){const b=e.data[f],x=n[f];yd(f),(null!==b.hostBindings||0!==b.hostVars||null!==b.hostAttrs)&&RS(b,x)}}finally{vn(-1),yd(h)}}function RS(e,n){null!==e.hostBindings&&e.hostBindings(1,n)}function ua(e,n,t){n.componentOffset=t,(e.components??=[]).push(n.index)}function Ld(e,n,t){if(t){if(n.exportAs)for(let r=0;r<n.exportAs.length;r++)t[n.exportAs[r]]=e;Da(n)&&(t[""]=e)}}function my(e,n,t,r,a){e.data[r]=a;const c=a.factory||(a.factory=gd(a.type)),h=new vu(c,Da(a),z);e.blueprint[r]=h,t[r]=h,function Vs(e,n,t,r,a){const c=a.hostBindings;if(c){let h=e.hostBindingOpCodes;null===h&&(h=e.hostBindingOpCodes=[]);const f=~n.index;(function _w(e){let n=e.length;for(;n>0;){const t=e[--n];if("number"==typeof t&&t<0)return t}return 0})(h)!=f&&h.push(f),h.push(t,r,c)}}(e,n,r,Rm(e,t,a.hostVars,Oi),a)}function ha(e,n,t,r,a,c){const h=Rs(e,n);!function Bm(e,n,t,r,a,c,h){if(null==c)e.removeAttribute(n,a,t);else{const f=null==h?Yt(c):h(c,r||"",a);e.setAttribute(n,a,f,t)}}(n[Bi],h,c,e.value,t,r,a)}function QP(e,n,t,r,a,c){const h=c[n];if(null!==h)for(let f=0;f<h.length;)LS(r,t,h[f++],h[f++],h[f++])}function LS(e,n,t,r,a){const c=ka(null);try{const h=e.inputTransforms;null!==h&&h.hasOwnProperty(r)&&(a=h[r].call(n,a)),null!==e.setInput?e.setInput(n,a,t,r):n[r]=a}finally{ka(c)}}function JP(e,n,t){let r=null,a=0;for(;a<t.length;){const c=t[a];if(0!==c)if(5!==c){if("number"==typeof c)break;if(e.hasOwnProperty(c)){null===r&&(r=[]);const h=e[c];for(let f=0;f<h.length;f+=2)if(h[f]===n){r.push(c,h[f+1],t[a+1]);break}}a+=2}else a+=2;else a+=4}return r}function ju(e,n,t,r){return[e,!0,!1,n,null,0,r,t,null,null,null]}function Uu(e,n){const t=e.contentQueries;if(null!==t)for(let r=0;r<t.length;r+=2){const c=t[r+1];if(-1!==c){const h=e.data[c];ke(t[r]),h.contentQueries(2,n[c],c)}}}function Nm(e,n){return e[du]?e[J_][Ma]=n:e[du]=n,e[J_]=n,n}function bw(e,n,t){ke(0);const r=ka(null);try{n(e,t)}finally{ka(r)}}function NS(e){return e[cu]||(e[cu]=[])}function py(e){return e.cleanup||(e.cleanup=[])}function zS(e,n,t){return(null===e||Da(e))&&(t=function db(e){for(;Array.isArray(e);){if("object"==typeof e[tb])return e;e=e[_e]}return null}(t[n.index])),t[Bi]}function zm(e,n){const t=e[hd],r=t?t.get(Bs,null):null;r&&r.handleError(n)}function Ql(e,n,t,r,a){for(let c=0;c<t.length;){const h=t[c++],f=t[c++];LS(e.data[h],n[h],r,f,a)}}function Jl(e,n,t){const r=wc(n,e);!function _x(e,n,t){e.setValue(n,t)}(e[Bi],r,t)}function VS(e,n){const t=na(n,e),r=t[Ie];!function fy(e,n){for(let t=n.length;t<e.blueprint.length;t++)n.push(e.blueprint[t])}(r,t);const a=t[_e];null!==a&&null===t[Ka]&&(t[Ka]=Id(a,t[hd])),ug(r,t,t[Xr])}function ug(e,n,t){dm(n);try{const r=e.viewQuery;null!==r&&bw(1,r,t);const a=e.template;null!==a&&Pm(e,n,a,1,t),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Uu(e,n),e.staticViewQueries&&bw(2,e.viewQuery,t);const c=e.components;null!==c&&function tO(e,n){for(let t=0;t<n.length;t++)VS(e,n[t])}(n,c)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{n[Vi]&=-5,cs()}}let yw=(()=>{class e{constructor(){this.all=new Set,this.queue=new Map}create(t,r,a){const c=typeof Zone>"u"?null:Zone.current,h=function z0(e,n,t){const r=Object.create(AD);t&&(r.consumerAllowSignalWrites=!0),r.fn=e,r.schedule=n;const a=h=>{r.cleanupFn=h};return r.ref={notify:()=>DD(r),run:()=>{if(r.dirty=!1,r.hasRun&&!yc(r))return;r.hasRun=!0;const h=_f(r);try{r.cleanupFn(),r.cleanupFn=V0,r.fn(a)}finally{om(r,h)}},cleanup:()=>r.cleanupFn()},r.ref}(t,x=>{this.all.has(x)&&this.queue.set(x,c)},a);let f;this.all.add(h),h.notify();const b=()=>{h.cleanup(),f?.(),this.all.delete(h),this.queue.delete(h)};return f=r?.onDestroy(b),{destroy:b}}flush(){if(0!==this.queue.size)for(const[t,r]of this.queue)this.queue.delete(t),r?r.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#t=this.\u0275prov=Jt({token:e,providedIn:"root",factory:()=>new e})}return e})();function hg(e,n,t){let r=t?e.styles:null,a=t?e.classes:null,c=0;if(null!==n)for(let h=0;h<n.length;h++){const f=n[h];"number"==typeof f?c=f:1==c?a=L_(a,f):2==c&&(r=L_(r,f+": "+n[++h]+";"))}t?e.styles=r:e.stylesWithoutHost=r,t?e.classes=a:e.classesWithoutHost=a}function Vm(e,n,t,r,a=!1){for(;null!==t;){const c=n[t.index];null!==c&&r.push(cr(c)),Vo(c)&&vw(c,r);const h=t.type;if(8&h)Vm(e,n,t.child,r);else if(32&h){const f=Ib(t,n);let b;for(;b=f();)r.push(b)}else if(16&h){const f=Ac(n,t);if(Array.isArray(f))r.push(...f);else{const b=_m(n[Gr]);Vm(b[Ie],b,f,r,!0)}}t=a?t.projectionNext:t.next}return r}function vw(e,n){for(let t=zo;t<e.length;t++){const r=e[t],a=r[Ie].firstChild;null!==a&&Vm(r[Ie],r,a,n)}e[Ll]!==e[_e]&&n.push(e[Ll])}function gy(e,n,t,r=!0){const a=n[Kh],c=a.rendererFactory,h=a.afterRenderEventManager;c.begin?.(),h?.begin();try{jm(e,n,e.template,t)}catch(b){throw r&&zm(n,b),b}finally{c.end?.(),a.effectManager?.flush(),h?.end()}}function jm(e,n,t,r){const a=n[Vi];if(256!=(256&a)){n[Kh].effectManager?.flush(),dm(n);try{ND(n),function zn(e){return _i.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==t&&Pm(e,n,t,2,r);const h=3==(3&a);if(h){const x=e.preOrderCheckHooks;null!==x&&um(n,x,null)}else{const x=e.preOrderHooks;null!==x&&hm(n,x,0,null),kf(n,0)}if(function mg(e){for(let n=Uf(e);null!==n;n=ui(n)){if(!n[eb])continue;const t=n[em];for(let r=0;r<t.length;r++){Ja(t[r])}}}(n),Um(n,2),null!==e.contentQueries&&Uu(e,n),h){const x=e.contentCheckHooks;null!==x&&um(n,x)}else{const x=e.contentHooks;null!==x&&hm(n,x,1),kf(n,1)}!function WP(e,n){const t=e.hostBindingOpCodes;if(null===t)return;const r=ay(n,uu);try{for(let a=0;a<t.length;a++){const c=t[a];if(c<0)vn(~c);else{const h=c,f=t[++a],b=t[++a];$D(f,h),r.dirty=!1;const x=_f(r);try{b(2,n[h])}finally{om(r,x)}}}}finally{null===n[uu]&&Im(n,uu),vn(-1)}}(e,n);const f=e.components;null!==f&&jS(n,f,0);const b=e.viewQuery;if(null!==b&&bw(2,b,r),h){const x=e.viewCheckHooks;null!==x&&um(n,x)}else{const x=e.viewHooks;null!==x&&hm(n,x,2),kf(n,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),n[Vi]&=-73,xf(n)}finally{cs()}}}function Um(e,n){for(let t=Uf(e);null!==t;t=ui(t))for(let r=zo;r<t.length;r++)fg(t[r],n)}function pg(e,n,t){fg(na(n,e),t)}function fg(e,n){if(!function H0(e){return 128==(128&e[Vi])}(e))return;const t=e[Ie],r=e[Vi];if(80&r&&0===n||1024&r||2===n)jm(t,e,t.template,e[Xr]);else if(e[Xh]>0){Um(e,1);const a=t.components;null!==a&&jS(e,a,1)}}function jS(e,n,t){for(let r=0;r<n.length;r++)pg(e,n[r],t)}class gg{get rootNodes(){const n=this._lView,t=n[Ie];return Vm(t,n,t.firstChild,[])}constructor(n,t){this._lView=n,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Xr]}set context(n){this._lView[Xr]=n}get destroyed(){return 256==(256&this._lView[Vi])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[gr];if(Vo(n)){const t=n[8],r=t?t.indexOf(this):-1;r>-1&&(Qi(n,r),Mr(t,r))}this._attachedToViewContainer=!1}bx(this._lView[Ie],this._lView)}onDestroy(n){!function Cc(e,n){if(256==(256&e[Vi]))throw new Rt(911,!1);null===e[Xa]&&(e[Xa]=[]),e[Xa].push(n)}(this._lView,n)}markForCheck(){Od(this._cdRefInjectingView||this._lView)}detach(){this._lView[Vi]&=-129}reattach(){this._lView[Vi]|=128}detectChanges(){gy(this._lView[Ie],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Rt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Lk(e,n){Ri(e,n,n[Bi],2,null,null)}(this._lView[Ie],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Rt(902,!1);this._appRef=n}}class Hm extends gg{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;gy(n[Ie],n,n[Xr],!1)}checkNoChanges(){}get context(){return null}}class _g extends Lc{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const t=yn(n);return new bg(t,this.ngModule)}}function US(e){const n=[];for(let t in e)e.hasOwnProperty(t)&&n.push({propName:e[t],templateName:t});return n}class $S{constructor(n,t){this.injector=n,this.parentInjector=t}get(n,t,r){r=Wa(r);const a=this.injector.get(n,ey,r);return a!==ey||t===ey?a:this.parentInjector.get(n,t,r)}}class bg extends sg{get inputs(){const n=this.componentDef,t=n.inputTransforms,r=US(n.inputs);if(null!==t)for(const a of r)t.hasOwnProperty(a.propName)&&(a.transform=t[a.propName]);return r}get outputs(){return US(this.componentDef.outputs)}constructor(n,t){super(),this.componentDef=n,this.ngModule=t,this.componentType=n.type,this.selector=function kR(e){return e.map(pD).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!t}create(n,t,r,a){let c=(a=a||this.ngModule)instanceof Ko?a:a?.injector;c&&null!==this.componentDef.getStandaloneInjector&&(c=this.componentDef.getStandaloneInjector(c)||c);const h=c?new $S(n,c):n,f=h.get(ag,null);if(null===f)throw new Rt(407,!1);const T={rendererFactory:f,sanitizer:h.get(RP,null),effectManager:h.get(yw,null),afterRenderEventManager:h.get(mw,null)},I=f.createRenderer(null,this.componentDef),L=this.componentDef.selectors[0][0]||"div",N=r?function qP(e,n,t,r){const c=r.get(sy,!1)||t===ea.ShadowDom,h=e.selectRootElement(n,c);return function kS(e){fw(e)}(h),h}(I,r,this.componentDef.encapsulation,h):$f(I,L,function HS(e){const n=e.toLowerCase();return"svg"===n?U0:"math"===n?"math":null}(L)),nt=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let tt=null;null!==N&&(tt=Id(N,h,!0));const _t=cy(0,null,null,1,0,null,null,null,null,null,null),wt=ly(null,_t,null,nt,null,null,T,I,h,null,tt);let Dt,Vt;dm(wt);try{const ae=this.componentDef;let ee,Fe=null;ae.findHostDirectiveDefs?(ee=[],Fe=new Map,ae.findHostDirectiveDefs(ae,ee,Fe),ee.push(ae)):ee=[ae];const Ai=function iO(e,n){const t=e[Ie],r=fn;return e[r]=n,Vu(t,r,2,"#host",null)}(wt,N),Wi=function WS(e,n,t,r,a,c,h){const f=a[Ie];!function nO(e,n,t,r){for(const a of e)n.mergedAttrs=ud(n.mergedAttrs,a.hostAttrs);null!==n.mergedAttrs&&(hg(n,n.mergedAttrs,!0),null!==t&&Dx(r,t,n))}(r,e,n,h);let b=null;null!==n&&(b=Id(n,a[hd]));const x=c.rendererFactory.createRenderer(n,t);let M=16;t.signals?M=4096:t.onPush&&(M=64);const T=ly(a,MS(t),null,M,a[e.index],e,c,x,null,null,b);return f.firstCreatePass&&ua(f,e,r.length-1),Nm(a,T),a[e.index]=T}(Ai,N,ae,ee,wt,T,I);Vt=BD(_t,fn),N&&function rO(e,n,t,r){if(r)pf(e,t,["ng-version",PP.full]);else{const{attrs:a,classes:c}=function Z_(e){const n=[],t=[];let r=1,a=2;for(;r<e.length;){let c=e[r];if("string"==typeof c)2===a?""!==c&&n.push(c,e[++r]):8===a&&t.push(c);else{if(!Za(a))break;a=c}r++}return{attrs:n,classes:t}}(n.selectors[0]);a&&pf(e,t,a),c&&c.length>0&&Mx(e,t,c.join(" "))}}(I,ae,N,r),void 0!==t&&function xw(e,n,t){const r=e.projection=[];for(let a=0;a<n.length;a++){const c=t[a];r.push(null!=c?Array.from(c):null)}}(Vt,this.ngContentSelectors,t),Dt=function _y(e,n,t,r,a,c){const h=mo(),f=a[Ie],b=Rs(h,a);hy(f,a,h,t,null,r);for(let M=0;M<t.length;M++)Yo(wu(a,f,h.directiveStart+M,h),a);Fm(f,a,h),b&&Yo(b,a);const x=wu(a,f,h.directiveStart+h.componentOffset,h);if(e[Xr]=a[Xr]=x,null!==c)for(const M of c)M(x,n);return Fd(f,h,e),x}(Wi,ae,ee,Fe,wt,[qS]),ug(_t,wt,null)}finally{cs()}return new GS(this.componentType,Dt,Tm(Vt,wt),wt,Vt)}}class GS extends Jx{constructor(n,t,r,a,c){super(),this.location=r,this._rootLView=a,this._tNode=c,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Hm(a),this.componentType=n}setInput(n,t){const r=this._tNode.inputs;let a;if(null!==r&&(a=r[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),t))return;const c=this._rootLView;Ql(c[Ie],c,a,n,t),this.previousInputValues.set(n,t),Od(na(this._tNode.index,c))}}get injector(){return new Go(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function qS(){const e=mo();yu(Wt()[Ie],e)}function Xt(e){let n=function yg(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),t=!0;const r=[e];for(;n;){let a;if(Da(e))a=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Rt(903,!1);a=n.\u0275dir}if(a){if(t){r.push(a);const h=e;h.inputs=Gu(e.inputs),h.inputTransforms=Gu(e.inputTransforms),h.declaredInputs=Gu(e.declaredInputs),h.outputs=Gu(e.outputs);const f=a.hostBindings;f&&vy(e,f);const b=a.viewQuery,x=a.contentQueries;if(b&&by(e,b),x&&yy(e,x),ef(e.inputs,a.inputs),ef(e.declaredInputs,a.declaredInputs),ef(e.outputs,a.outputs),null!==a.inputTransforms&&(null===h.inputTransforms&&(h.inputTransforms={}),ef(h.inputTransforms,a.inputTransforms)),Da(a)&&a.data.animation){const M=e.data;M.animation=(M.animation||[]).concat(a.data.animation)}}const c=a.features;if(c)for(let h=0;h<c.length;h++){const f=c[h];f&&f.ngInherit&&f(e),f===Xt&&(t=!1)}}n=Object.getPrototypeOf(n)}!function oO(e){let n=0,t=null;for(let r=e.length-1;r>=0;r--){const a=e[r];a.hostVars=n+=a.hostVars,a.hostAttrs=ud(a.hostAttrs,t=ud(t,a.hostAttrs))}}(r)}function Gu(e){return e===Ya?{}:e===Rn?[]:e}function by(e,n){const t=e.viewQuery;e.viewQuery=t?(r,a)=>{n(r,a),t(r,a)}:n}function yy(e,n){const t=e.contentQueries;e.contentQueries=t?(r,a,c)=>{n(r,a,c),t(r,a,c)}:n}function vy(e,n){const t=e.hostBindings;e.hostBindings=t?(r,a)=>{n(r,a),t(r,a)}:n}function ZS(e){const n=e.inputConfig,t={};for(const r in n)if(n.hasOwnProperty(r)){const a=n[r];Array.isArray(a)&&a[2]&&(t[r]=a[2])}e.inputTransforms=t}function xy(e){return!!Wm(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function Wm(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function bo(e,n,t){return e[n]=t}function br(e,n,t){return!Object.is(e[n],t)&&(e[n]=t,!0)}function Ve(e,n,t,r){const a=Wt();return br(a,Mc(),n)&&(Dn(),ha(Xe(),a,e,n,t,r)),Ve}function tc(e,n,t,r){return br(e,Mc(),t)?n+Yt(t)+r:Oi}function qm(e,n,t,r,a,c){const f=function js(e,n,t,r){const a=br(e,n,t);return br(e,n+1,r)||a}(e,function ro(){return _i.lFrame.bindingIndex}(),t,a);return tl(2),f?n+Yt(t)+r+Yt(a)+c:Oi}function Kt(e,n,t,r,a,c,h,f){const b=Wt(),x=Dn(),M=e+fn,T=x.firstCreatePass?function ul(e,n,t,r,a,c,h,f,b){const x=n.consts,M=Vu(n,e,4,h||null,bd(x,f));uy(n,t,M,bd(x,b)),yu(n,M);const T=M.tView=cy(2,M,r,a,c,n.directiveRegistry,n.pipeRegistry,null,n.schemas,x,null);return null!==n.queries&&(n.queries.template(n,M),T.queries=n.queries.embeddedTView(M)),M}(M,x,b,n,t,r,a,c,h):x.data[M];Ir(T,!1);const I=Dy(x,b,T,e);Sa()&&Eu(x,b,I,T),Yo(I,b),Nm(b,b[M]=ju(I,b,I,T)),ib(T)&&dg(x,b,T),null!=h&&Om(b,T,f)}let Dy=function Jm(e,n,t,r){return ds(!0),n[Bi].createComment("")};function Kr(e){return lm(function W0(){return _i.lFrame.contextLView}(),fn+e)}function It(e,n,t){const r=Wt();return br(r,Mc(),n)&&zs(Dn(),Xe(),r,e,n,r[Bi],t,!1),It}function Ew(e,n,t,r,a){const h=a?"class":"style";Ql(e,t,n.inputs[h],h,r)}function ht(e,n,t,r){const a=Wt(),c=Dn(),h=fn+e,f=a[Bi],b=c.firstCreatePass?function CO(e,n,t,r,a,c){const h=n.consts,b=Vu(n,e,2,r,bd(h,a));return uy(n,t,b,bd(h,c)),null!==b.attrs&&hg(b,b.attrs,!1),null!==b.mergedAttrs&&hg(b,b.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,b),b}(h,c,a,n,t,r):c.data[h],x=Aw(c,a,b,f,n,e);a[h]=x;const M=ib(b);return Ir(b,!0),Dx(f,x,b),32!=(32&b.flags)&&Sa()&&Eu(c,a,x,b),0===function VD(){return _i.lFrame.elementDepthCount}()&&Yo(x,a),function jD(){_i.lFrame.elementDepthCount++}(),M&&(dg(c,a,b),Fd(c,b,a)),null!==r&&Om(a,b),ht}function ft(){let e=mo();zl()?hb():(e=e.parent,Ir(e,!1));const n=e;(function $0(e){return _i.skipHydrationRootTNode===e})(n)&&function UD(){_i.skipHydrationRootTNode=null}(),function cm(){_i.lFrame.elementDepthCount--}();const t=Dn();return t.firstCreatePass&&(yu(t,e),P0(e)&&t.queries.elementEnd(e)),null!=n.classesWithoutHost&&function xu(e){return 0!=(8&e.flags)}(n)&&Ew(t,n,Wt(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function X0(e){return 0!=(16&e.flags)}(n)&&Ew(t,n,Wt(),n.stylesWithoutHost,!1),ft}function je(e,n,t,r){return ht(e,n,t,r),ft(),je}let Aw=(e,n,t,r,a,c)=>(ds(!0),$f(r,a,function pb(){return _i.lFrame.currentNamespace}()));function Eo(e,n,t){const r=Wt(),a=Dn(),c=e+fn,h=a.firstCreatePass?function cT(e,n,t,r,a){const c=n.consts,h=bd(c,r),f=Vu(n,e,8,"ng-container",h);return null!==h&&hg(f,h,!0),uy(n,t,f,bd(c,a)),null!==n.queries&&n.queries.elementStart(n,f),f}(c,a,r,n,t):a.data[c];Ir(h,!0);const f=Iw(a,r,h,e);return r[c]=f,Sa()&&Eu(a,r,f,h),Yo(f,r),ib(h)&&(dg(a,r,h),Fd(a,h,r)),null!=t&&Om(r,h),Eo}function Qr(){let e=mo();const n=Dn();return zl()?hb():(e=e.parent,Ir(e,!1)),n.firstCreatePass&&(yu(n,e),P0(e)&&n.queries.elementEnd(e)),Qr}function yo(e,n,t){return Eo(e,n,t),Qr(),yo}let Iw=(e,n,t,r)=>(ds(!0),Pb(n[Bi],""));function vo(){return Wt()}function Mg(e){return!!e&&"function"==typeof e.then}function Dg(e){return!!e&&"function"==typeof e.subscribe}function Se(e,n,t,r){const a=Wt(),c=Dn(),h=mo();return Rw(c,a,a[Bi],h,e,n,r),Se}function kg(e,n){const t=mo(),r=Wt(),a=Dn();return Rw(a,r,zS(_u(a.data),t,r),t,e,n),kg}function Rw(e,n,t,r,a,c,h){const f=ib(r),x=e.firstCreatePass&&py(e),M=n[Xr],T=NS(n);let I=!0;if(3&r.type||h){const V=Rs(r,n),$=h?h(V):V,nt=T.length,tt=h?wt=>h(cr(wt[r.index])):r.index;let _t=null;if(!h&&f&&(_t=function hl(e,n,t,r){const a=e.cleanup;if(null!=a)for(let c=0;c<a.length-1;c+=2){const h=a[c];if(h===t&&a[c+1]===r){const f=n[cu],b=a[c+2];return f.length>b?f[b]:null}"string"==typeof h&&(c+=2)}return null}(e,n,a,r.index)),null!==_t)(_t.__ngLastListenerFn__||_t).__ngNextListenerFn__=c,_t.__ngLastListenerFn__=c,I=!1;else{c=hT(r,n,M,c,!1);const wt=t.listen($,a,c);T.push(c,wt),x&&x.push(a,tt,nt,nt+1)}}else c=hT(r,n,M,c,!1);const L=r.outputs;let N;if(I&&null!==L&&(N=L[a])){const V=N.length;if(V)for(let $=0;$<V;$+=2){const Dt=n[N[$]][N[$+1]].subscribe(c),Vt=T.length;T.push(c,Dt),x&&x.push(a,r.index,Vt,-(Vt+1))}}}function uT(e,n,t,r){try{return Qa(6,n,t),!1!==t(r)}catch(a){return zm(e,a),!1}finally{Qa(7,n,t)}}function hT(e,n,t,r,a){return function c(h){if(h===Function)return r;Od(e.componentOffset>-1?na(e.index,n):n);let b=uT(n,t,r,h),x=c.__ngNextListenerFn__;for(;x;)b=uT(n,t,x,h)&&b,x=x.__ngNextListenerFn__;return a&&!1===b&&h.preventDefault(),b}}function Ne(e=1){return function ZR(e){return(_i.lFrame.contextLView=function XR(e,n){for(;e>0;)n=n[md],e--;return n}(e,_i.lFrame.contextLView))[Xr]}(e)}function mT(e,n){let t=null;const r=function S0(e){const n=e.attrs;if(null!=n){const t=n.indexOf(5);if(!(1&t))return n[t+1]}return null}(e);for(let a=0;a<n.length;a++){const c=n[a];if("*"!==c){if(null===r?k0(e,c,!0):DR(r,c))return a}else t=a}return t}function xn(e){const n=Wt()[Gr][Zr];if(!n.projection){const r=n.projection=pm(e?e.length:1,null),a=r.slice();let c=n.child;for(;null!==c;){const h=e?mT(c,e):0;null!==h&&(a[h]?a[h].projectionNext=c:r[h]=c,a[h]=c),c=c.next}}}function Oe(e,n=0,t){const r=Wt(),a=Dn(),c=Vu(a,fn+e,16,null,t||null);null===c.projection&&(c.projection=n),hb(),(!r[Ka]||ue())&&32!=(32&c.flags)&&function Wf(e,n,t){wx(n[Bi],0,n,t,vx(e,t,n),Z(t.parent||n[Zr],t,n))}(a,r,c)}function Sy(e,n,t){return tp(e,"",n,"",t),Sy}function tp(e,n,t,r,a){const c=Wt(),h=tc(c,n,t,r);return h!==Oi&&zs(Dn(),Xe(),c,e,h,c[Bi],a,!1),tp}function ec(e,n){return e<<17|n<<2}function Bd(e){return e>>17&32767}function Nw(e){return 2|e}function Nc(e){return(131068&e)>>2}function ep(e,n){return-131069&e|n<<2}function Ay(e){return 1|e}function Iy(e,n,t,r,a){const c=e[t+1],h=null===n;let f=r?Bd(c):Nc(c),b=!1;for(;0!==f&&(!1===b||h);){const M=e[f+1];Qu(e[f],n)&&(b=!0,e[f+1]=r?Ay(M):Nw(M)),f=r?Bd(M):Nc(M)}b&&(e[t+1]=r?Nw(c):Ay(c))}function Qu(e,n){return null===e||null==n||(Array.isArray(e)?e[1]:e)===n||!(!Array.isArray(e)||"string"!=typeof n)&&Du(e,n)>=0}const ao={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function zw(e){return e.substring(ao.key,ao.keyEnd)}function ip(e,n){const t=ao.textEnd;return t===n?-1:(n=ao.keyEnd=function yT(e,n,t){for(;n<t&&e.charCodeAt(n)>32;)n++;return n}(e,ao.key=n,t),zc(e,n,t))}function zc(e,n,t){for(;n<t&&e.charCodeAt(n)<=32;)n++;return n}function pa(e,n,t){return lo(e,n,t,!1),pa}function Qe(e,n){return lo(e,n,null,!0),Qe}function ml(e,n){for(let t=function gT(e){return function bT(e){ao.key=0,ao.keyEnd=0,ao.value=0,ao.valueEnd=0,ao.textEnd=e.length}(e),ip(e,zc(e,0,ao.textEnd))}(n);t>=0;t=ip(n,t))us(e,zw(n),!0)}function lo(e,n,t,r){const a=Wt(),c=Dn(),h=tl(2);c.firstUpdatePass&&np(c,e,h,r),n!==Oi&&br(a,h,n)&&Hw(c,c.data[To()],a,a[Bi],e,a[h+1]=function ST(e,n){return null==e||""===e||("string"==typeof n?e+=n:"object"==typeof e&&(e=io(Xo(e)))),e}(n,t),r,h)}function Eg(e,n){return n>=e.expandoStartIndex}function np(e,n,t,r){const a=e.data;if(null===a[t+1]){const c=a[To()],h=Eg(e,t);$w(c,r)&&null===n&&!h&&(n=!1),n=function xT(e,n,t,r){const a=_u(e);let c=r?n.residualClasses:n.residualStyles;if(null===a)0===(r?n.classBindings:n.styleBindings)&&(t=Ag(t=Uw(null,e,n,t,r),n.attrs,r),c=null);else{const h=n.directiveStylingLast;if(-1===h||e[h]!==a)if(t=Uw(a,e,n,t,r),null===c){let b=function wT(e,n,t){const r=t?n.classBindings:n.styleBindings;if(0!==Nc(r))return e[Bd(r)]}(e,n,r);void 0!==b&&Array.isArray(b)&&(b=Uw(null,e,n,b[1],r),b=Ag(b,n.attrs,r),function CT(e,n,t,r){e[Bd(t?n.classBindings:n.styleBindings)]=r}(e,n,r,b))}else c=function MT(e,n,t){let r;const a=n.directiveEnd;for(let c=1+n.directiveStylingLast;c<a;c++)r=Ag(r,e[c].hostAttrs,t);return Ag(r,n.attrs,t)}(e,n,r)}return void 0!==c&&(r?n.residualClasses=c:n.residualStyles=c),t}(a,c,n,r),function kO(e,n,t,r,a,c){let h=c?n.classBindings:n.styleBindings,f=Bd(h),b=Nc(h);e[r]=t;let M,x=!1;if(Array.isArray(t)?(M=t[1],(null===M||Du(t,M)>0)&&(x=!0)):M=t,a)if(0!==b){const I=Bd(e[f+1]);e[r+1]=ec(I,f),0!==I&&(e[I+1]=ep(e[I+1],r)),e[f+1]=function Tg(e,n){return 131071&e|n<<17}(e[f+1],r)}else e[r+1]=ec(f,0),0!==f&&(e[f+1]=ep(e[f+1],r)),f=r;else e[r+1]=ec(b,0),0===f?f=r:e[b+1]=ep(e[b+1],r),b=r;x&&(e[r+1]=Nw(e[r+1])),Iy(e,M,r,!0),Iy(e,M,r,!1),function SO(e,n,t,r,a){const c=a?e.residualClasses:e.residualStyles;null!=c&&"string"==typeof n&&Du(c,n)>=0&&(t[r+1]=Ay(t[r+1]))}(n,M,e,r,c),h=ec(f,b),c?n.classBindings=h:n.styleBindings=h}(a,c,n,t,h,r)}}function Uw(e,n,t,r,a){let c=null;const h=t.directiveEnd;let f=t.directiveStylingLast;for(-1===f?f=t.directiveStart:f++;f<h&&(c=n[f],r=Ag(r,c.hostAttrs,a),c!==e);)f++;return null!==e&&(t.directiveStylingLast=f),r}function Ag(e,n,t){const r=t?1:2;let a=-1;if(null!==n)for(let c=0;c<n.length;c++){const h=n[c];"number"==typeof h?a=h:a===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),us(e,h,!!t||n[++c]))}return void 0===e?null:e}function Hw(e,n,t,r,a,c,h,f){if(!(3&n.type))return;const b=e.data,x=b[f+1],M=function Ey(e){return 1==(1&e)}(x)?Ry(b,n,t,a,Nc(x),h):void 0;Ig(M)||(Ig(c)||function pT(e){return 2==(2&e)}(x)&&(c=Ry(b,null,t,a,f,h)),function Cx(e,n,t,r,a){if(n)a?e.addClass(t,r):e.removeClass(t,r);else{let c=-1===r.indexOf("-")?void 0:ol.DashCase;null==a?e.removeStyle(t,r,c):("string"==typeof a&&a.endsWith("!important")&&(a=a.slice(0,-10),c|=ol.Important),e.setStyle(t,r,a,c))}}(r,h,wc(To(),t),a,c))}function Ry(e,n,t,r,a,c){const h=null===n;let f;for(;a>0;){const b=e[a],x=Array.isArray(b),M=x?b[1]:b,T=null===M;let I=t[a+1];I===Oi&&(I=T?Rn:void 0);let L=T?Ul(I,r):M===r?I:void 0;if(x&&!Ig(L)&&(L=Ul(b,r)),Ig(L)&&(f=L,h))return f;const N=e[a+1];a=h?Bd(N):Nc(N)}if(null!==n){let b=c?n.residualClasses:n.residualStyles;null!=b&&(f=Ul(b,r))}return f}function Ig(e){return void 0!==e}function $w(e,n){return 0!=(e.flags&(n?8:16))}function be(e,n=""){const t=Wt(),r=Dn(),a=e+fn,c=r.firstCreatePass?Vu(r,a,1,n,null):r.data[a],h=Gw(r,t,c,n,e);t[a]=h,Sa()&&Eu(r,t,h,c),Ir(c,!1)}let Gw=(e,n,t,r,a)=>(ds(!0),function Hf(e,n){return e.createText(n)}(n[Bi],r));function _s(e){return Ln("",e,""),_s}function Ln(e,n,t){const r=Wt(),a=tc(r,e,n,t);return a!==Oi&&Jl(r,To(),a),Ln}function Ju(e,n,t,r,a){const c=Wt(),h=qm(c,e,n,t,r,a);return h!==Oi&&Jl(c,To(),h),Ju}function Xw(e,n,t){!function gs(e,n,t,r){const a=Dn(),c=tl(2);a.firstUpdatePass&&np(a,null,c,r);const h=Wt();if(t!==Oi&&br(h,c,t)){const f=a.data[To()];if($w(f,r)&&!Eg(a,c)){let b=r?f.classesWithoutHost:f.stylesWithoutHost;null!==b&&(t=L_(b,t||"")),Ew(a,f,h,t,r)}else!function PO(e,n,t,r,a,c,h,f){a===Oi&&(a=Rn);let b=0,x=0,M=0<a.length?a[0]:null,T=0<c.length?c[0]:null;for(;null!==M||null!==T;){const I=b<a.length?a[b+1]:void 0,L=x<c.length?c[x+1]:void 0;let V,N=null;M===T?(b+=2,x+=2,I!==L&&(N=T,V=L)):null===T||null!==M&&M<T?(b+=2,N=M):(x+=2,N=T,V=L),null!==N&&Hw(e,n,t,r,N,V,h,f),M=b<a.length?a[b]:null,T=x<c.length?c[x]:null}}(a,f,h,h[Bi],h[c+1],h[c+1]=function DT(e,n,t){if(null==t||""===t)return Rn;const r=[],a=Xo(t);if(Array.isArray(a))for(let c=0;c<a.length;c++)e(r,a[c],!0);else if("object"==typeof a)for(const c in a)a.hasOwnProperty(c)&&e(r,c,a[c]);else"string"==typeof a&&n(r,a);return r}(e,n,t),r,c)}}(us,ml,tc(Wt(),e,n,t),!0)}function Ao(e,n,t){const r=Wt();return br(r,Mc(),n)&&zs(Dn(),Xe(),r,e,n,r[Bi],t,!0),Ao}function Rg(e,n,t){const r=Wt();if(br(r,Mc(),n)){const c=Dn(),h=Xe();zs(c,h,r,e,n,zS(_u(c.data),h,r),t,!0)}return Rg}const zd=void 0;var GO=["en",[["a","p"],["AM","PM"],zd],[["AM","PM"],zd,zd],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],zd,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],zd,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",zd,"{1} 'at' {0}",zd],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function jT(e){const t=Math.floor(Math.abs(e)),r=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===r?1:5}];let op={};function bs(e){const n=function n1(e){return e.toLowerCase().replace(/_/g,"-")}(e);let t=e1(n);if(t)return t;const r=n.split("-")[0];if(t=e1(r),t)return t;if("en"===r)return GO;throw new Rt(701,!1)}function e1(e){return e in op||(op[e]=zi.ng&&zi.ng.common&&zi.ng.common.locales&&zi.ng.common.locales[e]),op[e]}var ur=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}(ur||{});const th="en-US";let UT=th;function jy(e,n,t,r,a){if(e=Mi(e),Array.isArray(e))for(let c=0;c<e.length;c++)jy(e[c],n,t,r,a);else{const c=Dn(),h=Wt(),f=mo();let b=Td(e)?e:Mi(e.provide);const x=Jk(e),M=1048575&f.providerIndexes,T=f.directiveStart,I=f.providerIndexes>>20;if(Td(e)||!e.multi){const L=new vu(x,a,z),N=C1(b,n,a?M:M+I,T);-1===N?(ex(Af(f,h),c,b),up(c,e,n.length),n.push(b),f.directiveStart++,f.directiveEnd++,a&&(f.providerIndexes+=1048576),t.push(L),h.push(L)):(t[N]=L,h[N]=L)}else{const L=C1(b,n,M+I,T),N=C1(b,n,M,M+I),$=N>=0&&t[N];if(a&&!$||!a&&!(L>=0&&t[L])){ex(Af(f,h),c,b);const nt=function aE(e,n,t,r,a){const c=new vu(e,t,z);return c.multi=[],c.index=n,c.componentProviders=0,oE(c,a,r&&!t),c}(a?Uy:sE,t.length,a,r,x);!a&&$&&(t[N].providerFactory=nt),up(c,e,n.length,0),n.push(b),f.directiveStart++,f.directiveEnd++,a&&(f.providerIndexes+=1048576),t.push(nt),h.push(nt)}else up(c,e,L>-1?L:N,oE(t[a?N:L],x,!a&&r));!a&&r&&$&&t[N].componentProviders++}}}function up(e,n,t,r){const a=Td(n),c=function Ed(e){return!!e.useClass}(n);if(a||c){const b=(c?Mi(n.useClass):n).prototype.ngOnDestroy;if(b){const x=e.destroyHooks||(e.destroyHooks=[]);if(!a&&n.multi){const M=x.indexOf(t);-1===M?x.push(t,[r,b]):x[M+1].push(r,b)}else x.push(t,b)}}}function oE(e,n,t){return t&&e.componentProviders++,e.multi.push(n)-1}function C1(e,n,t,r){for(let a=t;a<r;a++)if(n[a]===e)return a;return-1}function sE(e,n,t,r){return Hg(this.multi,[])}function Uy(e,n,t,r){const a=this.multi;let c;if(this.providerFactory){const h=this.providerFactory.componentProviders,f=wu(t,t[Ie],this.providerFactory.index,r);c=f.slice(0,h),Hg(a,c);for(let b=h;b<f.length;b++)c.push(f[b])}else c=[],Hg(a,c);return c}function Hg(e,n){for(let t=0;t<e.length;t++)n.push((0,e[t])());return n}function Te(e,n=[]){return t=>{t.providersResolver=(r,a)=>function _F(e,n,t){const r=Dn();if(r.firstCreatePass){const a=Da(e);jy(t,r.data,r.blueprint,a,!0),jy(n,r.data,r.blueprint,a,!1)}}(r,a?a(e):e,n)}}class jc{}class M1{}class k1 extends jc{constructor(n,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new _g(this);const a=ls(n);this._bootstrapComponents=Zl(a.bootstrap),this._r3Injector=sw(n,t,[{provide:jc,useValue:this},{provide:Lc,useValue:this.componentFactoryResolver},...r],io(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class S1 extends M1{constructor(n){super(),this.moduleType=n}create(n){return new k1(this.moduleType,n,[])}}class T1 extends jc{constructor(n){super(),this.componentFactoryResolver=new _g(this),this.instance=null;const t=new Iu([...n.providers,{provide:jc,useValue:this},{provide:Lc,useValue:this.componentFactoryResolver}],n.parent||Oc(),n.debugName,new Set(["environment"]));this.injector=t,n.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function Hy(e,n,t=null){return new T1({providers:e,parent:n,debugName:t,runEnvironmentInitializers:!0}).injector}let lE=(()=>{class e{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const r=Hb(0,t.type),a=r.length>0?Hy([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,a)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#t=this.\u0275prov=Jt({token:e,providedIn:"environment",factory:()=>new e(vt(Ko))})}return e})();function E1(e){e.getStandaloneInjector=n=>n.get(lE).getOrCreateStandaloneInjector(e)}function _E(e,n,t,r,a,c){const h=n+t;return br(e,h,a)?bo(e,h+1,c?r.call(c,a):r(a)):function pp(e,n){const t=e[n];return t===Oi?void 0:t}(e,h+1)}function wE(e,n,t){const r=e+fn,a=Wt(),c=lm(a,r);return function fp(e,n){return e[Ie].data[n].pure}(a,r)?_E(a,$o(),n,c.transform,t,c):c.transform(t)}function TF(){return this._results[Symbol.iterator]()}class oh{static#t=Symbol.iterator;get changes(){return this._changes||(this._changes=new me)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=oh.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=TF)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,t){return this._results.reduce(n,t)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,t){const r=this;r.dirty=!1;const a=function oa(e){return e.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function tP(e,n,t){if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++){let a=e[r],c=n[r];if(t&&(a=t(a),c=t(c)),c!==a)return!1}return!0}(r._results,a,t))&&(r._results=a,r.length=a.length,r.last=a[this.length-1],r.first=a[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function IF(e,n,t,r=!0){const a=n[Ie];if(function Nk(e,n,t,r){const a=zo+r,c=t.length;r>0&&(t[a-1][Ma]=n),r<c-zo?(n[Ma]=t[a],Wr(t,zo+r,n)):(t.push(n),n[Ma]=null),n[gr]=t;const h=n[Qh];null!==h&&t!==h&&function uP(e,n){const t=e[em];n[Gr]!==n[gr][gr][Gr]&&(e[eb]=!0),null===t?e[em]=[n]:t.push(n)}(h,n);const f=n[Ts];null!==f&&f.insertView(e),n[Vi]|=128}(a,n,e,t),r){const c=Lb(t,e),h=n[Bi],f=Fb(h,e[Ll]);null!==f&&function Fk(e,n,t,r,a,c){r[_e]=a,r[Zr]=n,Ri(e,r,t,1,a,c)}(a,e[Zr],h,n,f,c)}}let Jr=(()=>{class e{static#t=this.__NG_ELEMENT_ID__=OF}return e})();const RF=Jr,PF=class extends RF{constructor(n,t,r){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,t){return this.createEmbeddedViewImpl(n,t)}createEmbeddedViewImpl(n,t,r){const a=function EF(e,n,t,r){const a=n.tView,f=ly(e,a,t,4096&e[Vi]?4096:16,null,n,null,null,null,r?.injector??null,r?.hydrationInfo??null);f[Qh]=e[n.index];const x=e[Ts];return null!==x&&(f[Ts]=x.createEmbeddedView(a)),ug(a,f,t),f}(this._declarationLView,this._declarationTContainer,n,{injector:t,hydrationInfo:r});return new gg(a)}};function OF(){return $g(mo(),Wt())}function $g(e,n){return 4&e.type?new PF(n,e,Tm(e,n)):null}let hr=(()=>{class e{static#t=this.__NG_ELEMENT_ID__=AE}return e})();function AE(){return j1(mo(),Wt())}const IE=hr,RE=class extends IE{constructor(n,t,r){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=r}get element(){return Tm(this._hostTNode,this._hostLView)}get injector(){return new Go(this._hostTNode,this._hostLView)}get parentInjector(){const n=If(this._hostTNode,this._hostLView);if(kc(n)){const t=xd(n,this._hostLView),r=Sc(n);return new Go(t[Ie].data[r+8],t)}return new Go(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const t=PE(this._lContainer);return null!==t&&t[n]||null}get length(){return this._lContainer.length-zo}createEmbeddedView(n,t,r){let a,c;"number"==typeof r?a=r:null!=r&&(a=r.index,c=r.injector);const f=n.createEmbeddedViewImpl(t||{},c,null);return this.insertImpl(f,a,false),f}createComponent(n,t,r,a,c){const h=n&&!function Ff(e){return"function"==typeof e}(n);let f;if(h)f=t;else{const V=t||{};f=V.index,r=V.injector,a=V.projectableNodes,c=V.environmentInjector||V.ngModuleRef}const b=h?n:new bg(yn(n)),x=r||this.parentInjector;if(!c&&null==b.ngModule){const $=(h?x:this.parentInjector).get(Ko,null);$&&(c=$)}yn(b.componentType??{});const L=b.create(x,a,null,c);return this.insertImpl(L.hostView,f,false),L}insert(n,t){return this.insertImpl(n,t,!1)}insertImpl(n,t,r){const a=n._lView;if(function GR(e){return Vo(e[gr])}(a)){const b=this.indexOf(n);if(-1!==b)this.detach(b);else{const x=a[gr],M=new RE(x,x[Zr],x[gr]);M.detach(M.indexOf(n))}}const h=this._adjustIndex(t),f=this._lContainer;return IF(f,a,h,!r),n.attachToViewContainerRef(),Wr(V1(f),h,n),n}move(n,t){return this.insert(n,t)}indexOf(n){const t=PE(this._lContainer);return null!==t?t.indexOf(n):-1}remove(n){const t=this._adjustIndex(n,-1),r=Qi(this._lContainer,t);r&&(Mr(V1(this._lContainer),t),bx(r[Ie],r))}detach(n){const t=this._adjustIndex(n,-1),r=Qi(this._lContainer,t);return r&&null!=Mr(V1(this._lContainer),t)?new gg(r):null}_adjustIndex(n,t=0){return n??this.length+t}};function PE(e){return e[8]}function V1(e){return e[8]||(e[8]=[])}function j1(e,n){let t;const r=n[e.index];return Vo(r)?t=r:(t=ju(r,n,null,e),n[e.index]=t,Nm(n,t)),H1(t,n,e,r),new RE(t,e,n)}let H1=function Gg(e,n,t,r){if(e[Ll])return;let a;a=8&t.type?cr(r):function U1(e,n){const t=e[Bi],r=t.createComment(""),a=Rs(n,e);return Tu(t,Fb(t,a),r,function mP(e,n){return e.nextSibling(n)}(t,a),!1),r}(n,t),e[Ll]=a};class $1{constructor(n){this.queryList=n,this.matches=null}clone(){return new $1(this.queryList)}setDirty(){this.queryList.setDirty()}}class G1{constructor(n=[]){this.queries=n}createEmbeddedView(n){const t=n.queries;if(null!==t){const r=null!==n.contentQueries?n.contentQueries[0]:t.length,a=[];for(let c=0;c<r;c++){const h=t.getByIndex(c);a.push(this.queries[h.indexInDeclarationView].clone())}return new G1(a)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let t=0;t<this.queries.length;t++)null!==LE(n,t).matches&&this.queries[t].setDirty()}}class OE{constructor(n,t,r=null){this.predicate=n,this.flags=t,this.read=r}}class W1{constructor(n=[]){this.queries=n}elementStart(n,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(n,t)}elementEnd(n){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(n)}embeddedTView(n){let t=null;for(let r=0;r<this.length;r++){const a=null!==t?t.length:0,c=this.getByIndex(r).embeddedTView(n,a);c&&(c.indexInDeclarationView=r,null!==t?t.push(c):t=[c])}return null!==t?new W1(t):null}template(n,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(n,t)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class q1{constructor(n,t=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(n,t){this.isApplyingToNode(t)&&this.matchTNode(n,t)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,t){this.elementStart(n,t)}embeddedTView(n,t){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,t),new q1(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let r=n.parent;for(;null!==r&&8&r.type&&r.index!==t;)r=r.parent;return t===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(n,t){const r=this.metadata.predicate;if(Array.isArray(r))for(let a=0;a<r.length;a++){const c=r[a];this.matchTNodeWithReadOption(n,t,BF(t,c)),this.matchTNodeWithReadOption(n,t,Rf(t,n,c,!1,!1))}else r===Jr?4&t.type&&this.matchTNodeWithReadOption(n,t,-1):this.matchTNodeWithReadOption(n,t,Rf(t,n,r,!1,!1))}matchTNodeWithReadOption(n,t,r){if(null!==r){const a=this.metadata.read;if(null!==a)if(a===Me||a===hr||a===Jr&&4&t.type)this.addMatch(t.index,-2);else{const c=Rf(t,n,a,!1,!1);null!==c&&this.addMatch(t.index,c)}else this.addMatch(t.index,r)}}addMatch(n,t){null===this.matches?this.matches=[n,t]:this.matches.push(n,t)}}function BF(e,n){const t=e.localNames;if(null!==t)for(let r=0;r<t.length;r+=2)if(t[r]===n)return t[r+1];return null}function zF(e,n,t,r){return-1===t?function NF(e,n){return 11&e.type?Tm(e,n):4&e.type?$g(e,n):null}(n,e):-2===t?function VF(e,n,t){return t===Me?Tm(n,e):t===Jr?$g(n,e):t===hr?j1(n,e):void 0}(e,n,r):wu(e,e[Ie],t,n)}function FE(e,n,t,r){const a=n[Ts].queries[r];if(null===a.matches){const c=e.data,h=t.matches,f=[];for(let b=0;b<h.length;b+=2){const x=h[b];f.push(x<0?null:zF(n,c[x],h[b+1],t.metadata.read))}a.matches=f}return a.matches}function Y1(e,n,t,r){const a=e.queries.getByIndex(t),c=a.matches;if(null!==c){const h=FE(e,n,a,t);for(let f=0;f<c.length;f+=2){const b=c[f];if(b>0)r.push(h[f/2]);else{const x=c[f+1],M=n[-b];for(let T=zo;T<M.length;T++){const I=M[T];I[Qh]===I[gr]&&Y1(I[Ie],I,x,r)}if(null!==M[em]){const T=M[em];for(let I=0;I<T.length;I++){const L=T[I];Y1(L[Ie],L,x,r)}}}}}return r}function pe(e){const n=Wt(),t=Dn(),r=Ft();ke(r+1);const a=LE(t,r);if(e.dirty&&function $R(e){return 4==(4&e[Vi])}(n)===(2==(2&a.metadata.flags))){if(null===a.matches)e.reset([]);else{const c=a.crossesNgTemplate?Y1(t,n,r,[]):FE(t,n,a,r);e.reset(c,AP),e.notifyOnChanges()}return!0}return!1}function Hi(e,n,t){const r=Dn();r.firstCreatePass&&(Z1(r,new OE(e,n,t),-1),2==(2&n)&&(r.staticViewQueries=!0)),Uc(r,Wt(),n)}function Fi(e,n,t,r){const a=Dn();if(a.firstCreatePass){const c=mo();Z1(a,new OE(n,t,r),c.index),function _p(e,n){const t=e.contentQueries||(e.contentQueries=[]);n!==(t.length?t[t.length-1]:-1)&&t.push(e.queries.length-1,n)}(a,e),2==(2&t)&&(a.staticContentQueries=!0)}Uc(a,Wt(),t)}function fe(){return function jF(e,n){return e[Ts].queries[n].queryList}(Wt(),Ft())}function Uc(e,n,t){const r=new oh(4==(4&t));(function YP(e,n,t,r){const a=NS(n);a.push(t),e.firstCreatePass&&py(e).push(r,a.length-1)})(e,n,r,r.destroy),null===n[Ts]&&(n[Ts]=new G1),n[Ts].queries.push(new $1(r))}function Z1(e,n,t){null===e.queries&&(e.queries=new W1),e.queries.track(new q1(n,t))}function LE(e,n){return e.queries.getByIndex(n)}function bp(e,n){return $g(e,n)}const oC=new kt("Application Initializer");let iv=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=oe(oC,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const a of this.appInits){const c=a();if(Mg(c))t.push(c);else if(Dg(c)){const h=new Promise((f,b)=>{c.subscribe({complete:f,error:b})});t.push(h)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(a=>{this.reject(a)}),0===t.length&&r(),this.initialized=!0}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),eA=(()=>{class e{log(t){console.log(t)}warn(t){console.warn(t)}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();const rc=new kt("LocaleId",{providedIn:"root",factory:()=>oe(rc,hn.Optional|hn.SkipSelf)||function sC(){return typeof $localize<"u"&&$localize.locale||th}()});let nv=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Yr(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class rL{constructor(n,t){this.ngModuleFactory=n,this.componentFactories=t}}let nA=(()=>{class e{compileModuleSync(t){return new S1(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const r=this.compileModuleSync(t),c=Zl(ls(t).declarations).reduce((h,f)=>{const b=yn(f);return b&&h.push(new bg(b)),h},[]);return new rL(r,c)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const s=new kt(""),l=new kt("");let p,d=(()=>{class e{constructor(t,r,a){this._ngZone=t,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,p||(function m(e){p=e}(a),a.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Re.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(t)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,a){let c=-1;r&&r>0&&(c=setTimeout(()=>{this._callbacks=this._callbacks.filter(h=>h.timeoutId!==c),t(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:t,timeoutId:c,updateCb:a})}whenStable(t,r,a){if(a&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,a),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,a){return[]}static#t=this.\u0275fac=function(r){return new(r||e)(vt(Re),vt(u),vt(l))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})(),u=(()=>{class e{constructor(){this._applications=new Map}registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return p?.findTestabilityInTree(this,t,r)??null}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),g=null;const _=new kt("AllowMultipleToken"),y=new kt("PlatformDestroyListeners"),v=new kt("appBootstrapListener");class S{constructor(n,t){this.name=n,this.token=t}}function R(e,n,t=[]){const r=`Platform: ${n}`,a=new kt(r);return(c=[])=>{let h=U();if(!h||h.injector.get(_,!1)){const f=[...t,...c,{provide:a,useValue:!0}];e?e(f):function E(e){if(g&&!g.get(_,!1))throw new Rt(400,!1);(function D(){!function SD(e){ab=e}(()=>{throw new Rt(600,!1)})})(),g=e;const n=e.get(H);(function P(e){e.get(Gx,null)?.forEach(t=>t())})(e)}(function B(e=[],n){return oo.create({name:n,providers:[{provide:Wb,useValue:"platform"},{provide:y,useValue:new Set([()=>g=null])},...e]})}(f,r))}return function F(e){const n=U();if(!n)throw new Rt(401,!1);return n}()}}function U(){return g?.get(H)??null}let H=(()=>{class e{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,r){const a=function q(e="zone.js",n){return"noop"===e?new ry:"zone.js"===e?new Re(n):e}(r?.ngZone,function W(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return a.run(()=>{const c=function bF(e,n,t){return new k1(e,n,t)}(t.moduleType,this.injector,function ut(e){return[{provide:Re,useFactory:e},{provide:wm,multi:!0,useFactory:()=>{const n=oe(dt,{optional:!0});return()=>n.initialize()}},{provide:J,useFactory:et},{provide:hS,useFactory:uw}]}(()=>a)),h=c.injector.get(Bs,null);return a.runOutsideAngular(()=>{const f=a.onError.subscribe({next:b=>{h.handleError(b)}});c.onDestroy(()=>{it(this._modules,c),f.unsubscribe()})}),function X(e,n,t){try{const r=t();return Mg(r)?r.catch(a=>{throw n.runOutsideAngular(()=>e.handleError(a)),a}):r}catch(r){throw n.runOutsideAngular(()=>e.handleError(r)),r}}(h,a,()=>{const f=c.injector.get(iv);return f.runInitializers(),f.donePromise.then(()=>(function Oy(e){os(e,"Expected localeId to be defined"),"string"==typeof e&&(UT=e.toLowerCase().replace(/_/g,"-"))}(c.injector.get(rc,th)||th),this._moduleDoBootstrap(c),c))})})}bootstrapModule(t,r=[]){const a=G({},r);return function w(e,n,t){const r=new S1(t);return Promise.resolve(r)}(0,0,t).then(c=>this.bootstrapModuleFactory(c,a))}_moduleDoBootstrap(t){const r=t.injector.get(Q);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(a=>r.bootstrap(a));else{if(!t.instance.ngDoBootstrap)throw new Rt(-403,!1);t.instance.ngDoBootstrap(r)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Rt(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const t=this._injector.get(y,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#t=this.\u0275fac=function(r){return new(r||e)(vt(oo))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function G(e,n){return Array.isArray(n)?n.reduce(G,e):{...e,...n}}let Q=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=oe(J),this.zoneIsStable=oe(hS),this.componentTypes=[],this.components=[],this.isStable=oe(nv).hasPendingTasks.pipe(Ci(t=>t?Le(!1):this.zoneIsStable),wa(),tf()),this._injector=oe(Ko)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,r){const a=t instanceof sg;if(!this._injector.get(iv).done)throw!a&&function au(e){const n=yn(e)||$r(e)||No(e);return null!==n&&n.standalone}(t),new Rt(405,!1);let h;h=a?t:this._injector.get(Lc).resolveComponentFactory(t),this.componentTypes.push(h.componentType);const f=function k(e){return e.isBoundToModule}(h)?void 0:this._injector.get(jc),x=h.create(oo.NULL,[],r||h.selector,f),M=x.location.nativeElement,T=x.injector.get(s,null);return T?.registerApplication(M),x.onDestroy(()=>{this.detachView(x.hostView),it(this.components,x),T?.unregisterApplication(M)}),this._loadComponent(x),x}tick(){if(this._runningTick)throw new Rt(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){const r=t;it(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const r=this._injector.get(v,[]);r.push(...this._bootstrapListeners),r.forEach(a=>a(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>it(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Rt(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function it(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}const J=new kt("",{providedIn:"root",factory:()=>oe(Bs).handleError.bind(void 0)});function et(){const e=oe(Re),n=oe(Bs);return t=>e.runOutsideAngular(()=>n.handleError(t))}let dt=(()=>{class e{constructor(){this.zone=oe(Re),this.applicationRef=oe(Q)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();let Et=(()=>{class e{static#t=this.__NG_ELEMENT_ID__=te}return e})();function te(e){return function ie(e,n,t){if(Bl(e)&&!t){const r=na(e.index,n);return new gg(r,r)}return 47&e.type?new gg(n[Gr],n):null}(mo(),Wt(),16==(16&e))}class oc{constructor(){}supports(n){return xy(n)}create(n){return new Xg(n)}}const Zg=(e,n)=>n;class Xg{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||Zg}forEachItem(n){let t;for(t=this._itHead;null!==t;t=t._next)n(t)}forEachOperation(n){let t=this._itHead,r=this._removalsHead,a=0,c=null;for(;t||r;){const h=!r||t&&t.currentIndex<uC(r,a,c)?t:r,f=uC(h,a,c),b=h.currentIndex;if(h===r)a--,r=r._nextRemoved;else if(t=t._next,null==h.previousIndex)a++;else{c||(c=[]);const x=f-a,M=b-a;if(x!=M){for(let I=0;I<x;I++){const L=I<c.length?c[I]:c[I]=0,N=L+I;M<=N&&N<x&&(c[I]=L+1)}c[h.previousIndex]=M-x}}f!==b&&n(h,f,b)}}forEachPreviousItem(n){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachMovedItem(n){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}forEachIdentityChange(n){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)n(t)}diff(n){if(null==n&&(n=[]),!xy(n))throw new Rt(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let a,c,h,t=this._itHead,r=!1;if(Array.isArray(n)){this.length=n.length;for(let f=0;f<this.length;f++)c=n[f],h=this._trackByFn(f,c),null!==t&&Object.is(t.trackById,h)?(r&&(t=this._verifyReinsertion(t,c,h,f)),Object.is(t.item,c)||this._addIdentityChange(t,c)):(t=this._mismatch(t,c,h,f),r=!0),t=t._next}else a=0,function Un(e,n){if(Array.isArray(e))for(let t=0;t<e.length;t++)n(e[t]);else{const t=e[Symbol.iterator]();let r;for(;!(r=t.next()).done;)n(r.value)}}(n,f=>{h=this._trackByFn(a,f),null!==t&&Object.is(t.trackById,h)?(r&&(t=this._verifyReinsertion(t,f,h,a)),Object.is(t.item,f)||this._addIdentityChange(t,f)):(t=this._mismatch(t,f,h,a),r=!0),t=t._next,a++}),this.length=a;return this._truncate(t),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,t,r,a){let c;return null===n?c=this._itTail:(c=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._reinsertAfter(n,c,a)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(r,a))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._moveAfter(n,c,a)):n=this._addAfter(new sv(t,r),c,a),n}_verifyReinsertion(n,t,r,a){let c=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==c?n=this._reinsertAfter(c,n._prev,a):n.currentIndex!=a&&(n.currentIndex=a,this._addToMoves(n,a)),n}_truncate(n){for(;null!==n;){const t=n._next;this._addToRemovals(this._unlink(n)),n=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,t,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const a=n._prevRemoved,c=n._nextRemoved;return null===a?this._removalsHead=c:a._nextRemoved=c,null===c?this._removalsTail=a:c._prevRemoved=a,this._insertAfter(n,t,r),this._addToMoves(n,r),n}_moveAfter(n,t,r){return this._unlink(n),this._insertAfter(n,t,r),this._addToMoves(n,r),n}_addAfter(n,t,r){return this._insertAfter(n,t,r),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,t,r){const a=null===t?this._itHead:t._next;return n._next=a,n._prev=t,null===a?this._itTail=n:a._prev=n,null===t?this._itHead=n:t._next=n,null===this._linkedRecords&&(this._linkedRecords=new dC),this._linkedRecords.put(n),n.currentIndex=r,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const t=n._prev,r=n._next;return null===t?this._itHead=r:t._next=r,null===r?this._itTail=t:r._prev=t,n}_addToMoves(n,t){return n.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new dC),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,t){return n.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class sv{constructor(n,t){this.item=n,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class uA{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,t){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===t||t<=r.currentIndex)&&Object.is(r.trackById,n))return r;return null}remove(n){const t=n._prevDup,r=n._nextDup;return null===t?this._head=r:t._nextDup=r,null===r?this._tail=t:r._prevDup=t,null===this._head}}class dC{constructor(){this.map=new Map}put(n){const t=n.trackById;let r=this.map.get(t);r||(r=new uA,this.map.set(t,r)),r.add(n)}get(n,t){const a=this.map.get(n);return a?a.get(n,t):null}remove(n){const t=n.trackById;return this.map.get(t).remove(n)&&this.map.delete(t),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function uC(e,n,t){const r=e.previousIndex;if(null===r)return r;let a=0;return t&&r<t.length&&(a=t[r]),r+n+a}class hC{constructor(){}supports(n){return n instanceof Map||Wm(n)}create(){return new hA}}class hA{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let t;for(t=this._mapHead;null!==t;t=t._next)n(t)}forEachPreviousItem(n){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)n(t)}forEachChangedItem(n){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}diff(n){if(n){if(!(n instanceof Map||Wm(n)))throw new Rt(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(n,(r,a)=>{if(t&&t.key===a)this._maybeAddToChanges(t,r),this._appendAfter=t,t=t._next;else{const c=this._getOrCreateRecordForKey(a,r);t=this._insertBeforeOrAppend(t,c)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let r=t;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,t){if(n){const r=n._prev;return t._next=n,t._prev=r,n._prev=t,r&&(r._next=t),n===this._mapHead&&(this._mapHead=t),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(n,t){if(this._records.has(n)){const a=this._records.get(n);this._maybeAddToChanges(a,t);const c=a._prev,h=a._next;return c&&(c._next=h),h&&(h._prev=c),a._next=null,a._prev=null,a}const r=new mA(n);return this._records.set(n,r),r.currentValue=t,this._addToAdditions(r),r}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,t){Object.is(t,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=t,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,t){n instanceof Map?n.forEach(t):Object.keys(n).forEach(r=>t(n[r],r))}}class mA{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function mC(){return new $s([new oc])}let $s=(()=>{class e{static#t=this.\u0275prov=Jt({token:e,providedIn:"root",factory:mC});constructor(t){this.factories=t}static create(t,r){if(null!=r){const a=r.factories.slice();t=t.concat(a)}return new e(t)}static extend(t){return{provide:e,useFactory:r=>e.create(t,r||mC()),deps:[[e,new rl,new aa]]}}find(t){const r=this.factories.find(a=>a.supports(t));if(null!=r)return r;throw new Rt(901,!1)}}return e})();function gl(){return new wp([new hC])}let wp=(()=>{class e{static#t=this.\u0275prov=Jt({token:e,providedIn:"root",factory:gl});constructor(t){this.factories=t}static create(t,r){if(r){const a=r.factories.slice();t=t.concat(a)}return new e(t)}static extend(t){return{provide:e,useFactory:r=>e.create(t,r||gl()),deps:[[e,new rl,new aa]]}}find(t){const r=this.factories.find(a=>a.supports(t));if(r)return r;throw new Rt(901,!1)}}return e})();const jd=R(null,"core",[]);let fC=(()=>{class e{constructor(t){}static#t=this.\u0275fac=function(r){return new(r||e)(vt(Q))};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({})}return e})();function av(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}let vL=null;function Cp(){return vL}class EW{}const ki=new kt("DocumentToken");let xL=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:function(){return oe(IW)},providedIn:"platform"})}return e})();const AW=new kt("Location Initialized");let IW=(()=>{class e extends xL{constructor(){super(),this._doc=oe(ki),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Cp().getBaseHref(this._doc)}onPopState(t){const r=Cp().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=Cp().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,a){this._history.pushState(t,r,a)}replaceState(t,r,a){this._history.replaceState(t,r,a)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:function(){return new e},providedIn:"platform"})}return e})();function wL(e,n){if(0==e.length)return n;if(0==n.length)return e;let t=0;return e.endsWith("/")&&t++,n.startsWith("/")&&t++,2==t?e+n.substring(1):1==t?e+n:e+"/"+n}function wV(e){const n=e.match(/#|\?|$/),t=n&&n.index||e.length;return e.slice(0,t-("/"===e[t-1]?1:0))+e.slice(t)}function uh(e){return e&&"?"!==e[0]?"?"+e:e}let Kg=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:function(){return oe(MV)},providedIn:"root"})}return e})();const CV=new kt("appBaseHref");let MV=(()=>{class e extends Kg{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??oe(ki).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return wL(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+uh(this._platformLocation.search),a=this._platformLocation.hash;return a&&t?`${r}${a}`:r}pushState(t,r,a,c){const h=this.prepareExternalUrl(a+uh(c));this._platformLocation.pushState(t,r,h)}replaceState(t,r,a,c){const h=this.prepareExternalUrl(a+uh(c));this._platformLocation.replaceState(t,r,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(xL),vt(CV,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),RW=(()=>{class e extends Kg{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=wL(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,a,c){let h=this.prepareExternalUrl(a+uh(c));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.pushState(t,r,h)}replaceState(t,r,a,c){let h=this.prepareExternalUrl(a+uh(c));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(xL),vt(CV,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})(),gC=(()=>{class e{constructor(t){this._subject=new me,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._basePath=function FW(e){if(new RegExp("^(https?:)?//").test(e)){const[,t]=e.split(/\/\/[^\/]+/);return t}return e}(wV(DV(r))),this._locationStrategy.onPopState(a=>{this._subject.emit({url:this.path(!0),pop:!0,state:a.state,type:a.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+uh(r))}normalize(t){return e.stripTrailingSlash(function OW(e,n){if(!e||!n.startsWith(e))return n;const t=n.substring(e.length);return""===t||["/",";","?","#"].includes(t[0])?t:n}(this._basePath,DV(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",a=null){this._locationStrategy.pushState(a,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+uh(r)),a)}replaceState(t,r="",a=null){this._locationStrategy.replaceState(a,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+uh(r)),a)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(a=>a(t,r))}subscribe(t,r,a){return this._subject.subscribe({next:t,error:r,complete:a})}static#t=this.normalizeQueryParams=uh;static#e=this.joinWithSlash=wL;static#i=this.stripTrailingSlash=wV;static#n=this.\u0275fac=function(r){return new(r||e)(vt(Kg))};static#r=this.\u0275prov=Jt({token:e,factory:function(){return function PW(){return new gC(vt(Kg))}()},providedIn:"root"})}return e})();function DV(e){return e.replace(/\/index.html$/,"")}var fa=function(e){return e[e.Format=0]="Format",e[e.Standalone=1]="Standalone",e}(fa||{}),yr=function(e){return e[e.Narrow=0]="Narrow",e[e.Abbreviated=1]="Abbreviated",e[e.Wide=2]="Wide",e[e.Short=3]="Short",e}(yr||{}),_l=function(e){return e[e.Short=0]="Short",e[e.Medium=1]="Medium",e[e.Long=2]="Long",e[e.Full=3]="Full",e}(_l||{}),wo=function(e){return e[e.Decimal=0]="Decimal",e[e.Group=1]="Group",e[e.List=2]="List",e[e.PercentSign=3]="PercentSign",e[e.PlusSign=4]="PlusSign",e[e.MinusSign=5]="MinusSign",e[e.Exponential=6]="Exponential",e[e.SuperscriptingExponent=7]="SuperscriptingExponent",e[e.PerMille=8]="PerMille",e[e.Infinity=9]="Infinity",e[e.NaN=10]="NaN",e[e.TimeSeparator=11]="TimeSeparator",e[e.CurrencyDecimal=12]="CurrencyDecimal",e[e.CurrencyGroup=13]="CurrencyGroup",e}(wo||{});function vA(e,n){return ac(bs(e)[ur.DateFormat],n)}function xA(e,n){return ac(bs(e)[ur.TimeFormat],n)}function wA(e,n){return ac(bs(e)[ur.DateTimeFormat],n)}function sc(e,n){const t=bs(e),r=t[ur.NumberSymbols][n];if(typeof r>"u"){if(n===wo.CurrencyDecimal)return t[ur.NumberSymbols][wo.Decimal];if(n===wo.CurrencyGroup)return t[ur.NumberSymbols][wo.Group]}return r}function SV(e){if(!e[ur.ExtraData])throw new Error(`Missing extra locale data for the locale "${e[ur.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function ac(e,n){for(let t=n;t>-1;t--)if(typeof e[t]<"u")return e[t];throw new Error("Locale data API: locale data undefined")}function ML(e){const[n,t]=e.split(":");return{hours:+n,minutes:+t}}const ZW=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,_C={},XW=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var hh=function(e){return e[e.Short=0]="Short",e[e.ShortGMT=1]="ShortGMT",e[e.Long=2]="Long",e[e.Extended=3]="Extended",e}(hh||{}),Xn=function(e){return e[e.FullYear=0]="FullYear",e[e.Month=1]="Month",e[e.Date=2]="Date",e[e.Hours=3]="Hours",e[e.Minutes=4]="Minutes",e[e.Seconds=5]="Seconds",e[e.FractionalSeconds=6]="FractionalSeconds",e[e.Day=7]="Day",e}(Xn||{}),Kn=function(e){return e[e.DayPeriods=0]="DayPeriods",e[e.Days=1]="Days",e[e.Months=2]="Months",e[e.Eras=3]="Eras",e}(Kn||{});function KW(e,n,t,r){let a=function sq(e){if(AV(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){const[a,c=1,h=1]=e.split("-").map(f=>+f);return CA(a,c-1,h)}const t=parseFloat(e);if(!isNaN(e-t))return new Date(t);let r;if(r=e.match(ZW))return function aq(e){const n=new Date(0);let t=0,r=0;const a=e[8]?n.setUTCFullYear:n.setFullYear,c=e[8]?n.setUTCHours:n.setHours;e[9]&&(t=Number(e[9]+e[10]),r=Number(e[9]+e[11])),a.call(n,Number(e[1]),Number(e[2])-1,Number(e[3]));const h=Number(e[4]||0)-t,f=Number(e[5]||0)-r,b=Number(e[6]||0),x=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return c.call(n,h,f,b,x),n}(r)}const n=new Date(e);if(!AV(n))throw new Error(`Unable to convert "${e}" into a date`);return n}(e);n=mh(t,n)||n;let f,h=[];for(;n;){if(f=XW.exec(n),!f){h.push(n);break}{h=h.concat(f.slice(1));const M=h.pop();if(!M)break;n=M}}let b=a.getTimezoneOffset();r&&(b=EV(r,b),a=function oq(e,n,t){const r=t?-1:1,a=e.getTimezoneOffset();return function rq(e,n){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+n),e}(e,r*(EV(n,a)-a))}(a,r,!0));let x="";return h.forEach(M=>{const T=function nq(e){if(kL[e])return kL[e];let n;switch(e){case"G":case"GG":case"GGG":n=kr(Kn.Eras,yr.Abbreviated);break;case"GGGG":n=kr(Kn.Eras,yr.Wide);break;case"GGGGG":n=kr(Kn.Eras,yr.Narrow);break;case"y":n=Io(Xn.FullYear,1,0,!1,!0);break;case"yy":n=Io(Xn.FullYear,2,0,!0,!0);break;case"yyy":n=Io(Xn.FullYear,3,0,!1,!0);break;case"yyyy":n=Io(Xn.FullYear,4,0,!1,!0);break;case"Y":n=SA(1);break;case"YY":n=SA(2,!0);break;case"YYY":n=SA(3);break;case"YYYY":n=SA(4);break;case"M":case"L":n=Io(Xn.Month,1,1);break;case"MM":case"LL":n=Io(Xn.Month,2,1);break;case"MMM":n=kr(Kn.Months,yr.Abbreviated);break;case"MMMM":n=kr(Kn.Months,yr.Wide);break;case"MMMMM":n=kr(Kn.Months,yr.Narrow);break;case"LLL":n=kr(Kn.Months,yr.Abbreviated,fa.Standalone);break;case"LLLL":n=kr(Kn.Months,yr.Wide,fa.Standalone);break;case"LLLLL":n=kr(Kn.Months,yr.Narrow,fa.Standalone);break;case"w":n=DL(1);break;case"ww":n=DL(2);break;case"W":n=DL(1,!0);break;case"d":n=Io(Xn.Date,1);break;case"dd":n=Io(Xn.Date,2);break;case"c":case"cc":n=Io(Xn.Day,1);break;case"ccc":n=kr(Kn.Days,yr.Abbreviated,fa.Standalone);break;case"cccc":n=kr(Kn.Days,yr.Wide,fa.Standalone);break;case"ccccc":n=kr(Kn.Days,yr.Narrow,fa.Standalone);break;case"cccccc":n=kr(Kn.Days,yr.Short,fa.Standalone);break;case"E":case"EE":case"EEE":n=kr(Kn.Days,yr.Abbreviated);break;case"EEEE":n=kr(Kn.Days,yr.Wide);break;case"EEEEE":n=kr(Kn.Days,yr.Narrow);break;case"EEEEEE":n=kr(Kn.Days,yr.Short);break;case"a":case"aa":case"aaa":n=kr(Kn.DayPeriods,yr.Abbreviated);break;case"aaaa":n=kr(Kn.DayPeriods,yr.Wide);break;case"aaaaa":n=kr(Kn.DayPeriods,yr.Narrow);break;case"b":case"bb":case"bbb":n=kr(Kn.DayPeriods,yr.Abbreviated,fa.Standalone,!0);break;case"bbbb":n=kr(Kn.DayPeriods,yr.Wide,fa.Standalone,!0);break;case"bbbbb":n=kr(Kn.DayPeriods,yr.Narrow,fa.Standalone,!0);break;case"B":case"BB":case"BBB":n=kr(Kn.DayPeriods,yr.Abbreviated,fa.Format,!0);break;case"BBBB":n=kr(Kn.DayPeriods,yr.Wide,fa.Format,!0);break;case"BBBBB":n=kr(Kn.DayPeriods,yr.Narrow,fa.Format,!0);break;case"h":n=Io(Xn.Hours,1,-12);break;case"hh":n=Io(Xn.Hours,2,-12);break;case"H":n=Io(Xn.Hours,1);break;case"HH":n=Io(Xn.Hours,2);break;case"m":n=Io(Xn.Minutes,1);break;case"mm":n=Io(Xn.Minutes,2);break;case"s":n=Io(Xn.Seconds,1);break;case"ss":n=Io(Xn.Seconds,2);break;case"S":n=Io(Xn.FractionalSeconds,1);break;case"SS":n=Io(Xn.FractionalSeconds,2);break;case"SSS":n=Io(Xn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=DA(hh.Short);break;case"ZZZZZ":n=DA(hh.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=DA(hh.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=DA(hh.Long);break;default:return null}return kL[e]=n,n}(M);x+=T?T(a,t,b):"''"===M?"'":M.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),x}function CA(e,n,t){const r=new Date(0);return r.setFullYear(e,n,t),r.setHours(0,0,0),r}function mh(e,n){const t=function BW(e){return bs(e)[ur.LocaleId]}(e);if(_C[t]=_C[t]||{},_C[t][n])return _C[t][n];let r="";switch(n){case"shortDate":r=vA(e,_l.Short);break;case"mediumDate":r=vA(e,_l.Medium);break;case"longDate":r=vA(e,_l.Long);break;case"fullDate":r=vA(e,_l.Full);break;case"shortTime":r=xA(e,_l.Short);break;case"mediumTime":r=xA(e,_l.Medium);break;case"longTime":r=xA(e,_l.Long);break;case"fullTime":r=xA(e,_l.Full);break;case"short":const a=mh(e,"shortTime"),c=mh(e,"shortDate");r=MA(wA(e,_l.Short),[a,c]);break;case"medium":const h=mh(e,"mediumTime"),f=mh(e,"mediumDate");r=MA(wA(e,_l.Medium),[h,f]);break;case"long":const b=mh(e,"longTime"),x=mh(e,"longDate");r=MA(wA(e,_l.Long),[b,x]);break;case"full":const M=mh(e,"fullTime"),T=mh(e,"fullDate");r=MA(wA(e,_l.Full),[M,T])}return r&&(_C[t][n]=r),r}function MA(e,n){return n&&(e=e.replace(/\{([^}]+)}/g,function(t,r){return null!=n&&r in n?n[r]:t})),e}function Gc(e,n,t="-",r,a){let c="";(e<0||a&&e<=0)&&(a?e=1-e:(e=-e,c=t));let h=String(e);for(;h.length<n;)h="0"+h;return r&&(h=h.slice(h.length-n)),c+h}function Io(e,n,t=0,r=!1,a=!1){return function(c,h){let f=function JW(e,n){switch(e){case Xn.FullYear:return n.getFullYear();case Xn.Month:return n.getMonth();case Xn.Date:return n.getDate();case Xn.Hours:return n.getHours();case Xn.Minutes:return n.getMinutes();case Xn.Seconds:return n.getSeconds();case Xn.FractionalSeconds:return n.getMilliseconds();case Xn.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${e}".`)}}(e,c);if((t>0||f>-t)&&(f+=t),e===Xn.Hours)0===f&&-12===t&&(f=12);else if(e===Xn.FractionalSeconds)return function QW(e,n){return Gc(e,3).substring(0,n)}(f,n);const b=sc(h,wo.MinusSign);return Gc(f,n,b,r,a)}}function kr(e,n,t=fa.Format,r=!1){return function(a,c){return function tq(e,n,t,r,a,c){switch(t){case Kn.Months:return function VW(e,n,t){const r=bs(e),c=ac([r[ur.MonthsFormat],r[ur.MonthsStandalone]],n);return ac(c,t)}(n,a,r)[e.getMonth()];case Kn.Days:return function zW(e,n,t){const r=bs(e),c=ac([r[ur.DaysFormat],r[ur.DaysStandalone]],n);return ac(c,t)}(n,a,r)[e.getDay()];case Kn.DayPeriods:const h=e.getHours(),f=e.getMinutes();if(c){const x=function $W(e){const n=bs(e);return SV(n),(n[ur.ExtraData][2]||[]).map(r=>"string"==typeof r?ML(r):[ML(r[0]),ML(r[1])])}(n),M=function GW(e,n,t){const r=bs(e);SV(r);const c=ac([r[ur.ExtraData][0],r[ur.ExtraData][1]],n)||[];return ac(c,t)||[]}(n,a,r),T=x.findIndex(I=>{if(Array.isArray(I)){const[L,N]=I,V=h>=L.hours&&f>=L.minutes,$=h<N.hours||h===N.hours&&f<N.minutes;if(L.hours<N.hours){if(V&&$)return!0}else if(V||$)return!0}else if(I.hours===h&&I.minutes===f)return!0;return!1});if(-1!==T)return M[T]}return function NW(e,n,t){const r=bs(e),c=ac([r[ur.DayPeriodsFormat],r[ur.DayPeriodsStandalone]],n);return ac(c,t)}(n,a,r)[h<12?0:1];case Kn.Eras:return function jW(e,n){return ac(bs(e)[ur.Eras],n)}(n,r)[e.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(a,c,e,n,t,r)}}function DA(e){return function(n,t,r){const a=-1*r,c=sc(t,wo.MinusSign),h=a>0?Math.floor(a/60):Math.ceil(a/60);switch(e){case hh.Short:return(a>=0?"+":"")+Gc(h,2,c)+Gc(Math.abs(a%60),2,c);case hh.ShortGMT:return"GMT"+(a>=0?"+":"")+Gc(h,1,c);case hh.Long:return"GMT"+(a>=0?"+":"")+Gc(h,2,c)+":"+Gc(Math.abs(a%60),2,c);case hh.Extended:return 0===r?"Z":(a>=0?"+":"")+Gc(h,2,c)+":"+Gc(Math.abs(a%60),2,c);default:throw new Error(`Unknown zone width "${e}"`)}}}const eq=0,kA=4;function TV(e){return CA(e.getFullYear(),e.getMonth(),e.getDate()+(kA-e.getDay()))}function DL(e,n=!1){return function(t,r){let a;if(n){const c=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,h=t.getDate();a=1+Math.floor((h+c)/7)}else{const c=TV(t),h=function iq(e){const n=CA(e,eq,1).getDay();return CA(e,0,1+(n<=kA?kA:kA+7)-n)}(c.getFullYear()),f=c.getTime()-h.getTime();a=1+Math.round(f/6048e5)}return Gc(a,e,sc(r,wo.MinusSign))}}function SA(e,n=!1){return function(t,r){return Gc(TV(t).getFullYear(),e,sc(r,wo.MinusSign),n)}}const kL={};function EV(e,n){e=e.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(t)?n:t}function AV(e){return e instanceof Date&&!isNaN(e.valueOf())}function OV(e,n){n=encodeURIComponent(n);for(const t of e.split(";")){const r=t.indexOf("="),[a,c]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(a.trim()===n)return decodeURIComponent(c)}return null}const RL=/\s+/,FV=[];let yC=(()=>{class e{constructor(t,r,a,c){this._iterableDiffers=t,this._keyValueDiffers=r,this._ngEl=a,this._renderer=c,this.initialClasses=FV,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(RL):FV}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(RL):t}ngDoCheck(){for(const r of this.initialClasses)this._updateState(r,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const r of t)this._updateState(r,!0);else if(null!=t)for(const r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){const a=this.stateMap.get(t);void 0!==a?(a.enabled!==r&&(a.changed=!0,a.enabled=r),a.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const r=t[0],a=t[1];a.changed?(this._toggleClass(r,a.enabled),a.changed=!1):a.touched||(a.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),a.touched=!1}}_toggleClass(t,r){(t=t.trim()).length>0&&t.split(RL).forEach(a=>{r?this._renderer.addClass(this._ngEl.nativeElement,a):this._renderer.removeClass(this._ngEl.nativeElement,a)})}static#t=this.\u0275fac=function(r){return new(r||e)(z($s),z(wp),z(Me),z(Bc))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return e})();class vq{constructor(n,t,r,a){this.$implicit=n,this.ngForOf=t,this.index=r,this.count=a}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let vC=(()=>{class e{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,r,a){this._viewContainer=t,this._template=r,this._differs=a,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=this._viewContainer;t.forEachOperation((a,c,h)=>{if(null==a.previousIndex)r.createEmbeddedView(this._template,new vq(a.item,this._ngForOf,-1,-1),null===h?void 0:h);else if(null==h)r.remove(null===c?void 0:c);else if(null!==c){const f=r.get(c);r.move(f,h),BV(f,a)}});for(let a=0,c=r.length;a<c;a++){const f=r.get(a).context;f.index=a,f.count=c,f.ngForOf=this._ngForOf}t.forEachIdentityChange(a=>{BV(r.get(a.currentIndex),a)})}static ngTemplateContextGuard(t,r){return!0}static#t=this.\u0275fac=function(r){return new(r||e)(z(hr),z(Jr),z($s))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return e})();function BV(e,n){e.context.$implicit=n.item}let La=(()=>{class e{constructor(t,r){this._viewContainer=t,this._context=new xq,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){NV("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){NV("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}static#t=this.\u0275fac=function(r){return new(r||e)(z(hr),z(Jr))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return e})();class xq{constructor(){this.$implicit=null,this.ngIf=null}}function NV(e,n){if(n&&!n.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${io(n)}'.`)}class PL{constructor(n,t){this._viewContainerRef=n,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(n){n&&!this._created?this.create():!n&&this._created&&this.destroy()}}let Qg=(()=>{class e{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews.push(t)}_matchCase(t){const r=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||r,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),r}_updateDefaultCases(t){if(this._defaultViews.length>0&&t!==this._defaultUsed){this._defaultUsed=t;for(const r of this._defaultViews)r.enforceState(t)}}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275dir=Mt({type:e,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0})}return e})(),xC=(()=>{class e{constructor(t,r,a){this.ngSwitch=a,a._addCase(),this._view=new PL(t,r)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}static#t=this.\u0275fac=function(r){return new(r||e)(z(hr),z(Jr),z(Qg,9))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0})}return e})(),zV=(()=>{class e{constructor(t,r,a){a._addDefault(new PL(t,r))}static#t=this.\u0275fac=function(r){return new(r||e)(z(hr),z(Jr),z(Qg,9))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","ngSwitchDefault",""]],standalone:!0})}return e})(),OL=(()=>{class e{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(t.ngTemplateOutlet||t.ngTemplateOutletInjector){const r=this._viewContainerRef;if(this._viewRef&&r.remove(r.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:a,ngTemplateOutletContext:c,ngTemplateOutletInjector:h}=this;this._viewRef=r.createEmbeddedView(a,c,h?{injector:h}:void 0)}else this._viewRef=null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}static#t=this.\u0275fac=function(r){return new(r||e)(z(hr))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Bn]})}return e})();const Oq=new kt("DATE_PIPE_DEFAULT_TIMEZONE"),Fq=new kt("DATE_PIPE_DEFAULT_OPTIONS");let jV=(()=>{class e{constructor(t,r,a){this.locale=t,this.defaultTimezone=r,this.defaultOptions=a}transform(t,r,a,c){if(null==t||""===t||t!=t)return null;try{return KW(t,r??this.defaultOptions?.dateFormat??"mediumDate",c||this.locale,a??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(h){throw function Wc(e,n){return new Rt(2100,!1)}()}}static#t=this.\u0275fac=function(r){return new(r||e)(z(rc,16),z(Oq,24),z(Fq,24))};static#e=this.\u0275pipe=ko({name:"date",type:e,pure:!0,standalone:!0})}return e})(),ws=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({})}return e})();const HV="browser";function $V(e){return"server"===e}let Zq=(()=>{class e{static#t=this.\u0275prov=Jt({token:e,providedIn:"root",factory:()=>new Xq(vt(ki),window)})}return e})();class Xq{constructor(n,t){this.document=n,this.window=t,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const t=function Kq(e,n){const t=e.getElementById(n)||e.getElementsByName(n)[0];if(t)return t;if("function"==typeof e.createTreeWalker&&e.body&&"function"==typeof e.body.attachShadow){const r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let a=r.currentNode;for(;a;){const c=a.shadowRoot;if(c){const h=c.getElementById(n)||c.querySelector(`[name="${n}"]`);if(h)return h}a=r.nextNode()}}return null}(this.document,n);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(n){this.supportsScrolling()&&(this.window.history.scrollRestoration=n)}scrollToElement(n){const t=n.getBoundingClientRect(),r=t.left+this.window.pageXOffset,a=t.top+this.window.pageYOffset,c=this.offset();this.window.scrollTo(r-c[0],a-c[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class GV{}class v7 extends EW{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class zL extends v7{static makeCurrent(){!function TW(e){vL||(vL=e)}(new zL)}onAndCancel(n,t,r){return n.addEventListener(t,r),()=>{n.removeEventListener(t,r)}}dispatchEvent(n,t){n.dispatchEvent(t)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,t){return(t=t||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,t){return"window"===t?window:"document"===t?n:"body"===t?n.body:null}getBaseHref(n){const t=function x7(){return CC=CC||document.querySelector("base"),CC?CC.getAttribute("href"):null}();return null==t?null:function w7(e){IA=IA||document.createElement("a"),IA.setAttribute("href",e);const n=IA.pathname;return"/"===n.charAt(0)?n:`/${n}`}(t)}resetBaseElement(){CC=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return OV(document.cookie,n)}}let IA,CC=null,M7=(()=>{class e{build(){return new XMLHttpRequest}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();const VL=new kt("EventManagerPlugins");let XV=(()=>{class e{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(a=>{a.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,a){return this._findPluginFor(r).addEventListener(t,r,a)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(c=>c.supports(t)),!r)throw new Rt(5101,!1);return this._eventNameToPlugin.set(t,r),r}static#t=this.\u0275fac=function(r){return new(r||e)(vt(VL),vt(Re))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();class KV{constructor(n){this._doc=n}}const jL="ng-app-id";let QV=(()=>{class e{constructor(t,r,a,c={}){this.doc=t,this.appId=r,this.nonce=a,this.platformId=c,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=$V(c),this.resetHostNodes()}addStyles(t){for(const r of t)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(t){for(const r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){const r=this.styleRef;r.get(t)?.elements?.forEach(a=>a.remove()),r.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${jL}="${this.appId}"]`);if(t?.length){const r=new Map;return t.forEach(a=>{null!=a.textContent&&r.set(a.textContent,a)}),r}return null}changeUsageCount(t,r){const a=this.styleRef;if(a.has(t)){const c=a.get(t);return c.usage+=r,c.usage}return a.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){const a=this.styleNodesInDOM,c=a?.get(r);if(c?.parentNode===t)return a.delete(r),c.removeAttribute(jL),c;{const h=this.doc.createElement("style");return this.nonce&&h.setAttribute("nonce",this.nonce),h.textContent=r,this.platformIsServer&&h.setAttribute(jL,this.appId),h}}addStyleToHost(t,r){const a=this.getStyleElement(t,r);t.appendChild(a);const c=this.styleRef,h=c.get(r)?.elements;h?h.push(a):c.set(r,{elements:[a],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ki),vt(ig),vt(cl,8),vt(Fc))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();const UL={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},HL=/%COMP%/g,T7=new kt("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function t4(e,n){return n.map(t=>t.replace(HL,e))}let $L=(()=>{class e{constructor(t,r,a,c,h,f,b,x=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=a,this.removeStylesOnCompDestroy=c,this.doc=h,this.platformId=f,this.ngZone=b,this.nonce=x,this.rendererByCompId=new Map,this.platformIsServer=$V(f),this.defaultRenderer=new GL(t,h,b,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===ea.ShadowDom&&(r={...r,encapsulation:ea.Emulated});const a=this.getOrCreateRenderer(t,r);return a instanceof n4?a.applyToHost(t):a instanceof WL&&a.applyStyles(),a}getOrCreateRenderer(t,r){const a=this.rendererByCompId;let c=a.get(r.id);if(!c){const h=this.doc,f=this.ngZone,b=this.eventManager,x=this.sharedStylesHost,M=this.removeStylesOnCompDestroy,T=this.platformIsServer;switch(r.encapsulation){case ea.Emulated:c=new n4(b,x,r,this.appId,M,h,f,T);break;case ea.ShadowDom:return new R7(b,x,t,r,h,f,this.nonce,T);default:c=new WL(b,x,r,M,h,f,T)}a.set(r.id,c)}return c}ngOnDestroy(){this.rendererByCompId.clear()}static#t=this.\u0275fac=function(r){return new(r||e)(vt(XV),vt(QV),vt(ig),vt(T7),vt(ki),vt(Fc),vt(Re),vt(cl))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();class GL{constructor(n,t,r,a){this.eventManager=n,this.doc=t,this.ngZone=r,this.platformIsServer=a,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,t){return t?this.doc.createElementNS(UL[t]||t,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,t){(e4(n)?n.content:n).appendChild(t)}insertBefore(n,t,r){n&&(e4(n)?n.content:n).insertBefore(t,r)}removeChild(n,t){n&&n.removeChild(t)}selectRootElement(n,t){let r="string"==typeof n?this.doc.querySelector(n):n;if(!r)throw new Rt(-5104,!1);return t||(r.textContent=""),r}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,t,r,a){if(a){t=a+":"+t;const c=UL[a];c?n.setAttributeNS(c,t,r):n.setAttribute(t,r)}else n.setAttribute(t,r)}removeAttribute(n,t,r){if(r){const a=UL[r];a?n.removeAttributeNS(a,t):n.removeAttribute(`${r}:${t}`)}else n.removeAttribute(t)}addClass(n,t){n.classList.add(t)}removeClass(n,t){n.classList.remove(t)}setStyle(n,t,r,a){a&(ol.DashCase|ol.Important)?n.style.setProperty(t,r,a&ol.Important?"important":""):n.style[t]=r}removeStyle(n,t,r){r&ol.DashCase?n.style.removeProperty(t):n.style[t]=""}setProperty(n,t,r){n[t]=r}setValue(n,t){n.nodeValue=t}listen(n,t,r){if("string"==typeof n&&!(n=Cp().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${t}`);return this.eventManager.addEventListener(n,t,this.decoratePreventDefault(r))}decoratePreventDefault(n){return t=>{if("__ngUnwrap__"===t)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(t)):n(t))&&t.preventDefault()}}}function e4(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class R7 extends GL{constructor(n,t,r,a,c,h,f,b){super(n,c,h,b),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const x=t4(a.id,a.styles);for(const M of x){const T=document.createElement("style");f&&T.setAttribute("nonce",f),T.textContent=M,this.shadowRoot.appendChild(T)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,t){return super.appendChild(this.nodeOrShadowRoot(n),t)}insertBefore(n,t,r){return super.insertBefore(this.nodeOrShadowRoot(n),t,r)}removeChild(n,t){return super.removeChild(this.nodeOrShadowRoot(n),t)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class WL extends GL{constructor(n,t,r,a,c,h,f,b){super(n,c,h,f),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=a,this.styles=b?t4(b,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class n4 extends WL{constructor(n,t,r,a,c,h,f,b){const x=a+"-"+r.id;super(n,t,r,c,h,f,b,x),this.contentAttr=function E7(e){return"_ngcontent-%COMP%".replace(HL,e)}(x),this.hostAttr=function A7(e){return"_nghost-%COMP%".replace(HL,e)}(x)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,t){const r=super.createElement(n,t);return super.setAttribute(r,this.contentAttr,""),r}}let P7=(()=>{class e extends KV{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,a){return t.addEventListener(r,a,!1),()=>this.removeEventListener(t,r,a)}removeEventListener(t,r,a){return t.removeEventListener(r,a)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ki))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();const r4=["alt","control","meta","shift"],O7={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},F7={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let L7=(()=>{class e extends KV{constructor(t){super(t)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,r,a){const c=e.parseEventName(r),h=e.eventCallback(c.fullKey,a,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Cp().onAndCancel(t,c.domEventName,h))}static parseEventName(t){const r=t.toLowerCase().split("."),a=r.shift();if(0===r.length||"keydown"!==a&&"keyup"!==a)return null;const c=e._normalizeKey(r.pop());let h="",f=r.indexOf("code");if(f>-1&&(r.splice(f,1),h="code."),r4.forEach(x=>{const M=r.indexOf(x);M>-1&&(r.splice(M,1),h+=x+".")}),h+=c,0!=r.length||0===c.length)return null;const b={};return b.domEventName=a,b.fullKey=h,b}static matchEventFullKeyCode(t,r){let a=O7[t.key]||t.key,c="";return r.indexOf("code.")>-1&&(a=t.code,c="code."),!(null==a||!a)&&(a=a.toLowerCase()," "===a?a="space":"."===a&&(a="dot"),r4.forEach(h=>{h!==a&&(0,F7[h])(t)&&(c+=h+".")}),c+=a,c===r)}static eventCallback(t,r,a){return c=>{e.matchEventFullKeyCode(c,t)&&a.runGuarded(()=>r(c))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ki))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();const s4=[{provide:Fc,useValue:HV},{provide:Gx,useValue:function B7(){zL.makeCurrent()},multi:!0},{provide:ki,useFactory:function z7(){return function kx(e){Dd=e}(document),document},deps:[]}],V7=R(jd,"browser",s4),j7=new kt(""),a4=[{provide:l,useClass:class C7{addToWindow(n){zi.getAngularTestability=(r,a=!0)=>{const c=n.findTestabilityInTree(r,a);if(null==c)throw new Rt(5103,!1);return c},zi.getAllAngularTestabilities=()=>n.getAllTestabilities(),zi.getAllAngularRootElements=()=>n.getAllRootElements(),zi.frameworkStabilizers||(zi.frameworkStabilizers=[]),zi.frameworkStabilizers.push(r=>{const a=zi.getAllAngularTestabilities();let c=a.length,h=!1;const f=function(b){h=h||b,c--,0==c&&r(h)};a.forEach(b=>{b.whenStable(f)})})}findTestabilityInTree(n,t,r){return null==t?null:n.getTestability(t)??(r?Cp().isShadowRoot(t)?this.findTestabilityInTree(n,t.host,!0):this.findTestabilityInTree(n,t.parentElement,!0):null)}},deps:[]},{provide:s,useClass:d,deps:[Re,u,l]},{provide:d,useClass:d,deps:[Re,u,l]}],l4=[{provide:Wb,useValue:"root"},{provide:Bs,useFactory:function N7(){return new Bs},deps:[]},{provide:VL,useClass:P7,multi:!0,deps:[ki,Re,Fc]},{provide:VL,useClass:L7,multi:!0,deps:[ki]},$L,QV,XV,{provide:ag,useExisting:$L},{provide:GV,useClass:M7,deps:[]},[]];let c4=(()=>{class e{constructor(t){}static withServerTransition(t){return{ngModule:e,providers:[{provide:ig,useValue:t.appId}]}}static#t=this.\u0275fac=function(r){return new(r||e)(vt(j7,12))};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[...l4,...a4],imports:[ws,fC]})}return e})(),d4=(()=>{class e{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ki))};static#e=this.\u0275prov=Jt({token:e,factory:function(r){let a=null;return a=r?new r:function H7(){return new d4(vt(ki))}(),a},providedIn:"root"})}return e})();typeof window<"u"&&window;let YL=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:function(r){let a=null;return a=r?new(r||e):vt(m4),a},providedIn:"root"})}return e})(),m4=(()=>{class e extends YL{constructor(t){super(),this._doc=t}sanitize(t,r){if(null==r)return null;switch(t){case an.NONE:return r;case an.HTML:return Ia(r,"HTML")?Xo(r):Rr(this._doc,String(r)).toString();case an.STYLE:return Ia(r,"Style")?Xo(r):r;case an.SCRIPT:if(Ia(r,"Script"))return Xo(r);throw new Rt(5200,!1);case an.URL:return Ia(r,"URL")?Xo(r):Dr(String(r));case an.RESOURCE_URL:if(Ia(r,"ResourceURL"))return Xo(r);throw new Rt(5201,!1);default:throw new Rt(5202,!1)}}bypassSecurityTrustHtml(t){return function fs(e){return new da(e)}(t)}bypassSecurityTrustStyle(t){return function Kf(e){return new Rc(e)}(t)}bypassSecurityTrustScript(t){return function zb(e){return new Hk(e)}(t)}bypassSecurityTrustUrl(t){return function Gk(e){return new $k(e)}(t)}bypassSecurityTrustResourceUrl(t){return function kd(e){return new Ex(e)}(t)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ki))};static#e=this.\u0275prov=Jt({token:e,factory:function(r){let a=null;return a=r?new r:function q7(e){return new m4(e.get(ki))}(vt(oo)),a},providedIn:"root"})}return e})();function RA(e){return!!e&&(e instanceof en||bn(e.lift)&&bn(e.subscribe))}const{isArray:Y7}=Array,{getPrototypeOf:Z7,prototype:X7,keys:K7}=Object;function f4(e){if(1===e.length){const n=e[0];if(Y7(n))return{args:n,keys:null};if(function Q7(e){return e&&"object"==typeof e&&Z7(e)===X7}(n)){const t=K7(n);return{args:t.map(r=>n[r]),keys:t}}}return{args:e,keys:null}}const{isArray:J7}=Array;function ZL(e){return Ti(n=>function t9(e,n){return J7(n)?e(...n):e(n)}(e,n))}function g4(e,n){return e.reduce((t,r,a)=>(t[r]=n[a],t),{})}function Jg(...e){const n=ad(e),t=nD(e),{args:r,keys:a}=f4(e);if(0===r.length)return Er([],n);const c=new en(function e9(e,n,t=Al){return r=>{_4(n,()=>{const{length:a}=e,c=new Array(a);let h=a,f=a;for(let b=0;b<a;b++)_4(n,()=>{const x=Er(e[b],n);let M=!1;x.subscribe(jn(r,T=>{c[b]=T,M||(M=!0,f--),f||r.next(t(c.slice()))},()=>{--h||r.complete()}))},r)},r)}}(r,n,a?h=>g4(a,h):Al));return t?c.pipe(ZL(t)):c}function _4(e,n,t){e?Ss(t,e,n):n()}const PA=Kp(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function MC(...e){return function i9(){return sd(1)}()(Er(e,ad(e)))}function cv(e){return new en(n=>{qi(e()).subscribe(n)})}function dv(e,n){const t=bn(e)?e:()=>e,r=a=>a.error(t());return new en(n?a=>n.schedule(r,0,a):r)}function XL(){return pr((e,n)=>{let t=null;e._refCount++;const r=jn(n,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(t=null);const a=e._connection,c=t;t=null,a&&(!c||a===c)&&a.unsubscribe(),n.unsubscribe()});e.subscribe(r),r.closed||(t=e.connect())})}class KL extends en{constructor(n,t){super(),this.source=n,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,is(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new lt;const t=this.getSubject();n.add(this.source.subscribe(jn(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),n.closed&&(this._connection=null,n=lt.EMPTY)}return n}refCount(){return XL()(this)}}function nr(e){return e<=0?()=>xa:pr((n,t)=>{let r=0;n.subscribe(jn(t,a=>{++r<=e&&(t.next(a),e<=r&&t.complete())}))})}function Ws(...e){const n=ad(e);return pr((t,r)=>{(n?MC(e,t,n):MC(e,t)).subscribe(r)})}function rr(e,n){return pr((t,r)=>{let a=0;t.subscribe(jn(r,c=>e.call(n,c,a++)&&r.next(c)))})}function OA(e){return pr((n,t)=>{let r=!1;n.subscribe(jn(t,a=>{r=!0,t.next(a)},()=>{r||t.next(e),t.complete()}))})}function b4(e=n9){return pr((n,t)=>{let r=!1;n.subscribe(jn(t,a=>{r=!0,t.next(a)},()=>r?t.complete():t.error(e())))})}function n9(){return new PA}function t_(e,n){const t=arguments.length>=2;return r=>r.pipe(e?rr((a,c)=>e(a,c,r)):Al,nr(1),t?OA(n):b4(()=>new PA))}function uv(e,n){return bn(n)?xr(e,n,1):xr(e,1)}function Co(e,n,t){const r=bn(e)||n||t?{next:e,error:n,complete:t}:e;return r?pr((a,c)=>{var h;null===(h=r.subscribe)||void 0===h||h.call(r);let f=!0;a.subscribe(jn(c,b=>{var x;null===(x=r.next)||void 0===x||x.call(r,b),c.next(b)},()=>{var b;f=!1,null===(b=r.complete)||void 0===b||b.call(r),c.complete()},b=>{var x;f=!1,null===(x=r.error)||void 0===x||x.call(r,b),c.error(b)},()=>{var b,x;f&&(null===(b=r.unsubscribe)||void 0===b||b.call(r)),null===(x=r.finalize)||void 0===x||x.call(r)}))}):Al}function Dp(e){return pr((n,t)=>{let c,r=null,a=!1;r=n.subscribe(jn(t,void 0,void 0,h=>{c=qi(e(h,Dp(e)(n))),r?(r.unsubscribe(),r=null,c.subscribe(t)):a=!0})),a&&(r.unsubscribe(),r=null,c.subscribe(t))})}function QL(e){return e<=0?()=>xa:pr((n,t)=>{let r=[];n.subscribe(jn(t,a=>{r.push(a),e<r.length&&r.shift()},()=>{for(const a of r)t.next(a);t.complete()},void 0,()=>{r=null}))})}function FA(e){return Ti(()=>e)}function hv(e){return pr((n,t)=>{try{n.subscribe(t)}finally{t.add(e)}})}function Si(e){return pr((n,t)=>{qi(e).subscribe(jn(t,()=>t.complete(),Qc)),!t.closed&&n.subscribe(t)})}const ln="primary",DC=Symbol("RouteTitle");class a9{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t[0]:t}return null}getAll(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function mv(e){return new a9(e)}function l9(e,n,t){const r=t.path.split("/");if(r.length>e.length||"full"===t.pathMatch&&(n.hasChildren()||r.length<e.length))return null;const a={};for(let c=0;c<r.length;c++){const h=r[c],f=e[c];if(h.startsWith(":"))a[h.substring(1)]=f;else if(h!==f.path)return null}return{consumed:e.slice(0,r.length),posParams:a}}function Hd(e,n){const t=e?Object.keys(e):void 0,r=n?Object.keys(n):void 0;if(!t||!r||t.length!=r.length)return!1;let a;for(let c=0;c<t.length;c++)if(a=t[c],!y4(e[a],n[a]))return!1;return!0}function y4(e,n){if(Array.isArray(e)&&Array.isArray(n)){if(e.length!==n.length)return!1;const t=[...e].sort(),r=[...n].sort();return t.every((a,c)=>r[c]===a)}return e===n}function v4(e){return e.length>0?e[e.length-1]:null}function kp(e){return RA(e)?e:Mg(e)?Er(Promise.resolve(e)):Le(e)}const d9={exact:function C4(e,n,t){if(!e_(e.segments,n.segments)||!LA(e.segments,n.segments,t)||e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children)if(!e.children[r]||!C4(e.children[r],n.children[r],t))return!1;return!0},subset:M4},x4={exact:function u9(e,n){return Hd(e,n)},subset:function h9(e,n){return Object.keys(n).length<=Object.keys(e).length&&Object.keys(n).every(t=>y4(e[t],n[t]))},ignored:()=>!0};function w4(e,n,t){return d9[t.paths](e.root,n.root,t.matrixParams)&&x4[t.queryParams](e.queryParams,n.queryParams)&&!("exact"===t.fragment&&e.fragment!==n.fragment)}function M4(e,n,t){return D4(e,n,n.segments,t)}function D4(e,n,t,r){if(e.segments.length>t.length){const a=e.segments.slice(0,t.length);return!(!e_(a,t)||n.hasChildren()||!LA(a,t,r))}if(e.segments.length===t.length){if(!e_(e.segments,t)||!LA(e.segments,t,r))return!1;for(const a in n.children)if(!e.children[a]||!M4(e.children[a],n.children[a],r))return!1;return!0}{const a=t.slice(0,e.segments.length),c=t.slice(e.segments.length);return!!(e_(e.segments,a)&&LA(e.segments,a,r)&&e.children[ln])&&D4(e.children[ln],n,c,r)}}function LA(e,n,t){return n.every((r,a)=>x4[t](e[a].parameters,r.parameters))}class pv{constructor(n=new sr([],{}),t={},r=null){this.root=n,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=mv(this.queryParams)),this._queryParamMap}toString(){return f9.serialize(this)}}class sr{constructor(n,t){this.segments=n,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return BA(this)}}class kC{constructor(n,t){this.path=n,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=mv(this.parameters)),this._parameterMap}toString(){return T4(this)}}function e_(e,n){return e.length===n.length&&e.every((t,r)=>t.path===n[r].path)}let SC=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:function(){return new JL},providedIn:"root"})}return e})();class JL{parse(n){const t=new k9(n);return new pv(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(n){const t=`/${TC(n.root,!0)}`,r=function b9(e){const n=Object.keys(e).map(t=>{const r=e[t];return Array.isArray(r)?r.map(a=>`${NA(t)}=${NA(a)}`).join("&"):`${NA(t)}=${NA(r)}`}).filter(t=>!!t);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${t}${r}${"string"==typeof n.fragment?`#${function g9(e){return encodeURI(e)}(n.fragment)}`:""}`}}const f9=new JL;function BA(e){return e.segments.map(n=>T4(n)).join("/")}function TC(e,n){if(!e.hasChildren())return BA(e);if(n){const t=e.children[ln]?TC(e.children[ln],!1):"",r=[];return Object.entries(e.children).forEach(([a,c])=>{a!==ln&&r.push(`${a}:${TC(c,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function p9(e,n){let t=[];return Object.entries(e.children).forEach(([r,a])=>{r===ln&&(t=t.concat(n(a,r)))}),Object.entries(e.children).forEach(([r,a])=>{r!==ln&&(t=t.concat(n(a,r)))}),t}(e,(r,a)=>a===ln?[TC(e.children[ln],!1)]:[`${a}:${TC(r,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[ln]?`${BA(e)}/${t[0]}`:`${BA(e)}/(${t.join("//")})`}}function k4(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function NA(e){return k4(e).replace(/%3B/gi,";")}function tB(e){return k4(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function zA(e){return decodeURIComponent(e)}function S4(e){return zA(e.replace(/\+/g,"%20"))}function T4(e){return`${tB(e.path)}${function _9(e){return Object.keys(e).map(n=>`;${tB(n)}=${tB(e[n])}`).join("")}(e.parameters)}`}const y9=/^[^\/()?;#]+/;function eB(e){const n=e.match(y9);return n?n[0]:""}const v9=/^[^\/()?;=#]+/,w9=/^[^=?&#]+/,M9=/^[^&#]+/;class k9{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new sr([],{}):new sr([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(n.length>0||Object.keys(t).length>0)&&(r[ln]=new sr(n,t)),r}parseSegment(){const n=eB(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new Rt(4009,!1);return this.capture(n),new kC(zA(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const t=function x9(e){const n=e.match(v9);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const a=eB(this.remaining);a&&(r=a,this.capture(r))}n[zA(t)]=zA(r)}parseQueryParam(n){const t=function C9(e){const n=e.match(w9);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const h=function D9(e){const n=e.match(M9);return n?n[0]:""}(this.remaining);h&&(r=h,this.capture(r))}const a=S4(t),c=S4(r);if(n.hasOwnProperty(a)){let h=n[a];Array.isArray(h)||(h=[h],n[a]=h),h.push(c)}else n[a]=c}parseParens(n){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=eB(this.remaining),a=this.remaining[r.length];if("/"!==a&&")"!==a&&";"!==a)throw new Rt(4010,!1);let c;r.indexOf(":")>-1?(c=r.slice(0,r.indexOf(":")),this.capture(c),this.capture(":")):n&&(c=ln);const h=this.parseChildren();t[c]=1===Object.keys(h).length?h[ln]:new sr([],h),this.consumeOptional("//")}return t}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new Rt(4011,!1)}}function E4(e){return e.segments.length>0?new sr([],{[ln]:e}):e}function A4(e){const n={};for(const r of Object.keys(e.children)){const c=A4(e.children[r]);if(r===ln&&0===c.segments.length&&c.hasChildren())for(const[h,f]of Object.entries(c.children))n[h]=f;else(c.segments.length>0||c.hasChildren())&&(n[r]=c)}return function S9(e){if(1===e.numberOfChildren&&e.children[ln]){const n=e.children[ln];return new sr(e.segments.concat(n.segments),n.children)}return e}(new sr(e.segments,n))}function i_(e){return e instanceof pv}function I4(e){let n;const a=E4(function t(c){const h={};for(const b of c.children){const x=t(b);h[b.outlet]=x}const f=new sr(c.url,h);return c===e&&(n=f),f}(e.root));return n??a}function R4(e,n,t,r){let a=e;for(;a.parent;)a=a.parent;if(0===n.length)return iB(a,a,a,t,r);const c=function E9(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new O4(!0,0,e);let n=0,t=!1;const r=e.reduce((a,c,h)=>{if("object"==typeof c&&null!=c){if(c.outlets){const f={};return Object.entries(c.outlets).forEach(([b,x])=>{f[b]="string"==typeof x?x.split("/"):x}),[...a,{outlets:f}]}if(c.segmentPath)return[...a,c.segmentPath]}return"string"!=typeof c?[...a,c]:0===h?(c.split("/").forEach((f,b)=>{0==b&&"."===f||(0==b&&""===f?t=!0:".."===f?n++:""!=f&&a.push(f))}),a):[...a,c]},[]);return new O4(t,n,r)}(n);if(c.toRoot())return iB(a,a,new sr([],{}),t,r);const h=function A9(e,n,t){if(e.isAbsolute)return new jA(n,!0,0);if(!t)return new jA(n,!1,NaN);if(null===t.parent)return new jA(t,!0,0);const r=VA(e.commands[0])?0:1;return function I9(e,n,t){let r=e,a=n,c=t;for(;c>a;){if(c-=a,r=r.parent,!r)throw new Rt(4005,!1);a=r.segments.length}return new jA(r,!1,a-c)}(t,t.segments.length-1+r,e.numberOfDoubleDots)}(c,a,e),f=h.processChildren?AC(h.segmentGroup,h.index,c.commands):F4(h.segmentGroup,h.index,c.commands);return iB(a,h.segmentGroup,f,t,r)}function VA(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function EC(e){return"object"==typeof e&&null!=e&&e.outlets}function iB(e,n,t,r,a){let h,c={};r&&Object.entries(r).forEach(([b,x])=>{c[b]=Array.isArray(x)?x.map(M=>`${M}`):`${x}`}),h=e===n?t:P4(e,n,t);const f=E4(A4(h));return new pv(f,c,a)}function P4(e,n,t){const r={};return Object.entries(e.children).forEach(([a,c])=>{r[a]=c===n?t:P4(c,n,t)}),new sr(e.segments,r)}class O4{constructor(n,t,r){if(this.isAbsolute=n,this.numberOfDoubleDots=t,this.commands=r,n&&r.length>0&&VA(r[0]))throw new Rt(4003,!1);const a=r.find(EC);if(a&&a!==v4(r))throw new Rt(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class jA{constructor(n,t,r){this.segmentGroup=n,this.processChildren=t,this.index=r}}function F4(e,n,t){if(e||(e=new sr([],{})),0===e.segments.length&&e.hasChildren())return AC(e,n,t);const r=function P9(e,n,t){let r=0,a=n;const c={match:!1,pathIndex:0,commandIndex:0};for(;a<e.segments.length;){if(r>=t.length)return c;const h=e.segments[a],f=t[r];if(EC(f))break;const b=`${f}`,x=r<t.length-1?t[r+1]:null;if(a>0&&void 0===b)break;if(b&&x&&"object"==typeof x&&void 0===x.outlets){if(!B4(b,x,h))return c;r+=2}else{if(!B4(b,{},h))return c;r++}a++}return{match:!0,pathIndex:a,commandIndex:r}}(e,n,t),a=t.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){const c=new sr(e.segments.slice(0,r.pathIndex),{});return c.children[ln]=new sr(e.segments.slice(r.pathIndex),e.children),AC(c,0,a)}return r.match&&0===a.length?new sr(e.segments,{}):r.match&&!e.hasChildren()?nB(e,n,t):r.match?AC(e,0,a):nB(e,n,t)}function AC(e,n,t){if(0===t.length)return new sr(e.segments,{});{const r=function R9(e){return EC(e[0])?e[0].outlets:{[ln]:e}}(t),a={};if(Object.keys(r).some(c=>c!==ln)&&e.children[ln]&&1===e.numberOfChildren&&0===e.children[ln].segments.length){const c=AC(e.children[ln],n,t);return new sr(e.segments,c.children)}return Object.entries(r).forEach(([c,h])=>{"string"==typeof h&&(h=[h]),null!==h&&(a[c]=F4(e.children[c],n,h))}),Object.entries(e.children).forEach(([c,h])=>{void 0===r[c]&&(a[c]=h)}),new sr(e.segments,a)}}function nB(e,n,t){const r=e.segments.slice(0,n);let a=0;for(;a<t.length;){const c=t[a];if(EC(c)){const b=O9(c.outlets);return new sr(r,b)}if(0===a&&VA(t[0])){r.push(new kC(e.segments[n].path,L4(t[0]))),a++;continue}const h=EC(c)?c.outlets[ln]:`${c}`,f=a<t.length-1?t[a+1]:null;h&&f&&VA(f)?(r.push(new kC(h,L4(f))),a+=2):(r.push(new kC(h,{})),a++)}return new sr(r,{})}function O9(e){const n={};return Object.entries(e).forEach(([t,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(n[t]=nB(new sr([],{}),0,r))}),n}function L4(e){const n={};return Object.entries(e).forEach(([t,r])=>n[t]=`${r}`),n}function B4(e,n,t){return e==t.path&&Hd(n,t.parameters)}const IC="imperative";class $d{constructor(n,t){this.id=n,this.url=t}}class UA extends $d{constructor(n,t,r="imperative",a=null){super(n,t),this.type=0,this.navigationTrigger=r,this.restoredState=a}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Sp extends $d{constructor(n,t,r){super(n,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class RC extends $d{constructor(n,t,r,a){super(n,t),this.reason=r,this.code=a,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class fv extends $d{constructor(n,t,r,a){super(n,t),this.reason=r,this.code=a,this.type=16}}class HA extends $d{constructor(n,t,r,a){super(n,t),this.error=r,this.target=a,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class N4 extends $d{constructor(n,t,r,a){super(n,t),this.urlAfterRedirects=r,this.state=a,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class F9 extends $d{constructor(n,t,r,a){super(n,t),this.urlAfterRedirects=r,this.state=a,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class L9 extends $d{constructor(n,t,r,a,c){super(n,t),this.urlAfterRedirects=r,this.state=a,this.shouldActivate=c,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class B9 extends $d{constructor(n,t,r,a){super(n,t),this.urlAfterRedirects=r,this.state=a,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class N9 extends $d{constructor(n,t,r,a){super(n,t),this.urlAfterRedirects=r,this.state=a,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class z9{constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class V9{constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class j9{constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class U9{constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class H9{constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $9{constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class z4{constructor(n,t,r){this.routerEvent=n,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class rB{}class oB{constructor(n){this.url=n}}class G9{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new PC,this.attachRef=null}}let PC=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const a=this.getOrCreateContext(t);a.outlet=r,this.contexts.set(t,a)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new G9,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class V4{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const t=this.pathFromRoot(n);return t.length>1?t[t.length-2]:null}children(n){const t=sB(n,this._root);return t?t.children.map(r=>r.value):[]}firstChild(n){const t=sB(n,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(n){const t=aB(n,this._root);return t.length<2?[]:t[t.length-2].children.map(a=>a.value).filter(a=>a!==n)}pathFromRoot(n){return aB(n,this._root).map(t=>t.value)}}function sB(e,n){if(e===n.value)return n;for(const t of n.children){const r=sB(e,t);if(r)return r}return null}function aB(e,n){if(e===n.value)return[n];for(const t of n.children){const r=aB(e,t);if(r.length)return r.unshift(n),r}return[]}class ph{constructor(n,t){this.value=n,this.children=t}toString(){return`TreeNode(${this.value})`}}function gv(e){const n={};return e&&e.children.forEach(t=>n[t.value.outlet]=t),n}class j4 extends V4{constructor(n,t){super(n),this.snapshot=t,lB(this,n)}toString(){return this.snapshot.toString()}}function U4(e,n){const t=function W9(e,n){const h=new $A([],{},{},"",{},ln,n,null,{});return new $4("",new ph(h,[]))}(0,n),r=new Yr([new kC("",{})]),a=new Yr({}),c=new Yr({}),h=new Yr({}),f=new Yr(""),b=new _v(r,a,h,f,c,ln,n,t.root);return b.snapshot=t.root,new j4(new ph(b,[]),t)}class _v{constructor(n,t,r,a,c,h,f,b){this.urlSubject=n,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=a,this.dataSubject=c,this.outlet=h,this.component=f,this._futureSnapshot=b,this.title=this.dataSubject?.pipe(Ti(x=>x[DC]))??Le(void 0),this.url=n,this.params=t,this.queryParams=r,this.fragment=a,this.data=c}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ti(n=>mv(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ti(n=>mv(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function H4(e,n="emptyOnly"){const t=e.pathFromRoot;let r=0;if("always"!==n)for(r=t.length-1;r>=1;){const a=t[r],c=t[r-1];if(a.routeConfig&&""===a.routeConfig.path)r--;else{if(c.component)break;r--}}return function q9(e){return e.reduce((n,t)=>({params:{...n.params,...t.params},data:{...n.data,...t.data},resolve:{...t.data,...n.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class $A{get title(){return this.data?.[DC]}constructor(n,t,r,a,c,h,f,b,x){this.url=n,this.params=t,this.queryParams=r,this.fragment=a,this.data=c,this.outlet=h,this.component=f,this.routeConfig=b,this._resolve=x}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=mv(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=mv(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class $4 extends V4{constructor(n,t){super(t),this.url=n,lB(this,t)}toString(){return G4(this._root)}}function lB(e,n){n.value._routerState=e,n.children.forEach(t=>lB(e,t))}function G4(e){const n=e.children.length>0?` { ${e.children.map(G4).join(", ")} } `:"";return`${e.value}${n}`}function cB(e){if(e.snapshot){const n=e.snapshot,t=e._futureSnapshot;e.snapshot=t,Hd(n.queryParams,t.queryParams)||e.queryParamsSubject.next(t.queryParams),n.fragment!==t.fragment&&e.fragmentSubject.next(t.fragment),Hd(n.params,t.params)||e.paramsSubject.next(t.params),function c9(e,n){if(e.length!==n.length)return!1;for(let t=0;t<e.length;++t)if(!Hd(e[t],n[t]))return!1;return!0}(n.url,t.url)||e.urlSubject.next(t.url),Hd(n.data,t.data)||e.dataSubject.next(t.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function dB(e,n){const t=Hd(e.params,n.params)&&function m9(e,n){return e_(e,n)&&e.every((t,r)=>Hd(t.parameters,n[r].parameters))}(e.url,n.url);return t&&!(!e.parent!=!n.parent)&&(!e.parent||dB(e.parent,n.parent))}let uB=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ln,this.activateEvents=new me,this.deactivateEvents=new me,this.attachEvents=new me,this.detachEvents=new me,this.parentContexts=oe(PC),this.location=oe(hr),this.changeDetector=oe(Et),this.environmentInjector=oe(Ko),this.inputBinder=oe(GA,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:r,previousValue:a}=t.name;if(r)return;this.isTrackedInParentContexts(a)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(a)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Rt(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Rt(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Rt(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Rt(4013,!1);this._activatedRoute=t;const a=this.location,h=t.snapshot.component,f=this.parentContexts.getOrCreateContext(this.name).children,b=new Y9(t,f,a.injector);this.activated=a.createComponent(h,{index:a.length,injector:b,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275dir=Mt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Bn]})}return e})();class Y9{constructor(n,t,r){this.route=n,this.childContexts=t,this.parent=r}get(n,t){return n===_v?this.route:n===PC?this.childContexts:this.parent.get(n,t)}}const GA=new kt("");let W4=(()=>{class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:r}=t,a=Jg([r.queryParams,r.params,r.data]).pipe(Ci(([c,h,f],b)=>(f={...c,...h,...f},0===b?Le(f):Promise.resolve(f)))).subscribe(c=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(t);const h=function SW(e){const n=yn(e);if(!n)return null;const t=new bg(n);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}(r.component);if(h)for(const{templateName:f}of h.inputs)t.activatedComponentRef.setInput(f,c[f]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,a)}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();function OC(e,n,t){if(t&&e.shouldReuseRoute(n.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=n.value;const a=function X9(e,n,t){return n.children.map(r=>{for(const a of t.children)if(e.shouldReuseRoute(r.value,a.value.snapshot))return OC(e,r,a);return OC(e,r)})}(e,n,t);return new ph(r,a)}{if(e.shouldAttach(n.value)){const c=e.retrieve(n.value);if(null!==c){const h=c.route;return h.value._futureSnapshot=n.value,h.children=n.children.map(f=>OC(e,f)),h}}const r=function K9(e){return new _v(new Yr(e.url),new Yr(e.params),new Yr(e.queryParams),new Yr(e.fragment),new Yr(e.data),e.outlet,e.component,e)}(n.value),a=n.children.map(c=>OC(e,c));return new ph(r,a)}}const hB="ngNavigationCancelingError";function q4(e,n){const{redirectTo:t,navigationBehaviorOptions:r}=i_(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,a=Y4(!1,0,n);return a.url=t,a.navigationBehaviorOptions=r,a}function Y4(e,n,t){const r=new Error("NavigationCancelingError: "+(e||""));return r[hB]=!0,r.cancellationCode=n,t&&(r.url=t),r}function Z4(e){return e&&e[hB]}let X4=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275cmp=Ye({type:e,selectors:[["ng-component"]],standalone:!0,features:[E1],decls:1,vars:0,template:function(r,a){1&r&&je(0,"router-outlet")},dependencies:[uB],encapsulation:2})}return e})();function mB(e){const n=e.children&&e.children.map(mB),t=n?{...e,children:n}:{...e};return!t.component&&!t.loadComponent&&(n||t.loadChildren)&&t.outlet&&t.outlet!==ln&&(t.component=X4),t}function qc(e){return e.outlet||ln}function FC(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let n=e.parent;n;n=n.parent){const t=n.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class oY{constructor(n,t,r,a,c){this.routeReuseStrategy=n,this.futureState=t,this.currState=r,this.forwardEvent=a,this.inputBindingEnabled=c}activate(n){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,n),cB(this.futureState.root),this.activateChildRoutes(t,r,n)}deactivateChildRoutes(n,t,r){const a=gv(t);n.children.forEach(c=>{const h=c.value.outlet;this.deactivateRoutes(c,a[h],r),delete a[h]}),Object.values(a).forEach(c=>{this.deactivateRouteAndItsChildren(c,r)})}deactivateRoutes(n,t,r){const a=n.value,c=t?t.value:null;if(a===c)if(a.component){const h=r.getContext(a.outlet);h&&this.deactivateChildRoutes(n,t,h.children)}else this.deactivateChildRoutes(n,t,r);else c&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(n,t){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,t):this.deactivateRouteAndOutlet(n,t)}detachAndStoreRouteSubtree(n,t){const r=t.getContext(n.value.outlet),a=r&&n.value.component?r.children:t,c=gv(n);for(const h of Object.keys(c))this.deactivateRouteAndItsChildren(c[h],a);if(r&&r.outlet){const h=r.outlet.detach(),f=r.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:h,route:n,contexts:f})}}deactivateRouteAndOutlet(n,t){const r=t.getContext(n.value.outlet),a=r&&n.value.component?r.children:t,c=gv(n);for(const h of Object.keys(c))this.deactivateRouteAndItsChildren(c[h],a);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(n,t,r){const a=gv(t);n.children.forEach(c=>{this.activateRoutes(c,a[c.value.outlet],r),this.forwardEvent(new $9(c.value.snapshot))}),n.children.length&&this.forwardEvent(new U9(n.value.snapshot))}activateRoutes(n,t,r){const a=n.value,c=t?t.value:null;if(cB(a),a===c)if(a.component){const h=r.getOrCreateContext(a.outlet);this.activateChildRoutes(n,t,h.children)}else this.activateChildRoutes(n,t,r);else if(a.component){const h=r.getOrCreateContext(a.outlet);if(this.routeReuseStrategy.shouldAttach(a.snapshot)){const f=this.routeReuseStrategy.retrieve(a.snapshot);this.routeReuseStrategy.store(a.snapshot,null),h.children.onOutletReAttached(f.contexts),h.attachRef=f.componentRef,h.route=f.route.value,h.outlet&&h.outlet.attach(f.componentRef,f.route.value),cB(f.route.value),this.activateChildRoutes(n,null,h.children)}else{const f=FC(a.snapshot);h.attachRef=null,h.route=a,h.injector=f,h.outlet&&h.outlet.activateWith(a,h.injector),this.activateChildRoutes(n,null,h.children)}}else this.activateChildRoutes(n,null,r)}}class K4{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class WA{constructor(n,t){this.component=n,this.route=t}}function sY(e,n,t){const r=e._root;return LC(r,n?n._root:null,t,[r.value])}function bv(e,n){const t=Symbol(),r=n.get(e,t);return r===t?"function"!=typeof e||function b0(e){return null!==cd(e)}(e)?n.get(e):e:r}function LC(e,n,t,r,a={canDeactivateChecks:[],canActivateChecks:[]}){const c=gv(n);return e.children.forEach(h=>{(function lY(e,n,t,r,a={canDeactivateChecks:[],canActivateChecks:[]}){const c=e.value,h=n?n.value:null,f=t?t.getContext(e.value.outlet):null;if(h&&c.routeConfig===h.routeConfig){const b=function cY(e,n,t){if("function"==typeof t)return t(e,n);switch(t){case"pathParamsChange":return!e_(e.url,n.url);case"pathParamsOrQueryParamsChange":return!e_(e.url,n.url)||!Hd(e.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!dB(e,n)||!Hd(e.queryParams,n.queryParams);default:return!dB(e,n)}}(h,c,c.routeConfig.runGuardsAndResolvers);b?a.canActivateChecks.push(new K4(r)):(c.data=h.data,c._resolvedData=h._resolvedData),LC(e,n,c.component?f?f.children:null:t,r,a),b&&f&&f.outlet&&f.outlet.isActivated&&a.canDeactivateChecks.push(new WA(f.outlet.component,h))}else h&&BC(n,f,a),a.canActivateChecks.push(new K4(r)),LC(e,null,c.component?f?f.children:null:t,r,a)})(h,c[h.value.outlet],t,r.concat([h.value]),a),delete c[h.value.outlet]}),Object.entries(c).forEach(([h,f])=>BC(f,t.getContext(h),a)),a}function BC(e,n,t){const r=gv(e),a=e.value;Object.entries(r).forEach(([c,h])=>{BC(h,a.component?n?n.children.getContext(c):null:n,t)}),t.canDeactivateChecks.push(new WA(a.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,a))}function NC(e){return"function"==typeof e}function Q4(e){return e instanceof PA||"EmptyError"===e?.name}const qA=Symbol("INITIAL_VALUE");function yv(){return Ci(e=>Jg(e.map(n=>n.pipe(nr(1),Ws(qA)))).pipe(Ti(n=>{for(const t of n)if(!0!==t){if(t===qA)return qA;if(!1===t||t instanceof pv)return t}return!0}),rr(n=>n!==qA),nr(1)))}function J4(e){return function Jd(...e){return id(e)}(Co(n=>{if(i_(n))throw q4(0,n)}),Ti(n=>!0===n))}class YA{constructor(n){this.segmentGroup=n||null}}class t5{constructor(n){this.urlTree=n}}function vv(e){return dv(new YA(e))}function e5(e){return dv(new t5(e))}class EY{constructor(n,t){this.urlSerializer=n,this.urlTree=t}noMatchError(n){return new Rt(4002,!1)}lineralizeSegments(n,t){let r=[],a=t.root;for(;;){if(r=r.concat(a.segments),0===a.numberOfChildren)return Le(r);if(a.numberOfChildren>1||!a.children[ln])return dv(new Rt(4e3,!1));a=a.children[ln]}}applyRedirectCommands(n,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),n,r)}applyRedirectCreateUrlTree(n,t,r,a){const c=this.createSegmentGroup(n,t.root,r,a);return new pv(c,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(n,t){const r={};return Object.entries(n).forEach(([a,c])=>{if("string"==typeof c&&c.startsWith(":")){const f=c.substring(1);r[a]=t[f]}else r[a]=c}),r}createSegmentGroup(n,t,r,a){const c=this.createSegments(n,t.segments,r,a);let h={};return Object.entries(t.children).forEach(([f,b])=>{h[f]=this.createSegmentGroup(n,b,r,a)}),new sr(c,h)}createSegments(n,t,r,a){return t.map(c=>c.path.startsWith(":")?this.findPosParam(n,c,a):this.findOrReturn(c,r))}findPosParam(n,t,r){const a=r[t.path.substring(1)];if(!a)throw new Rt(4001,!1);return a}findOrReturn(n,t){let r=0;for(const a of t){if(a.path===n.path)return t.splice(r),a;r++}return n}}const pB={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function AY(e,n,t,r,a){const c=fB(e,n,t);return c.matched?(r=function J9(e,n){return e.providers&&!e._injector&&(e._injector=Hy(e.providers,n,`Route: ${e.path}`)),e._injector??n}(n,r),function kY(e,n,t,r){const a=n.canMatch;return a&&0!==a.length?Le(a.map(h=>{const f=bv(h,e);return kp(function fY(e){return e&&NC(e.canMatch)}(f)?f.canMatch(n,t):e.runInContext(()=>f(n,t)))})).pipe(yv(),J4()):Le(!0)}(r,n,t).pipe(Ti(h=>!0===h?c:{...pB}))):Le(c)}function fB(e,n,t){if(""===n.path)return"full"===n.pathMatch&&(e.hasChildren()||t.length>0)?{...pB}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const a=(n.matcher||l9)(t,e,n);if(!a)return{...pB};const c={};Object.entries(a.posParams??{}).forEach(([f,b])=>{c[f]=b.path});const h=a.consumed.length>0?{...c,...a.consumed[a.consumed.length-1].parameters}:c;return{matched:!0,consumedSegments:a.consumed,remainingSegments:t.slice(a.consumed.length),parameters:h,positionalParamSegments:a.posParams??{}}}function n5(e,n,t,r){return t.length>0&&function PY(e,n,t){return t.some(r=>ZA(e,n,r)&&qc(r)!==ln)}(e,t,r)?{segmentGroup:new sr(n,RY(r,new sr(t,e.children))),slicedSegments:[]}:0===t.length&&function OY(e,n,t){return t.some(r=>ZA(e,n,r))}(e,t,r)?{segmentGroup:new sr(e.segments,IY(e,0,t,r,e.children)),slicedSegments:t}:{segmentGroup:new sr(e.segments,e.children),slicedSegments:t}}function IY(e,n,t,r,a){const c={};for(const h of r)if(ZA(e,t,h)&&!a[qc(h)]){const f=new sr([],{});c[qc(h)]=f}return{...a,...c}}function RY(e,n){const t={};t[ln]=n;for(const r of e)if(""===r.path&&qc(r)!==ln){const a=new sr([],{});t[qc(r)]=a}return t}function ZA(e,n,t){return(!(e.hasChildren()||n.length>0)||"full"!==t.pathMatch)&&""===t.path}class NY{constructor(n,t,r,a,c,h,f){this.injector=n,this.configLoader=t,this.rootComponentType=r,this.config=a,this.urlTree=c,this.paramsInheritanceStrategy=h,this.urlSerializer=f,this.allowRedirects=!0,this.applyRedirects=new EY(this.urlSerializer,this.urlTree)}noMatchError(n){return new Rt(4002,!1)}recognize(){const n=n5(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,ln).pipe(Dp(t=>{if(t instanceof t5)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof YA?this.noMatchError(t):t}),Ti(t=>{const r=new $A([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},ln,this.rootComponentType,null,{}),a=new ph(r,t),c=new $4("",a),h=function T9(e,n,t=null,r=null){return R4(I4(e),n,t,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return h.queryParams=this.urlTree.queryParams,c.url=this.urlSerializer.serialize(h),this.inheritParamsAndData(c._root),{state:c,tree:h}}))}match(n){return this.processSegmentGroup(this.injector,this.config,n.root,ln).pipe(Dp(r=>{throw r instanceof YA?this.noMatchError(r):r}))}inheritParamsAndData(n){const t=n.value,r=H4(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),n.children.forEach(a=>this.inheritParamsAndData(a))}processSegmentGroup(n,t,r,a){return 0===r.segments.length&&r.hasChildren()?this.processChildren(n,t,r):this.processSegment(n,t,r,r.segments,a,!0)}processChildren(n,t,r){const a=[];for(const c of Object.keys(r.children))"primary"===c?a.unshift(c):a.push(c);return Er(a).pipe(uv(c=>{const h=r.children[c],f=function nY(e,n){const t=e.filter(r=>qc(r)===n);return t.push(...e.filter(r=>qc(r)!==n)),t}(t,c);return this.processSegmentGroup(n,f,h,c)}),function o9(e,n){return pr(function r9(e,n,t,r,a){return(c,h)=>{let f=t,b=n,x=0;c.subscribe(jn(h,M=>{const T=x++;b=f?e(b,M,T):(f=!0,M),r&&h.next(b)},a&&(()=>{f&&h.next(b),h.complete()})))}}(e,n,arguments.length>=2,!0))}((c,h)=>(c.push(...h),c)),OA(null),function s9(e,n){const t=arguments.length>=2;return r=>r.pipe(e?rr((a,c)=>e(a,c,r)):Al,QL(1),t?OA(n):b4(()=>new PA))}(),xr(c=>{if(null===c)return vv(r);const h=r5(c);return function zY(e){e.sort((n,t)=>n.value.outlet===ln?-1:t.value.outlet===ln?1:n.value.outlet.localeCompare(t.value.outlet))}(h),Le(h)}))}processSegment(n,t,r,a,c,h){return Er(t).pipe(uv(f=>this.processSegmentAgainstRoute(f._injector??n,t,f,r,a,c,h).pipe(Dp(b=>{if(b instanceof YA)return Le(null);throw b}))),t_(f=>!!f),Dp(f=>{if(Q4(f))return function LY(e,n,t){return 0===n.length&&!e.children[t]}(r,a,c)?Le([]):vv(r);throw f}))}processSegmentAgainstRoute(n,t,r,a,c,h,f){return function FY(e,n,t,r){return!!(qc(e)===r||r!==ln&&ZA(n,t,e))&&("**"===e.path||fB(n,e,t).matched)}(r,a,c,h)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(n,a,r,c,h,f):f&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,a,t,r,c,h):vv(a):vv(a)}expandSegmentAgainstRouteUsingRedirect(n,t,r,a,c,h){return"**"===a.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,r,a,h):this.expandRegularSegmentAgainstRouteUsingRedirect(n,t,r,a,c,h)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,t,r,a){const c=this.applyRedirects.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?e5(c):this.applyRedirects.lineralizeSegments(r,c).pipe(xr(h=>{const f=new sr(h,{});return this.processSegment(n,t,f,h,a,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,t,r,a,c,h){const{matched:f,consumedSegments:b,remainingSegments:x,positionalParamSegments:M}=fB(t,a,c);if(!f)return vv(t);const T=this.applyRedirects.applyRedirectCommands(b,a.redirectTo,M);return a.redirectTo.startsWith("/")?e5(T):this.applyRedirects.lineralizeSegments(a,T).pipe(xr(I=>this.processSegment(n,r,t,I.concat(x),h,!1)))}matchSegmentAgainstRoute(n,t,r,a,c,h){let f;if("**"===r.path){const b=a.length>0?v4(a).parameters:{};f=Le({snapshot:new $A(a,b,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,o5(r),qc(r),r.component??r._loadedComponent??null,r,s5(r)),consumedSegments:[],remainingSegments:[]}),t.children={}}else f=AY(t,r,a,n).pipe(Ti(({matched:b,consumedSegments:x,remainingSegments:M,parameters:T})=>b?{snapshot:new $A(x,T,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,o5(r),qc(r),r.component??r._loadedComponent??null,r,s5(r)),consumedSegments:x,remainingSegments:M}:null));return f.pipe(Ci(b=>null===b?vv(t):this.getChildConfig(n=r._injector??n,r,a).pipe(Ci(({routes:x})=>{const M=r._loadedInjector??n,{snapshot:T,consumedSegments:I,remainingSegments:L}=b,{segmentGroup:N,slicedSegments:V}=n5(t,I,L,x);if(0===V.length&&N.hasChildren())return this.processChildren(M,x,N).pipe(Ti(nt=>null===nt?null:[new ph(T,nt)]));if(0===x.length&&0===V.length)return Le([new ph(T,[])]);const $=qc(r)===c;return this.processSegment(M,x,N,V,$?ln:c,!0).pipe(Ti(nt=>[new ph(T,nt)]))}))))}getChildConfig(n,t,r){return t.children?Le({routes:t.children,injector:n}):t.loadChildren?void 0!==t._loadedRoutes?Le({routes:t._loadedRoutes,injector:t._loadedInjector}):function DY(e,n,t,r){const a=n.canLoad;return void 0===a||0===a.length?Le(!0):Le(a.map(h=>{const f=bv(h,e);return kp(function uY(e){return e&&NC(e.canLoad)}(f)?f.canLoad(n,t):e.runInContext(()=>f(n,t)))})).pipe(yv(),J4())}(n,t,r).pipe(xr(a=>a?this.configLoader.loadChildren(n,t).pipe(Co(c=>{t._loadedRoutes=c.routes,t._loadedInjector=c.injector})):function TY(e){return dv(Y4(!1,3))}())):Le({routes:[],injector:n})}}function VY(e){const n=e.value.routeConfig;return n&&""===n.path}function r5(e){const n=[],t=new Set;for(const r of e){if(!VY(r)){n.push(r);continue}const a=n.find(c=>r.value.routeConfig===c.value.routeConfig);void 0!==a?(a.children.push(...r.children),t.add(a)):n.push(r)}for(const r of t){const a=r5(r.children);n.push(new ph(r.value,a))}return n.filter(r=>!t.has(r))}function o5(e){return e.data||{}}function s5(e){return e.resolve||{}}function a5(e){return"string"==typeof e.title||null===e.title}function gB(e){return Ci(n=>{const t=e(n);return t?Er(t).pipe(Ti(()=>n)):Le(n)})}const xv=new kt("ROUTES");let _B=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=oe(nA)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Le(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=kp(t.loadComponent()).pipe(Ti(l5),Co(c=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=c}),hv(()=>{this.componentLoaders.delete(t)})),a=new KL(r,()=>new we).pipe(XL());return this.componentLoaders.set(t,a),a}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Le({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const c=function qY(e,n,t,r){return kp(e.loadChildren()).pipe(Ti(l5),xr(a=>a instanceof M1||Array.isArray(a)?Le(a):Er(n.compileModuleAsync(a))),Ti(a=>{r&&r(e);let c,h,f=!1;return Array.isArray(a)?(h=a,!0):(c=a.create(t).injector,h=c.get(xv,[],{optional:!0,self:!0}).flat()),{routes:h.map(mB),injector:c}}))}(r,this.compiler,t,this.onLoadEndListener).pipe(hv(()=>{this.childrenLoaders.delete(r)})),h=new KL(c,()=>new we).pipe(XL());return this.childrenLoaders.set(r,h),h}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function l5(e){return function YY(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}let XA=(()=>{class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new we,this.transitionAbortSubject=new we,this.configLoader=oe(_B),this.environmentInjector=oe(Ko),this.urlSerializer=oe(SC),this.rootContexts=oe(PC),this.inputBindingEnabled=null!==oe(GA,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Le(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=a=>this.events.next(new V9(a)),this.configLoader.onLoadStartListener=a=>this.events.next(new z9(a))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:r})}setupNavigations(t,r,a){return this.transitions=new Yr({id:0,currentUrlTree:r,currentRawUrl:r,currentBrowserUrl:r,extractedUrl:t.urlHandlingStrategy.extract(r),urlAfterRedirects:t.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:IC,restoredState:null,currentSnapshot:a.snapshot,targetSnapshot:null,currentRouterState:a,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(rr(c=>0!==c.id),Ti(c=>({...c,extractedUrl:t.urlHandlingStrategy.extract(c.rawUrl)})),Ci(c=>{this.currentTransition=c;let h=!1,f=!1;return Le(c).pipe(Co(b=>{this.currentNavigation={id:b.id,initialUrl:b.rawUrl,extractedUrl:b.extractedUrl,trigger:b.source,extras:b.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Ci(b=>{const x=b.currentBrowserUrl.toString(),M=!t.navigated||b.extractedUrl.toString()!==x||x!==b.currentUrlTree.toString();if(!M&&"reload"!==(b.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const I="";return this.events.next(new fv(b.id,this.urlSerializer.serialize(b.rawUrl),I,0)),b.resolve(null),xa}if(t.urlHandlingStrategy.shouldProcessUrl(b.rawUrl))return Le(b).pipe(Ci(I=>{const L=this.transitions?.getValue();return this.events.next(new UA(I.id,this.urlSerializer.serialize(I.extractedUrl),I.source,I.restoredState)),L!==this.transitions?.getValue()?xa:Promise.resolve(I)}),function jY(e,n,t,r,a,c){return xr(h=>function BY(e,n,t,r,a,c,h="emptyOnly"){return new NY(e,n,t,r,a,h,c).recognize()}(e,n,t,r,h.extractedUrl,a,c).pipe(Ti(({state:f,tree:b})=>({...h,targetSnapshot:f,urlAfterRedirects:b}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),Co(I=>{c.targetSnapshot=I.targetSnapshot,c.urlAfterRedirects=I.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:I.urlAfterRedirects};const L=new N4(I.id,this.urlSerializer.serialize(I.extractedUrl),this.urlSerializer.serialize(I.urlAfterRedirects),I.targetSnapshot);this.events.next(L)}));if(M&&t.urlHandlingStrategy.shouldProcessUrl(b.currentRawUrl)){const{id:I,extractedUrl:L,source:N,restoredState:V,extras:$}=b,nt=new UA(I,this.urlSerializer.serialize(L),N,V);this.events.next(nt);const tt=U4(0,this.rootComponentType).snapshot;return this.currentTransition=c={...b,targetSnapshot:tt,urlAfterRedirects:L,extras:{...$,skipLocationChange:!1,replaceUrl:!1}},Le(c)}{const I="";return this.events.next(new fv(b.id,this.urlSerializer.serialize(b.extractedUrl),I,1)),b.resolve(null),xa}}),Co(b=>{const x=new F9(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot);this.events.next(x)}),Ti(b=>(this.currentTransition=c={...b,guards:sY(b.targetSnapshot,b.currentSnapshot,this.rootContexts)},c)),function _Y(e,n){return xr(t=>{const{targetSnapshot:r,currentSnapshot:a,guards:{canActivateChecks:c,canDeactivateChecks:h}}=t;return 0===h.length&&0===c.length?Le({...t,guardsResult:!0}):function bY(e,n,t,r){return Er(e).pipe(xr(a=>function MY(e,n,t,r,a){const c=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return c&&0!==c.length?Le(c.map(f=>{const b=FC(n)??a,x=bv(f,b);return kp(function pY(e){return e&&NC(e.canDeactivate)}(x)?x.canDeactivate(e,n,t,r):b.runInContext(()=>x(e,n,t,r))).pipe(t_())})).pipe(yv()):Le(!0)}(a.component,a.route,t,n,r)),t_(a=>!0!==a,!0))}(h,r,a,e).pipe(xr(f=>f&&function dY(e){return"boolean"==typeof e}(f)?function yY(e,n,t,r){return Er(n).pipe(uv(a=>MC(function xY(e,n){return null!==e&&n&&n(new j9(e)),Le(!0)}(a.route.parent,r),function vY(e,n){return null!==e&&n&&n(new H9(e)),Le(!0)}(a.route,r),function CY(e,n,t){const r=n[n.length-1],c=n.slice(0,n.length-1).reverse().map(h=>function aY(e){const n=e.routeConfig?e.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:e,guards:n}:null}(h)).filter(h=>null!==h).map(h=>cv(()=>Le(h.guards.map(b=>{const x=FC(h.node)??t,M=bv(b,x);return kp(function mY(e){return e&&NC(e.canActivateChild)}(M)?M.canActivateChild(r,e):x.runInContext(()=>M(r,e))).pipe(t_())})).pipe(yv())));return Le(c).pipe(yv())}(e,a.path,t),function wY(e,n,t){const r=n.routeConfig?n.routeConfig.canActivate:null;if(!r||0===r.length)return Le(!0);const a=r.map(c=>cv(()=>{const h=FC(n)??t,f=bv(c,h);return kp(function hY(e){return e&&NC(e.canActivate)}(f)?f.canActivate(n,e):h.runInContext(()=>f(n,e))).pipe(t_())}));return Le(a).pipe(yv())}(e,a.route,t))),t_(a=>!0!==a,!0))}(r,c,e,n):Le(f)),Ti(f=>({...t,guardsResult:f})))})}(this.environmentInjector,b=>this.events.next(b)),Co(b=>{if(c.guardsResult=b.guardsResult,i_(b.guardsResult))throw q4(0,b.guardsResult);const x=new L9(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot,!!b.guardsResult);this.events.next(x)}),rr(b=>!!b.guardsResult||(this.cancelNavigationTransition(b,"",3),!1)),gB(b=>{if(b.guards.canActivateChecks.length)return Le(b).pipe(Co(x=>{const M=new B9(x.id,this.urlSerializer.serialize(x.extractedUrl),this.urlSerializer.serialize(x.urlAfterRedirects),x.targetSnapshot);this.events.next(M)}),Ci(x=>{let M=!1;return Le(x).pipe(function UY(e,n){return xr(t=>{const{targetSnapshot:r,guards:{canActivateChecks:a}}=t;if(!a.length)return Le(t);let c=0;return Er(a).pipe(uv(h=>function HY(e,n,t,r){const a=e.routeConfig,c=e._resolve;return void 0!==a?.title&&!a5(a)&&(c[DC]=a.title),function $Y(e,n,t,r){const a=function GY(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}(e);if(0===a.length)return Le({});const c={};return Er(a).pipe(xr(h=>function WY(e,n,t,r){const a=FC(n)??r,c=bv(e,a);return kp(c.resolve?c.resolve(n,t):a.runInContext(()=>c(n,t)))}(e[h],n,t,r).pipe(t_(),Co(f=>{c[h]=f}))),QL(1),FA(c),Dp(h=>Q4(h)?xa:dv(h)))}(c,e,n,r).pipe(Ti(h=>(e._resolvedData=h,e.data=H4(e,t).resolve,a&&a5(a)&&(e.data[DC]=a.title),null)))}(h.route,r,e,n)),Co(()=>c++),QL(1),xr(h=>c===a.length?Le(t):xa))})}(t.paramsInheritanceStrategy,this.environmentInjector),Co({next:()=>M=!0,complete:()=>{M||this.cancelNavigationTransition(x,"",2)}}))}),Co(x=>{const M=new N9(x.id,this.urlSerializer.serialize(x.extractedUrl),this.urlSerializer.serialize(x.urlAfterRedirects),x.targetSnapshot);this.events.next(M)}))}),gB(b=>{const x=M=>{const T=[];M.routeConfig?.loadComponent&&!M.routeConfig._loadedComponent&&T.push(this.configLoader.loadComponent(M.routeConfig).pipe(Co(I=>{M.component=I}),Ti(()=>{})));for(const I of M.children)T.push(...x(I));return T};return Jg(x(b.targetSnapshot.root)).pipe(OA(),nr(1))}),gB(()=>this.afterPreactivation()),Ti(b=>{const x=function Z9(e,n,t){const r=OC(e,n._root,t?t._root:void 0);return new j4(r,n)}(t.routeReuseStrategy,b.targetSnapshot,b.currentRouterState);return this.currentTransition=c={...b,targetRouterState:x},c}),Co(()=>{this.events.next(new rB)}),((e,n,t,r)=>Ti(a=>(new oY(n,a.targetRouterState,a.currentRouterState,t,r).activate(e),a)))(this.rootContexts,t.routeReuseStrategy,b=>this.events.next(b),this.inputBindingEnabled),nr(1),Co({next:b=>{h=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Sp(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects))),t.titleStrategy?.updateTitle(b.targetRouterState.snapshot),b.resolve(!0)},complete:()=>{h=!0}}),Si(this.transitionAbortSubject.pipe(Co(b=>{throw b}))),hv(()=>{h||f||this.cancelNavigationTransition(c,"",1),this.currentNavigation?.id===c.id&&(this.currentNavigation=null)}),Dp(b=>{if(f=!0,Z4(b))this.events.next(new RC(c.id,this.urlSerializer.serialize(c.extractedUrl),b.message,b.cancellationCode)),function Q9(e){return Z4(e)&&i_(e.url)}(b)?this.events.next(new oB(b.url)):c.resolve(!1);else{this.events.next(new HA(c.id,this.urlSerializer.serialize(c.extractedUrl),b,c.targetSnapshot??void 0));try{c.resolve(t.errorHandler(b))}catch(x){c.reject(x)}}return xa}))}))}cancelNavigationTransition(t,r,a){const c=new RC(t.id,this.urlSerializer.serialize(t.extractedUrl),r,a);this.events.next(c),t.resolve(!1)}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function c5(e){return e!==IC}let d5=(()=>{class e{buildTitle(t){let r,a=t.root;for(;void 0!==a;)r=this.getResolvedTitleForRoute(a)??r,a=a.children.find(c=>c.outlet===ln);return r}getResolvedTitleForRoute(t){return t.data[DC]}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:function(){return oe(ZY)},providedIn:"root"})}return e})(),ZY=(()=>{class e extends d5{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(d4))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),XY=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:function(){return oe(QY)},providedIn:"root"})}return e})();class KY{shouldDetach(n){return!1}store(n,t){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,t){return n.routeConfig===t.routeConfig}}let QY=(()=>{class e extends KY{static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const KA=new kt("",{providedIn:"root",factory:()=>({})});let JY=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:function(){return oe(tZ)},providedIn:"root"})}return e})(),tZ=(()=>{class e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var zC=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(zC||{});function u5(e,n){e.events.pipe(rr(t=>t instanceof Sp||t instanceof RC||t instanceof HA||t instanceof fv),Ti(t=>t instanceof Sp||t instanceof fv?zC.COMPLETE:t instanceof RC&&(0===t.code||1===t.code)?zC.REDIRECTING:zC.FAILED),rr(t=>t!==zC.REDIRECTING),nr(1)).subscribe(()=>{n()})}function eZ(e){throw e}function iZ(e,n,t){return n.parse("/")}const nZ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},rZ={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let lc=(()=>{class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=oe(eA),this.isNgZoneEnabled=!1,this._events=new we,this.options=oe(KA,{optional:!0})||{},this.pendingTasks=oe(nv),this.errorHandler=this.options.errorHandler||eZ,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||iZ,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=oe(JY),this.routeReuseStrategy=oe(XY),this.titleStrategy=oe(d5),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=oe(xv,{optional:!0})?.flat()??[],this.navigationTransitions=oe(XA),this.urlSerializer=oe(SC),this.location=oe(gC),this.componentInputBindingEnabled=!!oe(GA,{optional:!0}),this.eventsSubscription=new lt,this.isNgZoneEnabled=oe(Re)instanceof Re&&Re.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new pv,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=U4(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(r=>{try{const{currentTransition:a}=this.navigationTransitions;if(null===a)return void(h5(r)&&this._events.next(r));if(r instanceof UA)c5(a.source)&&(this.browserUrlTree=a.extractedUrl);else if(r instanceof fv)this.rawUrlTree=a.rawUrl;else if(r instanceof N4){if("eager"===this.urlUpdateStrategy){if(!a.extras.skipLocationChange){const c=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl);this.setBrowserUrl(c,a)}this.browserUrlTree=a.urlAfterRedirects}}else if(r instanceof rB)this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects);else if(r instanceof RC)0!==r.code&&1!==r.code&&(this.navigated=!0),(3===r.code||2===r.code)&&this.restoreHistory(a);else if(r instanceof oB){const c=this.urlHandlingStrategy.merge(r.url,a.currentRawUrl),h={skipLocationChange:a.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||c5(a.source)};this.scheduleNavigation(c,IC,null,h,{resolve:a.resolve,reject:a.reject,promise:a.promise})}r instanceof HA&&this.restoreHistory(a,!0),r instanceof Sp&&(this.navigated=!0),h5(r)&&this._events.next(r)}catch(a){this.navigationTransitions.transitionAbortSubject.next(a)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),IC,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,r,t.state)},0)}))}navigateToSyncWithBrowser(t,r,a){const c={replaceUrl:!0},h=a?.navigationId?a:null;if(a){const b={...a};delete b.navigationId,delete b.\u0275routerPageId,0!==Object.keys(b).length&&(c.state=b)}const f=this.parseUrl(t);this.scheduleNavigation(f,r,h,c)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(mB),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){const{relativeTo:a,queryParams:c,fragment:h,queryParamsHandling:f,preserveFragment:b}=r,x=b?this.currentUrlTree.fragment:h;let T,M=null;switch(f){case"merge":M={...this.currentUrlTree.queryParams,...c};break;case"preserve":M=this.currentUrlTree.queryParams;break;default:M=c||null}null!==M&&(M=this.removeEmptyProps(M));try{T=I4(a?a.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),T=this.currentUrlTree.root}return R4(T,t,M,x??null)}navigateByUrl(t,r={skipLocationChange:!1}){const a=i_(t)?t:this.parseUrl(t),c=this.urlHandlingStrategy.merge(a,this.rawUrlTree);return this.scheduleNavigation(c,IC,null,r)}navigate(t,r={skipLocationChange:!1}){return function oZ(e){for(let n=0;n<e.length;n++)if(null==e[n])throw new Rt(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(a){r=this.malformedUriErrorHandler(a,this.urlSerializer,t)}return r}isActive(t,r){let a;if(a=!0===r?{...nZ}:!1===r?{...rZ}:r,i_(t))return w4(this.currentUrlTree,t,a);const c=this.parseUrl(t);return w4(this.currentUrlTree,c,a)}removeEmptyProps(t){return Object.keys(t).reduce((r,a)=>{const c=t[a];return null!=c&&(r[a]=c),r},{})}scheduleNavigation(t,r,a,c,h){if(this.disposed)return Promise.resolve(!1);let f,b,x;h?(f=h.resolve,b=h.reject,x=h.promise):x=new Promise((T,I)=>{f=T,b=I});const M=this.pendingTasks.add();return u5(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(M))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:a,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:c,resolve:f,reject:b,promise:x,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),x.catch(T=>Promise.reject(T))}setBrowserUrl(t,r){const a=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(a)||r.extras.replaceUrl){const h={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(a,"",h)}else{const c={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(a,"",c)}}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const c=this.currentPageId-this.browserPageId;0!==c?this.location.historyGo(c):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===c&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function h5(e){return!(e instanceof rB||e instanceof oB)}let QA=(()=>{class e{constructor(t,r,a,c,h,f){this.router=t,this.route=r,this.tabIndexAttribute=a,this.renderer=c,this.el=h,this.locationStrategy=f,this.href=null,this.commands=null,this.onChanges=new we,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const b=h.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===b||"area"===b,this.isAnchorElement?this.subscription=t.events.subscribe(x=>{x instanceof Sp&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,r,a,c,h){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||r||a||c||h||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function zx(e,n,t){return function Nx(e,n){return"src"===n&&("embed"===e||"frame"===e||"iframe"===e||"media"===e||"script"===e)||"href"===n&&("base"===e||"link"===e)?Pc:Lx}(n,t)(e)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,r){const a=this.renderer,c=this.el.nativeElement;null!==r?a.setAttribute(c,t,r):a.removeAttribute(c,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#t=this.\u0275fac=function(r){return new(r||e)(z(lc),z(_v),Ue("tabindex"),z(Bc),z(Me),z(Kg))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,a){1&r&&Se("click",function(h){return a.onClick(h.button,h.ctrlKey,h.shiftKey,h.altKey,h.metaKey)}),2&r&&Ve("target",a.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",av],skipLocationChange:["skipLocationChange","skipLocationChange",av],replaceUrl:["replaceUrl","replaceUrl",av],routerLink:"routerLink"},standalone:!0,features:[ZS,Bn]})}return e})();class m5{}let lZ=(()=>{class e{constructor(t,r,a,c,h){this.router=t,this.injector=a,this.preloadingStrategy=c,this.loader=h}setUpPreloading(){this.subscription=this.router.events.pipe(rr(t=>t instanceof Sp),uv(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const a=[];for(const c of r){c.providers&&!c._injector&&(c._injector=Hy(c.providers,t,`Route: ${c.path}`));const h=c._injector??t,f=c._loadedInjector??h;(c.loadChildren&&!c._loadedRoutes&&void 0===c.canLoad||c.loadComponent&&!c._loadedComponent)&&a.push(this.preloadConfig(h,c)),(c.children||c._loadedRoutes)&&a.push(this.processRoutes(f,c.children??c._loadedRoutes))}return Er(a).pipe(sd())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let a;a=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):Le(null);const c=a.pipe(xr(h=>null===h?Le(void 0):(r._loadedRoutes=h.routes,r._loadedInjector=h.injector,this.processRoutes(h.injector??t,h.routes))));return r.loadComponent&&!r._loadedComponent?Er([c,this.loader.loadComponent(r)]).pipe(sd()):c})}static#t=this.\u0275fac=function(r){return new(r||e)(vt(lc),vt(nA),vt(Ko),vt(m5),vt(_B))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const bB=new kt("");let p5=(()=>{class e{constructor(t,r,a,c,h={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=a,this.zone=c,this.options=h,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},h.scrollPositionRestoration=h.scrollPositionRestoration||"disabled",h.anchorScrolling=h.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof UA?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Sp?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof fv&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof z4&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new z4(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#t=this.\u0275fac=function(r){dl()};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();function fh(e,n){return{\u0275kind:e,\u0275providers:n}}function g5(){const e=oe(oo);return n=>{const t=e.get(Q);if(n!==t.components[0])return;const r=e.get(lc),a=e.get(_5);1===e.get(yB)&&r.initialNavigation(),e.get(b5,null,hn.Optional)?.setUpPreloading(),e.get(bB,null,hn.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),a.closed||(a.next(),a.complete(),a.unsubscribe())}}const _5=new kt("",{factory:()=>new we}),yB=new kt("",{providedIn:"root",factory:()=>1}),b5=new kt("");function hZ(e){return fh(0,[{provide:b5,useExisting:lZ},{provide:m5,useExisting:e}])}const y5=new kt("ROUTER_FORROOT_GUARD"),pZ=[gC,{provide:SC,useClass:JL},lc,PC,{provide:_v,useFactory:function f5(e){return e.routerState.root},deps:[lc]},_B,[]];function fZ(){return new S("Router",lc)}let v5=(()=>{class e{constructor(t){}static forRoot(t,r){return{ngModule:e,providers:[pZ,[],{provide:xv,multi:!0,useValue:t},{provide:y5,useFactory:yZ,deps:[[lc,new aa,new rl]]},{provide:KA,useValue:r||{}},r?.useHash?{provide:Kg,useClass:RW}:{provide:Kg,useClass:MV},{provide:bB,useFactory:()=>{const e=oe(Zq),n=oe(Re),t=oe(KA),r=oe(XA),a=oe(SC);return t.scrollOffset&&e.setOffset(t.scrollOffset),new p5(a,r,e,n,t)}},r?.preloadingStrategy?hZ(r.preloadingStrategy).\u0275providers:[],{provide:S,multi:!0,useFactory:fZ},r?.initialNavigation?vZ(r):[],r?.bindToComponentInputs?fh(8,[W4,{provide:GA,useExisting:W4}]).\u0275providers:[],[{provide:x5,useFactory:g5},{provide:v,multi:!0,useExisting:x5}]]}}static forChild(t){return{ngModule:e,providers:[{provide:xv,multi:!0,useValue:t}]}}static#t=this.\u0275fac=function(r){return new(r||e)(vt(y5,8))};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({})}return e})();function yZ(e){return"guarded"}function vZ(e){return["disabled"===e.initialNavigation?fh(3,[{provide:oC,multi:!0,useFactory:()=>{const n=oe(lc);return()=>{n.setUpLocationChangeListener()}}},{provide:yB,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?fh(2,[{provide:yB,useValue:0},{provide:oC,multi:!0,deps:[oo],useFactory:n=>{const t=n.get(AW,Promise.resolve());return()=>t.then(()=>new Promise(r=>{const a=n.get(lc),c=n.get(_5);u5(a,()=>{r(!0)}),n.get(XA).afterPreactivation=()=>(r(!0),c.closed?Le(void 0):c),a.initialNavigation()}))}}]).\u0275providers:[]]}const x5=new kt("");function wv(e){return e+.5|0}const gh=(e,n,t)=>Math.max(Math.min(e,t),n);function VC(e){return gh(wv(2.55*e),0,255)}function Tp(e){return gh(wv(255*e),0,255)}function _h(e){return gh(wv(e/2.55)/100,0,1)}function w5(e){return gh(wv(100*e),0,100)}const cc={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},vB=[..."0123456789ABCDEF"],wZ=e=>vB[15&e],CZ=e=>vB[(240&e)>>4]+vB[15&e],JA=e=>(240&e)>>4==(15&e);const TZ=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function C5(e,n,t){const r=n*Math.min(t,1-t),a=(c,h=(c+e/30)%12)=>t-r*Math.max(Math.min(h-3,9-h,1),-1);return[a(0),a(8),a(4)]}function EZ(e,n,t){const r=(a,c=(a+e/60)%6)=>t-t*n*Math.max(Math.min(c,4-c,1),0);return[r(5),r(3),r(1)]}function AZ(e,n,t){const r=C5(e,1,.5);let a;for(n+t>1&&(a=1/(n+t),n*=a,t*=a),a=0;a<3;a++)r[a]*=1-n-t,r[a]+=n;return r}function xB(e){const t=e.r/255,r=e.g/255,a=e.b/255,c=Math.max(t,r,a),h=Math.min(t,r,a),f=(c+h)/2;let b,x,M;return c!==h&&(M=c-h,x=f>.5?M/(2-c-h):M/(c+h),b=function IZ(e,n,t,r,a){return e===a?(n-t)/r+(n<t?6:0):n===a?(t-e)/r+2:(e-n)/r+4}(t,r,a,M,c),b=60*b+.5),[0|b,x||0,f]}function wB(e,n,t,r){return(Array.isArray(n)?e(n[0],n[1],n[2]):e(n,t,r)).map(Tp)}function CB(e,n,t){return wB(C5,e,n,t)}function M5(e){return(e%360+360)%360}const D5={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},k5={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let tI;const zZ=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,MB=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,Cv=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function eI(e,n,t){if(e){let r=xB(e);r[n]=Math.max(0,Math.min(r[n]+r[n]*t,0===n?360:1)),r=CB(r),e.r=r[0],e.g=r[1],e.b=r[2]}}function S5(e,n){return e&&Object.assign(n||{},e)}function T5(e){var n={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(n={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(n.a=Tp(e[3]))):(n=S5(e,{r:0,g:0,b:0,a:1})).a=Tp(n.a),n}function HZ(e){return"r"===e.charAt(0)?function VZ(e){const n=zZ.exec(e);let r,a,c,t=255;if(n){if(n[7]!==r){const h=+n[7];t=n[8]?VC(h):gh(255*h,0,255)}return r=+n[1],a=+n[3],c=+n[5],r=255&(n[2]?VC(r):gh(r,0,255)),a=255&(n[4]?VC(a):gh(a,0,255)),c=255&(n[6]?VC(c):gh(c,0,255)),{r,g:a,b:c,a:t}}}(e):function OZ(e){const n=TZ.exec(e);let r,t=255;if(!n)return;n[5]!==r&&(t=n[6]?VC(+n[5]):Tp(+n[5]));const a=M5(+n[2]),c=+n[3]/100,h=+n[4]/100;return r="hwb"===n[1]?function RZ(e,n,t){return wB(AZ,e,n,t)}(a,c,h):"hsv"===n[1]?function PZ(e,n,t){return wB(EZ,e,n,t)}(a,c,h):CB(a,c,h),{r:r[0],g:r[1],b:r[2],a:t}}(e)}class Mv{constructor(n){if(n instanceof Mv)return n;const t=typeof n;let r;"object"===t?r=T5(n):"string"===t&&(r=function DZ(e){var t,n=e.length;return"#"===e[0]&&(4===n||5===n?t={r:255&17*cc[e[1]],g:255&17*cc[e[2]],b:255&17*cc[e[3]],a:5===n?17*cc[e[4]]:255}:(7===n||9===n)&&(t={r:cc[e[1]]<<4|cc[e[2]],g:cc[e[3]]<<4|cc[e[4]],b:cc[e[5]]<<4|cc[e[6]],a:9===n?cc[e[7]]<<4|cc[e[8]]:255})),t}(n)||function NZ(e){tI||(tI=function BZ(){const e={},n=Object.keys(k5),t=Object.keys(D5);let r,a,c,h,f;for(r=0;r<n.length;r++){for(h=f=n[r],a=0;a<t.length;a++)c=t[a],f=f.replace(c,D5[c]);c=parseInt(k5[h],16),e[f]=[c>>16&255,c>>8&255,255&c]}return e}(),tI.transparent=[0,0,0,0]);const n=tI[e.toLowerCase()];return n&&{r:n[0],g:n[1],b:n[2],a:4===n.length?n[3]:255}}(n)||HZ(n)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var n=S5(this._rgb);return n&&(n.a=_h(n.a)),n}set rgb(n){this._rgb=T5(n)}rgbString(){return this._valid?function jZ(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${_h(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}(this._rgb):void 0}hexString(){return this._valid?function SZ(e){var n=(e=>JA(e.r)&&JA(e.g)&&JA(e.b)&&JA(e.a))(e)?wZ:CZ;return e?"#"+n(e.r)+n(e.g)+n(e.b)+((e,n)=>e<255?n(e):"")(e.a,n):void 0}(this._rgb):void 0}hslString(){return this._valid?function LZ(e){if(!e)return;const n=xB(e),t=n[0],r=w5(n[1]),a=w5(n[2]);return e.a<255?`hsla(${t}, ${r}%, ${a}%, ${_h(e.a)})`:`hsl(${t}, ${r}%, ${a}%)`}(this._rgb):void 0}mix(n,t){if(n){const r=this.rgb,a=n.rgb;let c;const h=t===c?.5:t,f=2*h-1,b=r.a-a.a,x=((f*b==-1?f:(f+b)/(1+f*b))+1)/2;c=1-x,r.r=255&x*r.r+c*a.r+.5,r.g=255&x*r.g+c*a.g+.5,r.b=255&x*r.b+c*a.b+.5,r.a=h*r.a+(1-h)*a.a,this.rgb=r}return this}interpolate(n,t){return n&&(this._rgb=function UZ(e,n,t){const r=Cv(_h(e.r)),a=Cv(_h(e.g)),c=Cv(_h(e.b));return{r:Tp(MB(r+t*(Cv(_h(n.r))-r))),g:Tp(MB(a+t*(Cv(_h(n.g))-a))),b:Tp(MB(c+t*(Cv(_h(n.b))-c))),a:e.a+t*(n.a-e.a)}}(this._rgb,n._rgb,t)),this}clone(){return new Mv(this.rgb)}alpha(n){return this._rgb.a=Tp(n),this}clearer(n){return this._rgb.a*=1-n,this}greyscale(){const n=this._rgb,t=wv(.3*n.r+.59*n.g+.11*n.b);return n.r=n.g=n.b=t,this}opaquer(n){return this._rgb.a*=1+n,this}negate(){const n=this._rgb;return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,this}lighten(n){return eI(this._rgb,2,n),this}darken(n){return eI(this._rgb,2,-n),this}saturate(n){return eI(this._rgb,1,n),this}desaturate(n){return eI(this._rgb,1,-n),this}rotate(n){return function FZ(e,n){var t=xB(e);t[0]=M5(t[0]+n),t=CB(t),e.r=t[0],e.g=t[1],e.b=t[2]}(this._rgb,n),this}}function bh(){}const $Z=(()=>{let e=0;return()=>e++})();function Vn(e){return null===e||typeof e>"u"}function Fr(e){if(Array.isArray&&Array.isArray(e))return!0;const n=Object.prototype.toString.call(e);return"[object"===n.slice(0,7)&&"Array]"===n.slice(-6)}function Sn(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function uo(e){return("number"==typeof e||e instanceof Number)&&isFinite(+e)}function bl(e,n){return uo(e)?e:n}function cn(e,n){return typeof e>"u"?n:e}const E5=(e,n)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100*n:+e;function Sr(e,n,t){if(e&&"function"==typeof e.call)return e.apply(t,n)}function ar(e,n,t,r){let a,c,h;if(Fr(e))if(c=e.length,r)for(a=c-1;a>=0;a--)n.call(t,e[a],a);else for(a=0;a<c;a++)n.call(t,e[a],a);else if(Sn(e))for(h=Object.keys(e),c=h.length,a=0;a<c;a++)n.call(t,e[h[a]],h[a])}function iI(e,n){let t,r,a,c;if(!e||!n||e.length!==n.length)return!1;for(t=0,r=e.length;t<r;++t)if(a=e[t],c=n[t],a.datasetIndex!==c.datasetIndex||a.index!==c.index)return!1;return!0}function nI(e){if(Fr(e))return e.map(nI);if(Sn(e)){const n=Object.create(null),t=Object.keys(e),r=t.length;let a=0;for(;a<r;++a)n[t[a]]=nI(e[t[a]]);return n}return e}function A5(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function WZ(e,n,t,r){if(!A5(e))return;const a=n[e],c=t[e];Sn(a)&&Sn(c)?jC(a,c,r):n[e]=nI(c)}function jC(e,n,t){const r=Fr(n)?n:[n],a=r.length;if(!Sn(e))return e;const c=(t=t||{}).merger||WZ;let h;for(let f=0;f<a;++f){if(h=r[f],!Sn(h))continue;const b=Object.keys(h);for(let x=0,M=b.length;x<M;++x)c(b[x],e,h,t)}return e}function UC(e,n){return jC(e,n,{merger:qZ})}function qZ(e,n,t){if(!A5(e))return;const r=n[e],a=t[e];Sn(r)&&Sn(a)?UC(r,a):Object.prototype.hasOwnProperty.call(n,e)||(n[e]=nI(a))}const I5={"":e=>e,x:e=>e.x,y:e=>e.y};function Ep(e,n){return(I5[n]||(I5[n]=function ZZ(e){const n=function YZ(e){const n=e.split("."),t=[];let r="";for(const a of n)r+=a,r.endsWith("\\")?r=r.slice(0,-1)+".":(t.push(r),r="");return t}(e);return t=>{for(const r of n){if(""===r)break;t=t&&t[r]}return t}}(n)))(e)}function DB(e){return e.charAt(0).toUpperCase()+e.slice(1)}const HC=e=>typeof e<"u",Ap=e=>"function"==typeof e,R5=(e,n)=>{if(e.size!==n.size)return!1;for(const t of e)if(!n.has(t))return!1;return!0},Lr=Math.PI,Br=2*Lr,KZ=Br+Lr,rI=Number.POSITIVE_INFINITY,QZ=Lr/180,Mo=Lr/2,n_=Lr/4,P5=2*Lr/3,Ip=Math.log10,Gd=Math.sign;function $C(e,n,t){return Math.abs(e-n)<t}function O5(e){const n=Math.round(e);e=$C(e,n,e/1e3)?n:e;const t=Math.pow(10,Math.floor(Ip(e))),r=e/t;return(r<=1?1:r<=2?2:r<=5?5:10)*t}function Dv(e){return!isNaN(parseFloat(e))&&isFinite(e)}function F5(e,n,t){let r,a,c;for(r=0,a=e.length;r<a;r++)c=e[r][t],isNaN(c)||(n.min=Math.min(n.min,c),n.max=Math.max(n.max,c))}function Yc(e){return e*(Lr/180)}function kB(e){return e*(180/Lr)}function L5(e){if(!uo(e))return;let n=1,t=0;for(;Math.round(e*n)/n!==e;)n*=10,t++;return t}function B5(e,n){const t=n.x-e.x,r=n.y-e.y,a=Math.sqrt(t*t+r*r);let c=Math.atan2(r,t);return c<-.5*Lr&&(c+=Br),{angle:c,distance:a}}function SB(e,n){return Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2))}function eX(e,n){return(e-n+KZ)%Br-Lr}function yl(e){return(e%Br+Br)%Br}function GC(e,n,t,r){const a=yl(e),c=yl(n),h=yl(t),f=yl(c-a),b=yl(h-a),x=yl(a-c),M=yl(a-h);return a===c||a===h||r&&c===h||f>b&&x<M}function Qo(e,n,t){return Math.max(n,Math.min(t,e))}function yh(e,n,t,r=1e-6){return e>=Math.min(n,t)-r&&e<=Math.max(n,t)+r}function TB(e,n,t){t=t||(h=>e[h]<n);let c,r=e.length-1,a=0;for(;r-a>1;)c=a+r>>1,t(c)?a=c:r=c;return{lo:a,hi:r}}const vh=(e,n,t,r)=>TB(e,t,r?a=>{const c=e[a][n];return c<t||c===t&&e[a+1][n]===t}:a=>e[a][n]<t),nX=(e,n,t)=>TB(e,t,r=>e[r][n]>=t),N5=["push","pop","shift","splice","unshift"];function z5(e,n){const t=e._chartjs;if(!t)return;const r=t.listeners,a=r.indexOf(n);-1!==a&&r.splice(a,1),!(r.length>0)&&(N5.forEach(c=>{delete e[c]}),delete e._chartjs)}function V5(e){const n=new Set(e);return n.size===e.length?e:Array.from(n)}const j5=typeof window>"u"?function(e){return e()}:window.requestAnimationFrame;function U5(e,n){let t=[],r=!1;return function(...a){t=a,r||(r=!0,j5.call(window,()=>{r=!1,e.apply(n,t)}))}}const EB=e=>"start"===e?"left":"end"===e?"right":"center",qs=(e,n,t)=>"start"===e?n:"end"===e?t:(n+t)/2;function H5(e,n,t){const r=n.length;let a=0,c=r;if(e._sorted){const{iScale:h,_parsed:f}=e,b=h.axis,{min:x,max:M,minDefined:T,maxDefined:I}=h.getUserBounds();T&&(a=Qo(Math.min(vh(f,b,x).lo,t?r:vh(n,b,h.getPixelForValue(x)).lo),0,r-1)),c=I?Qo(Math.max(vh(f,h.axis,M,!0).hi+1,t?0:vh(n,b,h.getPixelForValue(M),!0).hi+1),a,r)-a:r-a}return{start:a,count:c}}function $5(e){const{xScale:n,yScale:t,_scaleRanges:r}=e,a={xmin:n.min,xmax:n.max,ymin:t.min,ymax:t.max};if(!r)return e._scaleRanges=a,!0;const c=r.xmin!==n.min||r.xmax!==n.max||r.ymin!==t.min||r.ymax!==t.max;return Object.assign(r,a),c}const oI=e=>0===e||1===e,G5=(e,n,t)=>-Math.pow(2,10*(e-=1))*Math.sin((e-n)*Br/t),W5=(e,n,t)=>Math.pow(2,-10*e)*Math.sin((e-n)*Br/t)+1,WC={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*Mo),easeOutSine:e=>Math.sin(e*Mo),easeInOutSine:e=>-.5*(Math.cos(Lr*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>oI(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>oI(e)?e:G5(e,.075,.3),easeOutElastic:e=>oI(e)?e:W5(e,.075,.3),easeInOutElastic:e=>oI(e)?e:e<.5?.5*G5(2*e,.1125,.45):.5+.5*W5(2*e-1,.1125,.45),easeInBack:e=>e*e*(2.70158*e-1.70158),easeOutBack:e=>(e-=1)*e*(2.70158*e+1.70158)+1,easeInOutBack(e){let n=1.70158;return(e/=.5)<1?e*e*((1+(n*=1.525))*e-n)*.5:.5*((e-=2)*e*((1+(n*=1.525))*e+n)+2)},easeInBounce:e=>1-WC.easeOutBounce(1-e),easeOutBounce:e=>e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,easeInOutBounce:e=>e<.5?.5*WC.easeInBounce(2*e):.5*WC.easeOutBounce(2*e-1)+.5};function AB(e){if(e&&"object"==typeof e){const n=e.toString();return"[object CanvasPattern]"===n||"[object CanvasGradient]"===n}return!1}function q5(e){return AB(e)?e:new Mv(e)}function IB(e){return AB(e)?e:new Mv(e).saturate(.5).darken(.1).hexString()}const lX=["x","y","borderWidth","radius","tension"],cX=["color","borderColor","backgroundColor"],Y5=new Map;function qC(e,n,t){return function hX(e,n){n=n||{};const t=e+JSON.stringify(n);let r=Y5.get(t);return r||(r=new Intl.NumberFormat(e,n),Y5.set(t,r)),r}(n,t).format(e)}const Z5={values:e=>Fr(e)?e:""+e,numeric(e,n,t){if(0===e)return"0";const r=this.chart.options.locale;let a,c=e;if(t.length>1){const x=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(x<1e-4||x>1e15)&&(a="scientific"),c=function mX(e,n){let t=n.length>3?n[2].value-n[1].value:n[1].value-n[0].value;return Math.abs(t)>=1&&e!==Math.floor(e)&&(t=e-Math.floor(e)),t}(e,t)}const h=Ip(Math.abs(c)),f=isNaN(h)?1:Math.max(Math.min(-1*Math.floor(h),20),0),b={notation:a,minimumFractionDigits:f,maximumFractionDigits:f};return Object.assign(b,this.options.ticks.format),qC(e,r,b)},logarithmic(e,n,t){if(0===e)return"0";const r=t[n].significand||e/Math.pow(10,Math.floor(Ip(e)));return[1,2,3,5,10,15].includes(r)||n>.8*t.length?Z5.numeric.call(this,e,n,t):""}};var sI={formatters:Z5};const r_=Object.create(null),RB=Object.create(null);function YC(e,n){if(!n)return e;const t=n.split(".");for(let r=0,a=t.length;r<a;++r){const c=t[r];e=e[c]||(e[c]=Object.create(null))}return e}function PB(e,n,t){return"string"==typeof n?jC(YC(e,n),t):jC(YC(e,""),n)}class fX{constructor(n,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,a)=>IB(a.backgroundColor),this.hoverBorderColor=(r,a)=>IB(a.borderColor),this.hoverColor=(r,a)=>IB(a.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(n),this.apply(t)}set(n,t){return PB(this,n,t)}get(n){return YC(this,n)}describe(n,t){return PB(RB,n,t)}override(n,t){return PB(r_,n,t)}route(n,t,r,a){const c=YC(this,n),h=YC(this,r),f="_"+t;Object.defineProperties(c,{[f]:{value:c[t],writable:!0},[t]:{enumerable:!0,get(){const b=this[f],x=h[a];return Sn(b)?Object.assign({},x,b):cn(b,x)},set(b){this[f]=b}}})}apply(n){n.forEach(t=>t(this))}}var to=new fX({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function dX(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:n=>"onProgress"!==n&&"onComplete"!==n&&"fn"!==n}),e.set("animations",{colors:{type:"color",properties:cX},numbers:{type:"number",properties:lX}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:n=>0|n}}}})},function uX(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function pX(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(n,t)=>t.lineWidth,tickColor:(n,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:sI.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:n=>!n.startsWith("before")&&!n.startsWith("after")&&"callback"!==n&&"parser"!==n,_indexable:n=>"borderDash"!==n&&"tickBorderDash"!==n&&"dash"!==n}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:n=>"backdropPadding"!==n&&"callback"!==n,_indexable:n=>"backdropPadding"!==n})}]);function aI(e,n,t,r,a){let c=n[a];return c||(c=n[a]=e.measureText(a).width,t.push(a)),c>r&&(r=c),r}function _X(e,n,t,r){let a=(r=r||{}).data=r.data||{},c=r.garbageCollect=r.garbageCollect||[];r.font!==n&&(a=r.data={},c=r.garbageCollect=[],r.font=n),e.save(),e.font=n;let h=0;const f=t.length;let b,x,M,T,I;for(b=0;b<f;b++)if(T=t[b],null==T||Fr(T)){if(Fr(T))for(x=0,M=T.length;x<M;x++)I=T[x],null!=I&&!Fr(I)&&(h=aI(e,a,c,h,I))}else h=aI(e,a,c,h,T);e.restore();const L=c.length/2;if(L>t.length){for(b=0;b<L;b++)delete a[c[b]];c.splice(0,L)}return h}function o_(e,n,t){const r=e.currentDevicePixelRatio,a=0!==t?Math.max(t/2,.5):0;return Math.round((n-a)*r)/r+a}function X5(e,n){(n=n||e.getContext("2d")).save(),n.resetTransform(),n.clearRect(0,0,e.width,e.height),n.restore()}function OB(e,n,t,r){K5(e,n,t,r,null)}function K5(e,n,t,r,a){let c,h,f,b,x,M,T,I;const L=n.pointStyle,N=n.rotation,V=n.radius;let $=(N||0)*QZ;if(L&&"object"==typeof L&&(c=L.toString(),"[object HTMLImageElement]"===c||"[object HTMLCanvasElement]"===c))return e.save(),e.translate(t,r),e.rotate($),e.drawImage(L,-L.width/2,-L.height/2,L.width,L.height),void e.restore();if(!(isNaN(V)||V<=0)){switch(e.beginPath(),L){default:a?e.ellipse(t,r,a/2,V,0,0,Br):e.arc(t,r,V,0,Br),e.closePath();break;case"triangle":M=a?a/2:V,e.moveTo(t+Math.sin($)*M,r-Math.cos($)*V),$+=P5,e.lineTo(t+Math.sin($)*M,r-Math.cos($)*V),$+=P5,e.lineTo(t+Math.sin($)*M,r-Math.cos($)*V),e.closePath();break;case"rectRounded":x=.516*V,b=V-x,h=Math.cos($+n_)*b,T=Math.cos($+n_)*(a?a/2-x:b),f=Math.sin($+n_)*b,I=Math.sin($+n_)*(a?a/2-x:b),e.arc(t-T,r-f,x,$-Lr,$-Mo),e.arc(t+I,r-h,x,$-Mo,$),e.arc(t+T,r+f,x,$,$+Mo),e.arc(t-I,r+h,x,$+Mo,$+Lr),e.closePath();break;case"rect":if(!N){b=Math.SQRT1_2*V,M=a?a/2:b,e.rect(t-M,r-b,2*M,2*b);break}$+=n_;case"rectRot":T=Math.cos($)*(a?a/2:V),h=Math.cos($)*V,f=Math.sin($)*V,I=Math.sin($)*(a?a/2:V),e.moveTo(t-T,r-f),e.lineTo(t+I,r-h),e.lineTo(t+T,r+f),e.lineTo(t-I,r+h),e.closePath();break;case"crossRot":$+=n_;case"cross":T=Math.cos($)*(a?a/2:V),h=Math.cos($)*V,f=Math.sin($)*V,I=Math.sin($)*(a?a/2:V),e.moveTo(t-T,r-f),e.lineTo(t+T,r+f),e.moveTo(t+I,r-h),e.lineTo(t-I,r+h);break;case"star":T=Math.cos($)*(a?a/2:V),h=Math.cos($)*V,f=Math.sin($)*V,I=Math.sin($)*(a?a/2:V),e.moveTo(t-T,r-f),e.lineTo(t+T,r+f),e.moveTo(t+I,r-h),e.lineTo(t-I,r+h),$+=n_,T=Math.cos($)*(a?a/2:V),h=Math.cos($)*V,f=Math.sin($)*V,I=Math.sin($)*(a?a/2:V),e.moveTo(t-T,r-f),e.lineTo(t+T,r+f),e.moveTo(t+I,r-h),e.lineTo(t-I,r+h);break;case"line":h=a?a/2:Math.cos($)*V,f=Math.sin($)*V,e.moveTo(t-h,r-f),e.lineTo(t+h,r+f);break;case"dash":e.moveTo(t,r),e.lineTo(t+Math.cos($)*(a?a/2:V),r+Math.sin($)*V);break;case!1:e.closePath()}e.fill(),n.borderWidth>0&&e.stroke()}}function xh(e,n,t){return t=t||.5,!n||e&&e.x>n.left-t&&e.x<n.right+t&&e.y>n.top-t&&e.y<n.bottom+t}function lI(e,n){e.save(),e.beginPath(),e.rect(n.left,n.top,n.right-n.left,n.bottom-n.top),e.clip()}function cI(e){e.restore()}function bX(e,n,t,r,a){if(!n)return e.lineTo(t.x,t.y);if("middle"===a){const c=(n.x+t.x)/2;e.lineTo(c,n.y),e.lineTo(c,t.y)}else"after"===a!=!!r?e.lineTo(n.x,t.y):e.lineTo(t.x,n.y);e.lineTo(t.x,t.y)}function yX(e,n,t,r){if(!n)return e.lineTo(t.x,t.y);e.bezierCurveTo(r?n.cp1x:n.cp2x,r?n.cp1y:n.cp2y,r?t.cp2x:t.cp1x,r?t.cp2y:t.cp1y,t.x,t.y)}function xX(e,n,t,r,a){if(a.strikethrough||a.underline){const c=e.measureText(r),h=n-c.actualBoundingBoxLeft,f=n+c.actualBoundingBoxRight,x=t+c.actualBoundingBoxDescent,M=a.strikethrough?(t-c.actualBoundingBoxAscent+x)/2:x;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=a.decorationWidth||2,e.moveTo(h,M),e.lineTo(f,M),e.stroke()}}function wX(e,n){const t=e.fillStyle;e.fillStyle=n.color,e.fillRect(n.left,n.top,n.width,n.height),e.fillStyle=t}function s_(e,n,t,r,a,c={}){const h=Fr(n)?n:[n],f=c.strokeWidth>0&&""!==c.strokeColor;let b,x;for(e.save(),e.font=a.string,function vX(e,n){n.translation&&e.translate(n.translation[0],n.translation[1]),Vn(n.rotation)||e.rotate(n.rotation),n.color&&(e.fillStyle=n.color),n.textAlign&&(e.textAlign=n.textAlign),n.textBaseline&&(e.textBaseline=n.textBaseline)}(e,c),b=0;b<h.length;++b)x=h[b],c.backdrop&&wX(e,c.backdrop),f&&(c.strokeColor&&(e.strokeStyle=c.strokeColor),Vn(c.strokeWidth)||(e.lineWidth=c.strokeWidth),e.strokeText(x,t,r,c.maxWidth)),e.fillText(x,t,r,c.maxWidth),xX(e,t,r,x,c),r+=Number(a.lineHeight);e.restore()}function ZC(e,n){const{x:t,y:r,w:a,h:c,radius:h}=n;e.arc(t+h.topLeft,r+h.topLeft,h.topLeft,1.5*Lr,Lr,!0),e.lineTo(t,r+c-h.bottomLeft),e.arc(t+h.bottomLeft,r+c-h.bottomLeft,h.bottomLeft,Lr,Mo,!0),e.lineTo(t+a-h.bottomRight,r+c),e.arc(t+a-h.bottomRight,r+c-h.bottomRight,h.bottomRight,Mo,0,!0),e.lineTo(t+a,r+h.topRight),e.arc(t+a-h.topRight,r+h.topRight,h.topRight,0,-Mo,!0),e.lineTo(t+h.topLeft,r)}const CX=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,MX=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function DX(e,n){const t=(""+e).match(CX);if(!t||"normal"===t[1])return 1.2*n;switch(e=+t[2],t[3]){case"px":return e;case"%":e/=100}return n*e}const kX=e=>+e||0;function FB(e,n){const t={},r=Sn(n),a=r?Object.keys(n):n,c=Sn(e)?r?h=>cn(e[h],e[n[h]]):h=>e[h]:()=>e;for(const h of a)t[h]=kX(c(h));return t}function Q5(e){return FB(e,{top:"y",right:"x",bottom:"y",left:"x"})}function a_(e){return FB(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Ys(e){const n=Q5(e);return n.width=n.left+n.right,n.height=n.top+n.bottom,n}function Uo(e,n){let t=cn((e=e||{}).size,(n=n||to.font).size);"string"==typeof t&&(t=parseInt(t,10));let r=cn(e.style,n.style);r&&!(""+r).match(MX)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const a={family:cn(e.family,n.family),lineHeight:DX(cn(e.lineHeight,n.lineHeight),t),size:t,style:r,weight:cn(e.weight,n.weight),string:""};return a.string=function gX(e){return!e||Vn(e.size)||Vn(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(a),a}function XC(e,n,t,r){let c,h,f,a=!0;for(c=0,h=e.length;c<h;++c)if(f=e[c],void 0!==f&&(void 0!==n&&"function"==typeof f&&(f=f(n),a=!1),void 0!==t&&Fr(f)&&(f=f[t%f.length],a=!1),void 0!==f))return r&&!a&&(r.cacheable=!1),f}function Rp(e,n){return Object.assign(Object.create(e),n)}function LB(e,n=[""],t,r,a=(()=>e[0])){const c=t||e;typeof r>"u"&&(r=nj("_fallback",e));const h={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:c,_fallback:r,_getTarget:a,override:f=>LB([f,...e],n,c,r)};return new Proxy(h,{deleteProperty:(f,b)=>(delete f[b],delete f._keys,delete e[0][b],!0),get:(f,b)=>tj(f,b,()=>function FX(e,n,t,r){let a;for(const c of n)if(a=nj(TX(c,e),t),typeof a<"u")return BB(e,a)?NB(t,r,e,a):a}(b,n,e,f)),getOwnPropertyDescriptor:(f,b)=>Reflect.getOwnPropertyDescriptor(f._scopes[0],b),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(f,b)=>rj(f).includes(b),ownKeys:f=>rj(f),set(f,b,x){const M=f._storage||(f._storage=a());return f[b]=M[b]=x,delete f._keys,!0}})}function kv(e,n,t,r){const a={_cacheable:!1,_proxy:e,_context:n,_subProxy:t,_stack:new Set,_descriptors:J5(e,r),setContext:c=>kv(e,c,t,r),override:c=>kv(e.override(c),n,t,r)};return new Proxy(a,{deleteProperty:(c,h)=>(delete c[h],delete e[h],!0),get:(c,h,f)=>tj(c,h,()=>function EX(e,n,t){const{_proxy:r,_context:a,_subProxy:c,_descriptors:h}=e;let f=r[n];return Ap(f)&&h.isScriptable(n)&&(f=function AX(e,n,t,r){const{_proxy:a,_context:c,_subProxy:h,_stack:f}=t;if(f.has(e))throw new Error("Recursion detected: "+Array.from(f).join("->")+"->"+e);f.add(e);let b=n(c,h||r);return f.delete(e),BB(e,b)&&(b=NB(a._scopes,a,e,b)),b}(n,f,e,t)),Fr(f)&&f.length&&(f=function IX(e,n,t,r){const{_proxy:a,_context:c,_subProxy:h,_descriptors:f}=t;if(typeof c.index<"u"&&r(e))return n[c.index%n.length];if(Sn(n[0])){const b=n,x=a._scopes.filter(M=>M!==b);n=[];for(const M of b){const T=NB(x,a,e,M);n.push(kv(T,c,h&&h[e],f))}}return n}(n,f,e,h.isIndexable)),BB(n,f)&&(f=kv(f,a,c&&c[n],h)),f}(c,h,f)),getOwnPropertyDescriptor:(c,h)=>c._descriptors.allKeys?Reflect.has(e,h)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,h),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(c,h)=>Reflect.has(e,h),ownKeys:()=>Reflect.ownKeys(e),set:(c,h,f)=>(e[h]=f,delete c[h],!0)})}function J5(e,n={scriptable:!0,indexable:!0}){const{_scriptable:t=n.scriptable,_indexable:r=n.indexable,_allKeys:a=n.allKeys}=e;return{allKeys:a,scriptable:t,indexable:r,isScriptable:Ap(t)?t:()=>t,isIndexable:Ap(r)?r:()=>r}}const TX=(e,n)=>e?e+DB(n):n,BB=(e,n)=>Sn(n)&&"adapters"!==e&&(null===Object.getPrototypeOf(n)||n.constructor===Object);function tj(e,n,t){if(Object.prototype.hasOwnProperty.call(e,n))return e[n];const r=t();return e[n]=r,r}function ej(e,n,t){return Ap(e)?e(n,t):e}const RX=(e,n)=>!0===e?n:"string"==typeof e?Ep(n,e):void 0;function PX(e,n,t,r,a){for(const c of n){const h=RX(t,c);if(h){e.add(h);const f=ej(h._fallback,t,a);if(typeof f<"u"&&f!==t&&f!==r)return f}else if(!1===h&&typeof r<"u"&&t!==r)return null}return!1}function NB(e,n,t,r){const a=n._rootScopes,c=ej(n._fallback,t,r),h=[...e,...a],f=new Set;f.add(r);let b=ij(f,h,t,c||t,r);return!(null===b||typeof c<"u"&&c!==t&&(b=ij(f,h,c,b,r),null===b))&&LB(Array.from(f),[""],a,c,()=>function OX(e,n,t){const r=e._getTarget();n in r||(r[n]={});const a=r[n];return Fr(a)&&Sn(t)?t:a||{}}(n,t,r))}function ij(e,n,t,r,a){for(;t;)t=PX(e,n,t,r,a);return t}function nj(e,n){for(const t of n){if(!t)continue;const r=t[e];if(typeof r<"u")return r}}function rj(e){let n=e._keys;return n||(n=e._keys=function LX(e){const n=new Set;for(const t of e)for(const r of Object.keys(t).filter(a=>!a.startsWith("_")))n.add(r);return Array.from(n)}(e._scopes)),n}function oj(e,n,t,r){const{iScale:a}=e,{key:c="r"}=this._parsing,h=new Array(r);let f,b,x,M;for(f=0,b=r;f<b;++f)x=f+t,M=n[x],h[f]={r:a.parse(Ep(M,c),x)};return h}const BX=Number.EPSILON||1e-14,Sv=(e,n)=>n<e.length&&!e[n].skip&&e[n],sj=e=>"x"===e?"y":"x";function NX(e,n,t,r){const a=e.skip?n:e,c=n,h=t.skip?n:t,f=SB(c,a),b=SB(h,c);let x=f/(f+b),M=b/(f+b);x=isNaN(x)?0:x,M=isNaN(M)?0:M;const T=r*x,I=r*M;return{previous:{x:c.x-T*(h.x-a.x),y:c.y-T*(h.y-a.y)},next:{x:c.x+I*(h.x-a.x),y:c.y+I*(h.y-a.y)}}}function dI(e,n,t){return Math.max(Math.min(e,t),n)}function HX(e,n,t,r,a){let c,h,f,b;if(n.spanGaps&&(e=e.filter(x=>!x.skip)),"monotone"===n.cubicInterpolationMode)!function jX(e,n="x"){const t=sj(n),r=e.length,a=Array(r).fill(0),c=Array(r);let h,f,b,x=Sv(e,0);for(h=0;h<r;++h)if(f=b,b=x,x=Sv(e,h+1),b){if(x){const M=x[n]-b[n];a[h]=0!==M?(x[t]-b[t])/M:0}c[h]=f?x?Gd(a[h-1])!==Gd(a[h])?0:(a[h-1]+a[h])/2:a[h-1]:a[h]}(function zX(e,n,t){const r=e.length;let a,c,h,f,b,x=Sv(e,0);for(let M=0;M<r-1;++M)if(b=x,x=Sv(e,M+1),b&&x){if($C(n[M],0,BX)){t[M]=t[M+1]=0;continue}a=t[M]/n[M],c=t[M+1]/n[M],f=Math.pow(a,2)+Math.pow(c,2),!(f<=9)&&(h=3/Math.sqrt(f),t[M]=a*h*n[M],t[M+1]=c*h*n[M])}})(e,a,c),function VX(e,n,t="x"){const r=sj(t),a=e.length;let c,h,f,b=Sv(e,0);for(let x=0;x<a;++x){if(h=f,f=b,b=Sv(e,x+1),!f)continue;const M=f[t],T=f[r];h&&(c=(M-h[t])/3,f[`cp1${t}`]=M-c,f[`cp1${r}`]=T-c*n[x]),b&&(c=(b[t]-M)/3,f[`cp2${t}`]=M+c,f[`cp2${r}`]=T+c*n[x])}}(e,c,n)}(e,a);else{let x=r?e[e.length-1]:e[0];for(c=0,h=e.length;c<h;++c)f=e[c],b=NX(x,f,e[Math.min(c+1,h-(r?0:1))%h],n.tension),f.cp1x=b.previous.x,f.cp1y=b.previous.y,f.cp2x=b.next.x,f.cp2y=b.next.y,x=f}n.capBezierPoints&&function UX(e,n){let t,r,a,c,h,f=xh(e[0],n);for(t=0,r=e.length;t<r;++t)h=c,c=f,f=t<r-1&&xh(e[t+1],n),c&&(a=e[t],h&&(a.cp1x=dI(a.cp1x,n.left,n.right),a.cp1y=dI(a.cp1y,n.top,n.bottom)),f&&(a.cp2x=dI(a.cp2x,n.left,n.right),a.cp2y=dI(a.cp2y,n.top,n.bottom)))}(e,t)}function zB(){return typeof window<"u"&&typeof document<"u"}function VB(e){let n=e.parentNode;return n&&"[object ShadowRoot]"===n.toString()&&(n=n.host),n}function uI(e,n,t){let r;return"string"==typeof e?(r=parseInt(e,10),-1!==e.indexOf("%")&&(r=r/100*n.parentNode[t])):r=e,r}const hI=e=>e.ownerDocument.defaultView.getComputedStyle(e,null),GX=["top","right","bottom","left"];function l_(e,n,t){const r={};t=t?"-"+t:"";for(let a=0;a<4;a++){const c=GX[a];r[c]=parseFloat(e[n+"-"+c+t])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const WX=(e,n,t)=>(e>0||n>0)&&(!t||!t.shadowRoot);function c_(e,n){if("native"in e)return e;const{canvas:t,currentDevicePixelRatio:r}=n,a=hI(t),c="border-box"===a.boxSizing,h=l_(a,"padding"),f=l_(a,"border","width"),{x:b,y:x,box:M}=function qX(e,n){const t=e.touches,r=t&&t.length?t[0]:e,{offsetX:a,offsetY:c}=r;let f,b,h=!1;if(WX(a,c,e.target))f=a,b=c;else{const x=n.getBoundingClientRect();f=r.clientX-x.left,b=r.clientY-x.top,h=!0}return{x:f,y:b,box:h}}(e,t),T=h.left+(M&&f.left),I=h.top+(M&&f.top);let{width:L,height:N}=n;return c&&(L-=h.width+f.width,N-=h.height+f.height),{x:Math.round((b-T)/L*t.width/r),y:Math.round((x-I)/N*t.height/r)}}const mI=e=>Math.round(10*e)/10;function aj(e,n,t){const r=n||1,a=Math.floor(e.height*r),c=Math.floor(e.width*r);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const h=e.canvas;return h.style&&(t||!h.style.height&&!h.style.width)&&(h.style.height=`${e.height}px`,h.style.width=`${e.width}px`),(e.currentDevicePixelRatio!==r||h.height!==a||h.width!==c)&&(e.currentDevicePixelRatio=r,h.height=a,h.width=c,e.ctx.setTransform(r,0,0,r,0,0),!0)}const XX=function(){let e=!1;try{const n={get passive(){return e=!0,!1}};zB()&&(window.addEventListener("test",null,n),window.removeEventListener("test",null,n))}catch{}return e}();function lj(e,n){const t=function $X(e,n){return hI(e).getPropertyValue(n)}(e,n),r=t&&t.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function d_(e,n,t,r){return{x:e.x+t*(n.x-e.x),y:e.y+t*(n.y-e.y)}}function KX(e,n,t,r){return{x:e.x+t*(n.x-e.x),y:"middle"===r?t<.5?e.y:n.y:"after"===r?t<1?e.y:n.y:t>0?n.y:e.y}}function QX(e,n,t,r){const a={x:e.cp2x,y:e.cp2y},c={x:n.cp1x,y:n.cp1y},h=d_(e,a,t),f=d_(a,c,t),b=d_(c,n,t),x=d_(h,f,t),M=d_(f,b,t);return d_(x,M,t)}function Tv(e,n,t){return e?function(e,n){return{x:t=>e+e+n-t,setWidth(t){n=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,r)=>t-r,leftForLtr:(t,r)=>t-r}}(n,t):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,n)=>e+n,leftForLtr:(e,n)=>e}}function cj(e,n){let t,r;("ltr"===n||"rtl"===n)&&(t=e.canvas.style,r=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",n,"important"),e.prevTextDirection=r)}function dj(e,n){void 0!==n&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",n[0],n[1]))}function uj(e){return"angle"===e?{between:GC,compare:eX,normalize:yl}:{between:yh,compare:(n,t)=>n-t,normalize:n=>n}}function hj({start:e,end:n,count:t,loop:r,style:a}){return{start:e%t,end:n%t,loop:r&&(n-e+1)%t==0,style:a}}function mj(e,n,t){if(!t)return[e];const{property:r,start:a,end:c}=t,h=n.length,{compare:f,between:b,normalize:x}=uj(r),{start:M,end:T,loop:I,style:L}=function eK(e,n,t){const{property:r,start:a,end:c}=t,{between:h,normalize:f}=uj(r),b=n.length;let I,L,{start:x,end:M,loop:T}=e;if(T){for(x+=b,M+=b,I=0,L=b;I<L&&h(f(n[x%b][r]),a,c);++I)x--,M--;x%=b,M%=b}return M<x&&(M+=b),{start:x,end:M,loop:T,style:e.style}}(e,n,t),N=[];let nt,tt,_t,V=!1,$=null;for(let ee=M,Fe=M;ee<=T;++ee)tt=n[ee%h],!tt.skip&&(nt=x(tt[r]),nt!==_t&&(V=b(nt,a,c),null===$&&(V||b(a,_t,nt)&&0!==f(a,_t))&&($=0===f(nt,a)?ee:Fe),null!==$&&(!V||0===f(c,nt)||b(c,_t,nt))&&(N.push(hj({start:$,end:ee,loop:I,count:h,style:L})),$=null),Fe=ee,_t=nt));return null!==$&&N.push(hj({start:$,end:T,loop:I,count:h,style:L})),N}function pj(e,n){const t=[],r=e.segments;for(let a=0;a<r.length;a++){const c=mj(r[a],e.points,n);c.length&&t.push(...c)}return t}function gj(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function sK(e,n){if(!n)return!1;const t=[],r=function(a,c){return AB(c)?(t.includes(c)||t.push(c),t.indexOf(c)):c};return JSON.stringify(e,r)!==JSON.stringify(n,r)}class aK{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(n,t,r,a){const h=t.duration;t.listeners[a].forEach(f=>f({chart:n,initial:t.initial,numSteps:h,currentStep:Math.min(r-t.start,h)}))}_refresh(){this._request||(this._running=!0,this._request=j5.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(n=Date.now()){let t=0;this._charts.forEach((r,a)=>{if(!r.running||!r.items.length)return;const c=r.items;let b,h=c.length-1,f=!1;for(;h>=0;--h)b=c[h],b._active?(b._total>r.duration&&(r.duration=b._total),b.tick(n),f=!0):(c[h]=c[c.length-1],c.pop());f&&(a.draw(),this._notify(a,r,n,"progress")),c.length||(r.running=!1,this._notify(a,r,n,"complete"),r.initial=!1),t+=c.length}),this._lastDate=n,0===t&&(this._running=!1)}_getAnims(n){const t=this._charts;let r=t.get(n);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(n,r)),r}listen(n,t,r){this._getAnims(n).listeners[t].push(r)}add(n,t){!t||!t.length||this._getAnims(n).items.push(...t)}has(n){return this._getAnims(n).items.length>0}start(n){const t=this._charts.get(n);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,a)=>Math.max(r,a._duration),0),this._refresh())}running(n){if(!this._running)return!1;const t=this._charts.get(n);return!(!t||!t.running||!t.items.length)}stop(n){const t=this._charts.get(n);if(!t||!t.items.length)return;const r=t.items;let a=r.length-1;for(;a>=0;--a)r[a].cancel();t.items=[],this._notify(n,t,Date.now(),"complete")}remove(n){return this._charts.delete(n)}}var wh=new aK;const _j="transparent",lK={boolean:(e,n,t)=>t>.5?n:e,color(e,n,t){const r=q5(e||_j),a=r.valid&&q5(n||_j);return a&&a.valid?a.mix(r,t).hexString():n},number:(e,n,t)=>e+(n-e)*t};class cK{constructor(n,t,r,a){const c=t[r];a=XC([n.to,a,c,n.from]);const h=XC([n.from,c,a]);this._active=!0,this._fn=n.fn||lK[n.type||typeof h],this._easing=WC[n.easing]||WC.linear,this._start=Math.floor(Date.now()+(n.delay||0)),this._duration=this._total=Math.floor(n.duration),this._loop=!!n.loop,this._target=t,this._prop=r,this._from=h,this._to=a,this._promises=void 0}active(){return this._active}update(n,t,r){if(this._active){this._notify(!1);const a=this._target[this._prop],c=r-this._start,h=this._duration-c;this._start=r,this._duration=Math.floor(Math.max(h,n.duration)),this._total+=c,this._loop=!!n.loop,this._to=XC([n.to,t,a,n.from]),this._from=XC([n.from,a,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(n){const t=n-this._start,r=this._duration,a=this._prop,c=this._from,h=this._loop,f=this._to;let b;if(this._active=c!==f&&(h||t<r),!this._active)return this._target[a]=f,void this._notify(!0);t<0?this._target[a]=c:(b=t/r%2,b=h&&b>1?2-b:b,b=this._easing(Math.min(1,Math.max(0,b))),this._target[a]=this._fn(c,f,b))}wait(){const n=this._promises||(this._promises=[]);return new Promise((t,r)=>{n.push({res:t,rej:r})})}_notify(n){const t=n?"res":"rej",r=this._promises||[];for(let a=0;a<r.length;a++)r[a][t]()}}class bj{constructor(n,t){this._chart=n,this._properties=new Map,this.configure(t)}configure(n){if(!Sn(n))return;const t=Object.keys(to.animation),r=this._properties;Object.getOwnPropertyNames(n).forEach(a=>{const c=n[a];if(!Sn(c))return;const h={};for(const f of t)h[f]=c[f];(Fr(c.properties)&&c.properties||[a]).forEach(f=>{(f===a||!r.has(f))&&r.set(f,h)})})}_animateOptions(n,t){const r=t.options,a=function uK(e,n){if(!n)return;let t=e.options;if(t)return t.$shared&&(e.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t;e.options=n}(n,r);if(!a)return[];const c=this._createAnimations(a,r);return r.$shared&&function dK(e,n){const t=[],r=Object.keys(n);for(let a=0;a<r.length;a++){const c=e[r[a]];c&&c.active()&&t.push(c.wait())}return Promise.all(t)}(n.options.$animations,r).then(()=>{n.options=r},()=>{}),c}_createAnimations(n,t){const r=this._properties,a=[],c=n.$animations||(n.$animations={}),h=Object.keys(t),f=Date.now();let b;for(b=h.length-1;b>=0;--b){const x=h[b];if("$"===x.charAt(0))continue;if("options"===x){a.push(...this._animateOptions(n,t));continue}const M=t[x];let T=c[x];const I=r.get(x);if(T){if(I&&T.active()){T.update(I,M,f);continue}T.cancel()}I&&I.duration?(c[x]=T=new cK(I,n,x,M),a.push(T)):n[x]=M}return a}update(n,t){if(0===this._properties.size)return void Object.assign(n,t);const r=this._createAnimations(n,t);return r.length?(wh.add(this._chart,r),!0):void 0}}function yj(e,n){const t=e&&e.options||{},r=t.reverse,a=void 0===t.min?n:0,c=void 0===t.max?n:0;return{start:r?c:a,end:r?a:c}}function vj(e,n){const t=[],r=e._getSortedDatasetMetas(n);let a,c;for(a=0,c=r.length;a<c;++a)t.push(r[a].index);return t}function xj(e,n,t,r={}){const a=e.keys,c="single"===r.mode;let h,f,b,x;if(null!==n){for(h=0,f=a.length;h<f;++h){if(b=+a[h],b===t){if(r.all)continue;break}x=e.values[b],uo(x)&&(c||0===n||Gd(n)===Gd(x))&&(n+=x)}return n}}function wj(e,n){const t=e&&e.options.stacked;return t||void 0===t&&void 0!==n.stack}function _K(e,n,t){const r=e[n]||(e[n]={});return r[t]||(r[t]={})}function Cj(e,n,t,r){for(const a of n.getMatchingVisibleMetas(r).reverse()){const c=e[a.index];if(t&&c>0||!t&&c<0)return a.index}return null}function Mj(e,n){const{chart:t,_cachedMeta:r}=e,a=t._stacks||(t._stacks={}),{iScale:c,vScale:h,index:f}=r,b=c.axis,x=h.axis,M=function fK(e,n,t){return`${e.id}.${n.id}.${t.stack||t.type}`}(c,h,r),T=n.length;let I;for(let L=0;L<T;++L){const N=n[L],{[b]:V,[x]:$}=N;I=(N._stacks||(N._stacks={}))[x]=_K(a,M,V),I[f]=$,I._top=Cj(I,h,!0,r.type),I._bottom=Cj(I,h,!1,r.type),(I._visualValues||(I._visualValues={}))[f]=$}}function jB(e,n){const t=e.scales;return Object.keys(t).filter(r=>t[r].axis===n).shift()}function KC(e,n){const t=e.controller.index,r=e.vScale&&e.vScale.axis;if(r){n=n||e._parsed;for(const a of n){const c=a._stacks;if(!c||void 0===c[r]||void 0===c[r][t])return;delete c[r][t],void 0!==c[r]._visualValues&&void 0!==c[r]._visualValues[t]&&delete c[r]._visualValues[t]}}}const UB=e=>"reset"===e||"none"===e,Dj=(e,n)=>n?e:Object.assign({},e);let Pp=(()=>class e{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,r){this.chart=t,this._ctx=t.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=wj(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&KC(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,r=this._cachedMeta,a=this.getDataset(),c=(I,L,N,V)=>"x"===I?L:"r"===I?V:N,h=r.xAxisID=cn(a.xAxisID,jB(t,"x")),f=r.yAxisID=cn(a.yAxisID,jB(t,"y")),b=r.rAxisID=cn(a.rAxisID,jB(t,"r")),x=r.indexAxis,M=r.iAxisID=c(x,h,f,b),T=r.vAxisID=c(x,f,h,b);r.xScale=this.getScaleForId(h),r.yScale=this.getScaleForId(f),r.rScale=this.getScaleForId(b),r.iScale=this.getScaleForId(M),r.vScale=this.getScaleForId(T)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const r=this._cachedMeta;return t===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&z5(this._data,this),t._stacked&&KC(t)}_dataCheck(){const t=this.getDataset(),r=t.data||(t.data=[]),a=this._data;if(Sn(r))this._data=function pK(e){const n=Object.keys(e),t=new Array(n.length);let r,a,c;for(r=0,a=n.length;r<a;++r)c=n[r],t[r]={x:c,y:e[c]};return t}(r);else if(a!==r){if(a){z5(a,this);const c=this._cachedMeta;KC(c),c._parsed=[]}r&&Object.isExtensible(r)&&function oX(e,n){e._chartjs?e._chartjs.listeners.push(n):(Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[n]}}),N5.forEach(t=>{const r="_onData"+DB(t),a=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value(...c){const h=a.apply(this,c);return e._chartjs.listeners.forEach(f=>{"function"==typeof f[r]&&f[r](...c)}),h}})}))}(r,this),this._syncList=[],this._data=r}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const r=this._cachedMeta,a=this.getDataset();let c=!1;this._dataCheck();const h=r._stacked;r._stacked=wj(r.vScale,r),r.stack!==a.stack&&(c=!0,KC(r),r.stack=a.stack),this._resyncElements(t),(c||h!==r._stacked)&&Mj(this,r._parsed)}configure(){const t=this.chart.config,r=t.datasetScopeKeys(this._type),a=t.getOptionScopes(this.getDataset(),r,!0);this.options=t.createResolver(a,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,r){const{_cachedMeta:a,_data:c}=this,{iScale:h,_stacked:f}=a,b=h.axis;let T,I,L,x=0===t&&r===c.length||a._sorted,M=t>0&&a._parsed[t-1];if(!1===this._parsing)a._parsed=c,a._sorted=!0,L=c;else{L=Fr(c[t])?this.parseArrayData(a,c,t,r):Sn(c[t])?this.parseObjectData(a,c,t,r):this.parsePrimitiveData(a,c,t,r);const N=()=>null===I[b]||M&&I[b]<M[b];for(T=0;T<r;++T)a._parsed[T+t]=I=L[T],x&&(N()&&(x=!1),M=I);a._sorted=x}f&&Mj(this,L)}parsePrimitiveData(t,r,a,c){const{iScale:h,vScale:f}=t,b=h.axis,x=f.axis,M=h.getLabels(),T=h===f,I=new Array(c);let L,N,V;for(L=0,N=c;L<N;++L)V=L+a,I[L]={[b]:T||h.parse(M[V],V),[x]:f.parse(r[V],V)};return I}parseArrayData(t,r,a,c){const{xScale:h,yScale:f}=t,b=new Array(c);let x,M,T,I;for(x=0,M=c;x<M;++x)T=x+a,I=r[T],b[x]={x:h.parse(I[0],T),y:f.parse(I[1],T)};return b}parseObjectData(t,r,a,c){const{xScale:h,yScale:f}=t,{xAxisKey:b="x",yAxisKey:x="y"}=this._parsing,M=new Array(c);let T,I,L,N;for(T=0,I=c;T<I;++T)L=T+a,N=r[L],M[T]={x:h.parse(Ep(N,b),L),y:f.parse(Ep(N,x),L)};return M}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,r,a){const h=this._cachedMeta,f=r[t.axis];return xj({keys:vj(this.chart,!0),values:r._stacks[t.axis]._visualValues},f,h.index,{mode:a})}updateRangeFromParsed(t,r,a,c){const h=a[r.axis];let f=null===h?NaN:h;const b=c&&a._stacks[r.axis];c&&b&&(c.values=b,f=xj(c,h,this._cachedMeta.index)),t.min=Math.min(t.min,f),t.max=Math.max(t.max,f)}getMinMax(t,r){const a=this._cachedMeta,c=a._parsed,h=a._sorted&&t===a.iScale,f=c.length,b=this._getOtherScale(t),x=((e,n,t)=>e&&!n.hidden&&n._stacked&&{keys:vj(this.chart,!0),values:null})(r,a),M={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:T,max:I}=function gK(e){const{min:n,max:t,minDefined:r,maxDefined:a}=e.getUserBounds();return{min:r?n:Number.NEGATIVE_INFINITY,max:a?t:Number.POSITIVE_INFINITY}}(b);let L,N;function V(){N=c[L];const $=N[b.axis];return!uo(N[t.axis])||T>$||I<$}for(L=0;L<f&&(V()||(this.updateRangeFromParsed(M,t,N,x),!h));++L);if(h)for(L=f-1;L>=0;--L)if(!V()){this.updateRangeFromParsed(M,t,N,x);break}return M}getAllParsedValues(t){const r=this._cachedMeta._parsed,a=[];let c,h,f;for(c=0,h=r.length;c<h;++c)f=r[c][t.axis],uo(f)&&a.push(f);return a}getMaxOverflow(){return!1}getLabelAndValue(t){const r=this._cachedMeta,a=r.iScale,c=r.vScale,h=this.getParsed(t);return{label:a?""+a.getLabelForValue(h[a.axis]):"",value:c?""+c.getLabelForValue(h[c.axis]):""}}_update(t){const r=this._cachedMeta;this.update(t||"default"),r._clip=function mK(e){let n,t,r,a;return Sn(e)?(n=e.top,t=e.right,r=e.bottom,a=e.left):n=t=r=a=e,{top:n,right:t,bottom:r,left:a,disabled:!1===e}}(cn(this.options.clip,function hK(e,n,t){if(!1===t)return!1;const r=yj(e,t),a=yj(n,t);return{top:a.end,right:r.end,bottom:a.start,left:r.start}}(r.xScale,r.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,a=this._cachedMeta,c=a.data||[],h=this.chart.chartArea,f=[],b=this._drawStart||0,x=this._drawCount||c.length-b,M=this.options.drawActiveElementsOnTop;let T;for(a.dataset&&a.dataset.draw(t,h,b,x),T=b;T<b+x;++T){const I=c[T];I.hidden||(I.active&&M?f.push(I):I.draw(t,h))}for(T=0;T<f.length;++T)f[T].draw(t,h)}getStyle(t,r){const a=r?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(a):this.resolveDataElementOptions(t||0,a)}getContext(t,r,a){const c=this.getDataset();let h;if(t>=0&&t<this._cachedMeta.data.length){const f=this._cachedMeta.data[t];h=f.$context||(f.$context=function yK(e,n,t){return Rp(e,{active:!1,dataIndex:n,parsed:void 0,raw:void 0,element:t,index:n,mode:"default",type:"data"})}(this.getContext(),t,f)),h.parsed=this.getParsed(t),h.raw=c.data[t],h.index=h.dataIndex=t}else h=this.$context||(this.$context=function bK(e,n){return Rp(e,{active:!1,dataset:void 0,datasetIndex:n,index:n,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),h.dataset=c,h.index=h.datasetIndex=this.index;return h.active=!!r,h.mode=a,h}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,r){return this._resolveElementOptions(this.dataElementType.id,r,t)}_resolveElementOptions(t,r="default",a){const c="active"===r,h=this._cachedDataOpts,f=t+"-"+r,b=h[f],x=this.enableOptionSharing&&HC(a);if(b)return Dj(b,x);const M=this.chart.config,T=M.datasetElementScopeKeys(this._type,t),I=c?[`${t}Hover`,"hover",t,""]:[t,""],L=M.getOptionScopes(this.getDataset(),T),N=Object.keys(to.elements[t]),$=M.resolveNamedOptions(L,N,()=>this.getContext(a,c,r),I);return $.$shared&&($.$shared=x,h[f]=Object.freeze(Dj($,x))),$}_resolveAnimations(t,r,a){const c=this.chart,h=this._cachedDataOpts,f=`animation-${r}`,b=h[f];if(b)return b;let x;if(!1!==c.options.animation){const T=this.chart.config,I=T.datasetAnimationScopeKeys(this._type,r),L=T.getOptionScopes(this.getDataset(),I);x=T.createResolver(L,this.getContext(t,a,r))}const M=new bj(c,x&&x.animations);return x&&x._cacheable&&(h[f]=Object.freeze(M)),M}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,r){return!r||UB(t)||this.chart._animationsDisabled}_getSharedOptions(t,r){const a=this.resolveDataElementOptions(t,r),c=this._sharedOptions,h=this.getSharedOptions(a),f=this.includeOptions(r,h)||h!==c;return this.updateSharedOptions(h,r,a),{sharedOptions:h,includeOptions:f}}updateElement(t,r,a,c){UB(c)?Object.assign(t,a):this._resolveAnimations(r,c).update(t,a)}updateSharedOptions(t,r,a){t&&!UB(r)&&this._resolveAnimations(void 0,r).update(t,a)}_setStyle(t,r,a,c){t.active=c;const h=this.getStyle(r,c);this._resolveAnimations(r,a,c).update(t,{options:!c&&this.getSharedOptions(h)||h})}removeHoverStyle(t,r,a){this._setStyle(t,a,"active",!1)}setHoverStyle(t,r,a){this._setStyle(t,a,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const r=this._data,a=this._cachedMeta.data;for(const[b,x,M]of this._syncList)this[b](x,M);this._syncList=[];const c=a.length,h=r.length,f=Math.min(h,c);f&&this.parse(0,f),h>c?this._insertElements(c,h-c,t):h<c&&this._removeElements(h,c-h)}_insertElements(t,r,a=!0){const c=this._cachedMeta,h=c.data,f=t+r;let b;const x=M=>{for(M.length+=r,b=M.length-1;b>=f;b--)M[b]=M[b-r]};for(x(h),b=t;b<f;++b)h[b]=new this.dataElementType;this._parsing&&x(c._parsed),this.parse(t,r),a&&this.updateElements(h,t,r,"reset")}updateElements(t,r,a,c){}_removeElements(t,r){const a=this._cachedMeta;if(this._parsing){const c=a._parsed.splice(t,r);a._stacked&&KC(a,c)}a.data.splice(t,r)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[r,a,c]=t;this[r](a,c)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,r){r&&this._sync(["_removeElements",t,r]);const a=arguments.length-2;a&&this._sync(["_insertElements",t,a])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}})();function wK(e){const n=e.iScale,t=function xK(e,n){if(!e._cache.$bar){const t=e.getMatchingVisibleMetas(n);let r=[];for(let a=0,c=t.length;a<c;a++)r=r.concat(t[a].controller.getAllParsedValues(e));e._cache.$bar=V5(r.sort((a,c)=>a-c))}return e._cache.$bar}(n,e.type);let a,c,h,f,r=n._length;const b=()=>{32767===h||-32768===h||(HC(f)&&(r=Math.min(r,Math.abs(h-f)||r)),f=h)};for(a=0,c=t.length;a<c;++a)h=n.getPixelForValue(t[a]),b();for(f=void 0,a=0,c=n.ticks.length;a<c;++a)h=n.getPixelForTick(a),b();return r}function kj(e,n,t,r){return Fr(e)?function DK(e,n,t,r){const a=t.parse(e[0],r),c=t.parse(e[1],r),h=Math.min(a,c),f=Math.max(a,c);let b=h,x=f;Math.abs(h)>Math.abs(f)&&(b=f,x=h),n[t.axis]=x,n._custom={barStart:b,barEnd:x,start:a,end:c,min:h,max:f}}(e,n,t,r):n[t.axis]=t.parse(e,r),n}function Sj(e,n,t,r){const a=e.iScale,c=e.vScale,h=a.getLabels(),f=a===c,b=[];let x,M,T,I;for(x=t,M=t+r;x<M;++x)I=n[x],T={},T[a.axis]=f||a.parse(h[x],x),b.push(kj(I,T,c,x));return b}function HB(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function TK(e,n,t,r){let a=n.borderSkipped;const c={};if(!a)return void(e.borderSkipped=c);if(!0===a)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:h,end:f,reverse:b,top:x,bottom:M}=function SK(e){let n,t,r,a,c;return e.horizontal?(n=e.base>e.x,t="left",r="right"):(n=e.base<e.y,t="bottom",r="top"),n?(a="end",c="start"):(a="start",c="end"),{start:t,end:r,reverse:n,top:a,bottom:c}}(e);"middle"===a&&t&&(e.enableBorderRadius=!0,(t._top||0)===r?a=x:(t._bottom||0)===r?a=M:(c[Tj(M,h,f,b)]=!0,a=x)),c[Tj(a,h,f,b)]=!0,e.borderSkipped=c}function Tj(e,n,t,r){return r?(e=function EK(e,n,t){return e===n?t:e===t?n:e}(e,n,t),e=Ej(e,t,n)):e=Ej(e,n,t),e}function Ej(e,n,t){return"start"===e?n:"end"===e?t:e}function AK(e,{inflateAmount:n},t){e.inflateAmount="auto"===n?1===t?.33:0:n}let IK=(()=>class e extends Pp{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,r,a,c){return Sj(t,r,a,c)}parseArrayData(t,r,a,c){return Sj(t,r,a,c)}parseObjectData(t,r,a,c){const{iScale:h,vScale:f}=t,{xAxisKey:b="x",yAxisKey:x="y"}=this._parsing,M="x"===h.axis?b:x,T="x"===f.axis?b:x,I=[];let L,N,V,$;for(L=a,N=a+c;L<N;++L)$=r[L],V={},V[h.axis]=h.parse(Ep($,M),L),I.push(kj(Ep($,T),V,f,L));return I}updateRangeFromParsed(t,r,a,c){super.updateRangeFromParsed(t,r,a,c);const h=a._custom;h&&r===this._cachedMeta.vScale&&(t.min=Math.min(t.min,h.min),t.max=Math.max(t.max,h.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const r=this._cachedMeta,{iScale:a,vScale:c}=r,h=this.getParsed(t),f=h._custom,b=HB(f)?"["+f.start+", "+f.end+"]":""+c.getLabelForValue(h[c.axis]);return{label:""+a.getLabelForValue(h[a.axis]),value:b}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(t){const r=this._cachedMeta;this.updateElements(r.data,0,r.data.length,t)}updateElements(t,r,a,c){const h="reset"===c,{index:f,_cachedMeta:{vScale:b}}=this,x=b.getBasePixel(),M=b.isHorizontal(),T=this._getRuler(),{sharedOptions:I,includeOptions:L}=this._getSharedOptions(r,c);for(let N=r;N<r+a;N++){const V=this.getParsed(N),$=h||Vn(V[b.axis])?{base:x,head:x}:this._calculateBarValuePixels(N),nt=this._calculateBarIndexPixels(N,T),tt=(V._stacks||{})[b.axis],_t={horizontal:M,base:$.base,enableBorderRadius:!tt||HB(V._custom)||f===tt._top||f===tt._bottom,x:M?$.head:nt.center,y:M?nt.center:$.head,height:M?nt.size:Math.abs($.size),width:M?Math.abs($.size):nt.size};L&&(_t.options=I||this.resolveDataElementOptions(N,t[N].active?"active":c));const wt=_t.options||t[N].options;TK(_t,wt,tt,f),AK(_t,wt,T.ratio),this.updateElement(t[N],N,_t,c)}}_getStacks(t,r){const{iScale:a}=this._cachedMeta,c=a.getMatchingVisibleMetas(this._type).filter(x=>x.controller.options.grouped),h=a.options.stacked,f=[],b=x=>{const M=x.controller.getParsed(r),T=M&&M[x.vScale.axis];if(Vn(T)||isNaN(T))return!0};for(const x of c)if((void 0===r||!b(x))&&((!1===h||-1===f.indexOf(x.stack)||void 0===h&&void 0===x.stack)&&f.push(x.stack),x.index===t))break;return f.length||f.push(void 0),f}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,r,a){const c=this._getStacks(t,a),h=void 0!==r?c.indexOf(r):-1;return-1===h?c.length-1:h}_getRuler(){const t=this.options,r=this._cachedMeta,a=r.iScale,c=[];let h,f;for(h=0,f=r.data.length;h<f;++h)c.push(a.getPixelForValue(this.getParsed(h)[a.axis],h));const b=t.barThickness;return{min:b||wK(r),pixels:c,start:a._startPixel,end:a._endPixel,stackCount:this._getStackCount(),scale:a,grouped:t.grouped,ratio:b?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:r,_stacked:a,index:c},options:{base:h,minBarLength:f}}=this,b=h||0,x=this.getParsed(t),M=x._custom,T=HB(M);let V,$,I=x[r.axis],L=0,N=a?this.applyStack(r,x,a):I;N!==I&&(L=N-I,N=I),T&&(I=M.barStart,N=M.barEnd-M.barStart,0!==I&&Gd(I)!==Gd(M.barEnd)&&(L=0),L+=I);const nt=Vn(h)||T?L:h;let tt=r.getPixelForValue(nt);if(V=this.chart.getDataVisibility(t)?r.getPixelForValue(L+N):tt,$=V-tt,Math.abs($)<f){$=function kK(e,n,t){return 0!==e?Gd(e):(n.isHorizontal()?1:-1)*(n.min>=t?1:-1)}($,r,b)*f,I===b&&(tt-=$/2);const _t=r.getPixelForDecimal(0),wt=r.getPixelForDecimal(1),Dt=Math.min(_t,wt),Vt=Math.max(_t,wt);tt=Math.max(Math.min(tt,Vt),Dt),V=tt+$,a&&!T&&(x._stacks[r.axis]._visualValues[c]=r.getValueForPixel(V)-r.getValueForPixel(tt))}if(tt===r.getPixelForValue(b)){const _t=Gd($)*r.getLineWidthForValue(b)/2;tt+=_t,$-=_t}return{size:$,base:tt,head:V,center:V+$/2}}_calculateBarIndexPixels(t,r){const a=r.scale,c=this.options,h=c.skipNull,f=cn(c.maxBarThickness,1/0);let b,x;if(r.grouped){const M=h?this._getStackCount(t):r.stackCount,T="flex"===c.barThickness?function MK(e,n,t,r){const a=n.pixels,c=a[e];let h=e>0?a[e-1]:null,f=e<a.length-1?a[e+1]:null;const b=t.categoryPercentage;null===h&&(h=c-(null===f?n.end-n.start:f-c)),null===f&&(f=c+c-h);const x=c-(c-Math.min(h,f))/2*b;return{chunk:Math.abs(f-h)/2*b/r,ratio:t.barPercentage,start:x}}(t,r,c,M):function CK(e,n,t,r){const a=t.barThickness;let c,h;return Vn(a)?(c=n.min*t.categoryPercentage,h=t.barPercentage):(c=a*r,h=1),{chunk:c/r,ratio:h,start:n.pixels[e]-c/2}}(t,r,c,M),I=this._getStackIndex(this.index,this._cachedMeta.stack,h?t:void 0);b=T.start+T.chunk*I+T.chunk/2,x=Math.min(f,T.chunk*T.ratio)}else b=a.getPixelForValue(this.getParsed(t)[a.axis],t),x=Math.min(f,r.min*r.ratio);return{base:b-x/2,head:b+x/2,center:b,size:x}}draw(){const t=this._cachedMeta,r=t.vScale,a=t.data,c=a.length;let h=0;for(;h<c;++h)null!==this.getParsed(h)[r.axis]&&a[h].draw(this._ctx)}})(),RK=(()=>class e extends Pp{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,r,a,c){const h=super.parsePrimitiveData(t,r,a,c);for(let f=0;f<h.length;f++)h[f]._custom=this.resolveDataElementOptions(f+a).radius;return h}parseArrayData(t,r,a,c){const h=super.parseArrayData(t,r,a,c);for(let f=0;f<h.length;f++)h[f]._custom=cn(r[a+f][2],this.resolveDataElementOptions(f+a).radius);return h}parseObjectData(t,r,a,c){const h=super.parseObjectData(t,r,a,c);for(let f=0;f<h.length;f++){const b=r[a+f];h[f]._custom=cn(b&&b.r&&+b.r,this.resolveDataElementOptions(f+a).radius)}return h}getMaxOverflow(){const t=this._cachedMeta.data;let r=0;for(let a=t.length-1;a>=0;--a)r=Math.max(r,t[a].size(this.resolveDataElementOptions(a))/2);return r>0&&r}getLabelAndValue(t){const r=this._cachedMeta,a=this.chart.data.labels||[],{xScale:c,yScale:h}=r,f=this.getParsed(t),b=c.getLabelForValue(f.x),x=h.getLabelForValue(f.y),M=f._custom;return{label:a[t]||"",value:"("+b+", "+x+(M?", "+M:"")+")"}}update(t){const r=this._cachedMeta.data;this.updateElements(r,0,r.length,t)}updateElements(t,r,a,c){const h="reset"===c,{iScale:f,vScale:b}=this._cachedMeta,{sharedOptions:x,includeOptions:M}=this._getSharedOptions(r,c),T=f.axis,I=b.axis;for(let L=r;L<r+a;L++){const N=t[L],V=!h&&this.getParsed(L),$={},nt=$[T]=h?f.getPixelForDecimal(.5):f.getPixelForValue(V[T]),tt=$[I]=h?b.getBasePixel():b.getPixelForValue(V[I]);$.skip=isNaN(nt)||isNaN(tt),M&&($.options=x||this.resolveDataElementOptions(L,N.active?"active":c),h&&($.options.radius=0)),this.updateElement(N,L,$,c)}}resolveDataElementOptions(t,r){const a=this.getParsed(t);let c=super.resolveDataElementOptions(t,r);c.$shared&&(c=Object.assign({},c,{$shared:!1}));const h=c.radius;return"active"!==r&&(c.radius=0),c.radius+=cn(a&&a._custom,h),c}})(),$B=(()=>class e extends Pp{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const r=t.data;if(r.labels.length&&r.datasets.length){const{labels:{pointStyle:a,color:c}}=t.legend.options;return r.labels.map((h,f)=>{const x=t.getDatasetMeta(0).controller.getStyle(f);return{text:h,fillStyle:x.backgroundColor,strokeStyle:x.borderColor,fontColor:c,lineWidth:x.borderWidth,pointStyle:a,hidden:!t.getDataVisibility(f),index:f}})}return[]}},onClick(t,r,a){a.chart.toggleDataVisibility(r.index),a.chart.update()}}}};constructor(t,r){super(t,r),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,r){const a=this.getDataset().data,c=this._cachedMeta;if(!1===this._parsing)c._parsed=a;else{let f,b,h=x=>+a[x];if(Sn(a[t])){const{key:x="value"}=this._parsing;h=M=>+Ep(a[M],x)}for(f=t,b=t+r;f<b;++f)c._parsed[f]=h(f)}}_getRotation(){return Yc(this.options.rotation-90)}_getCircumference(){return Yc(this.options.circumference)}_getRotationExtents(){let t=Br,r=-Br;for(let a=0;a<this.chart.data.datasets.length;++a)if(this.chart.isDatasetVisible(a)&&this.chart.getDatasetMeta(a).type===this._type){const c=this.chart.getDatasetMeta(a).controller,h=c._getRotation(),f=c._getCircumference();t=Math.min(t,h),r=Math.max(r,h+f)}return{rotation:t,circumference:r-t}}update(t){const r=this.chart,{chartArea:a}=r,c=this._cachedMeta,h=c.data,f=this.getMaxBorderWidth()+this.getMaxOffset(h)+this.options.spacing,b=Math.max((Math.min(a.width,a.height)-f)/2,0),x=Math.min(((e,n)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100:+e/n)(this.options.cutout,b),1),M=this._getRingWeight(this.index),{circumference:T,rotation:I}=this._getRotationExtents(),{ratioX:L,ratioY:N,offsetX:V,offsetY:$}=function PK(e,n,t){let r=1,a=1,c=0,h=0;if(n<Br){const f=e,b=f+n,x=Math.cos(f),M=Math.sin(f),T=Math.cos(b),I=Math.sin(b),L=(_t,wt,Dt)=>GC(_t,f,b,!0)?1:Math.max(wt,wt*t,Dt,Dt*t),N=(_t,wt,Dt)=>GC(_t,f,b,!0)?-1:Math.min(wt,wt*t,Dt,Dt*t),V=L(0,x,T),$=L(Mo,M,I),nt=N(Lr,x,T),tt=N(Lr+Mo,M,I);r=(V-nt)/2,a=($-tt)/2,c=-(V+nt)/2,h=-($+tt)/2}return{ratioX:r,ratioY:a,offsetX:c,offsetY:h}}(I,T,x),_t=Math.max(Math.min((a.width-f)/L,(a.height-f)/N)/2,0),wt=E5(this.options.radius,_t),Vt=(wt-Math.max(wt*x,0))/this._getVisibleDatasetWeightTotal();this.offsetX=V*wt,this.offsetY=$*wt,c.total=this.calculateTotal(),this.outerRadius=wt-Vt*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-Vt*M,0),this.updateElements(h,0,h.length,t)}_circumference(t,r){const a=this.options,c=this._cachedMeta,h=this._getCircumference();return r&&a.animation.animateRotate||!this.chart.getDataVisibility(t)||null===c._parsed[t]||c.data[t].hidden?0:this.calculateCircumference(c._parsed[t]*h/Br)}updateElements(t,r,a,c){const h="reset"===c,f=this.chart,b=f.chartArea,T=(b.left+b.right)/2,I=(b.top+b.bottom)/2,L=h&&f.options.animation.animateScale,N=L?0:this.innerRadius,V=L?0:this.outerRadius,{sharedOptions:$,includeOptions:nt}=this._getSharedOptions(r,c);let _t,tt=this._getRotation();for(_t=0;_t<r;++_t)tt+=this._circumference(_t,h);for(_t=r;_t<r+a;++_t){const wt=this._circumference(_t,h),Dt=t[_t],Vt={x:T+this.offsetX,y:I+this.offsetY,startAngle:tt,endAngle:tt+wt,circumference:wt,outerRadius:V,innerRadius:N};nt&&(Vt.options=$||this.resolveDataElementOptions(_t,Dt.active?"active":c)),tt+=wt,this.updateElement(Dt,_t,Vt,c)}}calculateTotal(){const t=this._cachedMeta,r=t.data;let c,a=0;for(c=0;c<r.length;c++){const h=t._parsed[c];null!==h&&!isNaN(h)&&this.chart.getDataVisibility(c)&&!r[c].hidden&&(a+=Math.abs(h))}return a}calculateCircumference(t){const r=this._cachedMeta.total;return r>0&&!isNaN(t)?Br*(Math.abs(t)/r):0}getLabelAndValue(t){const a=this.chart,c=a.data.labels||[],h=qC(this._cachedMeta._parsed[t],a.options.locale);return{label:c[t]||"",value:h}}getMaxBorderWidth(t){let r=0;const a=this.chart;let c,h,f,b,x;if(!t)for(c=0,h=a.data.datasets.length;c<h;++c)if(a.isDatasetVisible(c)){f=a.getDatasetMeta(c),t=f.data,b=f.controller;break}if(!t)return 0;for(c=0,h=t.length;c<h;++c)x=b.resolveDataElementOptions(c),"inner"!==x.borderAlign&&(r=Math.max(r,x.borderWidth||0,x.hoverBorderWidth||0));return r}getMaxOffset(t){let r=0;for(let a=0,c=t.length;a<c;++a){const h=this.resolveDataElementOptions(a);r=Math.max(r,h.offset||0,h.hoverOffset||0)}return r}_getRingWeightOffset(t){let r=0;for(let a=0;a<t;++a)this.chart.isDatasetVisible(a)&&(r+=this._getRingWeight(a));return r}_getRingWeight(t){return Math.max(cn(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}})(),OK=(()=>class e extends Pp{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const r=this._cachedMeta,{dataset:a,data:c=[],_dataset:h}=r,f=this.chart._animationsDisabled;let{start:b,count:x}=H5(r,c,f);this._drawStart=b,this._drawCount=x,$5(r)&&(b=0,x=c.length),a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!h._decimated,a.points=c;const M=this.resolveDatasetElementOptions(t);this.options.showLine||(M.borderWidth=0),M.segment=this.options.segment,this.updateElement(a,void 0,{animated:!f,options:M},t),this.updateElements(c,b,x,t)}updateElements(t,r,a,c){const h="reset"===c,{iScale:f,vScale:b,_stacked:x,_dataset:M}=this._cachedMeta,{sharedOptions:T,includeOptions:I}=this._getSharedOptions(r,c),L=f.axis,N=b.axis,{spanGaps:V,segment:$}=this.options,nt=Dv(V)?V:Number.POSITIVE_INFINITY,tt=this.chart._animationsDisabled||h||"none"===c,_t=r+a,wt=t.length;let Dt=r>0&&this.getParsed(r-1);for(let Vt=0;Vt<wt;++Vt){const ae=t[Vt],ee=tt?ae:{};if(Vt<r||Vt>=_t){ee.skip=!0;continue}const Fe=this.getParsed(Vt),Ai=Vn(Fe[N]),Wi=ee[L]=f.getPixelForValue(Fe[L],Vt),dn=ee[N]=h||Ai?b.getBasePixel():b.getPixelForValue(x?this.applyStack(b,Fe,x):Fe[N],Vt);ee.skip=isNaN(Wi)||isNaN(dn)||Ai,ee.stop=Vt>0&&Math.abs(Fe[L]-Dt[L])>nt,$&&(ee.parsed=Fe,ee.raw=M.data[Vt]),I&&(ee.options=T||this.resolveDataElementOptions(Vt,ae.active?"active":c)),tt||this.updateElement(ae,Vt,ee,c),Dt=Fe}}getMaxOverflow(){const t=this._cachedMeta,r=t.dataset,a=r.options&&r.options.borderWidth||0,c=t.data||[];if(!c.length)return a;const h=c[0].size(this.resolveDataElementOptions(0)),f=c[c.length-1].size(this.resolveDataElementOptions(c.length-1));return Math.max(a,h,f)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}})(),Aj=(()=>class e extends Pp{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const r=t.data;if(r.labels.length&&r.datasets.length){const{labels:{pointStyle:a,color:c}}=t.legend.options;return r.labels.map((h,f)=>{const x=t.getDatasetMeta(0).controller.getStyle(f);return{text:h,fillStyle:x.backgroundColor,strokeStyle:x.borderColor,fontColor:c,lineWidth:x.borderWidth,pointStyle:a,hidden:!t.getDataVisibility(f),index:f}})}return[]}},onClick(t,r,a){a.chart.toggleDataVisibility(r.index),a.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,r){super(t,r),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const a=this.chart,c=a.data.labels||[],h=qC(this._cachedMeta._parsed[t].r,a.options.locale);return{label:c[t]||"",value:h}}parseObjectData(t,r,a,c){return oj.bind(this)(t,r,a,c)}update(t){const r=this._cachedMeta.data;this._updateRadius(),this.updateElements(r,0,r.length,t)}getMinMax(){const r={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return this._cachedMeta.data.forEach((a,c)=>{const h=this.getParsed(c).r;!isNaN(h)&&this.chart.getDataVisibility(c)&&(h<r.min&&(r.min=h),h>r.max&&(r.max=h))}),r}_updateRadius(){const t=this.chart,r=t.chartArea,a=t.options,c=Math.min(r.right-r.left,r.bottom-r.top),h=Math.max(c/2,0),b=(h-Math.max(a.cutoutPercentage?h/100*a.cutoutPercentage:1,0))/t.getVisibleDatasetCount();this.outerRadius=h-b*this.index,this.innerRadius=this.outerRadius-b}updateElements(t,r,a,c){const h="reset"===c,f=this.chart,x=f.options.animation,M=this._cachedMeta.rScale,T=M.xCenter,I=M.yCenter,L=M.getIndexAngle(0)-.5*Lr;let V,N=L;const $=360/this.countVisibleElements();for(V=0;V<r;++V)N+=this._computeAngle(V,c,$);for(V=r;V<r+a;V++){const nt=t[V];let tt=N,_t=N+this._computeAngle(V,c,$),wt=f.getDataVisibility(V)?M.getDistanceFromCenterForValue(this.getParsed(V).r):0;N=_t,h&&(x.animateScale&&(wt=0),x.animateRotate&&(tt=_t=L));const Dt={x:T,y:I,innerRadius:0,outerRadius:wt,startAngle:tt,endAngle:_t,options:this.resolveDataElementOptions(V,nt.active?"active":c)};this.updateElement(nt,V,Dt,c)}}countVisibleElements(){let r=0;return this._cachedMeta.data.forEach((a,c)=>{!isNaN(this.getParsed(c).r)&&this.chart.getDataVisibility(c)&&r++}),r}_computeAngle(t,r,a){return this.chart.getDataVisibility(t)?Yc(this.resolveDataElementOptions(t,r).angle||a):0}})();var FK=Object.freeze({__proto__:null,BarController:IK,BubbleController:RK,DoughnutController:$B,LineController:OK,PieController:(()=>class e extends $B{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}})(),PolarAreaController:Aj,RadarController:(()=>class e extends Pp{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){const r=this._cachedMeta.vScale,a=this.getParsed(t);return{label:r.getLabels()[t],value:""+r.getLabelForValue(a[r.axis])}}parseObjectData(t,r,a,c){return oj.bind(this)(t,r,a,c)}update(t){const r=this._cachedMeta,a=r.dataset,c=r.data||[],h=r.iScale.getLabels();if(a.points=c,"resize"!==t){const f=this.resolveDatasetElementOptions(t);this.options.showLine||(f.borderWidth=0),this.updateElement(a,void 0,{_loop:!0,_fullLoop:h.length===c.length,options:f},t)}this.updateElements(c,0,c.length,t)}updateElements(t,r,a,c){const h=this._cachedMeta.rScale,f="reset"===c;for(let b=r;b<r+a;b++){const x=t[b],M=this.resolveDataElementOptions(b,x.active?"active":c),T=h.getPointPositionForValue(b,this.getParsed(b).r),I=f?h.xCenter:T.x,L=f?h.yCenter:T.y,N={x:I,y:L,angle:T.angle,skip:isNaN(I)||isNaN(L),options:M};this.updateElement(x,b,N,c)}}})(),ScatterController:(()=>class e extends Pp{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){const r=this._cachedMeta,a=this.chart.data.labels||[],{xScale:c,yScale:h}=r,f=this.getParsed(t),b=c.getLabelForValue(f.x),x=h.getLabelForValue(f.y);return{label:a[t]||"",value:"("+b+", "+x+")"}}update(t){const r=this._cachedMeta,{data:a=[]}=r,c=this.chart._animationsDisabled;let{start:h,count:f}=H5(r,a,c);if(this._drawStart=h,this._drawCount=f,$5(r)&&(h=0,f=a.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:b,_dataset:x}=r;b._chart=this.chart,b._datasetIndex=this.index,b._decimated=!!x._decimated,b.points=a;const M=this.resolveDatasetElementOptions(t);M.segment=this.options.segment,this.updateElement(b,void 0,{animated:!c,options:M},t)}else this.datasetElementType&&(delete r.dataset,this.datasetElementType=!1);this.updateElements(a,h,f,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,r,a,c){const h="reset"===c,{iScale:f,vScale:b,_stacked:x,_dataset:M}=this._cachedMeta,T=this.resolveDataElementOptions(r,c),I=this.getSharedOptions(T),L=this.includeOptions(c,I),N=f.axis,V=b.axis,{spanGaps:$,segment:nt}=this.options,tt=Dv($)?$:Number.POSITIVE_INFINITY,_t=this.chart._animationsDisabled||h||"none"===c;let wt=r>0&&this.getParsed(r-1);for(let Dt=r;Dt<r+a;++Dt){const Vt=t[Dt],ae=this.getParsed(Dt),ee=_t?Vt:{},Fe=Vn(ae[V]),Ai=ee[N]=f.getPixelForValue(ae[N],Dt),Wi=ee[V]=h||Fe?b.getBasePixel():b.getPixelForValue(x?this.applyStack(b,ae,x):ae[V],Dt);ee.skip=isNaN(Ai)||isNaN(Wi)||Fe,ee.stop=Dt>0&&Math.abs(ae[N]-wt[N])>tt,nt&&(ee.parsed=ae,ee.raw=M.data[Dt]),L&&(ee.options=I||this.resolveDataElementOptions(Dt,Vt.active?"active":c)),_t||this.updateElement(Vt,Dt,ee,c),wt=ae}this.updateSharedOptions(I,c,T)}getMaxOverflow(){const t=this._cachedMeta,r=t.data||[];if(!this.options.showLine){let b=0;for(let x=r.length-1;x>=0;--x)b=Math.max(b,r[x].size(this.resolveDataElementOptions(x))/2);return b>0&&b}const a=t.dataset,c=a.options&&a.options.borderWidth||0;if(!r.length)return c;const h=r[0].size(this.resolveDataElementOptions(0)),f=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(c,h,f)/2}})()});function u_(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class GB{static override(n){Object.assign(GB.prototype,n)}options;constructor(n){this.options=n||{}}init(){}formats(){return u_()}parse(){return u_()}format(){return u_()}add(){return u_()}diff(){return u_()}startOf(){return u_()}endOf(){return u_()}}var LK__date=GB;function BK(e,n,t,r){const{controller:a,data:c,_sorted:h}=e,f=a._cachedMeta.iScale;if(f&&n===f.axis&&"r"!==n&&h&&c.length){const b=f._reversePixels?nX:vh;if(!r)return b(c,n,t);if(a._sharedOptions){const x=c[0],M="function"==typeof x.getRange&&x.getRange(n);if(M){const T=b(c,n,t-M),I=b(c,n,t+M);return{lo:T.lo,hi:I.hi}}}}return{lo:0,hi:c.length-1}}function QC(e,n,t,r,a){const c=e.getSortedVisibleDatasetMetas(),h=t[n];for(let f=0,b=c.length;f<b;++f){const{index:x,data:M}=c[f],{lo:T,hi:I}=BK(c[f],n,h,a);for(let L=T;L<=I;++L){const N=M[L];N.skip||r(N,x,L)}}}function WB(e,n,t,r,a){const c=[];return!a&&!e.isPointInArea(n)||QC(e,t,n,function(f,b,x){!a&&!xh(f,e.chartArea,0)||f.inRange(n.x,n.y,r)&&c.push({element:f,datasetIndex:b,index:x})},!0),c}function qB(e,n,t,r,a,c){return c||e.isPointInArea(n)?"r"!==t||r?function VK(e,n,t,r,a,c){let h=[];const f=function NK(e){const n=-1!==e.indexOf("x"),t=-1!==e.indexOf("y");return function(r,a){const c=n?Math.abs(r.x-a.x):0,h=t?Math.abs(r.y-a.y):0;return Math.sqrt(Math.pow(c,2)+Math.pow(h,2))}}(t);let b=Number.POSITIVE_INFINITY;return QC(e,t,n,function x(M,T,I){const L=M.inRange(n.x,n.y,a);if(r&&!L)return;const N=M.getCenterPoint(a);if(!c&&!e.isPointInArea(N)&&!L)return;const $=f(n,N);$<b?(h=[{element:M,datasetIndex:T,index:I}],b=$):$===b&&h.push({element:M,datasetIndex:T,index:I})}),h}(e,n,t,r,a,c):function zK(e,n,t,r){let a=[];return QC(e,t,n,function c(h,f,b){const{startAngle:x,endAngle:M}=h.getProps(["startAngle","endAngle"],r),{angle:T}=B5(h,{x:n.x,y:n.y});GC(T,x,M)&&a.push({element:h,datasetIndex:f,index:b})}),a}(e,n,t,a):[]}function Ij(e,n,t,r,a){const c=[],h="x"===t?"inXRange":"inYRange";let f=!1;return QC(e,t,n,(b,x,M)=>{b[h](n[t],a)&&(c.push({element:b,datasetIndex:x,index:M}),f=f||b.inRange(n.x,n.y,a))}),r&&!f?[]:c}var jK={evaluateInteractionItems:QC,modes:{index(e,n,t,r){const a=c_(n,e),c=t.axis||"x",h=t.includeInvisible||!1,f=t.intersect?WB(e,a,c,r,h):qB(e,a,c,!1,r,h),b=[];return f.length?(e.getSortedVisibleDatasetMetas().forEach(x=>{const M=f[0].index,T=x.data[M];T&&!T.skip&&b.push({element:T,datasetIndex:x.index,index:M})}),b):[]},dataset(e,n,t,r){const a=c_(n,e),c=t.axis||"xy",h=t.includeInvisible||!1;let f=t.intersect?WB(e,a,c,r,h):qB(e,a,c,!1,r,h);if(f.length>0){const b=f[0].datasetIndex,x=e.getDatasetMeta(b).data;f=[];for(let M=0;M<x.length;++M)f.push({element:x[M],datasetIndex:b,index:M})}return f},point:(e,n,t,r)=>WB(e,c_(n,e),t.axis||"xy",r,t.includeInvisible||!1),nearest:(e,n,t,r)=>qB(e,c_(n,e),t.axis||"xy",t.intersect,r,t.includeInvisible||!1),x:(e,n,t,r)=>Ij(e,c_(n,e),"x",t.intersect,r),y:(e,n,t,r)=>Ij(e,c_(n,e),"y",t.intersect,r)}};const Rj=["left","top","right","bottom"];function JC(e,n){return e.filter(t=>t.pos===n)}function Pj(e,n){return e.filter(t=>-1===Rj.indexOf(t.pos)&&t.box.axis===n)}function tM(e,n){return e.sort((t,r)=>{const a=n?r:t,c=n?t:r;return a.weight===c.weight?a.index-c.index:a.weight-c.weight})}function Oj(e,n,t,r){return Math.max(e[t],n[t])+Math.max(e[r],n[r])}function Fj(e,n){e.top=Math.max(e.top,n.top),e.left=Math.max(e.left,n.left),e.bottom=Math.max(e.bottom,n.bottom),e.right=Math.max(e.right,n.right)}function WK(e,n,t,r){const{pos:a,box:c}=t,h=e.maxPadding;if(!Sn(a)){t.size&&(e[a]-=t.size);const T=r[t.stack]||{size:0,count:1};T.size=Math.max(T.size,t.horizontal?c.height:c.width),t.size=T.size/T.count,e[a]+=t.size}c.getPadding&&Fj(h,c.getPadding());const f=Math.max(0,n.outerWidth-Oj(h,e,"left","right")),b=Math.max(0,n.outerHeight-Oj(h,e,"top","bottom")),x=f!==e.w,M=b!==e.h;return e.w=f,e.h=b,t.horizontal?{same:x,other:M}:{same:M,other:x}}function YK(e,n){const t=n.maxPadding;return function r(a){const c={left:0,top:0,right:0,bottom:0};return a.forEach(h=>{c[h]=Math.max(n[h],t[h])}),c}(e?["left","right"]:["top","bottom"])}function eM(e,n,t,r){const a=[];let c,h,f,b,x,M;for(c=0,h=e.length,x=0;c<h;++c){f=e[c],b=f.box,b.update(f.width||n.w,f.height||n.h,YK(f.horizontal,n));const{same:T,other:I}=WK(n,t,f,r);x|=T&&a.length,M=M||I,b.fullSize||a.push(f)}return x&&eM(a,n,t,r)||M}function pI(e,n,t,r,a){e.top=t,e.left=n,e.right=n+r,e.bottom=t+a,e.width=r,e.height=a}function Lj(e,n,t,r){const a=t.padding;let{x:c,y:h}=n;for(const f of e){const b=f.box,x=r[f.stack]||{count:1,placed:0,weight:1},M=f.stackWeight/x.weight||1;if(f.horizontal){const T=n.w*M,I=x.size||b.height;HC(x.start)&&(h=x.start),b.fullSize?pI(b,a.left,h,t.outerWidth-a.right-a.left,I):pI(b,n.left+x.placed,h,T,I),x.start=h,x.placed+=T,h=b.bottom}else{const T=n.h*M,I=x.size||b.width;HC(x.start)&&(c=x.start),b.fullSize?pI(b,c,a.top,I,t.outerHeight-a.bottom-a.top):pI(b,c,n.top+x.placed,I,T),x.start=c,x.placed+=T,c=b.right}}n.x=c,n.y=h}var Zs={addBox(e,n){e.boxes||(e.boxes=[]),n.fullSize=n.fullSize||!1,n.position=n.position||"top",n.weight=n.weight||0,n._layers=n._layers||function(){return[{z:0,draw(t){n.draw(t)}}]},e.boxes.push(n)},removeBox(e,n){const t=e.boxes?e.boxes.indexOf(n):-1;-1!==t&&e.boxes.splice(t,1)},configure(e,n,t){n.fullSize=t.fullSize,n.position=t.position,n.weight=t.weight},update(e,n,t,r){if(!e)return;const a=Ys(e.options.layout.padding),c=Math.max(n-a.width,0),h=Math.max(t-a.height,0),f=function GK(e){const n=function UK(e){const n=[];let t,r,a,c,h,f;for(t=0,r=(e||[]).length;t<r;++t)a=e[t],({position:c,options:{stack:h,stackWeight:f=1}}=a),n.push({index:t,box:a,pos:c,horizontal:a.isHorizontal(),weight:a.weight,stack:h&&c+h,stackWeight:f});return n}(e),t=tM(n.filter(x=>x.box.fullSize),!0),r=tM(JC(n,"left"),!0),a=tM(JC(n,"right")),c=tM(JC(n,"top"),!0),h=tM(JC(n,"bottom")),f=Pj(n,"x"),b=Pj(n,"y");return{fullSize:t,leftAndTop:r.concat(c),rightAndBottom:a.concat(b).concat(h).concat(f),chartArea:JC(n,"chartArea"),vertical:r.concat(a).concat(b),horizontal:c.concat(h).concat(f)}}(e.boxes),b=f.vertical,x=f.horizontal;ar(e.boxes,V=>{"function"==typeof V.beforeLayout&&V.beforeLayout()});const M=b.reduce((V,$)=>$.box.options&&!1===$.box.options.display?V:V+1,0)||1,T=Object.freeze({outerWidth:n,outerHeight:t,padding:a,availableWidth:c,availableHeight:h,vBoxMaxWidth:c/2/M,hBoxMaxHeight:h/2}),I=Object.assign({},a);Fj(I,Ys(r));const L=Object.assign({maxPadding:I,w:c,h,x:a.left,y:a.top},a),N=function $K(e,n){const t=function HK(e){const n={};for(const t of e){const{stack:r,pos:a,stackWeight:c}=t;if(!r||!Rj.includes(a))continue;const h=n[r]||(n[r]={count:0,placed:0,weight:0,size:0});h.count++,h.weight+=c}return n}(e),{vBoxMaxWidth:r,hBoxMaxHeight:a}=n;let c,h,f;for(c=0,h=e.length;c<h;++c){f=e[c];const{fullSize:b}=f.box,x=t[f.stack],M=x&&f.stackWeight/x.weight;f.horizontal?(f.width=M?M*r:b&&n.availableWidth,f.height=a):(f.width=r,f.height=M?M*a:b&&n.availableHeight)}return t}(b.concat(x),T);eM(f.fullSize,L,T,N),eM(b,L,T,N),eM(x,L,T,N)&&eM(b,L,T,N),function qK(e){const n=e.maxPadding;function t(r){const a=Math.max(n[r]-e[r],0);return e[r]+=a,a}e.y+=t("top"),e.x+=t("left"),t("right"),t("bottom")}(L),Lj(f.leftAndTop,L,T,N),L.x+=L.w,L.y+=L.h,Lj(f.rightAndBottom,L,T,N),e.chartArea={left:L.left,top:L.top,right:L.left+L.w,bottom:L.top+L.h,height:L.h,width:L.w},ar(f.chartArea,V=>{const $=V.box;Object.assign($,e.chartArea),$.update(L.w,L.h,{left:0,top:0,right:0,bottom:0})})}};class Bj{acquireContext(n,t){}releaseContext(n){return!1}addEventListener(n,t,r){}removeEventListener(n,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(n,t,r,a){return t=Math.max(0,t||n.width),r=r||n.height,{width:t,height:Math.max(0,a?Math.floor(t/a):r)}}isAttached(n){return!0}updateConfig(n){}}class ZK extends Bj{acquireContext(n){return n&&n.getContext&&n.getContext("2d")||null}updateConfig(n){n.options.animation=!1}}const fI="$chartjs",XK={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Nj=e=>null===e||""===e,zj=!!XX&&{passive:!0};function JK(e,n,t){e.canvas.removeEventListener(n,t,zj)}function gI(e,n){for(const t of e)if(t===n||t.contains(n))return!0}function eQ(e,n,t){const r=e.canvas,a=new MutationObserver(c=>{let h=!1;for(const f of c)h=h||gI(f.addedNodes,r),h=h&&!gI(f.removedNodes,r);h&&t()});return a.observe(document,{childList:!0,subtree:!0}),a}function iQ(e,n,t){const r=e.canvas,a=new MutationObserver(c=>{let h=!1;for(const f of c)h=h||gI(f.removedNodes,r),h=h&&!gI(f.addedNodes,r);h&&t()});return a.observe(document,{childList:!0,subtree:!0}),a}const iM=new Map;let Vj=0;function jj(){const e=window.devicePixelRatio;e!==Vj&&(Vj=e,iM.forEach((n,t)=>{t.currentDevicePixelRatio!==e&&n()}))}function oQ(e,n,t){const r=e.canvas,a=r&&VB(r);if(!a)return;const c=U5((f,b)=>{const x=a.clientWidth;t(f,b),x<a.clientWidth&&t()},window),h=new ResizeObserver(f=>{const b=f[0],x=b.contentRect.width,M=b.contentRect.height;0===x&&0===M||c(x,M)});return h.observe(a),function nQ(e,n){iM.size||window.addEventListener("resize",jj),iM.set(e,n)}(e,c),h}function YB(e,n,t){t&&t.disconnect(),"resize"===n&&function rQ(e){iM.delete(e),iM.size||window.removeEventListener("resize",jj)}(e)}function sQ(e,n,t){const r=e.canvas,a=U5(c=>{null!==e.ctx&&t(function tQ(e,n){const t=XK[e.type]||e.type,{x:r,y:a}=c_(e,n);return{type:t,chart:n,native:e,x:void 0!==r?r:null,y:void 0!==a?a:null}}(c,e))},e);return function QK(e,n,t){e.addEventListener(n,t,zj)}(r,n,a),a}class aQ extends Bj{acquireContext(n,t){const r=n&&n.getContext&&n.getContext("2d");return r&&r.canvas===n?(function KK(e,n){const t=e.style,r=e.getAttribute("height"),a=e.getAttribute("width");if(e[fI]={initial:{height:r,width:a,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",Nj(a)){const c=lj(e,"width");void 0!==c&&(e.width=c)}if(Nj(r))if(""===e.style.height)e.height=e.width/(n||2);else{const c=lj(e,"height");void 0!==c&&(e.height=c)}}(n,t),r):null}releaseContext(n){const t=n.canvas;if(!t[fI])return!1;const r=t[fI].initial;["height","width"].forEach(c=>{const h=r[c];Vn(h)?t.removeAttribute(c):t.setAttribute(c,h)});const a=r.style||{};return Object.keys(a).forEach(c=>{t.style[c]=a[c]}),t.width=t.width,delete t[fI],!0}addEventListener(n,t,r){this.removeEventListener(n,t),(n.$proxies||(n.$proxies={}))[t]=({attach:eQ,detach:iQ,resize:oQ}[t]||sQ)(n,t,r)}removeEventListener(n,t){const r=n.$proxies||(n.$proxies={}),a=r[t];a&&(({attach:YB,detach:YB,resize:YB}[t]||JK)(n,t,a),r[t]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(n,t,r,a){return function ZX(e,n,t,r){const a=hI(e),c=l_(a,"margin"),h=uI(a.maxWidth,e,"clientWidth")||rI,f=uI(a.maxHeight,e,"clientHeight")||rI,b=function YX(e,n,t){let r,a;if(void 0===n||void 0===t){const c=VB(e);if(c){const h=c.getBoundingClientRect(),f=hI(c),b=l_(f,"border","width"),x=l_(f,"padding");n=h.width-x.width-b.width,t=h.height-x.height-b.height,r=uI(f.maxWidth,c,"clientWidth"),a=uI(f.maxHeight,c,"clientHeight")}else n=e.clientWidth,t=e.clientHeight}return{width:n,height:t,maxWidth:r||rI,maxHeight:a||rI}}(e,n,t);let{width:x,height:M}=b;if("content-box"===a.boxSizing){const I=l_(a,"border","width"),L=l_(a,"padding");x-=L.width+I.width,M-=L.height+I.height}return x=Math.max(0,x-c.width),M=Math.max(0,r?x/r:M-c.height),x=mI(Math.min(x,h,b.maxWidth)),M=mI(Math.min(M,f,b.maxHeight)),x&&!M&&(M=mI(x/2)),(void 0!==n||void 0!==t)&&r&&b.height&&M>b.height&&(M=b.height,x=mI(Math.floor(M*r))),{width:x,height:M}}(n,t,r,a)}isAttached(n){const t=VB(n);return!(!t||!t.isConnected)}}class Ch{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(n){const{x:t,y:r}=this.getProps(["x","y"],n);return{x:t,y:r}}hasValue(){return Dv(this.x)&&Dv(this.y)}getProps(n,t){const r=this.$animations;if(!t||!r)return this;const a={};return n.forEach(c=>{a[c]=r[c]&&r[c].active()?r[c]._to:this[c]}),a}}function _I(e,n,t,r,a){const c=cn(r,0),h=Math.min(cn(a,e.length),e.length);let b,x,M,f=0;for(t=Math.ceil(t),a&&(b=a-r,t=b/Math.floor(b/t)),M=c;M<0;)f++,M=Math.round(c+f*t);for(x=Math.max(c,0);x<h;x++)x===M&&(n.push(e[x]),f++,M=Math.round(c+f*t))}const Uj=(e,n,t)=>"top"===n||"left"===n?e[n]+t:e[n]-t,Hj=(e,n)=>Math.min(n||e,e);function $j(e,n){const t=[],r=e.length/n,a=e.length;let c=0;for(;c<a;c+=r)t.push(e[Math.floor(c)]);return t}function gQ(e,n,t){const r=e.ticks.length,a=Math.min(n,r-1),c=e._startPixel,h=e._endPixel,f=1e-6;let x,b=e.getPixelForTick(a);if(!(t&&(x=1===r?Math.max(b-c,h-b):0===n?(e.getPixelForTick(1)-b)/2:(b-e.getPixelForTick(a-1))/2,b+=a<n?x:-x,b<c-f||b>h+f)))return b}function nM(e){return e.drawTicks?e.tickLength:0}function Gj(e,n){if(!e.display)return 0;const t=Uo(e.font,n),r=Ys(e.padding);return(Fr(e.text)?e.text.length:1)*t.lineHeight+r.height}function vQ(e,n,t){let r=EB(e);return(t&&"right"!==n||!t&&"right"===n)&&(r=(e=>"left"===e?"right":"right"===e?"left":e)(r)),r}class h_ extends Ch{constructor(n){super(),this.id=n.id,this.type=n.type,this.options=void 0,this.ctx=n.ctx,this.chart=n.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(n){this.options=n.setContext(this.getContext()),this.axis=n.axis,this._userMin=this.parse(n.min),this._userMax=this.parse(n.max),this._suggestedMin=this.parse(n.suggestedMin),this._suggestedMax=this.parse(n.suggestedMax)}parse(n,t){return n}getUserBounds(){let{_userMin:n,_userMax:t,_suggestedMin:r,_suggestedMax:a}=this;return n=bl(n,Number.POSITIVE_INFINITY),t=bl(t,Number.NEGATIVE_INFINITY),r=bl(r,Number.POSITIVE_INFINITY),a=bl(a,Number.NEGATIVE_INFINITY),{min:bl(n,r),max:bl(t,a),minDefined:uo(n),maxDefined:uo(t)}}getMinMax(n){let h,{min:t,max:r,minDefined:a,maxDefined:c}=this.getUserBounds();if(a&&c)return{min:t,max:r};const f=this.getMatchingVisibleMetas();for(let b=0,x=f.length;b<x;++b)h=f[b].controller.getMinMax(this,n),a||(t=Math.min(t,h.min)),c||(r=Math.max(r,h.max));return t=c&&t>r?r:t,r=a&&t>r?t:r,{min:bl(t,bl(r,t)),max:bl(r,bl(t,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const n=this.chart.data;return this.options.labels||(this.isHorizontal()?n.xLabels:n.yLabels)||n.labels||[]}getLabelItems(n=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(n))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Sr(this.options.beforeUpdate,[this])}update(n,t,r){const{beginAtZero:a,grace:c,ticks:h}=this.options,f=h.sampleSize;this.beforeUpdate(),this.maxWidth=n,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function SX(e,n,t){const{min:r,max:a}=e,c=E5(n,(a-r)/2),h=(f,b)=>t&&0===f?0:f+b;return{min:h(r,-Math.abs(c)),max:h(a,c)}}(this,c,a),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const b=f<this.ticks.length;this._convertTicksToLabels(b?$j(this.ticks,f):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),h.display&&(h.autoSkip||"auto"===h.source)&&(this.ticks=function cQ(e,n){const t=e.options.ticks,r=function dQ(e){const n=e.options.offset,t=e._tickSize();return Math.floor(Math.min(e._length/t+(n?0:1),e._maxLength/t))}(e),a=Math.min(t.maxTicksLimit||r,r),c=t.major.enabled?function hQ(e){const n=[];let t,r;for(t=0,r=e.length;t<r;t++)e[t].major&&n.push(t);return n}(n):[],h=c.length,f=c[0],b=c[h-1],x=[];if(h>a)return function mQ(e,n,t,r){let h,a=0,c=t[0];for(r=Math.ceil(r),h=0;h<e.length;h++)h===c&&(n.push(e[h]),a++,c=t[a*r])}(n,x,c,h/a),x;const M=function uQ(e,n,t){const r=function pQ(e){const n=e.length;let t,r;if(n<2)return!1;for(r=e[0],t=1;t<n;++t)if(e[t]-e[t-1]!==r)return!1;return r}(e),a=n.length/t;if(!r)return Math.max(a,1);const c=function JZ(e){const n=[],t=Math.sqrt(e);let r;for(r=1;r<t;r++)e%r==0&&(n.push(r),n.push(e/r));return t===(0|t)&&n.push(t),n.sort((a,c)=>a-c).pop(),n}(r);for(let h=0,f=c.length-1;h<f;h++){const b=c[h];if(b>a)return b}return Math.max(a,1)}(c,n,a);if(h>0){let T,I;const L=h>1?Math.round((b-f)/(h-1)):null;for(_I(n,x,M,Vn(L)?0:f-L,f),T=0,I=h-1;T<I;T++)_I(n,x,M,c[T],c[T+1]);return _I(n,x,M,b,Vn(L)?n.length:b+L),x}return _I(n,x,M),x}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),b&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,r,n=this.options.reverse;this.isHorizontal()?(t=this.left,r=this.right):(t=this.top,r=this.bottom,n=!n),this._startPixel=t,this._endPixel=r,this._reversePixels=n,this._length=r-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Sr(this.options.afterUpdate,[this])}beforeSetDimensions(){Sr(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Sr(this.options.afterSetDimensions,[this])}_callHooks(n){this.chart.notifyPlugins(n,this.getContext()),Sr(this.options[n],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Sr(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(n){const t=this.options.ticks;let r,a,c;for(r=0,a=n.length;r<a;r++)c=n[r],c.label=Sr(t.callback,[c.value,r,n],this)}afterTickToLabelConversion(){Sr(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Sr(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const n=this.options,t=n.ticks,r=Hj(this.ticks.length,n.ticks.maxTicksLimit),a=t.minRotation||0,c=t.maxRotation;let f,b,x,h=a;if(!this._isVisible()||!t.display||a>=c||r<=1||!this.isHorizontal())return void(this.labelRotation=a);const M=this._getLabelSizes(),T=M.widest.width,I=M.highest.height,L=Qo(this.chart.width-T,0,this.maxWidth);f=n.offset?this.maxWidth/r:L/(r-1),T+6>f&&(f=L/(r-(n.offset?.5:1)),b=this.maxHeight-nM(n.grid)-t.padding-Gj(n.title,this.chart.options.font),x=Math.sqrt(T*T+I*I),h=kB(Math.min(Math.asin(Qo((M.highest.height+6)/f,-1,1)),Math.asin(Qo(b/x,-1,1))-Math.asin(Qo(I/x,-1,1)))),h=Math.max(a,Math.min(c,h))),this.labelRotation=h}afterCalculateLabelRotation(){Sr(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Sr(this.options.beforeFit,[this])}fit(){const n={width:0,height:0},{chart:t,options:{ticks:r,title:a,grid:c}}=this,h=this._isVisible(),f=this.isHorizontal();if(h){const b=Gj(a,t.options.font);if(f?(n.width=this.maxWidth,n.height=nM(c)+b):(n.height=this.maxHeight,n.width=nM(c)+b),r.display&&this.ticks.length){const{first:x,last:M,widest:T,highest:I}=this._getLabelSizes(),L=2*r.padding,N=Yc(this.labelRotation),V=Math.cos(N),$=Math.sin(N);f?n.height=Math.min(this.maxHeight,n.height+(r.mirror?0:$*T.width+V*I.height)+L):n.width=Math.min(this.maxWidth,n.width+(r.mirror?0:V*T.width+$*I.height)+L),this._calculatePadding(x,M,$,V)}}this._handleMargins(),f?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=n.height):(this.width=n.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(n,t,r,a){const{ticks:{align:c,padding:h},position:f}=this.options,b=0!==this.labelRotation,x="top"!==f&&"x"===this.axis;if(this.isHorizontal()){const M=this.getPixelForTick(0)-this.left,T=this.right-this.getPixelForTick(this.ticks.length-1);let I=0,L=0;b?x?(I=a*n.width,L=r*t.height):(I=r*n.height,L=a*t.width):"start"===c?L=t.width:"end"===c?I=n.width:"inner"!==c&&(I=n.width/2,L=t.width/2),this.paddingLeft=Math.max((I-M+h)*this.width/(this.width-M),0),this.paddingRight=Math.max((L-T+h)*this.width/(this.width-T),0)}else{let M=t.height/2,T=n.height/2;"start"===c?(M=0,T=n.height):"end"===c&&(M=t.height,T=0),this.paddingTop=M+h,this.paddingBottom=T+h}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Sr(this.options.afterFit,[this])}isHorizontal(){const{axis:n,position:t}=this.options;return"top"===t||"bottom"===t||"x"===n}isFullSize(){return this.options.fullSize}_convertTicksToLabels(n){let t,r;for(this.beforeTickToLabelConversion(),this.generateTickLabels(n),t=0,r=n.length;t<r;t++)Vn(n[t].label)&&(n.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let n=this._labelSizes;if(!n){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=$j(r,t)),this._labelSizes=n=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return n}_computeLabelSizes(n,t,r){const{ctx:a,_longestTextCache:c}=this,h=[],f=[],b=Math.floor(t/Hj(t,r));let T,I,L,N,V,$,nt,tt,_t,wt,Dt,x=0,M=0;for(T=0;T<t;T+=b){if(N=n[T].label,V=this._resolveTickFontOptions(T),a.font=$=V.string,nt=c[$]=c[$]||{data:{},gc:[]},tt=V.lineHeight,_t=wt=0,Vn(N)||Fr(N)){if(Fr(N))for(I=0,L=N.length;I<L;++I)Dt=N[I],!Vn(Dt)&&!Fr(Dt)&&(_t=aI(a,nt.data,nt.gc,_t,Dt),wt+=tt)}else _t=aI(a,nt.data,nt.gc,_t,N),wt=tt;h.push(_t),f.push(wt),x=Math.max(_t,x),M=Math.max(wt,M)}!function _Q(e,n){ar(e,t=>{const r=t.gc,a=r.length/2;let c;if(a>n){for(c=0;c<a;++c)delete t.data[r[c]];r.splice(0,a)}})}(c,t);const Vt=h.indexOf(x),ae=f.indexOf(M),ee=Fe=>({width:h[Fe]||0,height:f[Fe]||0});return{first:ee(0),last:ee(t-1),widest:ee(Vt),highest:ee(ae),widths:h,heights:f}}getLabelForValue(n){return n}getPixelForValue(n,t){return NaN}getValueForPixel(n){}getPixelForTick(n){const t=this.ticks;return n<0||n>t.length-1?null:this.getPixelForValue(t[n].value)}getPixelForDecimal(n){this._reversePixels&&(n=1-n);const t=this._startPixel+n*this._length;return function iX(e){return Qo(e,-32768,32767)}(this._alignToPixels?o_(this.chart,t,0):t)}getDecimalForPixel(n){const t=(n-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:n,max:t}=this;return n<0&&t<0?t:n>0&&t>0?n:0}getContext(n){const t=this.ticks||[];if(n>=0&&n<t.length){const r=t[n];return r.$context||(r.$context=function yQ(e,n,t){return Rp(e,{tick:t,index:n,type:"tick"})}(this.getContext(),n,r))}return this.$context||(this.$context=function bQ(e,n){return Rp(e,{scale:n,type:"scale"})}(this.chart.getContext(),this))}_tickSize(){const n=this.options.ticks,t=Yc(this.labelRotation),r=Math.abs(Math.cos(t)),a=Math.abs(Math.sin(t)),c=this._getLabelSizes(),h=n.autoSkipPadding||0,f=c?c.widest.width+h:0,b=c?c.highest.height+h:0;return this.isHorizontal()?b*r>f*a?f/r:b/a:b*a<f*r?b/r:f/a}_isVisible(){const n=this.options.display;return"auto"!==n?!!n:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(n){const t=this.axis,r=this.chart,a=this.options,{grid:c,position:h,border:f}=a,b=c.offset,x=this.isHorizontal(),T=this.ticks.length+(b?1:0),I=nM(c),L=[],N=f.setContext(this.getContext()),V=N.display?N.width:0,$=V/2,nt=function(xe){return o_(r,xe,V)};let tt,_t,wt,Dt,Vt,ae,ee,Fe,Ai,Wi,dn,zr;if("top"===h)tt=nt(this.bottom),ae=this.bottom-I,Fe=tt-$,Wi=nt(n.top)+$,zr=n.bottom;else if("bottom"===h)tt=nt(this.top),Wi=n.top,zr=nt(n.bottom)-$,ae=tt+$,Fe=this.top+I;else if("left"===h)tt=nt(this.right),Vt=this.right-I,ee=tt-$,Ai=nt(n.left)+$,dn=n.right;else if("right"===h)tt=nt(this.left),Ai=n.left,dn=nt(n.right)-$,Vt=tt+$,ee=this.left+I;else if("x"===t){if("center"===h)tt=nt((n.top+n.bottom)/2+.5);else if(Sn(h)){const xe=Object.keys(h)[0];tt=nt(this.chart.scales[xe].getPixelForValue(h[xe]))}Wi=n.top,zr=n.bottom,ae=tt+$,Fe=ae+I}else if("y"===t){if("center"===h)tt=nt((n.left+n.right)/2);else if(Sn(h)){const xe=Object.keys(h)[0];tt=nt(this.chart.scales[xe].getPixelForValue(h[xe]))}Vt=tt-$,ee=Vt-I,Ai=n.left,dn=n.right}const Ks=cn(a.ticks.maxTicksLimit,T),Qn=Math.max(1,Math.ceil(T/Ks));for(_t=0;_t<T;_t+=Qn){const xe=this.getContext(_t),Pe=c.setContext(xe),si=f.setContext(xe),Li=Pe.lineWidth,Vr=Pe.color,ya=si.dash||[],Oo=si.dashOffset,za=Pe.tickWidth,Jn=Pe.tickColor,Xp=Pe.tickBorderDash||[],Lh=Pe.tickBorderDashOffset;wt=gQ(this,_t,b),void 0!==wt&&(Dt=o_(r,wt,Li),x?Vt=ee=Ai=dn=Dt:ae=Fe=Wi=zr=Dt,L.push({tx1:Vt,ty1:ae,tx2:ee,ty2:Fe,x1:Ai,y1:Wi,x2:dn,y2:zr,width:Li,color:Vr,borderDash:ya,borderDashOffset:Oo,tickWidth:za,tickColor:Jn,tickBorderDash:Xp,tickBorderDashOffset:Lh}))}return this._ticksLength=T,this._borderValue=tt,L}_computeLabelItems(n){const t=this.axis,r=this.options,{position:a,ticks:c}=r,h=this.isHorizontal(),f=this.ticks,{align:b,crossAlign:x,padding:M,mirror:T}=c,I=nM(r.grid),L=I+M,N=T?-M:L,V=-Yc(this.labelRotation),$=[];let nt,tt,_t,wt,Dt,Vt,ae,ee,Fe,Ai,Wi,dn,zr="middle";if("top"===a)Vt=this.bottom-N,ae=this._getXAxisLabelAlignment();else if("bottom"===a)Vt=this.top+N,ae=this._getXAxisLabelAlignment();else if("left"===a){const Qn=this._getYAxisLabelAlignment(I);ae=Qn.textAlign,Dt=Qn.x}else if("right"===a){const Qn=this._getYAxisLabelAlignment(I);ae=Qn.textAlign,Dt=Qn.x}else if("x"===t){if("center"===a)Vt=(n.top+n.bottom)/2+L;else if(Sn(a)){const Qn=Object.keys(a)[0];Vt=this.chart.scales[Qn].getPixelForValue(a[Qn])+L}ae=this._getXAxisLabelAlignment()}else if("y"===t){if("center"===a)Dt=(n.left+n.right)/2-L;else if(Sn(a)){const Qn=Object.keys(a)[0];Dt=this.chart.scales[Qn].getPixelForValue(a[Qn])}ae=this._getYAxisLabelAlignment(I).textAlign}"y"===t&&("start"===b?zr="top":"end"===b&&(zr="bottom"));const Ks=this._getLabelSizes();for(nt=0,tt=f.length;nt<tt;++nt){_t=f[nt],wt=_t.label;const Qn=c.setContext(this.getContext(nt));ee=this.getPixelForTick(nt)+c.labelOffset,Fe=this._resolveTickFontOptions(nt),Ai=Fe.lineHeight,Wi=Fr(wt)?wt.length:1;const xe=Wi/2,Pe=Qn.color,si=Qn.textStrokeColor,Li=Qn.textStrokeWidth;let ya,Vr=ae;if(h?(Dt=ee,"inner"===ae&&(Vr=nt===tt-1?this.options.reverse?"left":"right":0===nt?this.options.reverse?"right":"left":"center"),dn="top"===a?"near"===x||0!==V?-Wi*Ai+Ai/2:"center"===x?-Ks.highest.height/2-xe*Ai+Ai:Ai/2-Ks.highest.height:"near"===x||0!==V?Ai/2:"center"===x?Ks.highest.height/2-xe*Ai:Ks.highest.height-Wi*Ai,T&&(dn*=-1),0!==V&&!Qn.showLabelBackdrop&&(Dt+=Ai/2*Math.sin(V))):(Vt=ee,dn=(1-Wi)*Ai/2),Qn.showLabelBackdrop){const Oo=Ys(Qn.backdropPadding),za=Ks.heights[nt],Jn=Ks.widths[nt];let Xp=dn-Oo.top,Lh=0-Oo.left;switch(zr){case"middle":Xp-=za/2;break;case"bottom":Xp-=za}switch(ae){case"center":Lh-=Jn/2;break;case"right":Lh-=Jn;break;case"inner":nt===tt-1?Lh-=Jn:nt>0&&(Lh-=Jn/2)}ya={left:Lh,top:Xp,width:Jn+Oo.width,height:za+Oo.height,color:Qn.backdropColor}}$.push({label:wt,font:Fe,textOffset:dn,options:{rotation:V,color:Pe,strokeColor:si,strokeWidth:Li,textAlign:Vr,textBaseline:zr,translation:[Dt,Vt],backdrop:ya}})}return $}_getXAxisLabelAlignment(){const{position:n,ticks:t}=this.options;if(-Yc(this.labelRotation))return"top"===n?"left":"right";let a="center";return"start"===t.align?a="left":"end"===t.align?a="right":"inner"===t.align&&(a="inner"),a}_getYAxisLabelAlignment(n){const{position:t,ticks:{crossAlign:r,mirror:a,padding:c}}=this.options,f=n+c,b=this._getLabelSizes().widest.width;let x,M;return"left"===t?a?(M=this.right+c,"near"===r?x="left":"center"===r?(x="center",M+=b/2):(x="right",M+=b)):(M=this.right-f,"near"===r?x="right":"center"===r?(x="center",M-=b/2):(x="left",M=this.left)):"right"===t?a?(M=this.left+c,"near"===r?x="right":"center"===r?(x="center",M-=b/2):(x="left",M-=b)):(M=this.left+f,"near"===r?x="left":"center"===r?(x="center",M+=b/2):(x="right",M=this.right)):x="right",{textAlign:x,x:M}}_computeLabelArea(){if(this.options.ticks.mirror)return;const n=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:n.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:n.width}:void 0}drawBackground(){const{ctx:n,options:{backgroundColor:t},left:r,top:a,width:c,height:h}=this;t&&(n.save(),n.fillStyle=t,n.fillRect(r,a,c,h),n.restore())}getLineWidthForValue(n){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const a=this.ticks.findIndex(c=>c.value===n);return a>=0?t.setContext(this.getContext(a)).lineWidth:0}drawGrid(n){const t=this.options.grid,r=this.ctx,a=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(n));let c,h;const f=(b,x,M)=>{!M.width||!M.color||(r.save(),r.lineWidth=M.width,r.strokeStyle=M.color,r.setLineDash(M.borderDash||[]),r.lineDashOffset=M.borderDashOffset,r.beginPath(),r.moveTo(b.x,b.y),r.lineTo(x.x,x.y),r.stroke(),r.restore())};if(t.display)for(c=0,h=a.length;c<h;++c){const b=a[c];t.drawOnChartArea&&f({x:b.x1,y:b.y1},{x:b.x2,y:b.y2},b),t.drawTicks&&f({x:b.tx1,y:b.ty1},{x:b.tx2,y:b.ty2},{color:b.tickColor,width:b.tickWidth,borderDash:b.tickBorderDash,borderDashOffset:b.tickBorderDashOffset})}}drawBorder(){const{chart:n,ctx:t,options:{border:r,grid:a}}=this,c=r.setContext(this.getContext()),h=r.display?c.width:0;if(!h)return;const f=a.setContext(this.getContext(0)).lineWidth,b=this._borderValue;let x,M,T,I;this.isHorizontal()?(x=o_(n,this.left,h)-h/2,M=o_(n,this.right,f)+f/2,T=I=b):(T=o_(n,this.top,h)-h/2,I=o_(n,this.bottom,f)+f/2,x=M=b),t.save(),t.lineWidth=c.width,t.strokeStyle=c.color,t.beginPath(),t.moveTo(x,T),t.lineTo(M,I),t.stroke(),t.restore()}drawLabels(n){if(!this.options.ticks.display)return;const r=this.ctx,a=this._computeLabelArea();a&&lI(r,a);const c=this.getLabelItems(n);for(const h of c)s_(r,h.label,0,h.textOffset,h.font,h.options);a&&cI(r)}drawTitle(){const{ctx:n,options:{position:t,title:r,reverse:a}}=this;if(!r.display)return;const c=Uo(r.font),h=Ys(r.padding),f=r.align;let b=c.lineHeight/2;"bottom"===t||"center"===t||Sn(t)?(b+=h.bottom,Fr(r.text)&&(b+=c.lineHeight*(r.text.length-1))):b+=h.top;const{titleX:x,titleY:M,maxWidth:T,rotation:I}=function xQ(e,n,t,r){const{top:a,left:c,bottom:h,right:f,chart:b}=e,{chartArea:x,scales:M}=b;let I,L,N,T=0;const V=h-a,$=f-c;if(e.isHorizontal()){if(L=qs(r,c,f),Sn(t)){const nt=Object.keys(t)[0];N=M[nt].getPixelForValue(t[nt])+V-n}else N="center"===t?(x.bottom+x.top)/2+V-n:Uj(e,t,n);I=f-c}else{if(Sn(t)){const nt=Object.keys(t)[0];L=M[nt].getPixelForValue(t[nt])-$+n}else L="center"===t?(x.left+x.right)/2-$+n:Uj(e,t,n);N=qs(r,h,a),T="left"===t?-Mo:Mo}return{titleX:L,titleY:N,maxWidth:I,rotation:T}}(this,b,t,f);s_(n,r.text,0,0,c,{color:r.color,maxWidth:T,rotation:I,textAlign:vQ(f,t,a),textBaseline:"middle",translation:[x,M]})}draw(n){this._isVisible()&&(this.drawBackground(),this.drawGrid(n),this.drawBorder(),this.drawTitle(),this.drawLabels(n))}_layers(){const n=this.options,t=n.ticks&&n.ticks.z||0,r=cn(n.grid&&n.grid.z,-1),a=cn(n.border&&n.border.z,0);return this._isVisible()&&this.draw===h_.prototype.draw?[{z:r,draw:c=>{this.drawBackground(),this.drawGrid(c),this.drawTitle()}},{z:a,draw:()=>{this.drawBorder()}},{z:t,draw:c=>{this.drawLabels(c)}}]:[{z:t,draw:c=>{this.draw(c)}}]}getMatchingVisibleMetas(n){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",a=[];let c,h;for(c=0,h=t.length;c<h;++c){const f=t[c];f[r]===this.id&&(!n||f.type===n)&&a.push(f)}return a}_resolveTickFontOptions(n){return Uo(this.options.ticks.setContext(this.getContext(n)).font)}_maxDigits(){const n=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/n}}class bI{constructor(n,t,r){this.type=n,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(n){return Object.prototype.isPrototypeOf.call(this.type.prototype,n.prototype)}register(n){const t=Object.getPrototypeOf(n);let r;(function MQ(e){return"id"in e&&"defaults"in e})(t)&&(r=this.register(t));const a=this.items,c=n.id,h=this.scope+"."+c;if(!c)throw new Error("class does not have id: "+n);return c in a||(a[c]=n,function wQ(e,n,t){const r=jC(Object.create(null),[t?to.get(t):{},to.get(n),e.defaults]);to.set(n,r),e.defaultRoutes&&function CQ(e,n){Object.keys(n).forEach(t=>{const r=t.split("."),a=r.pop(),c=[e].concat(r).join("."),h=n[t].split("."),f=h.pop(),b=h.join(".");to.route(c,a,b,f)})}(n,e.defaultRoutes),e.descriptors&&to.describe(n,e.descriptors)}(n,h,r),this.override&&to.override(n.id,n.overrides)),h}get(n){return this.items[n]}unregister(n){const t=this.items,r=n.id,a=this.scope;r in t&&delete t[r],a&&r in to[a]&&(delete to[a][r],this.override&&delete r_[r])}}class DQ{constructor(){this.controllers=new bI(Pp,"datasets",!0),this.elements=new bI(Ch,"elements"),this.plugins=new bI(Object,"plugins"),this.scales=new bI(h_,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...n){this._each("register",n)}remove(...n){this._each("unregister",n)}addControllers(...n){this._each("register",n,this.controllers)}addElements(...n){this._each("register",n,this.elements)}addPlugins(...n){this._each("register",n,this.plugins)}addScales(...n){this._each("register",n,this.scales)}getController(n){return this._get(n,this.controllers,"controller")}getElement(n){return this._get(n,this.elements,"element")}getPlugin(n){return this._get(n,this.plugins,"plugin")}getScale(n){return this._get(n,this.scales,"scale")}removeControllers(...n){this._each("unregister",n,this.controllers)}removeElements(...n){this._each("unregister",n,this.elements)}removePlugins(...n){this._each("unregister",n,this.plugins)}removeScales(...n){this._each("unregister",n,this.scales)}_each(n,t,r){[...t].forEach(a=>{const c=r||this._getRegistryForType(a);r||c.isForType(a)||c===this.plugins&&a.id?this._exec(n,c,a):ar(a,h=>{const f=r||this._getRegistryForType(h);this._exec(n,f,h)})})}_exec(n,t,r){const a=DB(n);Sr(r["before"+a],[],r),t[n](r),Sr(r["after"+a],[],r)}_getRegistryForType(n){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(n))return r}return this.plugins}_get(n,t,r){const a=t.get(n);if(void 0===a)throw new Error('"'+n+'" is not a registered '+r+".");return a}}var Wd=new DQ;class kQ{constructor(){this._init=[]}notify(n,t,r,a){"beforeInit"===t&&(this._init=this._createDescriptors(n,!0),this._notify(this._init,n,"install"));const c=a?this._descriptors(n).filter(a):this._descriptors(n),h=this._notify(c,n,t,r);return"afterDestroy"===t&&(this._notify(c,n,"stop"),this._notify(this._init,n,"uninstall")),h}_notify(n,t,r,a){a=a||{};for(const c of n){const h=c.plugin;if(!1===Sr(h[r],[t,a,c.options],h)&&a.cancelable)return!1}return!0}invalidate(){Vn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(n){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(n);return this._notifyStateChanges(n),t}_createDescriptors(n,t){const r=n&&n.config,a=cn(r.options&&r.options.plugins,{}),c=function SQ(e){const n={},t=[],r=Object.keys(Wd.plugins.items);for(let c=0;c<r.length;c++)t.push(Wd.getPlugin(r[c]));const a=e.plugins||[];for(let c=0;c<a.length;c++){const h=a[c];-1===t.indexOf(h)&&(t.push(h),n[h.id]=!0)}return{plugins:t,localIds:n}}(r);return!1!==a||t?function EQ(e,{plugins:n,localIds:t},r,a){const c=[],h=e.getContext();for(const f of n){const b=f.id,x=TQ(r[b],a);null!==x&&c.push({plugin:f,options:AQ(e.config,{plugin:f,local:t[b]},x,h)})}return c}(n,c,a,t):[]}_notifyStateChanges(n){const t=this._oldCache||[],r=this._cache,a=(c,h)=>c.filter(f=>!h.some(b=>f.plugin.id===b.plugin.id));this._notify(a(t,r),n,"stop"),this._notify(a(r,t),n,"start")}}function TQ(e,n){return n||!1!==e?!0===e?{}:e:null}function AQ(e,{plugin:n,local:t},r,a){const c=e.pluginScopeKeys(n),h=e.getOptionScopes(r,c);return t&&n.defaults&&h.push(n.defaults),e.createResolver(h,a,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ZB(e,n){return((n.datasets||{})[e]||{}).indexAxis||n.indexAxis||(to.datasets[e]||{}).indexAxis||"x"}function Wj(e){if("x"===e||"y"===e||"r"===e)return e}function PQ(e){return"top"===e||"bottom"===e?"x":"left"===e||"right"===e?"y":void 0}function XB(e,...n){if(Wj(e))return e;for(const t of n){const r=t.axis||PQ(t.position)||e.length>1&&Wj(e[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function qj(e,n,t){if(t[n+"AxisID"]===e)return{axis:n}}function Yj(e){const n=e.options||(e.options={});n.plugins=cn(n.plugins,{}),n.scales=function FQ(e,n){const t=r_[e.type]||{scales:{}},r=n.scales||{},a=ZB(e.type,n),c=Object.create(null);return Object.keys(r).forEach(h=>{const f=r[h];if(!Sn(f))return console.error(`Invalid scale configuration for scale: ${h}`);if(f._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${h}`);const b=XB(h,f,function OQ(e,n){if(n.data&&n.data.datasets){const t=n.data.datasets.filter(r=>r.xAxisID===e||r.yAxisID===e);if(t.length)return qj(e,"x",t[0])||qj(e,"y",t[0])}return{}}(h,e),to.scales[f.type]),x=function RQ(e,n){return e===n?"_index_":"_value_"}(b,a),M=t.scales||{};c[h]=UC(Object.create(null),[{axis:b},f,M[b],M[x]])}),e.data.datasets.forEach(h=>{const f=h.type||e.type,b=h.indexAxis||ZB(f,n),M=(r_[f]||{}).scales||{};Object.keys(M).forEach(T=>{const I=function IQ(e,n){let t=e;return"_index_"===e?t=n:"_value_"===e&&(t="x"===n?"y":"x"),t}(T,b),L=h[I+"AxisID"]||I;c[L]=c[L]||Object.create(null),UC(c[L],[{axis:I},r[L],M[T]])})}),Object.keys(c).forEach(h=>{const f=c[h];UC(f,[to.scales[f.type],to.scale])}),c}(e,n)}function Zj(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const Xj=new Map,Kj=new Set;function yI(e,n){let t=Xj.get(e);return t||(t=n(),Xj.set(e,t),Kj.add(t)),t}const rM=(e,n,t)=>{const r=Ep(n,t);void 0!==r&&e.add(r)};class BQ{constructor(n){this._config=function LQ(e){return(e=e||{}).data=Zj(e.data),Yj(e),e}(n),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(n){this._config.type=n}get data(){return this._config.data}set data(n){this._config.data=Zj(n)}get options(){return this._config.options}set options(n){this._config.options=n}get plugins(){return this._config.plugins}update(){const n=this._config;this.clearCache(),Yj(n)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(n){return yI(n,()=>[[`datasets.${n}`,""]])}datasetAnimationScopeKeys(n,t){return yI(`${n}.transition.${t}`,()=>[[`datasets.${n}.transitions.${t}`,`transitions.${t}`],[`datasets.${n}`,""]])}datasetElementScopeKeys(n,t){return yI(`${n}-${t}`,()=>[[`datasets.${n}.elements.${t}`,`datasets.${n}`,`elements.${t}`,""]])}pluginScopeKeys(n){const t=n.id;return yI(`${this.type}-plugin-${t}`,()=>[[`plugins.${t}`,...n.additionalOptionScopes||[]]])}_cachedScopes(n,t){const r=this._scopeCache;let a=r.get(n);return(!a||t)&&(a=new Map,r.set(n,a)),a}getOptionScopes(n,t,r){const{options:a,type:c}=this,h=this._cachedScopes(n,r),f=h.get(t);if(f)return f;const b=new Set;t.forEach(M=>{n&&(b.add(n),M.forEach(T=>rM(b,n,T))),M.forEach(T=>rM(b,a,T)),M.forEach(T=>rM(b,r_[c]||{},T)),M.forEach(T=>rM(b,to,T)),M.forEach(T=>rM(b,RB,T))});const x=Array.from(b);return 0===x.length&&x.push(Object.create(null)),Kj.has(t)&&h.set(t,x),x}chartOptionScopes(){const{options:n,type:t}=this;return[n,r_[t]||{},to.datasets[t]||{},{type:t},to,RB]}resolveNamedOptions(n,t,r,a=[""]){const c={$shared:!0},{resolver:h,subPrefixes:f}=Qj(this._resolverCache,n,a);let b=h;(function zQ(e,n){const{isScriptable:t,isIndexable:r}=J5(e);for(const a of n){const c=t(a),h=r(a),f=(h||c)&&e[a];if(c&&(Ap(f)||NQ(f))||h&&Fr(f))return!0}return!1})(h,t)&&(c.$shared=!1,b=kv(h,r=Ap(r)?r():r,this.createResolver(n,r,f)));for(const x of t)c[x]=b[x];return c}createResolver(n,t,r=[""],a){const{resolver:c}=Qj(this._resolverCache,n,r);return Sn(t)?kv(c,t,void 0,a):c}}function Qj(e,n,t){let r=e.get(n);r||(r=new Map,e.set(n,r));const a=t.join();let c=r.get(a);return c||(c={resolver:LB(n,t),subPrefixes:t.filter(f=>!f.toLowerCase().includes("hover"))},r.set(a,c)),c}const NQ=e=>Sn(e)&&Object.getOwnPropertyNames(e).some(n=>Ap(e[n])),jQ=["top","bottom","left","right","chartArea"];function Jj(e,n){return"top"===e||"bottom"===e||-1===jQ.indexOf(e)&&"x"===n}function tU(e,n){return function(t,r){return t[e]===r[e]?t[n]-r[n]:t[e]-r[e]}}function eU(e){const n=e.chart,t=n.options.animation;n.notifyPlugins("afterRender"),Sr(t&&t.onComplete,[e],n)}function UQ(e){const n=e.chart,t=n.options.animation;Sr(t&&t.onProgress,[e],n)}function iU(e){return zB()&&"string"==typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const vI={},nU=e=>{const n=iU(e);return Object.values(vI).filter(t=>t.canvas===n).pop()};function HQ(e,n,t){const r=Object.keys(e);for(const a of r){const c=+a;if(c>=n){const h=e[a];delete e[a],(t>0||c>n)&&(e[c+t]=h)}}}function xI(e,n,t){return e.options.clip?e[t]:n[t]}let wI=(()=>class e{static defaults=to;static instances=vI;static overrides=r_;static registry=Wd;static version="4.4.1";static getChart=nU;static register(...t){Wd.add(...t),rU()}static unregister(...t){Wd.remove(...t),rU()}constructor(t,r){const a=this.config=new BQ(r),c=iU(t),h=nU(c);if(h)throw new Error("Canvas is already in use. Chart with ID '"+h.id+"' must be destroyed before the canvas with ID '"+h.canvas.id+"' can be reused.");const f=a.createResolver(a.chartOptionScopes(),this.getContext());this.platform=new(a.platform||function lQ(e){return!zB()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?ZK:aQ}(c)),this.platform.updateConfig(a);const b=this.platform.acquireContext(c,f.aspectRatio),x=b&&b.canvas,M=x&&x.height,T=x&&x.width;this.id=$Z(),this.ctx=b,this.canvas=x,this.width=T,this.height=M,this._options=f,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new kQ,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function sX(e,n){let t;return function(...r){return n?(clearTimeout(t),t=setTimeout(e,n,r)):e.apply(this,r),n}}(I=>this.update(I),f.resizeDelay||0),this._dataChanges=[],vI[this.id]=this,b&&x?(wh.listen(this,"complete",eU),wh.listen(this,"progress",UQ),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:r},width:a,height:c,_aspectRatio:h}=this;return Vn(t)?r&&h?h:c?a/c:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Wd}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():aj(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return X5(this.canvas,this.ctx),this}stop(){return wh.stop(this),this}resize(t,r){wh.running(this)?this._resizeBeforeDraw={width:t,height:r}:this._resize(t,r)}_resize(t,r){const a=this.options,f=this.platform.getMaximumSize(this.canvas,t,r,a.maintainAspectRatio&&this.aspectRatio),b=a.devicePixelRatio||this.platform.getDevicePixelRatio(),x=this.width?"resize":"attach";this.width=f.width,this.height=f.height,this._aspectRatio=this.aspectRatio,aj(this,b,!0)&&(this.notifyPlugins("resize",{size:f}),Sr(a.onResize,[this,f],this),this.attached&&this._doResize(x)&&this.render())}ensureScalesHaveIDs(){ar(this.options.scales||{},(a,c)=>{a.id=c})}buildOrUpdateScales(){const t=this.options,r=t.scales,a=this.scales,c=Object.keys(a).reduce((f,b)=>(f[b]=!1,f),{});let h=[];r&&(h=h.concat(Object.keys(r).map(f=>{const b=r[f],x=XB(f,b),M="r"===x,T="x"===x;return{options:b,dposition:M?"chartArea":T?"bottom":"left",dtype:M?"radialLinear":T?"category":"linear"}}))),ar(h,f=>{const b=f.options,x=b.id,M=XB(x,b),T=cn(b.type,f.dtype);(void 0===b.position||Jj(b.position,M)!==Jj(f.dposition))&&(b.position=f.dposition),c[x]=!0;let I=null;x in a&&a[x].type===T?I=a[x]:(I=new(Wd.getScale(T))({id:x,type:T,ctx:this.ctx,chart:this}),a[I.id]=I),I.init(b,t)}),ar(c,(f,b)=>{f||delete a[b]}),ar(a,f=>{Zs.configure(this,f,f.options),Zs.addBox(this,f)})}_updateMetasets(){const t=this._metasets,r=this.data.datasets.length,a=t.length;if(t.sort((c,h)=>c.index-h.index),a>r){for(let c=r;c<a;++c)this._destroyDatasetMeta(c);t.splice(r,a-r)}this._sortedMetasets=t.slice(0).sort(tU("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:r}}=this;t.length>r.length&&delete this._stacks,t.forEach((a,c)=>{0===r.filter(h=>h===a._dataset).length&&this._destroyDatasetMeta(c)})}buildOrUpdateControllers(){const t=[],r=this.data.datasets;let a,c;for(this._removeUnreferencedMetasets(),a=0,c=r.length;a<c;a++){const h=r[a];let f=this.getDatasetMeta(a);const b=h.type||this.config.type;if(f.type&&f.type!==b&&(this._destroyDatasetMeta(a),f=this.getDatasetMeta(a)),f.type=b,f.indexAxis=h.indexAxis||ZB(b,this.options),f.order=h.order||0,f.index=a,f.label=""+h.label,f.visible=this.isDatasetVisible(a),f.controller)f.controller.updateIndex(a),f.controller.linkScales();else{const x=Wd.getController(b),{datasetElementType:M,dataElementType:T}=to.datasets[b];Object.assign(x,{dataElementType:Wd.getElement(T),datasetElementType:M&&Wd.getElement(M)}),f.controller=new x(this,a),t.push(f.controller)}}return this._updateMetasets(),t}_resetElements(){ar(this.data.datasets,(t,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const r=this.config;r.update();const a=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),c=this._animationsDisabled=!a.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const h=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let f=0;for(let M=0,T=this.data.datasets.length;M<T;M++){const{controller:I}=this.getDatasetMeta(M),L=!c&&-1===h.indexOf(I);I.buildOrUpdateElements(L),f=Math.max(+I.getMaxOverflow(),f)}f=this._minPadding=a.layout.autoPadding?f:0,this._updateLayout(f),c||ar(h,M=>{M.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(tU("z","_idx"));const{_active:b,_lastEvent:x}=this;x?this._eventHandler(x,!0):b.length&&this._updateHoverStyles(b,b,!0),this.render()}_updateScales(){ar(this.scales,t=>{Zs.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,r=new Set(Object.keys(this._listeners)),a=new Set(t.events);(!R5(r,a)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,r=this._getUniformDataChanges()||[];for(const{method:a,start:c,count:h}of r)HQ(t,c,"_removeElements"===a?-h:h)}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const r=this.data.datasets.length,a=h=>new Set(t.filter(f=>f[0]===h).map((f,b)=>b+","+f.splice(1).join(","))),c=a(0);for(let h=1;h<r;h++)if(!R5(c,a(h)))return;return Array.from(c).map(h=>h.split(",")).map(h=>({method:h[1],start:+h[2],count:+h[3]}))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Zs.update(this,this.width,this.height,t);const r=this.chartArea,a=r.width<=0||r.height<=0;this._layers=[],ar(this.boxes,c=>{a&&"chartArea"===c.position||(c.configure&&c.configure(),this._layers.push(...c._layers()))},this),this._layers.forEach((c,h)=>{c._idx=h}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let r=0,a=this.data.datasets.length;r<a;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,a=this.data.datasets.length;r<a;++r)this._updateDataset(r,Ap(t)?t({datasetIndex:r}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,r){const a=this.getDatasetMeta(t),c={meta:a,index:t,mode:r,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",c)&&(a.controller._update(r),c.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",c))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(wh.has(this)?this.attached&&!wh.running(this)&&wh.start(this):(this.draw(),eU({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:a,height:c}=this._resizeBeforeDraw;this._resize(a,c),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const r=this._layers;for(t=0;t<r.length&&r[t].z<=0;++t)r[t].draw(this.chartArea);for(this._drawDatasets();t<r.length;++t)r[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const r=this._sortedMetasets,a=[];let c,h;for(c=0,h=r.length;c<h;++c){const f=r[c];(!t||f.visible)&&a.push(f)}return a}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let r=t.length-1;r>=0;--r)this._drawDataset(t[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const r=this.ctx,a=t._clip,c=!a.disabled,h=function GQ(e,n){const{xScale:t,yScale:r}=e;return t&&r?{left:xI(t,n,"left"),right:xI(t,n,"right"),top:xI(r,n,"top"),bottom:xI(r,n,"bottom")}:n}(t,this.chartArea),f={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",f)&&(c&&lI(r,{left:!1===a.left?0:h.left-a.left,right:!1===a.right?this.width:h.right+a.right,top:!1===a.top?0:h.top-a.top,bottom:!1===a.bottom?this.height:h.bottom+a.bottom}),t.controller.draw(),c&&cI(r),f.cancelable=!1,this.notifyPlugins("afterDatasetDraw",f))}isPointInArea(t){return xh(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,r,a,c){const h=jK.modes[r];return"function"==typeof h?h(this,t,a,c):[]}getDatasetMeta(t){const r=this.data.datasets[t],a=this._metasets;let c=a.filter(h=>h&&h._dataset===r).pop();return c||(c={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:t,_dataset:r,_parsed:[],_sorted:!1},a.push(c)),c}getContext(){return this.$context||(this.$context=Rp(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const r=this.data.datasets[t];if(!r)return!1;const a=this.getDatasetMeta(t);return"boolean"==typeof a.hidden?!a.hidden:!r.hidden}setDatasetVisibility(t,r){this.getDatasetMeta(t).hidden=!r}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,r,a){const c=a?"show":"hide",h=this.getDatasetMeta(t),f=h.controller._resolveAnimations(void 0,c);HC(r)?(h.data[r].hidden=!a,this.update()):(this.setDatasetVisibility(t,a),f.update(h,{visible:a}),this.update(b=>b.datasetIndex===t?c:void 0))}hide(t,r){this._updateVisibility(t,r,!1)}show(t,r){this._updateVisibility(t,r,!0)}_destroyDatasetMeta(t){const r=this._metasets[t];r&&r.controller&&r.controller._destroy(),delete this._metasets[t]}_stop(){let t,r;for(this.stop(),wh.remove(this),t=0,r=this.data.datasets.length;t<r;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:r}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),X5(t,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete vI[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,r=this.platform,a=(h,f)=>{r.addEventListener(this,h,f),t[h]=f},c=(h,f,b)=>{h.offsetX=f,h.offsetY=b,this._eventHandler(h)};ar(this.options.events,h=>a(h,c))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,r=this.platform,a=(x,M)=>{r.addEventListener(this,x,M),t[x]=M},c=(x,M)=>{t[x]&&(r.removeEventListener(this,x,M),delete t[x])},h=(x,M)=>{this.canvas&&this.resize(x,M)};let f;const b=()=>{c("attach",b),this.attached=!0,this.resize(),a("resize",h),a("detach",f)};f=()=>{this.attached=!1,c("resize",h),this._stop(),this._resize(0,0),a("attach",b)},r.isAttached(this.canvas)?b():f()}unbindEvents(){ar(this._listeners,(t,r)=>{this.platform.removeEventListener(this,r,t)}),this._listeners={},ar(this._responsiveListeners,(t,r)=>{this.platform.removeEventListener(this,r,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,r,a){const c=a?"set":"remove";let h,f,b,x;for("dataset"===r&&(h=this.getDatasetMeta(t[0].datasetIndex),h.controller["_"+c+"DatasetHoverStyle"]()),b=0,x=t.length;b<x;++b){f=t[b];const M=f&&this.getDatasetMeta(f.datasetIndex).controller;M&&M[c+"HoverStyle"](f.element,f.datasetIndex,f.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const r=this._active||[],a=t.map(({datasetIndex:h,index:f})=>{const b=this.getDatasetMeta(h);if(!b)throw new Error("No dataset found at index "+h);return{datasetIndex:h,element:b.data[f],index:f}});!iI(a,r)&&(this._active=a,this._lastEvent=null,this._updateHoverStyles(a,r))}notifyPlugins(t,r,a){return this._plugins.notify(this,t,r,a)}isPluginEnabled(t){return 1===this._plugins._cache.filter(r=>r.plugin.id===t).length}_updateHoverStyles(t,r,a){const c=this.options.hover,h=(x,M)=>x.filter(T=>!M.some(I=>T.datasetIndex===I.datasetIndex&&T.index===I.index)),f=h(r,t),b=a?t:h(t,r);f.length&&this.updateHoverStyle(f,c.mode,!1),b.length&&c.mode&&this.updateHoverStyle(b,c.mode,!0)}_eventHandler(t,r){const a={event:t,replay:r,cancelable:!0,inChartArea:this.isPointInArea(t)},c=f=>(f.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",a,c))return;const h=this._handleEvent(t,r,a.inChartArea);return a.cancelable=!1,this.notifyPlugins("afterEvent",a,c),(h||a.changed)&&this.render(),this}_handleEvent(t,r,a){const{_active:c=[],options:h}=this,b=this._getActiveElements(t,c,a,r),x=function XZ(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(t),M=function $Q(e,n,t,r){return t&&"mouseout"!==e.type?r?n:e:null}(t,this._lastEvent,a,x);a&&(this._lastEvent=null,Sr(h.onHover,[t,b,this],this),x&&Sr(h.onClick,[t,b,this],this));const T=!iI(b,c);return(T||r)&&(this._active=b,this._updateHoverStyles(b,c,r)),this._lastEvent=M,T}_getActiveElements(t,r,a,c){if("mouseout"===t.type)return[];if(!a)return r;const h=this.options.hover;return this.getElementsAtEventForMode(t,h.mode,h,c)}})();function rU(){return ar(wI.instances,e=>e._plugins.invalidate())}function Ev(e,n,t,r){return{x:t+e*Math.cos(n),y:r+e*Math.sin(n)}}function CI(e,n,t,r,a,c){const{x:h,y:f,startAngle:b,pixelMargin:x,innerRadius:M}=n,T=Math.max(n.outerRadius+r+t-x,0),I=M>0?M+r+t+x:0;let L=0;const N=a-b;if(r){const Pe=((M>0?M-r:0)+(T>0?T-r:0))/2;L=(N-(0!==Pe?N*Pe/(Pe+r):N))/2}const $=(N-Math.max(.001,N*T-t/Lr)/T)/2,nt=b+$+L,tt=a-$-L,{outerStart:_t,outerEnd:wt,innerStart:Dt,innerEnd:Vt}=function YQ(e,n,t,r){const a=function qQ(e){return FB(e,["outerStart","outerEnd","innerStart","innerEnd"])}(e.options.borderRadius),c=(t-n)/2,h=Math.min(c,r*n/2),f=b=>{const x=(t-Math.min(c,b))*r/2;return Qo(b,0,Math.min(c,x))};return{outerStart:f(a.outerStart),outerEnd:f(a.outerEnd),innerStart:Qo(a.innerStart,0,h),innerEnd:Qo(a.innerEnd,0,h)}}(n,I,T,tt-nt),ae=T-_t,ee=T-wt,Fe=nt+_t/ae,Ai=tt-wt/ee,Wi=I+Dt,dn=I+Vt,zr=nt+Dt/Wi,Ks=tt-Vt/dn;if(e.beginPath(),c){const Qn=(Fe+Ai)/2;if(e.arc(h,f,T,Fe,Qn),e.arc(h,f,T,Qn,Ai),wt>0){const Li=Ev(ee,Ai,h,f);e.arc(Li.x,Li.y,wt,Ai,tt+Mo)}const xe=Ev(dn,tt,h,f);if(e.lineTo(xe.x,xe.y),Vt>0){const Li=Ev(dn,Ks,h,f);e.arc(Li.x,Li.y,Vt,tt+Mo,Ks+Math.PI)}const Pe=(tt-Vt/I+(nt+Dt/I))/2;if(e.arc(h,f,I,tt-Vt/I,Pe,!0),e.arc(h,f,I,Pe,nt+Dt/I,!0),Dt>0){const Li=Ev(Wi,zr,h,f);e.arc(Li.x,Li.y,Dt,zr+Math.PI,nt-Mo)}const si=Ev(ae,nt,h,f);if(e.lineTo(si.x,si.y),_t>0){const Li=Ev(ae,Fe,h,f);e.arc(Li.x,Li.y,_t,nt-Mo,Fe)}}else{e.moveTo(h,f);const Qn=Math.cos(Fe)*T+h,xe=Math.sin(Fe)*T+f;e.lineTo(Qn,xe);const Pe=Math.cos(Ai)*T+h,si=Math.sin(Ai)*T+f;e.lineTo(Pe,si)}e.closePath()}function oU(e,n,t=n){e.lineCap=cn(t.borderCapStyle,n.borderCapStyle),e.setLineDash(cn(t.borderDash,n.borderDash)),e.lineDashOffset=cn(t.borderDashOffset,n.borderDashOffset),e.lineJoin=cn(t.borderJoinStyle,n.borderJoinStyle),e.lineWidth=cn(t.borderWidth,n.borderWidth),e.strokeStyle=cn(t.borderColor,n.borderColor)}function QQ(e,n,t){e.lineTo(t.x,t.y)}function sU(e,n,t={}){const r=e.length,{start:a=0,end:c=r-1}=t,{start:h,end:f}=n,b=Math.max(a,h),x=Math.min(c,f);return{count:r,start:b,loop:n.loop,ilen:x<b&&!(a<h&&c<h||a>f&&c>f)?r+x-b:x-b}}function tJ(e,n,t,r){const{points:a,options:c}=n,{count:h,start:f,loop:b,ilen:x}=sU(a,t,r),M=function JQ(e){return e.stepped?bX:e.tension||"monotone"===e.cubicInterpolationMode?yX:QQ}(c);let L,N,V,{move:T=!0,reverse:I}=r||{};for(L=0;L<=x;++L)N=a[(f+(I?x-L:L))%h],!N.skip&&(T?(e.moveTo(N.x,N.y),T=!1):M(e,V,N,I,c.stepped),V=N);return b&&(N=a[(f+(I?x:0))%h],M(e,V,N,I,c.stepped)),!!b}function eJ(e,n,t,r){const a=n.points,{count:c,start:h,ilen:f}=sU(a,t,r),{move:b=!0,reverse:x}=r||{};let I,L,N,V,$,nt,M=0,T=0;const tt=wt=>(h+(x?f-wt:wt))%c,_t=()=>{V!==$&&(e.lineTo(M,$),e.lineTo(M,V),e.lineTo(M,nt))};for(b&&(L=a[tt(0)],e.moveTo(L.x,L.y)),I=0;I<=f;++I){if(L=a[tt(I)],L.skip)continue;const wt=L.x,Dt=L.y,Vt=0|wt;Vt===N?(Dt<V?V=Dt:Dt>$&&($=Dt),M=(T*M+wt)/++T):(_t(),e.lineTo(wt,Dt),N=Vt,T=0,V=$=Dt),nt=Dt}_t()}function KB(e){const n=e.options;return e._decimated||e._loop||n.tension||"monotone"===n.cubicInterpolationMode||n.stepped||n.borderDash&&n.borderDash.length?tJ:eJ}const oJ="function"==typeof Path2D;let MI=(()=>class e extends Ch{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,r){const a=this.options;!a.tension&&"monotone"!==a.cubicInterpolationMode||a.stepped||this._pointsUpdated||(HX(this._points,a,t,a.spanGaps?this._loop:this._fullLoop,r),this._pointsUpdated=!0)}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function rK(e,n){const t=e.points,r=e.options.spanGaps,a=t.length;if(!a)return[];const c=!!e._loop,{start:h,end:f}=function iK(e,n,t,r){let a=0,c=n-1;if(t&&!r)for(;a<n&&!e[a].skip;)a++;for(;a<n&&e[a].skip;)a++;for(a%=n,t&&(c+=a);c>a&&e[c%n].skip;)c--;return c%=n,{start:a,end:c}}(t,a,c,r);return function fj(e,n,t,r){return r&&r.setContext&&t?function oK(e,n,t,r){const a=e._chart.getContext(),c=gj(e.options),{_datasetIndex:h,options:{spanGaps:f}}=e,b=t.length,x=[];let M=c,T=n[0].start,I=T;function L(N,V,$,nt){const tt=f?-1:1;if(N!==V){for(N+=b;t[N%b].skip;)N-=tt;for(;t[V%b].skip;)V+=tt;N%b!=V%b&&(x.push({start:N%b,end:V%b,loop:$,style:nt}),M=nt,T=V%b)}}for(const N of n){T=f?T:N.start;let $,V=t[T%b];for(I=T+1;I<=N.end;I++){const nt=t[I%b];$=gj(r.setContext(Rp(a,{type:"segment",p0:V,p1:nt,p0DataIndex:(I-1)%b,p1DataIndex:I%b,datasetIndex:h}))),sK($,M)&&L(T,I-1,N.loop,M),V=nt,M=$}T<I-1&&L(T,I-1,N.loop,M)}return x}(e,n,t,r):n}(e,!0===r?[{start:h,end:f,loop:c}]:function nK(e,n,t,r){const a=e.length,c=[];let b,h=n,f=e[n];for(b=n+1;b<=t;++b){const x=e[b%a];x.skip||x.stop?f.skip||(c.push({start:n%a,end:(b-1)%a,loop:r=!1}),n=h=x.stop?b:null):(h=b,f.skip&&(n=b)),f=x}return null!==h&&c.push({start:n%a,end:h%a,loop:r}),c}(t,h,f<h?f+a:f,!!e._fullLoop&&0===h&&f===a-1),t,n)}(this,this.options.segment))}first(){const t=this.segments;return t.length&&this.points[t[0].start]}last(){const t=this.segments,a=t.length;return a&&this.points[t[a-1].end]}interpolate(t,r){const a=this.options,c=t[r],h=this.points,f=pj(this,{property:r,start:c,end:c});if(!f.length)return;const b=[],x=function iJ(e){return e.stepped?KX:e.tension||"monotone"===e.cubicInterpolationMode?QX:d_}(a);let M,T;for(M=0,T=f.length;M<T;++M){const{start:I,end:L}=f[M],N=h[I],V=h[L];if(N===V){b.push(N);continue}const nt=x(N,V,Math.abs((c-N[r])/(V[r]-N[r])),a.stepped);nt[r]=t[r],b.push(nt)}return 1===b.length?b[0]:b}pathSegment(t,r,a){return KB(this)(t,this,r,a)}path(t,r,a){const c=this.segments,h=KB(this);let f=this._loop;r=r||0,a=a||this.points.length-r;for(const b of c)f&=h(t,this,b,{start:r,end:r+a-1});return!!f}draw(t,r,a,c){(this.points||[]).length&&(this.options||{}).borderWidth&&(t.save(),function sJ(e,n,t,r){oJ&&!n.options.segment?function nJ(e,n,t,r){let a=n._path;a||(a=n._path=new Path2D,n.path(a,t,r)&&a.closePath()),oU(e,n.options),e.stroke(a)}(e,n,t,r):function rJ(e,n,t,r){const{segments:a,options:c}=n,h=KB(n);for(const f of a)oU(e,c,f.style),e.beginPath(),h(e,n,f,{start:t,end:t+r-1})&&e.closePath(),e.stroke()}(e,n,t,r)}(t,this,a,c),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}})();function aU(e,n,t,r){const a=e.options,{[t]:c}=e.getProps([t],r);return Math.abs(n-c)<a.radius+a.hitRadius}let aJ=(()=>class e extends Ch{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,r,a){const c=this.options,{x:h,y:f}=this.getProps(["x","y"],a);return Math.pow(t-h,2)+Math.pow(r-f,2)<Math.pow(c.hitRadius+c.radius,2)}inXRange(t,r){return aU(this,t,"x",r)}inYRange(t,r){return aU(this,t,"y",r)}getCenterPoint(t){const{x:r,y:a}=this.getProps(["x","y"],t);return{x:r,y:a}}size(t){let r=(t=t||this.options||{}).radius||0;return r=Math.max(r,r&&t.hoverRadius||0),2*(r+(r&&t.borderWidth||0))}draw(t,r){const a=this.options;this.skip||a.radius<.1||!xh(this,r,this.size(a)/2)||(t.strokeStyle=a.borderColor,t.lineWidth=a.borderWidth,t.fillStyle=a.backgroundColor,OB(t,a,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}})();function lU(e,n){const{x:t,y:r,base:a,width:c,height:h}=e.getProps(["x","y","base","width","height"],n);let f,b,x,M,T;return e.horizontal?(T=h/2,f=Math.min(t,a),b=Math.max(t,a),x=r-T,M=r+T):(T=c/2,f=t-T,b=t+T,x=Math.min(r,a),M=Math.max(r,a)),{left:f,top:x,right:b,bottom:M}}function Op(e,n,t,r){return e?0:Qo(n,t,r)}function QB(e,n,t,r){const a=null===n,c=null===t,f=e&&!(a&&c)&&lU(e,r);return f&&(a||yh(n,f.left,f.right))&&(c||yh(t,f.top,f.bottom))}function hJ(e,n){e.rect(n.x,n.y,n.w,n.h)}function JB(e,n,t={}){const r=e.x!==t.x?-n:0,a=e.y!==t.y?-n:0;return{x:e.x+r,y:e.y+a,w:e.w+((e.x+e.w!==t.x+t.w?n:0)-r),h:e.h+((e.y+e.h!==t.y+t.h?n:0)-a),radius:e.radius}}var pJ=Object.freeze({__proto__:null,ArcElement:class KQ extends Ch{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:n=>"borderDash"!==n};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(n){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,t,r){const a=this.getProps(["x","y"],r),{angle:c,distance:h}=B5(a,{x:n,y:t}),{startAngle:f,endAngle:b,innerRadius:x,outerRadius:M,circumference:T}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),I=(this.options.spacing+this.options.borderWidth)/2,N=cn(T,b-f)>=Br||GC(c,f,b),V=yh(h,x+I,M+I);return N&&V}getCenterPoint(n){const{x:t,y:r,startAngle:a,endAngle:c,innerRadius:h,outerRadius:f}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:b,spacing:x}=this.options,M=(a+c)/2,T=(h+f+x+b)/2;return{x:t+Math.cos(M)*T,y:r+Math.sin(M)*T}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:t,circumference:r}=this,a=(t.offset||0)/4,c=(t.spacing||0)/2,h=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=r>Br?Math.floor(r/Br):0,0===r||this.innerRadius<0||this.outerRadius<0)return;n.save();const f=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(f)*a,Math.sin(f)*a);const x=a*(1-Math.sin(Math.min(Lr,r||0)));n.fillStyle=t.backgroundColor,n.strokeStyle=t.borderColor,function ZQ(e,n,t,r,a){const{fullCircles:c,startAngle:h,circumference:f}=n;let b=n.endAngle;if(c){CI(e,n,t,r,b,a);for(let x=0;x<c;++x)e.fill();isNaN(f)||(b=h+(f%Br||Br))}CI(e,n,t,r,b,a),e.fill()}(n,this,x,c,h),function XQ(e,n,t,r,a){const{fullCircles:c,startAngle:h,circumference:f,options:b}=n,{borderWidth:x,borderJoinStyle:M,borderDash:T,borderDashOffset:I}=b,L="inner"===b.borderAlign;if(!x)return;e.setLineDash(T||[]),e.lineDashOffset=I,L?(e.lineWidth=2*x,e.lineJoin=M||"round"):(e.lineWidth=x,e.lineJoin=M||"bevel");let N=n.endAngle;if(c){CI(e,n,t,r,N,a);for(let V=0;V<c;++V)e.stroke();isNaN(f)||(N=h+(f%Br||Br))}L&&function WQ(e,n,t){const{startAngle:r,pixelMargin:a,x:c,y:h,outerRadius:f,innerRadius:b}=n;let x=a/f;e.beginPath(),e.arc(c,h,f,r-x,t+x),b>a?(x=a/b,e.arc(c,h,b,t+x,r-x,!0)):e.arc(c,h,a,t+Mo,r-Mo),e.closePath(),e.clip()}(e,n,N),c||(CI(e,n,t,r,N,a),e.stroke())}(n,this,x,c,h),n.restore()}},BarElement:class mJ extends Ch{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(n){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,n&&Object.assign(this,n)}draw(n){const{inflateAmount:t,options:{borderColor:r,backgroundColor:a}}=this,{inner:c,outer:h}=function dJ(e){const n=lU(e),t=n.right-n.left,r=n.bottom-n.top,a=function lJ(e,n,t){const a=e.borderSkipped,c=Q5(e.options.borderWidth);return{t:Op(a.top,c.top,0,t),r:Op(a.right,c.right,0,n),b:Op(a.bottom,c.bottom,0,t),l:Op(a.left,c.left,0,n)}}(e,t/2,r/2),c=function cJ(e,n,t){const{enableBorderRadius:r}=e.getProps(["enableBorderRadius"]),a=e.options.borderRadius,c=a_(a),h=Math.min(n,t),f=e.borderSkipped,b=r||Sn(a);return{topLeft:Op(!b||f.top||f.left,c.topLeft,0,h),topRight:Op(!b||f.top||f.right,c.topRight,0,h),bottomLeft:Op(!b||f.bottom||f.left,c.bottomLeft,0,h),bottomRight:Op(!b||f.bottom||f.right,c.bottomRight,0,h)}}(e,t/2,r/2);return{outer:{x:n.left,y:n.top,w:t,h:r,radius:c},inner:{x:n.left+a.l,y:n.top+a.t,w:t-a.l-a.r,h:r-a.t-a.b,radius:{topLeft:Math.max(0,c.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,c.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,c.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,c.bottomRight-Math.max(a.b,a.r))}}}}(this),f=function uJ(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}(h.radius)?ZC:hJ;n.save(),(h.w!==c.w||h.h!==c.h)&&(n.beginPath(),f(n,JB(h,t,c)),n.clip(),f(n,JB(c,-t,h)),n.fillStyle=r,n.fill("evenodd")),n.beginPath(),f(n,JB(c,t)),n.fillStyle=a,n.fill(),n.restore()}inRange(n,t,r){return QB(this,n,t,r)}inXRange(n,t){return QB(this,n,null,t)}inYRange(n,t){return QB(this,null,n,t)}getCenterPoint(n){const{x:t,y:r,base:a,horizontal:c}=this.getProps(["x","y","base","horizontal"],n);return{x:c?(t+a)/2:t,y:c?r:(r+a)/2}}getRange(n){return"x"===n?this.width/2:this.height/2}},LineElement:MI,PointElement:aJ});const tN=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],cU=tN.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function dU(e){return tN[e%tN.length]}function uU(e){return cU[e%cU.length]}function hU(e){let n;for(n in e)if(e[n].borderColor||e[n].backgroundColor)return!0;return!1}var vJ={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,n,t){if(!t.enabled)return;const{data:{datasets:r},options:a}=e.config,{elements:c}=a;if(!t.forceOverride&&(hU(r)||function yJ(e){return e&&(e.borderColor||e.backgroundColor)}(a)||c&&hU(c)))return;const h=function bJ(e){let n=0;return(t,r)=>{const a=e.getDatasetMeta(r).controller;a instanceof $B?n=function gJ(e,n){return e.backgroundColor=e.data.map(()=>dU(n++)),n}(t,n):a instanceof Aj?n=function _J(e,n){return e.backgroundColor=e.data.map(()=>uU(n++)),n}(t,n):a&&(n=function fJ(e,n){return e.borderColor=dU(n),e.backgroundColor=uU(n),++n}(t,n))}}(e);r.forEach(h)}};function mU(e){if(e._decimated){const n=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:n})}}function pU(e){e.data.datasets.forEach(n=>{mU(n)})}var MJ={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,n,t)=>{if(!t.enabled)return void pU(e);const r=e.width;e.data.datasets.forEach((a,c)=>{const{_data:h,indexAxis:f}=a,b=e.getDatasetMeta(c),x=h||a.data;if("y"===XC([f,e.options.indexAxis])||!b.controller.supportsDecimation)return;const M=e.scales[b.xAxisID];if("linear"!==M.type&&"time"!==M.type||e.options.parsing)return;let N,{start:T,count:I}=function CJ(e,n){const t=n.length;let a,r=0;const{iScale:c}=e,{min:h,max:f,minDefined:b,maxDefined:x}=c.getUserBounds();return b&&(r=Qo(vh(n,c.axis,h).lo,0,t-1)),a=x?Qo(vh(n,c.axis,f).hi+1,r,t)-r:t-r,{start:r,count:a}}(b,x);if(I<=(t.threshold||4*r))mU(a);else{switch(Vn(h)&&(a._data=x,delete a.data,Object.defineProperty(a,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(V){this._data=V}})),t.algorithm){case"lttb":N=function xJ(e,n,t,r,a){const c=a.samples||r;if(c>=t)return e.slice(n,n+t);const h=[],f=(t-2)/(c-2);let b=0;const x=n+t-1;let T,I,L,N,V,M=n;for(h[b++]=e[M],T=0;T<c-2;T++){let tt,$=0,nt=0;const _t=Math.floor((T+1)*f)+1+n,wt=Math.min(Math.floor((T+2)*f)+1,t)+n,Dt=wt-_t;for(tt=_t;tt<wt;tt++)$+=e[tt].x,nt+=e[tt].y;$/=Dt,nt/=Dt;const Vt=Math.floor(T*f)+1+n,ae=Math.min(Math.floor((T+1)*f)+1,t)+n,{x:ee,y:Fe}=e[M];for(L=N=-1,tt=Vt;tt<ae;tt++)N=.5*Math.abs((ee-$)*(e[tt].y-Fe)-(ee-e[tt].x)*(nt-Fe)),N>L&&(L=N,I=e[tt],V=tt);h[b++]=I,M=V}return h[b++]=e[x],h}(x,T,I,r,t);break;case"min-max":N=function wJ(e,n,t,r){let h,f,b,x,M,T,I,L,N,V,a=0,c=0;const $=[],tt=e[n].x,wt=e[n+t-1].x-tt;for(h=n;h<n+t;++h){f=e[h],b=(f.x-tt)/wt*r,x=f.y;const Dt=0|b;if(Dt===M)x<N?(N=x,T=h):x>V&&(V=x,I=h),a=(c*a+f.x)/++c;else{const Vt=h-1;if(!Vn(T)&&!Vn(I)){const ae=Math.min(T,I),ee=Math.max(T,I);ae!==L&&ae!==Vt&&$.push({...e[ae],x:a}),ee!==L&&ee!==Vt&&$.push({...e[ee],x:a})}h>0&&Vt!==L&&$.push(e[Vt]),$.push(f),M=Dt,c=0,N=V=x,T=I=L=h}}return $}(x,T,I,r);break;default:throw new Error(`Unsupported decimation algorithm '${t.algorithm}'`)}a._decimated=N}})},destroy(e){pU(e)}};function eN(e,n,t,r){if(r)return;let a=n[e],c=t[e];return"angle"===e&&(a=yl(a),c=yl(c)),{property:e,start:a,end:c}}function iN(e,n,t){for(;n>e;n--){const r=t[n];if(!isNaN(r.x)&&!isNaN(r.y))break}return n}function fU(e,n,t,r){return e&&n?r(e[t],n[t]):e?e[t]:n?n[t]:0}function gU(e,n){let t=[],r=!1;return Fr(e)?(r=!0,t=e):t=function kJ(e,n){const{x:t=null,y:r=null}=e||{},a=n.points,c=[];return n.segments.forEach(({start:h,end:f})=>{f=iN(h,f,a);const b=a[h],x=a[f];null!==r?(c.push({x:b.x,y:r}),c.push({x:x.x,y:r})):null!==t&&(c.push({x:t,y:b.y}),c.push({x:t,y:x.y}))}),c}(e,n),t.length?new MI({points:t,options:{tension:0},_loop:r,_fullLoop:r}):null}function _U(e){return e&&!1!==e.fill}function SJ(e,n,t){let a=e[n].fill;const c=[n];let h;if(!t)return a;for(;!1!==a&&-1===c.indexOf(a);){if(!uo(a))return a;if(h=e[a],!h)return!1;if(h.visible)return a;c.push(a),a=h.fill}return!1}function TJ(e,n,t){const r=function RJ(e){const n=e.options,t=n.fill;let r=cn(t&&t.target,t);return void 0===r&&(r=!!n.backgroundColor),!1!==r&&null!==r&&(!0===r?"origin":r)}(e);if(Sn(r))return!isNaN(r.value)&&r;let a=parseFloat(r);return uo(a)&&Math.floor(a)===a?function EJ(e,n,t,r){return("-"===e||"+"===e)&&(t=n+t),!(t===n||t<0||t>=r)&&t}(r[0],n,a,t):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function FJ(e,n,t){const r=[];for(let a=0;a<t.length;a++){const c=t[a],{first:h,last:f,point:b}=LJ(c,n,"x");if(!(!b||h&&f))if(h)r.unshift(b);else if(e.push(b),!f)break}e.push(...r)}function LJ(e,n,t){const r=e.interpolate(n,t);if(!r)return{};const a=r[t],c=e.segments,h=e.points;let f=!1,b=!1;for(let x=0;x<c.length;x++){const M=c[x],T=h[M.start][t],I=h[M.end][t];if(yh(a,T,I)){f=a===T,b=a===I;break}}return{first:f,last:b,point:r}}class bU{constructor(n){this.x=n.x,this.y=n.y,this.radius=n.radius}pathSegment(n,t,r){const{x:a,y:c,radius:h}=this;return n.arc(a,c,h,(t=t||{start:0,end:Br}).end,t.start,!0),!r.bounds}interpolate(n){const{x:t,y:r,radius:a}=this,c=n.angle;return{x:t+Math.cos(c)*a,y:r+Math.sin(c)*a,angle:c}}}function nN(e,n,t){const r=function BJ(e){const{chart:n,fill:t,line:r}=e;if(uo(t))return function NJ(e,n){const t=e.getDatasetMeta(n);return t&&e.isDatasetVisible(n)?t.dataset:null}(n,t);if("stack"===t)return function PJ(e){const{scale:n,index:t,line:r}=e,a=[],c=r.segments,h=r.points,f=function OJ(e,n){const t=[],r=e.getMatchingVisibleMetas("line");for(let a=0;a<r.length;a++){const c=r[a];if(c.index===n)break;c.hidden||t.unshift(c.dataset)}return t}(n,t);f.push(gU({x:null,y:n.bottom},r));for(let b=0;b<c.length;b++){const x=c[b];for(let M=x.start;M<=x.end;M++)FJ(a,h[M],f)}return new MI({points:a,options:{}})}(e);if("shape"===t)return!0;const a=function zJ(e){return(e.scale||{}).getPointPositionForValue?function jJ(e){const{scale:n,fill:t}=e,r=n.options,a=n.getLabels().length,c=r.reverse?n.max:n.min,h=function IJ(e,n,t){let r;return r="start"===e?t:"end"===e?n.options.reverse?n.min:n.max:Sn(e)?e.value:n.getBaseValue(),r}(t,n,c),f=[];if(r.grid.circular){const b=n.getPointPositionForValue(0,c);return new bU({x:b.x,y:b.y,radius:n.getDistanceFromCenterForValue(h)})}for(let b=0;b<a;++b)f.push(n.getPointPositionForValue(b,h));return f}(e):function VJ(e){const{scale:n={},fill:t}=e,r=function AJ(e,n){let t=null;return"start"===e?t=n.bottom:"end"===e?t=n.top:Sn(e)?t=n.getPixelForValue(e.value):n.getBasePixel&&(t=n.getBasePixel()),t}(t,n);if(uo(r)){const a=n.isHorizontal();return{x:a?r:null,y:a?null:r}}return null}(e)}(e);return a instanceof bU?a:gU(a,r)}(n),{line:a,scale:c,axis:h}=n,f=a.options,b=f.fill,x=f.backgroundColor,{above:M=x,below:T=x}=b||{};r&&a.points.length&&(lI(e,t),function UJ(e,n){const{line:t,target:r,above:a,below:c,area:h,scale:f}=n,b=t._loop?"angle":n.axis;e.save(),"x"===b&&c!==a&&(yU(e,r,h.top),vU(e,{line:t,target:r,color:a,scale:f,property:b}),e.restore(),e.save(),yU(e,r,h.bottom)),vU(e,{line:t,target:r,color:c,scale:f,property:b}),e.restore()}(e,{line:a,target:r,above:M,below:T,area:t,scale:c,axis:h}),cI(e))}function yU(e,n,t){const{segments:r,points:a}=n;let c=!0,h=!1;e.beginPath();for(const f of r){const{start:b,end:x}=f,M=a[b],T=a[iN(b,x,a)];c?(e.moveTo(M.x,M.y),c=!1):(e.lineTo(M.x,t),e.lineTo(M.x,M.y)),h=!!n.pathSegment(e,f,{move:h}),h?e.closePath():e.lineTo(T.x,t)}e.lineTo(n.first().x,t),e.closePath(),e.clip()}function vU(e,n){const{line:t,target:r,property:a,color:c,scale:h}=n,f=function DJ(e,n,t){const r=e.segments,a=e.points,c=n.points,h=[];for(const f of r){let{start:b,end:x}=f;x=iN(b,x,a);const M=eN(t,a[b],a[x],f.loop);if(!n.segments){h.push({source:f,target:M,start:a[b],end:a[x]});continue}const T=pj(n,M);for(const I of T){const L=eN(t,c[I.start],c[I.end],I.loop),N=mj(f,a,L);for(const V of N)h.push({source:V,target:I,start:{[t]:fU(M,L,"start",Math.max)},end:{[t]:fU(M,L,"end",Math.min)}})}}return h}(t,r,a);for(const{source:b,target:x,start:M,end:T}of f){const{style:{backgroundColor:I=c}={}}=b,L=!0!==r;e.save(),e.fillStyle=I,HJ(e,h,L&&eN(a,M,T)),e.beginPath();const N=!!t.pathSegment(e,b);let V;if(L){N?e.closePath():xU(e,r,T,a);const $=!!r.pathSegment(e,x,{move:N,reverse:!0});V=N&&$,V||xU(e,r,M,a)}e.closePath(),e.fill(V?"evenodd":"nonzero"),e.restore()}}function HJ(e,n,t){const{top:r,bottom:a}=n.chart.chartArea,{property:c,start:h,end:f}=t||{};"x"===c&&(e.beginPath(),e.rect(h,r,f-h,a-r),e.clip())}function xU(e,n,t,r){const a=n.interpolate(t,r);a&&e.lineTo(a.x,a.y)}var $J={id:"filler",afterDatasetsUpdate(e,n,t){const r=(e.data.datasets||[]).length,a=[];let c,h,f,b;for(h=0;h<r;++h)c=e.getDatasetMeta(h),f=c.dataset,b=null,f&&f.options&&f instanceof MI&&(b={visible:e.isDatasetVisible(h),index:h,fill:TJ(f,h,r),chart:e,axis:c.controller.options.indexAxis,scale:c.vScale,line:f}),c.$filler=b,a.push(b);for(h=0;h<r;++h)b=a[h],b&&!1!==b.fill&&(b.fill=SJ(a,h,t.propagate))},beforeDraw(e,n,t){const r="beforeDraw"===t.drawTime,a=e.getSortedVisibleDatasetMetas(),c=e.chartArea;for(let h=a.length-1;h>=0;--h){const f=a[h].$filler;f&&(f.line.updateControlPoints(c,f.axis),r&&f.fill&&nN(e.ctx,f,c))}},beforeDatasetsDraw(e,n,t){if("beforeDatasetsDraw"!==t.drawTime)return;const r=e.getSortedVisibleDatasetMetas();for(let a=r.length-1;a>=0;--a){const c=r[a].$filler;_U(c)&&nN(e.ctx,c,e.chartArea)}},beforeDatasetDraw(e,n,t){const r=n.meta.$filler;!_U(r)||"beforeDatasetDraw"!==t.drawTime||nN(e.ctx,r,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const wU=(e,n)=>{let{boxHeight:t=n,boxWidth:r=n}=e;return e.usePointStyle&&(t=Math.min(t,n),r=e.pointStyleWidth||Math.min(r,n)),{boxWidth:r,boxHeight:t,itemHeight:Math.max(n,t)}};class CU extends Ch{constructor(n){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,t,r){this.maxWidth=n,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const n=this.options.labels||{};let t=Sr(n.generateLabels,[this.chart],this)||[];n.filter&&(t=t.filter(r=>n.filter(r,this.chart.data))),n.sort&&(t=t.sort((r,a)=>n.sort(r,a,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:n,ctx:t}=this;if(!n.display)return void(this.width=this.height=0);const r=n.labels,a=Uo(r.font),c=a.size,h=this._computeTitleHeight(),{boxWidth:f,itemHeight:b}=wU(r,c);let x,M;t.font=a.string,this.isHorizontal()?(x=this.maxWidth,M=this._fitRows(h,c,f,b)+10):(M=this.maxHeight,x=this._fitCols(h,a,f,b)+10),this.width=Math.min(x,n.maxWidth||this.maxWidth),this.height=Math.min(M,n.maxHeight||this.maxHeight)}_fitRows(n,t,r,a){const{ctx:c,maxWidth:h,options:{labels:{padding:f}}}=this,b=this.legendHitBoxes=[],x=this.lineWidths=[0],M=a+f;let T=n;c.textAlign="left",c.textBaseline="middle";let I=-1,L=-M;return this.legendItems.forEach((N,V)=>{const $=r+t/2+c.measureText(N.text).width;(0===V||x[x.length-1]+$+2*f>h)&&(T+=M,x[x.length-(V>0?0:1)]=0,L+=M,I++),b[V]={left:0,top:L,row:I,width:$,height:a},x[x.length-1]+=$+f}),T}_fitCols(n,t,r,a){const{ctx:c,maxHeight:h,options:{labels:{padding:f}}}=this,b=this.legendHitBoxes=[],x=this.columnSizes=[],M=h-n;let T=f,I=0,L=0,N=0,V=0;return this.legendItems.forEach(($,nt)=>{const{itemWidth:tt,itemHeight:_t}=function WJ(e,n,t,r,a){const c=function qJ(e,n,t,r){let a=e.text;return a&&"string"!=typeof a&&(a=a.reduce((c,h)=>c.length>h.length?c:h)),n+t.size/2+r.measureText(a).width}(r,e,n,t),h=function YJ(e,n,t){let r=e;return"string"!=typeof n.text&&(r=MU(n,t)),r}(a,r,n.lineHeight);return{itemWidth:c,itemHeight:h}}(r,t,c,$,a);nt>0&&L+_t+2*f>M&&(T+=I+f,x.push({width:I,height:L}),N+=I+f,V++,I=L=0),b[nt]={left:N,top:L,col:V,width:tt,height:_t},I=Math.max(I,tt),L+=_t+f}),T+=I,x.push({width:I,height:L}),T}adjustHitBoxes(){if(!this.options.display)return;const n=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:a},rtl:c}}=this,h=Tv(c,this.left,this.width);if(this.isHorizontal()){let f=0,b=qs(r,this.left+a,this.right-this.lineWidths[f]);for(const x of t)f!==x.row&&(f=x.row,b=qs(r,this.left+a,this.right-this.lineWidths[f])),x.top+=this.top+n+a,x.left=h.leftForLtr(h.x(b),x.width),b+=x.width+a}else{let f=0,b=qs(r,this.top+n+a,this.bottom-this.columnSizes[f].height);for(const x of t)x.col!==f&&(f=x.col,b=qs(r,this.top+n+a,this.bottom-this.columnSizes[f].height)),x.top=b,x.left+=this.left+a,x.left=h.leftForLtr(h.x(x.left),x.width),b+=x.height+a}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const n=this.ctx;lI(n,this),this._draw(),cI(n)}}_draw(){const{options:n,columnSizes:t,lineWidths:r,ctx:a}=this,{align:c,labels:h}=n,f=to.color,b=Tv(n.rtl,this.left,this.width),x=Uo(h.font),{padding:M}=h,T=x.size,I=T/2;let L;this.drawTitle(),a.textAlign=b.textAlign("left"),a.textBaseline="middle",a.lineWidth=.5,a.font=x.string;const{boxWidth:N,boxHeight:V,itemHeight:$}=wU(h,T),_t=this.isHorizontal(),wt=this._computeTitleHeight();L=_t?{x:qs(c,this.left+M,this.right-r[0]),y:this.top+M+wt,line:0}:{x:this.left+M,y:qs(c,this.top+wt+M,this.bottom-t[0].height),line:0},cj(this.ctx,n.textDirection);const Dt=$+M;this.legendItems.forEach((Vt,ae)=>{a.strokeStyle=Vt.fontColor,a.fillStyle=Vt.fontColor;const ee=a.measureText(Vt.text).width,Fe=b.textAlign(Vt.textAlign||(Vt.textAlign=h.textAlign)),Ai=N+I+ee;let Wi=L.x,dn=L.y;b.setWidth(this.width),_t?ae>0&&Wi+Ai+M>this.right&&(dn=L.y+=Dt,L.line++,Wi=L.x=qs(c,this.left+M,this.right-r[L.line])):ae>0&&dn+Dt>this.bottom&&(Wi=L.x=Wi+t[L.line].width+M,L.line++,dn=L.y=qs(c,this.top+wt+M,this.bottom-t[L.line].height)),function(Vt,ae,ee){if(isNaN(N)||N<=0||isNaN(V)||V<0)return;a.save();const Fe=cn(ee.lineWidth,1);if(a.fillStyle=cn(ee.fillStyle,f),a.lineCap=cn(ee.lineCap,"butt"),a.lineDashOffset=cn(ee.lineDashOffset,0),a.lineJoin=cn(ee.lineJoin,"miter"),a.lineWidth=Fe,a.strokeStyle=cn(ee.strokeStyle,f),a.setLineDash(cn(ee.lineDash,[])),h.usePointStyle){const Ai={radius:V*Math.SQRT2/2,pointStyle:ee.pointStyle,rotation:ee.rotation,borderWidth:Fe},Wi=b.xPlus(Vt,N/2);K5(a,Ai,Wi,ae+I,h.pointStyleWidth&&N)}else{const Ai=ae+Math.max((T-V)/2,0),Wi=b.leftForLtr(Vt,N),dn=a_(ee.borderRadius);a.beginPath(),Object.values(dn).some(zr=>0!==zr)?ZC(a,{x:Wi,y:Ai,w:N,h:V,radius:dn}):a.rect(Wi,Ai,N,V),a.fill(),0!==Fe&&a.stroke()}a.restore()}(b.x(Wi),dn,Vt),Wi=((e,n,t,r)=>e===(r?"left":"right")?t:"center"===e?(n+t)/2:n)(Fe,Wi+N+I,_t?Wi+Ai:this.right,n.rtl),function(Vt,ae,ee){s_(a,ee.text,Vt,ae+$/2,x,{strikethrough:ee.hidden,textAlign:b.textAlign(ee.textAlign)})}(b.x(Wi),dn,Vt),_t?L.x+=Ai+M:L.y+="string"!=typeof Vt.text?MU(Vt,x.lineHeight)+M:Dt}),dj(this.ctx,n.textDirection)}drawTitle(){const n=this.options,t=n.title,r=Uo(t.font),a=Ys(t.padding);if(!t.display)return;const c=Tv(n.rtl,this.left,this.width),h=this.ctx,f=t.position,x=a.top+r.size/2;let M,T=this.left,I=this.width;if(this.isHorizontal())I=Math.max(...this.lineWidths),M=this.top+x,T=qs(n.align,T,this.right-I);else{const N=this.columnSizes.reduce((V,$)=>Math.max(V,$.height),0);M=x+qs(n.align,this.top,this.bottom-N-n.labels.padding-this._computeTitleHeight())}const L=qs(f,T,T+I);h.textAlign=c.textAlign(EB(f)),h.textBaseline="middle",h.strokeStyle=t.color,h.fillStyle=t.color,h.font=r.string,s_(h,t.text,L,M,r)}_computeTitleHeight(){const n=this.options.title,t=Uo(n.font),r=Ys(n.padding);return n.display?t.lineHeight+r.height:0}_getLegendItemAt(n,t){let r,a,c;if(yh(n,this.left,this.right)&&yh(t,this.top,this.bottom))for(c=this.legendHitBoxes,r=0;r<c.length;++r)if(a=c[r],yh(n,a.left,a.left+a.width)&&yh(t,a.top,a.top+a.height))return this.legendItems[r];return null}handleEvent(n){const t=this.options;if(!function ZJ(e,n){return!(("mousemove"!==e&&"mouseout"!==e||!n.onHover&&!n.onLeave)&&(!n.onClick||"click"!==e&&"mouseup"!==e))}(n.type,t))return;const r=this._getLegendItemAt(n.x,n.y);if("mousemove"===n.type||"mouseout"===n.type){const a=this._hoveredItem,c=((e,n)=>null!==e&&null!==n&&e.datasetIndex===n.datasetIndex&&e.index===n.index)(a,r);a&&!c&&Sr(t.onLeave,[n,a,this],this),this._hoveredItem=r,r&&!c&&Sr(t.onHover,[n,r,this],this)}else r&&Sr(t.onClick,[n,r,this],this)}}function MU(e,n){return n*(e.text?e.text.length:0)}var XJ={id:"legend",_element:CU,start(e,n,t){const r=e.legend=new CU({ctx:e.ctx,options:t,chart:e});Zs.configure(e,r,t),Zs.addBox(e,r)},stop(e){Zs.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,n,t){const r=e.legend;Zs.configure(e,r,t),r.options=t},afterUpdate(e){const n=e.legend;n.buildLabels(),n.adjustHitBoxes()},afterEvent(e,n){n.replay||e.legend.handleEvent(n.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,n,t){const r=n.datasetIndex,a=t.chart;a.isDatasetVisible(r)?(a.hide(r),n.hidden=!0):(a.show(r),n.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const n=e.data.datasets,{labels:{usePointStyle:t,pointStyle:r,textAlign:a,color:c,useBorderRadius:h,borderRadius:f}}=e.legend.options;return e._getSortedDatasetMetas().map(b=>{const x=b.controller.getStyle(t?0:void 0),M=Ys(x.borderWidth);return{text:n[b.index].label,fillStyle:x.backgroundColor,fontColor:c,hidden:!b.visible,lineCap:x.borderCapStyle,lineDash:x.borderDash,lineDashOffset:x.borderDashOffset,lineJoin:x.borderJoinStyle,lineWidth:(M.width+M.height)/4,strokeStyle:x.borderColor,pointStyle:r||x.pointStyle,rotation:x.rotation,textAlign:a||x.textAlign,borderRadius:h&&(f||x.borderRadius),datasetIndex:b.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class rN extends Ch{constructor(n){super(),this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,t){const r=this.options;if(this.left=0,this.top=0,!r.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=n,this.height=this.bottom=t;const a=Fr(r.text)?r.text.length:1;this._padding=Ys(r.padding);const c=a*Uo(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=c:this.width=c}isHorizontal(){const n=this.options.position;return"top"===n||"bottom"===n}_drawArgs(n){const{top:t,left:r,bottom:a,right:c,options:h}=this,f=h.align;let x,M,T,b=0;return this.isHorizontal()?(M=qs(f,r,c),T=t+n,x=c-r):("left"===h.position?(M=r+n,T=qs(f,a,t),b=-.5*Lr):(M=c-n,T=qs(f,t,a),b=.5*Lr),x=a-t),{titleX:M,titleY:T,maxWidth:x,rotation:b}}draw(){const n=this.ctx,t=this.options;if(!t.display)return;const r=Uo(t.font),c=r.lineHeight/2+this._padding.top,{titleX:h,titleY:f,maxWidth:b,rotation:x}=this._drawArgs(c);s_(n,t.text,0,0,r,{color:t.color,maxWidth:b,rotation:x,textAlign:EB(t.align),textBaseline:"middle",translation:[h,f]})}}var QJ={id:"title",_element:rN,start(e,n,t){!function KJ(e,n){const t=new rN({ctx:e.ctx,options:n,chart:e});Zs.configure(e,t,n),Zs.addBox(e,t),e.titleBlock=t}(e,t)},stop(e){Zs.removeBox(e,e.titleBlock),delete e.titleBlock},beforeUpdate(e,n,t){const r=e.titleBlock;Zs.configure(e,r,t),r.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const DI=new WeakMap;var JJ={id:"subtitle",start(e,n,t){const r=new rN({ctx:e.ctx,options:t,chart:e});Zs.configure(e,r,t),Zs.addBox(e,r),DI.set(e,r)},stop(e){Zs.removeBox(e,DI.get(e)),DI.delete(e)},beforeUpdate(e,n,t){const r=DI.get(e);Zs.configure(e,r,t),r.options=t},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const oM={average(e){if(!e.length)return!1;let n,t,r=0,a=0,c=0;for(n=0,t=e.length;n<t;++n){const h=e[n].element;if(h&&h.hasValue()){const f=h.tooltipPosition();r+=f.x,a+=f.y,++c}}return{x:r/c,y:a/c}},nearest(e,n){if(!e.length)return!1;let c,h,f,t=n.x,r=n.y,a=Number.POSITIVE_INFINITY;for(c=0,h=e.length;c<h;++c){const b=e[c].element;if(b&&b.hasValue()){const M=SB(n,b.getCenterPoint());M<a&&(a=M,f=b)}}if(f){const b=f.tooltipPosition();t=b.x,r=b.y}return{x:t,y:r}}};function qd(e,n){return n&&(Fr(n)?Array.prototype.push.apply(e,n):e.push(n)),e}function Mh(e){return("string"==typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function ttt(e,n){const{element:t,datasetIndex:r,index:a}=n,c=e.getDatasetMeta(r).controller,{label:h,value:f}=c.getLabelAndValue(a);return{chart:e,label:h,parsed:c.getParsed(a),raw:e.data.datasets[r].data[a],formattedValue:f,dataset:c.getDataset(),dataIndex:a,datasetIndex:r,element:t}}function DU(e,n){const t=e.chart.ctx,{body:r,footer:a,title:c}=e,{boxWidth:h,boxHeight:f}=n,b=Uo(n.bodyFont),x=Uo(n.titleFont),M=Uo(n.footerFont),T=c.length,I=a.length,L=r.length,N=Ys(n.padding);let V=N.height,$=0,nt=r.reduce((wt,Dt)=>wt+Dt.before.length+Dt.lines.length+Dt.after.length,0);nt+=e.beforeBody.length+e.afterBody.length,T&&(V+=T*x.lineHeight+(T-1)*n.titleSpacing+n.titleMarginBottom),nt&&(V+=L*(n.displayColors?Math.max(f,b.lineHeight):b.lineHeight)+(nt-L)*b.lineHeight+(nt-1)*n.bodySpacing),I&&(V+=n.footerMarginTop+I*M.lineHeight+(I-1)*n.footerSpacing);let tt=0;const _t=function(wt){$=Math.max($,t.measureText(wt).width+tt)};return t.save(),t.font=x.string,ar(e.title,_t),t.font=b.string,ar(e.beforeBody.concat(e.afterBody),_t),tt=n.displayColors?h+2+n.boxPadding:0,ar(r,wt=>{ar(wt.before,_t),ar(wt.lines,_t),ar(wt.after,_t)}),tt=0,t.font=M.string,ar(e.footer,_t),t.restore(),$+=N.width,{width:$,height:V}}function ntt(e,n,t,r){const{x:a,width:c}=t,{width:h,chartArea:{left:f,right:b}}=e;let x="center";return"center"===r?x=a<=(f+b)/2?"left":"right":a<=c/2?x="left":a>=h-c/2&&(x="right"),function itt(e,n,t,r){const{x:a,width:c}=r,h=t.caretSize+t.caretPadding;if("left"===e&&a+c+h>n.width||"right"===e&&a-c-h<0)return!0}(x,e,n,t)&&(x="center"),x}function kU(e,n,t){const r=t.yAlign||n.yAlign||function ett(e,n){const{y:t,height:r}=n;return t<r/2?"top":t>e.height-r/2?"bottom":"center"}(e,t);return{xAlign:t.xAlign||n.xAlign||ntt(e,n,t,r),yAlign:r}}function SU(e,n,t,r){const{caretSize:a,caretPadding:c,cornerRadius:h}=e,{xAlign:f,yAlign:b}=t,x=a+c,{topLeft:M,topRight:T,bottomLeft:I,bottomRight:L}=a_(h);let N=function rtt(e,n){let{x:t,width:r}=e;return"right"===n?t-=r:"center"===n&&(t-=r/2),t}(n,f);const V=function ott(e,n,t){let{y:r,height:a}=e;return"top"===n?r+=t:r-="bottom"===n?a+t:a/2,r}(n,b,x);return"center"===b?"left"===f?N+=x:"right"===f&&(N-=x):"left"===f?N-=Math.max(M,I)+a:"right"===f&&(N+=Math.max(T,L)+a),{x:Qo(N,0,r.width-n.width),y:Qo(V,0,r.height-n.height)}}function kI(e,n,t){const r=Ys(t.padding);return"center"===n?e.x+e.width/2:"right"===n?e.x+e.width-r.right:e.x+r.left}function TU(e){return qd([],Mh(e))}function EU(e,n){const t=n&&n.dataset&&n.dataset.tooltip&&n.dataset.tooltip.callbacks;return t?e.override(t):e}const AU={beforeTitle:bh,title(e){if(e.length>0){const n=e[0],t=n.chart.data.labels,r=t?t.length:0;if(this&&this.options&&"dataset"===this.options.mode)return n.dataset.label||"";if(n.label)return n.label;if(r>0&&n.dataIndex<r)return t[n.dataIndex]}return""},afterTitle:bh,beforeBody:bh,beforeLabel:bh,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let n=e.dataset.label||"";n&&(n+=": ");const t=e.formattedValue;return Vn(t)||(n+=t),n},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:bh,afterBody:bh,beforeFooter:bh,footer:bh,afterFooter:bh};function Ba(e,n,t,r){const a=e[n].call(t,r);return typeof a>"u"?AU[n].call(t,r):a}let IU=(()=>class e extends Ch{static positioners=oM;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const r=this.chart,a=this.options.setContext(this.getContext()),c=a.enabled&&r.options.animation&&a.animations,h=new bj(this.chart,c);return c._cacheable&&(this._cachedAnimations=Object.freeze(h)),h}getContext(){return this.$context||(this.$context=function stt(e,n,t){return Rp(e,{tooltip:n,tooltipItems:t,type:"tooltip"})}(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,r){const{callbacks:a}=r,c=Ba(a,"beforeTitle",this,t),h=Ba(a,"title",this,t),f=Ba(a,"afterTitle",this,t);let b=[];return b=qd(b,Mh(c)),b=qd(b,Mh(h)),b=qd(b,Mh(f)),b}getBeforeBody(t,r){return TU(Ba(r.callbacks,"beforeBody",this,t))}getBody(t,r){const{callbacks:a}=r,c=[];return ar(t,h=>{const f={before:[],lines:[],after:[]},b=EU(a,h);qd(f.before,Mh(Ba(b,"beforeLabel",this,h))),qd(f.lines,Ba(b,"label",this,h)),qd(f.after,Mh(Ba(b,"afterLabel",this,h))),c.push(f)}),c}getAfterBody(t,r){return TU(Ba(r.callbacks,"afterBody",this,t))}getFooter(t,r){const{callbacks:a}=r,c=Ba(a,"beforeFooter",this,t),h=Ba(a,"footer",this,t),f=Ba(a,"afterFooter",this,t);let b=[];return b=qd(b,Mh(c)),b=qd(b,Mh(h)),b=qd(b,Mh(f)),b}_createItems(t){const r=this._active,a=this.chart.data,c=[],h=[],f=[];let x,M,b=[];for(x=0,M=r.length;x<M;++x)b.push(ttt(this.chart,r[x]));return t.filter&&(b=b.filter((T,I,L)=>t.filter(T,I,L,a))),t.itemSort&&(b=b.sort((T,I)=>t.itemSort(T,I,a))),ar(b,T=>{const I=EU(t.callbacks,T);c.push(Ba(I,"labelColor",this,T)),h.push(Ba(I,"labelPointStyle",this,T)),f.push(Ba(I,"labelTextColor",this,T))}),this.labelColors=c,this.labelPointStyles=h,this.labelTextColors=f,this.dataPoints=b,b}update(t,r){const a=this.options.setContext(this.getContext()),c=this._active;let h,f=[];if(c.length){const b=oM[a.position].call(this,c,this._eventPosition);f=this._createItems(a),this.title=this.getTitle(f,a),this.beforeBody=this.getBeforeBody(f,a),this.body=this.getBody(f,a),this.afterBody=this.getAfterBody(f,a),this.footer=this.getFooter(f,a);const x=this._size=DU(this,a),M=Object.assign({},b,x),T=kU(this.chart,a,M),I=SU(a,M,T,this.chart);this.xAlign=T.xAlign,this.yAlign=T.yAlign,h={opacity:1,x:I.x,y:I.y,width:x.width,height:x.height,caretX:b.x,caretY:b.y}}else 0!==this.opacity&&(h={opacity:0});this._tooltipItems=f,this.$context=void 0,h&&this._resolveAnimations().update(this,h),t&&a.external&&a.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(t,r,a,c){const h=this.getCaretPosition(t,a,c);r.lineTo(h.x1,h.y1),r.lineTo(h.x2,h.y2),r.lineTo(h.x3,h.y3)}getCaretPosition(t,r,a){const{xAlign:c,yAlign:h}=this,{caretSize:f,cornerRadius:b}=a,{topLeft:x,topRight:M,bottomLeft:T,bottomRight:I}=a_(b),{x:L,y:N}=t,{width:V,height:$}=r;let nt,tt,_t,wt,Dt,Vt;return"center"===h?(Dt=N+$/2,"left"===c?(nt=L,tt=nt-f,wt=Dt+f,Vt=Dt-f):(nt=L+V,tt=nt+f,wt=Dt-f,Vt=Dt+f),_t=nt):(tt="left"===c?L+Math.max(x,T)+f:"right"===c?L+V-Math.max(M,I)-f:this.caretX,"top"===h?(wt=N,Dt=wt-f,nt=tt-f,_t=tt+f):(wt=N+$,Dt=wt+f,nt=tt+f,_t=tt-f),Vt=wt),{x1:nt,x2:tt,x3:_t,y1:wt,y2:Dt,y3:Vt}}drawTitle(t,r,a){const c=this.title,h=c.length;let f,b,x;if(h){const M=Tv(a.rtl,this.x,this.width);for(t.x=kI(this,a.titleAlign,a),r.textAlign=M.textAlign(a.titleAlign),r.textBaseline="middle",f=Uo(a.titleFont),b=a.titleSpacing,r.fillStyle=a.titleColor,r.font=f.string,x=0;x<h;++x)r.fillText(c[x],M.x(t.x),t.y+f.lineHeight/2),t.y+=f.lineHeight+b,x+1===h&&(t.y+=a.titleMarginBottom-b)}}_drawColorBox(t,r,a,c,h){const f=this.labelColors[a],b=this.labelPointStyles[a],{boxHeight:x,boxWidth:M}=h,T=Uo(h.bodyFont),I=kI(this,"left",h),L=c.x(I),V=r.y+(x<T.lineHeight?(T.lineHeight-x)/2:0);if(h.usePointStyle){const $={radius:Math.min(M,x)/2,pointStyle:b.pointStyle,rotation:b.rotation,borderWidth:1},nt=c.leftForLtr(L,M)+M/2,tt=V+x/2;t.strokeStyle=h.multiKeyBackground,t.fillStyle=h.multiKeyBackground,OB(t,$,nt,tt),t.strokeStyle=f.borderColor,t.fillStyle=f.backgroundColor,OB(t,$,nt,tt)}else{t.lineWidth=Sn(f.borderWidth)?Math.max(...Object.values(f.borderWidth)):f.borderWidth||1,t.strokeStyle=f.borderColor,t.setLineDash(f.borderDash||[]),t.lineDashOffset=f.borderDashOffset||0;const $=c.leftForLtr(L,M),nt=c.leftForLtr(c.xPlus(L,1),M-2),tt=a_(f.borderRadius);Object.values(tt).some(_t=>0!==_t)?(t.beginPath(),t.fillStyle=h.multiKeyBackground,ZC(t,{x:$,y:V,w:M,h:x,radius:tt}),t.fill(),t.stroke(),t.fillStyle=f.backgroundColor,t.beginPath(),ZC(t,{x:nt,y:V+1,w:M-2,h:x-2,radius:tt}),t.fill()):(t.fillStyle=h.multiKeyBackground,t.fillRect($,V,M,x),t.strokeRect($,V,M,x),t.fillStyle=f.backgroundColor,t.fillRect(nt,V+1,M-2,x-2))}t.fillStyle=this.labelTextColors[a]}drawBody(t,r,a){const{body:c}=this,{bodySpacing:h,bodyAlign:f,displayColors:b,boxHeight:x,boxWidth:M,boxPadding:T}=a,I=Uo(a.bodyFont);let L=I.lineHeight,N=0;const V=Tv(a.rtl,this.x,this.width),$=function(Fe){r.fillText(Fe,V.x(t.x+N),t.y+L/2),t.y+=L+h},nt=V.textAlign(f);let tt,_t,wt,Dt,Vt,ae,ee;for(r.textAlign=f,r.textBaseline="middle",r.font=I.string,t.x=kI(this,nt,a),r.fillStyle=a.bodyColor,ar(this.beforeBody,$),N=b&&"right"!==nt?"center"===f?M/2+T:M+2+T:0,Dt=0,ae=c.length;Dt<ae;++Dt){for(tt=c[Dt],_t=this.labelTextColors[Dt],r.fillStyle=_t,ar(tt.before,$),wt=tt.lines,b&&wt.length&&(this._drawColorBox(r,t,Dt,V,a),L=Math.max(I.lineHeight,x)),Vt=0,ee=wt.length;Vt<ee;++Vt)$(wt[Vt]),L=I.lineHeight;ar(tt.after,$)}N=0,L=I.lineHeight,ar(this.afterBody,$),t.y-=h}drawFooter(t,r,a){const c=this.footer,h=c.length;let f,b;if(h){const x=Tv(a.rtl,this.x,this.width);for(t.x=kI(this,a.footerAlign,a),t.y+=a.footerMarginTop,r.textAlign=x.textAlign(a.footerAlign),r.textBaseline="middle",f=Uo(a.footerFont),r.fillStyle=a.footerColor,r.font=f.string,b=0;b<h;++b)r.fillText(c[b],x.x(t.x),t.y+f.lineHeight/2),t.y+=f.lineHeight+a.footerSpacing}}drawBackground(t,r,a,c){const{xAlign:h,yAlign:f}=this,{x:b,y:x}=t,{width:M,height:T}=a,{topLeft:I,topRight:L,bottomLeft:N,bottomRight:V}=a_(c.cornerRadius);r.fillStyle=c.backgroundColor,r.strokeStyle=c.borderColor,r.lineWidth=c.borderWidth,r.beginPath(),r.moveTo(b+I,x),"top"===f&&this.drawCaret(t,r,a,c),r.lineTo(b+M-L,x),r.quadraticCurveTo(b+M,x,b+M,x+L),"center"===f&&"right"===h&&this.drawCaret(t,r,a,c),r.lineTo(b+M,x+T-V),r.quadraticCurveTo(b+M,x+T,b+M-V,x+T),"bottom"===f&&this.drawCaret(t,r,a,c),r.lineTo(b+N,x+T),r.quadraticCurveTo(b,x+T,b,x+T-N),"center"===f&&"left"===h&&this.drawCaret(t,r,a,c),r.lineTo(b,x+I),r.quadraticCurveTo(b,x,b+I,x),r.closePath(),r.fill(),c.borderWidth>0&&r.stroke()}_updateAnimationTarget(t){const r=this.chart,a=this.$animations,c=a&&a.x,h=a&&a.y;if(c||h){const f=oM[t.position].call(this,this._active,this._eventPosition);if(!f)return;const b=this._size=DU(this,t),x=Object.assign({},f,this._size),M=kU(r,t,x),T=SU(t,x,M,r);(c._to!==T.x||h._to!==T.y)&&(this.xAlign=M.xAlign,this.yAlign=M.yAlign,this.width=b.width,this.height=b.height,this.caretX=f.x,this.caretY=f.y,this._resolveAnimations().update(this,T))}}_willRender(){return!!this.opacity}draw(t){const r=this.options.setContext(this.getContext());let a=this.opacity;if(!a)return;this._updateAnimationTarget(r);const c={width:this.width,height:this.height},h={x:this.x,y:this.y};a=Math.abs(a)<.001?0:a;const f=Ys(r.padding);r.enabled&&(this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length)&&(t.save(),t.globalAlpha=a,this.drawBackground(h,t,c,r),cj(t,r.textDirection),h.y+=f.top,this.drawTitle(h,t,r),this.drawBody(h,t,r),this.drawFooter(h,t,r),dj(t,r.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,r){const a=this._active,c=t.map(({datasetIndex:b,index:x})=>{const M=this.chart.getDatasetMeta(b);if(!M)throw new Error("Cannot find a dataset at index "+b);return{datasetIndex:b,element:M.data[x],index:x}}),h=!iI(a,c),f=this._positionChanged(c,r);(h||f)&&(this._active=c,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,r,a=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const c=this.options,h=this._active||[],f=this._getActiveElements(t,h,r,a),b=this._positionChanged(f,t),x=r||!iI(f,h)||b;return x&&(this._active=f,(c.enabled||c.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,r))),x}_getActiveElements(t,r,a,c){const h=this.options;if("mouseout"===t.type)return[];if(!c)return r.filter(b=>this.chart.data.datasets[b.datasetIndex]&&void 0!==this.chart.getDatasetMeta(b.datasetIndex).controller.getParsed(b.index));const f=this.chart.getElementsAtEventForMode(t,h.mode,h,a);return h.reverse&&f.reverse(),f}_positionChanged(t,r){const{caretX:a,caretY:c,options:h}=this,f=oM[h.position].call(this,t,r);return!1!==f&&(a!==f.x||c!==f.y)}})();var att={id:"tooltip",_element:IU,positioners:oM,afterInit(e,n,t){t&&(e.tooltip=new IU({chart:e,options:t}))},beforeUpdate(e,n,t){e.tooltip&&e.tooltip.initialize(t)},reset(e,n,t){e.tooltip&&e.tooltip.initialize(t)},afterDraw(e){const n=e.tooltip;if(n&&n._willRender()){const t={tooltip:n};if(!1===e.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0}))return;n.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",t)}},afterEvent(e,n){e.tooltip&&e.tooltip.handleEvent(n.event,n.replay,n.inChartArea)&&(n.changed=!0)},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,n)=>n.bodyFont.size,boxWidth:(e,n)=>n.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:AU},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},ltt=Object.freeze({__proto__:null,Colors:vJ,Decimation:MJ,Filler:$J,Legend:XJ,SubTitle:JJ,Title:QJ,Tooltip:att});function RU(e){const n=this.getLabels();return e>=0&&e<n.length?n[e]:e}let htt=(()=>class e extends h_{static id="category";static defaults={ticks:{callback:RU}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const r=this._addedLabels;if(r.length){const a=this.getLabels();for(const{index:c,label:h}of r)a[c]===h&&a.splice(c,1);this._addedLabels=[]}super.init(t)}parse(t,r){if(Vn(t))return null;const a=this.getLabels();return((e,n)=>null===e?null:Qo(Math.round(e),0,n))(r=isFinite(r)&&a[r]===t?r:function dtt(e,n,t,r){const a=e.indexOf(n);return-1===a?((e,n,t,r)=>("string"==typeof n?(t=e.push(n)-1,r.unshift({index:t,label:n})):isNaN(n)&&(t=null),t))(e,n,t,r):a!==e.lastIndexOf(n)?t:a}(a,t,cn(r,t),this._addedLabels),a.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:a,max:c}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(a=0),r||(c=this.getLabels().length-1)),this.min=a,this.max=c}buildTicks(){const t=this.min,r=this.max,a=this.options.offset,c=[];let h=this.getLabels();h=0===t&&r===h.length-1?h:h.slice(t,r+1),this._valueRange=Math.max(h.length-(a?0:1),1),this._startValue=this.min-(a?.5:0);for(let f=t;f<=r;f++)c.push({value:f});return c}getLabelForValue(t){return RU.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!=typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const r=this.ticks;return t<0||t>r.length-1?null:this.getPixelForValue(r[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}})();function PU(e,n,{horizontal:t,minRotation:r}){const a=Yc(r),c=(t?Math.sin(a):Math.cos(a))||.001;return Math.min(n/c,.75*n*(""+e).length)}class SI extends h_{constructor(n){super(n),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(n,t){return Vn(n)||("number"==typeof n||n instanceof Number)&&!isFinite(+n)?null:+n}handleTickRangeOptions(){const{beginAtZero:n}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:a,max:c}=this;const h=b=>a=t?a:b,f=b=>c=r?c:b;if(n){const b=Gd(a),x=Gd(c);b<0&&x<0?f(0):b>0&&x>0&&h(0)}if(a===c){let b=0===c?1:Math.abs(.05*c);f(c+b),n||h(a-b)}this.min=a,this.max=c}getTickLimit(){const n=this.options.ticks;let a,{maxTicksLimit:t,stepSize:r}=n;return r?(a=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,a>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${a} ticks. Limiting to 1000.`),a=1e3)):(a=this.computeTickLimit(),t=t||11),t&&(a=Math.min(t,a)),a}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const n=this.options,t=n.ticks;let r=this.getTickLimit();r=Math.max(2,r);const h=function mtt(e,n){const t=[],{bounds:a,step:c,min:h,max:f,precision:b,count:x,maxTicks:M,maxDigits:T,includeBounds:I}=e,L=c||1,N=M-1,{min:V,max:$}=n,nt=!Vn(h),tt=!Vn(f),_t=!Vn(x),wt=($-V)/(T+1);let Vt,ae,ee,Fe,Dt=O5(($-V)/N/L)*L;if(Dt<1e-14&&!nt&&!tt)return[{value:V},{value:$}];Fe=Math.ceil($/Dt)-Math.floor(V/Dt),Fe>N&&(Dt=O5(Fe*Dt/N/L)*L),Vn(b)||(Vt=Math.pow(10,b),Dt=Math.ceil(Dt*Vt)/Vt),"ticks"===a?(ae=Math.floor(V/Dt)*Dt,ee=Math.ceil($/Dt)*Dt):(ae=V,ee=$),nt&&tt&&c&&function tX(e,n){const t=Math.round(e);return t-n<=e&&t+n>=e}((f-h)/c,Dt/1e3)?(Fe=Math.round(Math.min((f-h)/Dt,M)),Dt=(f-h)/Fe,ae=h,ee=f):_t?(ae=nt?h:ae,ee=tt?f:ee,Fe=x-1,Dt=(ee-ae)/Fe):(Fe=(ee-ae)/Dt,Fe=$C(Fe,Math.round(Fe),Dt/1e3)?Math.round(Fe):Math.ceil(Fe));const Ai=Math.max(L5(Dt),L5(ae));Vt=Math.pow(10,Vn(b)?Ai:b),ae=Math.round(ae*Vt)/Vt,ee=Math.round(ee*Vt)/Vt;let Wi=0;for(nt&&(I&&ae!==h?(t.push({value:h}),ae<h&&Wi++,$C(Math.round((ae+Wi*Dt)*Vt)/Vt,h,PU(h,wt,e))&&Wi++):ae<h&&Wi++);Wi<Fe;++Wi){const dn=Math.round((ae+Wi*Dt)*Vt)/Vt;if(tt&&dn>f)break;t.push({value:dn})}return tt&&I&&ee!==f?t.length&&$C(t[t.length-1].value,f,PU(f,wt,e))?t[t.length-1].value=f:t.push({value:f}):(!tt||ee===f)&&t.push({value:ee}),t}({maxTicks:r,bounds:n.bounds,min:n.min,max:n.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===n.bounds&&F5(h,this,"value"),n.reverse?(h.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),h}configure(){const n=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&n.length){const a=(r-t)/Math.max(n.length-1,1)/2;t-=a,r+=a}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(n){return qC(n,this.chart.options.locale,this.options.ticks.format)}}const sM=e=>Math.floor(Ip(e)),m_=(e,n)=>Math.pow(10,sM(e)+n);function OU(e){return e/Math.pow(10,sM(e))==1}function FU(e,n,t){const r=Math.pow(10,t),a=Math.floor(e/r);return Math.ceil(n/r)-a}function oN(e){const n=e.ticks;if(n.display&&e.display){const t=Ys(n.backdropPadding);return cn(n.font&&n.font.size,to.font.size)+t.height}return 0}function btt(e,n,t){return t=Fr(t)?t:[t],{w:_X(e,n.string,t),h:t.length*n.lineHeight}}function LU(e,n,t,r,a){return e===r||e===a?{start:n-t/2,end:n+t/2}:e<r||e>a?{start:n-t,end:n}:{start:n,end:n+t}}function vtt(e,n,t,r,a){const c=Math.abs(Math.sin(t)),h=Math.abs(Math.cos(t));let f=0,b=0;r.start<n.l?(f=(n.l-r.start)/c,e.l=Math.min(e.l,n.l-f)):r.end>n.r&&(f=(r.end-n.r)/c,e.r=Math.max(e.r,n.r+f)),a.start<n.t?(b=(n.t-a.start)/h,e.t=Math.min(e.t,n.t-b)):a.end>n.b&&(b=(a.end-n.b)/h,e.b=Math.max(e.b,n.b+b))}function xtt(e,n,t){const r=e.drawingArea,{extra:a,additionalAngle:c,padding:h,size:f}=t,b=e.getPointPosition(n,r+a+h,c),x=Math.round(kB(yl(b.angle+Mo))),M=function ktt(e,n,t){return 90===t||270===t?e-=n/2:(t>270||t<90)&&(e-=n),e}(b.y,f.h,x),T=function Mtt(e){return 0===e||180===e?"center":e<180?"left":"right"}(x),I=function Dtt(e,n,t){return"right"===t?e-=n:"center"===t&&(e-=n/2),e}(b.x,f.w,T);return{visible:!0,x:b.x,y:M,textAlign:T,left:I,top:M,right:I+f.w,bottom:M+f.h}}function wtt(e,n){if(!n)return!0;const{left:t,top:r,right:a,bottom:c}=e;return!(xh({x:t,y:r},n)||xh({x:t,y:c},n)||xh({x:a,y:r},n)||xh({x:a,y:c},n))}function Stt(e,n,t){const{left:r,top:a,right:c,bottom:h}=t,{backdropColor:f}=n;if(!Vn(f)){const b=a_(n.borderRadius),x=Ys(n.backdropPadding);e.fillStyle=f;const M=r-x.left,T=a-x.top,I=c-r+x.width,L=h-a+x.height;Object.values(b).some(N=>0!==N)?(e.beginPath(),ZC(e,{x:M,y:T,w:I,h:L,radius:b}),e.fill()):e.fillRect(M,T,I,L)}}function BU(e,n,t,r){const{ctx:a}=e;if(t)a.arc(e.xCenter,e.yCenter,n,0,Br);else{let c=e.getPointPosition(0,n);a.moveTo(c.x,c.y);for(let h=1;h<r;h++)c=e.getPointPosition(h,n),a.lineTo(c.x,c.y)}}const TI={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Na=Object.keys(TI);function NU(e,n){return e-n}function zU(e,n){if(Vn(n))return null;const t=e._adapter,{parser:r,round:a,isoWeekday:c}=e._parseOpts;let h=n;return"function"==typeof r&&(h=r(h)),uo(h)||(h="string"==typeof r?t.parse(h,r):t.parse(h)),null===h?null:(a&&(h="week"!==a||!Dv(c)&&!0!==c?t.startOf(h,a):t.startOf(h,"isoWeek",c)),+h)}function VU(e,n,t,r){const a=Na.length;for(let c=Na.indexOf(e);c<a-1;++c){const h=TI[Na[c]];if(h.common&&Math.ceil((t-n)/((h.steps?h.steps:Number.MAX_SAFE_INTEGER)*h.size))<=r)return Na[c]}return Na[a-1]}function jU(e,n,t){if(t){if(t.length){const{lo:r,hi:a}=TB(t,n);e[t[r]>=n?t[r]:t[a]]=!0}}else e[n]=!0}function UU(e,n,t){const r=[],a={},c=n.length;let h,f;for(h=0;h<c;++h)f=n[h],a[f]=h,r.push({value:f,major:!1});return 0!==c&&t?function Ott(e,n,t,r){const a=e._adapter,c=+a.startOf(n[0].value,r),h=n[n.length-1].value;let f,b;for(f=c;f<=h;f=+a.add(f,1,r))b=t[f],b>=0&&(n[b].major=!0);return n}(e,r,a,t):r}let sN=(()=>class e extends h_{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,r={}){const a=t.time||(t.time={}),c=this._adapter=new LK__date(t.adapters.date);c.init(r),UC(a.displayFormats,c.formats()),this._parseOpts={parser:a.parser,round:a.round,isoWeekday:a.isoWeekday},super.init(t),this._normalized=r.normalized}parse(t,r){return void 0===t?null:zU(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,r=this._adapter,a=t.time.unit||"day";let{min:c,max:h,minDefined:f,maxDefined:b}=this.getUserBounds();function x(M){!f&&!isNaN(M.min)&&(c=Math.min(c,M.min)),!b&&!isNaN(M.max)&&(h=Math.max(h,M.max))}(!f||!b)&&(x(this._getLabelBounds()),("ticks"!==t.bounds||"labels"!==t.ticks.source)&&x(this.getMinMax(!1))),c=uo(c)&&!isNaN(c)?c:+r.startOf(Date.now(),a),h=uo(h)&&!isNaN(h)?h:+r.endOf(Date.now(),a)+1,this.min=Math.min(c,h-1),this.max=Math.max(c+1,h)}_getLabelBounds(){const t=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;return t.length&&(r=t[0],a=t[t.length-1]),{min:r,max:a}}buildTicks(){const t=this.options,r=t.time,a=t.ticks,c="labels"===a.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&c.length&&(this.min=this._userMin||c[0],this.max=this._userMax||c[c.length-1]);const h=this.min,b=function rX(e,n,t){let r=0,a=e.length;for(;r<a&&e[r]<n;)r++;for(;a>r&&e[a-1]>t;)a--;return r>0||a<e.length?e.slice(r,a):e}(c,h,this.max);return this._unit=r.unit||(a.autoSkip?VU(r.minUnit,this.min,this.max,this._getLabelCapacity(h)):function Rtt(e,n,t,r,a){for(let c=Na.length-1;c>=Na.indexOf(t);c--){const h=Na[c];if(TI[h].common&&e._adapter.diff(a,r,h)>=n-1)return h}return Na[t?Na.indexOf(t):0]}(this,b.length,r.minUnit,this.min,this.max)),this._majorUnit=a.major.enabled&&"year"!==this._unit?function Ptt(e){for(let n=Na.indexOf(e)+1,t=Na.length;n<t;++n)if(TI[Na[n]].common)return Na[n]}(this._unit):void 0,this.initOffsets(c),t.reverse&&b.reverse(),UU(this,b,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let c,h,r=0,a=0;this.options.offset&&t.length&&(c=this.getDecimalForValue(t[0]),r=1===t.length?1-c:(this.getDecimalForValue(t[1])-c)/2,h=this.getDecimalForValue(t[t.length-1]),a=1===t.length?h:(h-this.getDecimalForValue(t[t.length-2]))/2);const f=t.length<3?.5:.25;r=Qo(r,0,f),a=Qo(a,0,f),this._offsets={start:r,end:a,factor:1/(r+1+a)}}_generate(){const t=this._adapter,r=this.min,a=this.max,c=this.options,h=c.time,f=h.unit||VU(h.minUnit,r,a,this._getLabelCapacity(r)),b=cn(c.ticks.stepSize,1),x="week"===f&&h.isoWeekday,M=Dv(x)||!0===x,T={};let L,N,I=r;if(M&&(I=+t.startOf(I,"isoWeek",x)),I=+t.startOf(I,M?"day":f),t.diff(a,r,f)>1e5*b)throw new Error(r+" and "+a+" are too far apart with stepSize of "+b+" "+f);const V="data"===c.ticks.source&&this.getDataTimestamps();for(L=I,N=0;L<a;L=+t.add(L,b,f),N++)jU(T,L,V);return(L===a||"ticks"===c.bounds||1===N)&&jU(T,L,V),Object.keys(T).sort(NU).map($=>+$)}getLabelForValue(t){const a=this.options.time;return this._adapter.format(t,a.tooltipFormat?a.tooltipFormat:a.displayFormats.datetime)}format(t,r){return this._adapter.format(t,r||this.options.time.displayFormats[this._unit])}_tickFormatFunction(t,r,a,c){const h=this.options,f=h.ticks.callback;if(f)return Sr(f,[t,r,a],this);const b=h.time.displayFormats,x=this._unit,M=this._majorUnit,I=M&&b[M],L=a[r];return this._adapter.format(t,c||(M&&I&&L&&L.major?I:x&&b[x]))}generateTickLabels(t){let r,a,c;for(r=0,a=t.length;r<a;++r)c=t[r],c.label=this._tickFormatFunction(c.value,r,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const r=this._offsets,a=this.getDecimalForValue(t);return this.getPixelForDecimal((r.start+a)*r.factor)}getValueForPixel(t){const r=this._offsets,a=this.getDecimalForPixel(t)/r.factor-r.end;return this.min+a*(this.max-this.min)}_getLabelSize(t){const r=this.options.ticks,a=this.ctx.measureText(t).width,c=Yc(this.isHorizontal()?r.maxRotation:r.minRotation),h=Math.cos(c),f=Math.sin(c),b=this._resolveTickFontOptions(0).size;return{w:a*h+b*f,h:a*f+b*h}}_getLabelCapacity(t){const r=this.options.time,a=r.displayFormats,c=a[r.unit]||a.millisecond,h=this._tickFormatFunction(t,0,UU(this,[t],this._majorUnit),c),f=this._getLabelSize(h),b=Math.floor(this.isHorizontal()?this.width/f.w:this.height/f.h)-1;return b>0?b:1}getDataTimestamps(){let r,a,t=this._cache.data||[];if(t.length)return t;const c=this.getMatchingVisibleMetas();if(this._normalized&&c.length)return this._cache.data=c[0].controller.getAllParsedValues(this);for(r=0,a=c.length;r<a;++r)t=t.concat(c[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let r,a;if(t.length)return t;const c=this.getLabels();for(r=0,a=c.length;r<a;++r)t.push(zU(this,c[r]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return V5(t.sort(NU))}})();function EI(e,n,t){let c,h,f,b,r=0,a=e.length-1;t?(n>=e[r].pos&&n<=e[a].pos&&({lo:r,hi:a}=vh(e,"pos",n)),({pos:c,time:f}=e[r]),({pos:h,time:b}=e[a])):(n>=e[r].time&&n<=e[a].time&&({lo:r,hi:a}=vh(e,"time",n)),({time:c,pos:f}=e[r]),({time:h,pos:b}=e[a]));const x=h-c;return x?f+(b-f)*(n-c)/x:f}var Ltt=Object.freeze({__proto__:null,CategoryScale:htt,LinearScale:class ptt extends SI{static id="linear";static defaults={ticks:{callback:sI.formatters.numeric}};determineDataLimits(){const{min:n,max:t}=this.getMinMax(!0);this.min=uo(n)?n:0,this.max=uo(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const n=this.isHorizontal(),t=n?this.width:this.height,r=Yc(this.options.ticks.minRotation),a=(n?Math.sin(r):Math.cos(r))||.001,c=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,c.lineHeight/a))}getPixelForValue(n){return null===n?NaN:this.getPixelForDecimal((n-this._startValue)/this._valueRange)}getValueForPixel(n){return this._startValue+this.getDecimalForPixel(n)*this._valueRange}},LogarithmicScale:class _tt extends h_{static id="logarithmic";static defaults={ticks:{callback:sI.formatters.logarithmic,major:{enabled:!0}}};constructor(n){super(n),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(n,t){const r=SI.prototype.parse.apply(this,[n,t]);if(0!==r)return uo(r)&&r>0?r:null;this._zero=!0}determineDataLimits(){const{min:n,max:t}=this.getMinMax(!0);this.min=uo(n)?Math.max(0,n):null,this.max=uo(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!uo(this._userMin)&&(this.min=n===m_(this.min,0)?m_(this.min,-1):m_(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:n,maxDefined:t}=this.getUserBounds();let r=this.min,a=this.max;const c=f=>r=n?r:f,h=f=>a=t?a:f;r===a&&(r<=0?(c(1),h(10)):(c(m_(r,-1)),h(m_(a,1)))),r<=0&&c(m_(a,-1)),a<=0&&h(m_(r,1)),this.min=r,this.max=a}buildTicks(){const n=this.options,r=function gtt(e,{min:n,max:t}){n=bl(e.min,n);const r=[],a=sM(n);let c=function ftt(e,n){let r=sM(n-e);for(;FU(e,n,r)>10;)r++;for(;FU(e,n,r)<10;)r--;return Math.min(r,sM(e))}(n,t),h=c<0?Math.pow(10,Math.abs(c)):1;const f=Math.pow(10,c),b=a>c?Math.pow(10,a):0,x=Math.round((n-b)*h)/h,M=Math.floor((n-b)/f/10)*f*10;let T=Math.floor((x-M)/Math.pow(10,c)),I=bl(e.min,Math.round((b+M+T*Math.pow(10,c))*h)/h);for(;I<t;)r.push({value:I,major:OU(I),significand:T}),T>=10?T=T<15?15:20:T++,T>=20&&(c++,T=2,h=c>=0?1:h),I=Math.round((b+M+T*Math.pow(10,c))*h)/h;const L=bl(e.max,I);return r.push({value:L,major:OU(L),significand:T}),r}({min:this._userMin,max:this._userMax},this);return"ticks"===n.bounds&&F5(r,this,"value"),n.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}getLabelForValue(n){return void 0===n?"0":qC(n,this.chart.options.locale,this.options.ticks.format)}configure(){const n=this.min;super.configure(),this._startValue=Ip(n),this._valueRange=Ip(this.max)-Ip(n)}getPixelForValue(n){return(void 0===n||0===n)&&(n=this.min),null===n||isNaN(n)?NaN:this.getPixelForDecimal(n===this.min?0:(Ip(n)-this._startValue)/this._valueRange)}getValueForPixel(n){const t=this.getDecimalForPixel(n);return Math.pow(10,this._startValue+t*this._valueRange)}},RadialLinearScale:class Itt extends SI{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:sI.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:n=>n,padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(n){super(n),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const n=this._padding=Ys(oN(this.options)/2),t=this.width=this.maxWidth-n.width,r=this.height=this.maxHeight-n.height;this.xCenter=Math.floor(this.left+t/2+n.left),this.yCenter=Math.floor(this.top+r/2+n.top),this.drawingArea=Math.floor(Math.min(t,r)/2)}determineDataLimits(){const{min:n,max:t}=this.getMinMax(!1);this.min=uo(n)&&!isNaN(n)?n:0,this.max=uo(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/oN(this.options))}generateTickLabels(n){SI.prototype.generateTickLabels.call(this,n),this._pointLabels=this.getLabels().map((t,r)=>{const a=Sr(this.options.pointLabels.callback,[t,r],this);return a||0===a?a:""}).filter((t,r)=>this.chart.getDataVisibility(r))}fit(){const n=this.options;n.display&&n.pointLabels.display?function ytt(e){const n={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},t=Object.assign({},n),r=[],a=[],c=e._pointLabels.length,h=e.options.pointLabels,f=h.centerPointLabels?Lr/c:0;for(let b=0;b<c;b++){const x=h.setContext(e.getPointLabelContext(b));a[b]=x.padding;const M=e.getPointPosition(b,e.drawingArea+a[b],f),T=Uo(x.font),I=btt(e.ctx,T,e._pointLabels[b]);r[b]=I;const L=yl(e.getIndexAngle(b)+f),N=Math.round(kB(L));vtt(t,n,L,LU(N,M.x,I.w,0,180),LU(N,M.y,I.h,90,270))}e.setCenterPoint(n.l-t.l,t.r-n.r,n.t-t.t,t.b-n.b),e._pointLabelItems=function Ctt(e,n,t){const r=[],a=e._pointLabels.length,c=e.options,{centerPointLabels:h,display:f}=c.pointLabels,b={extra:oN(c)/2,additionalAngle:h?Lr/a:0};let x;for(let M=0;M<a;M++){b.padding=t[M],b.size=n[M];const T=xtt(e,M,b);r.push(T),"auto"===f&&(T.visible=wtt(T,x),T.visible&&(x=T))}return r}(e,r,a)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(n,t,r,a){this.xCenter+=Math.floor((n-t)/2),this.yCenter+=Math.floor((r-a)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(n,t,r,a))}getIndexAngle(n){return yl(n*(Br/(this._pointLabels.length||1))+Yc(this.options.startAngle||0))}getDistanceFromCenterForValue(n){if(Vn(n))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-n)*t:(n-this.min)*t}getValueForDistanceFromCenter(n){if(Vn(n))return NaN;const t=n/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(n){const t=this._pointLabels||[];if(n>=0&&n<t.length){const r=t[n];return function Att(e,n,t){return Rp(e,{label:t,index:n,type:"pointLabel"})}(this.getContext(),n,r)}}getPointPosition(n,t,r=0){const a=this.getIndexAngle(n)-Mo+r;return{x:Math.cos(a)*t+this.xCenter,y:Math.sin(a)*t+this.yCenter,angle:a}}getPointPositionForValue(n,t){return this.getPointPosition(n,this.getDistanceFromCenterForValue(t))}getBasePosition(n){return this.getPointPositionForValue(n||0,this.getBaseValue())}getPointLabelPosition(n){const{left:t,top:r,right:a,bottom:c}=this._pointLabelItems[n];return{left:t,top:r,right:a,bottom:c}}drawBackground(){const{backgroundColor:n,grid:{circular:t}}=this.options;if(n){const r=this.ctx;r.save(),r.beginPath(),BU(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),r.closePath(),r.fillStyle=n,r.fill(),r.restore()}}drawGrid(){const n=this.ctx,t=this.options,{angleLines:r,grid:a,border:c}=t,h=this._pointLabels.length;let f,b,x;if(t.pointLabels.display&&function Ttt(e,n){const{ctx:t,options:{pointLabels:r}}=e;for(let a=n-1;a>=0;a--){const c=e._pointLabelItems[a];if(!c.visible)continue;const h=r.setContext(e.getPointLabelContext(a));Stt(t,h,c);const f=Uo(h.font),{x:b,y:x,textAlign:M}=c;s_(t,e._pointLabels[a],b,x+f.lineHeight/2,f,{color:h.color,textAlign:M,textBaseline:"middle"})}}(this,h),a.display&&this.ticks.forEach((M,T)=>{if(0!==T){b=this.getDistanceFromCenterForValue(M.value);const I=this.getContext(T),L=a.setContext(I),N=c.setContext(I);!function Ett(e,n,t,r,a){const c=e.ctx,h=n.circular,{color:f,lineWidth:b}=n;!h&&!r||!f||!b||t<0||(c.save(),c.strokeStyle=f,c.lineWidth=b,c.setLineDash(a.dash),c.lineDashOffset=a.dashOffset,c.beginPath(),BU(e,t,h,r),c.closePath(),c.stroke(),c.restore())}(this,L,b,h,N)}}),r.display){for(n.save(),f=h-1;f>=0;f--){const M=r.setContext(this.getPointLabelContext(f)),{color:T,lineWidth:I}=M;!I||!T||(n.lineWidth=I,n.strokeStyle=T,n.setLineDash(M.borderDash),n.lineDashOffset=M.borderDashOffset,b=this.getDistanceFromCenterForValue(t.ticks.reverse?this.min:this.max),x=this.getPointPosition(f,b),n.beginPath(),n.moveTo(this.xCenter,this.yCenter),n.lineTo(x.x,x.y),n.stroke())}n.restore()}}drawBorder(){}drawLabels(){const n=this.ctx,t=this.options,r=t.ticks;if(!r.display)return;const a=this.getIndexAngle(0);let c,h;n.save(),n.translate(this.xCenter,this.yCenter),n.rotate(a),n.textAlign="center",n.textBaseline="middle",this.ticks.forEach((f,b)=>{if(0===b&&!t.reverse)return;const x=r.setContext(this.getContext(b)),M=Uo(x.font);if(c=this.getDistanceFromCenterForValue(this.ticks[b].value),x.showLabelBackdrop){n.font=M.string,h=n.measureText(f.label).width,n.fillStyle=x.backdropColor;const T=Ys(x.backdropPadding);n.fillRect(-h/2-T.left,-c-M.size/2-T.top,h+T.width,M.size+T.height)}s_(n,f.label,0,-c,M,{color:x.color,strokeColor:x.textStrokeColor,strokeWidth:x.textStrokeWidth})}),n.restore()}drawTitle(){}},TimeScale:sN,TimeSeriesScale:class Ftt extends sN{static id="timeseries";static defaults=sN.defaults;constructor(n){super(n),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const n=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(n);this._minPos=EI(t,this.min),this._tableRange=EI(t,this.max)-this._minPos,super.initOffsets(n)}buildLookupTable(n){const{min:t,max:r}=this,a=[],c=[];let h,f,b,x,M;for(h=0,f=n.length;h<f;++h)x=n[h],x>=t&&x<=r&&a.push(x);if(a.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(h=0,f=a.length;h<f;++h)M=a[h+1],b=a[h-1],x=a[h],Math.round((M+b)/2)!==x&&c.push({time:x,pos:h/(f-1)});return c}_generate(){const n=this.min,t=this.max;let r=super.getDataTimestamps();return(!r.includes(n)||!r.length)&&r.splice(0,0,n),(!r.includes(t)||1===r.length)&&r.push(t),r.sort((a,c)=>a-c)}_getTimestampsForTable(){let n=this._cache.all||[];if(n.length)return n;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return n=t.length&&r.length?this.normalize(t.concat(r)):t.length?t:r,n=this._cache.all=n,n}getDecimalForValue(n){return(EI(this._table,n)-this._minPos)/this._tableRange}getValueForPixel(n){const t=this._offsets,r=this.getDecimalForPixel(n)/t.factor-t.end;return EI(this._table,r*this._tableRange+this._minPos,!0)}}});const Btt=[FK,pJ,ltt,Ltt];class AI{}class II{}class Yd{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(t=>{const r=t.indexOf(":");if(r>0){const a=t.slice(0,r),c=a.toLowerCase(),h=t.slice(r+1).trim();this.maybeSetNormalizedName(a,c),this.headers.has(c)?this.headers.get(c).push(h):this.headers.set(c,[h])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const t=this.headers.get(n.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,t){return this.clone({name:n,value:t,op:"a"})}set(n,t){return this.clone({name:n,value:t,op:"s"})}delete(n,t){return this.clone({name:n,value:t,op:"d"})}maybeSetNormalizedName(n,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,n)}init(){this.lazyInit&&(this.lazyInit instanceof Yd?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(t=>{this.headers.set(t,n.headers.get(t)),this.normalizedNames.set(t,n.normalizedNames.get(t))})}clone(n){const t=new Yd;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Yd?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([n]),t}applyUpdate(n){const t=n.name.toLowerCase();switch(n.op){case"a":case"s":let r=n.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(n.name,t);const a=("a"===n.op?this.headers.get(t):void 0)||[];a.push(...r),this.headers.set(t,a);break;case"d":const c=n.value;if(c){let h=this.headers.get(t);if(!h)return;h=h.filter(f=>-1===c.indexOf(f)),0===h.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,h)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(n,t){const r=(Array.isArray(t)?t:[t]).map(c=>c.toString()),a=n.toLowerCase();this.headers.set(a,r),this.maybeSetNormalizedName(n,a)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>n(this.normalizedNames.get(t),this.headers.get(t)))}}class Ntt{encodeKey(n){return HU(n)}encodeValue(n){return HU(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const Vtt=/%(\d[a-f0-9])/gi,jtt={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function HU(e){return encodeURIComponent(e).replace(Vtt,(n,t)=>jtt[t]??n)}function RI(e){return`${e}`}class Fp{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new Ntt,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function ztt(e,n){const t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(a=>{const c=a.indexOf("="),[h,f]=-1==c?[n.decodeKey(a),""]:[n.decodeKey(a.slice(0,c)),n.decodeValue(a.slice(c+1))],b=t.get(h)||[];b.push(f),t.set(h,b)}),t}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(t=>{const r=n.fromObject[t],a=Array.isArray(r)?r.map(RI):[RI(r)];this.map.set(t,a)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const t=this.map.get(n);return t?t[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,t){return this.clone({param:n,value:t,op:"a"})}appendAll(n){const t=[];return Object.keys(n).forEach(r=>{const a=n[r];Array.isArray(a)?a.forEach(c=>{t.push({param:r,value:c,op:"a"})}):t.push({param:r,value:a,op:"a"})}),this.clone(t)}set(n,t){return this.clone({param:n,value:t,op:"s"})}delete(n,t){return this.clone({param:n,value:t,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const t=this.encoder.encodeKey(n);return this.map.get(n).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const t=new Fp({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(n),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const t=("a"===n.op?this.map.get(n.param):void 0)||[];t.push(RI(n.value)),this.map.set(n.param,t);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let r=this.map.get(n.param)||[];const a=r.indexOf(RI(n.value));-1!==a&&r.splice(a,1),r.length>0?this.map.set(n.param,r):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class Utt{constructor(){this.map=new Map}set(n,t){return this.map.set(n,t),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function $U(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function GU(e){return typeof Blob<"u"&&e instanceof Blob}function WU(e){return typeof FormData<"u"&&e instanceof FormData}class aM{constructor(n,t,r,a){let c;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function Htt(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||a?(this.body=void 0!==r?r:null,c=a):c=r,c&&(this.reportProgress=!!c.reportProgress,this.withCredentials=!!c.withCredentials,c.responseType&&(this.responseType=c.responseType),c.headers&&(this.headers=c.headers),c.context&&(this.context=c.context),c.params&&(this.params=c.params)),this.headers||(this.headers=new Yd),this.context||(this.context=new Utt),this.params){const h=this.params.toString();if(0===h.length)this.urlWithParams=t;else{const f=t.indexOf("?");this.urlWithParams=t+(-1===f?"?":f<t.length-1?"&":"")+h}}else this.params=new Fp,this.urlWithParams=t}serializeBody(){return null===this.body?null:$U(this.body)||GU(this.body)||WU(this.body)||function $tt(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Fp?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||WU(this.body)?null:GU(this.body)?this.body.type||null:$U(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Fp?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const t=n.method||this.method,r=n.url||this.url,a=n.responseType||this.responseType,c=void 0!==n.body?n.body:this.body,h=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,f=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let b=n.headers||this.headers,x=n.params||this.params;const M=n.context??this.context;return void 0!==n.setHeaders&&(b=Object.keys(n.setHeaders).reduce((T,I)=>T.set(I,n.setHeaders[I]),b)),n.setParams&&(x=Object.keys(n.setParams).reduce((T,I)=>T.set(I,n.setParams[I]),x)),new aM(t,r,c,{params:x,headers:b,context:M,reportProgress:f,responseType:a,withCredentials:h})}}var Av=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(Av||{});class aN{constructor(n,t=200,r="OK"){this.headers=n.headers||new Yd,this.status=void 0!==n.status?n.status:t,this.statusText=n.statusText||r,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class lN extends aN{constructor(n={}){super(n),this.type=Av.ResponseHeader}clone(n={}){return new lN({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class Iv extends aN{constructor(n={}){super(n),this.type=Av.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new Iv({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class qU extends aN{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function cN(e,n){return{body:n,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let PI=(()=>{class e{constructor(t){this.handler=t}request(t,r,a={}){let c;if(t instanceof aM)c=t;else{let b,x;b=a.headers instanceof Yd?a.headers:new Yd(a.headers),a.params&&(x=a.params instanceof Fp?a.params:new Fp({fromObject:a.params})),c=new aM(t,r,void 0!==a.body?a.body:null,{headers:b,context:a.context,params:x,reportProgress:a.reportProgress,responseType:a.responseType||"json",withCredentials:a.withCredentials})}const h=Le(c).pipe(uv(b=>this.handler.handle(b)));if(t instanceof aM||"events"===a.observe)return h;const f=h.pipe(rr(b=>b instanceof Iv));switch(a.observe||"body"){case"body":switch(c.responseType){case"arraybuffer":return f.pipe(Ti(b=>{if(null!==b.body&&!(b.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return b.body}));case"blob":return f.pipe(Ti(b=>{if(null!==b.body&&!(b.body instanceof Blob))throw new Error("Response is not a Blob.");return b.body}));case"text":return f.pipe(Ti(b=>{if(null!==b.body&&"string"!=typeof b.body)throw new Error("Response is not a string.");return b.body}));default:return f.pipe(Ti(b=>b.body))}case"response":return f;default:throw new Error(`Unreachable: unhandled observe type ${a.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:(new Fp).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,a={}){return this.request("PATCH",t,cN(a,r))}post(t,r,a={}){return this.request("POST",t,cN(a,r))}put(t,r,a={}){return this.request("PUT",t,cN(a,r))}static#t=this.\u0275fac=function(r){return new(r||e)(vt(AI))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();function XU(e,n){return n(e)}function Wtt(e,n){return(t,r)=>n.intercept(t,{handle:a=>e(a,r)})}const Ytt=new kt(""),lM=new kt(""),KU=new kt("");function Ztt(){let e=null;return(n,t)=>{null===e&&(e=(oe(Ytt,{optional:!0})??[]).reduceRight(Wtt,XU));const r=oe(nv),a=r.add();return e(n,t).pipe(hv(()=>r.remove(a)))}}let QU=(()=>{class e extends AI{constructor(t,r){super(),this.backend=t,this.injector=r,this.chain=null,this.pendingTasks=oe(nv)}handle(t){if(null===this.chain){const a=Array.from(new Set([...this.injector.get(lM),...this.injector.get(KU,[])]));this.chain=a.reduceRight((c,h)=>function qtt(e,n,t){return(r,a)=>t.runInContext(()=>n(r,c=>e(c,a)))}(c,h,this.injector),XU)}const r=this.pendingTasks.add();return this.chain(t,a=>this.backend.handle(a)).pipe(hv(()=>this.pendingTasks.remove(r)))}static#t=this.\u0275fac=function(r){return new(r||e)(vt(II),vt(Ko))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();const Jtt=/^\)\]\}',?\n/;let t6=(()=>{class e{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Rt(-2800,!1);const r=this.xhrFactory;return(r.\u0275loadImpl?Er(r.\u0275loadImpl()):Le(null)).pipe(Ci(()=>new en(c=>{const h=r.build();if(h.open(t.method,t.urlWithParams),t.withCredentials&&(h.withCredentials=!0),t.headers.forEach((V,$)=>h.setRequestHeader(V,$.join(","))),t.headers.has("Accept")||h.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const V=t.detectContentTypeHeader();null!==V&&h.setRequestHeader("Content-Type",V)}if(t.responseType){const V=t.responseType.toLowerCase();h.responseType="json"!==V?V:"text"}const f=t.serializeBody();let b=null;const x=()=>{if(null!==b)return b;const V=h.statusText||"OK",$=new Yd(h.getAllResponseHeaders()),nt=function tet(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(h)||t.url;return b=new lN({headers:$,status:h.status,statusText:V,url:nt}),b},M=()=>{let{headers:V,status:$,statusText:nt,url:tt}=x(),_t=null;204!==$&&(_t=typeof h.response>"u"?h.responseText:h.response),0===$&&($=_t?200:0);let wt=$>=200&&$<300;if("json"===t.responseType&&"string"==typeof _t){const Dt=_t;_t=_t.replace(Jtt,"");try{_t=""!==_t?JSON.parse(_t):null}catch(Vt){_t=Dt,wt&&(wt=!1,_t={error:Vt,text:_t})}}wt?(c.next(new Iv({body:_t,headers:V,status:$,statusText:nt,url:tt||void 0})),c.complete()):c.error(new qU({error:_t,headers:V,status:$,statusText:nt,url:tt||void 0}))},T=V=>{const{url:$}=x(),nt=new qU({error:V,status:h.status||0,statusText:h.statusText||"Unknown Error",url:$||void 0});c.error(nt)};let I=!1;const L=V=>{I||(c.next(x()),I=!0);let $={type:Av.DownloadProgress,loaded:V.loaded};V.lengthComputable&&($.total=V.total),"text"===t.responseType&&h.responseText&&($.partialText=h.responseText),c.next($)},N=V=>{let $={type:Av.UploadProgress,loaded:V.loaded};V.lengthComputable&&($.total=V.total),c.next($)};return h.addEventListener("load",M),h.addEventListener("error",T),h.addEventListener("timeout",T),h.addEventListener("abort",T),t.reportProgress&&(h.addEventListener("progress",L),null!==f&&h.upload&&h.upload.addEventListener("progress",N)),h.send(f),c.next({type:Av.Sent}),()=>{h.removeEventListener("error",T),h.removeEventListener("abort",T),h.removeEventListener("load",M),h.removeEventListener("timeout",T),t.reportProgress&&(h.removeEventListener("progress",L),null!==f&&h.upload&&h.upload.removeEventListener("progress",N)),h.readyState!==h.DONE&&h.abort()}})))}static#t=this.\u0275fac=function(r){return new(r||e)(vt(GV))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();const dN=new kt("XSRF_ENABLED"),e6=new kt("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),i6=new kt("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class n6{}let net=(()=>{class e{constructor(t,r,a){this.doc=t,this.platform=r,this.cookieName=a,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=OV(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ki),vt(Fc),vt(e6))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();function ret(e,n){const t=e.url.toLowerCase();if(!oe(dN)||"GET"===e.method||"HEAD"===e.method||t.startsWith("http://")||t.startsWith("https://"))return n(e);const r=oe(n6).getToken(),a=oe(i6);return null!=r&&!e.headers.has(a)&&(e=e.clone({headers:e.headers.set(a,r)})),n(e)}var Lp=function(e){return e[e.Interceptors=0]="Interceptors",e[e.LegacyInterceptors=1]="LegacyInterceptors",e[e.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",e[e.NoXsrfProtection=3]="NoXsrfProtection",e[e.JsonpSupport=4]="JsonpSupport",e[e.RequestsMadeViaParent=5]="RequestsMadeViaParent",e[e.Fetch=6]="Fetch",e}(Lp||{});function oet(...e){const n=[PI,t6,QU,{provide:AI,useExisting:QU},{provide:II,useExisting:t6},{provide:lM,useValue:ret,multi:!0},{provide:dN,useValue:!0},{provide:n6,useClass:net}];for(const t of e)n.push(...t.\u0275providers);return function Cm(e){return{\u0275providers:e}}(n)}const r6=new kt("LEGACY_INTERCEPTOR_FN");function set(){return function p_(e,n){return{\u0275kind:e,\u0275providers:n}}(Lp.LegacyInterceptors,[{provide:r6,useFactory:Ztt},{provide:lM,useExisting:r6,multi:!0}])}let aet=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[oet(set())]})}return e})(),cM=(()=>{class e{constructor(t){this._http=t}addDevice(t){return this._http.post("http://localhost:3000/device",t)}getDeviceList(){return this._http.get("http://localhost:3000/device")}getDeviceId(t){return this._http.get("http://localhost:3000/device/"+t)}deleteDevice(t){return this._http.delete("http://localhost:3000/device/"+t)}putDevice(t,r){return this._http.put("http://localhost:3000/device/"+t,r)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(PI))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),pet=(()=>{class e{constructor(t){this.deviceservice=t,this.datadevice=[],this.datalocation=[]}ngOnInit(){this.deviceservice.getDeviceList().subscribe(t=>{this.data=t,null!=this.data&&(this.countDevicesByLocation(),this.showChartData())})}countDevicesByLocation(){const t=new Map;this.data.forEach(r=>{const h=`${r.deviceName}-${r.location}`;t.set(h,(t.get(h)||0)+1)}),this.deviceCountsByLocation=Array.from(t.entries()).map(([r,a])=>{const[c,h]=r.split("-");return{deviceName:c,location:h,count:a}})}showChartData(){const t=Array.from(new Set(this.data.map(c=>c.location))),a=Array.from(new Set(this.data.map(c=>c.deviceName))).map(c=>({data:t.map(f=>{const x=this.deviceCountsByLocation.find(M=>M.deviceName===c&&M.location===f);return x?x.count:0}),label:c}));this.showchartdata(t,a)}showchartdata(t,r){new wI("myChart",{type:"bar",data:{labels:t,datasets:r},options:{scales:{y:{beginAtZero:!0}}}})}static#t=this.\u0275fac=function(r){return new(r||e)(z(cM))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["app-charts"]],decls:2,vars:0,consts:[[1,"chart"],["id","myChart"]],template:function(r,a){1&r&&(ht(0,"div",0),je(1,"canvas",1),ft())},styles:[".chart[_ngcontent-%COMP%]{padding-top:40px}"]})}return e})();function o6(...e){const n=nD(e),{args:t,keys:r}=f4(e),a=new en(c=>{const{length:h}=t;if(!h)return void c.complete();const f=new Array(h);let b=h,x=h;for(let M=0;M<h;M++){let T=!1;qi(t[M]).subscribe(jn(c,I=>{T||(T=!0,x--),f[M]=I},()=>b--,void 0,()=>{(!b||!T)&&(x||c.next(r?g4(r,f):f),c.complete())}))}});return n?a.pipe(ZL(n)):a}let s6=(()=>{class e{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=a=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Bc),z(Me))};static#e=this.\u0275dir=Mt({type:e})}return e})(),f_=(()=>{class e extends s6{static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275dir=Mt({type:e,features:[Xt]})}return e})();const Cs=new kt("NgValueAccessor"),get={provide:Cs,useExisting:rn(()=>dM),multi:!0},bet=new kt("CompositionEventMode");let dM=(()=>{class e extends s6{constructor(t,r,a){super(t,r),this._compositionMode=a,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function _et(){const e=Cp()?Cp().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Bc),z(Me),z(bet,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,a){1&r&&Se("input",function(h){return a._handleInput(h.target.value)})("blur",function(){return a.onTouched()})("compositionstart",function(){return a._compositionStart()})("compositionend",function(h){return a._compositionEnd(h.target.value)})},features:[Te([get]),Xt]})}return e})();function Bp(e){return null==e||("string"==typeof e||Array.isArray(e))&&0===e.length}function l6(e){return null!=e&&"number"==typeof e.length}const Jo=new kt("NgValidators"),Np=new kt("NgAsyncValidators"),yet=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class vl{static min(n){return function c6(e){return n=>{if(Bp(n.value)||Bp(e))return null;const t=parseFloat(n.value);return!isNaN(t)&&t<e?{min:{min:e,actual:n.value}}:null}}(n)}static max(n){return function d6(e){return n=>{if(Bp(n.value)||Bp(e))return null;const t=parseFloat(n.value);return!isNaN(t)&&t>e?{max:{max:e,actual:n.value}}:null}}(n)}static required(n){return function u6(e){return Bp(e.value)?{required:!0}:null}(n)}static requiredTrue(n){return function h6(e){return!0===e.value?null:{required:!0}}(n)}static email(n){return function m6(e){return Bp(e.value)||yet.test(e.value)?null:{email:!0}}(n)}static minLength(n){return function p6(e){return n=>Bp(n.value)||!l6(n.value)?null:n.value.length<e?{minlength:{requiredLength:e,actualLength:n.value.length}}:null}(n)}static maxLength(n){return function f6(e){return n=>l6(n.value)&&n.value.length>e?{maxlength:{requiredLength:e,actualLength:n.value.length}}:null}(n)}static pattern(n){return function g6(e){if(!e)return FI;let n,t;return"string"==typeof e?(t="","^"!==e.charAt(0)&&(t+="^"),t+=e,"$"!==e.charAt(e.length-1)&&(t+="$"),n=new RegExp(t)):(t=e.toString(),n=e),r=>{if(Bp(r.value))return null;const a=r.value;return n.test(a)?null:{pattern:{requiredPattern:t,actualValue:a}}}}(n)}static nullValidator(n){return null}static compose(n){return w6(n)}static composeAsync(n){return C6(n)}}function FI(e){return null}function _6(e){return null!=e}function b6(e){return Mg(e)?Er(e):e}function y6(e){let n={};return e.forEach(t=>{n=null!=t?{...n,...t}:n}),0===Object.keys(n).length?null:n}function v6(e,n){return n.map(t=>t(e))}function x6(e){return e.map(n=>function vet(e){return!e.validate}(n)?n:t=>n.validate(t))}function w6(e){if(!e)return null;const n=e.filter(_6);return 0==n.length?null:function(t){return y6(v6(t,n))}}function uN(e){return null!=e?w6(x6(e)):null}function C6(e){if(!e)return null;const n=e.filter(_6);return 0==n.length?null:function(t){return o6(v6(t,n).map(b6)).pipe(Ti(y6))}}function hN(e){return null!=e?C6(x6(e)):null}function M6(e,n){return null===e?[n]:Array.isArray(e)?[...e,n]:[e,n]}function D6(e){return e._rawValidators}function k6(e){return e._rawAsyncValidators}function mN(e){return e?Array.isArray(e)?e:[e]:[]}function LI(e,n){return Array.isArray(e)?e.includes(n):e===n}function S6(e,n){const t=mN(n);return mN(e).forEach(a=>{LI(t,a)||t.push(a)}),t}function T6(e,n){return mN(n).filter(t=>!LI(e,t))}class E6{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=uN(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=hN(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,t){return!!this.control&&this.control.hasError(n,t)}getError(n,t){return this.control?this.control.getError(n,t):null}}class ga extends E6{get formDirective(){return null}get path(){return null}}class Zc extends E6{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class A6{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let pN=(()=>{class e extends A6{constructor(t){super(t)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Zc,2))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,a){2&r&&Qe("ng-untouched",a.isUntouched)("ng-touched",a.isTouched)("ng-pristine",a.isPristine)("ng-dirty",a.isDirty)("ng-valid",a.isValid)("ng-invalid",a.isInvalid)("ng-pending",a.isPending)},features:[Xt]})}return e})(),I6=(()=>{class e extends A6{constructor(t){super(t)}static#t=this.\u0275fac=function(r){return new(r||e)(z(ga,10))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,a){2&r&&Qe("ng-untouched",a.isUntouched)("ng-touched",a.isTouched)("ng-pristine",a.isPristine)("ng-dirty",a.isDirty)("ng-valid",a.isValid)("ng-invalid",a.isInvalid)("ng-pending",a.isPending)("ng-submitted",a.isSubmitted)},features:[Xt]})}return e})();const uM="VALID",NI="INVALID",Rv="PENDING",hM="DISABLED";function _N(e){return(zI(e)?e.validators:e)||null}function bN(e,n){return(zI(n)?n.asyncValidators:e)||null}function zI(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function P6(e,n,t){const r=e.controls;if(!(n?Object.keys(r):r).length)throw new Rt(1e3,"");if(!r[t])throw new Rt(1001,"")}function O6(e,n,t){e._forEachChild((r,a)=>{if(void 0===t[a])throw new Rt(1002,"")})}class VI{constructor(n,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===uM}get invalid(){return this.status===NI}get pending(){return this.status==Rv}get disabled(){return this.status===hM}get enabled(){return this.status!==hM}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(S6(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(S6(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(T6(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(T6(n,this._rawAsyncValidators))}hasValidator(n){return LI(this._rawValidators,n)}hasAsyncValidator(n){return LI(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=Rv,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=hM,this.errors=null,this._forEachChild(r=>{r.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!0))}enable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=uM,this._forEachChild(r=>{r.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===uM||this.status===Rv)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?hM:uM}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=Rv,this._hasOwnPendingAsyncValidator=!0;const t=b6(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,t={}){this.errors=n,this._updateControlsErrors(!1!==t.emitEvent)}get(n){let t=n;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((r,a)=>r&&r._find(a),this)}getError(n,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[n]:null}hasError(n,t){return!!this.getError(n,t)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new me,this.statusChanges=new me}_calculateStatus(){return this._allControlsDisabled()?hM:this.errors?NI:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Rv)?Rv:this._anyControlsHaveStatus(NI)?NI:uM}_anyControlsHaveStatus(n){return this._anyControls(t=>t.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){zI(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function Met(e){return Array.isArray(e)?uN(e):e||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function Det(e){return Array.isArray(e)?hN(e):e||null}(this._rawAsyncValidators)}}class mM extends VI{constructor(n,t,r){super(_N(t),bN(r,t)),this.controls=n,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,t){return this.controls[n]?this.controls[n]:(this.controls[n]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(n,t,r={}){this.registerControl(n,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(n,t={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(n,t,r={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],t&&this.registerControl(n,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,t={}){O6(this,0,n),Object.keys(n).forEach(r=>{P6(this,!0,r),this.controls[r].setValue(n[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(n,t={}){null!=n&&(Object.keys(n).forEach(r=>{const a=this.controls[r];a&&a.patchValue(n[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(n={},t={}){this._forEachChild((r,a)=>{r.reset(n?n[a]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(n,t,r)=>(n[r]=t.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&n(r,t)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[t,r]of Object.entries(this.controls))if(this.contains(t)&&n(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,r,a)=>((r.enabled||this.disabled)&&(t[a]=r.value),t))}_reduceChildren(n,t){let r=n;return this._forEachChild((a,c)=>{r=t(r,a,c)}),r}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}class F6 extends mM{}const g_=new kt("CallSetDisabledState",{providedIn:"root",factory:()=>pM}),pM="always";function jI(e,n){return[...n.path,e]}function fM(e,n,t=pM){yN(e,n),n.valueAccessor.writeValue(e.value),(e.disabled||"always"===t)&&n.valueAccessor.setDisabledState?.(e.disabled),function Tet(e,n){n.valueAccessor.registerOnChange(t=>{e._pendingValue=t,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&L6(e,n)})}(e,n),function Aet(e,n){const t=(r,a)=>{n.valueAccessor.writeValue(r),a&&n.viewToModelUpdate(r)};e.registerOnChange(t),n._registerOnDestroy(()=>{e._unregisterOnChange(t)})}(e,n),function Eet(e,n){n.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&L6(e,n),"submit"!==e.updateOn&&e.markAsTouched()})}(e,n),function ket(e,n){if(n.valueAccessor.setDisabledState){const t=r=>{n.valueAccessor.setDisabledState(r)};e.registerOnDisabledChange(t),n._registerOnDestroy(()=>{e._unregisterOnDisabledChange(t)})}}(e,n)}function UI(e,n,t=!0){const r=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(r),n.valueAccessor.registerOnTouched(r)),$I(e,n),e&&(n._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function HI(e,n){e.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(n)})}function yN(e,n){const t=D6(e);null!==n.validator?e.setValidators(M6(t,n.validator)):"function"==typeof t&&e.setValidators([t]);const r=k6(e);null!==n.asyncValidator?e.setAsyncValidators(M6(r,n.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);const a=()=>e.updateValueAndValidity();HI(n._rawValidators,a),HI(n._rawAsyncValidators,a)}function $I(e,n){let t=!1;if(null!==e){if(null!==n.validator){const a=D6(e);if(Array.isArray(a)&&a.length>0){const c=a.filter(h=>h!==n.validator);c.length!==a.length&&(t=!0,e.setValidators(c))}}if(null!==n.asyncValidator){const a=k6(e);if(Array.isArray(a)&&a.length>0){const c=a.filter(h=>h!==n.asyncValidator);c.length!==a.length&&(t=!0,e.setAsyncValidators(c))}}}const r=()=>{};return HI(n._rawValidators,r),HI(n._rawAsyncValidators,r),t}function L6(e,n){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function B6(e,n){yN(e,n)}function xN(e,n){if(!e.hasOwnProperty("model"))return!1;const t=e.model;return!!t.isFirstChange()||!Object.is(n,t.currentValue)}function N6(e,n){e._syncPendingControls(),n.forEach(t=>{const r=t.control;"submit"===r.updateOn&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function wN(e,n){if(!n)return null;let t,r,a;return Array.isArray(n),n.forEach(c=>{c.constructor===dM?t=c:function Pet(e){return Object.getPrototypeOf(e.constructor)===f_}(c)?r=c:a=c}),a||r||t||null}const Fet={provide:ga,useExisting:rn(()=>Pv)},gM=(()=>Promise.resolve())();let Pv=(()=>{class e extends ga{constructor(t,r,a){super(),this.callSetDisabledState=a,this.submitted=!1,this._directives=new Set,this.ngSubmit=new me,this.form=new mM({},uN(t),hN(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){gM.then(()=>{const r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),fM(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){gM.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){gM.then(()=>{const r=this._findContainer(t.path),a=new mM({});B6(a,t),r.registerControl(t.name,a),a.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){gM.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){gM.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,N6(this.form,this._directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static#t=this.\u0275fac=function(r){return new(r||e)(z(Jo,10),z(Np,10),z(g_,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,a){1&r&&Se("submit",function(h){return a.onSubmit(h)})("reset",function(){return a.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Te([Fet]),Xt]})}return e})();function z6(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}function V6(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}const _M=class extends VI{constructor(n=null,t,r){super(_N(t),bN(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),zI(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=V6(n)?n.value:n)}setValue(n,t={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(n,t={}){this.setValue(n,t)}reset(n=this.defaultValue,t={}){this._applyFormState(n),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){z6(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){z6(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){V6(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},Net={provide:Zc,useExisting:rn(()=>CN)},H6=(()=>Promise.resolve())();let CN=(()=>{class e extends Zc{constructor(t,r,a,c,h,f){super(),this._changeDetectorRef=h,this.callSetDisabledState=f,this.control=new _M,this._registered=!1,this.name="",this.update=new me,this._parent=t,this._setValidators(r),this._setAsyncValidators(a),this.valueAccessor=wN(0,c)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),xN(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){fM(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){H6.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const r=t.isDisabled.currentValue,a=0!==r&&av(r);H6.then(()=>{a&&!this.control.disabled?this.control.disable():!a&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?jI(t,this._parent):[t]}static#t=this.\u0275fac=function(r){return new(r||e)(z(ga,9),z(Jo,10),z(Np,10),z(Cs,10),z(Et,8),z(g_,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Te([Net]),Xt,Bn]})}return e})(),$6=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275dir=Mt({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return e})();const zet={provide:Cs,useExisting:rn(()=>MN),multi:!0};let MN=(()=>{class e extends f_{writeValue(t){this.setProperty("value",t??"")}registerOnChange(t){this.onChange=r=>{t(""==r?null:parseFloat(r))}}static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275dir=Mt({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,a){1&r&&Se("input",function(h){return a.onChange(h.target.value)})("blur",function(){return a.onTouched()})},features:[Te([zet]),Xt]})}return e})(),G6=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({})}return e})();const DN=new kt("NgModelWithFormControlWarning"),$et={provide:ga,useExisting:rn(()=>__)};let __=(()=>{class e extends ga{constructor(t,r,a){super(),this.callSetDisabledState=a,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new me,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&($I(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const r=this.form.get(t.path);return fM(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){UI(t.control||null,t,!1),function Oet(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this.submitted=!0,N6(this.form,this.directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const r=t.control,a=this.form.get(t.path);r!==a&&(UI(r||null,t),(e=>e instanceof _M)(a)&&(fM(a,t,this.callSetDisabledState),t.control=a))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const r=this.form.get(t.path);B6(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const r=this.form.get(t.path);r&&function Iet(e,n){return $I(e,n)}(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){yN(this.form,this),this._oldForm&&$I(this._oldForm,this)}_checkFormPresent(){}static#t=this.\u0275fac=function(r){return new(r||e)(z(Jo,10),z(Np,10),z(g_,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","formGroup",""]],hostBindings:function(r,a){1&r&&Se("submit",function(h){return a.onSubmit(h)})("reset",function(){return a.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Te([$et]),Xt,Bn]})}return e})();const qet={provide:Zc,useExisting:rn(()=>TN)};let TN=(()=>{class e extends Zc{set isDisabled(t){}static#t=this._ngModelWarningSentOnce=!1;constructor(t,r,a,c,h){super(),this._ngModelWarningConfig=h,this._added=!1,this.name=null,this.update=new me,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(a),this.valueAccessor=wN(0,c)}ngOnChanges(t){this._added||this._setUpControl(),xN(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return jI(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static#e=this.\u0275fac=function(r){return new(r||e)(z(ga,13),z(Jo,10),z(Np,10),z(Cs,10),z(DN,8))};static#i=this.\u0275dir=Mt({type:e,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Te([qet]),Xt,Bn]})}return e})(),sH=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[G6]})}return e})();class aH extends VI{constructor(n,t,r){super(_N(t),bN(r,t)),this.controls=n,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[this._adjustIndex(n)]}push(n,t={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(n,t,r={}){this.controls.splice(n,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(n,t={}){let r=this._adjustIndex(n);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(n,t,r={}){let a=this._adjustIndex(n);a<0&&(a=0),this.controls[a]&&this.controls[a]._registerOnCollectionChange(()=>{}),this.controls.splice(a,1),t&&(this.controls.splice(a,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,t={}){O6(this,0,n),n.forEach((r,a)=>{P6(this,!1,a),this.at(a).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(n,t={}){null!=n&&(n.forEach((r,a)=>{this.at(a)&&this.at(a).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(n=[],t={}){this._forEachChild((r,a)=>{r.reset(n[a],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((t,r)=>!!r._syncPendingControls()||t,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((t,r)=>{n(t,r)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(t=>t.enabled&&n(t))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}}function lH(e){return!!e&&(void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn)}let lit=(()=>{class e{constructor(){this.useNonNullable=!1}get nonNullable(){const t=new e;return t.useNonNullable=!0,t}group(t,r=null){const a=this._reduceControls(t);let c={};return lH(r)?c=r:null!==r&&(c.validators=r.validator,c.asyncValidators=r.asyncValidator),new mM(a,c)}record(t,r=null){const a=this._reduceControls(t);return new F6(a,r)}control(t,r,a){let c={};return this.useNonNullable?(lH(r)?c=r:(c.validators=r,c.asyncValidators=a),new _M(t,{...c,nonNullable:!0})):new _M(t,r,a)}array(t,r,a){const c=t.map(h=>this._createControl(h));return new aH(c,r,a)}_reduceControls(t){const r={};return Object.keys(t).forEach(a=>{r[a]=this._createControl(t[a])}),r}_createControl(t){return t instanceof _M||t instanceof VI?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),cit=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:g_,useValue:t.callSetDisabledState??pM}]}}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[sH]})}return e})(),dit=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:DN,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:g_,useValue:t.callSetDisabledState??pM}]}}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[sH]})}return e})();function De(e){return null!=e&&"false"!=`${e}`}function ts(e,n=0){return cH(e)?Number(e):n}function cH(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}function GI(e){return Array.isArray(e)?e:[e]}function Ro(e){return null==e?"":"string"==typeof e?e:`${e}px`}function Dh(e){return e instanceof Me?e.nativeElement:e}const hit=["addListener","removeListener"],mit=["addEventListener","removeEventListener"],pit=["on","off"];function zp(e,n,t,r){if(bn(t)&&(r=t,t=void 0),r)return zp(e,n,t).pipe(ZL(r));const[a,c]=function _it(e){return bn(e.addEventListener)&&bn(e.removeEventListener)}(e)?mit.map(h=>f=>e[h](n,f,t)):function fit(e){return bn(e.addListener)&&bn(e.removeListener)}(e)?hit.map(dH(e,n)):function git(e){return bn(e.on)&&bn(e.off)}(e)?pit.map(dH(e,n)):[];if(!a&&jt(e))return xr(h=>zp(h,n,t))(qi(e));if(!a)throw new TypeError("Invalid event target");return new en(h=>{const f=(...b)=>h.next(1<b.length?b:b[0]);return a(f),()=>c(f)})}function dH(e,n){return t=>r=>e[t](n,r)}class bit extends lt{constructor(n,t){super()}schedule(n,t=0){return this}}const WI={setInterval(e,n,...t){const{delegate:r}=WI;return r?.setInterval?r.setInterval(e,n,...t):setInterval(e,n,...t)},clearInterval(e){const{delegate:n}=WI;return(n?.clearInterval||clearInterval)(e)},delegate:void 0};class PN extends bit{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var r;if(this.closed)return this;this.state=n;const a=this.id,c=this.scheduler;return null!=a&&(this.id=this.recycleAsyncId(c,a,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(c,this.id,t),this}requestAsyncId(n,t,r=0){return WI.setInterval(n.flush.bind(n,this),r)}recycleAsyncId(n,t,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&WI.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(n,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let a,r=!1;try{this.work(n)}catch(c){r=!0,a=c||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),a}unsubscribe(){if(!this.closed){const{id:n,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ge(r,this),null!=n&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}}const bM={schedule(e){let n=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:r}=bM;r&&(n=r.requestAnimationFrame,t=r.cancelAnimationFrame);const a=n(c=>{t=void 0,e(c)});return new lt(()=>t?.(a))},requestAnimationFrame(...e){const{delegate:n}=bM;return(n?.requestAnimationFrame||requestAnimationFrame)(...e)},cancelAnimationFrame(...e){const{delegate:n}=bM;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...e)},delegate:void 0},ON={now:()=>(ON.delegate||Date).now(),delegate:void 0};class yM{constructor(n,t=yM.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,r){return new this.schedulerActionCtor(this,n).schedule(r,t)}}yM.now=ON.now;class FN extends yM{constructor(n,t=yM.now){super(n,t),this.actions=[],this._active=!1}flush(n){const{actions:t}=this;if(this._active)return void t.push(n);let r;this._active=!0;do{if(r=n.execute(n.state,n.delay))break}while(n=t.shift());if(this._active=!1,r){for(;n=t.shift();)n.unsubscribe();throw r}}}new class vit extends FN{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let a;n=n||r.shift();do{if(a=n.execute(n.state,n.delay))break}while((n=r[0])&&n.id===t&&r.shift());if(this._active=!1,a){for(;(n=r[0])&&n.id===t&&r.shift();)n.unsubscribe();throw a}}}(class yit extends PN{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,r=0){return null!==r&&r>0?super.requestAsyncId(n,t,r):(n.actions.push(this),n._scheduled||(n._scheduled=bM.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,t,r=0){var a;if(null!=r?r>0:this.delay>0)return super.recycleAsyncId(n,t,r);const{actions:c}=n;null!=t&&(null===(a=c[c.length-1])||void 0===a?void 0:a.id)!==t&&(bM.cancelAnimationFrame(t),n._scheduled=void 0)}});let LN,wit=1;const qI={};function uH(e){return e in qI&&(delete qI[e],!0)}const Cit={setImmediate(e){const n=wit++;return qI[n]=!0,LN||(LN=Promise.resolve()),LN.then(()=>uH(n)&&e()),n},clearImmediate(e){uH(e)}},{setImmediate:Mit,clearImmediate:Dit}=Cit,YI={setImmediate(...e){const{delegate:n}=YI;return(n?.setImmediate||Mit)(...e)},clearImmediate(e){const{delegate:n}=YI;return(n?.clearImmediate||Dit)(e)},delegate:void 0},ZI=(new class Sit extends FN{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let a;n=n||r.shift();do{if(a=n.execute(n.state,n.delay))break}while((n=r[0])&&n.id===t&&r.shift());if(this._active=!1,a){for(;(n=r[0])&&n.id===t&&r.shift();)n.unsubscribe();throw a}}}(class kit extends PN{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,r=0){return null!==r&&r>0?super.requestAsyncId(n,t,r):(n.actions.push(this),n._scheduled||(n._scheduled=YI.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,t,r=0){var a;if(null!=r?r>0:this.delay>0)return super.recycleAsyncId(n,t,r);const{actions:c}=n;null!=t&&(null===(a=c[c.length-1])||void 0===a?void 0:a.id)!==t&&(YI.clearImmediate(t),n._scheduled===t&&(n._scheduled=void 0))}}),new FN(PN)),Eit=ZI;function mH(e,n=ZI){return function Ait(e){return pr((n,t)=>{let r=!1,a=null,c=null,h=!1;const f=()=>{if(c?.unsubscribe(),c=null,r){r=!1;const x=a;a=null,t.next(x)}h&&t.complete()},b=()=>{c=null,h&&t.complete()};n.subscribe(jn(t,x=>{r=!0,a=x,c||qi(e(x)).subscribe(c=jn(t,f,b))},()=>{h=!0,(!r||!c||c.closed)&&t.complete()}))})}(()=>function hH(e=0,n,t=Eit){let r=-1;return null!=n&&(iD(n)?t=n:r=n),new en(a=>{let c=function Iit(e){return e instanceof Date&&!isNaN(e)}(e)?+e-t.now():e;c<0&&(c=0);let h=0;return t.schedule(function(){a.closed||(a.next(h++),0<=r?this.schedule(void 0,r):a.complete())},c)})}(e,n))}let BN;try{BN=typeof Intl<"u"&&Intl.v8BreakIterator}catch{BN=!1}let Ov,vr=(()=>{class e{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function Yq(e){return e===HV}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!BN)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#t=this.\u0275fac=function(r){return new(r||e)(vt(Fc))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const pH=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function fH(){if(Ov)return Ov;if("object"!=typeof document||!document)return Ov=new Set(pH),Ov;let e=document.createElement("input");return Ov=new Set(pH.filter(n=>(e.setAttribute("type",n),e.type===n))),Ov}let vM,XI,y_,NN;function Xc(e){return function Rit(){if(null==vM&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>vM=!0}))}finally{vM=vM||!1}return vM}()?e:!!e.capture}function gH(){if(null==y_){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return y_=!1,y_;if("scrollBehavior"in document.documentElement.style)y_=!0;else{const e=Element.prototype.scrollTo;y_=!!e&&!/\{\s*\[native code\]\s*\}/.test(e.toString())}}return y_}function xM(){if("object"!=typeof document||!document)return 0;if(null==XI){const e=document.createElement("div"),n=e.style;e.dir="rtl",n.width="1px",n.overflow="auto",n.visibility="hidden",n.pointerEvents="none",n.position="absolute";const t=document.createElement("div"),r=t.style;r.width="2px",r.height="1px",e.appendChild(t),document.body.appendChild(e),XI=0,0===e.scrollLeft&&(e.scrollLeft=1,XI=0===e.scrollLeft?1:2),e.remove()}return XI}function Fv(){let e=typeof document<"u"&&document?document.activeElement:null;for(;e&&e.shadowRoot;){const n=e.shadowRoot.activeElement;if(n===e)break;e=n}return e}function kh(e){return e.composedPath?e.composedPath()[0]:e.target}function zN(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}const Fit=new kt("cdk-dir-doc",{providedIn:"root",factory:function Lit(){return oe(ki)}}),Bit=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let es=(()=>{class e{constructor(t){this.value="ltr",this.change=new me,t&&(this.value=function Nit(e){const n=e?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?Bit.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static#t=this.\u0275fac=function(r){return new(r||e)(vt(Fit,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),wM=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({})}return e})(),CM=(()=>{class e{constructor(t,r,a){this._ngZone=t,this._platform=r,this._scrolled=new we,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=a}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const r=this.scrollContainers.get(t);r&&(r.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new en(r=>{this._globalSubscription||this._addGlobalListener();const a=t>0?this._scrolled.pipe(mH(t)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{a.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Le()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(t,r){const a=this.getAncestorScrollContainers(t);return this.scrolled(r).pipe(rr(c=>!c||a.indexOf(c)>-1))}getAncestorScrollContainers(t){const r=[];return this.scrollContainers.forEach((a,c)=>{this._scrollableContainsElement(c,t)&&r.push(c)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,r){let a=Dh(r),c=t.getElementRef().nativeElement;do{if(a==c)return!0}while(a=a.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>zp(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(Re),vt(vr),vt(ki,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),MM=(()=>{class e{constructor(t,r,a,c){this.elementRef=t,this.scrollDispatcher=r,this.ngZone=a,this.dir=c,this._destroyed=new we,this._elementScrolled=new en(h=>this.ngZone.runOutsideAngular(()=>zp(this.elementRef.nativeElement,"scroll").pipe(Si(this._destroyed)).subscribe(h)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const r=this.elementRef.nativeElement,a=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=a?t.end:t.start),null==t.right&&(t.right=a?t.start:t.end),null!=t.bottom&&(t.top=r.scrollHeight-r.clientHeight-t.bottom),a&&0!=xM()?(null!=t.left&&(t.right=r.scrollWidth-r.clientWidth-t.left),2==xM()?t.left=t.right:1==xM()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=r.scrollWidth-r.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const r=this.elementRef.nativeElement;gH()?r.scrollTo(t):(null!=t.top&&(r.scrollTop=t.top),null!=t.left&&(r.scrollLeft=t.left))}measureScrollOffset(t){const r="left",a="right",c=this.elementRef.nativeElement;if("top"==t)return c.scrollTop;if("bottom"==t)return c.scrollHeight-c.clientHeight-c.scrollTop;const h=this.dir&&"rtl"==this.dir.value;return"start"==t?t=h?a:r:"end"==t&&(t=h?r:a),h&&2==xM()?t==r?c.scrollWidth-c.clientWidth-c.scrollLeft:c.scrollLeft:h&&1==xM()?t==r?c.scrollLeft+c.scrollWidth-c.clientWidth:-c.scrollLeft:t==r?c.scrollLeft:c.scrollWidth-c.clientWidth-c.scrollLeft}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(CM),z(Re),z(es,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0})}return e})(),Lv=(()=>{class e{constructor(t,r,a){this._platform=t,this._change=new we,this._changeListener=c=>{this._change.next(c)},this._document=a,r.runOutsideAngular(()=>{if(t.isBrowser){const c=this._getWindow();c.addEventListener("resize",this._changeListener),c.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:r,height:a}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+a,right:t.left+r,height:a,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,r=this._getWindow(),a=t.documentElement,c=a.getBoundingClientRect();return{top:-c.top||t.body.scrollTop||r.scrollY||a.scrollTop||0,left:-c.left||t.body.scrollLeft||r.scrollX||a.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(mH(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static#t=this.\u0275fac=function(r){return new(r||e)(vt(vr),vt(Re),vt(ki,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Sh=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({})}return e})(),VN=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[wM,Sh,wM,Sh]})}return e})();class jN{attach(n){return this._attachedHost=n,n.attach(this)}detach(){let n=this._attachedHost;null!=n&&(this._attachedHost=null,n.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(n){this._attachedHost=n}}class Bv extends jN{constructor(n,t,r,a,c){super(),this.component=n,this.viewContainerRef=t,this.injector=r,this.componentFactoryResolver=a,this.projectableNodes=c}}class KI extends jN{constructor(n,t,r,a){super(),this.templateRef=n,this.viewContainerRef=t,this.context=r,this.injector=a}get origin(){return this.templateRef.elementRef}attach(n,t=this.context){return this.context=t,super.attach(n)}detach(){return this.context=void 0,super.detach()}}class Uit extends jN{constructor(n){super(),this.element=n instanceof Me?n.nativeElement:n}}class UN{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(n){return n instanceof Bv?(this._attachedPortal=n,this.attachComponentPortal(n)):n instanceof KI?(this._attachedPortal=n,this.attachTemplatePortal(n)):this.attachDomPortal&&n instanceof Uit?(this._attachedPortal=n,this.attachDomPortal(n)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(n){this._disposeFn=n}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Hit extends UN{constructor(n,t,r,a,c){super(),this.outletElement=n,this._componentFactoryResolver=t,this._appRef=r,this._defaultInjector=a,this.attachDomPortal=h=>{const f=h.element,b=this._document.createComment("dom-portal");f.parentNode.insertBefore(b,f),this.outletElement.appendChild(f),this._attachedPortal=h,super.setDisposeFn(()=>{b.parentNode&&b.parentNode.replaceChild(f,b)})},this._document=c}attachComponentPortal(n){const r=(n.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(n.component);let a;return n.viewContainerRef?(a=n.viewContainerRef.createComponent(r,n.viewContainerRef.length,n.injector||n.viewContainerRef.injector,n.projectableNodes||void 0),this.setDisposeFn(()=>a.destroy())):(a=r.create(n.injector||this._defaultInjector||oo.NULL),this._appRef.attachView(a.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(a.hostView),a.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(a)),this._attachedPortal=n,a}attachTemplatePortal(n){let t=n.viewContainerRef,r=t.createEmbeddedView(n.templateRef,n.context,{injector:n.injector});return r.rootNodes.forEach(a=>this.outletElement.appendChild(a)),r.detectChanges(),this.setDisposeFn(()=>{let a=t.indexOf(r);-1!==a&&t.remove(a)}),this._attachedPortal=n,r}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(n){return n.hostView.rootNodes[0]}}let DM=(()=>{class e extends UN{constructor(t,r,a){super(),this._componentFactoryResolver=t,this._viewContainerRef=r,this._isInitialized=!1,this.attached=new me,this.attachDomPortal=c=>{const h=c.element,f=this._document.createComment("dom-portal");c.setAttachedHost(this),h.parentNode.insertBefore(f,h),this._getRootNode().appendChild(h),this._attachedPortal=c,super.setDisposeFn(()=>{f.parentNode&&f.parentNode.replaceChild(h,f)})},this._document=a}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const r=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,c=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),h=r.createComponent(c,r.length,t.injector||r.injector,t.projectableNodes||void 0);return r!==this._viewContainerRef&&this._getRootNode().appendChild(h.hostView.rootNodes[0]),super.setDisposeFn(()=>h.destroy()),this._attachedPortal=t,this._attachedRef=h,this.attached.emit(h),h}attachTemplatePortal(t){t.setAttachedHost(this);const r=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=r,this.attached.emit(r),r}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}static#t=this.\u0275fac=function(r){return new(r||e)(z(Lc),z(hr),z(ki))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Xt]})}return e})(),Vp=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({})}return e})();function Do(e,...n){return n.length?n.some(t=>e[t]):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}const _H=gH();class Jit{constructor(n,t){this._viewportRuler=n,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const n=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=n.style.left||"",this._previousHTMLStyles.top=n.style.top||"",n.style.left=Ro(-this._previousScrollPosition.left),n.style.top=Ro(-this._previousScrollPosition.top),n.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const n=this._document.documentElement,r=n.style,a=this._document.body.style,c=r.scrollBehavior||"",h=a.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,n.classList.remove("cdk-global-scrollblock"),_H&&(r.scrollBehavior=a.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),_H&&(r.scrollBehavior=c,a.scrollBehavior=h)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,r=this._viewportRuler.getViewportSize();return t.scrollHeight>r.height||t.scrollWidth>r.width}}class tnt{constructor(n,t,r,a){this._scrollDispatcher=n,this._ngZone=t,this._viewportRuler=r,this._config=a,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(n){this._overlayRef=n}enable(){if(this._scrollSubscription)return;const n=this._scrollDispatcher.scrolled(0).pipe(rr(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=n.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=n.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class bH{enable(){}disable(){}attach(){}}function GN(e,n){return n.some(t=>e.bottom<t.top||e.top>t.bottom||e.right<t.left||e.left>t.right)}function yH(e,n){return n.some(t=>e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)}class ent{constructor(n,t,r,a){this._scrollDispatcher=n,this._viewportRuler=t,this._ngZone=r,this._config=a,this._scrollSubscription=null}attach(n){this._overlayRef=n}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:a}=this._viewportRuler.getViewportSize();GN(t,[{width:r,height:a,bottom:a,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let int=(()=>{class e{constructor(t,r,a,c){this._scrollDispatcher=t,this._viewportRuler=r,this._ngZone=a,this.noop=()=>new bH,this.close=h=>new tnt(this._scrollDispatcher,this._ngZone,this._viewportRuler,h),this.block=()=>new Jit(this._viewportRuler,this._document),this.reposition=h=>new ent(this._scrollDispatcher,this._viewportRuler,this._ngZone,h),this._document=c}static#t=this.\u0275fac=function(r){return new(r||e)(vt(CM),vt(Lv),vt(Re),vt(ki))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class TM{constructor(n){if(this.scrollStrategy=new bH,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,n){const t=Object.keys(n);for(const r of t)void 0!==n[r]&&(this[r]=n[r])}}}class nnt{constructor(n,t){this.connectionPair=n,this.scrollableViewProperties=t}}let vH=(()=>{class e{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const r=this._attachedOverlays.indexOf(t);r>-1&&this._attachedOverlays.splice(r,1),0===this._attachedOverlays.length&&this.detach()}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ki))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),rnt=(()=>{class e extends vH{constructor(t,r){super(t),this._ngZone=r,this._keydownListener=a=>{const c=this._attachedOverlays;for(let h=c.length-1;h>-1;h--)if(c[h]._keydownEvents.observers.length>0){const f=c[h]._keydownEvents;this._ngZone?this._ngZone.run(()=>f.next(a)):f.next(a);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ki),vt(Re,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ont=(()=>{class e extends vH{constructor(t,r,a){super(t),this._platform=r,this._ngZone=a,this._cursorStyleIsSet=!1,this._pointerDownListener=c=>{this._pointerDownEventTarget=kh(c)},this._clickListener=c=>{const h=kh(c),f="click"===c.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:h;this._pointerDownEventTarget=null;const b=this._attachedOverlays.slice();for(let x=b.length-1;x>-1;x--){const M=b[x];if(M._outsidePointerEvents.observers.length<1||!M.hasAttached())continue;if(M.overlayElement.contains(h)||M.overlayElement.contains(f))break;const T=M._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>T.next(c)):T.next(c)}}}add(t){if(super.add(t),!this._isAttached){const r=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(r)):this._addEventListeners(r),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ki),vt(vr),vt(Re,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),e2=(()=>{class e{constructor(t,r){this._platform=r,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||zN()){const a=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let c=0;c<a.length;c++)a[c].remove()}const r=this._document.createElement("div");r.classList.add(t),zN()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ki),vt(vr))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class EM{constructor(n,t,r,a,c,h,f,b,x,M=!1){this._portalOutlet=n,this._host=t,this._pane=r,this._config=a,this._ngZone=c,this._keyboardDispatcher=h,this._document=f,this._location=b,this._outsideClickDispatcher=x,this._animationsDisabled=M,this._backdropElement=null,this._backdropClick=new we,this._attachments=new we,this._detachments=new we,this._locationChanges=lt.EMPTY,this._backdropClickHandler=T=>this._backdropClick.next(T),this._backdropTransitionendHandler=T=>{this._disposeBackdrop(T.target)},this._keydownEvents=new we,this._outsidePointerEvents=new we,a.scrollStrategy&&(this._scrollStrategy=a.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=a.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(n){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(n);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(nr(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const n=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),n}dispose(){const n=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,n&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(n){n!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=n,this.hasAttached()&&(n.attach(this),this.updatePosition()))}updateSize(n){this._config={...this._config,...n},this._updateElementSize()}setDirection(n){this._config={...this._config,direction:n},this._updateElementDirection()}addPanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!0)}removePanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!1)}getDirection(){const n=this._config.direction;return n?"string"==typeof n?n:n.value:"ltr"}updateScrollStrategy(n){n!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=n,this.hasAttached()&&(n.attach(this),n.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const n=this._pane.style;n.width=Ro(this._config.width),n.height=Ro(this._config.height),n.minWidth=Ro(this._config.minWidth),n.minHeight=Ro(this._config.minHeight),n.maxWidth=Ro(this._config.maxWidth),n.maxHeight=Ro(this._config.maxHeight)}_togglePointerEvents(n){this._pane.style.pointerEvents=n?"":"none"}_attachBackdrop(){const n="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(n)})}):this._backdropElement.classList.add(n)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const n=this._backdropElement;if(n){if(this._animationsDisabled)return void this._disposeBackdrop(n);n.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{n.addEventListener("transitionend",this._backdropTransitionendHandler)}),n.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(n)},500))}}_toggleClasses(n,t,r){const a=GI(t||[]).filter(c=>!!c);a.length&&(r?n.classList.add(...a):n.classList.remove(...a))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const n=this._ngZone.onStable.pipe(Si(wr(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),n.unsubscribe())})})}_disposeScrollStrategy(){const n=this._scrollStrategy;n&&(n.disable(),n.detach&&n.detach())}_disposeBackdrop(n){n&&(n.removeEventListener("click",this._backdropClickHandler),n.removeEventListener("transitionend",this._backdropTransitionendHandler),n.remove(),this._backdropElement===n&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const xH="cdk-overlay-connected-position-bounding-box",snt=/([A-Za-z%]+)$/;class wH{get positions(){return this._preferredPositions}constructor(n,t,r,a,c){this._viewportRuler=t,this._document=r,this._platform=a,this._overlayContainer=c,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new we,this._resizeSubscription=lt.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(n)}attach(n){this._validatePositions(),n.hostElement.classList.add(xH),this._overlayRef=n,this._boundingBox=n.hostElement,this._pane=n.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const n=this._originRect,t=this._overlayRect,r=this._viewportRect,a=this._containerRect,c=[];let h;for(let f of this._preferredPositions){let b=this._getOriginPoint(n,a,f),x=this._getOverlayPoint(b,t,f),M=this._getOverlayFit(x,t,r,f);if(M.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(f,b);this._canFitWithFlexibleDimensions(M,x,r)?c.push({position:f,origin:b,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(b,f)}):(!h||h.overlayFit.visibleArea<M.visibleArea)&&(h={overlayFit:M,overlayPoint:x,originPoint:b,position:f,overlayRect:t})}if(c.length){let f=null,b=-1;for(const x of c){const M=x.boundingBoxRect.width*x.boundingBoxRect.height*(x.position.weight||1);M>b&&(b=M,f=x)}return this._isPushed=!1,void this._applyPosition(f.position,f.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(h.position,h.originPoint);this._applyPosition(h.position,h.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&v_(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(xH),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const n=this._lastPosition;if(n){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,n);this._applyPosition(n,t)}else this.apply()}withScrollableContainers(n){return this._scrollables=n,this}withPositions(n){return this._preferredPositions=n,-1===n.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(n){return this._viewportMargin=n,this}withFlexibleDimensions(n=!0){return this._hasFlexibleDimensions=n,this}withGrowAfterOpen(n=!0){return this._growAfterOpen=n,this}withPush(n=!0){return this._canPush=n,this}withLockedPosition(n=!0){return this._positionLocked=n,this}setOrigin(n){return this._origin=n,this}withDefaultOffsetX(n){return this._offsetX=n,this}withDefaultOffsetY(n){return this._offsetY=n,this}withTransformOriginOn(n){return this._transformOriginSelector=n,this}_getOriginPoint(n,t,r){let a,c;if("center"==r.originX)a=n.left+n.width/2;else{const h=this._isRtl()?n.right:n.left,f=this._isRtl()?n.left:n.right;a="start"==r.originX?h:f}return t.left<0&&(a-=t.left),c="center"==r.originY?n.top+n.height/2:"top"==r.originY?n.top:n.bottom,t.top<0&&(c-=t.top),{x:a,y:c}}_getOverlayPoint(n,t,r){let a,c;return a="center"==r.overlayX?-t.width/2:"start"===r.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,c="center"==r.overlayY?-t.height/2:"top"==r.overlayY?0:-t.height,{x:n.x+a,y:n.y+c}}_getOverlayFit(n,t,r,a){const c=MH(t);let{x:h,y:f}=n,b=this._getOffset(a,"x"),x=this._getOffset(a,"y");b&&(h+=b),x&&(f+=x);let I=0-f,L=f+c.height-r.height,N=this._subtractOverflows(c.width,0-h,h+c.width-r.width),V=this._subtractOverflows(c.height,I,L),$=N*V;return{visibleArea:$,isCompletelyWithinViewport:c.width*c.height===$,fitsInViewportVertically:V===c.height,fitsInViewportHorizontally:N==c.width}}_canFitWithFlexibleDimensions(n,t,r){if(this._hasFlexibleDimensions){const a=r.bottom-t.y,c=r.right-t.x,h=CH(this._overlayRef.getConfig().minHeight),f=CH(this._overlayRef.getConfig().minWidth);return(n.fitsInViewportVertically||null!=h&&h<=a)&&(n.fitsInViewportHorizontally||null!=f&&f<=c)}return!1}_pushOverlayOnScreen(n,t,r){if(this._previousPushAmount&&this._positionLocked)return{x:n.x+this._previousPushAmount.x,y:n.y+this._previousPushAmount.y};const a=MH(t),c=this._viewportRect,h=Math.max(n.x+a.width-c.width,0),f=Math.max(n.y+a.height-c.height,0),b=Math.max(c.top-r.top-n.y,0),x=Math.max(c.left-r.left-n.x,0);let M=0,T=0;return M=a.width<=c.width?x||-h:n.x<this._viewportMargin?c.left-r.left-n.x:0,T=a.height<=c.height?b||-f:n.y<this._viewportMargin?c.top-r.top-n.y:0,this._previousPushAmount={x:M,y:T},{x:n.x+M,y:n.y+T}}_applyPosition(n,t){if(this._setTransformOrigin(n),this._setOverlayElementStyles(t,n),this._setBoundingBoxStyles(t,n),n.panelClass&&this._addPanelClasses(n.panelClass),this._lastPosition=n,this._positionChanges.observers.length){const r=this._getScrollVisibility(),a=new nnt(n,r);this._positionChanges.next(a)}this._isInitialRender=!1}_setTransformOrigin(n){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let r,a=n.overlayY;r="center"===n.overlayX?"center":this._isRtl()?"start"===n.overlayX?"right":"left":"start"===n.overlayX?"left":"right";for(let c=0;c<t.length;c++)t[c].style.transformOrigin=`${r} ${a}`}_calculateBoundingBoxRect(n,t){const r=this._viewportRect,a=this._isRtl();let c,h,f,M,T,I;if("top"===t.overlayY)h=n.y,c=r.height-h+this._viewportMargin;else if("bottom"===t.overlayY)f=r.height-n.y+2*this._viewportMargin,c=r.height-f+this._viewportMargin;else{const L=Math.min(r.bottom-n.y+r.top,n.y),N=this._lastBoundingBoxSize.height;c=2*L,h=n.y-L,c>N&&!this._isInitialRender&&!this._growAfterOpen&&(h=n.y-N/2)}if("end"===t.overlayX&&!a||"start"===t.overlayX&&a)I=r.width-n.x+this._viewportMargin,M=n.x-this._viewportMargin;else if("start"===t.overlayX&&!a||"end"===t.overlayX&&a)T=n.x,M=r.right-n.x;else{const L=Math.min(r.right-n.x+r.left,n.x),N=this._lastBoundingBoxSize.width;M=2*L,T=n.x-L,M>N&&!this._isInitialRender&&!this._growAfterOpen&&(T=n.x-N/2)}return{top:h,left:T,bottom:f,right:I,width:M,height:c}}_setBoundingBoxStyles(n,t){const r=this._calculateBoundingBoxRect(n,t);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));const a={};if(this._hasExactPosition())a.top=a.left="0",a.bottom=a.right=a.maxHeight=a.maxWidth="",a.width=a.height="100%";else{const c=this._overlayRef.getConfig().maxHeight,h=this._overlayRef.getConfig().maxWidth;a.height=Ro(r.height),a.top=Ro(r.top),a.bottom=Ro(r.bottom),a.width=Ro(r.width),a.left=Ro(r.left),a.right=Ro(r.right),a.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",a.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",c&&(a.maxHeight=Ro(c)),h&&(a.maxWidth=Ro(h))}this._lastBoundingBoxSize=r,v_(this._boundingBox.style,a)}_resetBoundingBoxStyles(){v_(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){v_(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(n,t){const r={},a=this._hasExactPosition(),c=this._hasFlexibleDimensions,h=this._overlayRef.getConfig();if(a){const M=this._viewportRuler.getViewportScrollPosition();v_(r,this._getExactOverlayY(t,n,M)),v_(r,this._getExactOverlayX(t,n,M))}else r.position="static";let f="",b=this._getOffset(t,"x"),x=this._getOffset(t,"y");b&&(f+=`translateX(${b}px) `),x&&(f+=`translateY(${x}px)`),r.transform=f.trim(),h.maxHeight&&(a?r.maxHeight=Ro(h.maxHeight):c&&(r.maxHeight="")),h.maxWidth&&(a?r.maxWidth=Ro(h.maxWidth):c&&(r.maxWidth="")),v_(this._pane.style,r)}_getExactOverlayY(n,t,r){let a={top:"",bottom:""},c=this._getOverlayPoint(t,this._overlayRect,n);return this._isPushed&&(c=this._pushOverlayOnScreen(c,this._overlayRect,r)),"bottom"===n.overlayY?a.bottom=this._document.documentElement.clientHeight-(c.y+this._overlayRect.height)+"px":a.top=Ro(c.y),a}_getExactOverlayX(n,t,r){let h,a={left:"",right:""},c=this._getOverlayPoint(t,this._overlayRect,n);return this._isPushed&&(c=this._pushOverlayOnScreen(c,this._overlayRect,r)),h=this._isRtl()?"end"===n.overlayX?"left":"right":"end"===n.overlayX?"right":"left","right"===h?a.right=this._document.documentElement.clientWidth-(c.x+this._overlayRect.width)+"px":a.left=Ro(c.x),a}_getScrollVisibility(){const n=this._getOriginRect(),t=this._pane.getBoundingClientRect(),r=this._scrollables.map(a=>a.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:yH(n,r),isOriginOutsideView:GN(n,r),isOverlayClipped:yH(t,r),isOverlayOutsideView:GN(t,r)}}_subtractOverflows(n,...t){return t.reduce((r,a)=>r-Math.max(a,0),n)}_getNarrowedViewportRect(){const n=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._viewportMargin,left:r.left+this._viewportMargin,right:r.left+n-this._viewportMargin,bottom:r.top+t-this._viewportMargin,width:n-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(n,t){return"x"===t?null==n.offsetX?this._offsetX:n.offsetX:null==n.offsetY?this._offsetY:n.offsetY}_validatePositions(){}_addPanelClasses(n){this._pane&&GI(n).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(n=>{this._pane.classList.remove(n)}),this._appliedPanelClasses=[])}_getOriginRect(){const n=this._origin;if(n instanceof Me)return n.nativeElement.getBoundingClientRect();if(n instanceof Element)return n.getBoundingClientRect();const t=n.width||0,r=n.height||0;return{top:n.y,bottom:n.y+r,left:n.x,right:n.x+t,height:r,width:t}}}function v_(e,n){for(let t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}function CH(e){if("number"!=typeof e&&null!=e){const[n,t]=e.split(snt);return t&&"px"!==t?null:parseFloat(n)}return e||null}function MH(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}const DH="cdk-global-overlay-wrapper";class ant{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(n){const t=n.getConfig();this._overlayRef=n,this._width&&!t.width&&n.updateSize({width:this._width}),this._height&&!t.height&&n.updateSize({height:this._height}),n.hostElement.classList.add(DH),this._isDisposed=!1}top(n=""){return this._bottomOffset="",this._topOffset=n,this._alignItems="flex-start",this}left(n=""){return this._xOffset=n,this._xPosition="left",this}bottom(n=""){return this._topOffset="",this._bottomOffset=n,this._alignItems="flex-end",this}right(n=""){return this._xOffset=n,this._xPosition="right",this}start(n=""){return this._xOffset=n,this._xPosition="start",this}end(n=""){return this._xOffset=n,this._xPosition="end",this}width(n=""){return this._overlayRef?this._overlayRef.updateSize({width:n}):this._width=n,this}height(n=""){return this._overlayRef?this._overlayRef.updateSize({height:n}):this._height=n,this}centerHorizontally(n=""){return this.left(n),this._xPosition="center",this}centerVertically(n=""){return this.top(n),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const n=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:a,height:c,maxWidth:h,maxHeight:f}=r,b=!("100%"!==a&&"100vw"!==a||h&&"100%"!==h&&"100vw"!==h),x=!("100%"!==c&&"100vh"!==c||f&&"100%"!==f&&"100vh"!==f),M=this._xPosition,T=this._xOffset,I="rtl"===this._overlayRef.getConfig().direction;let L="",N="",V="";b?V="flex-start":"center"===M?(V="center",I?N=T:L=T):I?"left"===M||"end"===M?(V="flex-end",L=T):("right"===M||"start"===M)&&(V="flex-start",N=T):"left"===M||"start"===M?(V="flex-start",L=T):("right"===M||"end"===M)&&(V="flex-end",N=T),n.position=this._cssPosition,n.marginLeft=b?"0":L,n.marginTop=x?"0":this._topOffset,n.marginBottom=this._bottomOffset,n.marginRight=b?"0":N,t.justifyContent=V,t.alignItems=x?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const n=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,r=t.style;t.classList.remove(DH),r.justifyContent=r.alignItems=n.marginTop=n.marginBottom=n.marginLeft=n.marginRight=n.position="",this._overlayRef=null,this._isDisposed=!0}}let lnt=(()=>{class e{constructor(t,r,a,c){this._viewportRuler=t,this._document=r,this._platform=a,this._overlayContainer=c}global(){return new ant}flexibleConnectedTo(t){return new wH(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(Lv),vt(ki),vt(vr),vt(e2))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),cnt=0,_a=(()=>{class e{constructor(t,r,a,c,h,f,b,x,M,T,I,L){this.scrollStrategies=t,this._overlayContainer=r,this._componentFactoryResolver=a,this._positionBuilder=c,this._keyboardDispatcher=h,this._injector=f,this._ngZone=b,this._document=x,this._directionality=M,this._location=T,this._outsideClickDispatcher=I,this._animationsModuleType=L}create(t){const r=this._createHostElement(),a=this._createPaneElement(r),c=this._createPortalOutlet(a),h=new TM(t);return h.direction=h.direction||this._directionality.value,new EM(c,r,a,h,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const r=this._document.createElement("div");return r.id="cdk-overlay-"+cnt++,r.classList.add("cdk-overlay-pane"),t.appendChild(r),r}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(Q)),new Hit(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(int),vt(e2),vt(Lc),vt(lnt),vt(rnt),vt(oo),vt(Re),vt(ki),vt(es),vt(gC),vt(ont),vt(Pr,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const dnt=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],kH=new kt("cdk-connected-overlay-scroll-strategy");let WN=(()=>{class e{constructor(t){this.elementRef=t}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0})}return e})(),SH=(()=>{class e{get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(t){this._hasBackdrop=De(t)}get lockPosition(){return this._lockPosition}set lockPosition(t){this._lockPosition=De(t)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(t){this._flexibleDimensions=De(t)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(t){this._growAfterOpen=De(t)}get push(){return this._push}set push(t){this._push=De(t)}constructor(t,r,a,c,h){this._overlay=t,this._dir=h,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=lt.EMPTY,this._attachSubscription=lt.EMPTY,this._detachSubscription=lt.EMPTY,this._positionSubscription=lt.EMPTY,this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.backdropClick=new me,this.positionChange=new me,this.attach=new me,this.detach=new me,this.overlayKeydown=new me,this.overlayOutsideClick=new me,this._templatePortal=new KI(r,a),this._scrollStrategyFactory=c,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(t){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),t.origin&&this.open&&this._position.apply()),t.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=dnt);const t=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=t.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=t.detachments().subscribe(()=>this.detach.emit()),t.keydownEvents().subscribe(r=>{this.overlayKeydown.next(r),27===r.keyCode&&!this.disableClose&&!Do(r)&&(r.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(r=>{this.overlayOutsideClick.next(r)})}_buildConfig(){const t=this._position=this.positionStrategy||this._createPositionStrategy(),r=new TM({direction:this._dir,positionStrategy:t,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(r.width=this.width),(this.height||0===this.height)&&(r.height=this.height),(this.minWidth||0===this.minWidth)&&(r.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(r.minHeight=this.minHeight),this.backdropClass&&(r.backdropClass=this.backdropClass),this.panelClass&&(r.panelClass=this.panelClass),r}_updatePositionStrategy(t){const r=this.positions.map(a=>({originX:a.originX,originY:a.originY,overlayX:a.overlayX,overlayY:a.overlayY,offsetX:a.offsetX||this.offsetX,offsetY:a.offsetY||this.offsetY,panelClass:a.panelClass||void 0}));return t.setOrigin(this._getFlexibleConnectedPositionStrategyOrigin()).withPositions(r).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const t=this._overlay.position().flexibleConnectedTo(this._getFlexibleConnectedPositionStrategyOrigin());return this._updatePositionStrategy(t),t}_getFlexibleConnectedPositionStrategyOrigin(){return this.origin instanceof WN?this.origin.elementRef:this.origin}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(t=>{this.backdropClick.emit(t)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(function jit(e,n=!1){return pr((t,r)=>{let a=0;t.subscribe(jn(r,c=>{const h=e(c,a++);(h||n)&&r.next(c),!h&&r.complete()}))})}(()=>this.positionChange.observers.length>0)).subscribe(t=>{this.positionChange.emit(t),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}static#t=this.\u0275fac=function(r){return new(r||e)(z(_a),z(Jr),z(hr),z(kH),z(es,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:["cdkConnectedOverlayOrigin","origin"],positions:["cdkConnectedOverlayPositions","positions"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:["cdkConnectedOverlayOpen","open"],disableClose:["cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[Bn]})}return e})();const hnt={provide:kH,deps:[_a],useFactory:function unt(e){return()=>e.scrollStrategies.reposition()}};let jp=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[_a,hnt],imports:[wM,Vp,VN,VN]})}return e})();function n2(e,n=ZI){return pr((t,r)=>{let a=null,c=null,h=null;const f=()=>{if(a){a.unsubscribe(),a=null;const x=c;c=null,r.next(x)}};function b(){const x=h+e,M=n.now();if(M<x)return a=this.schedule(void 0,x-M),void r.add(a);f()}t.subscribe(jn(r,x=>{c=x,h=n.now(),a||(a=n.schedule(b,e),r.add(a))},()=>{f(),r.complete()},void 0,()=>{c=a=null}))})}function TH(e){return rr((n,t)=>e<=t)}let EH=(()=>{class e{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),r2=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[EH]})}return e})();const AH=new Set;let x_,fnt=(()=>{class e{constructor(t,r){this._platform=t,this._nonce=r,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):_nt}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function gnt(e,n){if(!AH.has(e))try{x_||(x_=document.createElement("style"),n&&(x_.nonce=n),x_.setAttribute("type","text/css"),document.head.appendChild(x_)),x_.sheet&&(x_.sheet.insertRule(`@media ${e} {body{ }}`,0),AH.add(e))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(vr),vt(cl,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function _nt(e){return{matches:"all"===e||""===e,media:e,addListener:()=>{},removeListener:()=>{}}}let bnt=(()=>{class e{constructor(t,r){this._mediaMatcher=t,this._zone=r,this._queries=new Map,this._destroySubject=new we}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return IH(GI(t)).some(a=>this._registerQuery(a).mql.matches)}observe(t){let c=Jg(IH(GI(t)).map(h=>this._registerQuery(h).observable));return c=MC(c.pipe(nr(1)),c.pipe(TH(1),n2(0))),c.pipe(Ti(h=>{const f={matches:!1,breakpoints:{}};return h.forEach(({matches:b,query:x})=>{f.matches=f.matches||b,f.breakpoints[x]=b}),f}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const r=this._mediaMatcher.matchMedia(t),c={observable:new en(h=>{const f=b=>this._zone.run(()=>h.next(b));return r.addListener(f),()=>{r.removeListener(f)}}).pipe(Ws(r),Ti(({matches:h})=>({query:t,matches:h})),Si(this._destroySubject)),mql:r};return this._queries.set(t,c),c}static#t=this.\u0275fac=function(r){return new(r||e)(vt(fnt),vt(Re))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function IH(e){return e.map(n=>n.split(",")).reduce((n,t)=>n.concat(t)).map(n=>n.trim())}function o2(e,n,t){const r=s2(e,n);r.some(a=>a.trim()==t.trim())||(r.push(t.trim()),e.setAttribute(n,r.join(" ")))}function Vv(e,n,t){const a=s2(e,n).filter(c=>c!=t.trim());a.length?e.setAttribute(n,a.join(" ")):e.removeAttribute(n)}function s2(e,n){return(e.getAttribute(n)||"").match(/\S+/g)||[]}const PH="cdk-describedby-message",a2="cdk-describedby-host";let qN=0,OH=(()=>{class e{constructor(t,r){this._platform=r,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+qN++,this._document=t,this._id=oe(ig)+"-"+qN++}describe(t,r,a){if(!this._canBeDescribed(t,r))return;const c=YN(r,a);"string"!=typeof r?(FH(r,this._id),this._messageRegistry.set(c,{messageElement:r,referenceCount:0})):this._messageRegistry.has(c)||this._createMessageElement(r,a),this._isElementDescribedByMessage(t,c)||this._addMessageReference(t,c)}removeDescription(t,r,a){if(!r||!this._isElementNode(t))return;const c=YN(r,a);if(this._isElementDescribedByMessage(t,c)&&this._removeMessageReference(t,c),"string"==typeof r){const h=this._messageRegistry.get(c);h&&0===h.referenceCount&&this._deleteMessageElement(c)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const t=this._document.querySelectorAll(`[${a2}="${this._id}"]`);for(let r=0;r<t.length;r++)this._removeCdkDescribedByReferenceIds(t[r]),t[r].removeAttribute(a2);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(t,r){const a=this._document.createElement("div");FH(a,this._id),a.textContent=t,r&&a.setAttribute("role",r),this._createMessagesContainer(),this._messagesContainer.appendChild(a),this._messageRegistry.set(YN(t,r),{messageElement:a,referenceCount:0})}_deleteMessageElement(t){this._messageRegistry.get(t)?.messageElement?.remove(),this._messageRegistry.delete(t)}_createMessagesContainer(){if(this._messagesContainer)return;const t="cdk-describedby-message-container",r=this._document.querySelectorAll(`.${t}[platform="server"]`);for(let c=0;c<r.length;c++)r[c].remove();const a=this._document.createElement("div");a.style.visibility="hidden",a.classList.add(t),a.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&a.setAttribute("platform","server"),this._document.body.appendChild(a),this._messagesContainer=a}_removeCdkDescribedByReferenceIds(t){const r=s2(t,"aria-describedby").filter(a=>0!=a.indexOf(PH));t.setAttribute("aria-describedby",r.join(" "))}_addMessageReference(t,r){const a=this._messageRegistry.get(r);o2(t,"aria-describedby",a.messageElement.id),t.setAttribute(a2,this._id),a.referenceCount++}_removeMessageReference(t,r){const a=this._messageRegistry.get(r);a.referenceCount--,Vv(t,"aria-describedby",a.messageElement.id),t.removeAttribute(a2)}_isElementDescribedByMessage(t,r){const a=s2(t,"aria-describedby"),c=this._messageRegistry.get(r),h=c&&c.messageElement.id;return!!h&&-1!=a.indexOf(h)}_canBeDescribed(t,r){if(!this._isElementNode(t))return!1;if(r&&"object"==typeof r)return!0;const a=null==r?"":`${r}`.trim(),c=t.getAttribute("aria-label");return!(!a||c&&c.trim()===a)}_isElementNode(t){return t.nodeType===this._document.ELEMENT_NODE}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ki),vt(vr))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function YN(e,n){return"string"==typeof e?`${n||""}/${e}`:e}function FH(e,n){e.id||(e.id=`${PH}-${n}-${qN++}`)}class LH{constructor(n){this._items=n,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new we,this._typeaheadSubscription=lt.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new we,this.change=new we,n instanceof oh&&(this._itemChangesSubscription=n.changes.subscribe(t=>{if(this._activeItem){const a=t.toArray().indexOf(this._activeItem);a>-1&&a!==this._activeItemIndex&&(this._activeItemIndex=a)}}))}skipPredicate(n){return this._skipPredicateFn=n,this}withWrap(n=!0){return this._wrap=n,this}withVerticalOrientation(n=!0){return this._vertical=n,this}withHorizontalOrientation(n){return this._horizontal=n,this}withAllowedModifierKeys(n){return this._allowedModifierKeys=n,this}withTypeAhead(n=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Co(t=>this._pressedLetters.push(t)),n2(n),rr(()=>this._pressedLetters.length>0),Ti(()=>this._pressedLetters.join(""))).subscribe(t=>{const r=this._getItemsArray();for(let a=1;a<r.length+1;a++){const c=(this._activeItemIndex+a)%r.length,h=r[c];if(!this._skipPredicateFn(h)&&0===h.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(c);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(n=!0){return this._homeAndEnd=n,this}withPageUpDown(n=!0,t=10){return this._pageUpAndDown={enabled:n,delta:t},this}setActiveItem(n){const t=this._activeItem;this.updateActiveItem(n),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(n){const t=n.keyCode,a=["altKey","ctrlKey","metaKey","shiftKey"].every(c=>!n[c]||this._allowedModifierKeys.indexOf(c)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&a){this.setNextItemActive();break}return;case 38:if(this._vertical&&a){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&a){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&a){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&a){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&a){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&a){const c=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(c>0?c:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&a){const c=this._activeItemIndex+this._pageUpAndDown.delta,h=this._getItemsArray().length;this._setActiveItemByIndex(c<h?c:h-1,-1);break}return;default:return void((a||Do(n,"shiftKey"))&&(n.key&&1===n.key.length?this._letterKeyStream.next(n.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],n.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(n){const t=this._getItemsArray(),r="number"==typeof n?n:t.indexOf(n);this._activeItem=t[r]??null,this._activeItemIndex=r}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(n){this._wrap?this._setActiveInWrapMode(n):this._setActiveInDefaultMode(n)}_setActiveInWrapMode(n){const t=this._getItemsArray();for(let r=1;r<=t.length;r++){const a=(this._activeItemIndex+n*r+t.length)%t.length;if(!this._skipPredicateFn(t[a]))return void this.setActiveItem(a)}}_setActiveInDefaultMode(n){this._setActiveItemByIndex(this._activeItemIndex+n,n)}_setActiveItemByIndex(n,t){const r=this._getItemsArray();if(r[n]){for(;this._skipPredicateFn(r[n]);)if(!r[n+=t])return;this.setActiveItem(n)}}_getItemsArray(){return this._items instanceof oh?this._items.toArray():this._items}}class ynt extends LH{setActiveItem(n){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(n),this.activeItem&&this.activeItem.setActiveStyles()}}let AM=(()=>{class e{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function xnt(e){return!!(e.offsetWidth||e.offsetHeight||"function"==typeof e.getClientRects&&e.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const r=function vnt(e){try{return e.frameElement}catch{return null}}(function Ent(e){return e.ownerDocument&&e.ownerDocument.defaultView||window}(t));if(r&&(-1===zH(r)||!this.isVisible(r)))return!1;let a=t.nodeName.toLowerCase(),c=zH(t);return t.hasAttribute("contenteditable")?-1!==c:!("iframe"===a||"object"===a||this._platform.WEBKIT&&this._platform.IOS&&!function Snt(e){let n=e.nodeName.toLowerCase(),t="input"===n&&e.type;return"text"===t||"password"===t||"select"===n||"textarea"===n}(t))&&("audio"===a?!!t.hasAttribute("controls")&&-1!==c:"video"===a?-1!==c&&(null!==c||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,r){return function Tnt(e){return!function Cnt(e){return function Dnt(e){return"input"==e.nodeName.toLowerCase()}(e)&&"hidden"==e.type}(e)&&(function wnt(e){let n=e.nodeName.toLowerCase();return"input"===n||"select"===n||"button"===n||"textarea"===n}(e)||function Mnt(e){return function knt(e){return"a"==e.nodeName.toLowerCase()}(e)&&e.hasAttribute("href")}(e)||e.hasAttribute("contenteditable")||NH(e))}(t)&&!this.isDisabled(t)&&(r?.ignoreVisibility||this.isVisible(t))}static#t=this.\u0275fac=function(r){return new(r||e)(vt(vr))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function NH(e){if(!e.hasAttribute("tabindex")||void 0===e.tabIndex)return!1;let n=e.getAttribute("tabindex");return!(!n||isNaN(parseInt(n,10)))}function zH(e){if(!NH(e))return null;const n=parseInt(e.getAttribute("tabindex")||"",10);return isNaN(n)?-1:n}class Ant{get enabled(){return this._enabled}set enabled(n){this._enabled=n,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}constructor(n,t,r,a,c=!1){this._element=n,this._checker=t,this._ngZone=r,this._document=a,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,c||this.attachAnchors()}destroy(){const n=this._startAnchor,t=this._endAnchor;n&&(n.removeEventListener("focus",this.startAnchorListener),n.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(n){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(n)))})}focusFirstTabbableElementWhenReady(n){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(n)))})}focusLastTabbableElementWhenReady(n){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(n)))})}_getRegionBoundary(n){const t=this._element.querySelectorAll(`[cdk-focus-region-${n}], [cdkFocusRegion${n}], [cdk-focus-${n}]`);return"start"==n?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(n){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const r=this._getFirstTabbableElement(t);return r?.focus(n),!!r}return t.focus(n),!0}return this.focusFirstTabbableElement(n)}focusFirstTabbableElement(n){const t=this._getRegionBoundary("start");return t&&t.focus(n),!!t}focusLastTabbableElement(n){const t=this._getRegionBoundary("end");return t&&t.focus(n),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const t=n.children;for(let r=0;r<t.length;r++){const a=t[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[r]):null;if(a)return a}return null}_getLastTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const t=n.children;for(let r=t.length-1;r>=0;r--){const a=t[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[r]):null;if(a)return a}return null}_createAnchor(){const n=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,n),n.classList.add("cdk-visually-hidden"),n.classList.add("cdk-focus-trap-anchor"),n.setAttribute("aria-hidden","true"),n}_toggleAnchorTabIndex(n,t){n?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(n){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}_executeOnStable(n){this._ngZone.isStable?n():this._ngZone.onStable.pipe(nr(1)).subscribe(n)}}let IM=(()=>{class e{constructor(t,r,a){this._checker=t,this._ngZone=r,this._document=a}create(t,r=!1){return new Ant(t,this._checker,this._ngZone,this._document,r)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(AM),vt(Re),vt(ki))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Int=(()=>{class e{get enabled(){return this.focusTrap.enabled}set enabled(t){this.focusTrap.enabled=De(t)}get autoCapture(){return this._autoCapture}set autoCapture(t){this._autoCapture=De(t)}constructor(t,r,a){this._elementRef=t,this._focusTrapFactory=r,this._previouslyFocusedElement=null,this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0)}ngOnDestroy(){this.focusTrap.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap.hasAttached()||this.focusTrap.attachAnchors()}ngOnChanges(t){const r=t.autoCapture;r&&!r.firstChange&&this.autoCapture&&this.focusTrap.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=Fv(),this.focusTrap.focusInitialElementWhenReady()}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(IM),z(ki))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:["cdkTrapFocus","enabled"],autoCapture:["cdkTrapFocusAutoCapture","autoCapture"]},exportAs:["cdkTrapFocus"],features:[Bn]})}return e})();function VH(e){return 0===e.buttons||0===e.detail}function jH(e){const n=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}const Rnt=new kt("cdk-input-modality-detector-options"),Pnt={ignoreKeys:[18,17,224,91,16]},jv=Xc({passive:!0,capture:!0});let Ont=(()=>{class e{get mostRecentModality(){return this._modality.value}constructor(t,r,a,c){this._platform=t,this._mostRecentTarget=null,this._modality=new Yr(null),this._lastTouchMs=0,this._onKeydown=h=>{this._options?.ignoreKeys?.some(f=>f===h.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=kh(h))},this._onMousedown=h=>{Date.now()-this._lastTouchMs<650||(this._modality.next(VH(h)?"keyboard":"mouse"),this._mostRecentTarget=kh(h))},this._onTouchstart=h=>{jH(h)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=kh(h))},this._options={...Pnt,...c},this.modalityDetected=this._modality.pipe(TH(1)),this.modalityChanged=this.modalityDetected.pipe(wa()),t.isBrowser&&r.runOutsideAngular(()=>{a.addEventListener("keydown",this._onKeydown,jv),a.addEventListener("mousedown",this._onMousedown,jv),a.addEventListener("touchstart",this._onTouchstart,jv)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,jv),document.removeEventListener("mousedown",this._onMousedown,jv),document.removeEventListener("touchstart",this._onTouchstart,jv))}static#t=this.\u0275fac=function(r){return new(r||e)(vt(vr),vt(Re),vt(ki),vt(Rnt,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Fnt=new kt("liveAnnouncerElement",{providedIn:"root",factory:function Lnt(){return null}}),Bnt=new kt("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let Nnt=0,znt=(()=>{class e{constructor(t,r,a,c){this._ngZone=r,this._defaultOptions=c,this._document=a,this._liveElement=t||this._createLiveElement()}announce(t,...r){const a=this._defaultOptions;let c,h;return 1===r.length&&"number"==typeof r[0]?h=r[0]:[c,h]=r,this.clear(),clearTimeout(this._previousTimeout),c||(c=a&&a.politeness?a.politeness:"polite"),null==h&&a&&(h=a.duration),this._liveElement.setAttribute("aria-live",c),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(f=>this._currentResolve=f)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,"number"==typeof h&&(this._previousTimeout=setTimeout(()=>this.clear(),h)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const t="cdk-live-announcer-element",r=this._document.getElementsByClassName(t),a=this._document.createElement("div");for(let c=0;c<r.length;c++)r[c].remove();return a.classList.add(t),a.classList.add("cdk-visually-hidden"),a.setAttribute("aria-atomic","true"),a.setAttribute("aria-live","polite"),a.id="cdk-live-announcer-"+Nnt++,this._document.body.appendChild(a),a}_exposeAnnouncerToModals(t){const r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let a=0;a<r.length;a++){const c=r[a],h=c.getAttribute("aria-owns");h?-1===h.indexOf(t)&&c.setAttribute("aria-owns",h+" "+t):c.setAttribute("aria-owns",t)}}static#t=this.\u0275fac=function(r){return new(r||e)(vt(Fnt,8),vt(Re),vt(ki),vt(Bnt,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Vnt=new kt("cdk-focus-monitor-default-options"),l2=Xc({passive:!0,capture:!0});let dc=(()=>{class e{constructor(t,r,a,c,h){this._ngZone=t,this._platform=r,this._inputModalityDetector=a,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new we,this._rootNodeFocusAndBlurListener=f=>{for(let x=kh(f);x;x=x.parentElement)"focus"===f.type?this._onFocus(f,x):this._onBlur(f,x)},this._document=c,this._detectionMode=h?.detectionMode||0}monitor(t,r=!1){const a=Dh(t);if(!this._platform.isBrowser||1!==a.nodeType)return Le();const c=function Oit(e){if(function Pit(){if(null==NN){const e=typeof document<"u"?document.head:null;NN=!(!e||!e.createShadowRoot&&!e.attachShadow)}return NN}()){const n=e.getRootNode?e.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}(a)||this._getDocument(),h=this._elementInfo.get(a);if(h)return r&&(h.checkChildren=!0),h.subject;const f={checkChildren:r,subject:new we,rootNode:c};return this._elementInfo.set(a,f),this._registerGlobalListeners(f),f.subject}stopMonitoring(t){const r=Dh(t),a=this._elementInfo.get(r);a&&(a.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(a))}focusVia(t,r,a){const c=Dh(t);c===this._getDocument().activeElement?this._getClosestElementsInfo(c).forEach(([f,b])=>this._originChanged(f,r,b)):(this._setOrigin(r),"function"==typeof c.focus&&c.focus(a))}ngOnDestroy(){this._elementInfo.forEach((t,r)=>this.stopMonitoring(r))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,r){t.classList.toggle("cdk-focused",!!r),t.classList.toggle("cdk-touch-focused","touch"===r),t.classList.toggle("cdk-keyboard-focused","keyboard"===r),t.classList.toggle("cdk-mouse-focused","mouse"===r),t.classList.toggle("cdk-program-focused","program"===r)}_setOrigin(t,r=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&r,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,r){const a=this._elementInfo.get(r),c=kh(t);!a||!a.checkChildren&&r!==c||this._originChanged(r,this._getFocusOrigin(c),a)}_onBlur(t,r){const a=this._elementInfo.get(r);!a||a.checkChildren&&t.relatedTarget instanceof Node&&r.contains(t.relatedTarget)||(this._setClasses(r),this._emitOrigin(a,null))}_emitOrigin(t,r){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(r))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const r=t.rootNode,a=this._rootNodeFocusListenerCount.get(r)||0;a||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,l2),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,l2)}),this._rootNodeFocusListenerCount.set(r,a+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Si(this._stopInputModalityDetector)).subscribe(c=>{this._setOrigin(c,!0)}))}_removeGlobalListeners(t){const r=t.rootNode;if(this._rootNodeFocusListenerCount.has(r)){const a=this._rootNodeFocusListenerCount.get(r);a>1?this._rootNodeFocusListenerCount.set(r,a-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,l2),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,l2),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,r,a){this._setClasses(t,r),this._emitOrigin(a,r),this._lastFocusOrigin=r}_getClosestElementsInfo(t){const r=[];return this._elementInfo.forEach((a,c)=>{(c===t||a.checkChildren&&c.contains(t))&&r.push([c,a])}),r}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:r,mostRecentModality:a}=this._inputModalityDetector;if("mouse"!==a||!r||r===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const c=t.labels;if(c)for(let h=0;h<c.length;h++)if(c[h].contains(r))return!0;return!1}static#t=this.\u0275fac=function(r){return new(r||e)(vt(Re),vt(vr),vt(Ont),vt(ki,8),vt(Vnt,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),jnt=(()=>{class e{constructor(t,r){this._elementRef=t,this._focusMonitor=r,this._focusOrigin=null,this.cdkFocusChange=new me}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){const t=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(t,1===t.nodeType&&t.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(r=>{this._focusOrigin=r,this.cdkFocusChange.emit(r)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(dc))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"]})}return e})();const HH="cdk-high-contrast-black-on-white",$H="cdk-high-contrast-white-on-black",ZN="cdk-high-contrast-active";let GH=(()=>{class e{constructor(t,r){this._platform=t,this._document=r,this._breakpointSubscription=oe(bnt).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const r=this._document.defaultView||window,a=r&&r.getComputedStyle?r.getComputedStyle(t):null,c=(a&&a.backgroundColor||"").replace(/ /g,"");switch(t.remove(),c){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(ZN,HH,$H),this._hasCheckedHighContrastMode=!0;const r=this.getHighContrastMode();1===r?t.add(ZN,HH):2===r&&t.add(ZN,$H)}}static#t=this.\u0275fac=function(r){return new(r||e)(vt(vr),vt(ki))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),c2=(()=>{class e{constructor(t){t._applyBodyHighContrastModeCssClasses()}static#t=this.\u0275fac=function(r){return new(r||e)(vt(GH))};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[r2]})}return e})();function Unt(e,n){}class d2{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}}let WH=(()=>{class e extends UN{constructor(t,r,a,c,h,f,b,x){super(),this._elementRef=t,this._focusTrapFactory=r,this._config=c,this._interactivityChecker=h,this._ngZone=f,this._overlayRef=b,this._focusMonitor=x,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this.attachDomPortal=M=>{this._portalOutlet.hasAttached();const T=this._portalOutlet.attachDomPortal(M);return this._contentAttached(),T},this._document=a,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(t){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachComponentPortal(t);return this._contentAttached(),r}attachTemplatePortal(t){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachTemplatePortal(t);return this._contentAttached(),r}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(t,r){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const a=()=>{t.removeEventListener("blur",a),t.removeEventListener("mousedown",a),t.removeAttribute("tabindex")};t.addEventListener("blur",a),t.addEventListener("mousedown",a)})),t.focus(r)}_focusByCssSelector(t,r){let a=this._elementRef.nativeElement.querySelector(t);a&&this._forceFocus(a,r)}_trapFocus(){const t=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||t.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(r=>{r||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const t=this._config.restoreFocus;let r=null;if("string"==typeof t?r=this._document.querySelector(t):"boolean"==typeof t?r=t?this._elementFocusedBeforeDialogWasOpened:null:t&&(r=t),this._config.restoreFocus&&r&&"function"==typeof r.focus){const a=Fv(),c=this._elementRef.nativeElement;(!a||a===this._document.body||a===c||c.contains(a))&&(this._focusMonitor?(this._focusMonitor.focusVia(r,this._closeInteractionType),this._closeInteractionType=null):r.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,r=Fv();return t===r||t.contains(r)}_initializeFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=Fv())}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(IM),z(ki,8),z(d2),z(AM),z(Re),z(EM),z(dc))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["cdk-dialog-container"]],viewQuery:function(r,a){if(1&r&&Hi(DM,7),2&r){let c;pe(c=fe())&&(a._portalOutlet=c.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(r,a){2&r&&Ve("id",a._config.id||null)("role",a._config.role)("aria-modal",a._config.ariaModal)("aria-labelledby",a._config.ariaLabel?null:a._ariaLabelledByQueue[0])("aria-label",a._config.ariaLabel)("aria-describedby",a._config.ariaDescribedBy||null)},features:[Xt],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(r,a){1&r&&Kt(0,Unt,0,0,"ng-template",0)},dependencies:[DM],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2})}return e})();class XN{constructor(n,t){this.overlayRef=n,this.config=t,this.closed=new we,this.disableClose=t.disableClose,this.backdropClick=n.backdropClick(),this.keydownEvents=n.keydownEvents(),this.outsidePointerEvents=n.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(r=>{27===r.keyCode&&!this.disableClose&&!Do(r)&&(r.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=n.detachments().subscribe(()=>{!1!==t.closeOnOverlayDetachments&&this.close()})}close(n,t){if(this.containerInstance){const r=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),r.next(n),r.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(n="",t=""){return this.overlayRef.updateSize({width:n,height:t}),this}addPanelClass(n){return this.overlayRef.addPanelClass(n),this}removePanelClass(n){return this.overlayRef.removePanelClass(n),this}}const qH=new kt("DialogScrollStrategy"),Hnt=new kt("DialogData"),$nt=new kt("DefaultDialogConfig"),Wnt={provide:qH,deps:[_a],useFactory:function Gnt(e){return()=>e.scrollStrategies.block()}};let qnt=0,YH=(()=>{class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(t,r,a,c,h,f){this._overlay=t,this._injector=r,this._defaultOptions=a,this._parentDialog=c,this._overlayContainer=h,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new we,this._afterOpenedAtThisLevel=new we,this._ariaHiddenElements=new Map,this.afterAllClosed=cv(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Ws(void 0))),this._scrollStrategy=f}open(t,r){(r={...this._defaultOptions||new d2,...r}).id=r.id||"cdk-dialog-"+qnt++,r.id&&this.getDialogById(r.id);const c=this._getOverlayConfig(r),h=this._overlay.create(c),f=new XN(h,r),b=this._attachContainer(h,f,r);return f.containerInstance=b,this._attachDialogContent(t,f,b,r),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(f),f.closed.subscribe(()=>this._removeOpenDialog(f,!0)),this.afterOpened.next(f),f}closeAll(){KN(this.openDialogs,t=>t.close())}getDialogById(t){return this.openDialogs.find(r=>r.id===t)}ngOnDestroy(){KN(this._openDialogsAtThisLevel,t=>{!1===t.config.closeOnDestroy&&this._removeOpenDialog(t,!1)}),KN(this._openDialogsAtThisLevel,t=>t.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(t){const r=new TM({positionStrategy:t.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,width:t.width,height:t.height,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(r.backdropClass=t.backdropClass),r}_attachContainer(t,r,a){const c=a.injector||a.viewContainerRef?.injector,h=[{provide:d2,useValue:a},{provide:XN,useValue:r},{provide:EM,useValue:t}];let f;a.container?"function"==typeof a.container?f=a.container:(f=a.container.type,h.push(...a.container.providers(a))):f=WH;const b=new Bv(f,a.viewContainerRef,oo.create({parent:c||this._injector,providers:h}),a.componentFactoryResolver);return t.attach(b).instance}_attachDialogContent(t,r,a,c){if(t instanceof Jr){const h=this._createInjector(c,r,a,void 0);let f={$implicit:c.data,dialogRef:r};c.templateContext&&(f={...f,..."function"==typeof c.templateContext?c.templateContext():c.templateContext}),a.attachTemplatePortal(new KI(t,null,f,h))}else{const h=this._createInjector(c,r,a,this._injector),f=a.attachComponentPortal(new Bv(t,c.viewContainerRef,h,c.componentFactoryResolver));r.componentRef=f,r.componentInstance=f.instance}}_createInjector(t,r,a,c){const h=t.injector||t.viewContainerRef?.injector,f=[{provide:Hnt,useValue:t.data},{provide:XN,useValue:r}];return t.providers&&("function"==typeof t.providers?f.push(...t.providers(r,t,a)):f.push(...t.providers)),t.direction&&(!h||!h.get(es,null,{optional:!0}))&&f.push({provide:es,useValue:{value:t.direction,change:Le()}}),oo.create({parent:h||c,providers:f})}_removeOpenDialog(t,r){const a=this.openDialogs.indexOf(t);a>-1&&(this.openDialogs.splice(a,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((c,h)=>{c?h.setAttribute("aria-hidden",c):h.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),r&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const r=t.parentElement.children;for(let a=r.length-1;a>-1;a--){const c=r[a];c!==t&&"SCRIPT"!==c.nodeName&&"STYLE"!==c.nodeName&&!c.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(c,c.getAttribute("aria-hidden")),c.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}static#t=this.\u0275fac=function(r){return new(r||e)(vt(_a),vt(oo),vt($nt,8),vt(e,12),vt(e2),vt(qH))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();function KN(e,n){let t=e.length;for(;t--;)n(e[t])}let ZH=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[YH,Wnt],imports:[jp,Vp,c2,Vp]})}return e})();const Ynt=["text"];function Znt(e,n){if(1&e&&je(0,"mat-pseudo-checkbox",6),2&e){const t=Ne();It("disabled",t.disabled)("state",t.selected?"checked":"unchecked")}}function Xnt(e,n){1&e&&je(0,"mat-pseudo-checkbox",7),2&e&&It("disabled",Ne().disabled)}function Knt(e,n){if(1&e&&(ht(0,"span",8),be(1),ft()),2&e){const t=Ne();St(1),Ln("(",t.group.label,")")}}const Qnt=[[["mat-icon"]],"*"],Jnt=["mat-icon","*"];let QN=(()=>{class e{static#t=this.STANDARD_CURVE="cubic-bezier(0.4,0.0,0.2,1)";static#e=this.DECELERATION_CURVE="cubic-bezier(0.0,0.0,0.2,1)";static#i=this.ACCELERATION_CURVE="cubic-bezier(0.4,0.0,1,1)";static#n=this.SHARP_CURVE="cubic-bezier(0.4,0.0,0.6,1)"}return e})(),JN=(()=>{class e{static#t=this.COMPLEX="375ms";static#e=this.ENTERING="225ms";static#i=this.EXITING="195ms"}return e})();const ert=new kt("mat-sanity-checks",{providedIn:"root",factory:function trt(){return!0}});let yi=(()=>{class e{constructor(t,r,a){this._sanityChecks=r,this._document=a,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!zN()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}static#t=this.\u0275fac=function(r){return new(r||e)(vt(GH),vt(ert,8),vt(ki))};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[wM,wM]})}return e})();function Up(e){return class extends e{get disabled(){return this._disabled}set disabled(n){this._disabled=De(n)}constructor(...n){super(...n),this._disabled=!1}}}function Uv(e,n){return class extends e{get color(){return this._color}set color(t){const r=t||this.defaultColor;r!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),r&&this._elementRef.nativeElement.classList.add(`mat-${r}`),this._color=r)}constructor(...t){super(...t),this.defaultColor=n,this.color=n}}}function Hv(e){return class extends e{get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=De(n)}constructor(...n){super(...n),this._disableRipple=!1}}}function w_(e,n=0){return class extends e{get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?ts(t):this.defaultTabIndex}constructor(...t){super(...t),this._tabIndex=n,this.defaultTabIndex=n}}}function tz(e){return class extends e{updateErrorState(){const n=this.errorState,c=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);c!==n&&(this.errorState=c,this.stateChanges.next())}constructor(...n){super(...n),this.errorState=!1}}}function QH(e){return class extends e{constructor(...n){super(...n),this._isInitialized=!1,this._pendingSubscribers=[],this.initialized=new en(t=>{this._isInitialized?this._notifySubscriber(t):this._pendingSubscribers.push(t)})}_markInitialized(){this._isInitialized=!0,this._pendingSubscribers.forEach(this._notifySubscriber),this._pendingSubscribers=null}_notifySubscriber(n){n.next(),n.complete()}}}const irt=new kt("MAT_DATE_LOCALE",{providedIn:"root",factory:function nrt(){return oe(rc)}});class Ms{constructor(){this._localeChanges=new we,this.localeChanges=this._localeChanges}getValidDateOrNull(n){return this.isDateInstance(n)&&this.isValid(n)?n:null}deserialize(n){return null==n||this.isDateInstance(n)&&this.isValid(n)?n:this.invalid()}setLocale(n){this.locale=n,this._localeChanges.next()}compareDate(n,t){return this.getYear(n)-this.getYear(t)||this.getMonth(n)-this.getMonth(t)||this.getDate(n)-this.getDate(t)}sameDate(n,t){if(n&&t){let r=this.isValid(n),a=this.isValid(t);return r&&a?!this.compareDate(n,t):r==a}return n==t}clampDate(n,t,r){return t&&this.compareDate(n,t)<0?t:r&&this.compareDate(n,r)>0?r:n}}const C_=new kt("mat-date-formats"),rrt=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function ez(e,n){const t=Array(e);for(let r=0;r<e;r++)t[r]=n(r);return t}let ort=(()=>{class e extends Ms{constructor(t,r){super(),this.useUtcForDisplay=!1,super.setLocale(t)}getYear(t){return t.getFullYear()}getMonth(t){return t.getMonth()}getDate(t){return t.getDate()}getDayOfWeek(t){return t.getDay()}getMonthNames(t){const r=new Intl.DateTimeFormat(this.locale,{month:t,timeZone:"utc"});return ez(12,a=>this._format(r,new Date(2017,a,1)))}getDateNames(){const t=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return ez(31,r=>this._format(t,new Date(2017,0,r+1)))}getDayOfWeekNames(t){const r=new Intl.DateTimeFormat(this.locale,{weekday:t,timeZone:"utc"});return ez(7,a=>this._format(r,new Date(2017,0,a+1)))}getYearName(t){const r=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(r,t)}getFirstDayOfWeek(){return 0}getNumDaysInMonth(t){return this.getDate(this._createDateWithOverflow(this.getYear(t),this.getMonth(t)+1,0))}clone(t){return new Date(t.getTime())}createDate(t,r,a){let c=this._createDateWithOverflow(t,r,a);return c.getMonth(),c}today(){return new Date}parse(t,r){return"number"==typeof t?new Date(t):t?new Date(Date.parse(t)):null}format(t,r){if(!this.isValid(t))throw Error("NativeDateAdapter: Cannot format invalid date.");const a=new Intl.DateTimeFormat(this.locale,{...r,timeZone:"utc"});return this._format(a,t)}addCalendarYears(t,r){return this.addCalendarMonths(t,12*r)}addCalendarMonths(t,r){let a=this._createDateWithOverflow(this.getYear(t),this.getMonth(t)+r,this.getDate(t));return this.getMonth(a)!=((this.getMonth(t)+r)%12+12)%12&&(a=this._createDateWithOverflow(this.getYear(a),this.getMonth(a),0)),a}addCalendarDays(t,r){return this._createDateWithOverflow(this.getYear(t),this.getMonth(t),this.getDate(t)+r)}toIso8601(t){return[t.getUTCFullYear(),this._2digit(t.getUTCMonth()+1),this._2digit(t.getUTCDate())].join("-")}deserialize(t){if("string"==typeof t){if(!t)return null;if(rrt.test(t)){let r=new Date(t);if(this.isValid(r))return r}}return super.deserialize(t)}isDateInstance(t){return t instanceof Date}isValid(t){return!isNaN(t.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(t,r,a){const c=new Date;return c.setFullYear(t,r,a),c.setHours(0,0,0,0),c}_2digit(t){return("00"+t).slice(-2)}_format(t,r){const a=new Date;return a.setUTCFullYear(r.getFullYear(),r.getMonth(),r.getDate()),a.setUTCHours(r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),t.format(a)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(irt,8),vt(vr))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();const srt={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let art=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[{provide:Ms,useClass:ort}]})}return e})(),lrt=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[{provide:C_,useValue:srt}],imports:[art]})}return e})(),u2=(()=>{class e{isErrorState(t,r){return!!(t&&t.invalid&&(t.touched||r&&r.submitted))}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),JH=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,yi]})}return e})();class crt{constructor(n,t,r,a=!1){this._renderer=n,this.element=t,this.config=r,this._animationForciblyDisabledThroughCss=a,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const t8=Xc({passive:!0,capture:!0});class drt{constructor(){this._events=new Map,this._delegateEventHandler=n=>{const t=kh(n);t&&this._events.get(n.type)?.forEach((r,a)=>{(a===t||a.contains(t))&&r.forEach(c=>c.handleEvent(n))})}}addHandler(n,t,r,a){const c=this._events.get(t);if(c){const h=c.get(r);h?h.add(a):c.set(r,new Set([a]))}else this._events.set(t,new Map([[r,new Set([a])]])),n.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,t8)})}removeHandler(n,t,r){const a=this._events.get(n);if(!a)return;const c=a.get(t);c&&(c.delete(r),0===c.size&&a.delete(t),0===a.size&&(this._events.delete(n),document.removeEventListener(n,this._delegateEventHandler,t8)))}}const e8={enterDuration:225,exitDuration:150},i8=Xc({passive:!0,capture:!0}),n8=["mousedown","touchstart"],r8=["mouseup","mouseleave","touchend","touchcancel"];class PM{static#t=this._eventManager=new drt;constructor(n,t,r,a){this._target=n,this._ngZone=t,this._platform=a,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,a.isBrowser&&(this._containerElement=Dh(r))}fadeInRipple(n,t,r={}){const a=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),c={...e8,...r.animation};r.centered&&(n=a.left+a.width/2,t=a.top+a.height/2);const h=r.radius||function hrt(e,n,t){const r=Math.max(Math.abs(e-t.left),Math.abs(e-t.right)),a=Math.max(Math.abs(n-t.top),Math.abs(n-t.bottom));return Math.sqrt(r*r+a*a)}(n,t,a),f=n-a.left,b=t-a.top,x=c.enterDuration,M=document.createElement("div");M.classList.add("mat-ripple-element"),M.style.left=f-h+"px",M.style.top=b-h+"px",M.style.height=2*h+"px",M.style.width=2*h+"px",null!=r.color&&(M.style.backgroundColor=r.color),M.style.transitionDuration=`${x}ms`,this._containerElement.appendChild(M);const T=window.getComputedStyle(M),L=T.transitionDuration,N="none"===T.transitionProperty||"0s"===L||"0s, 0s"===L||0===a.width&&0===a.height,V=new crt(this,M,r,N);M.style.transform="scale3d(1, 1, 1)",V.state=0,r.persistent||(this._mostRecentTransientRipple=V);let $=null;return!N&&(x||c.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const nt=()=>this._finishRippleTransition(V),tt=()=>this._destroyRipple(V);M.addEventListener("transitionend",nt),M.addEventListener("transitioncancel",tt),$={onTransitionEnd:nt,onTransitionCancel:tt}}),this._activeRipples.set(V,$),(N||!x)&&this._finishRippleTransition(V),V}fadeOutRipple(n){if(2===n.state||3===n.state)return;const t=n.element,r={...e8,...n.config.animation};t.style.transitionDuration=`${r.exitDuration}ms`,t.style.opacity="0",n.state=2,(n._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(n)}fadeOutAll(){this._getActiveRipples().forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){const t=Dh(n);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,n8.forEach(r=>{PM._eventManager.addHandler(this._ngZone,r,t,this)}))}handleEvent(n){"mousedown"===n.type?this._onMousedown(n):"touchstart"===n.type?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{r8.forEach(t=>{this._triggerElement.addEventListener(t,this,i8)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(n){0===n.state?this._startFadeOutTransition(n):2===n.state&&this._destroyRipple(n)}_startFadeOutTransition(n){const t=n===this._mostRecentTransientRipple,{persistent:r}=n.config;n.state=1,!r&&(!t||!this._isPointerDown)&&n.fadeOut()}_destroyRipple(n){const t=this._activeRipples.get(n)??null;this._activeRipples.delete(n),this._activeRipples.size||(this._containerRect=null),n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),n.state=3,null!==t&&(n.element.removeEventListener("transitionend",t.onTransitionEnd),n.element.removeEventListener("transitioncancel",t.onTransitionCancel)),n.element.remove()}_onMousedown(n){const t=VH(n),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!r&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!jH(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=n.changedTouches;if(t)for(let r=0;r<t.length;r++)this.fadeInRipple(t[r].clientX,t[r].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(n=>{!n.config.persistent&&(1===n.state||n.config.terminateOnPointerUp&&0===n.state)&&n.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const n=this._triggerElement;n&&(n8.forEach(t=>PM._eventManager.removeHandler(t,n,this)),this._pointerUpEventsRegistered&&r8.forEach(t=>n.removeEventListener(t,this,i8)))}}const $v=new kt("mat-ripple-global-options");let Gv=(()=>{class e{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,r,a,c,h){this._elementRef=t,this._animationMode=h,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=c||{},this._rippleRenderer=new PM(this,r,t,a)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,r=0,a){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,r,{...this.rippleConfig,...a}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(Re),z(vr),z($v,8),z(Pr,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(r,a){2&r&&Qe("mat-ripple-unbounded",a.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return e})(),Ah=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,yi]})}return e})(),mrt=(()=>{class e{constructor(t){this._animationMode=t,this.state="unchecked",this.disabled=!1,this.appearance="full"}static#t=this.\u0275fac=function(r){return new(r||e)(z(Pr,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(r,a){2&r&&Qe("mat-pseudo-checkbox-indeterminate","indeterminate"===a.state)("mat-pseudo-checkbox-checked","checked"===a.state)("mat-pseudo-checkbox-disabled",a.disabled)("mat-pseudo-checkbox-minimal","minimal"===a.appearance)("mat-pseudo-checkbox-full","full"===a.appearance)("_mat-animation-noopable","NoopAnimations"===a._animationMode)},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},decls:0,vars:0,template:function(r,a){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-full{border:2px solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0})}return e})(),o8=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi]})}return e})();const s8=new kt("MAT_OPTION_PARENT_COMPONENT"),a8=new kt("MatOptgroup");let prt=0;class l8{constructor(n,t=!1){this.source=n,this.isUserInput=t}}let frt=(()=>{class e{get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(t){this._disabled=De(t)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get hideSingleSelectionIndicator(){return!(!this._parent||!this._parent.hideSingleSelectionIndicator)}constructor(t,r,a,c){this._element=t,this._changeDetectorRef=r,this._parent=a,this.group=c,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+prt++,this.onSelectionChange=new me,this._stateChanges=new we}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(t=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),t&&this._emitSelectionChangeEvent())}deselect(t=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),t&&this._emitSelectionChangeEvent())}focus(t,r){const a=this._getHostElement();"function"==typeof a.focus&&a.focus(r)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(t){(13===t.keyCode||32===t.keyCode)&&!Do(t)&&(this._selectViaInteraction(),t.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const t=this.viewValue;t!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=t)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(t=!1){this.onSelectionChange.emit(new l8(this,t))}static#t=this.\u0275fac=function(r){dl()};static#e=this.\u0275dir=Mt({type:e,viewQuery:function(r,a){if(1&r&&Hi(Ynt,7),2&r){let c;pe(c=fe())&&(a._text=c.first)}},inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}})}return e})(),iz=(()=>{class e extends frt{constructor(t,r,a,c){super(t,r,a,c)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(Et),z(s8,8),z(a8,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(r,a){1&r&&Se("click",function(){return a._selectViaInteraction()})("keydown",function(h){return a._handleKeydown(h)}),2&r&&(Ao("id",a.id),Ve("aria-selected",a.selected)("aria-disabled",a.disabled.toString()),Qe("mdc-list-item--selected",a.selected)("mat-mdc-option-multiple",a.multiple)("mat-mdc-option-active",a.active)("mdc-list-item--disabled",a.disabled))},exportAs:["matOption"],features:[Xt],ngContentSelectors:Jnt,decls:8,vars:5,consts:[["class","mat-mdc-option-pseudo-checkbox","aria-hidden","true",3,"disabled","state",4,"ngIf"],[1,"mdc-list-item__primary-text"],["text",""],["class","mat-mdc-option-pseudo-checkbox","state","checked","aria-hidden","true","appearance","minimal",3,"disabled",4,"ngIf"],["class","cdk-visually-hidden",4,"ngIf"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"]],template:function(r,a){1&r&&(xn(Qnt),Kt(0,Znt,1,2,"mat-pseudo-checkbox",0),Oe(1),ht(2,"span",1,2),Oe(4,1),ft(),Kt(5,Xnt,1,1,"mat-pseudo-checkbox",3),Kt(6,Knt,2,1,"span",4),je(7,"div",5)),2&r&&(It("ngIf",a.multiple),St(5),It("ngIf",!a.multiple&&a.selected&&!a.hideSingleSelectionIndicator),St(1),It("ngIf",a.group&&a.group._inert),St(1),It("matRippleTrigger",a._getHostElement())("matRippleDisabled",a.disabled||a.disableRipple))},dependencies:[Gv,La,mrt],styles:['.mat-mdc-option{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color);font-family:var(--mat-option-label-text-font);line-height:var(--mat-option-label-text-line-height);font-size:var(--mat-option-label-text-size);letter-spacing:var(--mat-option-label-text-tracking);font-weight:var(--mat-option-label-text-weight);min-height:48px}.mat-mdc-option:focus{outline:none}[dir=rtl] .mat-mdc-option,.mat-mdc-option[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color)}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color)}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color)}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color)}.mat-mdc-option.mdc-list-item{align-items:center}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}.cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{right:auto;left:16px}.mat-mdc-option-active .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return e})();let h2=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[Ah,ws,yi,o8]})}return e})();const u8={capture:!0},h8=["focus","click","mouseenter","touchstart"],nz="mat-ripple-loader-uninitialized",rz="mat-ripple-loader-class-name",m8="mat-ripple-loader-centered",m2="mat-ripple-loader-disabled";let p8=(()=>{class e{constructor(){this._document=oe(ki,{optional:!0}),this._animationMode=oe(Pr,{optional:!0}),this._globalRippleOptions=oe($v,{optional:!0}),this._platform=oe(vr),this._ngZone=oe(Re),this._hosts=new Map,this._onInteraction=t=>{if(!(t.target instanceof HTMLElement))return;const a=t.target.closest(`[${nz}]`);a&&this._createRipple(a)},this._ngZone.runOutsideAngular(()=>{for(const t of h8)this._document?.addEventListener(t,this._onInteraction,u8)})}ngOnDestroy(){const t=this._hosts.keys();for(const r of t)this.destroyRipple(r);for(const r of h8)this._document?.removeEventListener(r,this._onInteraction,u8)}configureRipple(t,r){t.setAttribute(nz,""),(r.className||!t.hasAttribute(rz))&&t.setAttribute(rz,r.className||""),r.centered&&t.setAttribute(m8,""),r.disabled&&t.setAttribute(m2,"")}getRipple(t){return this._hosts.get(t)||this._createRipple(t)}setDisabled(t,r){const a=this._hosts.get(t);a?a.disabled=r:r?t.setAttribute(m2,""):t.removeAttribute(m2)}_createRipple(t){if(!this._document)return;const r=this._hosts.get(t);if(r)return r;t.querySelector(".mat-ripple")?.remove();const a=this._document.createElement("span");a.classList.add("mat-ripple",t.getAttribute(rz)),t.append(a);const c=new Gv(new Me(a),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return c._isInitialized=!0,c.trigger=t,c.centered=t.hasAttribute(m8),c.disabled=t.hasAttribute(m2),this.attachRipple(t,c),c}attachRipple(t,r){t.removeAttribute(nz),this._hosts.set(t,r)}destroyRipple(t){const r=this._hosts.get(t);r&&(r.ngOnDestroy(),this._hosts.delete(t))}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class f8{}class grt{}const Ih="*";function Po(e,n){return{type:7,name:e,definitions:n,options:{}}}function Fn(e,n=null){return{type:4,styles:n,timings:e}}function g8(e,n=null){return{type:2,steps:e,options:n}}function oi(e){return{type:6,styles:e,offset:null}}function Hn(e,n,t){return{type:0,name:e,styles:n,options:t}}function Wv(e){return{type:5,steps:e}}function Tn(e,n,t=null){return{type:1,expr:e,animation:n,options:t}}function qv(e=null){return{type:9,options:e}}function Yv(e,n,t=null){return{type:11,selector:e,animation:n,options:t}}class FM{constructor(n=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const t="start"==n?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}class _8{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let t=0,r=0,a=0;const c=this.players.length;0==c?queueMicrotask(()=>this._onFinish()):this.players.forEach(h=>{h.onDone(()=>{++t==c&&this._onFinish()}),h.onDestroy(()=>{++r==c&&this._onDestroy()}),h.onStart(()=>{++a==c&&this._onStart()})}),this.totalTime=this.players.reduce((h,f)=>Math.max(h,f.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const t=n*this.totalTime;this.players.forEach(r=>{const a=r.totalTime?Math.min(1,t/r.totalTime):1;r.setPosition(a)})}getPosition(){const n=this.players.reduce((t,r)=>null===t||r.totalTime>t.totalTime?r:t,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const t="start"==n?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}function _rt(e,n){}class p2{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const sz="mdc-dialog--open",b8="mdc-dialog--opening",y8="mdc-dialog--closing";let vrt=(()=>{class e extends WH{constructor(t,r,a,c,h,f,b,x){super(t,r,a,c,h,f,b,x),this._animationStateChanged=new me}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(t){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:t})}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(IM),z(ki,8),z(p2),z(AM),z(Re),z(EM),z(dc))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["ng-component"]],features:[Xt],decls:0,vars:0,template:function(r,a){},encapsulation:2})}return e})();const v8="--mat-dialog-transition-duration";function x8(e){return null==e?null:"number"==typeof e?e:e.endsWith("ms")?ts(e.substring(0,e.length-2)):e.endsWith("s")?1e3*ts(e.substring(0,e.length-1)):"0"===e?0:null}let xrt=(()=>{class e extends vrt{constructor(t,r,a,c,h,f,b,x,M){super(t,r,a,c,h,f,b,M),this._animationMode=x,this._animationsEnabled="NoopAnimations"!==this._animationMode,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?x8(this._config.enterAnimationDuration)??150:0,this._exitAnimationDuration=this._animationsEnabled?x8(this._config.exitAnimationDuration)??75:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(v8,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(b8,sz)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(sz),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(sz),this._animationsEnabled?(this._hostElement.style.setProperty(v8,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(y8)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_clearAnimationClasses(){this._hostElement.classList.remove(b8,y8)}_waitForAnimationToComplete(t,r){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(r,t)}_requestAnimationFrame(t){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(t):t()})}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(IM),z(ki,8),z(p2),z(AM),z(Re),z(EM),z(Pr,8),z(dc))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:8,hostBindings:function(r,a){2&r&&(Ao("id",a._config.id),Ve("aria-modal",a._config.ariaModal)("role",a._config.role)("aria-labelledby",a._config.ariaLabel?null:a._ariaLabelledByQueue[0])("aria-label",a._config.ariaLabel)("aria-describedby",a._config.ariaDescribedBy||null),Qe("_mat-animation-noopable",!a._animationsEnabled))},features:[Xt],decls:3,vars:0,consts:[[1,"mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(r,a){1&r&&(ht(0,"div",0)(1,"div",1),Kt(2,_rt,0,0,"ng-template",2),ft()())},dependencies:[DM],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px),(max-width: 600px),(min-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;transform:scale(0.8);opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto;outline:0}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid rgba(0,0,0,0);display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--fullscreen--titleless .mdc-dialog__close{margin-top:4px}.mdc-dialog--fullscreen--titleless.mdc-dialog--scrollable .mdc-dialog__close{margin-top:0}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{transform:none;opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%;z-index:1}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__container .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}.mdc-dialog__scrim--removed{pointer-events:none}.mdc-dialog__scrim--removed .mdc-dialog__scrim,.mdc-dialog__scrim--removed .mdc-dialog__surface-scrim{display:none}.mat-mdc-dialog-content{max-height:65vh}.mat-mdc-dialog-container{position:static;display:block}.mat-mdc-dialog-container,.mat-mdc-dialog-container .mdc-dialog__container,.mat-mdc-dialog-container .mdc-dialog__surface{max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mat-mdc-dialog-container .mdc-dialog__surface{display:block;width:100%;height:100%}.mat-mdc-dialog-container{--mdc-dialog-container-elevation-shadow:0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12);--mdc-dialog-container-shadow-color:#000;--mdc-dialog-container-shape:4px;--mdc-dialog-container-elevation: var(--mdc-dialog-container-elevation-shadow);outline:0}.mat-mdc-dialog-container .mdc-dialog__surface{background-color:var(--mdc-dialog-container-color, white)}.mat-mdc-dialog-container .mdc-dialog__surface{box-shadow:var(--mdc-dialog-container-elevation, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}.mat-mdc-dialog-container .mdc-dialog__surface{border-radius:var(--mdc-dialog-container-shape, 4px)}.mat-mdc-dialog-container .mdc-dialog__title{font-family:var(--mdc-dialog-subhead-font, Roboto, sans-serif);line-height:var(--mdc-dialog-subhead-line-height, 1.5rem);font-size:var(--mdc-dialog-subhead-size, 1rem);font-weight:var(--mdc-dialog-subhead-weight, 400);letter-spacing:var(--mdc-dialog-subhead-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__title{color:var(--mdc-dialog-subhead-color, rgba(0, 0, 0, 0.87))}.mat-mdc-dialog-container .mdc-dialog__content{font-family:var(--mdc-dialog-supporting-text-font, Roboto, sans-serif);line-height:var(--mdc-dialog-supporting-text-line-height, 1.5rem);font-size:var(--mdc-dialog-supporting-text-size, 1rem);font-weight:var(--mdc-dialog-supporting-text-weight, 400);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__content{color:var(--mdc-dialog-supporting-text-color, rgba(0, 0, 0, 0.6))}.mat-mdc-dialog-container .mdc-dialog__container{transition-duration:var(--mat-dialog-transition-duration, 0ms)}.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__container{transition:none}.mat-mdc-dialog-content{display:block}.mat-mdc-dialog-actions{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2})}return e})();class f2{constructor(n,t,r){this._ref=n,this._containerInstance=r,this._afterOpened=new we,this._beforeClosed=new we,this._state=0,this.disableClose=t.disableClose,this.id=n.id,r._animationStateChanged.pipe(rr(a=>"opened"===a.state),nr(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),r._animationStateChanged.pipe(rr(a=>"closed"===a.state),nr(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),n.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),wr(this.backdropClick(),this.keydownEvents().pipe(rr(a=>27===a.keyCode&&!this.disableClose&&!Do(a)))).subscribe(a=>{this.disableClose||(a.preventDefault(),w8(this,"keydown"===a.type?"keyboard":"mouse"))})}close(n){this._result=n,this._containerInstance._animationStateChanged.pipe(rr(t=>"closing"===t.state),nr(1)).subscribe(t=>{this._beforeClosed.next(n),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(n){let t=this._ref.config.positionStrategy;return n&&(n.left||n.right)?n.left?t.left(n.left):t.right(n.right):t.centerHorizontally(),n&&(n.top||n.bottom)?n.top?t.top(n.top):t.bottom(n.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(n="",t=""){return this._ref.updateSize(n,t),this}addPanelClass(n){return this._ref.addPanelClass(n),this}removePanelClass(n){return this._ref.removePanelClass(n),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}function w8(e,n,t){return e._closeInteractionType=n,e.close(t)}const C8=new kt("MatMdcDialogData"),wrt=new kt("mat-mdc-dialog-default-options"),M8=new kt("mat-mdc-dialog-scroll-strategy"),Mrt={provide:M8,deps:[_a],useFactory:function Crt(e){return()=>e.scrollStrategies.block()}};let Drt=0,krt=(()=>{class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(t,r,a,c,h,f,b,x,M,T){this._overlay=t,this._defaultOptions=a,this._parentDialog=c,this._dialogRefConstructor=b,this._dialogContainerType=x,this._dialogDataToken=M,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new we,this._afterOpenedAtThisLevel=new we,this._idPrefix="mat-dialog-",this.dialogConfigClass=p2,this.afterAllClosed=cv(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Ws(void 0))),this._scrollStrategy=f,this._dialog=r.get(YH)}open(t,r){let a;(r={...this._defaultOptions||new p2,...r}).id=r.id||`${this._idPrefix}${Drt++}`,r.scrollStrategy=r.scrollStrategy||this._scrollStrategy();const c=this._dialog.open(t,{...r,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:r},{provide:d2,useValue:r}]},templateContext:()=>({dialogRef:a}),providers:(h,f,b)=>(a=new this._dialogRefConstructor(h,r,b),a.updatePosition(r?.position),[{provide:this._dialogContainerType,useValue:b},{provide:this._dialogDataToken,useValue:f.data},{provide:this._dialogRefConstructor,useValue:a}])});return a.componentRef=c.componentRef,a.componentInstance=c.componentInstance,this.openDialogs.push(a),this.afterOpened.next(a),a.afterClosed().subscribe(()=>{const h=this.openDialogs.indexOf(a);h>-1&&(this.openDialogs.splice(h,1),this.openDialogs.length||this._getAfterAllClosed().next())}),a}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(r=>r.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(t){let r=t.length;for(;r--;)t[r].close()}static#t=this.\u0275fac=function(r){dl()};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})(),g2=(()=>{class e extends krt{constructor(t,r,a,c,h,f,b,x){super(t,r,c,f,b,h,f2,xrt,C8,x),this._idPrefix="mat-mdc-dialog-"}static#t=this.\u0275fac=function(r){return new(r||e)(vt(_a),vt(oo),vt(gC,8),vt(wrt,8),vt(M8),vt(e,12),vt(e2),vt(Pr,8))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})(),Srt=0,Trt=(()=>{class e{constructor(t,r,a){this.dialogRef=t,this._elementRef=r,this._dialog=a,this.type="button"}ngOnInit(){this.dialogRef||(this.dialogRef=D8(this._elementRef,this._dialog.openDialogs))}ngOnChanges(t){const r=t._matDialogClose||t._matDialogCloseResult;r&&(this.dialogResult=r.currentValue)}_onButtonClick(t){w8(this.dialogRef,0===t.screenX&&0===t.screenY?"keyboard":"mouse",this.dialogResult)}static#t=this.\u0275fac=function(r){return new(r||e)(z(f2,8),z(Me),z(g2))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","mat-dialog-close",""],["","matDialogClose",""]],hostVars:2,hostBindings:function(r,a){1&r&&Se("click",function(h){return a._onButtonClick(h)}),2&r&&Ve("aria-label",a.ariaLabel||null)("type",a.type)},inputs:{ariaLabel:["aria-label","ariaLabel"],type:"type",dialogResult:["mat-dialog-close","dialogResult"],_matDialogClose:["matDialogClose","_matDialogClose"]},exportAs:["matDialogClose"],features:[Bn]})}return e})(),Ert=(()=>{class e{constructor(t,r,a){this._dialogRef=t,this._elementRef=r,this._dialog=a,this.id="mat-mdc-dialog-title-"+Srt++}ngOnInit(){this._dialogRef||(this._dialogRef=D8(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{this._dialogRef._containerInstance?._ariaLabelledByQueue?.push(this.id)})}ngOnDestroy(){const t=this._dialogRef?._containerInstance?._ariaLabelledByQueue;t&&Promise.resolve().then(()=>{const r=t.indexOf(this.id);r>-1&&t.splice(r,1)})}static#t=this.\u0275fac=function(r){return new(r||e)(z(f2,8),z(Me),z(g2))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-mdc-dialog-title","mdc-dialog__title"],hostVars:1,hostBindings:function(r,a){2&r&&Ao("id",a.id)},inputs:{id:"id"},exportAs:["matDialogTitle"]})}return e})(),Art=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275dir=Mt({type:e,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"]})}return e})(),Irt=(()=>{class e{constructor(){this.align="start"}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275dir=Mt({type:e,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-mdc-dialog-actions","mdc-dialog__actions"],hostVars:4,hostBindings:function(r,a){2&r&&Qe("mat-mdc-dialog-actions-align-center","center"===a.align)("mat-mdc-dialog-actions-align-end","end"===a.align)},inputs:{align:"align"}})}return e})();function D8(e,n){let t=e.nativeElement.parentElement;for(;t&&!t.classList.contains("mat-mdc-dialog-container");)t=t.parentElement;return t?n.find(r=>r.id===t.id):null}let Rrt=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[g2,Mrt],imports:[ZH,jp,Vp,yi,yi]})}return e})();const S8=["mat-button",""],T8=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],E8=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],A8=".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}",Ort=["mat-icon-button",""],Frt=["*"],Lrt=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],Brt=Uv(Up(Hv(class{constructor(e){this._elementRef=e}})));let az=(()=>{class e extends Brt{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(t){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,t)}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=De(t),this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(t){this._disabled=De(t),this._updateRippleDisabled()}constructor(t,r,a,c){super(t),this._platform=r,this._ngZone=a,this._animationMode=c,this._focusMonitor=oe(dc),this._rippleLoader=oe(p8),this._isFab=!1,this._disableRipple=!1,this._disabled=!1,this._rippleLoader?.configureRipple(this._elementRef.nativeElement,{className:"mat-mdc-button-ripple"});const h=t.nativeElement.classList;for(const f of Lrt)this._hasHostAttributes(f.selector)&&f.mdcClasses.forEach(b=>{h.add(b)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(t="program",r){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,r):this._elementRef.nativeElement.focus(r)}_hasHostAttributes(...t){return t.some(r=>this._elementRef.nativeElement.hasAttribute(r))}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static#t=this.\u0275fac=function(r){dl()};static#e=this.\u0275dir=Mt({type:e,features:[Xt]})}return e})(),zrt=(()=>{class e extends az{constructor(t,r,a,c){super(t,r,a,c),this._haltDisabledEvents=h=>{this.disabled&&(h.preventDefault(),h.stopImmediatePropagation())}}ngOnInit(){this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("click",this._haltDisabledEvents)})}ngOnDestroy(){super.ngOnDestroy(),this._elementRef.nativeElement.removeEventListener("click",this._haltDisabledEvents)}static#t=this.\u0275fac=function(r){dl()};static#e=this.\u0275dir=Mt({type:e,features:[Xt]})}return e})(),LM=(()=>{class e extends az{constructor(t,r,a,c){super(t,r,a,c)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(vr),z(Re),z(Pr,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(r,a){2&r&&(Ve("disabled",a.disabled||null),Qe("_mat-animation-noopable","NoopAnimations"===a._animationMode)("mat-unthemed",!a.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Xt],attrs:S8,ngContentSelectors:E8,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,a){1&r&&(xn(T8),je(0,"span",0),Oe(1),ht(2,"span",1),Oe(3,1),ft(),Oe(4,2),je(5,"span",2)(6,"span",3)),2&r&&Qe("mdc-button__ripple",!a._isFab)("mdc-fab__ripple",a._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}return e})(),Vrt=(()=>{class e extends zrt{constructor(t,r,a,c){super(t,r,a,c)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(vr),z(Re),z(Pr,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["a","mat-button",""],["a","mat-raised-button",""],["a","mat-flat-button",""],["a","mat-stroked-button",""]],hostVars:9,hostBindings:function(r,a){2&r&&(Ve("disabled",a.disabled||null)("tabindex",a.disabled?-1:a.tabIndex)("aria-disabled",a.disabled.toString()),Qe("_mat-animation-noopable","NoopAnimations"===a._animationMode)("mat-unthemed",!a.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matButton","matAnchor"],features:[Xt],attrs:S8,ngContentSelectors:E8,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,a){1&r&&(xn(T8),je(0,"span",0),Oe(1),ht(2,"span",1),Oe(3,1),ft(),Oe(4,2),je(5,"span",2)(6,"span",3)),2&r&&Qe("mdc-button__ripple",!a._isFab)("mdc-fab__ripple",a._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',A8],encapsulation:2,changeDetection:0})}return e})(),BM=(()=>{class e extends az{constructor(t,r,a,c){super(t,r,a,c),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(vr),z(Re),z(Pr,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(r,a){2&r&&(Ve("disabled",a.disabled||null),Qe("_mat-animation-noopable","NoopAnimations"===a._animationMode)("mat-unthemed",!a.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Xt],attrs:Ort,ngContentSelectors:Frt,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,a){1&r&&(xn(),je(0,"span",0),Oe(1),je(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size);width:var(--mdc-icon-button-state-layer-size);color:var(--mdc-icon-button-icon-color);--mdc-icon-button-state-layer-size:48px;--mdc-icon-button-icon-size:24px;--mdc-icon-button-disabled-icon-color:black;--mdc-icon-button-disabled-icon-opacity:0.38}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{padding:12px;font-size:var(--mdc-icon-button-icon-size);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',A8],encapsulation:2,changeDetection:0})}return e})(),_2=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,Ah,yi]})}return e})();class Urt extends we{constructor(n=1/0,t=1/0,r=ON){super(),this._bufferSize=n,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,n),this._windowTime=Math.max(1,t)}next(n){const{isStopped:t,_buffer:r,_infiniteTimeWindow:a,_timestampProvider:c,_windowTime:h}=this;t||(r.push(n),!a&&r.push(c.now()+h)),this._trimBuffer(),super.next(n)}_subscribe(n){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(n),{_infiniteTimeWindow:r,_buffer:a}=this,c=a.slice();for(let h=0;h<c.length&&!n.closed;h+=r?1:2)n.next(c[h]);return this._checkFinalizedStatuses(n),t}_trimBuffer(){const{_bufferSize:n,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:a}=this,c=(a?1:2)*n;if(n<1/0&&c<r.length&&r.splice(0,r.length-c),!a){const h=t.now();let f=0;for(let b=1;b<r.length&&r[b]<=h;b+=2)f=b;f&&r.splice(0,f+1)}}}class $rt{constructor(n){this._box=n,this._destroyed=new we,this._resizeSubject=new we,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(t=>this._resizeSubject.next(t)))}observe(n){return this._elementObservables.has(n)||this._elementObservables.set(n,new en(t=>{const r=this._resizeSubject.subscribe(t);return this._resizeObserver?.observe(n,{box:this._box}),()=>{this._resizeObserver?.unobserve(n),r.unsubscribe(),this._elementObservables.delete(n)}}).pipe(rr(t=>t.some(r=>r.target===n)),function Hrt(e,n,t){let r,a=!1;return e&&"object"==typeof e?({bufferSize:r=1/0,windowTime:n=1/0,refCount:a=!1,scheduler:t}=e):r=e??1/0,tf({connector:()=>new Urt(r,n,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:a})}({bufferSize:1,refCount:!0}),Si(this._destroyed))),this._elementObservables.get(n)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}}let Grt=(()=>{class e{constructor(){this._observers=new Map,this._ngZone=oe(Re)}ngOnDestroy(){for(const[,t]of this._observers)t.destroy();this._observers.clear()}observe(t,r){const a=r?.box||"content-box";return this._observers.has(a)||this._observers.set(a,new $rt(a)),this._observers.get(a).observe(t)}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Wrt=["notch"],qrt=["matFormFieldNotchedOutline",""],Yrt=["*"],Zrt=["textField"],Xrt=["iconPrefixContainer"],Krt=["textPrefixContainer"];function Qrt(e,n){1&e&&je(0,"span",19)}function Jrt(e,n){if(1&e&&(ht(0,"label",17),Oe(1,1),Kt(2,Qrt,1,0,"span",18),ft()),2&e){const t=Ne(2);It("floating",t._shouldLabelFloat())("monitorResize",t._hasOutline())("id",t._labelId),Ve("for",t._control.id),St(2),It("ngIf",!t.hideRequiredMarker&&t._control.required)}}function tot(e,n){1&e&&Kt(0,Jrt,3,5,"label",16),2&e&&It("ngIf",Ne()._hasFloatingLabel())}function eot(e,n){1&e&&je(0,"div",20)}function iot(e,n){}function not(e,n){1&e&&Kt(0,iot,0,0,"ng-template",22),2&e&&(Ne(2),It("ngTemplateOutlet",Kr(1)))}function rot(e,n){if(1&e&&(ht(0,"div",21),Kt(1,not,1,1,"ng-template",9),ft()),2&e){const t=Ne();It("matFormFieldNotchedOutlineOpen",t._shouldLabelFloat()),St(1),It("ngIf",!t._forceDisplayInfixLabel())}}function oot(e,n){1&e&&(ht(0,"div",23,24),Oe(2,2),ft())}function sot(e,n){1&e&&(ht(0,"div",25,26),Oe(2,3),ft())}function aot(e,n){}function lot(e,n){1&e&&Kt(0,aot,0,0,"ng-template",22),2&e&&(Ne(),It("ngTemplateOutlet",Kr(1)))}function cot(e,n){1&e&&(ht(0,"div",27),Oe(1,4),ft())}function dot(e,n){1&e&&(ht(0,"div",28),Oe(1,5),ft())}function uot(e,n){1&e&&je(0,"div",29)}function hot(e,n){1&e&&(ht(0,"div",30),Oe(1,6),ft()),2&e&&It("@transitionMessages",Ne()._subscriptAnimationState)}function mot(e,n){if(1&e&&(ht(0,"mat-hint",34),be(1),ft()),2&e){const t=Ne(2);It("id",t._hintLabelId),St(1),_s(t.hintLabel)}}function pot(e,n){if(1&e&&(ht(0,"div",31),Kt(1,mot,2,2,"mat-hint",32),Oe(2,7),je(3,"div",33),Oe(4,8),ft()),2&e){const t=Ne();It("@transitionMessages",t._subscriptAnimationState),St(1),It("ngIf",t.hintLabel)}}const fot=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],got=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];let NM=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275dir=Mt({type:e,selectors:[["mat-label"]]})}return e})();const _ot=new kt("MatError");let bot=0,lz=(()=>{class e{constructor(){this.align="start",this.id="mat-mdc-hint-"+bot++}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275dir=Mt({type:e,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(r,a){2&r&&(Ao("id",a.id),Ve("align",null),Qe("mat-mdc-form-field-hint-end","end"===a.align))},inputs:{align:"align",id:"id"}})}return e})();const yot=new kt("MatPrefix"),I8=new kt("MatSuffix");let vot=(()=>{class e{constructor(){this._isText=!1}set _isTextSelector(t){this._isText=!0}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275dir=Mt({type:e,selectors:[["","matSuffix",""],["","matIconSuffix",""],["","matTextSuffix",""]],inputs:{_isTextSelector:["matTextSuffix","_isTextSelector"]},features:[Te([{provide:I8,useExisting:e}])]})}return e})();const R8=new kt("FloatingLabelParent");let P8=(()=>{class e{get floating(){return this._floating}set floating(t){this._floating=t,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(t){this._monitorResize=t,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(t){this._elementRef=t,this._floating=!1,this._monitorResize=!1,this._resizeObserver=oe(Grt),this._ngZone=oe(Re),this._parent=oe(R8),this._resizeSubscription=new lt}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return function xot(e){if(null!==e.offsetParent)return e.scrollWidth;const t=e.cloneNode(!0);t.style.setProperty("position","absolute"),t.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(t);const r=t.scrollWidth;return t.remove(),r}(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me))};static#e=this.\u0275dir=Mt({type:e,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(r,a){2&r&&Qe("mdc-floating-label--float-above",a.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"}})}return e})();const O8="mdc-line-ripple--active",b2="mdc-line-ripple--deactivating";let F8=(()=>{class e{constructor(t,r){this._elementRef=t,this._handleTransitionEnd=a=>{const c=this._elementRef.nativeElement.classList,h=c.contains(b2);"opacity"===a.propertyName&&h&&c.remove(O8,b2)},r.runOutsideAngular(()=>{t.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){const t=this._elementRef.nativeElement.classList;t.remove(b2),t.add(O8)}deactivate(){this._elementRef.nativeElement.classList.add(b2)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(Re))};static#e=this.\u0275dir=Mt({type:e,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]})}return e})(),L8=(()=>{class e{constructor(t,r){this._elementRef=t,this._ngZone=r,this.open=!1}ngAfterViewInit(){const t=this._elementRef.nativeElement.querySelector(".mdc-floating-label");t?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),"function"==typeof requestAnimationFrame&&(t.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>t.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(t){this._notch.nativeElement.style.width=this.open&&t?`calc(${t}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`:""}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(Re))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(r,a){if(1&r&&Hi(Wrt,5),2&r){let c;pe(c=fe())&&(a._notch=c.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(r,a){2&r&&Qe("mdc-notched-outline--notched",a.open)},inputs:{open:["matFormFieldNotchedOutlineOpen","open"]},attrs:qrt,ngContentSelectors:Yrt,decls:5,vars:0,consts:[[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],["notch",""],[1,"mdc-notched-outline__trailing"]],template:function(r,a){1&r&&(xn(),je(0,"div",0),ht(1,"div",1,2),Oe(3),ft(),je(4,"div",3))},encapsulation:2,changeDetection:0})}return e})();const wot={transitionMessages:Po("transitionMessages",[Hn("enter",oi({opacity:1,transform:"translateY(0%)"})),Tn("void => enter",[oi({opacity:0,transform:"translateY(-5px)"}),Fn("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let y2=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275dir=Mt({type:e})}return e})();const Zv=new kt("MatFormField"),Cot=new kt("MAT_FORM_FIELD_DEFAULT_OPTIONS");let B8=0,v2=(()=>{class e{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(t){this._hideRequiredMarker=De(t)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||"auto"}set floatLabel(t){t!==this._floatLabel&&(this._floatLabel=t,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(t){const r=this._appearance;this._appearance=t||this._defaults?.appearance||"fill","outline"===this._appearance&&this._appearance!==r&&(this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||"fixed"}set subscriptSizing(t){this._subscriptSizing=t||this._defaults?.subscriptSizing||"fixed"}get hintLabel(){return this._hintLabel}set hintLabel(t){this._hintLabel=t,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(t){this._explicitFormFieldControl=t}constructor(t,r,a,c,h,f,b,x){this._elementRef=t,this._changeDetectorRef=r,this._ngZone=a,this._dir=c,this._platform=h,this._defaults=f,this._animationMode=b,this._hideRequiredMarker=!1,this.color="primary",this._appearance="fill",this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId="mat-mdc-form-field-label-"+B8++,this._hintLabelId="mat-mdc-hint-"+B8++,this._subscriptAnimationState="",this._destroyed=new we,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,f&&(f.appearance&&(this.appearance=f.appearance),this._hideRequiredMarker=!!f?.hideRequiredMarker,f.color&&(this.color=f.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){const t=this._control;t.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${t.controlType}`),t.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),t.ngControl&&t.ngControl.valueChanges&&t.ngControl.valueChanges.pipe(Si(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(t=>!t._isText),this._hasTextPrefix=!!this._prefixChildren.find(t=>t._isText),this._hasIconSuffix=!!this._suffixChildren.find(t=>!t._isText),this._hasTextSuffix=!!this._suffixChildren.find(t=>t._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),wr(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||null===this._isFocused)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(Si(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(Si(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return"always"===this.floatLabel}_hasOutline(){return"outline"===this.appearance}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(t){const r=this._control?this._control.ngControl:null;return r&&r[t]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){this._hasOutline()&&this._floatingLabel&&this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth()):this._notchedOutline?._setNotchWidth(0)}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_syncDescribedByIds(){if(this._control){let t=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&t.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const r=this._hintChildren?this._hintChildren.find(c=>"start"===c.align):null,a=this._hintChildren?this._hintChildren.find(c=>"end"===c.align):null;r?t.push(r.id):this._hintLabel&&t.push(this._hintLabelId),a&&t.push(a.id)}else this._errorChildren&&t.push(...this._errorChildren.map(r=>r.id));this._control.setDescribedByIds(t)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;const t=this._floatingLabel.element;if(!this._iconPrefixContainer&&!this._textPrefixContainer)return void(t.style.transform="");if(!this._isAttachedToDom())return void(this._needsOutlineLabelOffsetUpdateOnStable=!0);const r=this._iconPrefixContainer?.nativeElement,a=this._textPrefixContainer?.nativeElement,c=r?.getBoundingClientRect().width??0,h=a?.getBoundingClientRect().width??0;t.style.transform=`var(\n        --mat-mdc-form-field-label-transform,\n        translateY(-50%) translateX(calc(${"rtl"===this._dir.value?"-1":"1"} * (${c+h}px + var(--mat-mdc-form-field-label-offset-x, 0px))))\n    )`}_isAttachedToDom(){const t=this._elementRef.nativeElement;if(t.getRootNode){const r=t.getRootNode();return r&&r!==t}return document.documentElement.contains(t)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(Et),z(Re),z(es),z(vr),z(Cot,8),z(Pr,8),z(ki))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-form-field"]],contentQueries:function(r,a,c){if(1&r&&(Fi(c,NM,5),Fi(c,NM,7),Fi(c,y2,5),Fi(c,yot,5),Fi(c,I8,5),Fi(c,_ot,5),Fi(c,lz,5)),2&r){let h;pe(h=fe())&&(a._labelChildNonStatic=h.first),pe(h=fe())&&(a._labelChildStatic=h.first),pe(h=fe())&&(a._formFieldControl=h.first),pe(h=fe())&&(a._prefixChildren=h),pe(h=fe())&&(a._suffixChildren=h),pe(h=fe())&&(a._errorChildren=h),pe(h=fe())&&(a._hintChildren=h)}},viewQuery:function(r,a){if(1&r&&(Hi(Zrt,5),Hi(Xrt,5),Hi(Krt,5),Hi(P8,5),Hi(L8,5),Hi(F8,5)),2&r){let c;pe(c=fe())&&(a._textField=c.first),pe(c=fe())&&(a._iconPrefixContainer=c.first),pe(c=fe())&&(a._textPrefixContainer=c.first),pe(c=fe())&&(a._floatingLabel=c.first),pe(c=fe())&&(a._notchedOutline=c.first),pe(c=fe())&&(a._lineRipple=c.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(r,a){2&r&&Qe("mat-mdc-form-field-label-always-float",a._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",a._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",a._hasIconSuffix)("mat-form-field-invalid",a._control.errorState)("mat-form-field-disabled",a._control.disabled)("mat-form-field-autofilled",a._control.autofilled)("mat-form-field-no-animations","NoopAnimations"===a._animationMode)("mat-form-field-appearance-fill","fill"==a.appearance)("mat-form-field-appearance-outline","outline"==a.appearance)("mat-form-field-hide-placeholder",a._hasFloatingLabel()&&!a._shouldLabelFloat())("mat-focused",a._control.focused)("mat-primary","accent"!==a.color&&"warn"!==a.color)("mat-accent","accent"===a.color)("mat-warn","warn"===a.color)("ng-untouched",a._shouldForward("untouched"))("ng-touched",a._shouldForward("touched"))("ng-pristine",a._shouldForward("pristine"))("ng-dirty",a._shouldForward("dirty"))("ng-valid",a._shouldForward("valid"))("ng-invalid",a._shouldForward("invalid"))("ng-pending",a._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Te([{provide:Zv,useExisting:e},{provide:R8,useExisting:e}])],ngContentSelectors:got,decls:18,vars:23,consts:[["labelTemplate",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],["textField",""],["class","mat-mdc-form-field-focus-overlay",4,"ngIf"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen",4,"ngIf"],["class","mat-mdc-form-field-icon-prefix",4,"ngIf"],["class","mat-mdc-form-field-text-prefix",4,"ngIf"],[1,"mat-mdc-form-field-infix"],[3,"ngIf"],["class","mat-mdc-form-field-text-suffix",4,"ngIf"],["class","mat-mdc-form-field-icon-suffix",4,"ngIf"],["matFormFieldLineRipple","",4,"ngIf"],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align",3,"ngSwitch"],["class","mat-mdc-form-field-error-wrapper",4,"ngSwitchCase"],["class","mat-mdc-form-field-hint-wrapper",4,"ngSwitchCase"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id",4,"ngIf"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true","class","mat-mdc-form-field-required-marker mdc-floating-label--required",4,"ngIf"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-focus-overlay"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-icon-prefix"],["iconPrefixContainer",""],[1,"mat-mdc-form-field-text-prefix"],["textPrefixContainer",""],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id",4,"ngIf"],[1,"mat-mdc-form-field-hint-spacer"],[3,"id"]],template:function(r,a){1&r&&(xn(fot),Kt(0,tot,1,1,"ng-template",null,0,bp),ht(2,"div",1,2),Se("click",function(h){return a._control.onContainerClick(h)}),Kt(4,eot,1,0,"div",3),ht(5,"div",4),Kt(6,rot,2,2,"div",5),Kt(7,oot,3,0,"div",6),Kt(8,sot,3,0,"div",7),ht(9,"div",8),Kt(10,lot,1,1,"ng-template",9),Oe(11),ft(),Kt(12,cot,2,0,"div",10),Kt(13,dot,2,0,"div",11),ft(),Kt(14,uot,1,0,"div",12),ft(),ht(15,"div",13),Kt(16,hot,2,1,"div",14),Kt(17,pot,5,2,"div",15),ft()),2&r&&(St(2),Qe("mdc-text-field--filled",!a._hasOutline())("mdc-text-field--outlined",a._hasOutline())("mdc-text-field--no-label",!a._hasFloatingLabel())("mdc-text-field--disabled",a._control.disabled)("mdc-text-field--invalid",a._control.errorState),St(2),It("ngIf",!a._hasOutline()&&!a._control.disabled),St(2),It("ngIf",a._hasOutline()),St(1),It("ngIf",a._hasIconPrefix),St(1),It("ngIf",a._hasTextPrefix),St(2),It("ngIf",!a._hasOutline()||a._forceDisplayInfixLabel()),St(2),It("ngIf",a._hasTextSuffix),St(1),It("ngIf",a._hasIconSuffix),St(1),It("ngIf",!a._hasOutline()),St(1),Qe("mat-mdc-form-field-subscript-dynamic-size","dynamic"===a.subscriptSizing),It("ngSwitch",a._getDisplayedMessages()),St(1),It("ngSwitchCase","error"),St(1),It("ngSwitchCase","hint"))},dependencies:[La,OL,Qg,xC,lz,P8,L8,F8],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px, var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 96px / 0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px * 2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{--mdc-filled-text-field-active-indicator-height:1px;--mdc-filled-text-field-focus-active-indicator-height:2px;--mdc-filled-text-field-container-shape:4px;border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined{--mdc-outlined-text-field-outline-width:1px;--mdc-outlined-text-field-focus-outline-width:2px;--mdc-outlined-text-field-container-shape:4px}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px, calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px, var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px, calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px, var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px, var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px, var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px, calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px, calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size) * var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:12px;box-sizing:content-box}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[wot.transitionMessages]},changeDetection:0})}return e})(),x2=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,ws,r2,yi]})}return e})();const V8=Xc({passive:!0});let kot=(()=>{class e{constructor(t,r){this._platform=t,this._ngZone=r,this._monitoredElements=new Map}monitor(t){if(!this._platform.isBrowser)return xa;const r=Dh(t),a=this._monitoredElements.get(r);if(a)return a.subject;const c=new we,h="cdk-text-field-autofilled",f=b=>{"cdk-text-field-autofill-start"!==b.animationName||r.classList.contains(h)?"cdk-text-field-autofill-end"===b.animationName&&r.classList.contains(h)&&(r.classList.remove(h),this._ngZone.run(()=>c.next({target:b.target,isAutofilled:!1}))):(r.classList.add(h),this._ngZone.run(()=>c.next({target:b.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{r.addEventListener("animationstart",f,V8),r.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(r,{subject:c,unlisten:()=>{r.removeEventListener("animationstart",f,V8)}}),c}stopMonitoring(t){const r=Dh(t),a=this._monitoredElements.get(r);a&&(a.unlisten(),a.subject.complete(),r.classList.remove("cdk-text-field-autofill-monitored"),r.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(r))}ngOnDestroy(){this._monitoredElements.forEach((t,r)=>this.stopMonitoring(r))}static#t=this.\u0275fac=function(r){return new(r||e)(vt(vr),vt(Re))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Sot=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({})}return e})();const j8=new kt("MAT_INPUT_VALUE_ACCESSOR"),Tot=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let Eot=0;const Aot=tz(class{constructor(e,n,t,r){this._defaultErrorStateMatcher=e,this._parentForm=n,this._parentFormGroup=t,this.ngControl=r,this.stateChanges=new we}});let cz=(()=>{class e extends Aot{get disabled(){return this._disabled}set disabled(t){this._disabled=De(t),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(t){this._id=t||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(vl.required)??!1}set required(t){this._required=De(t)}get type(){return this._type}set type(t){this._type=t||"text",this._validateType(),!this._isTextarea&&fH().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(t){this._readonly=De(t)}constructor(t,r,a,c,h,f,b,x,M,T){super(f,c,h,a),this._elementRef=t,this._platform=r,this._autofillMonitor=x,this._formField=T,this._uid="mat-input-"+Eot++,this.focused=!1,this.stateChanges=new we,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(N=>fH().has(N)),this._iOSKeyupListener=N=>{const V=N.target;!V.value&&0===V.selectionStart&&0===V.selectionEnd&&(V.setSelectionRange(1,1),V.setSelectionRange(0,0))};const I=this._elementRef.nativeElement,L=I.nodeName.toLowerCase();this._inputValueAccessor=b||I,this._previousNativeValue=this.value,this.id=this.id,r.IOS&&M.runOutsideAngular(()=>{t.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===L,this._isTextarea="textarea"===L,this._isInFormField=!!T,this._isNativeSelect&&(this.controlType=I.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(t=>{this.autofilled=t.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),null!==this.ngControl.disabled&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(t){this._elementRef.nativeElement.focus(t)}_focusChanged(t){t!==this.focused&&(this.focused=t,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){const t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}_dirtyCheckPlaceholder(){const t=this._getPlaceholder();if(t!==this._previousPlaceholder){const r=this._elementRef.nativeElement;this._previousPlaceholder=t,t?r.setAttribute("placeholder",t):r.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){Tot.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let t=this._elementRef.nativeElement.validity;return t&&t.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const t=this._elementRef.nativeElement,r=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&r&&r.label)}return this.focused||!this.empty}setDescribedByIds(t){t.length?this._elementRef.nativeElement.setAttribute("aria-describedby",t.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const t=this._elementRef.nativeElement;return this._isNativeSelect&&(t.multiple||t.size>1)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(vr),z(Zc,10),z(Pv,8),z(__,8),z(u2),z(j8,10),z(kot),z(Re),z(Zv,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(r,a){1&r&&Se("focus",function(){return a._focusChanged(!0)})("blur",function(){return a._focusChanged(!1)})("input",function(){return a._onInput()}),2&r&&(Ao("id",a.id)("disabled",a.disabled)("required",a.required),Ve("name",a.name||null)("readonly",a.readonly&&!a._isNativeSelect||null)("aria-invalid",a.empty&&a.required?null:a.errorState)("aria-required",a.required)("id",a.id),Qe("mat-input-server",a._isServer)("mat-mdc-form-field-textarea-control",a._isInFormField&&a._isTextarea)("mat-mdc-form-field-input-control",a._isInFormField)("mdc-text-field__input",a._isInFormField)("mat-mdc-native-select-inline",a._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[Te([{provide:y2,useExisting:e}]),Xt,Bn]})}return e})(),Iot=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,x2,x2,Sot,yi]})}return e})();const Rot=["mat-calendar-body",""];function Pot(e,n){if(1&e&&(ht(0,"tr",3)(1,"td",4),be(2),ft()()),2&e){const t=Ne();St(1),pa("padding-top",t._cellPadding)("padding-bottom",t._cellPadding),Ve("colspan",t.numCols),St(1),Ln(" ",t.label," ")}}function Oot(e,n){if(1&e&&(ht(0,"td",4),be(1),ft()),2&e){const t=Ne(2);pa("padding-top",t._cellPadding)("padding-bottom",t._cellPadding),Ve("colspan",t._firstRowOffset),St(1),Ln(" ",t._firstRowOffset>=t.labelMinRequiredCells?t.label:""," ")}}function Fot(e,n){if(1&e){const t=vo();ht(0,"td",8)(1,"button",9),Se("click",function(a){const h=$n(t).$implicit;return Nn(Ne(2)._cellClicked(h,a))})("focus",function(a){const h=$n(t).$implicit;return Nn(Ne(2)._emitActiveDateChange(h,a))}),ht(2,"span",10),be(3),ft(),je(4,"span",11),ft()()}if(2&e){const t=n.$implicit,r=n.index,a=Ne().index,c=Ne();pa("width",c._cellWidth)("padding-top",c._cellPadding)("padding-bottom",c._cellPadding),Ve("data-mat-row",a)("data-mat-col",r),St(1),Qe("mat-calendar-body-disabled",!t.enabled)("mat-calendar-body-active",c._isActiveCell(a,r))("mat-calendar-body-range-start",c._isRangeStart(t.compareValue))("mat-calendar-body-range-end",c._isRangeEnd(t.compareValue))("mat-calendar-body-in-range",c._isInRange(t.compareValue))("mat-calendar-body-comparison-bridge-start",c._isComparisonBridgeStart(t.compareValue,a,r))("mat-calendar-body-comparison-bridge-end",c._isComparisonBridgeEnd(t.compareValue,a,r))("mat-calendar-body-comparison-start",c._isComparisonStart(t.compareValue))("mat-calendar-body-comparison-end",c._isComparisonEnd(t.compareValue))("mat-calendar-body-in-comparison-range",c._isInComparisonRange(t.compareValue))("mat-calendar-body-preview-start",c._isPreviewStart(t.compareValue))("mat-calendar-body-preview-end",c._isPreviewEnd(t.compareValue))("mat-calendar-body-in-preview",c._isInPreview(t.compareValue)),It("ngClass",t.cssClasses)("tabindex",c._isActiveCell(a,r)?0:-1),Ve("aria-label",t.ariaLabel)("aria-disabled",!t.enabled||null)("aria-pressed",c._isSelected(t.compareValue))("aria-current",c.todayValue===t.compareValue?"date":null)("aria-describedby",c._getDescribedby(t.compareValue)),St(1),Qe("mat-calendar-body-selected",c._isSelected(t.compareValue))("mat-calendar-body-comparison-identical",c._isComparisonIdentical(t.compareValue))("mat-calendar-body-today",c.todayValue===t.compareValue),St(1),Ln(" ",t.displayValue," ")}}function Lot(e,n){if(1&e&&(ht(0,"tr",5),Kt(1,Oot,2,6,"td",6),Kt(2,Fot,5,48,"td",7),ft()),2&e){const t=n.$implicit,r=n.index,a=Ne();St(1),It("ngIf",0===r&&a._firstRowOffset),St(1),It("ngForOf",t)}}function Bot(e,n){if(1&e&&(ht(0,"th",5)(1,"span",6),be(2),ft(),ht(3,"span",7),be(4),ft()()),2&e){const t=n.$implicit;St(2),_s(t.long),St(2),_s(t.narrow)}}const Not=["*"];function zot(e,n){}function Vot(e,n){if(1&e){const t=vo();ht(0,"mat-month-view",5),Se("activeDateChange",function(a){return $n(t),Nn(Ne().activeDate=a)})("_userSelection",function(a){return $n(t),Nn(Ne()._dateSelected(a))})("dragStarted",function(a){return $n(t),Nn(Ne()._dragStarted(a))})("dragEnded",function(a){return $n(t),Nn(Ne()._dragEnded(a))}),ft()}if(2&e){const t=Ne();It("activeDate",t.activeDate)("selected",t.selected)("dateFilter",t.dateFilter)("maxDate",t.maxDate)("minDate",t.minDate)("dateClass",t.dateClass)("comparisonStart",t.comparisonStart)("comparisonEnd",t.comparisonEnd)("startDateAccessibleName",t.startDateAccessibleName)("endDateAccessibleName",t.endDateAccessibleName)("activeDrag",t._activeDrag)}}function jot(e,n){if(1&e){const t=vo();ht(0,"mat-year-view",6),Se("activeDateChange",function(a){return $n(t),Nn(Ne().activeDate=a)})("monthSelected",function(a){return $n(t),Nn(Ne()._monthSelectedInYearView(a))})("selectedChange",function(a){return $n(t),Nn(Ne()._goToDateInView(a,"month"))}),ft()}if(2&e){const t=Ne();It("activeDate",t.activeDate)("selected",t.selected)("dateFilter",t.dateFilter)("maxDate",t.maxDate)("minDate",t.minDate)("dateClass",t.dateClass)}}function Uot(e,n){if(1&e){const t=vo();ht(0,"mat-multi-year-view",7),Se("activeDateChange",function(a){return $n(t),Nn(Ne().activeDate=a)})("yearSelected",function(a){return $n(t),Nn(Ne()._yearSelectedInMultiYearView(a))})("selectedChange",function(a){return $n(t),Nn(Ne()._goToDateInView(a,"year"))}),ft()}if(2&e){const t=Ne();It("activeDate",t.activeDate)("selected",t.selected)("dateFilter",t.dateFilter)("maxDate",t.maxDate)("minDate",t.minDate)("dateClass",t.dateClass)}}function Hot(e,n){}const $ot=["button"];function Got(e,n){1&e&&(Ps(),ht(0,"svg",3),je(1,"path",4),ft())}const Wot=[[["","matDatepickerToggleIcon",""]]],qot=["[matDatepickerToggleIcon]"];let zM=(()=>{class e{constructor(){this.changes=new we,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(t,r){return`${t} \u2013 ${r}`}formatYearRangeLabel(t,r){return`${t} to ${r}`}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class dz{constructor(n,t,r,a,c={},h=n,f){this.value=n,this.displayValue=t,this.ariaLabel=r,this.enabled=a,this.cssClasses=c,this.compareValue=h,this.rawValue=f}}let Yot=1;const U8=Xc({passive:!1,capture:!0}),Hp=Xc({passive:!0,capture:!0}),w2=Xc({passive:!0});let Xv=(()=>{class e{ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}constructor(t,r){this._elementRef=t,this._ngZone=r,this._platform=oe(vr),this._focusActiveCellAfterViewChecked=!1,this.numCols=7,this.activeCell=0,this.isRange=!1,this.cellAspectRatio=1,this.previewStart=null,this.previewEnd=null,this.selectedValueChange=new me,this.previewChange=new me,this.activeDateChange=new me,this.dragStarted=new me,this.dragEnded=new me,this._didDragSinceMouseDown=!1,this._enterHandler=a=>{if(this._skipNextFocus&&"focus"===a.type)this._skipNextFocus=!1;else if(a.target&&this.isRange){const c=this._getCellFromElement(a.target);c&&this._ngZone.run(()=>this.previewChange.emit({value:c.enabled?c:null,event:a}))}},this._touchmoveHandler=a=>{if(!this.isRange)return;const c=H8(a),h=c?this._getCellFromElement(c):null;c!==a.target&&(this._didDragSinceMouseDown=!0),hz(a.target)&&a.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:h?.enabled?h:null,event:a}))},this._leaveHandler=a=>{null!==this.previewEnd&&this.isRange&&("blur"!==a.type&&(this._didDragSinceMouseDown=!0),a.target&&this._getCellFromElement(a.target)&&(!a.relatedTarget||!this._getCellFromElement(a.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:a})))},this._mousedownHandler=a=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;const c=a.target&&this._getCellFromElement(a.target);!c||!this._isInRange(c.rawValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:c.rawValue,event:a})})},this._mouseupHandler=a=>{if(!this.isRange)return;const c=hz(a.target);c?c.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{const h=this._getCellFromElement(c);this.dragEnded.emit({value:h?.rawValue??null,event:a})}):this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:a})})},this._touchendHandler=a=>{const c=H8(a);c&&this._mouseupHandler({target:c})},this._id="mat-calendar-body-"+Yot++,this._startDateLabelId=`${this._id}-start-date`,this._endDateLabelId=`${this._id}-end-date`,r.runOutsideAngular(()=>{const a=t.nativeElement;a.addEventListener("touchmove",this._touchmoveHandler,U8),a.addEventListener("mouseenter",this._enterHandler,Hp),a.addEventListener("focus",this._enterHandler,Hp),a.addEventListener("mouseleave",this._leaveHandler,Hp),a.addEventListener("blur",this._leaveHandler,Hp),a.addEventListener("mousedown",this._mousedownHandler,w2),a.addEventListener("touchstart",this._mousedownHandler,w2),this._platform.isBrowser&&(window.addEventListener("mouseup",this._mouseupHandler),window.addEventListener("touchend",this._touchendHandler))})}_cellClicked(t,r){this._didDragSinceMouseDown||t.enabled&&this.selectedValueChange.emit({value:t.value,event:r})}_emitActiveDateChange(t,r){t.enabled&&this.activeDateChange.emit({value:t.value,event:r})}_isSelected(t){return this.startValue===t||this.endValue===t}ngOnChanges(t){const r=t.numCols,{rows:a,numCols:c}=this;(t.rows||r)&&(this._firstRowOffset=a&&a.length&&a[0].length?c-a[0].length:0),(t.cellAspectRatio||r||!this._cellPadding)&&(this._cellPadding=50*this.cellAspectRatio/c+"%"),(r||!this._cellWidth)&&(this._cellWidth=100/c+"%")}ngOnDestroy(){const t=this._elementRef.nativeElement;t.removeEventListener("touchmove",this._touchmoveHandler,U8),t.removeEventListener("mouseenter",this._enterHandler,Hp),t.removeEventListener("focus",this._enterHandler,Hp),t.removeEventListener("mouseleave",this._leaveHandler,Hp),t.removeEventListener("blur",this._leaveHandler,Hp),t.removeEventListener("mousedown",this._mousedownHandler,w2),t.removeEventListener("touchstart",this._mousedownHandler,w2),this._platform.isBrowser&&(window.removeEventListener("mouseup",this._mouseupHandler),window.removeEventListener("touchend",this._touchendHandler))}_isActiveCell(t,r){let a=t*this.numCols+r;return t&&(a-=this._firstRowOffset),a==this.activeCell}_focusActiveCell(t=!0){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(nr(1)).subscribe(()=>{setTimeout(()=>{const r=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");r&&(t||(this._skipNextFocus=!0),r.focus())})})})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(t){return mz(t,this.startValue,this.endValue)}_isRangeEnd(t){return pz(t,this.startValue,this.endValue)}_isInRange(t){return fz(t,this.startValue,this.endValue,this.isRange)}_isComparisonStart(t){return mz(t,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(t,r,a){if(!this._isComparisonStart(t)||this._isRangeStart(t)||!this._isInRange(t))return!1;let c=this.rows[r][a-1];if(!c){const h=this.rows[r-1];c=h&&h[h.length-1]}return c&&!this._isRangeEnd(c.compareValue)}_isComparisonBridgeEnd(t,r,a){if(!this._isComparisonEnd(t)||this._isRangeEnd(t)||!this._isInRange(t))return!1;let c=this.rows[r][a+1];if(!c){const h=this.rows[r+1];c=h&&h[0]}return c&&!this._isRangeStart(c.compareValue)}_isComparisonEnd(t){return pz(t,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(t){return fz(t,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(t){return this.comparisonStart===this.comparisonEnd&&t===this.comparisonStart}_isPreviewStart(t){return mz(t,this.previewStart,this.previewEnd)}_isPreviewEnd(t){return pz(t,this.previewStart,this.previewEnd)}_isInPreview(t){return fz(t,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(t){return this.isRange?this.startValue===t&&this.endValue===t?`${this._startDateLabelId} ${this._endDateLabelId}`:this.startValue===t?this._startDateLabelId:this.endValue===t?this._endDateLabelId:null:null}_getCellFromElement(t){const r=hz(t);if(r){const a=r.getAttribute("data-mat-row"),c=r.getAttribute("data-mat-col");if(a&&c)return this.rows[parseInt(a)][parseInt(c)]}return null}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(Re))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],features:[Bn],attrs:Rot,decls:6,vars:6,consts:[["aria-hidden","true",4,"ngIf"],["role","row",4,"ngFor","ngForOf"],[1,"mat-calendar-body-hidden-label",3,"id"],["aria-hidden","true"],[1,"mat-calendar-body-label"],["role","row"],["class","mat-calendar-body-label",3,"paddingTop","paddingBottom",4,"ngIf"],["role","gridcell","class","mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom",4,"ngFor","ngForOf"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"ngClass","tabindex","click","focus"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(r,a){1&r&&(Kt(0,Pot,3,6,"tr",0),Kt(1,Lot,3,2,"tr",1),ht(2,"label",2),be(3),ft(),ht(4,"label",2),be(5),ft()),2&r&&(It("ngIf",a._firstRowOffset<a.labelMinRequiredCells),St(1),It("ngForOf",a.rows),St(1),It("id",a._startDateLabelId),St(1),Ln(" ",a.startDateAccessibleName,"\n"),St(1),It("id",a._endDateLabelId),St(1),Ln(" ",a.endDateAccessibleName,"\n"))},dependencies:[yC,vC,La],styles:['.mat-calendar-body{min-width:224px}.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-outline-color)}.mat-calendar-body-label{height:0;line-height:0;text-align:left;padding-left:4.7142857143%;padding-right:4.7142857143%;font-size:var(--mat-datepicker-calendar-body-label-text-size);font-weight:var(--mat-datepicker-calendar-body-label-text-weight);color:var(--mat-datepicker-calendar-body-label-text-color)}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview{color:var(--mat-datepicker-calendar-date-preview-state-outline-color)}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.mat-calendar-body-disabled>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){color:var(--mat-datepicker-calendar-date-disabled-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-disabled-state-outline-color)}.cdk-high-contrast-active .mat-calendar-body-disabled{opacity:.5}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px;color:var(--mat-datepicker-calendar-date-text-color);border-color:var(--mat-datepicker-calendar-date-outline-color)}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}.cdk-high-contrast-active .mat-calendar-body-cell-content{border:none}.cdk-keyboard-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical),.cdk-program-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-focus-state-background-color)}@media(hover: hover){.mat-calendar-body-cell:not(.mat-calendar-body-disabled):hover>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-hover-state-background-color)}}.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-state-background-color);color:var(--mat-datepicker-calendar-date-selected-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-disabled-state-background-color)}.mat-calendar-body-selected.mat-calendar-body-today{box-shadow:inset 0 0 0 1px var(--mat-datepicker-calendar-date-today-selected-state-outline-color)}.mat-calendar-body-in-range::before{background:var(--mat-datepicker-calendar-date-in-range-state-background-color)}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color)}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color)}.mat-calendar-body-comparison-bridge-start::before,[dir=rtl] .mat-calendar-body-comparison-bridge-end::before{background:linear-gradient(to right, var(--mat-datepicker-calendar-date-in-range-state-background-color) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color) 50%)}.mat-calendar-body-comparison-bridge-end::before,[dir=rtl] .mat-calendar-body-comparison-bridge-start::before{background:linear-gradient(to left, var(--mat-datepicker-calendar-date-in-range-state-background-color) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color) 50%)}.mat-calendar-body-in-range>.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range.mat-calendar-body-in-range::after{background:var(--mat-datepicker-calendar-date-in-overlap-range-state-background-color)}.mat-calendar-body-comparison-identical.mat-calendar-body-selected,.mat-calendar-body-in-comparison-range>.mat-calendar-body-selected{background:var(--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color)}.cdk-high-contrast-active .mat-datepicker-popup:not(:empty),.cdk-high-contrast-active .mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.cdk-high-contrast-active .mat-calendar-body-today{outline:dotted 1px}.cdk-high-contrast-active .mat-calendar-body-cell::before,.cdk-high-contrast-active .mat-calendar-body-cell::after,.cdk-high-contrast-active .mat-calendar-body-selected{background:none}.cdk-high-contrast-active .mat-calendar-body-in-range::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-start::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.cdk-high-contrast-active .mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}[dir=rtl] .mat-calendar-body-label{text-align:right}'],encapsulation:2,changeDetection:0})}return e})();function uz(e){return"TD"===e?.nodeName}function hz(e){let n;return uz(e)?n=e:uz(e.parentNode)?n=e.parentNode:uz(e.parentNode?.parentNode)&&(n=e.parentNode.parentNode),null!=n?.getAttribute("data-mat-row")?n:null}function mz(e,n,t){return null!==t&&n!==t&&e<t&&e===n}function pz(e,n,t){return null!==n&&n!==t&&e>=n&&e===t}function fz(e,n,t,r){return r&&null!==n&&null!==t&&n!==t&&e>=n&&e<=t}function H8(e){const n=e.changedTouches[0];return document.elementFromPoint(n.clientX,n.clientY)}class ba{constructor(n,t){this.start=n,this.end=t}}let $p=(()=>{class e{constructor(t,r){this.selection=t,this._adapter=r,this._selectionChanged=new we,this.selectionChanged=this._selectionChanged,this.selection=t}updateSelection(t,r){const a=this.selection;this.selection=t,this._selectionChanged.next({selection:t,source:r,oldValue:a})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(t){return this._adapter.isDateInstance(t)&&this._adapter.isValid(t)}static#t=this.\u0275fac=function(r){dl()};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})(),Zot=(()=>{class e extends $p{constructor(t){super(null,t)}add(t){super.updateSelection(t,this)}isValid(){return null!=this.selection&&this._isValidDateInstance(this.selection)}isComplete(){return null!=this.selection}clone(){const t=new e(this._adapter);return t.updateSelection(this.selection,this),t}static#t=this.\u0275fac=function(r){return new(r||e)(vt(Ms))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();const $8={provide:$p,deps:[[new aa,new rl,$p],Ms],useFactory:function Kot(e,n){return e||new Zot(n)}},C2=new kt("MAT_DATE_RANGE_SELECTION_STRATEGY");let G8=(()=>{class e{get activeDate(){return this._activeDate}set activeDate(t){const r=this._activeDate,a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(a,this.minDate,this.maxDate),this._hasSameMonthAndYear(r,this._activeDate)||this._init()}get selected(){return this._selected}set selected(t){this._selected=t instanceof ba?t:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t)),this._setRanges(this._selected)}get minDate(){return this._minDate}set minDate(t){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))}get maxDate(){return this._maxDate}set maxDate(t){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))}constructor(t,r,a,c,h){this._changeDetectorRef=t,this._dateFormats=r,this._dateAdapter=a,this._dir=c,this._rangeStrategy=h,this._rerenderSubscription=lt.EMPTY,this.activeDrag=null,this.selectedChange=new me,this._userSelection=new me,this.dragStarted=new me,this.dragEnded=new me,this.activeDateChange=new me,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Ws(null)).subscribe(()=>this._init())}ngOnChanges(t){const r=t.comparisonStart||t.comparisonEnd;r&&!r.firstChange&&this._setRanges(this.selected),t.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(t){const r=t.value,a=this._getDateFromDayOfMonth(r);let c,h;this._selected instanceof ba?(c=this._getDateInCurrentMonth(this._selected.start),h=this._getDateInCurrentMonth(this._selected.end)):c=h=this._getDateInCurrentMonth(this._selected),(c!==r||h!==r)&&this.selectedChange.emit(a),this._userSelection.emit({value:a,event:t.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(t){const a=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(t.value),this._dateAdapter.compareDate(a,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(t){const r=this._activeDate,a=this._isRtl();switch(t.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,a?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,a?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=t.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=t.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:return this._selectionKeyPressed=!0,void(this._canSelect(this._activeDate)&&t.preventDefault());case 27:return void(null!=this._previewEnd&&!Do(t)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:t}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:t})),t.preventDefault(),t.stopPropagation()));default:return}this._dateAdapter.compareDate(r,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),t.preventDefault()}_handleCalendarBodyKeyup(t){(32===t.keyCode||13===t.keyCode)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:t}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let t=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(7+this._dateAdapter.getDayOfWeek(t)-this._dateAdapter.getFirstDayOfWeek())%7,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(t){this._matCalendarBody._focusActiveCell(t)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:t,value:r}){if(this._rangeStrategy){const a=r?r.rawValue:null,c=this._rangeStrategy.createPreview(a,this.selected,t);if(this._previewStart=this._getCellCompareValue(c.start),this._previewEnd=this._getCellCompareValue(c.end),this.activeDrag&&a){const h=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,a,t);h&&(this._previewStart=this._getCellCompareValue(h.start),this._previewEnd=this._getCellCompareValue(h.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(t){if(this.activeDrag)if(t.value){const r=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,t.value,t.event);this.dragEnded.emit({value:r??null,event:t.event})}else this.dragEnded.emit({value:null,event:t.event})}_getDateFromDayOfMonth(t){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),t)}_initWeekdays(){const t=this._dateAdapter.getFirstDayOfWeek(),r=this._dateAdapter.getDayOfWeekNames("narrow");let c=this._dateAdapter.getDayOfWeekNames("long").map((h,f)=>({long:h,narrow:r[f]}));this._weekdays=c.slice(t).concat(c.slice(0,t))}_createWeekCells(){const t=this._dateAdapter.getNumDaysInMonth(this.activeDate),r=this._dateAdapter.getDateNames();this._weeks=[[]];for(let a=0,c=this._firstWeekOffset;a<t;a++,c++){7==c&&(this._weeks.push([]),c=0);const h=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),a+1),f=this._shouldEnableDate(h),b=this._dateAdapter.format(h,this._dateFormats.display.dateA11yLabel),x=this.dateClass?this.dateClass(h,"month"):void 0;this._weeks[this._weeks.length-1].push(new dz(a+1,r[a],b,f,x,this._getCellCompareValue(h),h))}}_shouldEnableDate(t){return!!t&&(!this.minDate||this._dateAdapter.compareDate(t,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(t,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(t))}_getDateInCurrentMonth(t){return t&&this._hasSameMonthAndYear(t,this.activeDate)?this._dateAdapter.getDate(t):null}_hasSameMonthAndYear(t,r){return!(!t||!r||this._dateAdapter.getMonth(t)!=this._dateAdapter.getMonth(r)||this._dateAdapter.getYear(t)!=this._dateAdapter.getYear(r))}_getCellCompareValue(t){if(t){const r=this._dateAdapter.getYear(t),a=this._dateAdapter.getMonth(t),c=this._dateAdapter.getDate(t);return new Date(r,a,c).getTime()}return null}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setRanges(t){t instanceof ba?(this._rangeStart=this._getCellCompareValue(t.start),this._rangeEnd=this._getCellCompareValue(t.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(t),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(t){return!this.dateFilter||this.dateFilter(t)}_clearPreview(){this._previewStart=this._previewEnd=null}static#t=this.\u0275fac=function(r){return new(r||e)(z(Et),z(C_,8),z(Ms,8),z(es,8),z(C2,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-month-view"]],viewQuery:function(r,a){if(1&r&&Hi(Xv,5),2&r){let c;pe(c=fe())&&(a._matCalendarBody=c.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],features:[Bn],decls:7,vars:15,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col",4,"ngFor","ngForOf"],["aria-hidden","true","colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName","selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown"],["scope","col"],[1,"cdk-visually-hidden"],["aria-hidden","true"]],template:function(r,a){1&r&&(ht(0,"table",0)(1,"thead",1)(2,"tr"),Kt(3,Bot,5,2,"th",2),ft(),ht(4,"tr"),je(5,"th",3),ft()(),ht(6,"tbody",4),Se("selectedValueChange",function(h){return a._dateSelected(h)})("activeDateChange",function(h){return a._updateActiveDate(h)})("previewChange",function(h){return a._previewChanged(h)})("dragStarted",function(h){return a.dragStarted.emit(h)})("dragEnded",function(h){return a._dragEnded(h)})("keyup",function(h){return a._handleCalendarBodyKeyup(h)})("keydown",function(h){return a._handleCalendarBodyKeydown(h)}),ft()()),2&r&&(St(3),It("ngForOf",a._weekdays),St(3),It("label",a._monthLabel)("rows",a._weeks)("todayValue",a._todayDate)("startValue",a._rangeStart)("endValue",a._rangeEnd)("comparisonStart",a._comparisonRangeStart)("comparisonEnd",a._comparisonRangeEnd)("previewStart",a._previewStart)("previewEnd",a._previewEnd)("isRange",a._isRange)("labelMinRequiredCells",3)("activeCell",a._dateAdapter.getDate(a.activeDate)-1)("startDateAccessibleName",a.startDateAccessibleName)("endDateAccessibleName",a.endDateAccessibleName))},dependencies:[vC,Xv],encapsulation:2,changeDetection:0})}return e})();const wl=24;let W8=(()=>{class e{get activeDate(){return this._activeDate}set activeDate(t){let r=this._activeDate;const a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(a,this.minDate,this.maxDate),q8(this._dateAdapter,r,this._activeDate,this.minDate,this.maxDate)||this._init()}get selected(){return this._selected}set selected(t){this._selected=t instanceof ba?t:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t)),this._setSelectedYear(t)}get minDate(){return this._minDate}set minDate(t){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))}get maxDate(){return this._maxDate}set maxDate(t){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))}constructor(t,r,a){this._changeDetectorRef=t,this._dateAdapter=r,this._dir=a,this._rerenderSubscription=lt.EMPTY,this.selectedChange=new me,this.yearSelected=new me,this.activeDateChange=new me,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Ws(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());const r=this._dateAdapter.getYear(this._activeDate)-VM(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let a=0,c=[];a<wl;a++)c.push(r+a),4==c.length&&(this._years.push(c.map(h=>this._createCellForYear(h))),c=[]);this._changeDetectorRef.markForCheck()}_yearSelected(t){const r=t.value,a=this._dateAdapter.createDate(r,0,1),c=this._getDateFromYear(r);this.yearSelected.emit(a),this.selectedChange.emit(c)}_updateActiveDate(t){const a=this._activeDate;this.activeDate=this._getDateFromYear(t.value),this._dateAdapter.compareDate(a,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(t){const r=this._activeDate,a=this._isRtl();switch(t.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,a?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,a?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-VM(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,wl-VM(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,t.altKey?10*-wl:-wl);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,t.altKey?10*wl:wl);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),t.preventDefault()}_handleCalendarBodyKeyup(t){(32===t.keyCode||13===t.keyCode)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:t}),this._selectionKeyPressed=!1)}_getActiveCell(){return VM(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(t){const r=this._dateAdapter.getMonth(this.activeDate),a=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(t,r,1));return this._dateAdapter.createDate(t,r,Math.min(this._dateAdapter.getDate(this.activeDate),a))}_createCellForYear(t){const r=this._dateAdapter.createDate(t,0,1),a=this._dateAdapter.getYearName(r),c=this.dateClass?this.dateClass(r,"multi-year"):void 0;return new dz(t,a,a,this._shouldEnableYear(t),c)}_shouldEnableYear(t){if(null==t||this.maxDate&&t>this._dateAdapter.getYear(this.maxDate)||this.minDate&&t<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;for(let a=this._dateAdapter.createDate(t,0,1);this._dateAdapter.getYear(a)==t;a=this._dateAdapter.addCalendarDays(a,1))if(this.dateFilter(a))return!0;return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedYear(t){if(this._selectedYear=null,t instanceof ba){const r=t.start||t.end;r&&(this._selectedYear=this._dateAdapter.getYear(r))}else t&&(this._selectedYear=this._dateAdapter.getYear(t))}static#t=this.\u0275fac=function(r){return new(r||e)(z(Et),z(Ms,8),z(es,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-multi-year-view"]],viewQuery:function(r,a){if(1&r&&Hi(Xv,5),2&r){let c;pe(c=fe())&&(a._matCalendarBody=c.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(r,a){1&r&&(ht(0,"table",0)(1,"thead",1)(2,"tr"),je(3,"th",2),ft()(),ht(4,"tbody",3),Se("selectedValueChange",function(h){return a._yearSelected(h)})("activeDateChange",function(h){return a._updateActiveDate(h)})("keyup",function(h){return a._handleCalendarBodyKeyup(h)})("keydown",function(h){return a._handleCalendarBodyKeydown(h)}),ft()()),2&r&&(St(4),It("rows",a._years)("todayValue",a._todayYear)("startValue",a._selectedYear)("endValue",a._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",a._getActiveCell()))},dependencies:[Xv],encapsulation:2,changeDetection:0})}return e})();function q8(e,n,t,r,a){const c=e.getYear(n),h=e.getYear(t),f=Y8(e,r,a);return Math.floor((c-f)/wl)===Math.floor((h-f)/wl)}function VM(e,n,t,r){return function est(e,n){return(e%n+n)%n}(e.getYear(n)-Y8(e,t,r),wl)}function Y8(e,n,t){let r=0;return t?r=e.getYear(t)-wl+1:n&&(r=e.getYear(n)),r}let Z8=(()=>{class e{get activeDate(){return this._activeDate}set activeDate(t){let r=this._activeDate;const a=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(a,this.minDate,this.maxDate),this._dateAdapter.getYear(r)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}get selected(){return this._selected}set selected(t){this._selected=t instanceof ba?t:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t)),this._setSelectedMonth(t)}get minDate(){return this._minDate}set minDate(t){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))}get maxDate(){return this._maxDate}set maxDate(t){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))}constructor(t,r,a,c){this._changeDetectorRef=t,this._dateFormats=r,this._dateAdapter=a,this._dir=c,this._rerenderSubscription=lt.EMPTY,this.selectedChange=new me,this.monthSelected=new me,this.activeDateChange=new me,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Ws(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(t){const r=t.value,a=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),r,1);this.monthSelected.emit(a);const c=this._getDateFromMonth(r);this.selectedChange.emit(c)}_updateActiveDate(t){const a=this._activeDate;this.activeDate=this._getDateFromMonth(t.value),this._dateAdapter.compareDate(a,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(t){const r=this._activeDate,a=this._isRtl();switch(t.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,a?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,a?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,t.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,t.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(r,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),t.preventDefault()}_handleCalendarBodyKeyup(t){(32===t.keyCode||13===t.keyCode)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:t}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let t=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(r=>r.map(a=>this._createCellForMonth(a,t[a]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(t){return t&&this._dateAdapter.getYear(t)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(t):null}_getDateFromMonth(t){const r=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),t,1),a=this._dateAdapter.getNumDaysInMonth(r);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),t,Math.min(this._dateAdapter.getDate(this.activeDate),a))}_createCellForMonth(t,r){const a=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),t,1),c=this._dateAdapter.format(a,this._dateFormats.display.monthYearA11yLabel),h=this.dateClass?this.dateClass(a,"year"):void 0;return new dz(t,r.toLocaleUpperCase(),c,this._shouldEnableMonth(t),h)}_shouldEnableMonth(t){const r=this._dateAdapter.getYear(this.activeDate);if(null==t||this._isYearAndMonthAfterMaxDate(r,t)||this._isYearAndMonthBeforeMinDate(r,t))return!1;if(!this.dateFilter)return!0;for(let c=this._dateAdapter.createDate(r,t,1);this._dateAdapter.getMonth(c)==t;c=this._dateAdapter.addCalendarDays(c,1))if(this.dateFilter(c))return!0;return!1}_isYearAndMonthAfterMaxDate(t,r){if(this.maxDate){const a=this._dateAdapter.getYear(this.maxDate),c=this._dateAdapter.getMonth(this.maxDate);return t>a||t===a&&r>c}return!1}_isYearAndMonthBeforeMinDate(t,r){if(this.minDate){const a=this._dateAdapter.getYear(this.minDate),c=this._dateAdapter.getMonth(this.minDate);return t<a||t===a&&r<c}return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedMonth(t){this._selectedMonth=t instanceof ba?this._getMonthInCurrentYear(t.start)||this._getMonthInCurrentYear(t.end):this._getMonthInCurrentYear(t)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Et),z(C_,8),z(Ms,8),z(es,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-year-view"]],viewQuery:function(r,a){if(1&r&&Hi(Xv,5),2&r){let c;pe(c=fe())&&(a._matCalendarBody=c.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(r,a){1&r&&(ht(0,"table",0)(1,"thead",1)(2,"tr"),je(3,"th",2),ft()(),ht(4,"tbody",3),Se("selectedValueChange",function(h){return a._monthSelected(h)})("activeDateChange",function(h){return a._updateActiveDate(h)})("keyup",function(h){return a._handleCalendarBodyKeyup(h)})("keydown",function(h){return a._handleCalendarBodyKeydown(h)}),ft()()),2&r&&(St(4),It("label",a._yearLabel)("rows",a._months)("todayValue",a._todayMonth)("startValue",a._selectedMonth)("endValue",a._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",a._dateAdapter.getMonth(a.activeDate)))},dependencies:[Xv],encapsulation:2,changeDetection:0})}return e})(),ist=1,nst=(()=>{class e{constructor(t,r,a,c,h){this._intl=t,this.calendar=r,this._dateAdapter=a,this._dateFormats=c,this._id="mat-calendar-header-"+ist++,this._periodButtonLabelId=`${this._id}-period-label`,this.calendar.stateChanges.subscribe(()=>h.markForCheck())}get periodButtonText(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return"month"==this.calendar.currentView?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView="month"==this.calendar.currentView?"multi-year":"month"}previousClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?-1:-wl)}nextClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?1:wl)}previousEnabled(){return!this.calendar.minDate||!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate)}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(t,r){return"month"==this.calendar.currentView?this._dateAdapter.getYear(t)==this._dateAdapter.getYear(r)&&this._dateAdapter.getMonth(t)==this._dateAdapter.getMonth(r):"year"==this.calendar.currentView?this._dateAdapter.getYear(t)==this._dateAdapter.getYear(r):q8(this._dateAdapter,t,r,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){const r=this._dateAdapter.getYear(this.calendar.activeDate)-VM(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),a=r+wl-1;return[this._dateAdapter.getYearName(this._dateAdapter.createDate(r,0,1)),this._dateAdapter.getYearName(this._dateAdapter.createDate(a,0,1))]}static#t=this.\u0275fac=function(r){return new(r||e)(z(zM),z(rn(()=>bz)),z(Ms,8),z(C_,8),z(Et))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],ngContentSelectors:Not,decls:13,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["mat-button","","type","button","aria-live","polite",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"disabled","click"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"disabled","click"],[1,"mat-calendar-hidden-label",3,"id"]],template:function(r,a){1&r&&(xn(),ht(0,"div",0)(1,"div",1)(2,"button",2),Se("click",function(){return a.currentPeriodClicked()}),ht(3,"span",3),be(4),ft(),Ps(),ht(5,"svg",4),je(6,"polygon",5),ft()(),Vl(),je(7,"div",6),Oe(8),ht(9,"button",7),Se("click",function(){return a.previousClicked()}),ft(),ht(10,"button",8),Se("click",function(){return a.nextClicked()}),ft()()(),ht(11,"label",9),be(12),ft()),2&r&&(St(2),Ve("aria-label",a.periodButtonLabel)("aria-describedby",a._periodButtonLabelId),St(2),_s(a.periodButtonText),St(1),Qe("mat-calendar-invert","month"!==a.calendar.currentView),St(4),It("disabled",!a.previousEnabled()),Ve("aria-label",a.prevButtonLabel),St(1),It("disabled",!a.nextEnabled()),Ve("aria-label",a.nextButtonLabel),St(1),It("id",a._periodButtonLabelId),St(1),_s(a.periodButtonDescription))},dependencies:[LM,BM],encapsulation:2,changeDetection:0})}return e})(),bz=(()=>{class e{get startAt(){return this._startAt}set startAt(t){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))}get selected(){return this._selected}set selected(t){this._selected=t instanceof ba?t:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))}get minDate(){return this._minDate}set minDate(t){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))}get maxDate(){return this._maxDate}set maxDate(t){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))}get activeDate(){return this._clampedActiveDate}set activeDate(t){this._clampedActiveDate=this._dateAdapter.clampDate(t,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}get currentView(){return this._currentView}set currentView(t){const r=this._currentView!==t?t:null;this._currentView=t,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),r&&this.viewChanged.emit(r)}constructor(t,r,a,c){this._dateAdapter=r,this._dateFormats=a,this._changeDetectorRef=c,this._moveFocusOnNextTick=!1,this.startView="month",this.selectedChange=new me,this.yearSelected=new me,this.monthSelected=new me,this.viewChanged=new me(!0),this._userSelection=new me,this._userDragDrop=new me,this._activeDrag=null,this.stateChanges=new we,this._intlChanges=t.changes.subscribe(()=>{c.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new Bv(this.headerComponent||nst),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(t){const r=t.minDate&&!this._dateAdapter.sameDate(t.minDate.previousValue,t.minDate.currentValue)?t.minDate:void 0,a=t.maxDate&&!this._dateAdapter.sameDate(t.maxDate.previousValue,t.maxDate.currentValue)?t.maxDate:void 0,c=r||a||t.dateFilter;if(c&&!c.firstChange){const h=this._getCurrentViewComponent();h&&(this._changeDetectorRef.detectChanges(),h._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(t){const r=t.value;(this.selected instanceof ba||r&&!this._dateAdapter.sameDate(r,this.selected))&&this.selectedChange.emit(r),this._userSelection.emit(t)}_yearSelectedInMultiYearView(t){this.yearSelected.emit(t)}_monthSelectedInYearView(t){this.monthSelected.emit(t)}_goToDateInView(t,r){this.activeDate=t,this.currentView=r}_dragStarted(t){this._activeDrag=t}_dragEnded(t){this._activeDrag&&(t.value&&this._userDragDrop.emit(t),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}static#t=this.\u0275fac=function(r){return new(r||e)(z(zM),z(Ms,8),z(C_,8),z(Et))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-calendar"]],viewQuery:function(r,a){if(1&r&&(Hi(G8,5),Hi(Z8,5),Hi(W8,5)),2&r){let c;pe(c=fe())&&(a.monthView=c.first),pe(c=fe())&&(a.yearView=c.first),pe(c=fe())&&(a.multiYearView=c.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],features:[Te([$8]),Bn],decls:5,vars:5,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content",3,"ngSwitch"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange"]],template:function(r,a){1&r&&(Kt(0,zot,0,0,"ng-template",0),ht(1,"div",1),Kt(2,Vot,1,11,"mat-month-view",2),Kt(3,jot,1,6,"mat-year-view",3),Kt(4,Uot,1,6,"mat-multi-year-view",4),ft()),2&r&&(It("cdkPortalOutlet",a._calendarHeaderPortal),St(1),It("ngSwitch",a.currentView),St(1),It("ngSwitchCase","month"),St(1),It("ngSwitchCase","year"),St(1),It("ngSwitchCase","multi-year"))},dependencies:[Qg,xC,jnt,DM,G8,Z8,W8],styles:['.mat-calendar{display:block;font-family:var(--mat-datepicker-calendar-text-font);font-size:var(--mat-datepicker-calendar-text-size)}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px;font-size:var(--mat-datepicker-calendar-period-button-text-size);font-weight:var(--mat-datepicker-calendar-period-button-text-weight)}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle;fill:var(--mat-datepicker-calendar-period-button-icon-color)}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}.cdk-high-contrast-active .mat-calendar-arrow{fill:CanvasText}.mat-calendar-previous-button,.mat-calendar-next-button{position:relative}.mat-datepicker-content .mat-calendar-previous-button,.mat-datepicker-content .mat-calendar-next-button{color:var(--mat-datepicker-calendar-navigation-button-icon-color)}.mat-calendar-previous-button::after,.mat-calendar-next-button::after{top:0;left:0;right:0;bottom:0;position:absolute;content:"";margin:15.5px;border:0 solid currentColor;border-top-width:2px}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-previous-button::after{border-left-width:2px;transform:translateX(2px) rotate(-45deg)}.mat-calendar-next-button::after{border-right-width:2px;transform:translateX(-2px) rotate(45deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0;color:var(--mat-datepicker-calendar-header-text-color);font-size:var(--mat-datepicker-calendar-header-text-size);font-weight:var(--mat-datepicker-calendar-header-text-weight)}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px;background:var(--mat-datepicker-calendar-header-divider-color)}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}.mat-calendar-hidden-label{display:none}'],encapsulation:2,changeDetection:0})}return e})();const X8={transformPanel:Po("transformPanel",[Tn("void => enter-dropdown",Fn("120ms cubic-bezier(0, 0, 0.2, 1)",Wv([oi({opacity:0,transform:"scale(1, 0.8)"}),oi({opacity:1,transform:"scale(1, 1)"})]))),Tn("void => enter-dialog",Fn("150ms cubic-bezier(0, 0, 0.2, 1)",Wv([oi({opacity:0,transform:"scale(0.7)"}),oi({transform:"none",opacity:1})]))),Tn("* => void",Fn("100ms linear",oi({opacity:0})))]),fadeInCalendar:Po("fadeInCalendar",[Hn("void",oi({opacity:0})),Hn("enter",oi({opacity:1})),Tn("void => *",Fn("120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"))])};let rst=0;const K8=new kt("mat-datepicker-scroll-strategy"),sst={provide:K8,deps:[_a],useFactory:function ost(e){return()=>e.scrollStrategies.reposition()}},ast=Uv(class{constructor(e){this._elementRef=e}});let lst=(()=>{class e extends ast{constructor(t,r,a,c,h,f){super(t),this._changeDetectorRef=r,this._globalModel=a,this._dateAdapter=c,this._rangeSelectionStrategy=h,this._subscriptions=new lt,this._animationDone=new we,this._isAnimating=!1,this._actionsPortal=null,this._closeButtonText=f.closeCalendarLabel}ngOnInit(){this._animationState=this.datepicker.touchUi?"enter-dialog":"enter-dropdown"}ngAfterViewInit(){this._subscriptions.add(this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})),this._calendar.focusActiveCell()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._animationDone.complete()}_handleUserSelection(t){const r=this._model.selection,a=t.value,c=r instanceof ba;if(c&&this._rangeSelectionStrategy){const h=this._rangeSelectionStrategy.selectionFinished(a,r,t.event);this._model.updateSelection(h,this)}else a&&(c||!this._dateAdapter.sameDate(a,r))&&this._model.add(a);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(t){this._model.updateSelection(t.value,this)}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}_handleAnimationEvent(t){this._isAnimating="start"===t.phaseName,this._isAnimating||this._animationDone.next()}_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(t,r){this._model=t?this._globalModel.clone():this._globalModel,this._actionsPortal=t,r&&this._changeDetectorRef.detectChanges()}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(Et),z($p),z(Ms),z(C2,8),z(zM))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-datepicker-content"]],viewQuery:function(r,a){if(1&r&&Hi(bz,5),2&r){let c;pe(c=fe())&&(a._calendar=c.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:3,hostBindings:function(r,a){1&r&&kg("@transformPanel.start",function(h){return a._handleAnimationEvent(h)})("@transformPanel.done",function(h){return a._handleAnimationEvent(h)}),2&r&&(Rg("@transformPanel",a._animationState),Qe("mat-datepicker-content-touch",a.datepicker.touchUi))},inputs:{color:"color"},exportAs:["matDatepickerContent"],features:[Xt],decls:5,vars:26,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"id","ngClass","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"color","focus","blur","click"]],template:function(r,a){if(1&r&&(ht(0,"div",0)(1,"mat-calendar",1),Se("yearSelected",function(h){return a.datepicker._selectYear(h)})("monthSelected",function(h){return a.datepicker._selectMonth(h)})("viewChanged",function(h){return a.datepicker._viewChanged(h)})("_userSelection",function(h){return a._handleUserSelection(h)})("_userDragDrop",function(h){return a._handleUserDragDrop(h)}),ft(),Kt(2,Hot,0,0,"ng-template",2),ht(3,"button",3),Se("focus",function(){return a._closeButtonFocused=!0})("blur",function(){return a._closeButtonFocused=!1})("click",function(){return a.datepicker.close()}),be(4),ft()()),2&r){let c;Qe("mat-datepicker-content-container-with-custom-header",a.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",a._actionsPortal),Ve("aria-modal",!0)("aria-labelledby",null!==(c=a._dialogLabelId)&&void 0!==c?c:void 0),St(1),It("id",a.datepicker.id)("ngClass",a.datepicker.panelClass)("startAt",a.datepicker.startAt)("startView",a.datepicker.startView)("minDate",a.datepicker._getMinDate())("maxDate",a.datepicker._getMaxDate())("dateFilter",a.datepicker._getDateFilter())("headerComponent",a.datepicker.calendarHeaderComponent)("selected",a._getSelected())("dateClass",a.datepicker.dateClass)("comparisonStart",a.comparisonStart)("comparisonEnd",a.comparisonEnd)("@fadeInCalendar","enter")("startDateAccessibleName",a.startDateAccessibleName)("endDateAccessibleName",a.endDateAccessibleName),St(1),It("cdkPortalOutlet",a._actionsPortal),St(1),Qe("cdk-visually-hidden",!a._closeButtonFocused),It("color",a.color||"primary"),St(1),_s(a._closeButtonText)}},dependencies:[yC,LM,Int,DM,bz],styles:[".mat-datepicker-content{box-shadow:0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12);display:block;border-radius:4px;background-color:var(--mat-datepicker-calendar-container-background-color);color:var(--mat-datepicker-calendar-container-text-color)}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.ng-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{box-shadow:0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12);display:block;max-height:80vh;position:relative;overflow:visible}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}"],encapsulation:2,data:{animation:[X8.transformPanel,X8.fadeInCalendar]},changeDetection:0})}return e})(),Q8=(()=>{class e{get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(t){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t))}get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(t){this._color=t}get touchUi(){return this._touchUi}set touchUi(t){this._touchUi=De(t)}get disabled(){return void 0===this._disabled&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(t){const r=De(t);r!==this._disabled&&(this._disabled=r,this.stateChanges.next(void 0))}get restoreFocus(){return this._restoreFocus}set restoreFocus(t){this._restoreFocus=De(t)}get panelClass(){return this._panelClass}set panelClass(t){this._panelClass=function uit(e,n=/\s+/){const t=[];if(null!=e){const r=Array.isArray(e)?e:`${e}`.split(n);for(const a of r){const c=`${a}`.trim();c&&t.push(c)}}return t}(t)}get opened(){return this._opened}set opened(t){De(t)?this.open():this.close()}_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}constructor(t,r,a,c,h,f,b){this._overlay=t,this._ngZone=r,this._viewContainerRef=a,this._dateAdapter=h,this._dir=f,this._model=b,this._inputStateChanges=lt.EMPTY,this._document=oe(ki),this.startView="month",this._touchUi=!1,this.xPosition="start",this.yPosition="below",this._restoreFocus=!0,this.yearSelected=new me,this.monthSelected=new me,this.viewChanged=new me(!0),this.openedStream=new me,this.closedStream=new me,this._opened=!1,this.id="mat-datepicker-"+rst++,this._focusedElementBeforeOpen=null,this._backdropHarnessClass=`${this.id}-backdrop`,this.stateChanges=new we,this._scrollStrategy=c}ngOnChanges(t){const r=t.xPosition||t.yPosition;if(r&&!r.firstChange&&this._overlayRef){const a=this._overlayRef.getConfig().positionStrategy;a instanceof wH&&(this._setConnectedPositions(a),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(t){this._model.add(t)}_selectYear(t){this.yearSelected.emit(t)}_selectMonth(t){this.monthSelected.emit(t)}_viewChanged(t){this.viewChanged.emit(t)}registerInput(t){return this._inputStateChanges.unsubscribe(),this.datepickerInput=t,this._inputStateChanges=t.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(t){this._actionsPortal=t,this._componentRef?.instance._assignActions(t,!0)}removeActions(t){t===this._actionsPortal&&(this._actionsPortal=null,this._componentRef?.instance._assignActions(null,!0))}open(){this._opened||this.disabled||this._componentRef?.instance._isAnimating||(this._focusedElementBeforeOpen=Fv(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened||this._componentRef?.instance._isAnimating)return;const t=this._restoreFocus&&this._focusedElementBeforeOpen&&"function"==typeof this._focusedElementBeforeOpen.focus,r=()=>{this._opened&&(this._opened=!1,this.closedStream.emit())};if(this._componentRef){const{instance:a,location:c}=this._componentRef;a._startExitAnimation(),a._animationDone.pipe(nr(1)).subscribe(()=>{const h=this._document.activeElement;t&&(!h||h===this._document.activeElement||c.nativeElement.contains(h))&&this._focusedElementBeforeOpen.focus(),this._focusedElementBeforeOpen=null,this._destroyOverlay()})}t?setTimeout(r):r()}_applyPendingSelection(){this._componentRef?.instance?._applyPendingSelection()}_forwardContentValues(t){t.datepicker=this,t.color=this.color,t._dialogLabelId=this.datepickerInput.getOverlayLabelId(),t._assignActions(this._actionsPortal,!1)}_openOverlay(){this._destroyOverlay();const t=this.touchUi,r=new Bv(lst,this._viewContainerRef),a=this._overlayRef=this._overlay.create(new TM({positionStrategy:t?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[t?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir,scrollStrategy:t?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:"mat-datepicker-"+(t?"dialog":"popup")}));this._getCloseStream(a).subscribe(c=>{c&&c.preventDefault(),this.close()}),a.keydownEvents().subscribe(c=>{const h=c.keyCode;(38===h||40===h||37===h||39===h||33===h||34===h)&&c.preventDefault()}),this._componentRef=a.attach(r),this._forwardContentValues(this._componentRef.instance),t||this._ngZone.onStable.pipe(nr(1)).subscribe(()=>a.updatePosition())}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){const t=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(t)}_setConnectedPositions(t){const r="end"===this.xPosition?"end":"start",a="start"===r?"end":"start",c="above"===this.yPosition?"bottom":"top",h="top"===c?"bottom":"top";return t.withPositions([{originX:r,originY:h,overlayX:r,overlayY:c},{originX:r,originY:c,overlayX:r,overlayY:h},{originX:a,originY:h,overlayX:a,overlayY:c},{originX:a,originY:c,overlayX:a,overlayY:h}])}_getCloseStream(t){const r=["ctrlKey","shiftKey","metaKey"];return wr(t.backdropClick(),t.detachments(),t.keydownEvents().pipe(rr(a=>27===a.keyCode&&!Do(a)||this.datepickerInput&&Do(a,"altKey")&&38===a.keyCode&&r.every(c=>!Do(a,c)))))}static#t=this.\u0275fac=function(r){return new(r||e)(z(_a),z(Re),z(hr),z(K8),z(Ms,8),z(es,8),z($p))};static#e=this.\u0275dir=Mt({type:e,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:"touchUi",disabled:"disabled",xPosition:"xPosition",yPosition:"yPosition",restoreFocus:"restoreFocus",dateClass:"dateClass",panelClass:"panelClass",opened:"opened"},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[Bn]})}return e})(),cst=(()=>{class e extends Q8{static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-datepicker"]],exportAs:["matDatepicker"],features:[Te([$8,{provide:Q8,useExisting:e}]),Xt],decls:0,vars:0,template:function(r,a){},encapsulation:2,changeDetection:0})}return e})();class M2{constructor(n,t){this.target=n,this.targetElement=t,this.value=this.target.value}}let dst=(()=>{class e{get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(t){this._assignValueProgrammatically(t)}get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(t){const r=De(t),a=this._elementRef.nativeElement;this._disabled!==r&&(this._disabled=r,this.stateChanges.next(void 0)),r&&this._isInitialized&&a.blur&&a.blur()}_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(t){this._model=t,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(r=>{if(this._shouldHandleChangeEvent(r)){const a=this._getValueFromModel(r.selection);this._lastValueValid=this._isValidValue(a),this._cvaOnChange(a),this._onTouched(),this._formatValue(a),this.dateInput.emit(new M2(this,this._elementRef.nativeElement)),this.dateChange.emit(new M2(this,this._elementRef.nativeElement))}})}constructor(t,r,a){this._elementRef=t,this._dateAdapter=r,this._dateFormats=a,this.dateChange=new me,this.dateInput=new me,this.stateChanges=new we,this._onTouched=()=>{},this._validatorOnChange=()=>{},this._cvaOnChange=()=>{},this._valueChangesSubscription=lt.EMPTY,this._localeSubscription=lt.EMPTY,this._parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}},this._filterValidator=c=>{const h=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(c.value));return!h||this._matchesFilter(h)?null:{matDatepickerFilter:!0}},this._minValidator=c=>{const h=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(c.value)),f=this._getMinDate();return!f||!h||this._dateAdapter.compareDate(f,h)<=0?null:{matDatepickerMin:{min:f,actual:h}}},this._maxValidator=c=>{const h=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(c.value)),f=this._getMaxDate();return!f||!h||this._dateAdapter.compareDate(f,h)>=0?null:{matDatepickerMax:{max:f,actual:h}}},this._lastValueValid=!1,this._localeSubscription=r.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(t){(function ust(e,n){const t=Object.keys(e);for(let r of t){const{previousValue:a,currentValue:c}=e[r];if(!n.isDateInstance(a)||!n.isDateInstance(c))return!0;if(!n.sameDate(a,c))return!0}return!1})(t,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(t){this._validatorOnChange=t}validate(t){return this._validator?this._validator(t):null}writeValue(t){this._assignValueProgrammatically(t)}registerOnChange(t){this._cvaOnChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}_onKeydown(t){Do(t,"altKey")&&40===t.keyCode&&["ctrlKey","shiftKey","metaKey"].every(c=>!Do(t,c))&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),t.preventDefault())}_onInput(t){const r=this._lastValueValid;let a=this._dateAdapter.parse(t,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(a),a=this._dateAdapter.getValidDateOrNull(a);const c=!this._dateAdapter.sameDate(a,this.value);!a||c?this._cvaOnChange(a):(t&&!this.value&&this._cvaOnChange(a),r!==this._lastValueValid&&this._validatorOnChange()),c&&(this._assignValue(a),this.dateInput.emit(new M2(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new M2(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(t){this._elementRef.nativeElement.value=null!=t?this._dateAdapter.format(t,this._dateFormats.display.dateInput):""}_assignValue(t){this._model?(this._assignValueToModel(t),this._pendingValue=null):this._pendingValue=t}_isValidValue(t){return!t||this._dateAdapter.isValid(t)}_parentDisabled(){return!1}_assignValueProgrammatically(t){t=this._dateAdapter.deserialize(t),this._lastValueValid=this._isValidValue(t),t=this._dateAdapter.getValidDateOrNull(t),this._assignValue(t),this._formatValue(t)}_matchesFilter(t){const r=this._getDateFilter();return!r||r(t)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(Ms,8),z(C_,8))};static#e=this.\u0275dir=Mt({type:e,inputs:{value:"value",disabled:"disabled"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[Bn]})}return e})();const hst={provide:Cs,useExisting:rn(()=>yz),multi:!0},mst={provide:Jo,useExisting:rn(()=>yz),multi:!0};let yz=(()=>{class e extends dst{set matDatepicker(t){t&&(this._datepicker=t,this._closedSubscription=t.closedStream.subscribe(()=>this._onTouched()),this._registerModel(t.registerInput(this)))}get min(){return this._min}set min(t){const r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t));this._dateAdapter.sameDate(r,this._min)||(this._min=r,this._validatorOnChange())}get max(){return this._max}set max(t){const r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(t));this._dateAdapter.sameDate(r,this._max)||(this._max=r,this._validatorOnChange())}get dateFilter(){return this._dateFilter}set dateFilter(t){const r=this._matchesFilter(this.value);this._dateFilter=t,this._matchesFilter(this.value)!==r&&this._validatorOnChange()}constructor(t,r,a,c){super(t,r,a),this._formField=c,this._closedSubscription=lt.EMPTY,this._validator=vl.compose(super._getValidators())}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():this._elementRef.nativeElement.getAttribute("aria-labelledby")}getThemePalette(){return this._formField?this._formField.color:void 0}getStartValue(){return this.value}ngOnDestroy(){super.ngOnDestroy(),this._closedSubscription.unsubscribe()}_openPopup(){this._datepicker&&this._datepicker.open()}_getValueFromModel(t){return t}_assignValueToModel(t){this._model&&this._model.updateSelection(t,this)}_getMinDate(){return this._min}_getMaxDate(){return this._max}_getDateFilter(){return this._dateFilter}_shouldHandleChangeEvent(t){return t.source!==this}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(Ms,8),z(C_,8),z(Zv,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["input","matDatepicker",""]],hostAttrs:[1,"mat-datepicker-input"],hostVars:6,hostBindings:function(r,a){1&r&&Se("input",function(h){return a._onInput(h.target.value)})("change",function(){return a._onChange()})("blur",function(){return a._onBlur()})("keydown",function(h){return a._onKeydown(h)}),2&r&&(Ao("disabled",a.disabled),Ve("aria-haspopup",a._datepicker?"dialog":null)("aria-owns",(null==a._datepicker?null:a._datepicker.opened)&&a._datepicker.id||null)("min",a.min?a._dateAdapter.toIso8601(a.min):null)("max",a.max?a._dateAdapter.toIso8601(a.max):null)("data-mat-calendar",a._datepicker?a._datepicker.id:null))},inputs:{matDatepicker:"matDatepicker",min:"min",max:"max",dateFilter:["matDatepickerFilter","dateFilter"]},exportAs:["matDatepickerInput"],features:[Te([hst,mst,{provide:j8,useExisting:e}]),Xt]})}return e})(),pst=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275dir=Mt({type:e,selectors:[["","matDatepickerToggleIcon",""]]})}return e})(),fst=(()=>{class e{get disabled(){return void 0===this._disabled&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(t){this._disabled=De(t)}constructor(t,r,a){this._intl=t,this._changeDetectorRef=r,this._stateChanges=lt.EMPTY;const c=Number(a);this.tabIndex=c||0===c?c:null}ngOnChanges(t){t.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(t){this.datepicker&&!this.disabled&&(this.datepicker.open(),t.stopPropagation())}_watchStateChanges(){const t=this.datepicker?this.datepicker.stateChanges:Le(),r=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:Le(),a=this.datepicker?wr(this.datepicker.openedStream,this.datepicker.closedStream):Le();this._stateChanges.unsubscribe(),this._stateChanges=wr(this._intl.changes,t,r,a).subscribe(()=>this._changeDetectorRef.markForCheck())}static#t=this.\u0275fac=function(r){return new(r||e)(z(zM),z(Et),Ue("tabindex"))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-datepicker-toggle"]],contentQueries:function(r,a,c){if(1&r&&Fi(c,pst,5),2&r){let h;pe(h=fe())&&(a._customIcon=h.first)}},viewQuery:function(r,a){if(1&r&&Hi($ot,5),2&r){let c;pe(c=fe())&&(a._button=c.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(r,a){1&r&&Se("click",function(h){return a._open(h)}),2&r&&(Ve("tabindex",null)("data-mat-calendar",a.datepicker?a.datepicker.id:null),Qe("mat-datepicker-toggle-active",a.datepicker&&a.datepicker.opened)("mat-accent",a.datepicker&&"accent"===a.datepicker.color)("mat-warn",a.datepicker&&"warn"===a.datepicker.color))},inputs:{datepicker:["for","datepicker"],tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],disabled:"disabled",disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],features:[Bn],ngContentSelectors:qot,decls:4,vars:6,consts:[["mat-icon-button","","type","button",3,"disabled","disableRipple"],["button",""],["class","mat-datepicker-toggle-default-icon","viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",4,"ngIf"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(r,a){1&r&&(xn(Wot),ht(0,"button",0,1),Kt(2,Got,2,0,"svg",2),Oe(3),ft()),2&r&&(It("disabled",a.disabled)("disableRipple",a.disableRipple),Ve("aria-haspopup",a.datepicker?"dialog":null)("aria-label",a.ariaLabel||a._intl.openCalendarLabel)("tabindex",a.disabled?-1:a.tabIndex),St(2),It("ngIf",!a._customIcon))},dependencies:[La,BM],styles:[".mat-datepicker-toggle{pointer-events:auto;color:var(--mat-datepicker-toggle-icon-color)}.mat-datepicker-toggle-active{color:var(--mat-datepicker-toggle-active-state-icon-color)}.cdk-high-contrast-active .mat-datepicker-toggle-default-icon{color:CanvasText}"],encapsulation:2,changeDetection:0})}return e})(),bst=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[zM,sst],imports:[ws,_2,jp,c2,Vp,yi,Sh]})}return e})();class yst{}function D2(e){return e&&"function"==typeof e.connect&&!(e instanceof KL)}class t${applyChanges(n,t,r,a,c){n.forEachOperation((h,f,b)=>{let x,M;if(null==h.previousIndex){const T=r(h,f,b);x=t.createEmbeddedView(T.templateRef,T.context,T.index),M=1}else null==b?(t.remove(f),M=3):(x=t.get(f),t.move(x,b),M=2);c&&c({context:x?.context,operation:M,record:h})})}detach(){}}class k2{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(n=!1,t,r=!0,a){this._multiple=n,this._emitChanges=r,this.compareWith=a,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new we,t&&t.length&&(n?t.forEach(c=>this._markSelected(c)):this._markSelected(t[0]),this._selectedToEmit.length=0)}select(...n){this._verifyValueAssignment(n),n.forEach(r=>this._markSelected(r));const t=this._hasQueuedChanges();return this._emitChangeEvent(),t}deselect(...n){this._verifyValueAssignment(n),n.forEach(r=>this._unmarkSelected(r));const t=this._hasQueuedChanges();return this._emitChangeEvent(),t}setSelection(...n){this._verifyValueAssignment(n);const t=this.selected,r=new Set(n);n.forEach(c=>this._markSelected(c)),t.filter(c=>!r.has(c)).forEach(c=>this._unmarkSelected(c));const a=this._hasQueuedChanges();return this._emitChangeEvent(),a}toggle(n){return this.isSelected(n)?this.deselect(n):this.select(n)}clear(n=!0){this._unmarkAll();const t=this._hasQueuedChanges();return n&&this._emitChangeEvent(),t}isSelected(n){return this._selection.has(this._getConcreteValue(n))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(n){this._multiple&&this.selected&&this._selected.sort(n)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(n){n=this._getConcreteValue(n),this.isSelected(n)||(this._multiple||this._unmarkAll(),this.isSelected(n)||this._selection.add(n),this._emitChanges&&this._selectedToEmit.push(n))}_unmarkSelected(n){n=this._getConcreteValue(n),this.isSelected(n)&&(this._selection.delete(n),this._emitChanges&&this._deselectedToEmit.push(n))}_unmarkAll(){this.isEmpty()||this._selection.forEach(n=>this._unmarkSelected(n))}_verifyValueAssignment(n){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(n){if(this.compareWith){for(let t of this._selection)if(this.compareWith(n,t))return t;return n}return n}}const jM=new kt("_ViewRepeater"),xst=["trigger"],wst=["panel"];function Cst(e,n){if(1&e&&(ht(0,"span",10),be(1),ft()),2&e){const t=Ne();St(1),_s(t.placeholder)}}function Mst(e,n){if(1&e&&(ht(0,"span",14),be(1),ft()),2&e){const t=Ne(2);St(1),_s(t.triggerValue)}}function Dst(e,n){1&e&&Oe(0,0,["*ngSwitchCase","true"])}function kst(e,n){1&e&&(ht(0,"span",11),Kt(1,Mst,2,1,"span",12),Kt(2,Dst,1,0,"ng-content",13),ft()),2&e&&(It("ngSwitch",!!Ne().customTrigger),St(2),It("ngSwitchCase",!0))}function Sst(e,n){if(1&e){const t=vo();Ps(),Vl(),ht(0,"div",15,16),Se("@transformPanel.done",function(a){return $n(t),Nn(Ne()._panelDoneAnimatingStream.next(a.toState))})("keydown",function(a){return $n(t),Nn(Ne()._handleKeydown(a))}),Oe(2,1),ft()}if(2&e){const t=Ne();Xw("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",t._getPanelTheme(),""),It("ngClass",t.panelClass)("@transformPanel","showing"),Ve("id",t.id+"-panel")("aria-multiselectable",t.multiple)("aria-label",t.ariaLabel||null)("aria-labelledby",t._getPanelAriaLabelledby())}}const Tst=[[["mat-select-trigger"]],"*"],Est=["mat-select-trigger","*"],Ast={transformPanelWrap:Po("transformPanelWrap",[Tn("* => void",Yv("@transformPanel",[qv()],{optional:!0}))]),transformPanel:Po("transformPanel",[Hn("void",oi({opacity:0,transform:"scale(1, 0.8)"})),Tn("void => showing",Fn("120ms cubic-bezier(0, 0, 0.2, 1)",oi({opacity:1,transform:"scale(1, 1)"}))),Tn("* => void",Fn("100ms linear",oi({opacity:0})))])};let i$=0;const n$=new kt("mat-select-scroll-strategy"),Rst=new kt("MAT_SELECT_CONFIG"),Pst={provide:n$,deps:[_a],useFactory:function Ist(e){return()=>e.scrollStrategies.reposition()}},Ost=new kt("MatSelectTrigger");class Fst{constructor(n,t){this.source=n,this.value=t}}const Lst=Hv(w_(Up(tz(class{constructor(e,n,t,r,a){this._elementRef=e,this._defaultErrorStateMatcher=n,this._parentForm=t,this._parentFormGroup=r,this.ngControl=a,this.stateChanges=new we}}))));let Bst=(()=>{class e extends Lst{get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(t){this._placeholder=t,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(vl.required)??!1}set required(t){this._required=De(t),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(t){this._multiple=De(t)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(t){this._disableOptionCentering=De(t)}get compareWith(){return this._compareWith}set compareWith(t){this._compareWith=t,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(t){this._assignValue(t)&&this._onChange(t)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(t){this._typeaheadDebounceInterval=ts(t)}get id(){return this._id}set id(t){this._id=t||this._uid,this.stateChanges.next()}constructor(t,r,a,c,h,f,b,x,M,T,I,L,N,V){super(h,c,b,x,T),this._viewportRuler=t,this._changeDetectorRef=r,this._ngZone=a,this._dir=f,this._parentFormField=M,this._liveAnnouncer=N,this._defaultOptions=V,this._panelOpen=!1,this._compareWith=($,nt)=>$===nt,this._uid="mat-select-"+i$++,this._triggerAriaLabelledBy=null,this._destroy=new we,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+i$++,this._panelDoneAnimatingStream=new we,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this._multiple=!1,this._disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.optionSelectionChanges=cv(()=>{const $=this.options;return $?$.changes.pipe(Ws($),Ci(()=>wr(...$.map(nt=>nt.onSelectionChange)))):this._ngZone.onStable.pipe(nr(1),Ci(()=>this.optionSelectionChanges))}),this.openedChange=new me,this._openedStream=this.openedChange.pipe(rr($=>$),Ti(()=>{})),this._closedStream=this.openedChange.pipe(rr($=>!$),Ti(()=>{})),this.selectionChange=new me,this.valueChange=new me,this._trackedModal=null,this.ngControl&&(this.ngControl.valueAccessor=this),null!=V?.typeaheadDebounceInterval&&(this._typeaheadDebounceInterval=V.typeaheadDebounceInterval),this._scrollStrategyFactory=L,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(I)||0,this.id=this.id}ngOnInit(){this._selectionModel=new k2(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(wa(),Si(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen))}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe(Si(this._destroy)).subscribe(t=>{t.added.forEach(r=>r.select()),t.removed.forEach(r=>r.deselect())}),this.options.changes.pipe(Ws(null),Si(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const t=this._getTriggerAriaLabelledby(),r=this.ngControl;if(t!==this._triggerAriaLabelledBy){const a=this._elementRef.nativeElement;this._triggerAriaLabelledBy=t,t?a.setAttribute("aria-labelledby",t):a.removeAttribute("aria-labelledby")}r&&(this._previousControl!==r.control&&(void 0!==this._previousControl&&null!==r.disabled&&r.disabled!==this.disabled&&(this.disabled=r.disabled),this._previousControl=r.control),this.updateErrorState())}ngOnChanges(t){(t.disabled||t.userAriaDescribedBy)&&this.stateChanges.next(),t.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._applyModalPanelOwnership(),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())}_applyModalPanelOwnership(){const t=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!t)return;const r=`${this.id}-panel`;this._trackedModal&&Vv(this._trackedModal,"aria-owns",r),o2(t,"aria-owns",r),this._trackedModal=t}_clearFromModal(){this._trackedModal&&(Vv(this._trackedModal,"aria-owns",`${this.id}-panel`),this._trackedModal=null)}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(t){this._assignValue(t)}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const t=this._selectionModel.selected.map(r=>r.viewValue);return this._isRtl()&&t.reverse(),t.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(t){this.disabled||(this.panelOpen?this._handleOpenKeydown(t):this._handleClosedKeydown(t))}_handleClosedKeydown(t){const r=t.keyCode,a=40===r||38===r||37===r||39===r,c=13===r||32===r,h=this._keyManager;if(!h.isTyping()&&c&&!Do(t)||(this.multiple||t.altKey)&&a)t.preventDefault(),this.open();else if(!this.multiple){const f=this.selected;h.onKeydown(t);const b=this.selected;b&&f!==b&&this._liveAnnouncer.announce(b.viewValue,1e4)}}_handleOpenKeydown(t){const r=this._keyManager,a=t.keyCode,c=40===a||38===a,h=r.isTyping();if(c&&t.altKey)t.preventDefault(),this.close();else if(h||13!==a&&32!==a||!r.activeItem||Do(t))if(!h&&this._multiple&&65===a&&t.ctrlKey){t.preventDefault();const f=this.options.some(b=>!b.disabled&&!b.selected);this.options.forEach(b=>{b.disabled||(f?b.select():b.deselect())})}else{const f=r.activeItemIndex;r.onKeydown(t),this._multiple&&c&&t.shiftKey&&r.activeItem&&r.activeItemIndex!==f&&r.activeItem._selectViaInteraction()}else t.preventDefault(),r.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(nr(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(t){if(this.options.forEach(r=>r.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&t)Array.isArray(t),t.forEach(r=>this._selectOptionByValue(r)),this._sortValues();else{const r=this._selectOptionByValue(t);r?this._keyManager.updateActiveItem(r):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(t){const r=this.options.find(a=>{if(this._selectionModel.isSelected(a))return!1;try{return null!=a.value&&this._compareWith(a.value,t)}catch{return!1}});return r&&this._selectionModel.select(r),r}_assignValue(t){return!!(t!==this._value||this._multiple&&Array.isArray(t))&&(this.options&&this._setSelectionByValue(t),this._value=t,!0)}_skipPredicate(t){return t.disabled}_initKeyManager(){this._keyManager=new ynt(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const t=wr(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(Si(t)).subscribe(r=>{this._onSelect(r.source,r.isUserInput),r.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),wr(...this.options.map(r=>r._stateChanges)).pipe(Si(t)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(t,r){const a=this._selectionModel.isSelected(t);null!=t.value||this._multiple?(a!==t.selected&&(t.selected?this._selectionModel.select(t):this._selectionModel.deselect(t)),r&&this._keyManager.setActiveItem(t),this.multiple&&(this._sortValues(),r&&this.focus())):(t.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(t.value)),a!==this._selectionModel.isSelected(t)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const t=this.options.toArray();this._selectionModel.sort((r,a)=>this.sortComparator?this.sortComparator(r,a,t):t.indexOf(r)-t.indexOf(a)),this.stateChanges.next()}}_propagateChanges(t){let r=null;r=this.multiple?this.selected.map(a=>a.value):this.selected?this.selected.value:t,this._value=r,this.valueChange.emit(r),this._onChange(r),this.selectionChange.emit(this._getChangeEvent(r)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let t=-1;for(let r=0;r<this.options.length;r++)if(!this.options.get(r).disabled){t=r;break}this._keyManager.setActiveItem(t)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(t){this._elementRef.nativeElement.focus(t)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const t=this._parentFormField?.getLabelId();return this.ariaLabelledby?(t?t+" ":"")+this.ariaLabelledby:t}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;const t=this._parentFormField?.getLabelId();let r=(t?t+" ":"")+this._valueId;return this.ariaLabelledby&&(r+=" "+this.ariaLabelledby),r}_panelDoneAnimating(t){this.openedChange.emit(t)}setDescribedByIds(t){t.length?this._elementRef.nativeElement.setAttribute("aria-describedby",t.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty||this._focused&&!!this._placeholder}static#t=this.\u0275fac=function(r){return new(r||e)(z(Lv),z(Et),z(Re),z(u2),z(Me),z(es,8),z(Pv,8),z(__,8),z(Zv,8),z(Zc,10),Ue("tabindex"),z(n$),z(znt),z(Rst,8))};static#e=this.\u0275dir=Mt({type:e,viewQuery:function(r,a){if(1&r&&(Hi(xst,5),Hi(wst,5),Hi(SH,5)),2&r){let c;pe(c=fe())&&(a.trigger=c.first),pe(c=fe())&&(a.panel=c.first),pe(c=fe())&&(a._overlayDir=c.first)}},inputs:{userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",placeholder:"placeholder",required:"required",multiple:"multiple",disableOptionCentering:"disableOptionCentering",compareWith:"compareWith",value:"value",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:"typeaheadDebounceInterval",sortComparator:"sortComparator",id:"id"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},features:[Xt,Bn]})}return e})(),r$=(()=>{class e extends Bst{constructor(){super(...arguments),this.panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto",this._positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}],this._hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1,this._skipPredicate=t=>!this.panelOpen&&t.disabled}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}ngOnInit(){super.ngOnInit(),this._viewportRuler.change().pipe(Si(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}open(){this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),super.open(),this.stateChanges.next()}close(){super.close(),this.stateChanges.next()}_scrollOptionIntoView(t){const r=this.options.toArray()[t];if(r){const a=this.panel.nativeElement,c=function c8(e,n,t){if(t.length){let r=n.toArray(),a=t.toArray(),c=0;for(let h=0;h<e+1;h++)r[h].group&&r[h].group===a[c]&&c++;return c}return 0}(t,this.options,this.optionGroups),h=r._getHostElement();a.scrollTop=0===t&&1===c?0:function d8(e,n,t,r){return e<t?e:e+n>t+r?Math.max(0,e-r+n):t}(h.offsetTop,h.offsetHeight,a.scrollTop,a.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(t){return new Fst(this,t)}_getOverlayWidth(t){return"auto"===this.panelWidth?(t instanceof WN?t.elementRef:t||this._elementRef).nativeElement.getBoundingClientRect().width:null===this.panelWidth?"":this.panelWidth}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(t){this._hideSingleSelectionIndicator=De(t),this._syncParentProperties()}_syncParentProperties(){if(this.options)for(const t of this.options)t._changeDetectorRef.markForCheck()}static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-select"]],contentQueries:function(r,a,c){if(1&r&&(Fi(c,Ost,5),Fi(c,iz,5),Fi(c,a8,5)),2&r){let h;pe(h=fe())&&(a.customTrigger=h.first),pe(h=fe())&&(a.options=h),pe(h=fe())&&(a.optionGroups=h)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","listbox","ngSkipHydration","",1,"mat-mdc-select"],hostVars:19,hostBindings:function(r,a){1&r&&Se("keydown",function(h){return a._handleKeydown(h)})("focus",function(){return a._onFocus()})("blur",function(){return a._onBlur()}),2&r&&(Ve("id",a.id)("tabindex",a.tabIndex)("aria-controls",a.panelOpen?a.id+"-panel":null)("aria-expanded",a.panelOpen)("aria-label",a.ariaLabel||null)("aria-required",a.required.toString())("aria-disabled",a.disabled.toString())("aria-invalid",a.errorState)("aria-activedescendant",a._getAriaActiveDescendant()),Qe("mat-mdc-select-disabled",a.disabled)("mat-mdc-select-invalid",a.errorState)("mat-mdc-select-required",a.required)("mat-mdc-select-empty",a.empty)("mat-mdc-select-multiple",a.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",panelWidth:"panelWidth",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matSelect"],features:[Te([{provide:y2,useExisting:e},{provide:s8,useExisting:e}]),Xt],ngContentSelectors:Est,decls:11,vars:10,consts:[["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],[1,"mat-mdc-select-value",3,"ngSwitch"],["class","mat-mdc-select-placeholder mat-mdc-select-min-line",4,"ngSwitchCase"],["class","mat-mdc-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth","backdropClick","attach","detach"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text",3,"ngSwitch"],["class","mat-mdc-select-min-line",4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(r,a){if(1&r&&(xn(Tst),ht(0,"div",0,1),Se("click",function(){return a.toggle()}),ht(3,"div",2),Kt(4,Cst,2,1,"span",3),Kt(5,kst,3,2,"span",4),ft(),ht(6,"div",5)(7,"div",6),Ps(),ht(8,"svg",7),je(9,"path",8),ft()()()(),Kt(10,Sst,3,9,"ng-template",9),Se("backdropClick",function(){return a.close()})("attach",function(){return a._onAttached()})("detach",function(){return a.close()})),2&r){const c=Kr(1);St(3),It("ngSwitch",a.empty),Ve("id",a._valueId),St(1),It("ngSwitchCase",!0),St(1),It("ngSwitchCase",!1),St(5),It("cdkConnectedOverlayPanelClass",a._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",a._scrollStrategy)("cdkConnectedOverlayOrigin",a._preferredOverlayOrigin||c)("cdkConnectedOverlayOpen",a.panelOpen)("cdkConnectedOverlayPositions",a._positions)("cdkConnectedOverlayWidth",a._overlayWidth)}},dependencies:[yC,Qg,xC,zV,SH,WN],styles:['.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color);font-family:var(--mat-select-trigger-text-font);line-height:var(--mat-select-trigger-text-line-height);font-size:var(--mat-select-trigger-text-size);font-weight:var(--mat-select-trigger-text-weight);letter-spacing:var(--mat-select-trigger-text-tracking)}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color)}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:translateY(-8px)}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color)}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color)}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow{color:var(--mat-select-invalid-arrow-color)}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color)}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:GrayText}div.mat-mdc-select-panel{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color)}.cdk-high-contrast-active div.mat-mdc-select-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color)}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper{cursor:pointer}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}'],encapsulation:2,data:{animation:[Ast.transformPanel]},changeDetection:0})}return e})(),o$=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[Pst],imports:[ws,jp,h2,yi,Sh,x2,h2,yi]})}return e})();function Nst(e,n){if(1&e&&(ht(0,"mat-option",19),be(1),ft()),2&e){const t=n.$implicit;It("value",t),St(1),Ln(" ",t," ")}}function zst(e,n){if(1&e&&(ht(0,"mat-option",19),be(1),ft()),2&e){const t=n.$implicit;It("value",t),St(1),Ln(" ",t," ")}}let xz=(()=>{class e{constructor(t,r,a,c){this._fb=t,this._deviceSevice=r,this._dialogRef=a,this.data=c,this.actionBtn="save",this.education=["Camera Ezviz C6N","Router Wifi Tenda","Dir conditioning"],this.area=["T\xe2y h\u1ed3","C\u1ea7u Gi\u1ea5y","Thanh Xu\xe2n"],this.defaultCoordinates={"T\xe2y h\u1ed3":{latitude:21.064519,longitude:105.809917},"C\u1ea7u Gi\u1ea5y":{latitude:21.036044,longitude:105.790054},"Thanh Xu\xe2n":{latitude:21.00617,longitude:105.805721}}}ngOnInit(){this.deviceForm=this._fb.group({deviceName:["",vl.required],weight:["",vl.required],size:["",vl.required],price:["",vl.required],location:["",vl.required],latitude:["",vl.required],longitude:["",vl.required],date:["",vl.required],note:["",vl.required]}),this.data&&(this.actionBtn="update",this.deviceForm.patchValue(this.data))}onLocationChange(t){const r=this.defaultCoordinates[t];r&&this.deviceForm.patchValue({latitude:r.latitude,longitude:r.longitude})}addProduct(){this.data?this.updateProduct():this.deviceForm.valid&&this._deviceSevice.addDevice(this.deviceForm.value).subscribe({next:t=>{alert("them thanh cong"),this.deviceForm.reset(),this._dialogRef.close("save")},error:()=>{alert("Them that bai")}})}updateProduct(){this._deviceSevice.putDevice(this.data.id,this.deviceForm.value).subscribe({next:t=>{alert("updata thanh cong"),this.deviceForm.reset(),this._dialogRef.close("update")},error:()=>{alert("updata that bai")}})}static#t=this.\u0275fac=function(r){return new(r||e)(z(lit),z(cM),z(f2),z(C8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["app-device-add-edit"]],decls:48,vars:7,consts:[["mat-dialog-title",""],[3,"formGroup"],["mat-dialog-content","",1,"content"],[1,"row"],["appearance","outline"],["formControlName","deviceName"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","placeholder","Ki-lo-gam","formControlName","weight"],["matInput","","type","number","placeholder","centimet","formControlName","size"],["matInput","","type","number","placeholder","VND","formControlName","price"],["formControlName","location",3,"selectionChange"],["matInput","","formControlName","date",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],["appearance","outline",1,"note"],["matInput","","formControlName","note"],["mat-dialog-actions","","align","end",1,"action"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","type","button",3,"mat-dialog-close"],[3,"value"]],template:function(r,a){if(1&r&&(ht(0,"div",0)(1,"h1"),be(2,"Device Form"),ft()(),ht(3,"form",1)(4,"div",2)(5,"div",3)(6,"mat-form-field",4)(7,"mat-label"),be(8,"Device Name"),ft(),ht(9,"mat-select",5),Kt(10,Nst,2,2,"mat-option",6),ft()(),ht(11,"mat-form-field",4)(12,"mat-label"),be(13,"weight"),ft(),je(14,"input",7),ft()(),ht(15,"div",3)(16,"mat-form-field",4)(17,"mat-label"),be(18,"Size"),ft(),je(19,"input",8),ft(),ht(20,"mat-form-field",4)(21,"mat-label"),be(22,"price"),ft(),je(23,"input",9),ft()(),ht(24,"div",3)(25,"mat-form-field",4)(26,"mat-label"),be(27,"Location"),ft(),ht(28,"mat-select",10),Se("selectionChange",function(h){return a.onLocationChange(h.value)}),Kt(29,zst,2,2,"mat-option",6),ft()(),ht(30,"mat-form-field",4)(31,"mat-label"),be(32,"Choose a date"),ft(),je(33,"input",11),ht(34,"mat-hint"),be(35,"MM/DD/YYYY"),ft(),je(36,"mat-datepicker-toggle",12)(37,"mat-datepicker",null,13),ft()(),ht(39,"mat-form-field",14)(40,"mat-label"),be(41,"Note"),ft(),je(42,"textarea",15),ft()(),ht(43,"div",16)(44,"button",17),Se("click",function(){return a.addProduct()}),be(45),ft(),ht(46,"button",18),be(47,"Cancel"),ft()()()),2&r){const c=Kr(38);St(3),It("formGroup",a.deviceForm),St(7),It("ngForOf",a.education),St(19),It("ngForOf",a.area),St(4),It("matDatepicker",c),St(3),It("for",c),St(9),_s(a.actionBtn),St(1),It("mat-dialog-close",!1)}},dependencies:[vC,LM,iz,cst,yz,fst,Trt,Ert,Art,Irt,v2,NM,lz,vot,cz,r$,$6,dM,MN,pN,I6,__,TN],styles:[".content[_ngcontent-%COMP%]{padding-top:10px}.row[_ngcontent-%COMP%]{display:flex;gap:10px}mat-form-field[_ngcontent-%COMP%]{width:100%}.action[_ngcontent-%COMP%]{padding:0 25px 20px}button[_ngcontent-%COMP%]{flex:1}.note[_ngcontent-%COMP%]{width:100%}"]})}return e})();const Vst=["tooltip"],s$=new kt("mat-tooltip-scroll-strategy"),Hst={provide:s$,deps:[_a],useFactory:function Ust(e){return()=>e.scrollStrategies.reposition({scrollThrottle:20})}},Gst=new kt("mat-tooltip-default-options",{providedIn:"root",factory:function $st(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),a$="tooltip-panel",l$=Xc({passive:!0});let Kst=(()=>{class e{get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(t){this._positionAtOrigin=De(t),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(t){this._disabled=De(t),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=ts(t)}get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=ts(t),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(t){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=t?String(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(t,r,a,c,h,f,b,x,M,T,I,L){this._overlay=t,this._elementRef=r,this._scrollDispatcher=a,this._viewContainerRef=c,this._ngZone=h,this._platform=f,this._ariaDescriber=b,this._focusMonitor=x,this._dir=T,this._defaultOptions=I,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._viewportMargin=8,this._cssClassPrefix="mat",this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new we,this._scrollStrategy=M,this._document=L,I&&(this._showDelay=I.showDelay,this._hideDelay=I.hideDelay,I.position&&(this.position=I.position),I.positionAtOrigin&&(this.positionAtOrigin=I.positionAtOrigin),I.touchGestures&&(this.touchGestures=I.touchGestures)),T.change.pipe(Si(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Si(this._destroyed)).subscribe(t=>{t?"keyboard"===t&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const t=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([r,a])=>{t.removeEventListener(r,a,l$)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(t,this.message,"tooltip"),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay,r){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const a=this._createOverlay(r);this._detach(),this._portal=this._portal||new Bv(this._tooltipComponent,this._viewContainerRef);const c=this._tooltipInstance=a.attach(this._portal).instance;c._triggerElement=this._elementRef.nativeElement,c._mouseLeaveHideDelay=this._hideDelay,c.afterHidden().pipe(Si(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),c.show(t)}hide(t=this.hideDelay){const r=this._tooltipInstance;r&&(r.isVisible()?r.hide(t):(r._cancelPendingAnimations(),this._detach()))}toggle(t){this._isTooltipVisible()?this.hide():this.show(void 0,t)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(t){if(this._overlayRef){const c=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!t)&&c._origin instanceof Me)return this._overlayRef;this._detach()}const r=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),a=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin&&t||this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(r);return a.positionChanges.pipe(Si(this._destroyed)).subscribe(c=>{this._updateCurrentPositionClass(c.connectionPair),this._tooltipInstance&&c.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:a,panelClass:`${this._cssClassPrefix}-${a$}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Si(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Si(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(Si(this._destroyed)).subscribe(c=>{this._isTooltipVisible()&&27===c.keyCode&&!Do(c)&&(c.preventDefault(),c.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(t){const r=t.getConfig().positionStrategy,a=this._getOrigin(),c=this._getOverlayPosition();r.withPositions([this._addOffset({...a.main,...c.main}),this._addOffset({...a.fallback,...c.fallback})])}_addOffset(t){return t}_getOrigin(){const t=!this._dir||"ltr"==this._dir.value,r=this.position;let a;"above"==r||"below"==r?a={originX:"center",originY:"above"==r?"top":"bottom"}:"before"==r||"left"==r&&t||"right"==r&&!t?a={originX:"start",originY:"center"}:("after"==r||"right"==r&&t||"left"==r&&!t)&&(a={originX:"end",originY:"center"});const{x:c,y:h}=this._invertPosition(a.originX,a.originY);return{main:a,fallback:{originX:c,originY:h}}}_getOverlayPosition(){const t=!this._dir||"ltr"==this._dir.value,r=this.position;let a;"above"==r?a={overlayX:"center",overlayY:"bottom"}:"below"==r?a={overlayX:"center",overlayY:"top"}:"before"==r||"left"==r&&t||"right"==r&&!t?a={overlayX:"end",overlayY:"center"}:("after"==r||"right"==r&&t||"left"==r&&!t)&&(a={overlayX:"start",overlayY:"center"});const{x:c,y:h}=this._invertPosition(a.overlayX,a.overlayY);return{main:a,fallback:{overlayX:c,overlayY:h}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(nr(1),Si(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,r){return"above"===this.position||"below"===this.position?"top"===r?r="bottom":"bottom"===r&&(r="top"):"end"===t?t="start":"start"===t&&(t="end"),{x:t,y:r}}_updateCurrentPositionClass(t){const{overlayY:r,originX:a,originY:c}=t;let h;if(h="center"===r?this._dir&&"rtl"===this._dir.value?"end"===a?"left":"right":"start"===a?"left":"right":"bottom"===r&&"top"===c?"above":"below",h!==this._currentPosition){const f=this._overlayRef;if(f){const b=`${this._cssClassPrefix}-${a$}-`;f.removePanelClass(b+this._currentPosition),f.addPanelClass(b+h)}this._currentPosition=h}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",t=>{let r;this._setupPointerExitEventsIfNeeded(),void 0!==t.x&&void 0!==t.y&&(r=t),this.show(void 0,r)}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",t=>{const r=t.targetTouches?.[0],a=r?{x:r.clientX,y:r.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(void 0,a),500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const t=[];if(this._platformSupportsMouseEvents())t.push(["mouseleave",r=>{const a=r.relatedTarget;(!a||!this._overlayRef?.overlayElement.contains(a))&&this.hide()}],["wheel",r=>this._wheelListener(r)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const r=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};t.push(["touchend",r],["touchcancel",r])}this._addListeners(t),this._passiveListeners.push(...t)}_addListeners(t){t.forEach(([r,a])=>{this._elementRef.nativeElement.addEventListener(r,a,l$)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(t){if(this._isTooltipVisible()){const r=this._document.elementFromPoint(t.clientX,t.clientY),a=this._elementRef.nativeElement;r!==a&&!a.contains(r)&&this.hide()}}_disableNativeGesturesIfNecessary(){const t=this.touchGestures;if("off"!==t){const r=this._elementRef.nativeElement,a=r.style;("on"===t||"INPUT"!==r.nodeName&&"TEXTAREA"!==r.nodeName)&&(a.userSelect=a.msUserSelect=a.webkitUserSelect=a.MozUserSelect="none"),("on"===t||!r.draggable)&&(a.webkitUserDrag="none"),a.touchAction="none",a.webkitTapHighlightColor="transparent"}}static#t=this.\u0275fac=function(r){dl()};static#e=this.\u0275dir=Mt({type:e,inputs:{position:["matTooltipPosition","position"],positionAtOrigin:["matTooltipPositionAtOrigin","positionAtOrigin"],disabled:["matTooltipDisabled","disabled"],showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]}})}return e})(),Qst=(()=>{class e extends Kst{constructor(t,r,a,c,h,f,b,x,M,T,I,L){super(t,r,a,c,h,f,b,x,M,T,I,L),this._tooltipComponent=tat,this._cssClassPrefix="mat-mdc",this._viewportMargin=8}_addOffset(t){const a=!this._dir||"ltr"==this._dir.value;return"top"===t.originY?t.offsetY=-8:"bottom"===t.originY?t.offsetY=8:"start"===t.originX?t.offsetX=a?-8:8:"end"===t.originX&&(t.offsetX=a?8:-8),t}static#t=this.\u0275fac=function(r){return new(r||e)(z(_a),z(Me),z(CM),z(hr),z(Re),z(vr),z(OH),z(dc),z(s$),z(es,8),z(Gst,8),z(ki))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(r,a){2&r&&Qe("mat-mdc-tooltip-disabled",a.disabled)},exportAs:["matTooltip"],features:[Xt]})}return e})(),Jst=(()=>{class e{constructor(t,r){this._changeDetectorRef=t,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new we,this._animationsDisabled="NoopAnimations"===r}show(t){null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},t)}hide(t){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},t)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:t}){(!t||!this._triggerElement.contains(t))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){}_handleAnimationEnd({animationName:t}){(t===this._showAnimation||t===this._hideAnimation)&&this._finalizeAnimation(t===this._showAnimation)}_cancelPendingAnimations(){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(t){t?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(t){const r=this._tooltip.nativeElement,a=this._showAnimation,c=this._hideAnimation;if(r.classList.remove(t?c:a),r.classList.add(t?a:c),this._isVisible=t,t&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const h=getComputedStyle(r);("0s"===h.getPropertyValue("animation-duration")||"none"===h.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}t&&this._onShow(),this._animationsDisabled&&(r.classList.add("_mat-animation-noopable"),this._finalizeAnimation(t))}static#t=this.\u0275fac=function(r){return new(r||e)(z(Et),z(Pr,8))};static#e=this.\u0275dir=Mt({type:e})}return e})(),tat=(()=>{class e extends Jst{constructor(t,r,a){super(t,a),this._elementRef=r,this._isMultiline=!1,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide"}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){const t=this._elementRef.nativeElement.getBoundingClientRect();return t.height>24&&t.width>=200}static#t=this.\u0275fac=function(r){return new(r||e)(z(Et),z(Me),z(Pr,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-tooltip-component"]],viewQuery:function(r,a){if(1&r&&Hi(Vst,7),2&r){let c;pe(c=fe())&&(a._tooltip=c.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(r,a){1&r&&Se("mouseleave",function(h){return a._handleMouseLeave(h)}),2&r&&pa("zoom",a.isVisible()?1:null)},features:[Xt],decls:4,vars:4,consts:[[1,"mdc-tooltip","mdc-tooltip--shown","mat-mdc-tooltip",3,"ngClass","animationend"],["tooltip",""],[1,"mdc-tooltip__surface","mdc-tooltip__surface-animation"]],template:function(r,a){1&r&&(ht(0,"div",0,1),Se("animationend",function(h){return a._handleAnimationEnd(h)}),ht(2,"div",2),be(3),ft()()),2&r&&(Qe("mdc-tooltip--multiline",a._isMultiline),It("ngClass",a.tooltipClass),St(3),_s(a.message))},dependencies:[yC],styles:['.mdc-tooltip__surface{word-break:break-all;word-break:var(--mdc-tooltip-word-break, normal);overflow-wrap:anywhere}.mdc-tooltip--showing-transition .mdc-tooltip__surface-animation{transition:opacity 150ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-tooltip--hide-transition .mdc-tooltip__surface-animation{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-tooltip{position:fixed;display:none;z-index:9}.mdc-tooltip-wrapper--rich{position:relative}.mdc-tooltip--shown,.mdc-tooltip--showing,.mdc-tooltip--hide{display:inline-flex}.mdc-tooltip--shown.mdc-tooltip--rich,.mdc-tooltip--showing.mdc-tooltip--rich,.mdc-tooltip--hide.mdc-tooltip--rich{display:inline-block;left:-320px;position:absolute}.mdc-tooltip__surface{line-height:16px;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center}.mdc-tooltip__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-tooltip__surface::before{border-color:CanvasText}}.mdc-tooltip--rich .mdc-tooltip__surface{align-items:flex-start;display:flex;flex-direction:column;min-height:24px;min-width:40px;max-width:320px;position:relative}.mdc-tooltip--multiline .mdc-tooltip__surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mdc-tooltip__surface,.mdc-tooltip--multiline .mdc-tooltip__surface[dir=rtl]{text-align:right}.mdc-tooltip__surface .mdc-tooltip__title{margin:0 8px}.mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(200px - (2 * 8px));margin:8px;text-align:left}[dir=rtl] .mdc-tooltip__surface .mdc-tooltip__content,.mdc-tooltip__surface .mdc-tooltip__content[dir=rtl]{text-align:right}.mdc-tooltip--rich .mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(320px - (2 * 8px));align-self:stretch}.mdc-tooltip__surface .mdc-tooltip__content-link{text-decoration:none}.mdc-tooltip--rich-actions,.mdc-tooltip__content,.mdc-tooltip__title{z-index:1}.mdc-tooltip__surface-animation{opacity:0;transform:scale(0.8);will-change:transform,opacity}.mdc-tooltip--shown .mdc-tooltip__surface-animation{transform:scale(1);opacity:1}.mdc-tooltip--hide .mdc-tooltip__surface-animation{transform:scale(1)}.mdc-tooltip__caret-surface-top,.mdc-tooltip__caret-surface-bottom{position:absolute;height:24px;width:24px;transform:rotate(35deg) skewY(20deg) scaleX(0.9396926208)}.mdc-tooltip__caret-surface-top .mdc-elevation-overlay,.mdc-tooltip__caret-surface-bottom .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-tooltip__caret-surface-bottom{box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12);outline:1px solid rgba(0,0,0,0);z-index:-1}@media screen and (forced-colors: active){.mdc-tooltip__caret-surface-bottom{outline-color:CanvasText}}.mat-mdc-tooltip{--mdc-plain-tooltip-container-shape:4px;--mdc-plain-tooltip-supporting-text-line-height:16px}.mat-mdc-tooltip .mdc-tooltip__surface{background-color:var(--mdc-plain-tooltip-container-color)}.mat-mdc-tooltip .mdc-tooltip__surface{border-radius:var(--mdc-plain-tooltip-container-shape)}.mat-mdc-tooltip .mdc-tooltip__caret-surface-top,.mat-mdc-tooltip .mdc-tooltip__caret-surface-bottom{border-radius:var(--mdc-plain-tooltip-container-shape)}.mat-mdc-tooltip .mdc-tooltip__surface{color:var(--mdc-plain-tooltip-supporting-text-color)}.mat-mdc-tooltip .mdc-tooltip__surface{font-family:var(--mdc-plain-tooltip-supporting-text-font);line-height:var(--mdc-plain-tooltip-supporting-text-line-height);font-size:var(--mdc-plain-tooltip-supporting-text-size);font-weight:var(--mdc-plain-tooltip-supporting-text-weight);letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking)}.mat-mdc-tooltip{position:relative;transform:scale(0)}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0})}return e})(),c$=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[Hst],imports:[c2,ws,jp,yi,yi,Sh]})}return e})();function eat(e,n){if(1&e&&(ht(0,"mat-option",19),be(1),ft()),2&e){const t=n.$implicit;It("value",t),St(1),Ln(" ",t," ")}}function iat(e,n){if(1&e){const t=vo();ht(0,"mat-form-field",16)(1,"mat-select",17),Se("selectionChange",function(a){return $n(t),Nn(Ne(2)._changePageSize(a.value))}),Kt(2,eat,2,2,"mat-option",18),ft()()}if(2&e){const t=Ne(2);It("appearance",t._formFieldAppearance)("color",t.color),St(1),It("value",t.pageSize)("disabled",t.disabled)("aria-labelledby",t._pageSizeLabelId)("panelClass",t.selectConfig.panelClass||"")("disableOptionCentering",t.selectConfig.disableOptionCentering),St(1),It("ngForOf",t._displayedPageSizeOptions)}}function nat(e,n){if(1&e&&(ht(0,"div",20),be(1),ft()),2&e){const t=Ne(2);St(1),_s(t.pageSize)}}function rat(e,n){if(1&e&&(ht(0,"div",12)(1,"div",13),be(2),ft(),Kt(3,iat,3,8,"mat-form-field",14),Kt(4,nat,2,1,"div",15),ft()),2&e){const t=Ne();St(1),Sy("id",t._pageSizeLabelId),St(1),Ln(" ",t._intl.itemsPerPageLabel," "),St(1),It("ngIf",t._displayedPageSizeOptions.length>1),St(1),It("ngIf",t._displayedPageSizeOptions.length<=1)}}function oat(e,n){if(1&e){const t=vo();ht(0,"button",21),Se("click",function(){return $n(t),Nn(Ne().firstPage())}),Ps(),ht(1,"svg",7),je(2,"path",22),ft()()}if(2&e){const t=Ne();It("matTooltip",t._intl.firstPageLabel)("matTooltipDisabled",t._previousButtonsDisabled())("matTooltipPosition","above")("disabled",t._previousButtonsDisabled()),Ve("aria-label",t._intl.firstPageLabel)}}function sat(e,n){if(1&e){const t=vo();Ps(),Vl(),ht(0,"button",23),Se("click",function(){return $n(t),Nn(Ne().lastPage())}),Ps(),ht(1,"svg",7),je(2,"path",24),ft()()}if(2&e){const t=Ne();It("matTooltip",t._intl.lastPageLabel)("matTooltipDisabled",t._nextButtonsDisabled())("matTooltipPosition","above")("disabled",t._nextButtonsDisabled()),Ve("aria-label",t._intl.lastPageLabel)}}let S2=(()=>{class e{constructor(){this.changes=new we,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(t,r,a)=>{if(0==a||0==r)return`0 of ${a}`;const c=t*r;return`${c+1} \u2013 ${c<(a=Math.max(a,0))?Math.min(c+r,a):c+r} of ${a}`}}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const lat={provide:S2,deps:[[new aa,new rl,S2]],useFactory:function aat(e){return e||new S2}},dat=new kt("MAT_PAGINATOR_DEFAULT_OPTIONS"),uat=Up(QH(class{}));let hat=(()=>{class e extends uat{get pageIndex(){return this._pageIndex}set pageIndex(t){this._pageIndex=Math.max(ts(t),0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(t){this._length=ts(t),this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(t){this._pageSize=Math.max(ts(t),0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(t){this._pageSizeOptions=(t||[]).map(r=>ts(r)),this._updateDisplayedPageSizeOptions()}get hidePageSize(){return this._hidePageSize}set hidePageSize(t){this._hidePageSize=De(t)}get showFirstLastButtons(){return this._showFirstLastButtons}set showFirstLastButtons(t){this._showFirstLastButtons=De(t)}constructor(t,r,a){if(super(),this._intl=t,this._changeDetectorRef=r,this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this._hidePageSize=!1,this._showFirstLastButtons=!1,this.selectConfig={},this.page=new me,this._intlChanges=t.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),a){const{pageSize:c,pageSizeOptions:h,hidePageSize:f,showFirstLastButtons:b}=a;null!=c&&(this._pageSize=c),null!=h&&(this._pageSizeOptions=h),null!=f&&(this._hidePageSize=f),null!=b&&(this._showFirstLastButtons=b)}}ngOnInit(){this._initialized=!0,this._updateDisplayedPageSizeOptions(),this._markInitialized()}ngOnDestroy(){this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex=this.pageIndex+1,this._emitPageEvent(t)}previousPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex=this.pageIndex-1,this._emitPageEvent(t)}firstPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex=0,this._emitPageEvent(t)}lastPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(t)}hasPreviousPage(){return this.pageIndex>=1&&0!=this.pageSize}hasNextPage(){const t=this.getNumberOfPages()-1;return this.pageIndex<t&&0!=this.pageSize}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(t){const a=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/t)||0,this.pageSize=t,this._emitPageEvent(a)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._initialized&&(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((t,r)=>t-r),this._changeDetectorRef.markForCheck())}_emitPageEvent(t){this.page.emit({previousPageIndex:t,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}static#t=this.\u0275fac=function(r){dl()};static#e=this.\u0275dir=Mt({type:e,inputs:{color:"color",pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",hidePageSize:"hidePageSize",showFirstLastButtons:"showFirstLastButtons",selectConfig:"selectConfig"},outputs:{page:"page"},features:[Xt]})}return e})(),mat=0,d$=(()=>{class e extends hat{constructor(t,r,a){super(t,r,a),this._pageSizeLabelId="mat-paginator-page-size-label-"+mat++,this._formFieldAppearance=a?.formFieldAppearance||"outline"}static#t=this.\u0275fac=function(r){return new(r||e)(z(S2),z(Et),z(dat,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-paginator"]],hostAttrs:["role","group",1,"mat-mdc-paginator"],inputs:{disabled:"disabled"},exportAs:["matPaginator"],features:[Xt],decls:14,vars:14,consts:[[1,"mat-mdc-paginator-outer-container"],[1,"mat-mdc-paginator-container"],["class","mat-mdc-paginator-page-size",4,"ngIf"],[1,"mat-mdc-paginator-range-actions"],["aria-live","polite",1,"mat-mdc-paginator-range-label"],["mat-icon-button","","type","button","class","mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-previous",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["viewBox","0 0 24 24","focusable","false","aria-hidden","true",1,"mat-mdc-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-next",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","class","mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],[1,"mat-mdc-paginator-page-size"],[1,"mat-mdc-paginator-page-size-label",3,"id"],["class","mat-mdc-paginator-page-size-select",3,"appearance","color",4,"ngIf"],["class","mat-mdc-paginator-page-size-value",4,"ngIf"],[1,"mat-mdc-paginator-page-size-select",3,"appearance","color"],["hideSingleSelectionIndicator","",3,"value","disabled","aria-labelledby","panelClass","disableOptionCentering","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-mdc-paginator-page-size-value"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(r,a){1&r&&(ht(0,"div",0)(1,"div",1),Kt(2,rat,5,4,"div",2),ht(3,"div",3)(4,"div",4),be(5),ft(),Kt(6,oat,3,5,"button",5),ht(7,"button",6),Se("click",function(){return a.previousPage()}),Ps(),ht(8,"svg",7),je(9,"path",8),ft()(),Vl(),ht(10,"button",9),Se("click",function(){return a.nextPage()}),Ps(),ht(11,"svg",7),je(12,"path",10),ft()(),Kt(13,sat,3,5,"button",11),ft()()()),2&r&&(St(2),It("ngIf",!a.hidePageSize),St(3),Ln(" ",a._intl.getRangeLabel(a.pageIndex,a.pageSize,a.length)," "),St(1),It("ngIf",a.showFirstLastButtons),St(1),It("matTooltip",a._intl.previousPageLabel)("matTooltipDisabled",a._previousButtonsDisabled())("matTooltipPosition","above")("disabled",a._previousButtonsDisabled()),Ve("aria-label",a._intl.previousPageLabel),St(3),It("matTooltip",a._intl.nextPageLabel)("matTooltipDisabled",a._nextButtonsDisabled())("matTooltipPosition","above")("disabled",a._nextButtonsDisabled()),Ve("aria-label",a._intl.nextPageLabel),St(3),It("ngIf",a.showFirstLastButtons))},dependencies:[vC,La,BM,v2,r$,iz,Qst],styles:[".mat-mdc-paginator{display:block;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-paginator-container-text-color);background-color:var(--mat-paginator-container-background-color);font-family:var(--mat-paginator-container-text-font);line-height:var(--mat-paginator-container-text-line-height);font-size:var(--mat-paginator-container-text-size);font-weight:var(--mat-paginator-container-text-weight);letter-spacing:var(--mat-paginator-container-text-tracking)}.mat-mdc-paginator .mat-mdc-select-value{font-size:var(--mat-paginator-select-trigger-text-size)}.mat-mdc-paginator .mat-mdc-form-field-subscript-wrapper{display:none}.mat-mdc-paginator .mat-mdc-select{line-height:1.5}.mat-mdc-paginator-outer-container{display:flex}.mat-mdc-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap-reverse;width:100%;min-height:var(--mat-paginator-container-size)}.mat-mdc-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-mdc-paginator-page-size{margin-right:0;margin-left:8px}.mat-mdc-paginator-page-size-label{margin:0 4px}.mat-mdc-paginator-page-size-select{margin:0 4px;width:84px}.mat-mdc-paginator-range-label{margin:0 32px 0 24px}.mat-mdc-paginator-range-actions{display:flex;align-items:center}.mat-mdc-paginator-icon{display:inline-block;width:28px;fill:var(--mat-paginator-enabled-icon-color)}.mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon{fill:var(--mat-paginator-disabled-icon-color)}[dir=rtl] .mat-mdc-paginator-icon{transform:rotate(180deg)}.cdk-high-contrast-active .mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon,.cdk-high-contrast-active .mat-mdc-paginator-icon{fill:currentColor;fill:CanvasText}.cdk-high-contrast-active .mat-mdc-paginator-range-actions .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}return e})(),pat=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[lat],imports:[ws,_2,o$,c$]})}return e})();const fat=["mat-sort-header",""];function gat(e,n){if(1&e){const t=vo();ht(0,"div",3),Se("@arrowPosition.start",function(){return $n(t),Nn(Ne()._disableViewStateAnimation=!0)})("@arrowPosition.done",function(){return $n(t),Nn(Ne()._disableViewStateAnimation=!1)}),je(1,"div",4),ht(2,"div",5),je(3,"div",6)(4,"div",7)(5,"div",8),ft()()}if(2&e){const t=Ne();It("@arrowOpacity",t._getArrowViewState())("@arrowPosition",t._getArrowViewState())("@allowChildren",t._getArrowDirectionState()),St(2),It("@indicator",t._getArrowDirectionState()),St(1),It("@leftPointer",t._getArrowDirectionState()),St(1),It("@rightPointer",t._getArrowDirectionState())}}const _at=["*"],u$=new kt("MAT_SORT_DEFAULT_OPTIONS"),bat=QH(Up(class{}));let wz=(()=>{class e extends bat{get direction(){return this._direction}set direction(t){this._direction=t}get disableClear(){return this._disableClear}set disableClear(t){this._disableClear=De(t)}constructor(t){super(),this._defaultOptions=t,this.sortables=new Map,this._stateChanges=new we,this.start="asc",this._direction="",this.sortChange=new me}register(t){this.sortables.set(t.id,t)}deregister(t){this.sortables.delete(t.id)}sort(t){this.active!=t.id?(this.active=t.id,this.direction=t.start?t.start:this.start):this.direction=this.getNextSortDirection(t),this.sortChange.emit({active:this.active,direction:this.direction})}getNextSortDirection(t){if(!t)return"";let a=function yat(e,n){let t=["asc","desc"];return"desc"==e&&t.reverse(),n||t.push(""),t}(t.start||this.start,t?.disableClear??this.disableClear??!!this._defaultOptions?.disableClear),c=a.indexOf(this.direction)+1;return c>=a.length&&(c=0),a[c]}ngOnInit(){this._markInitialized()}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}static#t=this.\u0275fac=function(r){return new(r||e)(z(u$,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","matSort",""]],hostAttrs:[1,"mat-sort"],inputs:{disabled:["matSortDisabled","disabled"],active:["matSortActive","active"],start:["matSortStart","start"],direction:["matSortDirection","direction"],disableClear:["matSortDisableClear","disableClear"]},outputs:{sortChange:"matSortChange"},exportAs:["matSort"],features:[Xt,Bn]})}return e})();const Gp=JN.ENTERING+" "+QN.STANDARD_CURVE,Kv={indicator:Po("indicator",[Hn("active-asc, asc",oi({transform:"translateY(0px)"})),Hn("active-desc, desc",oi({transform:"translateY(10px)"})),Tn("active-asc <=> active-desc",Fn(Gp))]),leftPointer:Po("leftPointer",[Hn("active-asc, asc",oi({transform:"rotate(-45deg)"})),Hn("active-desc, desc",oi({transform:"rotate(45deg)"})),Tn("active-asc <=> active-desc",Fn(Gp))]),rightPointer:Po("rightPointer",[Hn("active-asc, asc",oi({transform:"rotate(45deg)"})),Hn("active-desc, desc",oi({transform:"rotate(-45deg)"})),Tn("active-asc <=> active-desc",Fn(Gp))]),arrowOpacity:Po("arrowOpacity",[Hn("desc-to-active, asc-to-active, active",oi({opacity:1})),Hn("desc-to-hint, asc-to-hint, hint",oi({opacity:.54})),Hn("hint-to-desc, active-to-desc, desc, hint-to-asc, active-to-asc, asc, void",oi({opacity:0})),Tn("* => asc, * => desc, * => active, * => hint, * => void",Fn("0ms")),Tn("* <=> *",Fn(Gp))]),arrowPosition:Po("arrowPosition",[Tn("* => desc-to-hint, * => desc-to-active",Fn(Gp,Wv([oi({transform:"translateY(-25%)"}),oi({transform:"translateY(0)"})]))),Tn("* => hint-to-desc, * => active-to-desc",Fn(Gp,Wv([oi({transform:"translateY(0)"}),oi({transform:"translateY(25%)"})]))),Tn("* => asc-to-hint, * => asc-to-active",Fn(Gp,Wv([oi({transform:"translateY(25%)"}),oi({transform:"translateY(0)"})]))),Tn("* => hint-to-asc, * => active-to-asc",Fn(Gp,Wv([oi({transform:"translateY(0)"}),oi({transform:"translateY(-25%)"})]))),Hn("desc-to-hint, asc-to-hint, hint, desc-to-active, asc-to-active, active",oi({transform:"translateY(0)"})),Hn("hint-to-desc, active-to-desc, desc",oi({transform:"translateY(-25%)"})),Hn("hint-to-asc, active-to-asc, asc",oi({transform:"translateY(25%)"}))]),allowChildren:Po("allowChildren",[Tn("* <=> *",[Yv("@*",qv(),{optional:!0})])])};let T2=(()=>{class e{constructor(){this.changes=new we}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const xat={provide:T2,deps:[[new aa,new rl,T2]],useFactory:function vat(e){return e||new T2}},wat=Up(class{});let Cat=(()=>{class e extends wat{get sortActionDescription(){return this._sortActionDescription}set sortActionDescription(t){this._updateSortActionDescription(t)}get disableClear(){return this._disableClear}set disableClear(t){this._disableClear=De(t)}constructor(t,r,a,c,h,f,b,x){super(),this._intl=t,this._changeDetectorRef=r,this._sort=a,this._columnDef=c,this._focusMonitor=h,this._elementRef=f,this._ariaDescriber=b,this._showIndicatorHint=!1,this._viewState={},this._arrowDirection="",this._disableViewStateAnimation=!1,this.arrowPosition="after",this._sortActionDescription="Sort",x?.arrowPosition&&(this.arrowPosition=x?.arrowPosition),this._handleStateChanges()}ngOnInit(){!this.id&&this._columnDef&&(this.id=this._columnDef.name),this._updateArrowDirection(),this._setAnimationTransitionState({toState:this._isSorted()?"active":this._arrowDirection}),this._sort.register(this),this._sortButton=this._elementRef.nativeElement.querySelector(".mat-sort-header-container"),this._updateSortActionDescription(this._sortActionDescription)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{const r=!!t;r!==this._showIndicatorHint&&(this._setIndicatorHintVisible(r),this._changeDetectorRef.markForCheck())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._sort.deregister(this),this._rerenderSubscription.unsubscribe()}_setIndicatorHintVisible(t){this._isDisabled()&&t||(this._showIndicatorHint=t,this._isSorted()||(this._updateArrowDirection(),this._setAnimationTransitionState(this._showIndicatorHint?{fromState:this._arrowDirection,toState:"hint"}:{fromState:"hint",toState:this._arrowDirection})))}_setAnimationTransitionState(t){this._viewState=t||{},this._disableViewStateAnimation&&(this._viewState={toState:t.toState})}_toggleOnInteraction(){this._sort.sort(this),("hint"===this._viewState.toState||"active"===this._viewState.toState)&&(this._disableViewStateAnimation=!0)}_handleClick(){this._isDisabled()||this._sort.sort(this)}_handleKeydown(t){!this._isDisabled()&&(32===t.keyCode||13===t.keyCode)&&(t.preventDefault(),this._toggleOnInteraction())}_isSorted(){return this._sort.active==this.id&&("asc"===this._sort.direction||"desc"===this._sort.direction)}_getArrowDirectionState(){return`${this._isSorted()?"active-":""}${this._arrowDirection}`}_getArrowViewState(){const t=this._viewState.fromState;return(t?`${t}-to-`:"")+this._viewState.toState}_updateArrowDirection(){this._arrowDirection=this._isSorted()?this._sort.direction:this.start||this._sort.start}_isDisabled(){return this._sort.disabled||this.disabled}_getAriaSortAttribute(){return this._isSorted()?"asc"==this._sort.direction?"ascending":"descending":"none"}_renderArrow(){return!this._isDisabled()||this._isSorted()}_updateSortActionDescription(t){this._sortButton&&(this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription),this._ariaDescriber?.describe(this._sortButton,t)),this._sortActionDescription=t}_handleStateChanges(){this._rerenderSubscription=wr(this._sort.sortChange,this._sort._stateChanges,this._intl.changes).subscribe(()=>{this._isSorted()&&(this._updateArrowDirection(),("hint"===this._viewState.toState||"active"===this._viewState.toState)&&(this._disableViewStateAnimation=!0),this._setAnimationTransitionState({fromState:this._arrowDirection,toState:"active"}),this._showIndicatorHint=!1),!this._isSorted()&&this._viewState&&"active"===this._viewState.toState&&(this._disableViewStateAnimation=!1,this._setAnimationTransitionState({fromState:"active",toState:this._arrowDirection})),this._changeDetectorRef.markForCheck()})}static#t=this.\u0275fac=function(r){return new(r||e)(z(T2),z(Et),z(wz,8),z("MAT_SORT_HEADER_COLUMN_DEF",8),z(dc),z(Me),z(OH,8),z(u$,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["","mat-sort-header",""]],hostAttrs:[1,"mat-sort-header"],hostVars:3,hostBindings:function(r,a){1&r&&Se("click",function(){return a._handleClick()})("keydown",function(h){return a._handleKeydown(h)})("mouseenter",function(){return a._setIndicatorHintVisible(!0)})("mouseleave",function(){return a._setIndicatorHintVisible(!1)}),2&r&&(Ve("aria-sort",a._getAriaSortAttribute()),Qe("mat-sort-header-disabled",a._isDisabled()))},inputs:{disabled:"disabled",id:["mat-sort-header","id"],arrowPosition:"arrowPosition",start:"start",sortActionDescription:"sortActionDescription",disableClear:"disableClear"},exportAs:["matSortHeader"],features:[Xt],attrs:fat,ngContentSelectors:_at,decls:4,vars:7,consts:[[1,"mat-sort-header-container","mat-focus-indicator"],[1,"mat-sort-header-content"],["class","mat-sort-header-arrow",4,"ngIf"],[1,"mat-sort-header-arrow"],[1,"mat-sort-header-stem"],[1,"mat-sort-header-indicator"],[1,"mat-sort-header-pointer-left"],[1,"mat-sort-header-pointer-right"],[1,"mat-sort-header-pointer-middle"]],template:function(r,a){1&r&&(xn(),ht(0,"div",0)(1,"div",1),Oe(2),ft(),Kt(3,gat,6,6,"div",2),ft()),2&r&&(Qe("mat-sort-header-sorted",a._isSorted())("mat-sort-header-position-before","before"===a.arrowPosition),Ve("tabindex",a._isDisabled()?null:0)("role",a._isDisabled()?null:"button"),St(3),It("ngIf",a._renderArrow()))},dependencies:[La],styles:[".mat-sort-header-container{display:flex;cursor:pointer;align-items:center;letter-spacing:normal;outline:0}[mat-sort-header].cdk-keyboard-focused .mat-sort-header-container,[mat-sort-header].cdk-program-focused .mat-sort-header-container{border-bottom:solid 1px currentColor}.mat-sort-header-disabled .mat-sort-header-container{cursor:default}.mat-sort-header-container::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-sort-header-content{text-align:center;display:flex;align-items:center}.mat-sort-header-position-before{flex-direction:row-reverse}.mat-sort-header-arrow{height:12px;width:12px;min-width:12px;position:relative;display:flex;opacity:0}.mat-sort-header-arrow,[dir=rtl] .mat-sort-header-position-before .mat-sort-header-arrow{margin:0 0 0 6px}.mat-sort-header-position-before .mat-sort-header-arrow,[dir=rtl] .mat-sort-header-arrow{margin:0 6px 0 0}.mat-sort-header-stem{background:currentColor;height:10px;width:2px;margin:auto;display:flex;align-items:center}.cdk-high-contrast-active .mat-sort-header-stem{width:0;border-left:solid 2px}.mat-sort-header-indicator{width:100%;height:2px;display:flex;align-items:center;position:absolute;top:0;left:0}.mat-sort-header-pointer-middle{margin:auto;height:2px;width:2px;background:currentColor;transform:rotate(45deg)}.cdk-high-contrast-active .mat-sort-header-pointer-middle{width:0;height:0;border-top:solid 2px;border-left:solid 2px}.mat-sort-header-pointer-left,.mat-sort-header-pointer-right{background:currentColor;width:6px;height:2px;position:absolute;top:0}.cdk-high-contrast-active .mat-sort-header-pointer-left,.cdk-high-contrast-active .mat-sort-header-pointer-right{width:0;height:0;border-left:solid 6px;border-top:solid 2px}.mat-sort-header-pointer-left{transform-origin:right;left:0}.mat-sort-header-pointer-right{transform-origin:left;right:0}"],encapsulation:2,data:{animation:[Kv.indicator,Kv.leftPointer,Kv.rightPointer,Kv.arrowOpacity,Kv.arrowPosition,Kv.allowChildren]},changeDetection:0})}return e})(),Mat=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[xat],imports:[ws,yi]})}return e})();const Dat=[[["caption"]],[["colgroup"],["col"]]],kat=["caption","colgroup, col"];function Cz(e){return class extends e{get sticky(){return this._sticky}set sticky(n){const t=this._sticky;this._sticky=De(n),this._hasStickyChanged=t!==this._sticky}hasStickyChanged(){const n=this._hasStickyChanged;return this._hasStickyChanged=!1,n}resetStickyChanged(){this._hasStickyChanged=!1}constructor(...n){super(...n),this._sticky=!1,this._hasStickyChanged=!1}}}const Qv=new kt("CDK_TABLE");let Jv=(()=>{class e{constructor(t){this.template=t}static#t=this.\u0275fac=function(r){return new(r||e)(z(Jr))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdkCellDef",""]]})}return e})(),t0=(()=>{class e{constructor(t){this.template=t}static#t=this.\u0275fac=function(r){return new(r||e)(z(Jr))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdkHeaderCellDef",""]]})}return e})(),E2=(()=>{class e{constructor(t){this.template=t}static#t=this.\u0275fac=function(r){return new(r||e)(z(Jr))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdkFooterCellDef",""]]})}return e})();class Aat{}const Iat=Cz(Aat);let Rh=(()=>{class e extends Iat{get name(){return this._name}set name(t){this._setNameInput(t)}get stickyEnd(){return this._stickyEnd}set stickyEnd(t){const r=this._stickyEnd;this._stickyEnd=De(t),this._hasStickyChanged=r!==this._stickyEnd}constructor(t){super(),this._table=t,this._stickyEnd=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(t){t&&(this._name=t,this.cssClassFriendlyName=t.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}static#t=this.\u0275fac=function(r){return new(r||e)(z(Qv,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdkColumnDef",""]],contentQueries:function(r,a,c){if(1&r&&(Fi(c,Jv,5),Fi(c,t0,5),Fi(c,E2,5)),2&r){let h;pe(h=fe())&&(a.cell=h.first),pe(h=fe())&&(a.headerCell=h.first),pe(h=fe())&&(a.footerCell=h.first)}},inputs:{sticky:"sticky",name:["cdkColumnDef","name"],stickyEnd:"stickyEnd"},features:[Te([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:e}]),Xt]})}return e})();class Mz{constructor(n,t){t.nativeElement.classList.add(...n._columnCssClassName)}}let Dz=(()=>{class e extends Mz{constructor(t,r){super(t,r)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Rh),z(Me))};static#e=this.\u0275dir=Mt({type:e,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[Xt]})}return e})(),kz=(()=>{class e extends Mz{constructor(t,r){if(super(t,r),1===t._table?._elementRef.nativeElement.nodeType){const a=t._table._elementRef.nativeElement.getAttribute("role");r.nativeElement.setAttribute("role","grid"===a||"treegrid"===a?"gridcell":"cell")}}static#t=this.\u0275fac=function(r){return new(r||e)(z(Rh),z(Me))};static#e=this.\u0275dir=Mt({type:e,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],features:[Xt]})}return e})();class m${constructor(){this.tasks=[],this.endTasks=[]}}const Sz=new kt("_COALESCED_STYLE_SCHEDULER");let p$=(()=>{class e{constructor(t){this._ngZone=t,this._currentSchedule=null,this._destroyed=new we}schedule(t){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(t)}scheduleEnd(t){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(t)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new m$,this._getScheduleObservable().pipe(Si(this._destroyed)).subscribe(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){const t=this._currentSchedule;this._currentSchedule=new m$;for(const r of t.tasks)r();for(const r of t.endTasks)r()}this._currentSchedule=null}))}_getScheduleObservable(){return this._ngZone.isStable?Er(Promise.resolve(void 0)):this._ngZone.onStable.pipe(nr(1))}static#t=this.\u0275fac=function(r){return new(r||e)(vt(Re))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})(),Tz=(()=>{class e{constructor(t,r){this.template=t,this._differs=r}ngOnChanges(t){if(!this._columnsDiffer){const r=t.columns&&t.columns.currentValue||[];this._columnsDiffer=this._differs.find(r).create(),this._columnsDiffer.diff(r)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(t){return this instanceof UM?t.headerCell.template:this instanceof HM?t.footerCell.template:t.cell.template}static#t=this.\u0275fac=function(r){return new(r||e)(z(Jr),z($s))};static#e=this.\u0275dir=Mt({type:e,features:[Bn]})}return e})();class Rat extends Tz{}const Pat=Cz(Rat);let UM=(()=>{class e extends Pat{constructor(t,r,a){super(t,r),this._table=a}ngOnChanges(t){super.ngOnChanges(t)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Jr),z($s),z(Qv,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:["cdkHeaderRowDef","columns"],sticky:["cdkHeaderRowDefSticky","sticky"]},features:[Xt,Bn]})}return e})();class Oat extends Tz{}const Fat=Cz(Oat);let HM=(()=>{class e extends Fat{constructor(t,r,a){super(t,r),this._table=a}ngOnChanges(t){super.ngOnChanges(t)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Jr),z($s),z(Qv,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:["cdkFooterRowDef","columns"],sticky:["cdkFooterRowDefSticky","sticky"]},features:[Xt,Bn]})}return e})(),A2=(()=>{class e extends Tz{constructor(t,r,a){super(t,r),this._table=a}static#t=this.\u0275fac=function(r){return new(r||e)(z(Jr),z($s),z(Qv,8))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","cdkRowDef",""]],inputs:{columns:["cdkRowDefColumns","columns"],when:["cdkRowDefWhen","when"]},features:[Xt]})}return e})(),Ph=(()=>{class e{static#t=this.mostRecentCellOutlet=null;constructor(t){this._viewContainer=t,e.mostRecentCellOutlet=this}ngOnDestroy(){e.mostRecentCellOutlet===this&&(e.mostRecentCellOutlet=null)}static#e=this.\u0275fac=function(r){return new(r||e)(z(hr))};static#i=this.\u0275dir=Mt({type:e,selectors:[["","cdkCellOutlet",""]]})}return e})(),Ez=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275cmp=Ye({type:e,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(r,a){1&r&&yo(0,0)},dependencies:[Ph],encapsulation:2})}return e})(),Iz=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275cmp=Ye({type:e,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(r,a){1&r&&yo(0,0)},dependencies:[Ph],encapsulation:2})}return e})(),I2=(()=>{class e{constructor(t){this.templateRef=t,this._contentClassName="cdk-no-data-row"}static#t=this.\u0275fac=function(r){return new(r||e)(z(Jr))};static#e=this.\u0275dir=Mt({type:e,selectors:[["ng-template","cdkNoDataRow",""]]})}return e})();const f$=["top","bottom","left","right"];class Lat{constructor(n,t,r,a,c=!0,h=!0,f){this._isNativeHtmlTable=n,this._stickCellCss=t,this.direction=r,this._coalescedStyleScheduler=a,this._isBrowser=c,this._needsPositionStickyOnElement=h,this._positionListener=f,this._cachedCellWidths=[],this._borderCellCss={top:`${t}-border-elem-top`,bottom:`${t}-border-elem-bottom`,left:`${t}-border-elem-left`,right:`${t}-border-elem-right`}}clearStickyPositioning(n,t){const r=[];for(const a of n)if(a.nodeType===a.ELEMENT_NODE){r.push(a);for(let c=0;c<a.children.length;c++)r.push(a.children[c])}this._coalescedStyleScheduler.schedule(()=>{for(const a of r)this._removeStickyStyle(a,t)})}updateStickyColumns(n,t,r,a=!0){if(!n.length||!this._isBrowser||!t.some(I=>I)&&!r.some(I=>I))return void(this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]})));const c=n[0],h=c.children.length,f=this._getCellWidths(c,a),b=this._getStickyStartColumnPositions(f,t),x=this._getStickyEndColumnPositions(f,r),M=t.lastIndexOf(!0),T=r.indexOf(!0);this._coalescedStyleScheduler.schedule(()=>{const I="rtl"===this.direction,L=I?"right":"left",N=I?"left":"right";for(const V of n)for(let $=0;$<h;$++){const nt=V.children[$];t[$]&&this._addStickyStyle(nt,L,b[$],$===M),r[$]&&this._addStickyStyle(nt,N,x[$],$===T)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:-1===M?[]:f.slice(0,M+1).map((V,$)=>t[$]?V:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:-1===T?[]:f.slice(T).map((V,$)=>r[$+T]?V:null).reverse()}))})}stickRows(n,t,r){if(!this._isBrowser)return;const a="bottom"===r?n.slice().reverse():n,c="bottom"===r?t.slice().reverse():t,h=[],f=[],b=[];for(let M=0,T=0;M<a.length;M++){if(!c[M])continue;h[M]=T;const I=a[M];b[M]=this._isNativeHtmlTable?Array.from(I.children):[I];const L=I.getBoundingClientRect().height;T+=L,f[M]=L}const x=c.lastIndexOf(!0);this._coalescedStyleScheduler.schedule(()=>{for(let M=0;M<a.length;M++){if(!c[M])continue;const T=h[M],I=M===x;for(const L of b[M])this._addStickyStyle(L,r,T,I)}"top"===r?this._positionListener?.stickyHeaderRowsUpdated({sizes:f,offsets:h,elements:b}):this._positionListener?.stickyFooterRowsUpdated({sizes:f,offsets:h,elements:b})})}updateStickyFooterContainer(n,t){if(!this._isNativeHtmlTable)return;const r=n.querySelector("tfoot");this._coalescedStyleScheduler.schedule(()=>{t.some(a=>!a)?this._removeStickyStyle(r,["bottom"]):this._addStickyStyle(r,"bottom",0,!1)})}_removeStickyStyle(n,t){for(const a of t)n.style[a]="",n.classList.remove(this._borderCellCss[a]);f$.some(a=>-1===t.indexOf(a)&&n.style[a])?n.style.zIndex=this._getCalculatedZIndex(n):(n.style.zIndex="",this._needsPositionStickyOnElement&&(n.style.position=""),n.classList.remove(this._stickCellCss))}_addStickyStyle(n,t,r,a){n.classList.add(this._stickCellCss),a&&n.classList.add(this._borderCellCss[t]),n.style[t]=`${r}px`,n.style.zIndex=this._getCalculatedZIndex(n),this._needsPositionStickyOnElement&&(n.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(n){const t={top:100,bottom:10,left:1,right:1};let r=0;for(const a of f$)n.style[a]&&(r+=t[a]);return r?`${r}`:""}_getCellWidths(n,t=!0){if(!t&&this._cachedCellWidths.length)return this._cachedCellWidths;const r=[],a=n.children;for(let c=0;c<a.length;c++)r.push(a[c].getBoundingClientRect().width);return this._cachedCellWidths=r,r}_getStickyStartColumnPositions(n,t){const r=[];let a=0;for(let c=0;c<n.length;c++)t[c]&&(r[c]=a,a+=n[c]);return r}_getStickyEndColumnPositions(n,t){const r=[];let a=0;for(let c=n.length;c>0;c--)t[c]&&(r[c]=a,a+=n[c]);return r}}const Rz=new kt("CDK_SPL");let R2=(()=>{class e{constructor(t,r){this.viewContainer=t,this.elementRef=r}static#t=this.\u0275fac=function(r){return new(r||e)(z(hr),z(Me))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","rowOutlet",""]]})}return e})(),P2=(()=>{class e{constructor(t,r){this.viewContainer=t,this.elementRef=r}static#t=this.\u0275fac=function(r){return new(r||e)(z(hr),z(Me))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","headerRowOutlet",""]]})}return e})(),O2=(()=>{class e{constructor(t,r){this.viewContainer=t,this.elementRef=r}static#t=this.\u0275fac=function(r){return new(r||e)(z(hr),z(Me))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","footerRowOutlet",""]]})}return e})(),F2=(()=>{class e{constructor(t,r){this.viewContainer=t,this.elementRef=r}static#t=this.\u0275fac=function(r){return new(r||e)(z(hr),z(Me))};static#e=this.\u0275dir=Mt({type:e,selectors:[["","noDataRowOutlet",""]]})}return e})(),L2=(()=>{class e{get trackBy(){return this._trackByFn}set trackBy(t){this._trackByFn=t}get dataSource(){return this._dataSource}set dataSource(t){this._dataSource!==t&&this._switchDataSource(t)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(t){this._multiTemplateDataRows=De(t),this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(t){this._fixedLayout=De(t),this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}constructor(t,r,a,c,h,f,b,x,M,T,I,L){this._differs=t,this._changeDetectorRef=r,this._elementRef=a,this._dir=h,this._platform=b,this._viewRepeater=x,this._coalescedStyleScheduler=M,this._viewportRuler=T,this._stickyPositioningListener=I,this._ngZone=L,this._onDestroy=new we,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new me,this.viewChange=new Yr({start:0,end:Number.MAX_VALUE}),c||this._elementRef.nativeElement.setAttribute("role","table"),this._document=f,this._isNativeHtmlTable="TABLE"===this._elementRef.nativeElement.nodeName}ngOnInit(){this._setupStickyStyler(),this._isNativeHtmlTable&&this._applyNativeTableSections(),this._dataDiffer=this._differs.find([]).create((t,r)=>this.trackBy?this.trackBy(r.dataIndex,r.data):r),this._viewportRuler.change().pipe(Si(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentChecked(){this._cacheRowDefs(),this._cacheColumnDefs();const r=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||r,this._forceRecalculateCellWidths=r,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}ngOnDestroy(){[this._rowOutlet.viewContainer,this._headerRowOutlet.viewContainer,this._footerRowOutlet.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(t=>{t.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),D2(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();const t=this._dataDiffer.diff(this._renderRows);if(!t)return this._updateNoDataRow(),void this.contentChanged.next();const r=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(t,r,(a,c,h)=>this._getEmbeddedViewArgs(a.item,h),a=>a.item.data,a=>{1===a.operation&&a.context&&this._renderCellTemplateForItem(a.record.item.rowDef,a.context)}),this._updateRowIndexContext(),t.forEachIdentityChange(a=>{r.get(a.currentIndex).context.$implicit=a.item.data}),this._updateNoDataRow(),this._ngZone&&Re.isInAngularZone()?this._ngZone.onStable.pipe(nr(1),Si(this._onDestroy)).subscribe(()=>{this.updateStickyColumnStyles()}):this.updateStickyColumnStyles(),this.contentChanged.next()}addColumnDef(t){this._customColumnDefs.add(t)}removeColumnDef(t){this._customColumnDefs.delete(t)}addRowDef(t){this._customRowDefs.add(t)}removeRowDef(t){this._customRowDefs.delete(t)}addHeaderRowDef(t){this._customHeaderRowDefs.add(t),this._headerRowDefChanged=!0}removeHeaderRowDef(t){this._customHeaderRowDefs.delete(t),this._headerRowDefChanged=!0}addFooterRowDef(t){this._customFooterRowDefs.add(t),this._footerRowDefChanged=!0}removeFooterRowDef(t){this._customFooterRowDefs.delete(t),this._footerRowDefChanged=!0}setNoDataRow(t){this._customNoDataRow=t}updateStickyHeaderRowStyles(){const t=this._getRenderedRows(this._headerRowOutlet),a=this._elementRef.nativeElement.querySelector("thead");a&&(a.style.display=t.length?"":"none");const c=this._headerRowDefs.map(h=>h.sticky);this._stickyStyler.clearStickyPositioning(t,["top"]),this._stickyStyler.stickRows(t,c,"top"),this._headerRowDefs.forEach(h=>h.resetStickyChanged())}updateStickyFooterRowStyles(){const t=this._getRenderedRows(this._footerRowOutlet),a=this._elementRef.nativeElement.querySelector("tfoot");a&&(a.style.display=t.length?"":"none");const c=this._footerRowDefs.map(h=>h.sticky);this._stickyStyler.clearStickyPositioning(t,["bottom"]),this._stickyStyler.stickRows(t,c,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,c),this._footerRowDefs.forEach(h=>h.resetStickyChanged())}updateStickyColumnStyles(){const t=this._getRenderedRows(this._headerRowOutlet),r=this._getRenderedRows(this._rowOutlet),a=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...t,...r,...a],["left","right"]),this._stickyColumnStylesNeedReset=!1),t.forEach((c,h)=>{this._addStickyColumnStyles([c],this._headerRowDefs[h])}),this._rowDefs.forEach(c=>{const h=[];for(let f=0;f<r.length;f++)this._renderRows[f].rowDef===c&&h.push(r[f]);this._addStickyColumnStyles(h,c)}),a.forEach((c,h)=>{this._addStickyColumnStyles([c],this._footerRowDefs[h])}),Array.from(this._columnDefsByName.values()).forEach(c=>c.resetStickyChanged())}_getAllRenderRows(){const t=[],r=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let a=0;a<this._data.length;a++){let c=this._data[a];const h=this._getRenderRowsForData(c,a,r.get(c));this._cachedRenderRowsMap.has(c)||this._cachedRenderRowsMap.set(c,new WeakMap);for(let f=0;f<h.length;f++){let b=h[f];const x=this._cachedRenderRowsMap.get(b.data);x.has(b.rowDef)?x.get(b.rowDef).push(b):x.set(b.rowDef,[b]),t.push(b)}}return t}_getRenderRowsForData(t,r,a){return this._getRowDefs(t,r).map(h=>{const f=a&&a.has(h)?a.get(h):[];if(f.length){const b=f.shift();return b.dataIndex=r,b}return{data:t,rowDef:h,dataIndex:r}})}_cacheColumnDefs(){this._columnDefsByName.clear(),B2(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(r=>{this._columnDefsByName.has(r.name),this._columnDefsByName.set(r.name,r)})}_cacheRowDefs(){this._headerRowDefs=B2(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=B2(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=B2(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);const t=this._rowDefs.filter(r=>!r.when);this._defaultRowDef=t[0]}_renderUpdatedColumns(){const t=(h,f)=>h||!!f.getColumnsDiff(),r=this._rowDefs.reduce(t,!1);r&&this._forceRenderDataRows();const a=this._headerRowDefs.reduce(t,!1);a&&this._forceRenderHeaderRows();const c=this._footerRowDefs.reduce(t,!1);return c&&this._forceRenderFooterRows(),r||a||c}_switchDataSource(t){this._data=[],D2(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),t||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear()),this._dataSource=t}_observeRenderChanges(){if(!this.dataSource)return;let t;D2(this.dataSource)?t=this.dataSource.connect(this):RA(this.dataSource)?t=this.dataSource:Array.isArray(this.dataSource)&&(t=Le(this.dataSource)),this._renderChangeSubscription=t.pipe(Si(this._onDestroy)).subscribe(r=>{this._data=r||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((t,r)=>this._renderRow(this._headerRowOutlet,t,r)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((t,r)=>this._renderRow(this._footerRowOutlet,t,r)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(t,r){const a=Array.from(r.columns||[]).map(f=>this._columnDefsByName.get(f)),c=a.map(f=>f.sticky),h=a.map(f=>f.stickyEnd);this._stickyStyler.updateStickyColumns(t,c,h,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(t){const r=[];for(let a=0;a<t.viewContainer.length;a++){const c=t.viewContainer.get(a);r.push(c.rootNodes[0])}return r}_getRowDefs(t,r){if(1==this._rowDefs.length)return[this._rowDefs[0]];let a=[];if(this.multiTemplateDataRows)a=this._rowDefs.filter(c=>!c.when||c.when(r,t));else{let c=this._rowDefs.find(h=>h.when&&h.when(r,t))||this._defaultRowDef;c&&a.push(c)}return a}_getEmbeddedViewArgs(t,r){return{templateRef:t.rowDef.template,context:{$implicit:t.data},index:r}}_renderRow(t,r,a,c={}){const h=t.viewContainer.createEmbeddedView(r.template,c,a);return this._renderCellTemplateForItem(r,c),h}_renderCellTemplateForItem(t,r){for(let a of this._getCellTemplates(t))Ph.mostRecentCellOutlet&&Ph.mostRecentCellOutlet._viewContainer.createEmbeddedView(a,r);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){const t=this._rowOutlet.viewContainer;for(let r=0,a=t.length;r<a;r++){const h=t.get(r).context;h.count=a,h.first=0===r,h.last=r===a-1,h.even=r%2==0,h.odd=!h.even,this.multiTemplateDataRows?(h.dataIndex=this._renderRows[r].dataIndex,h.renderIndex=r):h.index=this._renderRows[r].dataIndex}}_getCellTemplates(t){return t&&t.columns?Array.from(t.columns,r=>{const a=this._columnDefsByName.get(r);return t.extractCellTemplate(a)}):[]}_applyNativeTableSections(){const t=this._document.createDocumentFragment(),r=[{tag:"thead",outlets:[this._headerRowOutlet]},{tag:"tbody",outlets:[this._rowOutlet,this._noDataRowOutlet]},{tag:"tfoot",outlets:[this._footerRowOutlet]}];for(const a of r){const c=this._document.createElement(a.tag);c.setAttribute("role","rowgroup");for(const h of a.outlets)c.appendChild(h.elementRef.nativeElement);t.appendChild(c)}this._elementRef.nativeElement.appendChild(t)}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){const t=(r,a)=>r||a.hasStickyChanged();this._headerRowDefs.reduce(t,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(t,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(t,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){this._stickyStyler=new Lat(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:Le()).pipe(Si(this._onDestroy)).subscribe(r=>{this._stickyStyler.direction=r,this.updateStickyColumnStyles()})}_getOwnDefs(t){return t.filter(r=>!r._table||r._table===this)}_updateNoDataRow(){const t=this._customNoDataRow||this._noDataRow;if(!t)return;const r=0===this._rowOutlet.viewContainer.length;if(r===this._isShowingNoDataRow)return;const a=this._noDataRowOutlet.viewContainer;if(r){const c=a.createEmbeddedView(t.templateRef),h=c.rootNodes[0];1===c.rootNodes.length&&h?.nodeType===this._document.ELEMENT_NODE&&(h.setAttribute("role","row"),h.classList.add(t._contentClassName))}else a.clear();this._isShowingNoDataRow=r,this._changeDetectorRef.markForCheck()}static#t=this.\u0275fac=function(r){return new(r||e)(z($s),z(Et),z(Me),Ue("role"),z(es,8),z(ki),z(vr),z(jM),z(Sz),z(Lv),z(Rz,12),z(Re,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(r,a,c){if(1&r&&(Fi(c,I2,5),Fi(c,Rh,5),Fi(c,A2,5),Fi(c,UM,5),Fi(c,HM,5)),2&r){let h;pe(h=fe())&&(a._noDataRow=h.first),pe(h=fe())&&(a._contentColumnDefs=h),pe(h=fe())&&(a._contentRowDefs=h),pe(h=fe())&&(a._contentHeaderRowDefs=h),pe(h=fe())&&(a._contentFooterRowDefs=h)}},viewQuery:function(r,a){if(1&r&&(Hi(R2,7),Hi(P2,7),Hi(O2,7),Hi(F2,7)),2&r){let c;pe(c=fe())&&(a._rowOutlet=c.first),pe(c=fe())&&(a._headerRowOutlet=c.first),pe(c=fe())&&(a._footerRowOutlet=c.first),pe(c=fe())&&(a._noDataRowOutlet=c.first)}},hostAttrs:["ngSkipHydration","",1,"cdk-table"],hostVars:2,hostBindings:function(r,a){2&r&&Qe("cdk-table-fixed-layout",a.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:"multiTemplateDataRows",fixedLayout:"fixedLayout"},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],features:[Te([{provide:Qv,useExisting:e},{provide:jM,useClass:t$},{provide:Sz,useClass:p$},{provide:Rz,useValue:null}])],ngContentSelectors:kat,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(r,a){1&r&&(xn(Dat),Oe(0),Oe(1,1),yo(2,0)(3,1)(4,2)(5,3))},dependencies:[R2,P2,O2,F2],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2})}return e})();function B2(e,n){return e.concat(Array.from(n))}let Nat=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[VN]})}return e})();const zat=[[["caption"]],[["colgroup"],["col"]]],Vat=["caption","colgroup, col"];let _$=(()=>{class e extends L2{constructor(){super(...arguments),this.stickyCssClass="mat-mdc-table-sticky",this.needsPositionStickyOnElement=!1}ngOnInit(){super.ngOnInit(),this._isNativeHtmlTable&&this._elementRef.nativeElement.querySelector("tbody").classList.add("mdc-data-table__content")}static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:["ngSkipHydration","",1,"mat-mdc-table","mdc-data-table__table"],hostVars:2,hostBindings:function(r,a){2&r&&Qe("mdc-table-fixed-layout",a.fixedLayout)},exportAs:["matTable"],features:[Te([{provide:L2,useExisting:e},{provide:Qv,useExisting:e},{provide:Sz,useClass:p$},{provide:jM,useClass:t$},{provide:Rz,useValue:null}]),Xt],ngContentSelectors:Vat,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(r,a){1&r&&(xn(zat),Oe(0),Oe(1,1),yo(2,0)(3,1)(4,2)(5,3))},dependencies:[R2,P2,O2,F2],styles:[".mat-mdc-table-sticky{position:sticky !important}.mdc-data-table{-webkit-overflow-scrolling:touch;display:inline-flex;flex-direction:column;box-sizing:border-box;position:relative}.mdc-data-table__table-container{-webkit-overflow-scrolling:touch;overflow-x:auto;width:100%}.mdc-data-table__table{min-width:100%;border:0;white-space:nowrap;border-spacing:0;table-layout:fixed}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell,.mdc-data-table__cell[dir=rtl]{text-align:right}.mdc-data-table__cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__cell--numeric,.mdc-data-table__cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__header-cell{box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mdc-data-table__header-cell,.mdc-data-table__header-cell[dir=rtl]{text-align:right}.mdc-data-table__header-cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__header-cell--numeric,.mdc-data-table__header-cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__header-cell-wrapper{align-items:center;display:inline-flex;vertical-align:middle}.mdc-data-table__cell,.mdc-data-table__header-cell{padding:0 16px 0 16px}.mdc-data-table__header-cell--checkbox,.mdc-data-table__cell--checkbox{padding-left:4px;padding-right:0}[dir=rtl] .mdc-data-table__header-cell--checkbox,[dir=rtl] .mdc-data-table__cell--checkbox,.mdc-data-table__header-cell--checkbox[dir=rtl],.mdc-data-table__cell--checkbox[dir=rtl]{padding-left:0;padding-right:4px}mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.mat-mdc-table{--mat-table-row-item-outline-width:1px;table-layout:auto;white-space:normal;background-color:var(--mat-table-background-color)}.mat-mdc-header-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-header-container-height, 56px);color:var(--mat-table-header-headline-color, rgba(0, 0, 0, 0.87));font-family:var(--mat-table-header-headline-font, Roboto, sans-serif);line-height:var(--mat-table-header-headline-line-height);font-size:var(--mat-table-header-headline-size, 14px);font-weight:var(--mat-table-header-headline-weight, 500)}.mat-mdc-row{height:var(--mat-table-row-item-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, 0.87))}.mat-mdc-row,.mdc-data-table__content{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-table-row-item-label-text-font, Roboto, sans-serif);line-height:var(--mat-table-row-item-label-text-line-height);font-size:var(--mat-table-row-item-label-text-size, 14px);font-weight:var(--mat-table-row-item-label-text-weight)}.mat-mdc-footer-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-footer-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, 0.87));font-family:var(--mat-table-footer-supporting-text-font, Roboto, sans-serif);line-height:var(--mat-table-footer-supporting-text-line-height);font-size:var(--mat-table-footer-supporting-text-size, 14px);font-weight:var(--mat-table-footer-supporting-text-weight);letter-spacing:var(--mat-table-footer-supporting-text-tracking)}.mat-mdc-header-cell{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, 0.12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-header-headline-tracking);font-weight:inherit;line-height:inherit}.mat-mdc-cell{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, 0.12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-row-item-label-text-tracking);line-height:inherit}.mdc-data-table__row:last-child .mat-mdc-cell{border-bottom:none}.mat-mdc-footer-cell{letter-spacing:var(--mat-table-row-item-label-text-tracking)}mat-row.mat-mdc-row,mat-header-row.mat-mdc-header-row,mat-footer-row.mat-mdc-footer-row{border-bottom:none}.mat-mdc-table tbody,.mat-mdc-table tfoot,.mat-mdc-table thead,.mat-mdc-cell,.mat-mdc-footer-cell,.mat-mdc-header-row,.mat-mdc-row,.mat-mdc-footer-row,.mat-mdc-table .mat-mdc-header-cell{background:inherit}.mat-mdc-table mat-header-row.mat-mdc-header-row,.mat-mdc-table mat-row.mat-mdc-row,.mat-mdc-table mat-footer-row.mat-mdc-footer-cell{height:unset}mat-header-cell.mat-mdc-header-cell,mat-cell.mat-mdc-cell,mat-footer-cell.mat-mdc-footer-cell{align-self:stretch}"],encapsulation:2})}return e})(),Pz=(()=>{class e extends Jv{static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275dir=Mt({type:e,selectors:[["","matCellDef",""]],features:[Te([{provide:Jv,useExisting:e}]),Xt]})}return e})(),Oz=(()=>{class e extends t0{static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275dir=Mt({type:e,selectors:[["","matHeaderCellDef",""]],features:[Te([{provide:t0,useExisting:e}]),Xt]})}return e})(),Fz=(()=>{class e extends Rh{get name(){return this._name}set name(t){this._setNameInput(t)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275dir=Mt({type:e,selectors:[["","matColumnDef",""]],inputs:{sticky:"sticky",name:["matColumnDef","name"]},features:[Te([{provide:Rh,useExisting:e},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:e}]),Xt]})}return e})(),Lz=(()=>{class e extends Dz{static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275dir=Mt({type:e,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-mdc-header-cell","mdc-data-table__header-cell"],features:[Xt]})}return e})(),Bz=(()=>{class e extends kz{static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275dir=Mt({type:e,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:[1,"mat-mdc-cell","mdc-data-table__cell"],features:[Xt]})}return e})(),b$=(()=>{class e extends UM{static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275dir=Mt({type:e,selectors:[["","matHeaderRowDef",""]],inputs:{columns:["matHeaderRowDef","columns"],sticky:["matHeaderRowDefSticky","sticky"]},features:[Te([{provide:UM,useExisting:e}]),Xt]})}return e})(),y$=(()=>{class e extends A2{static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275dir=Mt({type:e,selectors:[["","matRowDef",""]],inputs:{columns:["matRowDefColumns","columns"],when:["matRowDefWhen","when"]},features:[Te([{provide:A2,useExisting:e}]),Xt]})}return e})(),v$=(()=>{class e extends Ez{static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-mdc-header-row","mdc-data-table__header-row"],exportAs:["matHeaderRow"],features:[Te([{provide:Ez,useExisting:e}]),Xt],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(r,a){1&r&&yo(0,0)},dependencies:[Ph],encapsulation:2})}return e})(),x$=(()=>{class e extends Iz{static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-mdc-row","mdc-data-table__row"],exportAs:["matRow"],features:[Te([{provide:Iz,useExisting:e}]),Xt],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(r,a){1&r&&yo(0,0)},dependencies:[Ph],encapsulation:2})}return e})(),w$=(()=>{class e extends I2{constructor(){super(...arguments),this._contentClassName="mat-mdc-no-data-row"}static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275dir=Mt({type:e,selectors:[["ng-template","matNoDataRow",""]],features:[Te([{provide:I2,useExisting:e}]),Xt]})}return e})(),Yat=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,Nat,yi]})}return e})();class Xat extends yst{get data(){return this._data.value}set data(n){n=Array.isArray(n)?n:[],this._data.next(n),this._renderChangesSubscription||this._filterData(n)}get filter(){return this._filter.value}set filter(n){this._filter.next(n),this._renderChangesSubscription||this._filterData(this.data)}get sort(){return this._sort}set sort(n){this._sort=n,this._updateChangeSubscription()}get paginator(){return this._paginator}set paginator(n){this._paginator=n,this._updateChangeSubscription()}constructor(n=[]){super(),this._renderData=new Yr([]),this._filter=new Yr(""),this._internalPageChanges=new we,this._renderChangesSubscription=null,this.sortingDataAccessor=(t,r)=>{const a=t[r];if(cH(a)){const c=Number(a);return c<9007199254740991?c:a}return a},this.sortData=(t,r)=>{const a=r.active,c=r.direction;return a&&""!=c?t.sort((h,f)=>{let b=this.sortingDataAccessor(h,a),x=this.sortingDataAccessor(f,a);const M=typeof b,T=typeof x;M!==T&&("number"===M&&(b+=""),"number"===T&&(x+=""));let I=0;return null!=b&&null!=x?b>x?I=1:b<x&&(I=-1):null!=b?I=1:null!=x&&(I=-1),I*("asc"==c?1:-1)}):t},this.filterPredicate=(t,r)=>{const a=Object.keys(t).reduce((h,f)=>h+t[f]+"\u25ec","").toLowerCase(),c=r.trim().toLowerCase();return-1!=a.indexOf(c)},this._data=new Yr(n),this._updateChangeSubscription()}_updateChangeSubscription(){const n=this._sort?wr(this._sort.sortChange,this._sort.initialized):Le(null),t=this._paginator?wr(this._paginator.page,this._internalPageChanges,this._paginator.initialized):Le(null),a=Jg([this._data,this._filter]).pipe(Ti(([f])=>this._filterData(f))),c=Jg([a,n]).pipe(Ti(([f])=>this._orderData(f))),h=Jg([c,t]).pipe(Ti(([f])=>this._pageData(f)));this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=h.subscribe(f=>this._renderData.next(f))}_filterData(n){return this.filteredData=null==this.filter||""===this.filter?n:n.filter(t=>this.filterPredicate(t,this.filter)),this.paginator&&this._updatePaginator(this.filteredData.length),this.filteredData}_orderData(n){return this.sort?this.sortData(n.slice(),this.sort):n}_pageData(n){if(!this.paginator)return n;const t=this.paginator.pageIndex*this.paginator.pageSize;return n.slice(t,t+this.paginator.pageSize)}_updatePaginator(n){Promise.resolve().then(()=>{const t=this.paginator;if(t&&(t.length=n,t.pageIndex>0)){const r=Math.ceil(t.length/t.pageSize)-1||0,a=Math.min(t.pageIndex,r);a!==t.pageIndex&&(t.pageIndex=a,this._internalPageChanges.next())}})}connect(){return this._renderChangesSubscription||this._updateChangeSubscription(),this._renderData}disconnect(){this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=null}}class Kat extends Xat{}const Qat=["*"];let N2;function $M(e){return function Jat(){if(void 0===N2&&(N2=null,typeof window<"u")){const e=window;void 0!==e.trustedTypes&&(N2=e.trustedTypes.createPolicy("angular#components",{createHTML:n=>n}))}return N2}()?.createHTML(e)||e}function C$(e){return Error(`Unable to find icon with the name "${e}"`)}function M$(e){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${e}".`)}function D$(e){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${e}".`)}class M_{constructor(n,t,r){this.url=n,this.svgText=t,this.options=r}}let z2=(()=>{class e{constructor(t,r,a,c){this._httpClient=t,this._sanitizer=r,this._errorHandler=c,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=a}addSvgIcon(t,r,a){return this.addSvgIconInNamespace("",t,r,a)}addSvgIconLiteral(t,r,a){return this.addSvgIconLiteralInNamespace("",t,r,a)}addSvgIconInNamespace(t,r,a,c){return this._addSvgIconConfig(t,r,new M_(a,null,c))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,r,a,c){const h=this._sanitizer.sanitize(an.HTML,a);if(!h)throw D$(a);const f=$M(h);return this._addSvgIconConfig(t,r,new M_("",f,c))}addSvgIconSet(t,r){return this.addSvgIconSetInNamespace("",t,r)}addSvgIconSetLiteral(t,r){return this.addSvgIconSetLiteralInNamespace("",t,r)}addSvgIconSetInNamespace(t,r,a){return this._addSvgIconSetConfig(t,new M_(r,null,a))}addSvgIconSetLiteralInNamespace(t,r,a){const c=this._sanitizer.sanitize(an.HTML,r);if(!c)throw D$(r);const h=$M(c);return this._addSvgIconSetConfig(t,new M_("",h,a))}registerFontClassAlias(t,r=t){return this._fontCssClassesByAlias.set(t,r),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const r=this._sanitizer.sanitize(an.RESOURCE_URL,t);if(!r)throw M$(t);const a=this._cachedIconsByUrl.get(r);return a?Le(V2(a)):this._loadSvgIconFromConfig(new M_(t,null)).pipe(Co(c=>this._cachedIconsByUrl.set(r,c)),Ti(c=>V2(c)))}getNamedSvgIcon(t,r=""){const a=k$(r,t);let c=this._svgIconConfigs.get(a);if(c)return this._getSvgFromConfig(c);if(c=this._getIconConfigFromResolvers(r,t),c)return this._svgIconConfigs.set(a,c),this._getSvgFromConfig(c);const h=this._iconSetConfigs.get(r);return h?this._getSvgFromIconSetConfigs(t,h):dv(C$(a))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Le(V2(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(Ti(r=>V2(r)))}_getSvgFromIconSetConfigs(t,r){const a=this._extractIconWithNameFromAnySet(t,r);return a?Le(a):o6(r.filter(h=>!h.svgText).map(h=>this._loadSvgIconSetFromConfig(h).pipe(Dp(f=>{const x=`Loading icon set URL: ${this._sanitizer.sanitize(an.RESOURCE_URL,h.url)} failed: ${f.message}`;return this._errorHandler.handleError(new Error(x)),Le(null)})))).pipe(Ti(()=>{const h=this._extractIconWithNameFromAnySet(t,r);if(!h)throw C$(t);return h}))}_extractIconWithNameFromAnySet(t,r){for(let a=r.length-1;a>=0;a--){const c=r[a];if(c.svgText&&c.svgText.toString().indexOf(t)>-1){const h=this._svgElementFromConfig(c),f=this._extractSvgIconFromSet(h,t,c.options);if(f)return f}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(Co(r=>t.svgText=r),Ti(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Le(null):this._fetchIcon(t).pipe(Co(r=>t.svgText=r))}_extractSvgIconFromSet(t,r,a){const c=t.querySelector(`[id="${r}"]`);if(!c)return null;const h=c.cloneNode(!0);if(h.removeAttribute("id"),"svg"===h.nodeName.toLowerCase())return this._setSvgAttributes(h,a);if("symbol"===h.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(h),a);const f=this._svgElementFromString($M("<svg></svg>"));return f.appendChild(h),this._setSvgAttributes(f,a)}_svgElementFromString(t){const r=this._document.createElement("DIV");r.innerHTML=t;const a=r.querySelector("svg");if(!a)throw Error("<svg> tag not found");return a}_toSvgElement(t){const r=this._svgElementFromString($M("<svg></svg>")),a=t.attributes;for(let c=0;c<a.length;c++){const{name:h,value:f}=a[c];"id"!==h&&r.setAttribute(h,f)}for(let c=0;c<t.childNodes.length;c++)t.childNodes[c].nodeType===this._document.ELEMENT_NODE&&r.appendChild(t.childNodes[c].cloneNode(!0));return r}_setSvgAttributes(t,r){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),r&&r.viewBox&&t.setAttribute("viewBox",r.viewBox),t}_fetchIcon(t){const{url:r,options:a}=t,c=a?.withCredentials??!1;if(!this._httpClient)throw function tlt(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==r)throw Error(`Cannot fetch icon from URL "${r}".`);const h=this._sanitizer.sanitize(an.RESOURCE_URL,r);if(!h)throw M$(r);const f=this._inProgressUrlFetches.get(h);if(f)return f;const b=this._httpClient.get(h,{responseType:"text",withCredentials:c}).pipe(Ti(x=>$M(x)),hv(()=>this._inProgressUrlFetches.delete(h)),tf());return this._inProgressUrlFetches.set(h,b),b}_addSvgIconConfig(t,r,a){return this._svgIconConfigs.set(k$(t,r),a),this}_addSvgIconSetConfig(t,r){const a=this._iconSetConfigs.get(t);return a?a.push(r):this._iconSetConfigs.set(t,[r]),this}_svgElementFromConfig(t){if(!t.svgElement){const r=this._svgElementFromString(t.svgText);this._setSvgAttributes(r,t.options),t.svgElement=r}return t.svgElement}_getIconConfigFromResolvers(t,r){for(let a=0;a<this._resolvers.length;a++){const c=this._resolvers[a](r,t);if(c)return ilt(c)?new M_(c.url,null,c.options):new M_(c,null)}}static#t=this.\u0275fac=function(r){return new(r||e)(vt(PI,8),vt(YL),vt(ki,8),vt(Bs))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function V2(e){return e.cloneNode(!0)}function k$(e,n){return e+":"+n}function ilt(e){return!(!e.url||!e.options)}const nlt=Uv(class{constructor(e){this._elementRef=e}}),rlt=new kt("MAT_ICON_DEFAULT_OPTIONS"),olt=new kt("mat-icon-location",{providedIn:"root",factory:function slt(){const e=oe(ki),n=e?e.location:null;return{getPathname:()=>n?n.pathname+n.search:""}}}),S$=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],alt=S$.map(e=>`[${e}]`).join(", "),llt=/^url\(['"]?#(.*?)['"]?\)$/;let T$=(()=>{class e extends nlt{get inline(){return this._inline}set inline(t){this._inline=De(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const r=this._cleanupFontValue(t);r!==this._fontSet&&(this._fontSet=r,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const r=this._cleanupFontValue(t);r!==this._fontIcon&&(this._fontIcon=r,this._updateFontIconClasses())}constructor(t,r,a,c,h,f){super(t),this._iconRegistry=r,this._location=c,this._errorHandler=h,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=lt.EMPTY,f&&(f.color&&(this.color=this.defaultColor=f.color),f.fontSet&&(this.fontSet=f.fontSet)),a||t.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const r=t.split(":");switch(r.length){case 1:return["",r[0]];case 2:return r;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const r=this._location.getPathname();r!==this._previousPath&&(this._previousPath=r,this._prependPathToReferences(r))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let r=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();r--;){const a=t.childNodes[r];(1!==a.nodeType||"svg"===a.nodeName.toLowerCase())&&a.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,r=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(a=>a.length>0);this._previousFontSetClass.forEach(a=>t.classList.remove(a)),r.forEach(a=>t.classList.add(a)),this._previousFontSetClass=r,this.fontIcon!==this._previousFontIconClass&&!r.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const r=this._elementsWithExternalReferences;r&&r.forEach((a,c)=>{a.forEach(h=>{c.setAttribute(h.name,`url('${t}#${h.value}')`)})})}_cacheChildrenWithExternalReferences(t){const r=t.querySelectorAll(alt),a=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let c=0;c<r.length;c++)S$.forEach(h=>{const f=r[c],b=f.getAttribute(h),x=b?b.match(llt):null;if(x){let M=a.get(f);M||(M=[],a.set(f,M)),M.push({name:h,value:x[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[r,a]=this._splitIconName(t);r&&(this._svgNamespace=r),a&&(this._svgName=a),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(a,r).pipe(nr(1)).subscribe(c=>this._setSvgElement(c),c=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${r}:${a}! ${c.message}`))})}}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(z2),Ue("aria-hidden"),z(olt),z(Bs),z(rlt,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(r,a){2&r&&(Ve("data-mat-icon-type",a._usingFontIcon()?"font":"svg")("data-mat-icon-name",a._svgName||a.fontIcon)("data-mat-icon-namespace",a._svgNamespace||a.fontSet)("fontIcon",a._usingFontIcon()?a.fontIcon:null),Qe("mat-icon-inline",a.inline)("mat-icon-no-color","primary"!==a.color&&"accent"!==a.color&&"warn"!==a.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Xt],ngContentSelectors:Qat,decls:1,vars:0,template:function(r,a){1&r&&(xn(),Oe(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return e})(),clt=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,yi]})}return e})();function dlt(e,n){1&e&&(ht(0,"th",22),be(1," ID "),ft())}function ult(e,n){if(1&e&&(ht(0,"td",23),be(1),ft()),2&e){const t=n.$implicit;St(1),Ln(" ",t.id," ")}}function hlt(e,n){1&e&&(ht(0,"th",22),be(1," Device Name "),ft())}function mlt(e,n){if(1&e&&(ht(0,"td",23),be(1),ft()),2&e){const t=n.$implicit;St(1),Ln(" ",t.deviceName," ")}}function plt(e,n){1&e&&(ht(0,"th",22),be(1," weight "),ft())}function flt(e,n){if(1&e&&(ht(0,"td",23),be(1),ft()),2&e){const t=n.$implicit;St(1),Ln(" ",t.weight," ")}}function glt(e,n){1&e&&(ht(0,"th",22),be(1," size "),ft())}function _lt(e,n){if(1&e&&(ht(0,"td",23),be(1),ft()),2&e){const t=n.$implicit;St(1),Ln(" ",t.size," ")}}function blt(e,n){1&e&&(ht(0,"th",22),be(1," price "),ft())}function ylt(e,n){if(1&e&&(ht(0,"td",23),be(1),ft()),2&e){const t=n.$implicit;St(1),Ln(" ",t.price," VND")}}function vlt(e,n){1&e&&(ht(0,"th",22),be(1," location "),ft())}function xlt(e,n){if(1&e&&(ht(0,"td",23),be(1),ft()),2&e){const t=n.$implicit;St(1),Ln(" ",t.location," ")}}function wlt(e,n){1&e&&(ht(0,"th",22),be(1," date "),ft())}function Clt(e,n){if(1&e&&(ht(0,"td",23),be(1),function xE(e,n){const t=Dn();let r;const a=e+fn;t.firstCreatePass?(r=function CF(e,n){if(n)for(let t=n.length-1;t>=0;t--){const r=n[t];if(e===r.name)return r}}(n,t.pipeRegistry),t.data[a]=r,r.onDestroy&&(t.destroyHooks??=[]).push(a,r.onDestroy)):r=t.data[a];const c=r.factory||(r.factory=gd(r.type)),f=fr(z);try{const b=Ef(!1),x=c();return Ef(b),function wO(e,n,t,r){t>=e.data.length&&(e.data[t]=null,e.blueprint[t]=null),n[t]=r}(t,Wt(),a,x),x}finally{fr(f)}}(2,"date"),ft()),2&e){const t=n.$implicit;St(1),Ln(" ",wE(2,1,t.date)," ")}}function Mlt(e,n){1&e&&(ht(0,"th",22),be(1," note "),ft())}function Dlt(e,n){if(1&e&&(ht(0,"td",23),be(1),ft()),2&e){const t=n.$implicit;St(1),Ln(" ",t.note," ")}}function klt(e,n){1&e&&(ht(0,"th",22),be(1," Action "),ft())}function Slt(e,n){if(1&e){const t=vo();ht(0,"td",23)(1,"button",24),Se("click",function(){const c=$n(t).$implicit;return Nn(Ne().editProduct(c))}),ht(2,"mat-icon"),be(3,"edit"),ft()(),ht(4,"button",25),Se("click",function(){const c=$n(t).$implicit;return Nn(Ne().deleteDevice(c.id))}),ht(5,"mat-icon"),be(6,"delete"),ft()()()}}function Tlt(e,n){1&e&&je(0,"tr",26)}function Elt(e,n){1&e&&je(0,"tr",27)}function Alt(e,n){if(1&e&&(ht(0,"tr",28)(1,"td",29),be(2),ft()()),2&e){Ne();const t=Kr(12);St(2),Ln('No data matching the filter "',t.value,'"')}}const Ilt=function(){return[5,10,25,100]};let Rlt=(()=>{class e{constructor(t,r){this._dialog=t,this._deviceService=r,this.displayedColumns=["id","deviceName","weight","size","price","location","date","note","action"]}ngOnInit(){this.getDeviceList()}openAddEditDevice(){this._dialog.open(xz,{width:"30%"}).afterClosed().subscribe({next:r=>{"save"===r&&this.getDeviceList()}})}getDeviceList(){this._deviceService.getDeviceList().subscribe({next:t=>{this.dataSource=new Kat(t),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator},error:console.log})}editProduct(t){this._dialog.open(xz,{width:"30%",data:t}).afterClosed().subscribe({next:r=>{"update"===r&&this.getDeviceList()}})}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}deleteDevice(t){this._deviceService.deleteDevice(t).subscribe({next:r=>{alert("device deleted!"),this.getDeviceList()},error:console.log})}static#t=this.\u0275fac=function(r){return new(r||e)(z(g2),z(cM))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["app-devicelist"]],viewQuery:function(r,a){if(1&r&&(Hi(d$,5),Hi(wz,5)),2&r){let c;pe(c=fe())&&(a.paginator=c.first),pe(c=fe())&&(a.sort=c.first)}},decls:46,vars:5,consts:[[1,"menu__Add"],["mat-raised-button","",1,"menu__Add--button",3,"click"],[1,"main-body"],["matInput","","placeholder","Ex. Mia",3,"keyup"],["input",""],[1,"table-container"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","deviceName"],["matColumnDef","weight"],["matColumnDef","size"],["matColumnDef","price"],["matColumnDef","location"],["matColumnDef","date"],["matColumnDef","note"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of users",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(r,a){1&r&&(ht(0,"div",0)(1,"h1"),be(2,"List Device"),ft(),ht(3,"button",1),Se("click",function(){return a.openAddEditDevice()}),ht(4,"mat-icon"),be(5,"add"),ft(),be(6,"Add Device"),ft()(),ht(7,"div",2)(8,"mat-form-field")(9,"mat-label"),be(10,"Filter"),ft(),ht(11,"input",3,4),Se("keyup",function(h){return a.applyFilter(h)}),ft()(),ht(13,"div",5)(14,"table",6),Eo(15,7),Kt(16,dlt,2,0,"th",8),Kt(17,ult,2,1,"td",9),Qr(),Eo(18,10),Kt(19,hlt,2,0,"th",8),Kt(20,mlt,2,1,"td",9),Qr(),Eo(21,11),Kt(22,plt,2,0,"th",8),Kt(23,flt,2,1,"td",9),Qr(),Eo(24,12),Kt(25,glt,2,0,"th",8),Kt(26,_lt,2,1,"td",9),Qr(),Eo(27,13),Kt(28,blt,2,0,"th",8),Kt(29,ylt,2,1,"td",9),Qr(),Eo(30,14),Kt(31,vlt,2,0,"th",8),Kt(32,xlt,2,1,"td",9),Qr(),Eo(33,15),Kt(34,wlt,2,0,"th",8),Kt(35,Clt,3,3,"td",9),Qr(),Eo(36,16),Kt(37,Mlt,2,0,"th",8),Kt(38,Dlt,2,1,"td",9),Qr(),Eo(39,17),Kt(40,klt,2,0,"th",8),Kt(41,Slt,7,0,"td",9),Qr(),Kt(42,Tlt,1,0,"tr",18),Kt(43,Elt,1,0,"tr",19),Kt(44,Alt,3,1,"tr",20),ft(),je(45,"mat-paginator",21),ft()()),2&r&&(St(14),It("dataSource",a.dataSource),St(28),It("matHeaderRowDef",a.displayedColumns),St(1),It("matRowDefColumns",a.displayedColumns),St(2),It("pageSizeOptions",function L1(e,n,t){const r=$o()+e,a=Wt();return a[r]===Oi?bo(a,r,t?n.call(t):n()):function Oa(e,n){return e[n]}(a,r)}(4,Ilt)))},dependencies:[LM,BM,T$,v2,NM,cz,d$,_$,Oz,b$,Fz,Pz,y$,Lz,Bz,v$,x$,w$,wz,Cat,jV],styles:[".menu__Add[_ngcontent-%COMP%]{display:flex;text-align:justify;padding-top:40px}.menu__Add--button[_ngcontent-%COMP%]{margin-left:auto;background-color:#0f3}.main-body[_ngcontent-%COMP%]{padding-top:20px;max-width:1248px;margin:0 auto}mat-form-field[_ngcontent-%COMP%]{width:100%}"]})}return e})(),Plt=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275cmp=Ye({type:e,selectors:[["app-home"]],decls:3,vars:0,consts:[["src","https://upload.wikimedia.org/wikipedia/commons/thumb/6/63/Logo_Viettel_from_7_January_2021_Slogan.svg/1200px-Logo_Viettel_from_7_January_2021_Slogan.svg.png","alt",""]],template:function(r,a){1&r&&(ht(0,"h1"),be(1,"Welcome to Device app"),ft(),je(2,"img",0))},styles:["h1[_ngcontent-%COMP%]{font-size:50px;margin-top:100px}img[_ngcontent-%COMP%]{width:500px;margin-left:30%;margin-top:50px}"]})}return e})();var GM=Nh(574);const Olt=["map"];function Flt(e,n){if(1&e&&(ht(0,"div")(1,"p"),be(2),ft(),je(3,"div",6,7),ft()),2&e){const t=Ne();St(2),Ju("Device found at (",t.device.location.latitude,", ",t.device.location.longitude,")")}}function Llt(e,n){1&e&&(ht(0,"div")(1,"p"),be(2,"No device found with the specified ID."),ft()())}const Blt=[{path:"",component:Plt},{path:"devicelist",component:Rlt},{path:"map",component:(()=>{class e{constructor(t){this.deviceService=t,this.searched=!1}ngOnInit(){this.initializeMap(21.0285,105.8542)}initializeMap(t,r){new GM.Map({accessToken:"pk.eyJ1IjoiYmV0YXBjaG9pMTBrIiwiYSI6ImNrY2ZuaWEwNjA2ZW0yeWw4bG9yNnUyYm0ifQ.bFCQ-5yq6cSsrhugfxO2_Q",container:"map",style:"mapbox://styles/mapbox/streets-v12",center:[r,t],zoom:14}).addControl(new GM.NavigationControl)}searchDevice(){this.id?this.deviceService.getDeviceId(this.id).subscribe(t=>{this.device=t,this.searched=!0,this.device&&this.device.latitude&&this.device.longitude?this.updateMap(this.device.latitude,this.device.longitude):console.log("No location found for the device.")},t=>{console.error("Error searching for device:",t)}):console.log("Please enter an ID")}updateMap(t,r){const a=new GM.Map({accessToken:"pk.eyJ1IjoiYmV0YXBjaG9pMTBrIiwiYSI6ImNrY2ZuaWEwNjA2ZW0yeWw4bG9yNnUyYm0ifQ.bFCQ-5yq6cSsrhugfxO2_Q",container:"map",style:"mapbox://styles/mapbox/streets-v12",center:[r,t],zoom:14});a.addControl(new GM.NavigationControl),(new GM.Marker).setLngLat([r,t]).addTo(a)}static#t=this.\u0275fac=function(r){return new(r||e)(z(cM))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["app-map"]],viewQuery:function(r,a){if(1&r&&Hi(Olt,7),2&r){let c;pe(c=fe())&&(a.mapElement=c.first)}},decls:10,vars:3,consts:[[1,"search"],["appearance","fill"],["matInput","","placeholder","Enter ID",3,"ngModel","ngModelChange"],["mat-raised-button","","color","primary",3,"click"],[4,"ngIf"],["id","map",2,"width","auto","height","550px"],[1,"map"],["mapContainer",""]],template:function(r,a){1&r&&(ht(0,"div",0)(1,"mat-form-field",1)(2,"mat-label"),be(3,"Search by ID"),ft(),ht(4,"input",2),Se("ngModelChange",function(h){return a.id=h}),ft()(),ht(5,"button",3),Se("click",function(){return a.searchDevice()}),be(6,"Search"),ft(),Kt(7,Flt,5,2,"div",4),Kt(8,Llt,3,0,"div",4),ft(),je(9,"div",5)),2&r&&(St(4),It("ngModel",a.id),St(3),It("ngIf",a.device),St(1),It("ngIf",!a.device&&a.searched))},dependencies:[La,LM,v2,NM,cz,dM,pN,CN],styles:[".search[_ngcontent-%COMP%]{padding-top:40px}"]})}return e})()},{path:"device-add-edit",component:xz},{path:"charts",component:pet}];let Nlt=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[v5.forRoot(Blt),v5]})}return e})();const zlt=["*",[["mat-toolbar-row"]]],Vlt=["*","mat-toolbar-row"],jlt=Uv(class{constructor(e){this._elementRef=e}});let Ult=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275dir=Mt({type:e,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]})}return e})(),Hlt=(()=>{class e extends jlt{constructor(t,r,a){super(t),this._platform=r,this._document=a}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(vr),z(ki))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-toolbar"]],contentQueries:function(r,a,c){if(1&r&&Fi(c,Ult,5),2&r){let h;pe(h=fe())&&(a._toolbarRows=h)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(r,a){2&r&&Qe("mat-toolbar-multiple-rows",a._toolbarRows.length>0)("mat-toolbar-single-row",0===a._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[Xt],ngContentSelectors:Vlt,decls:2,vars:0,template:function(r,a){1&r&&(xn(zlt),Oe(0),Oe(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color);color:var(--mat-toolbar-container-text-color)}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font);font-size:var(--mat-toolbar-title-text-size);line-height:var(--mat-toolbar-title-text-line-height);font-weight:var(--mat-toolbar-title-text-weight);letter-spacing:var(--mat-toolbar-title-text-tracking);margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0})}return e})(),$lt=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,yi]})}return e})();const j2=["*"],Glt=["content"];function Wlt(e,n){if(1&e){const t=vo();ht(0,"div",2),Se("click",function(){return $n(t),Nn(Ne()._onBackdropClicked())}),ft()}2&e&&Qe("mat-drawer-shown",Ne()._isShowingBackdrop())}function qlt(e,n){1&e&&(ht(0,"mat-drawer-content"),Oe(1,2),ft())}const Ylt=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],Zlt=["mat-drawer","mat-drawer-content","*"];function Xlt(e,n){if(1&e){const t=vo();ht(0,"div",2),Se("click",function(){return $n(t),Nn(Ne()._onBackdropClicked())}),ft()}2&e&&Qe("mat-drawer-shown",Ne()._isShowingBackdrop())}function Klt(e,n){1&e&&(ht(0,"mat-sidenav-content"),Oe(1,2),ft())}const Qlt=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],Jlt=["mat-sidenav","mat-sidenav-content","*"],E$={transformDrawer:Po("transform",[Hn("open, open-instant",oi({transform:"none",visibility:"visible"})),Hn("void",oi({"box-shadow":"none",visibility:"hidden"})),Tn("void => open-instant",Fn("0ms")),Tn("void <=> open, open-instant => void",Fn("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},ect=new kt("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function ict(){return!1}}),Nz=new kt("MAT_DRAWER_CONTAINER");let U2=(()=>{class e extends MM{constructor(t,r,a,c,h){super(a,c,h),this._changeDetectorRef=t,this._container=r}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}static#t=this.\u0275fac=function(r){return new(r||e)(z(Et),z(rn(()=>I$)),z(Me),z(CM),z(Re))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-drawer-content"]],hostAttrs:["ngSkipHydration","",1,"mat-drawer-content"],hostVars:4,hostBindings:function(r,a){2&r&&pa("margin-left",a._container._contentMargins.left,"px")("margin-right",a._container._contentMargins.right,"px")},features:[Te([{provide:MM,useExisting:e}]),Xt],ngContentSelectors:j2,decls:1,vars:0,template:function(r,a){1&r&&(xn(),Oe(0))},encapsulation:2,changeDetection:0})}return e})(),A$=(()=>{class e{get position(){return this._position}set position(t){(t="end"===t?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(t),this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=De(t)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(t){("true"===t||"false"===t||null==t)&&(t=De(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle(De(t))}constructor(t,r,a,c,h,f,b,x){this._elementRef=t,this._focusTrapFactory=r,this._focusMonitor=a,this._platform=c,this._ngZone=h,this._interactivityChecker=f,this._doc=b,this._container=x,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new we,this._animationEnd=new we,this._animationState="void",this.openedChange=new me(!0),this._openedStream=this.openedChange.pipe(rr(M=>M),Ti(()=>{})),this.openedStart=this._animationStarted.pipe(rr(M=>M.fromState!==M.toState&&0===M.toState.indexOf("open")),FA(void 0)),this._closedStream=this.openedChange.pipe(rr(M=>!M),Ti(()=>{})),this.closedStart=this._animationStarted.pipe(rr(M=>M.fromState!==M.toState&&"void"===M.toState),FA(void 0)),this._destroyed=new we,this.onPositionChanged=new me,this._modeChanged=new we,this.openedChange.subscribe(M=>{M?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{zp(this._elementRef.nativeElement,"keydown").pipe(rr(M=>27===M.keyCode&&!this.disableClose&&!Do(M)),Si(this._destroyed)).subscribe(M=>this._ngZone.run(()=>{this.close(),M.stopPropagation(),M.preventDefault()}))}),this._animationEnd.pipe(wa((M,T)=>M.fromState===T.fromState&&M.toState===T.toState)).subscribe(M=>{const{fromState:T,toState:I}=M;(0===I.indexOf("open")&&"void"===T||"void"===I&&0===T.indexOf("open"))&&this.openedChange.emit(this._opened)})}_forceFocus(t,r){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const a=()=>{t.removeEventListener("blur",a),t.removeEventListener("mousedown",a),t.removeAttribute("tabindex")};t.addEventListener("blur",a),t.addEventListener("mousedown",a)})),t.focus(r)}_focusByCssSelector(t,r){let a=this._elementRef.nativeElement.querySelector(t);a&&this._forceFocus(a,r)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(r=>{!r&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const t=this._doc.activeElement;return!!t&&this._elementRef.nativeElement.contains(t)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,r){t&&r&&(this._openedVia=r);const a=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),a}_setOpen(t,r,a){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",r&&this._restoreFocus(a)),this._updateFocusTrapState(),new Promise(c=>{this.openedChange.pipe(nr(1)).subscribe(h=>c(h?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=!!this._container?.hasBackdrop)}_updatePositionInParent(t){const r=this._elementRef.nativeElement,a=r.parentNode;"end"===t?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),a.insertBefore(this._anchor,r)),a.appendChild(r)):this._anchor&&this._anchor.parentNode.insertBefore(r,this._anchor)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Me),z(IM),z(dc),z(vr),z(Re),z(AM),z(ki,8),z(Nz,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-drawer"]],viewQuery:function(r,a){if(1&r&&Hi(Glt,5),2&r){let c;pe(c=fe())&&(a._content=c.first)}},hostAttrs:["tabIndex","-1","ngSkipHydration","",1,"mat-drawer"],hostVars:12,hostBindings:function(r,a){1&r&&kg("@transform.start",function(h){return a._animationStarted.next(h)})("@transform.done",function(h){return a._animationEnd.next(h)}),2&r&&(Ve("align",null),Rg("@transform",a._animationState),Qe("mat-drawer-end","end"===a.position)("mat-drawer-over","over"===a.mode)("mat-drawer-push","push"===a.mode)("mat-drawer-side","side"===a.mode)("mat-drawer-opened",a.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:j2,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(r,a){1&r&&(xn(),ht(0,"div",0,1),Oe(2),ft())},dependencies:[MM],encapsulation:2,data:{animation:[E$.transformDrawer]},changeDetection:0})}return e})(),I$=(()=>{class e{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=De(t)}get hasBackdrop(){return this._drawerHasBackdrop(this._start)||this._drawerHasBackdrop(this._end)}set hasBackdrop(t){this._backdropOverride=null==t?null:De(t)}get scrollable(){return this._userContent||this._content}constructor(t,r,a,c,h,f=!1,b){this._dir=t,this._element=r,this._ngZone=a,this._changeDetectorRef=c,this._animationMode=b,this._drawers=new oh,this.backdropClick=new me,this._destroyed=new we,this._doCheckSubject=new we,this._contentMargins={left:null,right:null},this._contentMarginChanges=new we,t&&t.change.pipe(Si(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),h.change().pipe(Si(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=f}ngAfterContentInit(){this._allDrawers.changes.pipe(Ws(this._allDrawers),Si(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(r=>!r._container||r._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(Ws(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(n2(10),Si(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,r=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const a=this._left._getWidth();t+=a,r-=a}if(this._right&&this._right.opened)if("side"==this._right.mode)r+=this._right._getWidth();else if("push"==this._right.mode){const a=this._right._getWidth();r+=a,t-=a}t=t||null,r=r||null,(t!==this._contentMargins.left||r!==this._contentMargins.right)&&(this._contentMargins={left:t,right:r},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(rr(r=>r.fromState!==r.toState),Si(this._drawers.changes)).subscribe(r=>{"open-instant"!==r.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(Si(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){t&&t.onPositionChanged.pipe(Si(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(nr(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(Si(wr(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const r=this._element.nativeElement.classList,a="mat-drawer-container-has-open";t?r.add(a):r.remove(a)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._drawerHasBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._drawerHasBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._drawerHasBackdrop(this._end)}_isDrawerOpen(t){return null!=t&&t.opened}_drawerHasBackdrop(t){return null==this._backdropOverride?!!t&&"side"!==t.mode:this._backdropOverride}static#t=this.\u0275fac=function(r){return new(r||e)(z(es,8),z(Me),z(Re),z(Et),z(Lv),z(ect),z(Pr,8))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-drawer-container"]],contentQueries:function(r,a,c){if(1&r&&(Fi(c,U2,5),Fi(c,A$,5)),2&r){let h;pe(h=fe())&&(a._content=h.first),pe(h=fe())&&(a._allDrawers=h)}},viewQuery:function(r,a){if(1&r&&Hi(U2,5),2&r){let c;pe(c=fe())&&(a._userContent=c.first)}},hostAttrs:["ngSkipHydration","",1,"mat-drawer-container"],hostVars:2,hostBindings:function(r,a){2&r&&Qe("mat-drawer-container-explicit-backdrop",a._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[Te([{provide:Nz,useExisting:e}])],ngContentSelectors:Zlt,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(r,a){1&r&&(xn(Ylt),Kt(0,Wlt,1,2,"div",0),Oe(1),Oe(2,1),Kt(3,qlt,2,0,"mat-drawer-content",1)),2&r&&(It("ngIf",a.hasBackdrop),St(3),It("ngIf",!a._content))},dependencies:[La,U2],styles:['.mat-drawer-container{position:relative;z-index:1;color:var(--mat-sidenav-content-text-color);background-color:var(--mat-sidenav-content-background-color);box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible;background-color:var(--mat-sidenav-scrim-color)}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{box-shadow:0px 8px 10px -5px rgba(0, 0, 0, 0.2), 0px 16px 24px 2px rgba(0, 0, 0, 0.14), 0px 6px 30px 5px rgba(0, 0, 0, 0.12);position:relative;z-index:4;--mat-sidenav-container-shape:0;color:var(--mat-sidenav-container-text-color);background-color:var(--mat-sidenav-container-background-color);border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0);border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .mat-drawer{border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);border-top-left-radius:0;border-bottom-left-radius:0;left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-side{box-shadow:none;border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid}.mat-drawer-side.mat-drawer-end{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side.mat-drawer-end{border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid;border-left:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0})}return e})(),zz=(()=>{class e extends U2{constructor(t,r,a,c,h){super(t,r,a,c,h)}static#t=this.\u0275fac=function(r){return new(r||e)(z(Et),z(rn(()=>P$)),z(Me),z(CM),z(Re))};static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-sidenav-content"]],hostAttrs:["ngSkipHydration","",1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(r,a){2&r&&pa("margin-left",a._container._contentMargins.left,"px")("margin-right",a._container._contentMargins.right,"px")},features:[Te([{provide:MM,useExisting:e}]),Xt],ngContentSelectors:j2,decls:1,vars:0,template:function(r,a){1&r&&(xn(),Oe(0))},encapsulation:2,changeDetection:0})}return e})(),R$=(()=>{class e extends A${constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=De(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=ts(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=ts(t)}static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1","ngSkipHydration","",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(r,a){2&r&&(Ve("align",null),pa("top",a.fixedInViewport?a.fixedTopGap:null,"px")("bottom",a.fixedInViewport?a.fixedBottomGap:null,"px"),Qe("mat-drawer-end","end"===a.position)("mat-drawer-over","over"===a.mode)("mat-drawer-push","push"===a.mode)("mat-drawer-side","side"===a.mode)("mat-drawer-opened",a.opened)("mat-sidenav-fixed",a.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[Xt],ngContentSelectors:j2,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(r,a){1&r&&(xn(),ht(0,"div",0,1),Oe(2),ft())},dependencies:[MM],encapsulation:2,data:{animation:[E$.transformDrawer]},changeDetection:0})}return e})(),P$=(()=>{class e extends I${constructor(){super(...arguments),this._allDrawers=void 0,this._content=void 0}static#t=this.\u0275fac=function(){let t;return function(a){return(t||(t=bi(e)))(a||e)}}();static#e=this.\u0275cmp=Ye({type:e,selectors:[["mat-sidenav-container"]],contentQueries:function(r,a,c){if(1&r&&(Fi(c,zz,5),Fi(c,R$,5)),2&r){let h;pe(h=fe())&&(a._content=h.first),pe(h=fe())&&(a._allDrawers=h)}},hostAttrs:["ngSkipHydration","",1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(r,a){2&r&&Qe("mat-drawer-container-explicit-backdrop",a._backdropOverride)},exportAs:["matSidenavContainer"],features:[Te([{provide:Nz,useExisting:e}]),Xt],ngContentSelectors:Jlt,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(r,a){1&r&&(xn(Qlt),Kt(0,Xlt,1,2,"div",0),Oe(1),Oe(2,1),Kt(3,Klt,2,0,"mat-sidenav-content",1)),2&r&&(It("ngIf",a.hasBackdrop),St(3),It("ngIf",!a._content))},dependencies:[La,zz],styles:['.mat-drawer-container{position:relative;z-index:1;color:var(--mat-sidenav-content-text-color);background-color:var(--mat-sidenav-content-background-color);box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible;background-color:var(--mat-sidenav-scrim-color)}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{box-shadow:0px 8px 10px -5px rgba(0, 0, 0, 0.2), 0px 16px 24px 2px rgba(0, 0, 0, 0.14), 0px 6px 30px 5px rgba(0, 0, 0, 0.12);position:relative;z-index:4;--mat-sidenav-container-shape:0;color:var(--mat-sidenav-container-text-color);background-color:var(--mat-sidenav-container-background-color);border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0);border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .mat-drawer{border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);border-top-left-radius:0;border-bottom-left-radius:0;left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-side{box-shadow:none;border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid}.mat-drawer-side.mat-drawer-end{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side.mat-drawer-end{border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid;border-left:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0})}return e})(),nct=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[ws,yi,Sh,Sh,yi]})}return e})(),rct=(()=>{class e{constructor(){this.title="appDevice"}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275cmp=Ye({type:e,selectors:[["app-root"]],decls:50,vars:2,consts:[["color","primary"],["mat-icon-button","","id","menuIcon","aria-label","Example icon-button with menu icon",3,"click"],["id","menuTitle"],[1,"menuleft"],["mat-button","","routerLink","/",1,"top-menu-item"],["mat-button","","routerLink","/devicelist",1,"top-menu-item"],["mat-button","","routerLink","map",1,"top-menu-item"],["mat-button","","routerLink","charts",1,"top-menu-item"],["mode","side",3,"fixedInViewport","fixedTopGap"],["sidenav",""],[1,"side-nav-items"],["mat-button","","routerLink","/",1,"side-menu-item",3,"click"],["mat-button","","routerLink","/devicelist",1,"side-menu-item",3,"click"],["mat-button","","routerLink","map",1,"side-menu-item",3,"click"],["mat-button","","routerLink","charts",1,"side-menu-item",3,"click"],[1,"main-content"]],template:function(r,a){if(1&r){const c=vo();ht(0,"mat-toolbar",0)(1,"button",1),Se("click",function(){return $n(c),Nn(Kr(25).toggle())}),ht(2,"mat-icon"),be(3,"menu"),ft()(),ht(4,"span",2),be(5,"Device Iot App"),ft(),ht(6,"div",3)(7,"a",4)(8,"mat-icon"),be(9,"home"),ft(),be(10,"Home"),ft(),ht(11,"a",5)(12,"mat-icon"),be(13,"settings"),ft(),be(14,"Device List"),ft(),ht(15,"a",6)(16,"mat-icon"),be(17," location_on"),ft(),be(18,"Map"),ft(),ht(19,"a",7)(20,"mat-icon"),be(21," insert_chart_outlined"),ft(),be(22,"Chart Device"),ft()()(),ht(23,"mat-sidenav-container")(24,"mat-sidenav",8,9)(26,"div",10)(27,"div")(28,"a",11),Se("click",function(){return $n(c),Nn(Kr(25).close())}),ht(29,"mat-icon"),be(30,"home"),ft(),be(31,"Home"),ft()(),ht(32,"div")(33,"a",12),Se("click",function(){return $n(c),Nn(Kr(25).close())}),ht(34,"mat-icon"),be(35,"settings"),ft(),be(36," Device List"),ft()(),ht(37,"div")(38,"a",13),Se("click",function(){return $n(c),Nn(Kr(25).close())}),ht(39,"mat-icon"),be(40," location_on"),ft(),be(41," Map"),ft()(),ht(42,"div")(43,"a",14),Se("click",function(){return $n(c),Nn(Kr(25).close())}),ht(44,"mat-icon"),be(45," insert_chart_outlined"),ft(),be(46," Chart Device"),ft()()()(),ht(47,"mat-sidenav-content")(48,"div",15),je(49,"router-outlet"),ft()()()}2&r&&(St(24),It("fixedInViewport",!0)("fixedTopGap",60))},dependencies:[uB,QA,Hlt,Vrt,BM,T$,R$,P$,zz],styles:[".menuleft[_ngcontent-%COMP%]{flex:1 1 auto}#menuTitle[_ngcontent-%COMP%]{font-size:medium;margin-right:20px}.mat-toolbar[_ngcontent-%COMP%]{position:fixed;height:60px;z-index:1000}.side-nav-items[_ngcontent-%COMP%]{display:flexbox;flex-direction:column}.side-menu-item[_ngcontent-%COMP%]{color:#fff!important;margin-top:20px}.main-content[_ngcontent-%COMP%]{margin:20px}.mat-sidenav[_ngcontent-%COMP%]{background-color:#3f51b5}@media (min-width: 900px){#menuIcon[_ngcontent-%COMP%], .mat-sidenav[_ngcontent-%COMP%]{display:none}}@media (max-width: 900px){.top-menu-item[_ngcontent-%COMP%]{display:none}}"]})}return e})();function O$(e){return new Rt(3e3,!1)}function Wp(e){switch(e.length){case 0:return new FM;case 1:return e[0];default:return new _8(e)}}function F$(e,n,t=new Map,r=new Map){const a=[],c=[];let h=-1,f=null;if(n.forEach(b=>{const x=b.get("offset"),M=x==h,T=M&&f||new Map;b.forEach((I,L)=>{let N=L,V=I;if("offset"!==L)switch(N=e.normalizePropertyName(N,a),V){case"!":V=t.get(L);break;case Ih:V=r.get(L);break;default:V=e.normalizeStyleValue(L,N,V,a)}T.set(N,V)}),M||c.push(T),f=T,h=x}),a.length)throw function Sct(e){return new Rt(3502,!1)}();return c}function Vz(e,n,t,r){switch(n){case"start":e.onStart(()=>r(t&&jz(t,"start",e)));break;case"done":e.onDone(()=>r(t&&jz(t,"done",e)));break;case"destroy":e.onDestroy(()=>r(t&&jz(t,"destroy",e)))}}function jz(e,n,t){const c=Uz(e.element,e.triggerName,e.fromState,e.toState,n||e.phaseName,t.totalTime??e.totalTime,!!t.disabled),h=e._data;return null!=h&&(c._data=h),c}function Uz(e,n,t,r,a="",c=0,h){return{element:e,triggerName:n,fromState:t,toState:r,phaseName:a,totalTime:c,disabled:!!h}}function Cl(e,n,t){let r=e.get(n);return r||e.set(n,r=t),r}function L$(e){const n=e.indexOf(":");return[e.substring(1,n),e.slice(n+1)]}const zct=(()=>typeof document>"u"?null:document.documentElement)();function Hz(e){const n=e.parentNode||e.host||null;return n===zct?null:n}let D_=null,B$=!1;function N$(e,n){for(;n;){if(n===e)return!0;n=Hz(n)}return!1}function z$(e,n,t){if(t)return Array.from(e.querySelectorAll(n));const r=e.querySelector(n);return r?[r]:[]}let V$=(()=>{class e{validateStyleProperty(t){return function jct(e){D_||(D_=function Uct(){return typeof document<"u"?document.body:null}()||{},B$=!!D_.style&&"WebkitAppearance"in D_.style);let n=!0;return D_.style&&!function Vct(e){return"ebkit"==e.substring(1,6)}(e)&&(n=e in D_.style,!n&&B$&&(n="Webkit"+e.charAt(0).toUpperCase()+e.slice(1)in D_.style)),n}(t)}matchesElement(t,r){return!1}containsElement(t,r){return N$(t,r)}getParentElement(t){return Hz(t)}query(t,r,a){return z$(t,r,a)}computeStyle(t,r,a){return a||""}animate(t,r,a,c,h,f=[],b){return new FM(a,c)}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})(),$z=(()=>{class e{static#t=this.NOOP=new V$}return e})();const Hct=1e3,Gz="ng-enter",H2="ng-leave",$2="ng-trigger",G2=".ng-trigger",U$="ng-animating",Wz=".ng-animating";function Oh(e){if("number"==typeof e)return e;const n=e.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:qz(parseFloat(n[1]),n[2])}function qz(e,n){return"s"===n?e*Hct:e}function W2(e,n,t){return e.hasOwnProperty("duration")?e:function Gct(e,n,t){let a,c=0,h="";if("string"==typeof e){const f=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===f)return n.push(O$()),{duration:0,delay:0,easing:""};a=qz(parseFloat(f[1]),f[2]);const b=f[3];null!=b&&(c=qz(parseFloat(b),f[4]));const x=f[5];x&&(h=x)}else a=e;if(!t){let f=!1,b=n.length;a<0&&(n.push(function oct(){return new Rt(3100,!1)}()),f=!0),c<0&&(n.push(function sct(){return new Rt(3101,!1)}()),f=!0),f&&n.splice(b,0,O$())}return{duration:a,delay:c,easing:h}}(e,n,t)}function WM(e,n={}){return Object.keys(e).forEach(t=>{n[t]=e[t]}),n}function H$(e){const n=new Map;return Object.keys(e).forEach(t=>{n.set(t,e[t])}),n}function qp(e,n=new Map,t){if(t)for(let[r,a]of t)n.set(r,a);for(let[r,a]of e)n.set(r,a);return n}function Xd(e,n,t){n.forEach((r,a)=>{const c=Zz(a);t&&!t.has(a)&&t.set(a,e.style[c]),e.style[c]=r})}function k_(e,n){n.forEach((t,r)=>{const a=Zz(r);e.style[a]=""})}function qM(e){return Array.isArray(e)?1==e.length?e[0]:g8(e):e}const Yz=new RegExp("{{\\s*(.+?)\\s*}}","g");function G$(e){let n=[];if("string"==typeof e){let t;for(;t=Yz.exec(e);)n.push(t[1]);Yz.lastIndex=0}return n}function YM(e,n,t){const r=e.toString(),a=r.replace(Yz,(c,h)=>{let f=n[h];return null==f&&(t.push(function lct(e){return new Rt(3003,!1)}()),f=""),f.toString()});return a==r?e:a}function q2(e){const n=[];let t=e.next();for(;!t.done;)n.push(t.value),t=e.next();return n}const Yct=/-+([a-z0-9])/g;function Zz(e){return e.replace(Yct,(...n)=>n[1].toUpperCase())}function Ml(e,n,t){switch(n.type){case 7:return e.visitTrigger(n,t);case 0:return e.visitState(n,t);case 1:return e.visitTransition(n,t);case 2:return e.visitSequence(n,t);case 3:return e.visitGroup(n,t);case 4:return e.visitAnimate(n,t);case 5:return e.visitKeyframes(n,t);case 6:return e.visitStyle(n,t);case 8:return e.visitReference(n,t);case 9:return e.visitAnimateChild(n,t);case 10:return e.visitAnimateRef(n,t);case 11:return e.visitQuery(n,t);case 12:return e.visitStagger(n,t);default:throw function cct(e){return new Rt(3004,!1)}()}}function W$(e,n){return window.getComputedStyle(e)[n]}const Y2="*";function Kct(e,n){const t=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(r=>function Qct(e,n,t){if(":"==e[0]){const b=function Jct(e,n){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,r)=>parseFloat(r)>parseFloat(t);case":decrement":return(t,r)=>parseFloat(r)<parseFloat(t);default:return n.push(function Cct(e){return new Rt(3016,!1)}()),"* => *"}}(e,t);if("function"==typeof b)return void n.push(b);e=b}const r=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return t.push(function wct(e){return new Rt(3015,!1)}()),n;const a=r[1],c=r[2],h=r[3];n.push(q$(a,h));"<"==c[0]&&!(a==Y2&&h==Y2)&&n.push(q$(h,a))}(r,t,n)):t.push(e),t}const Z2=new Set(["true","1"]),X2=new Set(["false","0"]);function q$(e,n){const t=Z2.has(e)||X2.has(e),r=Z2.has(n)||X2.has(n);return(a,c)=>{let h=e==Y2||e==a,f=n==Y2||n==c;return!h&&t&&"boolean"==typeof a&&(h=a?Z2.has(e):X2.has(e)),!f&&r&&"boolean"==typeof c&&(f=c?Z2.has(n):X2.has(n)),h&&f}}const tdt=new RegExp("s*:selfs*,?","g");function Xz(e,n,t,r){return new edt(e).build(n,t,r)}class edt{constructor(n){this._driver=n}build(n,t,r){const a=new rdt(t);return this._resetContextStyleTimingState(a),Ml(this,qM(n),a)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,t){let r=t.queryCount=0,a=t.depCount=0;const c=[],h=[];return"@"==n.name.charAt(0)&&t.errors.push(function uct(){return new Rt(3006,!1)}()),n.definitions.forEach(f=>{if(this._resetContextStyleTimingState(t),0==f.type){const b=f,x=b.name;x.toString().split(/\s*,\s*/).forEach(M=>{b.name=M,c.push(this.visitState(b,t))}),b.name=x}else if(1==f.type){const b=this.visitTransition(f,t);r+=b.queryCount,a+=b.depCount,h.push(b)}else t.errors.push(function hct(){return new Rt(3007,!1)}())}),{type:7,name:n.name,states:c,transitions:h,queryCount:r,depCount:a,options:null}}visitState(n,t){const r=this.visitStyle(n.styles,t),a=n.options&&n.options.params||null;if(r.containsDynamicStyles){const c=new Set,h=a||{};r.styles.forEach(f=>{f instanceof Map&&f.forEach(b=>{G$(b).forEach(x=>{h.hasOwnProperty(x)||c.add(x)})})}),c.size&&(q2(c.values()),t.errors.push(function mct(e,n){return new Rt(3008,!1)}()))}return{type:0,name:n.name,style:r,options:a?{params:a}:null}}visitTransition(n,t){t.queryCount=0,t.depCount=0;const r=Ml(this,qM(n.animation),t);return{type:1,matchers:Kct(n.expr,t.errors),animation:r,queryCount:t.queryCount,depCount:t.depCount,options:S_(n.options)}}visitSequence(n,t){return{type:2,steps:n.steps.map(r=>Ml(this,r,t)),options:S_(n.options)}}visitGroup(n,t){const r=t.currentTime;let a=0;const c=n.steps.map(h=>{t.currentTime=r;const f=Ml(this,h,t);return a=Math.max(a,t.currentTime),f});return t.currentTime=a,{type:3,steps:c,options:S_(n.options)}}visitAnimate(n,t){const r=function sdt(e,n){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return Kz(W2(e,n).duration,0,"");const t=e;if(t.split(/\s+/).some(c=>"{"==c.charAt(0)&&"{"==c.charAt(1))){const c=Kz(0,0,"");return c.dynamic=!0,c.strValue=t,c}const a=W2(t,n);return Kz(a.duration,a.delay,a.easing)}(n.timings,t.errors);t.currentAnimateTimings=r;let a,c=n.styles?n.styles:oi({});if(5==c.type)a=this.visitKeyframes(c,t);else{let h=n.styles,f=!1;if(!h){f=!0;const x={};r.easing&&(x.easing=r.easing),h=oi(x)}t.currentTime+=r.duration+r.delay;const b=this.visitStyle(h,t);b.isEmptyStep=f,a=b}return t.currentAnimateTimings=null,{type:4,timings:r,style:a,options:null}}visitStyle(n,t){const r=this._makeStyleAst(n,t);return this._validateStyleAst(r,t),r}_makeStyleAst(n,t){const r=[],a=Array.isArray(n.styles)?n.styles:[n.styles];for(let f of a)"string"==typeof f?f===Ih?r.push(f):t.errors.push(new Rt(3002,!1)):r.push(H$(f));let c=!1,h=null;return r.forEach(f=>{if(f instanceof Map&&(f.has("easing")&&(h=f.get("easing"),f.delete("easing")),!c))for(let b of f.values())if(b.toString().indexOf("{{")>=0){c=!0;break}}),{type:6,styles:r,easing:h,offset:n.offset,containsDynamicStyles:c,options:null}}_validateStyleAst(n,t){const r=t.currentAnimateTimings;let a=t.currentTime,c=t.currentTime;r&&c>0&&(c-=r.duration+r.delay),n.styles.forEach(h=>{"string"!=typeof h&&h.forEach((f,b)=>{const x=t.collectedStyles.get(t.currentQuerySelector),M=x.get(b);let T=!0;M&&(c!=a&&c>=M.startTime&&a<=M.endTime&&(t.errors.push(function fct(e,n,t,r,a){return new Rt(3010,!1)}()),T=!1),c=M.startTime),T&&x.set(b,{startTime:c,endTime:a}),t.options&&function qct(e,n,t){const r=n.params||{},a=G$(e);a.length&&a.forEach(c=>{r.hasOwnProperty(c)||t.push(function act(e){return new Rt(3001,!1)}())})}(f,t.options,t.errors)})})}visitKeyframes(n,t){const r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function gct(){return new Rt(3011,!1)}()),r;let c=0;const h=[];let f=!1,b=!1,x=0;const M=n.steps.map(nt=>{const tt=this._makeStyleAst(nt,t);let _t=null!=tt.offset?tt.offset:function odt(e){if("string"==typeof e)return null;let n=null;if(Array.isArray(e))e.forEach(t=>{if(t instanceof Map&&t.has("offset")){const r=t;n=parseFloat(r.get("offset")),r.delete("offset")}});else if(e instanceof Map&&e.has("offset")){const t=e;n=parseFloat(t.get("offset")),t.delete("offset")}return n}(tt.styles),wt=0;return null!=_t&&(c++,wt=tt.offset=_t),b=b||wt<0||wt>1,f=f||wt<x,x=wt,h.push(wt),tt});b&&t.errors.push(function _ct(){return new Rt(3012,!1)}()),f&&t.errors.push(function bct(){return new Rt(3200,!1)}());const T=n.steps.length;let I=0;c>0&&c<T?t.errors.push(function yct(){return new Rt(3202,!1)}()):0==c&&(I=1/(T-1));const L=T-1,N=t.currentTime,V=t.currentAnimateTimings,$=V.duration;return M.forEach((nt,tt)=>{const _t=I>0?tt==L?1:I*tt:h[tt],wt=_t*$;t.currentTime=N+V.delay+wt,V.duration=wt,this._validateStyleAst(nt,t),nt.offset=_t,r.styles.push(nt)}),r}visitReference(n,t){return{type:8,animation:Ml(this,qM(n.animation),t),options:S_(n.options)}}visitAnimateChild(n,t){return t.depCount++,{type:9,options:S_(n.options)}}visitAnimateRef(n,t){return{type:10,animation:this.visitReference(n.animation,t),options:S_(n.options)}}visitQuery(n,t){const r=t.currentQuerySelector,a=n.options||{};t.queryCount++,t.currentQuery=n;const[c,h]=function idt(e){const n=!!e.split(/\s*,\s*/).find(t=>":self"==t);return n&&(e=e.replace(tdt,"")),e=e.replace(/@\*/g,G2).replace(/@\w+/g,t=>G2+"-"+t.slice(1)).replace(/:animating/g,Wz),[e,n]}(n.selector);t.currentQuerySelector=r.length?r+" "+c:c,Cl(t.collectedStyles,t.currentQuerySelector,new Map);const f=Ml(this,qM(n.animation),t);return t.currentQuery=null,t.currentQuerySelector=r,{type:11,selector:c,limit:a.limit||0,optional:!!a.optional,includeSelf:h,animation:f,originalSelector:n.selector,options:S_(n.options)}}visitStagger(n,t){t.currentQuery||t.errors.push(function vct(){return new Rt(3013,!1)}());const r="full"===n.timings?{duration:0,delay:0,easing:"full"}:W2(n.timings,t.errors,!0);return{type:12,animation:Ml(this,qM(n.animation),t),timings:r,options:null}}}class rdt{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function S_(e){return e?(e=WM(e)).params&&(e.params=function ndt(e){return e?WM(e):null}(e.params)):e={},e}function Kz(e,n,t){return{duration:e,delay:n,easing:t}}function Qz(e,n,t,r,a,c,h=null,f=!1){return{type:1,element:e,keyframes:n,preStyleProps:t,postStyleProps:r,duration:a,delay:c,totalTime:a+c,easing:h,subTimeline:f}}class K2{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,t){let r=this._map.get(n);r||this._map.set(n,r=[]),r.push(...t)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const cdt=new RegExp(":enter","g"),udt=new RegExp(":leave","g");function Jz(e,n,t,r,a,c=new Map,h=new Map,f,b,x=[]){return(new hdt).buildKeyframes(e,n,t,r,a,c,h,f,b,x)}class hdt{buildKeyframes(n,t,r,a,c,h,f,b,x,M=[]){x=x||new K2;const T=new t3(n,t,x,a,c,M,[]);T.options=b;const I=b.delay?Oh(b.delay):0;T.currentTimeline.delayNextStep(I),T.currentTimeline.setStyles([h],null,T.errors,b),Ml(this,r,T);const L=T.timelines.filter(N=>N.containsAnimation());if(L.length&&f.size){let N;for(let V=L.length-1;V>=0;V--){const $=L[V];if($.element===t){N=$;break}}N&&!N.allowOnlyTimelineStyles()&&N.setStyles([f],null,T.errors,b)}return L.length?L.map(N=>N.buildKeyframes()):[Qz(t,[],[],[],0,I,"",!1)]}visitTrigger(n,t){}visitState(n,t){}visitTransition(n,t){}visitAnimateChild(n,t){const r=t.subInstructions.get(t.element);if(r){const a=t.createSubContext(n.options),c=t.currentTimeline.currentTime,h=this._visitSubInstructions(r,a,a.options);c!=h&&t.transformIntoNewTimeline(h)}t.previousNode=n}visitAnimateRef(n,t){const r=t.createSubContext(n.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],t,r),this.visitReference(n.animation,r),t.transformIntoNewTimeline(r.currentTimeline.currentTime),t.previousNode=n}_applyAnimationRefDelays(n,t,r){for(const a of n){const c=a?.delay;if(c){const h="number"==typeof c?c:Oh(YM(c,a?.params??{},t.errors));r.delayNextStep(h)}}}_visitSubInstructions(n,t,r){let c=t.currentTimeline.currentTime;const h=null!=r.duration?Oh(r.duration):null,f=null!=r.delay?Oh(r.delay):null;return 0!==h&&n.forEach(b=>{const x=t.appendInstructionToTimeline(b,h,f);c=Math.max(c,x.duration+x.delay)}),c}visitReference(n,t){t.updateOptions(n.options,!0),Ml(this,n.animation,t),t.previousNode=n}visitSequence(n,t){const r=t.subContextCount;let a=t;const c=n.options;if(c&&(c.params||c.delay)&&(a=t.createSubContext(c),a.transformIntoNewTimeline(),null!=c.delay)){6==a.previousNode.type&&(a.currentTimeline.snapshotCurrentStyles(),a.previousNode=Q2);const h=Oh(c.delay);a.delayNextStep(h)}n.steps.length&&(n.steps.forEach(h=>Ml(this,h,a)),a.currentTimeline.applyStylesToKeyframe(),a.subContextCount>r&&a.transformIntoNewTimeline()),t.previousNode=n}visitGroup(n,t){const r=[];let a=t.currentTimeline.currentTime;const c=n.options&&n.options.delay?Oh(n.options.delay):0;n.steps.forEach(h=>{const f=t.createSubContext(n.options);c&&f.delayNextStep(c),Ml(this,h,f),a=Math.max(a,f.currentTimeline.currentTime),r.push(f.currentTimeline)}),r.forEach(h=>t.currentTimeline.mergeTimelineCollectedStyles(h)),t.transformIntoNewTimeline(a),t.previousNode=n}_visitTiming(n,t){if(n.dynamic){const r=n.strValue;return W2(t.params?YM(r,t.params,t.errors):r,t.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,t){const r=t.currentAnimateTimings=this._visitTiming(n.timings,t),a=t.currentTimeline;r.delay&&(t.incrementTime(r.delay),a.snapshotCurrentStyles());const c=n.style;5==c.type?this.visitKeyframes(c,t):(t.incrementTime(r.duration),this.visitStyle(c,t),a.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=n}visitStyle(n,t){const r=t.currentTimeline,a=t.currentAnimateTimings;!a&&r.hasCurrentStyleProperties()&&r.forwardFrame();const c=a&&a.easing||n.easing;n.isEmptyStep?r.applyEmptyStep(c):r.setStyles(n.styles,c,t.errors,t.options),t.previousNode=n}visitKeyframes(n,t){const r=t.currentAnimateTimings,a=t.currentTimeline.duration,c=r.duration,f=t.createSubContext().currentTimeline;f.easing=r.easing,n.styles.forEach(b=>{f.forwardTime((b.offset||0)*c),f.setStyles(b.styles,b.easing,t.errors,t.options),f.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(f),t.transformIntoNewTimeline(a+c),t.previousNode=n}visitQuery(n,t){const r=t.currentTimeline.currentTime,a=n.options||{},c=a.delay?Oh(a.delay):0;c&&(6===t.previousNode.type||0==r&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Q2);let h=r;const f=t.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!a.optional,t.errors);t.currentQueryTotal=f.length;let b=null;f.forEach((x,M)=>{t.currentQueryIndex=M;const T=t.createSubContext(n.options,x);c&&T.delayNextStep(c),x===t.element&&(b=T.currentTimeline),Ml(this,n.animation,T),T.currentTimeline.applyStylesToKeyframe(),h=Math.max(h,T.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(h),b&&(t.currentTimeline.mergeTimelineCollectedStyles(b),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=n}visitStagger(n,t){const r=t.parentContext,a=t.currentTimeline,c=n.timings,h=Math.abs(c.duration),f=h*(t.currentQueryTotal-1);let b=h*t.currentQueryIndex;switch(c.duration<0?"reverse":c.easing){case"reverse":b=f-b;break;case"full":b=r.currentStaggerTime}const M=t.currentTimeline;b&&M.delayNextStep(b);const T=M.currentTime;Ml(this,n.animation,t),t.previousNode=n,r.currentStaggerTime=a.currentTime-T+(a.startTime-r.currentTimeline.startTime)}}const Q2={};class t3{constructor(n,t,r,a,c,h,f,b){this._driver=n,this.element=t,this.subInstructions=r,this._enterClassName=a,this._leaveClassName=c,this.errors=h,this.timelines=f,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Q2,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=b||new J2(this._driver,t,0),f.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,t){if(!n)return;const r=n;let a=this.options;null!=r.duration&&(a.duration=Oh(r.duration)),null!=r.delay&&(a.delay=Oh(r.delay));const c=r.params;if(c){let h=a.params;h||(h=this.options.params={}),Object.keys(c).forEach(f=>{(!t||!h.hasOwnProperty(f))&&(h[f]=YM(c[f],h,this.errors))})}}_copyOptions(){const n={};if(this.options){const t=this.options.params;if(t){const r=n.params={};Object.keys(t).forEach(a=>{r[a]=t[a]})}}return n}createSubContext(n=null,t,r){const a=t||this.element,c=new t3(this._driver,a,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(a,r||0));return c.previousNode=this.previousNode,c.currentAnimateTimings=this.currentAnimateTimings,c.options=this._copyOptions(),c.updateOptions(n),c.currentQueryIndex=this.currentQueryIndex,c.currentQueryTotal=this.currentQueryTotal,c.parentContext=this,this.subContextCount++,c}transformIntoNewTimeline(n){return this.previousNode=Q2,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,t,r){const a={duration:t??n.duration,delay:this.currentTimeline.currentTime+(r??0)+n.delay,easing:""},c=new mdt(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,a,n.stretchStartingKeyframe);return this.timelines.push(c),a}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,t,r,a,c,h){let f=[];if(a&&f.push(this.element),n.length>0){n=(n=n.replace(cdt,"."+this._enterClassName)).replace(udt,"."+this._leaveClassName);let x=this._driver.query(this.element,n,1!=r);0!==r&&(x=r<0?x.slice(x.length+r,x.length):x.slice(0,r)),f.push(...x)}return!c&&0==f.length&&h.push(function xct(e){return new Rt(3014,!1)}()),f}}class J2{constructor(n,t,r,a){this._driver=n,this.element=t,this.startTime=r,this._elementTimelineStylesLookup=a,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+n),t&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,t){return this.applyStylesToKeyframe(),new J2(this._driver,n,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,t){this._localTimelineStyles.set(n,t),this._globalTimelineStyles.set(n,t),this._styleSummary.set(n,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[t,r]of this._globalTimelineStyles)this._backFill.set(t,r||Ih),this._currentKeyframe.set(t,Ih);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,t,r,a){t&&this._previousKeyframe.set("easing",t);const c=a&&a.params||{},h=function pdt(e,n){const t=new Map;let r;return e.forEach(a=>{if("*"===a){r=r||n.keys();for(let c of r)t.set(c,Ih)}else qp(a,t)}),t}(n,this._globalTimelineStyles);for(let[f,b]of h){const x=YM(b,c,r);this._pendingStyles.set(f,x),this._localTimelineStyles.has(f)||this._backFill.set(f,this._globalTimelineStyles.get(f)??Ih),this._updateStyle(f,x)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,t)=>{this._currentKeyframe.set(t,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,n)}))}snapshotCurrentStyles(){for(let[n,t]of this._localTimelineStyles)this._pendingStyles.set(n,t),this._updateStyle(n,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let t in this._currentKeyframe)n.push(t);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((t,r)=>{const a=this._styleSummary.get(r);(!a||t.time>a.time)&&this._updateStyle(r,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,t=new Set,r=1===this._keyframes.size&&0===this.duration;let a=[];this._keyframes.forEach((f,b)=>{const x=qp(f,new Map,this._backFill);x.forEach((M,T)=>{"!"===M?n.add(T):M===Ih&&t.add(T)}),r||x.set("offset",b/this.duration),a.push(x)});const c=n.size?q2(n.values()):[],h=t.size?q2(t.values()):[];if(r){const f=a[0],b=new Map(f);f.set("offset",0),b.set("offset",1),a=[f,b]}return Qz(this.element,a,c,h,this.duration,this.startTime,this.easing,!1)}}class mdt extends J2{constructor(n,t,r,a,c,h,f=!1){super(n,t,h.delay),this.keyframes=r,this.preStyleProps=a,this.postStyleProps=c,this._stretchStartingKeyframe=f,this.timings={duration:h.duration,delay:h.delay,easing:h.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:t,duration:r,easing:a}=this.timings;if(this._stretchStartingKeyframe&&t){const c=[],h=r+t,f=t/h,b=qp(n[0]);b.set("offset",0),c.push(b);const x=qp(n[0]);x.set("offset",X$(f)),c.push(x);const M=n.length-1;for(let T=1;T<=M;T++){let I=qp(n[T]);const L=I.get("offset");I.set("offset",X$((t+L*r)/h)),c.push(I)}r=h,t=0,a="",n=c}return Qz(this.element,n,this.preStyleProps,this.postStyleProps,r,t,a,!0)}}function X$(e,n=3){const t=Math.pow(10,n-1);return Math.round(e*t)/t}class e3{}const fdt=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class gdt extends e3{normalizePropertyName(n,t){return Zz(n)}normalizeStyleValue(n,t,r,a){let c="";const h=r.toString().trim();if(fdt.has(t)&&0!==r&&"0"!==r)if("number"==typeof r)c="px";else{const f=r.match(/^[+-]?[\d\.]+([a-z]*)$/);f&&0==f[1].length&&a.push(function dct(e,n){return new Rt(3005,!1)}())}return h+c}}function K$(e,n,t,r,a,c,h,f,b,x,M,T,I){return{type:0,element:e,triggerName:n,isRemovalTransition:a,fromState:t,fromStyles:c,toState:r,toStyles:h,timelines:f,queriedElements:b,preStyleProps:x,postStyleProps:M,totalTime:T,errors:I}}const n3={};class Q${constructor(n,t,r){this._triggerName=n,this.ast=t,this._stateStyles=r}match(n,t,r,a){return function _dt(e,n,t,r,a){return e.some(c=>c(n,t,r,a))}(this.ast.matchers,n,t,r,a)}buildStyles(n,t,r){let a=this._stateStyles.get("*");return void 0!==n&&(a=this._stateStyles.get(n?.toString())||a),a?a.buildStyles(t,r):new Map}build(n,t,r,a,c,h,f,b,x,M){const T=[],I=this.ast.options&&this.ast.options.params||n3,N=this.buildStyles(r,f&&f.params||n3,T),V=b&&b.params||n3,$=this.buildStyles(a,V,T),nt=new Set,tt=new Map,_t=new Map,wt="void"===a,Dt={params:bdt(V,I),delay:this.ast.options?.delay},Vt=M?[]:Jz(n,t,this.ast.animation,c,h,N,$,Dt,x,T);let ae=0;if(Vt.forEach(Fe=>{ae=Math.max(Fe.duration+Fe.delay,ae)}),T.length)return K$(t,this._triggerName,r,a,wt,N,$,[],[],tt,_t,ae,T);Vt.forEach(Fe=>{const Ai=Fe.element,Wi=Cl(tt,Ai,new Set);Fe.preStyleProps.forEach(zr=>Wi.add(zr));const dn=Cl(_t,Ai,new Set);Fe.postStyleProps.forEach(zr=>dn.add(zr)),Ai!==t&&nt.add(Ai)});const ee=q2(nt.values());return K$(t,this._triggerName,r,a,wt,N,$,Vt,ee,tt,_t,ae)}}function bdt(e,n){const t=WM(n);for(const r in e)e.hasOwnProperty(r)&&null!=e[r]&&(t[r]=e[r]);return t}class ydt{constructor(n,t,r){this.styles=n,this.defaultParams=t,this.normalizer=r}buildStyles(n,t){const r=new Map,a=WM(this.defaultParams);return Object.keys(n).forEach(c=>{const h=n[c];null!==h&&(a[c]=h)}),this.styles.styles.forEach(c=>{"string"!=typeof c&&c.forEach((h,f)=>{h&&(h=YM(h,a,t));const b=this.normalizer.normalizePropertyName(f,t);h=this.normalizer.normalizeStyleValue(f,b,h,t),r.set(f,h)})}),r}}class xdt{constructor(n,t,r){this.name=n,this.ast=t,this._normalizer=r,this.transitionFactories=[],this.states=new Map,t.states.forEach(a=>{this.states.set(a.name,new ydt(a.style,a.options&&a.options.params||{},r))}),J$(this.states,"true","1"),J$(this.states,"false","0"),t.transitions.forEach(a=>{this.transitionFactories.push(new Q$(n,a,this.states))}),this.fallbackTransition=function wdt(e,n,t){return new Q$(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(h,f)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,t,r,a){return this.transitionFactories.find(h=>h.match(n,t,r,a))||null}matchStyles(n,t,r){return this.fallbackTransition.buildStyles(n,t,r)}}function J$(e,n,t){e.has(n)?e.has(t)||e.set(t,e.get(n)):e.has(t)&&e.set(n,e.get(t))}const Cdt=new K2;class Mdt{constructor(n,t,r){this.bodyNode=n,this._driver=t,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,t){const r=[],c=Xz(this._driver,t,r,[]);if(r.length)throw function Tct(e){return new Rt(3503,!1)}();this._animations.set(n,c)}_buildPlayer(n,t,r){const a=n.element,c=F$(this._normalizer,n.keyframes,t,r);return this._driver.animate(a,c,n.duration,n.delay,n.easing,[],!0)}create(n,t,r={}){const a=[],c=this._animations.get(n);let h;const f=new Map;if(c?(h=Jz(this._driver,t,c,Gz,H2,new Map,new Map,r,Cdt,a),h.forEach(M=>{const T=Cl(f,M.element,new Map);M.postStyleProps.forEach(I=>T.set(I,null))})):(a.push(function Ect(){return new Rt(3300,!1)}()),h=[]),a.length)throw function Act(e){return new Rt(3504,!1)}();f.forEach((M,T)=>{M.forEach((I,L)=>{M.set(L,this._driver.computeStyle(T,L,Ih))})});const x=Wp(h.map(M=>{const T=f.get(M.element);return this._buildPlayer(M,new Map,T)}));return this._playersById.set(n,x),x.onDestroy(()=>this.destroy(n)),this.players.push(x),x}destroy(n){const t=this._getPlayer(n);t.destroy(),this._playersById.delete(n);const r=this.players.indexOf(t);r>=0&&this.players.splice(r,1)}_getPlayer(n){const t=this._playersById.get(n);if(!t)throw function Ict(e){return new Rt(3301,!1)}();return t}listen(n,t,r,a){const c=Uz(t,"","","");return Vz(this._getPlayer(n),r,c,a),()=>{}}command(n,t,r,a){if("register"==r)return void this.register(n,a[0]);if("create"==r)return void this.create(n,t,a[0]||{});const c=this._getPlayer(n);switch(r){case"play":c.play();break;case"pause":c.pause();break;case"reset":c.reset();break;case"restart":c.restart();break;case"finish":c.finish();break;case"init":c.init();break;case"setPosition":c.setPosition(parseFloat(a[0]));break;case"destroy":this.destroy(n)}}}const tG="ng-animate-queued",r3="ng-animate-disabled",Edt=[],eG={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Adt={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Kc="__ng_removed";class o3{get params(){return this.options.params}constructor(n,t=""){this.namespaceId=t;const r=n&&n.hasOwnProperty("value");if(this.value=function Odt(e){return e??null}(r?n.value:n),r){const c=WM(n);delete c.value,this.options=c}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const t=n.params;if(t){const r=this.options.params;Object.keys(t).forEach(a=>{null==r[a]&&(r[a]=t[a])})}}}const ZM="void",s3=new o3(ZM);class Idt{constructor(n,t,r){this.id=n,this.hostElement=t,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,uc(t,this._hostClassName)}listen(n,t,r,a){if(!this._triggers.has(t))throw function Rct(e,n){return new Rt(3302,!1)}();if(null==r||0==r.length)throw function Pct(e){return new Rt(3303,!1)}();if(!function Fdt(e){return"start"==e||"done"==e}(r))throw function Oct(e,n){return new Rt(3400,!1)}();const c=Cl(this._elementListeners,n,[]),h={name:t,phase:r,callback:a};c.push(h);const f=Cl(this._engine.statesByElement,n,new Map);return f.has(t)||(uc(n,$2),uc(n,$2+"-"+t),f.set(t,s3)),()=>{this._engine.afterFlush(()=>{const b=c.indexOf(h);b>=0&&c.splice(b,1),this._triggers.has(t)||f.delete(t)})}}register(n,t){return!this._triggers.has(n)&&(this._triggers.set(n,t),!0)}_getTrigger(n){const t=this._triggers.get(n);if(!t)throw function Fct(e){return new Rt(3401,!1)}();return t}trigger(n,t,r,a=!0){const c=this._getTrigger(t),h=new a3(this.id,t,n);let f=this._engine.statesByElement.get(n);f||(uc(n,$2),uc(n,$2+"-"+t),this._engine.statesByElement.set(n,f=new Map));let b=f.get(t);const x=new o3(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&b&&x.absorbOptions(b.options),f.set(t,x),b||(b=s3),x.value!==ZM&&b.value===x.value){if(!function Ndt(e,n){const t=Object.keys(e),r=Object.keys(n);if(t.length!=r.length)return!1;for(let a=0;a<t.length;a++){const c=t[a];if(!n.hasOwnProperty(c)||e[c]!==n[c])return!1}return!0}(b.params,x.params)){const V=[],$=c.matchStyles(b.value,b.params,V),nt=c.matchStyles(x.value,x.params,V);V.length?this._engine.reportError(V):this._engine.afterFlush(()=>{k_(n,$),Xd(n,nt)})}return}const I=Cl(this._engine.playersByElement,n,[]);I.forEach(V=>{V.namespaceId==this.id&&V.triggerName==t&&V.queued&&V.destroy()});let L=c.matchTransition(b.value,x.value,n,x.params),N=!1;if(!L){if(!a)return;L=c.fallbackTransition,N=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:t,transition:L,fromState:b,toState:x,player:h,isFallbackTransition:N}),N||(uc(n,tG),h.onStart(()=>{e0(n,tG)})),h.onDone(()=>{let V=this.players.indexOf(h);V>=0&&this.players.splice(V,1);const $=this._engine.playersByElement.get(n);if($){let nt=$.indexOf(h);nt>=0&&$.splice(nt,1)}}),this.players.push(h),I.push(h),h}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(t=>t.delete(n)),this._elementListeners.forEach((t,r)=>{this._elementListeners.set(r,t.filter(a=>a.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const t=this._engine.playersByElement.get(n);t&&(t.forEach(r=>r.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,t){const r=this._engine.driver.query(n,G2,!0);r.forEach(a=>{if(a[Kc])return;const c=this._engine.fetchNamespacesByElement(a);c.size?c.forEach(h=>h.triggerLeaveAnimation(a,t,!1,!0)):this.clearElementCache(a)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(a=>this.clearElementCache(a)))}triggerLeaveAnimation(n,t,r,a){const c=this._engine.statesByElement.get(n),h=new Map;if(c){const f=[];if(c.forEach((b,x)=>{if(h.set(x,b.value),this._triggers.has(x)){const M=this.trigger(n,x,ZM,a);M&&f.push(M)}}),f.length)return this._engine.markElementAsRemoved(this.id,n,!0,t,h),r&&Wp(f).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const t=this._elementListeners.get(n),r=this._engine.statesByElement.get(n);if(t&&r){const a=new Set;t.forEach(c=>{const h=c.name;if(a.has(h))return;a.add(h);const b=this._triggers.get(h).fallbackTransition,x=r.get(h)||s3,M=new o3(ZM),T=new a3(this.id,h,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:h,transition:b,fromState:x,toState:M,player:T,isFallbackTransition:!0})})}}removeNode(n,t){const r=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,t),this.triggerLeaveAnimation(n,t,!0))return;let a=!1;if(r.totalAnimations){const c=r.players.length?r.playersByQueriedElement.get(n):[];if(c&&c.length)a=!0;else{let h=n;for(;h=h.parentNode;)if(r.statesByElement.get(h)){a=!0;break}}}if(this.prepareLeaveAnimationListeners(n),a)r.markElementAsRemoved(this.id,n,!1,t);else{const c=n[Kc];(!c||c===eG)&&(r.afterFlush(()=>this.clearElementCache(n)),r.destroyInnerAnimations(n),r._onRemovalComplete(n,t))}}insertNode(n,t){uc(n,this._hostClassName)}drainQueuedTransitions(n){const t=[];return this._queue.forEach(r=>{const a=r.player;if(a.destroyed)return;const c=r.element,h=this._elementListeners.get(c);h&&h.forEach(f=>{if(f.name==r.triggerName){const b=Uz(c,r.triggerName,r.fromState.value,r.toState.value);b._data=n,Vz(r.player,f.phase,b,f.callback)}}),a.markedForDestroy?this._engine.afterFlush(()=>{a.destroy()}):t.push(r)}),this._queue=[],t.sort((r,a)=>{const c=r.transition.ast.depCount,h=a.transition.ast.depCount;return 0==c||0==h?c-h:this._engine.driver.containsElement(r.element,a.element)?1:-1})}destroy(n){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class Rdt{_onRemovalComplete(n,t){this.onRemovalComplete(n,t)}constructor(n,t,r){this.bodyNode=n,this.driver=t,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(a,c)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(t=>{t.players.forEach(r=>{r.queued&&n.push(r)})}),n}createNamespace(n,t){const r=new Idt(n,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(r,t):(this.newHostElements.set(t,r),this.collectEnterElement(t)),this._namespaceLookup[n]=r}_balanceNamespaceList(n,t){const r=this._namespaceList,a=this.namespacesByHostElement;if(r.length-1>=0){let h=!1,f=this.driver.getParentElement(t);for(;f;){const b=a.get(f);if(b){const x=r.indexOf(b);r.splice(x+1,0,n),h=!0;break}f=this.driver.getParentElement(f)}h||r.unshift(n)}else r.push(n);return a.set(t,n),n}register(n,t){let r=this._namespaceLookup[n];return r||(r=this.createNamespace(n,t)),r}registerTrigger(n,t,r){let a=this._namespaceLookup[n];a&&a.register(t,r)&&this.totalAnimations++}destroy(n,t){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const r=this._fetchNamespace(n);this.namespacesByHostElement.delete(r.hostElement);const a=this._namespaceList.indexOf(r);a>=0&&this._namespaceList.splice(a,1),r.destroy(t),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const t=new Set,r=this.statesByElement.get(n);if(r)for(let a of r.values())if(a.namespaceId){const c=this._fetchNamespace(a.namespaceId);c&&t.add(c)}return t}trigger(n,t,r,a){if(tR(t)){const c=this._fetchNamespace(n);if(c)return c.trigger(t,r,a),!0}return!1}insertNode(n,t,r,a){if(!tR(t))return;const c=t[Kc];if(c&&c.setForRemoval){c.setForRemoval=!1,c.setForMove=!0;const h=this.collectedLeaveElements.indexOf(t);h>=0&&this.collectedLeaveElements.splice(h,1)}if(n){const h=this._fetchNamespace(n);h&&h.insertNode(t,r)}a&&this.collectEnterElement(t)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,t){t?this.disabledNodes.has(n)||(this.disabledNodes.add(n),uc(n,r3)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),e0(n,r3))}removeNode(n,t,r){if(tR(t)){const a=n?this._fetchNamespace(n):null;a?a.removeNode(t,r):this.markElementAsRemoved(n,t,!1,r);const c=this.namespacesByHostElement.get(t);c&&c.id!==n&&c.removeNode(t,r)}else this._onRemovalComplete(t,r)}markElementAsRemoved(n,t,r,a,c){this.collectedLeaveElements.push(t),t[Kc]={namespaceId:n,setForRemoval:a,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:c}}listen(n,t,r,a,c){return tR(t)?this._fetchNamespace(n).listen(t,r,a,c):()=>{}}_buildInstruction(n,t,r,a,c){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,r,a,n.fromState.options,n.toState.options,t,c)}destroyInnerAnimations(n){let t=this.driver.query(n,G2,!0);t.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(n,Wz,!0),t.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(n){const t=this.playersByElement.get(n);t&&t.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(n){const t=this.playersByQueriedElement.get(n);t&&t.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return Wp(this.players).onDone(()=>n());n()})}processLeaveNode(n){const t=n[Kc];if(t&&t.setForRemoval){if(n[Kc]=eG,t.namespaceId){this.destroyInnerAnimations(n);const r=this._fetchNamespace(t.namespaceId);r&&r.clearElementCache(n)}this._onRemovalComplete(n,t.setForRemoval)}n.classList?.contains(r3)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(n=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,a)=>this._balanceNamespaceList(r,a)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)uc(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{t=this._flushAnimations(r,n)}finally{for(let a=0;a<r.length;a++)r[a]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],t.length?Wp(t).onDone(()=>{r.forEach(a=>a())}):r.forEach(a=>a())}}reportError(n){throw function Lct(e){return new Rt(3402,!1)}()}_flushAnimations(n,t){const r=new K2,a=[],c=new Map,h=[],f=new Map,b=new Map,x=new Map,M=new Set;this.disabledNodes.forEach(xe=>{M.add(xe);const Pe=this.driver.query(xe,".ng-animate-queued",!0);for(let si=0;si<Pe.length;si++)M.add(Pe[si])});const T=this.bodyNode,I=Array.from(this.statesByElement.keys()),L=rG(I,this.collectedEnterElements),N=new Map;let V=0;L.forEach((xe,Pe)=>{const si=Gz+V++;N.set(Pe,si),xe.forEach(Li=>uc(Li,si))});const $=[],nt=new Set,tt=new Set;for(let xe=0;xe<this.collectedLeaveElements.length;xe++){const Pe=this.collectedLeaveElements[xe],si=Pe[Kc];si&&si.setForRemoval&&($.push(Pe),nt.add(Pe),si.hasAnimation?this.driver.query(Pe,".ng-star-inserted",!0).forEach(Li=>nt.add(Li)):tt.add(Pe))}const _t=new Map,wt=rG(I,Array.from(nt));wt.forEach((xe,Pe)=>{const si=H2+V++;_t.set(Pe,si),xe.forEach(Li=>uc(Li,si))}),n.push(()=>{L.forEach((xe,Pe)=>{const si=N.get(Pe);xe.forEach(Li=>e0(Li,si))}),wt.forEach((xe,Pe)=>{const si=_t.get(Pe);xe.forEach(Li=>e0(Li,si))}),$.forEach(xe=>{this.processLeaveNode(xe)})});const Dt=[],Vt=[];for(let xe=this._namespaceList.length-1;xe>=0;xe--)this._namespaceList[xe].drainQueuedTransitions(t).forEach(si=>{const Li=si.player,Vr=si.element;if(Dt.push(Li),this.collectedEnterElements.length){const Qs=Vr[Kc];if(Qs&&Qs.setForMove){if(Qs.previousTriggersValues&&Qs.previousTriggersValues.has(si.triggerName)){const A_=Qs.previousTriggersValues.get(si.triggerName),hc=this.statesByElement.get(si.element);if(hc&&hc.has(si.triggerName)){const fR=hc.get(si.triggerName);fR.value=A_,hc.set(si.triggerName,fR)}}return void Li.destroy()}}const ya=!T||!this.driver.containsElement(T,Vr),Oo=_t.get(Vr),za=N.get(Vr),Jn=this._buildInstruction(si,r,za,Oo,ya);if(Jn.errors&&Jn.errors.length)return void Vt.push(Jn);if(ya)return Li.onStart(()=>k_(Vr,Jn.fromStyles)),Li.onDestroy(()=>Xd(Vr,Jn.toStyles)),void a.push(Li);if(si.isFallbackTransition)return Li.onStart(()=>k_(Vr,Jn.fromStyles)),Li.onDestroy(()=>Xd(Vr,Jn.toStyles)),void a.push(Li);const Xp=[];Jn.timelines.forEach(Qs=>{Qs.stretchStartingKeyframe=!0,this.disabledNodes.has(Qs.element)||Xp.push(Qs)}),Jn.timelines=Xp,r.append(Vr,Jn.timelines),h.push({instruction:Jn,player:Li,element:Vr}),Jn.queriedElements.forEach(Qs=>Cl(f,Qs,[]).push(Li)),Jn.preStyleProps.forEach((Qs,A_)=>{if(Qs.size){let hc=b.get(A_);hc||b.set(A_,hc=new Set),Qs.forEach((fR,R3)=>hc.add(R3))}}),Jn.postStyleProps.forEach((Qs,A_)=>{let hc=x.get(A_);hc||x.set(A_,hc=new Set),Qs.forEach((fR,R3)=>hc.add(R3))})});if(Vt.length){const xe=[];Vt.forEach(Pe=>{xe.push(function Bct(e,n){return new Rt(3505,!1)}())}),Dt.forEach(Pe=>Pe.destroy()),this.reportError(xe)}const ae=new Map,ee=new Map;h.forEach(xe=>{const Pe=xe.element;r.has(Pe)&&(ee.set(Pe,Pe),this._beforeAnimationBuild(xe.player.namespaceId,xe.instruction,ae))}),a.forEach(xe=>{const Pe=xe.element;this._getPreviousPlayers(Pe,!1,xe.namespaceId,xe.triggerName,null).forEach(Li=>{Cl(ae,Pe,[]).push(Li),Li.destroy()})});const Fe=$.filter(xe=>sG(xe,b,x)),Ai=new Map;nG(Ai,this.driver,tt,x,Ih).forEach(xe=>{sG(xe,b,x)&&Fe.push(xe)});const dn=new Map;L.forEach((xe,Pe)=>{nG(dn,this.driver,new Set(xe),b,"!")}),Fe.forEach(xe=>{const Pe=Ai.get(xe),si=dn.get(xe);Ai.set(xe,new Map([...Pe?.entries()??[],...si?.entries()??[]]))});const zr=[],Ks=[],Qn={};h.forEach(xe=>{const{element:Pe,player:si,instruction:Li}=xe;if(r.has(Pe)){if(M.has(Pe))return si.onDestroy(()=>Xd(Pe,Li.toStyles)),si.disabled=!0,si.overrideTotalTime(Li.totalTime),void a.push(si);let Vr=Qn;if(ee.size>1){let Oo=Pe;const za=[];for(;Oo=Oo.parentNode;){const Jn=ee.get(Oo);if(Jn){Vr=Jn;break}za.push(Oo)}za.forEach(Jn=>ee.set(Jn,Vr))}const ya=this._buildAnimation(si.namespaceId,Li,ae,c,dn,Ai);if(si.setRealPlayer(ya),Vr===Qn)zr.push(si);else{const Oo=this.playersByElement.get(Vr);Oo&&Oo.length&&(si.parentPlayer=Wp(Oo)),a.push(si)}}else k_(Pe,Li.fromStyles),si.onDestroy(()=>Xd(Pe,Li.toStyles)),Ks.push(si),M.has(Pe)&&a.push(si)}),Ks.forEach(xe=>{const Pe=c.get(xe.element);if(Pe&&Pe.length){const si=Wp(Pe);xe.setRealPlayer(si)}}),a.forEach(xe=>{xe.parentPlayer?xe.syncPlayerEvents(xe.parentPlayer):xe.destroy()});for(let xe=0;xe<$.length;xe++){const Pe=$[xe],si=Pe[Kc];if(e0(Pe,H2),si&&si.hasAnimation)continue;let Li=[];if(f.size){let ya=f.get(Pe);ya&&ya.length&&Li.push(...ya);let Oo=this.driver.query(Pe,Wz,!0);for(let za=0;za<Oo.length;za++){let Jn=f.get(Oo[za]);Jn&&Jn.length&&Li.push(...Jn)}}const Vr=Li.filter(ya=>!ya.destroyed);Vr.length?Ldt(this,Pe,Vr):this.processLeaveNode(Pe)}return $.length=0,zr.forEach(xe=>{this.players.push(xe),xe.onDone(()=>{xe.destroy();const Pe=this.players.indexOf(xe);this.players.splice(Pe,1)}),xe.play()}),zr}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,t,r,a,c){let h=[];if(t){const f=this.playersByQueriedElement.get(n);f&&(h=f)}else{const f=this.playersByElement.get(n);if(f){const b=!c||c==ZM;f.forEach(x=>{x.queued||!b&&x.triggerName!=a||h.push(x)})}}return(r||a)&&(h=h.filter(f=>!(r&&r!=f.namespaceId||a&&a!=f.triggerName))),h}_beforeAnimationBuild(n,t,r){const c=t.element,h=t.isRemovalTransition?void 0:n,f=t.isRemovalTransition?void 0:t.triggerName;for(const b of t.timelines){const x=b.element,M=x!==c,T=Cl(r,x,[]);this._getPreviousPlayers(x,M,h,f,t.toState).forEach(L=>{const N=L.getRealPlayer();N.beforeDestroy&&N.beforeDestroy(),L.destroy(),T.push(L)})}k_(c,t.fromStyles)}_buildAnimation(n,t,r,a,c,h){const f=t.triggerName,b=t.element,x=[],M=new Set,T=new Set,I=t.timelines.map(N=>{const V=N.element;M.add(V);const $=V[Kc];if($&&$.removedBeforeQueried)return new FM(N.duration,N.delay);const nt=V!==b,tt=function Bdt(e){const n=[];return oG(e,n),n}((r.get(V)||Edt).map(ae=>ae.getRealPlayer())).filter(ae=>!!ae.element&&ae.element===V),_t=c.get(V),wt=h.get(V),Dt=F$(this._normalizer,N.keyframes,_t,wt),Vt=this._buildPlayer(N,Dt,tt);if(N.subTimeline&&a&&T.add(V),nt){const ae=new a3(n,f,V);ae.setRealPlayer(Vt),x.push(ae)}return Vt});x.forEach(N=>{Cl(this.playersByQueriedElement,N.element,[]).push(N),N.onDone(()=>function Pdt(e,n,t){let r=e.get(n);if(r){if(r.length){const a=r.indexOf(t);r.splice(a,1)}0==r.length&&e.delete(n)}return r}(this.playersByQueriedElement,N.element,N))}),M.forEach(N=>uc(N,U$));const L=Wp(I);return L.onDestroy(()=>{M.forEach(N=>e0(N,U$)),Xd(b,t.toStyles)}),T.forEach(N=>{Cl(a,N,[]).push(L)}),L}_buildPlayer(n,t,r){return t.length>0?this.driver.animate(n.element,t,n.duration,n.delay,n.easing,r):new FM(n.duration,n.delay)}}class a3{constructor(n,t,r){this.namespaceId=n,this.triggerName=t,this.element=r,this._player=new FM,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((t,r)=>{t.forEach(a=>Vz(n,r,void 0,a))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const t=this._player;t.triggerCallback&&n.onStart(()=>t.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,t){Cl(this._queuedCallbacks,n,[]).push(t)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const t=this._player;t.triggerCallback&&t.triggerCallback(n)}}function tR(e){return e&&1===e.nodeType}function iG(e,n){const t=e.style.display;return e.style.display=n??"none",t}function nG(e,n,t,r,a){const c=[];t.forEach(b=>c.push(iG(b)));const h=[];r.forEach((b,x)=>{const M=new Map;b.forEach(T=>{const I=n.computeStyle(x,T,a);M.set(T,I),(!I||0==I.length)&&(x[Kc]=Adt,h.push(x))}),e.set(x,M)});let f=0;return t.forEach(b=>iG(b,c[f++])),h}function rG(e,n){const t=new Map;if(e.forEach(f=>t.set(f,[])),0==n.length)return t;const a=new Set(n),c=new Map;function h(f){if(!f)return 1;let b=c.get(f);if(b)return b;const x=f.parentNode;return b=t.has(x)?x:a.has(x)?1:h(x),c.set(f,b),b}return n.forEach(f=>{const b=h(f);1!==b&&t.get(b).push(f)}),t}function uc(e,n){e.classList?.add(n)}function e0(e,n){e.classList?.remove(n)}function Ldt(e,n,t){Wp(t).onDone(()=>e.processLeaveNode(n))}function oG(e,n){for(let t=0;t<e.length;t++){const r=e[t];r instanceof _8?oG(r.players,n):n.push(r)}}function sG(e,n,t){const r=t.get(e);if(!r)return!1;let a=n.get(e);return a?r.forEach(c=>a.add(c)):n.set(e,r),t.delete(e),!0}class eR{constructor(n,t,r){this.bodyNode=n,this._driver=t,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(a,c)=>{},this._transitionEngine=new Rdt(n,t,r),this._timelineEngine=new Mdt(n,t,r),this._transitionEngine.onRemovalComplete=(a,c)=>this.onRemovalComplete(a,c)}registerTrigger(n,t,r,a,c){const h=n+"-"+a;let f=this._triggerCache[h];if(!f){const b=[],M=Xz(this._driver,c,b,[]);if(b.length)throw function kct(e,n){return new Rt(3404,!1)}();f=function vdt(e,n,t){return new xdt(e,n,t)}(a,M,this._normalizer),this._triggerCache[h]=f}this._transitionEngine.registerTrigger(t,a,f)}register(n,t){this._transitionEngine.register(n,t)}destroy(n,t){this._transitionEngine.destroy(n,t)}onInsert(n,t,r,a){this._transitionEngine.insertNode(n,t,r,a)}onRemove(n,t,r){this._transitionEngine.removeNode(n,t,r)}disableAnimations(n,t){this._transitionEngine.markElementAsDisabled(n,t)}process(n,t,r,a){if("@"==r.charAt(0)){const[c,h]=L$(r);this._timelineEngine.command(c,t,h,a)}else this._transitionEngine.trigger(n,t,r,a)}listen(n,t,r,a,c){if("@"==r.charAt(0)){const[h,f]=L$(r);return this._timelineEngine.listen(h,t,f,c)}return this._transitionEngine.listen(n,t,r,a,c)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}let Vdt=(()=>{class e{static#t=this.initialStylesByElement=new WeakMap;constructor(t,r,a){this._element=t,this._startStyles=r,this._endStyles=a,this._state=0;let c=e.initialStylesByElement.get(t);c||e.initialStylesByElement.set(t,c=new Map),this._initialStyles=c}start(){this._state<1&&(this._startStyles&&Xd(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Xd(this._element,this._initialStyles),this._endStyles&&(Xd(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(k_(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(k_(this._element,this._endStyles),this._endStyles=null),Xd(this._element,this._initialStyles),this._state=3)}}return e})();function l3(e){let n=null;return e.forEach((t,r)=>{(function jdt(e){return"display"===e||"position"===e})(r)&&(n=n||new Map,n.set(r,t))}),n}class aG{constructor(n,t,r,a){this.element=n,this.keyframes=t,this.options=r,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map;const t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const t=[];return n.forEach(r=>{t.push(Object.fromEntries(r))}),t}_triggerWebAnimation(n,t,r){return n.animate(this._convertKeyframesToObject(t),r)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,a)=>{"offset"!==a&&n.set(a,this._finished?r:W$(this.element,a))}),this.currentSnapshot=n}triggerCallback(n){const t="start"===n?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}class Udt{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,t){return!1}containsElement(n,t){return N$(n,t)}getParentElement(n){return Hz(n)}query(n,t,r){return z$(n,t,r)}computeStyle(n,t,r){return window.getComputedStyle(n)[t]}animate(n,t,r,a,c,h=[]){const b={duration:r,delay:a,fill:0==a?"both":"forwards"};c&&(b.easing=c);const x=new Map,M=h.filter(L=>L instanceof aG);(function Zct(e,n){return 0===e||0===n})(r,a)&&M.forEach(L=>{L.currentSnapshot.forEach((N,V)=>x.set(V,N))});let T=function Wct(e){return e.length?e[0]instanceof Map?e:e.map(n=>H$(n)):[]}(t).map(L=>qp(L));T=function Xct(e,n,t){if(t.size&&n.length){let r=n[0],a=[];if(t.forEach((c,h)=>{r.has(h)||a.push(h),r.set(h,c)}),a.length)for(let c=1;c<n.length;c++){let h=n[c];a.forEach(f=>h.set(f,W$(e,f)))}}return n}(n,T,x);const I=function zdt(e,n){let t=null,r=null;return Array.isArray(n)&&n.length?(t=l3(n[0]),n.length>1&&(r=l3(n[n.length-1]))):n instanceof Map&&(t=l3(n)),t||r?new Vdt(e,t,r):null}(n,T);return new aG(n,T,b,I)}}let Hdt=(()=>{class e extends f8{constructor(t,r){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(r.body,{id:"0",encapsulation:ea.None,styles:[],data:{animation:[]}})}build(t){const r=this._nextAnimationId.toString();this._nextAnimationId++;const a=Array.isArray(t)?g8(t):t;return lG(this._renderer,null,r,"register",[a]),new $dt(r,this._renderer)}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ag),vt(ki))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();class $dt extends grt{constructor(n,t){super(),this._id=n,this._renderer=t}create(n,t){return new Gdt(this._id,n,t||{},this._renderer)}}class Gdt{constructor(n,t,r,a){this.id=n,this.element=t,this._renderer=a,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(n,t){return this._renderer.listen(this.element,`@@${this.id}:${n}`,t)}_command(n,...t){return lG(this._renderer,this.element,this.id,n,t)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function lG(e,n,t,r,a){return e.setProperty(n,`@@${t}:${r}`,a)}const cG="@.disabled";let Wdt=(()=>{class e{constructor(t,r,a){this.delegate=t,this.engine=r,this._zone=a,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,r.onRemovalComplete=(c,h)=>{const f=h?.parentNode(c);f&&h.removeChild(f,c)}}createRenderer(t,r){const c=this.delegate.createRenderer(t,r);if(!(t&&r&&r.data&&r.data.animation)){let M=this._rendererCache.get(c);return M||(M=new dG("",c,this.engine,()=>this._rendererCache.delete(c)),this._rendererCache.set(c,M)),M}const h=r.id,f=r.id+"-"+this._currentId;this._currentId++,this.engine.register(f,t);const b=M=>{Array.isArray(M)?M.forEach(b):this.engine.registerTrigger(h,f,t,M.name,M)};return r.data.animation.forEach(b),new qdt(this,f,c,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,r,a){t>=0&&t<this._microtaskId?this._zone.run(()=>r(a)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(c=>{const[h,f]=c;h(f)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,a]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ag),vt(eR),vt(Re))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();class dG{constructor(n,t,r,a){this.namespaceId=n,this.delegate=t,this.engine=r,this._onDestroy=a}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,t){return this.delegate.createElement(n,t)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,t){this.delegate.appendChild(n,t),this.engine.onInsert(this.namespaceId,t,n,!1)}insertBefore(n,t,r,a=!0){this.delegate.insertBefore(n,t,r),this.engine.onInsert(this.namespaceId,t,n,a)}removeChild(n,t,r){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(n,t){return this.delegate.selectRootElement(n,t)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,t,r,a){this.delegate.setAttribute(n,t,r,a)}removeAttribute(n,t,r){this.delegate.removeAttribute(n,t,r)}addClass(n,t){this.delegate.addClass(n,t)}removeClass(n,t){this.delegate.removeClass(n,t)}setStyle(n,t,r,a){this.delegate.setStyle(n,t,r,a)}removeStyle(n,t,r){this.delegate.removeStyle(n,t,r)}setProperty(n,t,r){"@"==t.charAt(0)&&t==cG?this.disableAnimations(n,!!r):this.delegate.setProperty(n,t,r)}setValue(n,t){this.delegate.setValue(n,t)}listen(n,t,r){return this.delegate.listen(n,t,r)}disableAnimations(n,t){this.engine.disableAnimations(n,t)}}class qdt extends dG{constructor(n,t,r,a,c){super(t,r,a,c),this.factory=n,this.namespaceId=t}setProperty(n,t,r){"@"==t.charAt(0)?"."==t.charAt(1)&&t==cG?this.disableAnimations(n,r=void 0===r||!!r):this.engine.process(this.namespaceId,n,t.slice(1),r):this.delegate.setProperty(n,t,r)}listen(n,t,r){if("@"==t.charAt(0)){const a=function Ydt(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(n);let c=t.slice(1),h="";return"@"!=c.charAt(0)&&([c,h]=function Zdt(e){const n=e.indexOf(".");return[e.substring(0,n),e.slice(n+1)]}(c)),this.engine.listen(this.namespaceId,a,c,h,f=>{this.factory.scheduleListenerCallback(f._data||-1,r,f)})}return this.delegate.listen(n,t,r)}}let Xdt=(()=>{class e extends eR{constructor(t,r,a,c){super(t.body,r,a)}ngOnDestroy(){this.flush()}static#t=this.\u0275fac=function(r){return new(r||e)(vt(ki),vt($z),vt(e3),vt(Q))};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac})}return e})();const uG=[{provide:f8,useClass:Hdt},{provide:e3,useFactory:function Kdt(){return new gdt}},{provide:eR,useClass:Xdt},{provide:ag,useFactory:function Qdt(e,n,t){return new Wdt(e,n,t)},deps:[$L,eR,Re]}],c3=[{provide:$z,useFactory:()=>new Udt},{provide:Pr,useValue:"BrowserAnimations"},...uG],hG=[{provide:$z,useClass:V$},{provide:Pr,useValue:"NoopAnimations"},...uG];let Jdt=(()=>{class e{static withConfig(t){return{ngModule:e,providers:t.disableAnimations?hG:c3}}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:c3,imports:[c4]})}return e})();const sut={provide:new kt("mat-autocomplete-scroll-strategy"),deps:[_a],useFactory:function out(e){return()=>e.scrollStrategies.reposition()}};let cut=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[sut],imports:[jp,h2,yi,ws,Sh,h2,yi]})}return e})(),dut=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[ZH,yi,Vp,yi]})}return e})(),_ut=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,Ah,yi]})}return e})(),Mut=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,ws,yi]})}return e})(),xG=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({})}return e})(),But=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,Ah,xG,yi,xG]})}return e})();const nR=new kt("mat-chips-default-options");let mht=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[u2,{provide:nR,useValue:{separatorKeyCodes:[13]}}],imports:[yi,ws,Ah,yi]})}return e})(),EG=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,yi]})}return e})(),ght=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[JH,yi,JH,yi]})}return e})(),Wht=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[r2,ws,yi,Ah,o8,EG]})}return e})();const Xht={provide:new kt("mat-menu-scroll-strategy"),deps:[_a],useFactory:function Zht(e){return()=>e.scrollStrategies.reposition()}};let Kht=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({providers:[Xht],imports:[ws,Ah,yi,jp,Sh,yi]})}return e})(),cmt=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[yi,ws,Ah,yi]})}return e})(),pmt=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[ws,yi,Vp,Ah,r2,c2,yi]})}return e})(),ymt=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({})}return e})(),Dmt=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[ymt,yi,yi]})}return e})(),Tmt=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({imports:[jp,Vp,ws,_2,yi,yi]})}return e})();const lR=function Rmt(e,n){return e===n||e!=e&&n!=n},cR=function Pmt(e,n){for(var t=e.length;t--;)if(lR(e[t][0],n))return t;return-1};var Fmt=Array.prototype.splice;function o0(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var r=e[n];this.set(r[0],r[1])}}o0.prototype.clear=function Amt(){this.__data__=[],this.size=0},o0.prototype.delete=function Lmt(e){var n=this.__data__,t=cR(n,e);return!(t<0||(t==n.length-1?n.pop():Fmt.call(n,t,1),--this.size,0))},o0.prototype.get=function Nmt(e){var n=this.__data__,t=cR(n,e);return t<0?void 0:n[t][1]},o0.prototype.has=function Vmt(e){return cR(this.__data__,e)>-1},o0.prototype.set=function Umt(e,n){var t=this.__data__,r=cR(t,e);return r<0?(++this.size,t.push([e,n])):t[r][1]=n,this};const dR=o0,VG="object"==typeof global&&global&&global.Object===Object&&global;var Jmt="object"==typeof self&&self&&self.Object===Object&&self;const s0=VG||Jmt||Function("return this")();var ept=s0.Symbol,jG=Object.prototype,ipt=jG.hasOwnProperty,npt=jG.toString,KM=ept?ept.toStringTag:void 0;var apt=Object.prototype.toString;var UG=ept?ept.toStringTag:void 0;const hR=function hpt(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":UG&&UG in Object(e)?function rpt(e){var n=ipt.call(e,KM),t=e[KM];try{e[KM]=void 0;var r=!0}catch{}var a=npt.call(e);return r&&(n?e[KM]=t:delete e[KM]),a}(e):function lpt(e){return apt.call(e)}(e)},E_=function mpt(e){var n=typeof e;return null!=e&&("object"==n||"function"==n)},x3=function bpt(e){if(!E_(e))return!1;var n=hR(e);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n};var e,ypt=s0["__core-js_shared__"],HG=(e=/[^.]+$/.exec(ypt&&ypt.keys&&ypt.keys.IE_PROTO||""))?"Symbol(src)_1."+e:"";var Cpt=Function.prototype.toString;var Spt=/^\[object .+?Constructor\]$/,Rpt=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const Opt=function Ppt(e){return!(!E_(e)||function vpt(e){return!!HG&&HG in e}(e))&&(x3(e)?Rpt:Spt).test(function Mpt(e){if(null!=e){try{return Cpt.call(e)}catch{}try{return e+""}catch{}}return""}(e))},C3=function Bpt(e,n){var t=function Fpt(e,n){return e?.[n]}(e,n);return Opt(t)?t:void 0},$G=C3(s0,"Map"),QM=C3(Object,"create");var Wpt=Object.prototype.hasOwnProperty;var Xpt=Object.prototype.hasOwnProperty;function a0(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var r=e[n];this.set(r[0],r[1])}}a0.prototype.clear=function Vpt(){this.__data__=QM?QM(null):{},this.size=0},a0.prototype.delete=function Upt(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n},a0.prototype.get=function qpt(e){var n=this.__data__;if(QM){var t=n[e];return"__lodash_hash_undefined__"===t?void 0:t}return Wpt.call(n,e)?n[e]:void 0},a0.prototype.has=function Kpt(e){var n=this.__data__;return QM?void 0!==n[e]:Xpt.call(n,e)},a0.prototype.set=function tft(e,n){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=QM&&void 0===n?"__lodash_hash_undefined__":n,this};const GG=a0,mR=function sft(e,n){var t=e.__data__;return function rft(e){var n=typeof e;return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e}(n)?t["string"==typeof n?"string":"hash"]:t.map};function l0(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var r=e[n];this.set(r[0],r[1])}}l0.prototype.clear=function ift(){this.size=0,this.__data__={hash:new GG,map:new($G||dR),string:new GG}},l0.prototype.delete=function aft(e){var n=mR(this,e).delete(e);return this.size-=n?1:0,n},l0.prototype.get=function cft(e){return mR(this,e).get(e)},l0.prototype.has=function uft(e){return mR(this,e).has(e)},l0.prototype.set=function mft(e,n){var t=mR(this,e),r=t.size;return t.set(e,n),this.size+=t.size==r?0:1,this};const fft=l0;function c0(e){var n=this.__data__=new dR(e);this.size=n.size}c0.prototype.clear=function $mt(){this.__data__=new dR,this.size=0},c0.prototype.delete=function Wmt(e){var n=this.__data__,t=n.delete(e);return this.size=n.size,t},c0.prototype.get=function Ymt(e){return this.__data__.get(e)},c0.prototype.has=function Xmt(e){return this.__data__.has(e)},c0.prototype.set=function _ft(e,n){var t=this.__data__;if(t instanceof dR){var r=t.__data__;if(!$G||r.length<199)return r.push([e,n]),this.size=++t.size,this;t=this.__data__=new fft(r)}return t.set(e,n),this.size=t.size,this};const yft=c0;var vft=function(){try{var e=C3(Object,"defineProperty");return e({},"",{}),e}catch{}}();const pR=vft,M3=function xft(e,n,t){"__proto__"==n&&pR?pR(e,n,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[n]=t},D3=function wft(e,n,t){(void 0!==t&&!lR(e[n],t)||void 0===t&&!(n in e))&&M3(e,n,t)};var Mft=function Cft(e){return function(n,t,r){for(var a=-1,c=Object(n),h=r(n),f=h.length;f--;){var b=h[e?f:++a];if(!1===t(c[b],b,c))break}return n}}();const Dft=Mft;var WG="object"==typeof exports&&exports&&!exports.nodeType&&exports,qG=WG&&"object"==typeof module&&module&&!module.nodeType&&module,YG=qG&&qG.exports===WG?s0.Buffer:void 0,ZG=YG?YG.allocUnsafe:void 0;const XG=s0.Uint8Array,Pft=function Rft(e,n){var t=n?function Aft(e){var n=new e.constructor(e.byteLength);return new XG(n).set(new XG(e)),n}(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)};var KG=Object.create,Lft=function(){function e(){}return function(n){if(!E_(n))return{};if(KG)return KG(n);e.prototype=n;var t=new e;return e.prototype=void 0,t}}();const Bft=Lft;var zft=function Nft(e,n){return function(t){return e(n(t))}}(Object.getPrototypeOf,Object);const QG=zft;var Vft=Object.prototype;const JG=function jft(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||Vft)},JM=function $ft(e){return null!=e&&"object"==typeof e},tW=function Wft(e){return JM(e)&&"[object Arguments]"==hR(e)};var eW=Object.prototype,qft=eW.hasOwnProperty,Yft=eW.propertyIsEnumerable,Zft=tW(function(){return arguments}())?tW:function(e){return JM(e)&&qft.call(e,"callee")&&!Yft.call(e,"callee")};const k3=Zft,S3=Array.isArray,iW=function Qft(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},T3=function Jft(e){return null!=e&&iW(e.length)&&!x3(e)};var nW="object"==typeof exports&&exports&&!exports.nodeType&&exports,rW=nW&&"object"==typeof module&&module&&!module.nodeType&&module,oW=rW&&rW.exports===nW?s0.Buffer:void 0;const sW=(oW?oW.isBuffer:void 0)||function igt(){return!1};var aW=Function.prototype.toString,dgt=Object.prototype.hasOwnProperty,ugt=aW.call(Object);var Nr={};Nr["[object Float32Array]"]=Nr["[object Float64Array]"]=Nr["[object Int8Array]"]=Nr["[object Int16Array]"]=Nr["[object Int32Array]"]=Nr["[object Uint8Array]"]=Nr["[object Uint8ClampedArray]"]=Nr["[object Uint16Array]"]=Nr["[object Uint32Array]"]=!0,Nr["[object Arguments]"]=Nr["[object Array]"]=Nr["[object ArrayBuffer]"]=Nr["[object Boolean]"]=Nr["[object DataView]"]=Nr["[object Date]"]=Nr["[object Error]"]=Nr["[object Function]"]=Nr["[object Map]"]=Nr["[object Number]"]=Nr["[object Object]"]=Nr["[object RegExp]"]=Nr["[object Set]"]=Nr["[object String]"]=Nr["[object WeakMap]"]=!1;var lW="object"==typeof exports&&exports&&!exports.nodeType&&exports,tD=lW&&"object"==typeof module&&module&&!module.nodeType&&module,E3=tD&&tD.exports===lW&&VG.process,Hgt=function(){try{return tD&&tD.require&&tD.require("util").types||E3&&E3.binding&&E3.binding("util")}catch{}}(),dW=Hgt&&Hgt.isTypedArray;const uW=dW?function Vgt(e){return function(n){return e(n)}}(dW):function Ngt(e){return JM(e)&&iW(e.length)&&!!Nr[hR(e)]},A3=function Ggt(e,n){if(("constructor"!==n||"function"!=typeof e[n])&&"__proto__"!=n)return e[n]};var qgt=Object.prototype.hasOwnProperty;const Zgt=function Ygt(e,n,t){var r=e[n];(!qgt.call(e,n)||!lR(r,t)||void 0===t&&!(n in e))&&M3(e,n,t)};var e_t=/^(?:0|[1-9]\d*)$/;const hW=function i_t(e,n){var t=typeof e;return!!(n=n??9007199254740991)&&("number"==t||"symbol"!=t&&e_t.test(e))&&e>-1&&e%1==0&&e<n};var r_t=Object.prototype.hasOwnProperty;const s_t=function o_t(e,n){var t=S3(e),r=!t&&k3(e),a=!t&&!r&&sW(e),c=!t&&!r&&!a&&uW(e),h=t||r||a||c,f=h?function Qgt(e,n){for(var t=-1,r=Array(e);++t<e;)r[t]=n(t);return r}(e.length,String):[],b=f.length;for(var x in e)(n||r_t.call(e,x))&&(!h||!("length"==x||a&&("offset"==x||"parent"==x)||c&&("buffer"==x||"byteLength"==x||"byteOffset"==x)||hW(x,b)))&&f.push(x);return f};var d_t=Object.prototype.hasOwnProperty;const h_t=function u_t(e){if(!E_(e))return function a_t(e){var n=[];if(null!=e)for(var t in Object(e))n.push(t);return n}(e);var n=JG(e),t=[];for(var r in e)"constructor"==r&&(n||!d_t.call(e,r))||t.push(r);return t},mW=function m_t(e){return T3(e)?s_t(e,!0):h_t(e)},f_t=function p_t(e){return function Xgt(e,n,t,r){var a=!t;t||(t={});for(var c=-1,h=n.length;++c<h;){var f=n[c],b=r?r(t[f],e[f],f,t,e):void 0;void 0===b&&(b=e[f]),a?M3(t,f,b):Zgt(t,f,b)}return t}(e,mW(e))},__t=function g_t(e,n,t,r,a,c,h){var f=A3(e,t),b=A3(n,t),x=h.get(b);if(x)D3(e,t,x);else{var M=c?c(f,b,t+"",e,n,h):void 0,T=void 0===M;if(T){var I=S3(b),L=!I&&sW(b),N=!I&&!L&&uW(b);M=b,I||L||N?S3(f)?M=f:function tgt(e){return JM(e)&&T3(e)}(f)?M=function Oft(e,n){var t=-1,r=e.length;for(n||(n=Array(r));++t<r;)n[t]=e[t];return n}(f):L?(T=!1,M=function Sft(e,n){if(n)return e.slice();var t=e.length,r=ZG?ZG(t):new e.constructor(t);return e.copy(r),r}(b,!0)):N?(T=!1,M=Pft(b,!0)):M=[]:function hgt(e){if(!JM(e)||"[object Object]"!=hR(e))return!1;var n=QG(e);if(null===n)return!0;var t=dgt.call(n,"constructor")&&n.constructor;return"function"==typeof t&&t instanceof t&&aW.call(t)==ugt}(b)||k3(b)?(M=f,k3(f)?M=f_t(f):(!E_(f)||x3(f))&&(M=function Uft(e){return"function"!=typeof e.constructor||JG(e)?{}:Bft(QG(e))}(b))):T=!1}T&&(h.set(b,M),a(M,b,r,c,h),h.delete(b)),D3(e,t,M)}},b_t=function pW(e,n,t,r,a){e!==n&&Dft(n,function(c,h){if(a||(a=new yft),E_(c))__t(e,n,h,t,pW,r,a);else{var f=r?r(A3(e,h),c,h+"",e,n,a):void 0;void 0===f&&(f=c),D3(e,h,f)}},mW)},fW=function y_t(e){return e};var gW=Math.max;const D_t=function M_t(e){return function(){return e}};var k_t=pR?function(e,n){return pR(e,"toString",{configurable:!0,enumerable:!1,value:D_t(n),writable:!0})}:fW,A_t=Date.now,R_t=function I_t(e){var n=0,t=0;return function(){var r=A_t(),a=16-(r-t);if(t=r,a>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}(k_t);const P_t=R_t,F_t=function O_t(e,n){return P_t(function w_t(e,n,t){return n=gW(void 0===n?e.length-1:n,0),function(){for(var r=arguments,a=-1,c=gW(r.length-n,0),h=Array(c);++a<c;)h[a]=r[n+a];a=-1;for(var f=Array(n+1);++a<n;)f[a]=r[a];return f[n]=t(h),function v_t(e,n,t){switch(t.length){case 0:return e.call(n);case 1:return e.call(n,t[0]);case 2:return e.call(n,t[0],t[1]);case 3:return e.call(n,t[0],t[1],t[2])}return e.apply(n,t)}(e,this,f)}}(e,n,fW),e+"")};var z_t=function N_t(e){return F_t(function(n,t){var r=-1,a=t.length,c=a>1?t[a-1]:void 0,h=a>2?t[2]:void 0;for(c=e.length>3&&"function"==typeof c?(a--,c):void 0,h&&function L_t(e,n,t){if(!E_(t))return!1;var r=typeof n;return!!("number"==r?T3(t)&&hW(n,t.length):"string"==r&&n in t)&&lR(t[n],e)}(t[0],t[1],h)&&(c=a<3?void 0:c,a=1),n=Object(n);++r<a;){var f=t[r];f&&e(n,f,r,c)}return n})}(function(e,n,t){b_t(e,n,t)});const V_t=z_t,j_t=[[255,99,132],[54,162,235],[255,206,86],[231,233,237],[75,192,192],[151,187,205],[220,220,220],[247,70,74],[70,191,189],[253,180,92],[148,159,177],[77,83,96]],U_t={plugins:{colors:{enabled:!1}},datasets:{line:{backgroundColor:e=>Yp(Zp(e.datasetIndex),.4),borderColor:e=>Yp(Zp(e.datasetIndex),1),pointBackgroundColor:e=>Yp(Zp(e.datasetIndex),1),pointBorderColor:"#fff"},bar:{backgroundColor:e=>Yp(Zp(e.datasetIndex),.6),borderColor:e=>Yp(Zp(e.datasetIndex),1)},get radar(){return this.line},doughnut:{backgroundColor:e=>Yp(Zp(e.dataIndex),.6),borderColor:"#fff"},get pie(){return this.doughnut},polarArea:{backgroundColor:e=>Yp(Zp(e.dataIndex),.6),borderColor:e=>Yp(Zp(e.dataIndex),1)},get bubble(){return this.doughnut},get scatter(){return this.doughnut},get area(){return this.polarArea}}};function Yp(e,n){return"rgba("+e.concat(n).join(",")+")"}function I3(e,n){return Math.floor(Math.random()*(n-e+1))+e}function Zp(e=0){return j_t[e]||function H_t(){return[I3(0,255),I3(0,255),I3(0,255)]}()}let _W=(()=>{class e{constructor(){this.generateColors=!0}static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275prov=Jt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();wI.register(...Btt);let $_t=(()=>{class e{constructor(t){t?.plugins&&wI.register(...t.plugins);const r=V_t(t?.generateColors?U_t:{},t?.defaults||{});to.set(r)}static forRoot(t){return{ngModule:e,providers:[{provide:_W,useValue:t}]}}static#t=this.\u0275fac=function(r){return new(r||e)(vt(_W,8))};static#e=this.\u0275mod=ei({type:e});static#i=this.\u0275inj=Je({})}return e})(),G_t=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#e=this.\u0275mod=ei({type:e,bootstrap:[rct]});static#i=this.\u0275inj=Je({providers:[cM],imports:[c4,Nlt,Jdt,$lt,_2,clt,nct,cut,dut,_ut,Mut,But,mht,bst,Rrt,EG,x2,ght,Iot,Wht,Kht,pat,cmt,o$,Yat,pmt,c$,Dmt,lrt,dit,aet,Mat,Tmt,$_t,cit]})}return e})();V7().bootstrapModule(G_t).catch(e=>console.error(e))},574:function(d0){d0.exports=function(){"use strict";var Bh,Nh,bn;function Kp(ge,lt){if(Bh)if(Nh){var Va="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Bh+")(sharedChunk); ("+Nh+")(sharedChunk); self.onerror = null;",Dl={};Bh(Dl),bn=lt(Dl),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(bn.workerUrl=window.URL.createObjectURL(new Blob([Va],{type:"text/javascript"})))}else Nh=lt;else Bh=lt}return Kp(0,function(ge){var lt=typeof self<"u"?self:{},Va="3.1.2";let Dl;const mi={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Dl){const o=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Dl=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):o}catch{Dl=o}}return Dl},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!mi.API_URL)return null;try{const o=new URL(mi.API_URL);return"api.mapbox.cn"===o.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===o.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},Js={supported:!1,testSupport:function(o){!Qc&&mc&&(Jc?I_(o):ja=o)}};let ja,mc,Qc=!1,Jc=!1;function I_(o){const i=o.createTexture();o.bindTexture(o.TEXTURE_2D,i);try{if(o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,mc),o.isContextLost())return;Js.supported=!0}catch{}o.deleteTexture(i),Qc=!0}lt.document&&(mc=lt.document.createElement("img"),mc.onload=function(){ja&&I_(ja),ja=null,Jc=!0},mc.onerror=function(){Qc=!0,ja=null},mc.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Qp="01";function Ds(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var kl=Sl;function Sl(o,i,s,l){this.cx=3*o,this.bx=3*(s-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(l-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=i,this.p2x=s,this.p2y=l}Sl.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,i){if(void 0===i&&(i=1e-6),o<0)return 0;if(o>1)return 1;for(var s=o,l=0;l<8;l++){var d=this.sampleCurveX(s)-o;if(Math.abs(d)<i)return s;var u=this.sampleCurveDerivativeX(s);if(Math.abs(u)<1e-6)break;s-=d/u}var m=0,p=1;for(s=o,l=0;l<20&&(d=this.sampleCurveX(s),!(Math.abs(d-o)<i));l++)o>d?m=s:p=s,s=.5*(p-m)+m;return s},solve:function(o,i){return this.sampleCurveY(this.solveCurveX(o,i))}};var R_=Ds(kl),td=Tl;function Tl(o,i){this.x=o,this.y=i}Tl.prototype={clone:function(){return new Tl(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,i){return this.clone()._rotateAround(o,i)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var i=o.x-this.x,s=o.y-this.y;return i*i+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,i){return Math.atan2(this.x*i-this.y*o,this.x*o+this.y*i)},_matMult:function(o){var i=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=i,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var i=Math.cos(o),s=Math.sin(o),l=s*this.x+i*this.y;return this.x=i*this.x-s*this.y,this.y=l,this},_rotateAround:function(o,i){var s=Math.cos(o),l=Math.sin(o),d=i.y+l*(this.x-i.x)+s*(this.y-i.y);return this.x=i.x+s*(this.x-i.x)-l*(this.y-i.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Tl.convert=function(o){return o instanceof Tl?o:Array.isArray(o)?new Tl(o[0],o[1]):o};var ot=Ds(td);function Ni(o,i){if(Array.isArray(o)){if(!Array.isArray(i)||o.length!==i.length)return!1;for(let s=0;s<o.length;s++)if(!Ni(o[s],i[s]))return!1;return!0}if("object"==typeof o&&null!==o&&null!==i){if("object"!=typeof i||Object.keys(o).length!==Object.keys(i).length)return!1;for(const s in o)if(!Ni(o[s],i[s]))return!1;return!0}return o===i}const Qd=Math.PI/180,El=180/Math.PI;function ni(o){return o*Qd}function jr(o){return o*El}const h0=[[0,0],[1,0],[1,1],[0,1]];function ed(o){if(o<=0)return 0;if(o>=1)return 1;const i=o*o,s=i*o;return 4*(o<.5?s:3*(o-i)+s-.75)}function Al(o){let i=1/0,s=1/0,l=-1/0,d=-1/0;for(const u of o)i=Math.min(i,u.x),s=Math.min(s,u.y),l=Math.max(l,u.x),d=Math.max(d,u.y);return{min:new ot(i,s),max:new ot(l,d)}}function Jd(o,i,s=0,l=!0){const d=new ot(s,s),u=o.sub(d),m=i.add(d),p=[u,new ot(m.x,u.y),m,new ot(u.x,m.y)];return l&&p.push(u.clone()),p}function id(o,i,s,l){const d=new R_(o,i,s,l);return function(u){return d.solve(u)}}const en=id(.25,.1,.25,1);function he(o,i,s){return Math.min(s,Math.max(i,o))}function Il(o,i,s){return(s=he((s-o)/(i-o),0,1))*s*(3-2*s)}function Rl(o,i,s){const l=s-i,d=((o-i)%l+l)%l+i;return d===i?s:d}function tu(o,i,s){if(!o.length)return s(null,[]);let l=o.length;const d=new Array(o.length);let u=null;o.forEach((m,p)=>{i(m,(g,_)=>{g&&(u=g),d[p]=_,0==--l&&s(u,d)})})}function we(o){const i=[];for(const s in o)i.push(o[s]);return i}function se(o,...i){for(const s of i)for(const l in s)o[l]=s[l];return o}function is(o,i){const s={};for(let l=0;l<i.length;l++){const d=i[l];d in o&&(s[d]=o[d])}return s}let pr=1;function jn(){return pr++}function P_(){return function o(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,o)}()}function Ti(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function zh(o){return!!o&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(o)}function qr(o,i){o.forEach(s=>{i[s]&&(i[s]=i[s].bind(i))})}function nd(o,i){return-1!==o.indexOf(i,o.length-i.length)}function Vh(o,i,s){const l={};for(const d in o)l[d]=i.call(s||this,o[d],d,o);return l}function Ut(o,i,s){const l={};for(const d in o)i.call(s||this,o[d],d,o)&&(l[d]=o[d]);return l}function Y(o){return Array.isArray(o)?o.map(Y):"object"==typeof o&&o?Vh(o,Y):o}const K={};function rt(o){K[o]||(typeof console<"u"&&console.warn(o),K[o]=!0)}function Ot(o,i,s){return(s.y-o.y)*(i.x-o.x)>(i.y-o.y)*(s.x-o.x)}function Nt(o){let i=0;for(let s,l,d=0,u=o.length,m=u-1;d<u;m=d++)s=o[d],l=o[m],i+=(l.x-s.x)*(s.y+l.y);return i}function ne([o,i,s]){const l=ni(i+90),d=ni(s);return{x:o*Math.cos(l)*Math.sin(d),y:o*Math.sin(l)*Math.sin(d),z:o*Math.cos(d),azimuthal:i,polar:s}}function ye(o,i,s){const l=Math.sqrt(o*o+i*i+s*s),d=l>0?Math.acos(s/l)*El:0;let u=0!==o||0!==i?Math.atan2(-i,-o)*El+90:0;return u<0&&(u+=360),[l,u,d]}function Lt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ee(o){const i={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,l,d,u)=>{const m=d||u;return i[l]=!m||m.toLowerCase(),""}),i["max-age"]){const s=parseInt(i["max-age"],10);isNaN(s)?delete i["max-age"]:i["max-age"]=s}return i}let Ge=null;function We(){return!!lt.document.fullscreenElement||!!lt.document.webkitFullscreenElement}function wn(o){try{const i=lt[o];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}}function tr(o,i){return[o[4*i],o[4*i+1],o[4*i+2],o[4*i+3]]}function eo(o,i,s){o[4*i+0]=s[0],o[4*i+1]=s[1],o[4*i+2]=s[2],o[4*i+3]=s[3]}function er(o,i){return[Math.pow(o[0],2.2)*i,Math.pow(o[1],2.2)*i,Math.pow(o[2],2.2)*i]}function En(o){return[Math.pow(o[0],1/2.2),Math.pow(o[1],1/2.2),Math.pow(o[2],1/2.2)]}const An="mapbox-tiles";let ns,Ua,Fo=500,Ho=50;function jh(){try{return lt.caches}catch{}}function ks(){jh()&&!ns&&(ns=lt.caches.open(An))}function pc(o){const i=o.indexOf("?");if(i<0)return o;const l=function(d){const u=d.indexOf("?");return u>0?d.slice(u+1).split("&"):[]}(o).filter(d=>{const u=d.split("=");return"language"===u[0]||"worldview"===u[0]});return l.length?`${o.slice(0,i)}?${l.join("&")}`:o.slice(0,i)}let rd=1/0;function Uh(o){rd++,rd>Ho&&(o.getActor().send("enforceCacheSizeLimit",Fo),rd=0)}const xt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};"function"==typeof Object.freeze&&Object.freeze(xt);class Tt extends Error{constructor(i,s,l){401===s&&qi(l)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=s,this.url=l}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const zt=Lt()?()=>self.worker&&self.worker.referrer:()=>("blob:"===lt.location.protocol?lt.parent:lt).location.href,Ht=function(o,i){if(!(/^file:/.test(s=o.url)||/^file:/.test(zt())&&!/^\w+:/.test(s))){if(lt.fetch&&lt.Request&&lt.AbortController&&lt.Request.prototype.hasOwnProperty("signal"))return function(l,d){const u=new lt.AbortController,m=new lt.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:zt(),referrerPolicy:l.referrerPolicy,signal:u.signal});let p=!1,g=!1;const _=(y=m.url).indexOf("sku=")>0&&qi(y);var y;"json"===l.type&&m.headers.set("Accept","application/json");const v=(C,D,k)=>{if(g)return;if(C&&"SecurityError"!==C.message&&rt(C.toString()),D&&k)return w(D);const S=Date.now();lt.fetch(m).then(E=>{if(E.ok){const A=_?E.clone():null;return w(E,A,S)}return d(new Tt(E.statusText,E.status,l.url))}).catch(E=>{"AbortError"!==E.name&&d(new Error(`${E.message} ${l.url}`))})},w=(C,D,k)=>{("arrayBuffer"===l.type?C.arrayBuffer():"json"===l.type?C.json():C.text()).then(S=>{g||(D&&k&&function(E,A,P){if(ks(),!ns)return;const O={status:A.status,statusText:A.statusText,headers:new lt.Headers};A.headers.forEach((B,j)=>O.headers.set(j,B));const R=Ee(A.headers.get("Cache-Control")||"");if(R["no-store"])return;R["max-age"]&&O.headers.set("Expires",new Date(P+1e3*R["max-age"]).toUTCString());const F=O.headers.get("Expires");F&&(new Date(F).getTime()-P<42e4||function(B,j){if(void 0===Ua)try{new Response(new ReadableStream),Ua=!0}catch{Ua=!1}Ua?j(B.body):B.blob().then(j)}(A,B=>{const j=new lt.Response(B,O);ks(),ns&&ns.then(U=>U.put(pc(E.url),j)).catch(U=>rt(U.message))}))}(m,D,k),p=!0,d(null,S,C.headers.get("Cache-Control"),C.headers.get("Expires")))}).catch(S=>{g||d(new Error(S.message))})};return _?function(C,D){if(ks(),!ns)return D(null);const k=pc(C.url);ns.then(S=>{S.match(k).then(E=>{const A=function(P){if(!P)return!1;const O=new Date(P.headers.get("Expires")||0),R=Ee(P.headers.get("Cache-Control")||"");return O>Date.now()&&!R["no-cache"]}(E);S.delete(k),A&&S.put(k,E.clone()),D(null,E,A)}).catch(D)}).catch(D)}(m,v):v(null,null),{cancel:()=>{g=!0,p||u.abort()}}}(o,i);if(Lt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,i,void 0,!0)}var s;return function(l,d){const u=new lt.XMLHttpRequest;u.open(l.method||"GET",l.url,!0),"arrayBuffer"===l.type&&(u.responseType="arraybuffer");for(const m in l.headers)u.setRequestHeader(m,l.headers[m]);return"json"===l.type&&(u.responseType="text",u.setRequestHeader("Accept","application/json")),u.withCredentials="include"===l.credentials,u.onerror=()=>{d(new Error(u.statusText))},u.onload=()=>{if((u.status>=200&&u.status<300||0===u.status)&&null!==u.response){let m=u.response;if("json"===l.type)try{m=JSON.parse(u.response)}catch(p){return d(p)}d(null,m,u.getResponseHeader("Cache-Control"),u.getResponseHeader("Expires"))}else d(new Tt(u.statusText,u.status,l.url))},u.send(l.body),{cancel:()=>u.abort()}}(o,i)},jt=function(o,i){return Ht(se(o,{type:"json"}),i)},qt=function(o,i){return Ht(se(o,{type:"arrayBuffer"}),i)};function Qt(o){const i=lt.document.createElement("a");return i.href=o,i.protocol===lt.document.location.protocol&&i.host===lt.document.location.host}const $t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ce,Zt;ce=[],Zt=0;const ai=function(o,i){if(Js.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),Zt>=mi.MAX_PARALLEL_IMAGE_REQUESTS){const u={requestParameters:o,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return ce.push(u),u}Zt++;let s=!1;const l=()=>{if(!s)for(s=!0,Zt--;ce.length&&Zt<mi.MAX_PARALLEL_IMAGE_REQUESTS;){const u=ce.shift(),{requestParameters:m,callback:p,cancelled:g}=u;g||(u.cancel=ai(m,p).cancel)}},d=qt(o,(u,m,p,g)=>{l(),u?i(u):m&&(lt.createImageBitmap?function(_,y){const v=new lt.Blob([new Uint8Array(_)],{type:"image/png"});lt.createImageBitmap(v).then(w=>{y(null,w)}).catch(w=>{y(new Error(`Could not load image because of ${w.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(_,y)=>i(_,y,p,g)):function(_,y){const v=new lt.Image,w=lt.URL;v.onload=()=>{y(null,v),w.revokeObjectURL(v.src),v.onload=null,lt.requestAnimationFrame(()=>{v.src=$t})},v.onerror=()=>y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const C=new lt.Blob([new Uint8Array(_)],{type:"image/png"});v.src=_.byteLength?w.createObjectURL(C):$t}(m,(_,y)=>i(_,y,p,g)))});return{cancel:()=>{d.cancel(),l()}}},un="NO_ACCESS_TOKEN";class Ae{constructor(i,s,l){this._transformRequestFn=i,this._customAccessToken=s,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const i=function(){let s="";for(let l=0;l<10;l++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Qp,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,s){return this._transformRequestFn&&this._transformRequestFn(i,s)||{url:i}}normalizeStyleURL(i,s){if(!nn(i))return i;const l=Ur(i);return l.params.push(`sdk=js-${Va}`),l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||s)}normalizeGlyphsURL(i,s){if(!nn(i))return i;const l=Ur(i);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||s)}normalizeModelURL(i,s){if(!nn(i))return i;const l=Ur(i);return l.path=`/models/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||s)}normalizeSourceURL(i,s,l,d){if(!nn(i))return i;const u=Ur(i);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),l&&u.params.push(`language=${l}`),d&&u.params.push(`worldview=${d}`),this._makeAPIURL(u,this._customAccessToken||s)}normalizeSpriteURL(i,s,l,d){const u=Ur(i);return nn(i)?(u.path=`/styles/v1${u.path}/sprite${s}${l}`,this._makeAPIURL(u,this._customAccessToken||d)):(u.path+=`${s}${l}`,rs(u))}normalizeTileURL(i,s,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!nn(i))return i;const d=Ur(i);d.path=d.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||l&&"raster"!==d.authority&&512===l?"@2x":""}${Js.supported?".webp":"$1"}`),"raster"===d.authority?d.path=`/${mi.RASTER_URL_PREFIX}${d.path}`:(d.path=d.path.replace(/^.+\/v4\//,"/"),d.path=`/${mi.TILE_URL_VERSION}${d.path}`);const u=this._customAccessToken||function(m){for(const p of m){const g=p.match(/^access_token=(.*)$/);if(g)return g[1]}return null}(d.params)||mi.ACCESS_TOKEN;return mi.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&d.params.push(`sku=${this._skuToken}`),this._makeAPIURL(d,u)}canonicalizeTileURL(i,s){const l=Ur(i);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return i;let d="mapbox://";l.path.match(/^\/raster\/v1\//)?d+=`raster/${l.path.replace(`/${mi.RASTER_URL_PREFIX}/`,"")}`:d+=`tiles/${l.path.replace(`/${mi.TILE_URL_VERSION}/`,"")}`;let u=l.params;return s&&(u=u.filter(m=>!m.match(/^access_token=/))),u.length&&(d+=`?${u.join("&")}`),d}canonicalizeTileset(i,s){const l=!!s&&nn(s),d=[];for(const u of i.tiles||[])qi(u)?d.push(this.canonicalizeTileURL(u,l)):d.push(u);return d}_makeAPIURL(i,s){const l="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",d=Ur(mi.API_URL);if(i.protocol=d.protocol,i.authority=d.authority,"http"===i.protocol){const u=i.params.indexOf("secure");u>=0&&i.params.splice(u,1)}if("/"!==d.path&&(i.path=`${d.path}${i.path}`),!mi.REQUIRE_ACCESS_TOKEN)return rs(i);if(s=s||mi.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if("s"===s[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return i.params=i.params.filter(u=>-1===u.indexOf("access_token")),i.params.push(`access_token=${s||""}`),rs(i)}}function nn(o){return 0===o.indexOf("mapbox:")}function qi(o){return mi.API_URL_REGEX.test(o)}function lr(o){return mi.API_CDN_URL_REGEX.test(o)}function Tr(o){return mi.API_STYLE_REGEX.test(o)&&!Lo(o)}function Lo(o){return mi.API_SPRITE_REGEX.test(o)}const va=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ur(o){const i=o.match(va);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function rs(o){const i=o.params.length?`?${o.params.join("&")}`:"";return`${o.protocol}://${o.authority}${o.path}${i}`}const Bo="mapbox.eventData";function Ss(o){if(!o)return null;const i=o.split(".");if(!i||3!==i.length)return null;try{return JSON.parse(decodeURIComponent(lt.atob(i[1]).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class od{constructor(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(i){const s=Ss(mi.ACCESS_TOKEN);let l="";return l=s&&s.u?lt.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,(d,u)=>String.fromCharCode(+("0x"+u)))):mi.ACCESS_TOKEN||"",i?`${Bo}.${i}:${l}`:`${Bo}:${l}`}fetchEventData(){const i=wn("localStorage"),s=this.getStorageKey(),l=this.getStorageKey("uuid");if(i)try{const d=lt.localStorage.getItem(s);d&&(this.eventData=JSON.parse(d));const u=lt.localStorage.getItem(l);u&&(this.anonId=u)}catch{rt("Unable to read from LocalStorage")}}saveEventData(){const i=wn("localStorage"),s=this.getStorageKey(),l=this.getStorageKey("uuid");if(i)try{lt.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&lt.localStorage.setItem(s,JSON.stringify(this.eventData))}catch{rt("Unable to write to LocalStorage")}}processRequests(i){}postEvent(i,s,l,d){if(!mi.EVENTS_URL)return;const u=Ur(mi.EVENTS_URL);u.params.push(`access_token=${d||mi.ACCESS_TOKEN||""}`);const m={event:this.type,created:new Date(i).toISOString()},p=s?se(m,s):m,g={url:rs(u),headers:{"Content-Type":"text/plain"},body:JSON.stringify([p])};var y;this.pendingRequest=(y=_=>{this.pendingRequest=null,l(_),this.saveEventData(),this.processRequests(d)},Ht(se(g,{method:"POST"}),y))}queueRequest(i,s){this.queue.push(i),this.processRequests(s)}}const xr=new class extends od{constructor(o){super("appUserTurnstile"),this._customAccessToken=o}postTurnstileEvent(o,i){mi.EVENTS_URL&&mi.ACCESS_TOKEN&&Array.isArray(o)&&o.some(s=>nn(s)||qi(s))&&this.queueRequest(Date.now(),i)}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const i=Ss(mi.ACCESS_TOKEN),s=i?i.u:mi.ACCESS_TOKEN;let l=s!==this.eventData.tokenU;zh(this.anonId)||(this.anonId=P_(),l=!0);const d=this.queue.shift();if(this.eventData.lastSuccess){const u=new Date(this.eventData.lastSuccess),m=new Date(d),p=(d-this.eventData.lastSuccess)/864e5;l=l||p>=1||p<-1||u.getDate()!==m.getDate()}else l=!0;l?this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Va,skuId:Qp,"enabled.telemetry":!1,userId:this.anonId},u=>{u||(this.eventData.lastSuccess=d,this.eventData.tokenU=s)},o):this.processRequests()}},sd=xr.postTurnstileEvent.bind(xr),xa=new class extends od{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(o,i,s,l){this.skuToken=i,this.errorCb=l,mi.EVENTS_URL&&(s||mi.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},s):this.errorCb(new Error(un)))}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{id:i,timestamp:s}=this.queue.shift();i&&this.success[i]||(this.anonId||this.fetchEventData(),zh(this.anonId)||(this.anonId=P_()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Va,skuId:Qp,skuToken:this.skuToken,userId:this.anonId},l=>{l?this.errorCb(l):i&&(this.success[i]=!0)},o))}},P3=xa.postMapLoadEvent.bind(xa),eD=new class extends od{constructor(){super("gljs.performance")}postPerformanceEvent(o,i){mi.EVENTS_URL&&(o||mi.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:i},o)}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:i,performanceData:s}=this.queue.shift(),l=function(d){const u=lt.performance.getEntriesByType("resource"),m=lt.performance.getEntriesByType("mark"),p=function(w){const C={};if(w)for(const D in w)if("other"!==D)for(const k of w[D]){const S=`${D}ResolveRangeMin`,E=`${D}ResolveRangeMax`,A=`${D}RequestCount`,P=`${D}RequestCachedCount`;C[S]=Math.min(C[S]||1/0,k.startTime),C[E]=Math.max(C[E]||-1/0,k.responseEnd);const O=R=>{void 0===C[R]&&(C[R]=0),++C[R]};void 0!==k.transferSize&&0===k.transferSize&&O(P),O(A)}return C}(function(w,C){const D={};if(w)for(const k of w){const S=C(k);void 0===D[S]&&(D[S]=[]),D[S].push(k)}return D}(u,gR)),g=lt.devicePixelRatio,_=lt.navigator.connection||lt.navigator.mozConnection||lt.navigator.webkitConnection,y={counters:[],metadata:[],attributes:[]},v=(w,C,D)=>{null!=D&&w.push({name:C,value:D.toString()})};for(const w in p)v(y.counters,w,p[w]);if(d.interactionRange[0]!==1/0&&d.interactionRange[1]!==-1/0&&(v(y.counters,"interactionRangeMin",d.interactionRange[0]),v(y.counters,"interactionRangeMax",d.interactionRange[1])),m)for(const w of Object.keys(Jp)){const C=Jp[w],D=m.find(k=>k.name===C);D&&v(y.counters,C,D.startTime)}return v(y.counters,"visibilityHidden",d.visibilityHidden),v(y.attributes,"style",function(w){if(w)for(const C of w){const D=C.name.split("?")[0];if(Tr(D)){const k=D.split("/").slice(-2);if(2===k.length)return`mapbox://styles/${k[0]}/${k[1]}`}}}(u)),v(y.attributes,"terrainEnabled",d.terrainEnabled?"true":"false"),v(y.attributes,"fogEnabled",d.fogEnabled?"true":"false"),v(y.attributes,"projection",d.projection),v(y.attributes,"zoom",d.zoom),v(y.metadata,"devicePixelRatio",g),v(y.metadata,"connectionEffectiveType",_?_.effectiveType:void 0),v(y.metadata,"navigatorUserAgent",lt.navigator.userAgent),v(y.metadata,"screenWidth",lt.screen.width),v(y.metadata,"screenHeight",lt.screen.height),v(y.metadata,"windowWidth",lt.innerWidth),v(y.metadata,"windowHeight",lt.innerHeight),v(y.metadata,"mapWidth",d.width/g),v(y.metadata,"mapHeight",d.height/g),v(y.metadata,"webglRenderer",d.renderer),v(y.metadata,"webglVendor",d.vendor),v(y.metadata,"sdkVersion",Va),v(y.metadata,"sdkIdentifier","mapbox-gl-js"),y}(s);for(const d of l.metadata);for(const d of l.counters);for(const d of l.attributes);this.postEvent(i,l,()=>{},o)}},iD=eD.postPerformanceEvent.bind(eD),O_=new class extends od{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(o,i,s,l){if(!mi.API_URL||!mi.SESSION_PATH)return;const d=Ur(mi.API_URL+mi.SESSION_PATH);d.params.push(`sku=${i||""}`),d.params.push(`access_token=${l||mi.ACCESS_TOKEN||""}`);const u={url:rs(d),headers:{"Content-Type":"text/plain"}};var p;this.pendingRequest=(p=m=>{this.pendingRequest=null,s(m),this.saveEventData(),this.processRequests(l)},Ht(se(u,{method:"GET"}),p))}getSessionAPI(o,i,s,l){this.skuToken=i,this.errorCb=l,mi.SESSION_PATH&&mi.API_URL&&(s||mi.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},s):this.errorCb(new Error(un)))}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{id:i,timestamp:s}=this.queue.shift();i&&this.success[i]||this.getSession(s,this.skuToken,l=>{l?this.errorCb(l):i&&(this.success[i]=!0)},o)}},nD=O_.getSessionAPI.bind(O_),ad=new Set;function rD(o,i){i?ad.add(o):ad.delete(o)}const Jp={create:"create",load:"load",fullLoad:"fullLoad"},m0={mark(o){lt.performance.mark(o)},measure(o,i,s){lt.performance.measure(o,i,s)}};function gR(o){const i=o.name.split("?")[0];return lr(i)&&i.includes("mapbox-gl.js")?"javascript":lr(i)&&i.includes("mapbox-gl.css")?"css":mi.API_FONTS_REGEX.test(i)?"fontRange":Lo(i)?"sprite":Tr(i)?"style":mi.API_TILEJSON_REGEX.test(i)?"tilejson":"other"}const _R=lt.performance;function oD(o){const i=o?o.url.toString():void 0;return _R.getEntriesByName(i)}var sD=F_;function F_(o){return i=o,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var l,d,u=new Blob([""],{type:"text/javascript"}),m=URL.createObjectURL(u);try{d=new Worker(m),l=!0}catch{l=!1}return d&&d.terminate(),URL.revokeObjectURL(m),l}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var l=document.createElement("canvas");l.width=l.height=1;var d=l.getContext("2d");if(!d)return!1;var u=d.getImageData(0,0,1,1);return u&&u.width===l.width}()||(void 0===p0[s=i&&i.failIfMajorPerformanceCaveat]&&(p0[s]=function(l){var d,m,p,g,u=(m=l,p=document.createElement("canvas"),(g=Object.create(F_.webGLContextAttributes)).failIfMajorPerformanceCaveat=m,p.getContext("webgl",g)||p.getContext("experimental-webgl",g));if(!u)return!1;try{d=u.createShader(u.VERTEX_SHADER)}catch{return!1}return!(!d||u.isContextLost())&&(u.shaderSource(d,"void main() {}"),u.compileShader(d),!0===u.getShaderParameter(d,u.COMPILE_STATUS))}(s)),!p0[s]||document.documentMode));var i,s}var p0={};let f0,Er,wr,Yr,Le;function tf(){return null==f0&&(f0=lt.OffscreenCanvas&&new lt.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof lt.createImageBitmap),f0}F_.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Ze={now:()=>void 0!==Yr?Yr:lt.performance.now(),setNow(o){Yr=o},restoreNow(){Yr=void 0},frame(o){const i=lt.requestAnimationFrame(o);return{cancel:()=>lt.cancelAnimationFrame(i)}},getImageData(o,i=0){const{width:s,height:l}=o;Le||(Le=lt.document.createElement("canvas"));const d=Le.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return(s>Le.width||l>Le.height)&&(Le.width=s,Le.height=l),d.clearRect(-i,-i,s+2*i,l+2*i),d.drawImage(o,0,0,s,l),d.getImageData(-i,-i,s+2*i,l+2*i)},resolveURL:o=>(Er||(Er=lt.document.createElement("a")),Er.href=o,Er.href),get devicePixelRatio(){return lt.devicePixelRatio},get prefersReducedMotion(){return!!lt.matchMedia&&(null==wr&&(wr=lt.matchMedia("(prefers-reduced-motion: reduce)")),wr.matches)},hasCanvasFingerprintNoise(){if(!tf())return!1;const o=new lt.OffscreenCanvas(85,1),i=o.getContext("2d",{willReadFrequently:!0});let s=0;for(let d=0;d<o.width;++d)i.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,i.fillRect(d,0,1,1);const l=i.getImageData(0,0,o.width,o.height);s=0;for(let d=0;d<l.data.length;++d)if(d%4!=3&&s++!==l.data[d])return!0;return!1}};function Ci(o,i,s){const l=lt.document.createElement(o);return void 0!==i&&(l.className=i),s&&s.appendChild(l),l}function wa(o,i,s){const l=lt.document.createElementNS("http://www.w3.org/2000/svg",o);for(const d of Object.keys(i))l.setAttributeNS(null,d,i[d]);return s&&s.appendChild(l),l}const eu=lt.document&&lt.document.documentElement.style,In=eu&&void 0!==eu.userSelect?"userSelect":"WebkitUserSelect";let ef;function io(){eu&&In&&(ef=eu[In],eu[In]="none")}function L_(){eu&&In&&(eu[In]=ef)}function g0(o){o.preventDefault(),o.stopPropagation(),lt.removeEventListener("click",g0,!0)}function rn(){lt.addEventListener("click",g0,!0),lt.setTimeout(()=>{lt.removeEventListener("click",g0,!0)},0)}function Mi(o,i){const s=o.getBoundingClientRect();return bR(o,s,i)}function Hh(o,i){const s=o.getBoundingClientRect(),l=[];for(let d=0;d<i.length;d++)l.push(bR(o,s,i[d]));return l}function B_(o){return void 0!==lt.InstallTrigger&&2===o.button&&o.ctrlKey&&lt.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:o.button}function bR(o,i,s){const l=o.offsetWidth===i.width?1:o.offsetWidth/i.width;return new ot((s.clientX-i.left)*l,(s.clientY-i.top)*l)}function _0(o,i,s){s[o]&&-1!==s[o].indexOf(i)||(s[o]=s[o]||[],s[o].push(i))}function Rt(o,i,s){if(s&&s[o]){const l=s[o].indexOf(i);-1!==l&&s[o].splice(l,1)}}class Bt{constructor(i,s={}){se(this,s),this.type=i}}class Yt extends Bt{constructor(i,s={}){super("error",se({error:i},s))}}class gi{on(i,s){return this._listeners=this._listeners||{},_0(i,s,this._listeners),this}off(i,s){return Rt(i,s,this._listeners),Rt(i,s,this._oneTimeListeners),this}once(i,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},_0(i,s,this._oneTimeListeners),this):new Promise(l=>this.once(i,l))}fire(i,s){"string"==typeof i&&(i=new Bt(i,s||{}));const l=i.type;if(this.listens(l)){i.target=this;const d=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const p of d)p.call(this,i);const u=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const p of u)Rt(l,p,this._oneTimeListeners),p.call(this,i);const m=this._eventedParent;m&&(se(i,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),m.fire(i))}else i instanceof Yt&&console.error(i.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,s){return this._eventedParent=i,this._eventedParentData=s,this}}var ct=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class le{constructor(i,s,l,d){this.message=(i?`${i}: `:"")+l,d&&(this.identifier=d),null!=s&&s.__line__&&(this.line=s.__line__)}}class iu extends le{}function Ha(o,...i){for(const s of i)for(const l in s)o[l]=s[l];return o}function Cn(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function ld(o){if(Array.isArray(o))return o.map(ld);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const i={};for(const s in o)i[s]=ld(o[s]);return i}return Cn(o)}class yR extends Error{constructor(i,s){super(s),this.message=s,this.key=i}}var fc=yR;class gc{constructor(i,s=[]){this.parent=i,this.bindings={};for(const[l,d]of s)this.bindings[l]=d}concat(i){return new gc(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}var O3=gc;const nf={kind:"null"},re={kind:"number"},$i={kind:"string"},Ki={kind:"boolean"},$a={kind:"color"},$h={kind:"object"},Yi={kind:"value"},os={kind:"collator"},vi={kind:"formatted"},N_={kind:"resolvedImage"};function ta(o,i){return{kind:"array",itemType:o,N:i}}function Ar(o){if("array"===o.kind){const i=Ar(o.itemType);return"number"==typeof o.N?`array<${i}, ${o.N}>`:"value"===o.itemType.kind?"array":`array<${i}>`}return o.kind}const Jt=[nf,re,$i,Ki,$a,vi,$h,ta(Yi),N_];function z_(o,i){if("error"===i.kind)return null;if("array"===o.kind){if("array"===i.kind&&(0===i.N&&"value"===i.itemType.kind||!z_(o.itemType,i.itemType))&&("number"!=typeof o.N||o.N===i.N))return null}else{if(o.kind===i.kind)return null;if("value"===o.kind)for(const s of Jt)if(!z_(s,i))return null}return`Expected ${Ar(o)} but found ${Ar(i)} instead.`}function Je(o,i){return i.some(s=>s.kind===o.kind)}function cd(o,i){return i.some(s=>"null"===s?null===o:"array"===s?Array.isArray(o):"object"===s?o&&!Array.isArray(o)&&"object"==typeof o:s===typeof o)}var b0,y0={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function V_(o){return(o=Math.round(o))<0?0:o>255?255:o}function Gh(o){return V_("%"===o[o.length-1]?parseFloat(o)/100*255:parseInt(o))}function nu(o){return(i="%"===o[o.length-1]?parseFloat(o)/100:parseFloat(o))<0?0:i>1?1:i;var i}function rf(o,i,s){return s<0?s+=1:s>1&&(s-=1),6*s<1?o+(i-o)*s*6:2*s<1?i:3*s<2?o+(i-o)*(2/3-s)*6:o}try{b0={}.parseCSSColor=function(o){var i,s=o.replace(/ /g,"").toLowerCase();if(s in y0)return y0[s].slice();if("#"===s[0])return 4===s.length?(i=parseInt(s.substr(1),16))>=0&&i<=4095?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null:7===s.length&&(i=parseInt(s.substr(1),16))>=0&&i<=16777215?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null;var l=s.indexOf("("),d=s.indexOf(")");if(-1!==l&&d+1===s.length){var u=s.substr(0,l),m=s.substr(l+1,d-(l+1)).split(","),p=1;switch(u){case"rgba":if(4!==m.length)return null;p=nu(m.pop());case"rgb":return 3!==m.length?null:[Gh(m[0]),Gh(m[1]),Gh(m[2]),p];case"hsla":if(4!==m.length)return null;p=nu(m.pop());case"hsl":if(3!==m.length)return null;var g=(parseFloat(m[0])%360+360)%360/360,_=nu(m[1]),y=nu(m[2]),v=y<=.5?y*(_+1):y+_-y*_,w=2*y-v;return[V_(255*rf(w,v,g+1/3)),V_(255*rf(w,v,g)),V_(255*rf(w,v,g-1/3)),p];default:return null}}return null}}catch{}class ss{constructor(i,s,l,d=1){this.r=i,this.g=s,this.b=l,this.a=d}static parse(i){if(!i)return;if(i instanceof ss)return i;if("string"!=typeof i)return;const s=b0(i);return s?new ss(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[i,s,l,d]=this.toArray();return`rgba(${Math.round(i)},${Math.round(s)},${Math.round(l)},${d})`}toArray(){const{r:i,g:s,b:l,a:d}=this;return 0===d?[0,0,0,0]:[255*i/d,255*s/d,255*l/d,d]}toArray01(){const{r:i,g:s,b:l,a:d}=this;return 0===d?[0,0,0,0]:[i/d,s/d,l/d,d]}toArray01Scaled(i){const{r:s,g:l,b:d,a:u}=this;return 0===u?[0,0,0]:[s/u*i,l/u*i,d/u*i]}toArray01PremultipliedAlpha(){const{r:i,g:s,b:l,a:d}=this;return[i,s,l,d]}toArray01Linear(){const{r:i,g:s,b:l,a:d}=this;return 0===d?[0,0,0,0]:[Math.pow(i/d,2.2),Math.pow(s/d,2.2),Math.pow(l/d,2.2),d]}}ss.black=new ss(0,0,0,1),ss.white=new ss(1,1,1,1),ss.transparent=new ss(0,0,0,0),ss.red=new ss(1,0,0,1),ss.blue=new ss(0,0,1,1);var di=ss;class hn{constructor(i,s,l){this.sensitivity=i?s?"variant":"case":s?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,s){return this.collator.compare(i,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class sf{constructor(i,s,l,d,u){this.text=i.normalize?i.normalize():i,this.image=s,this.scale=l,this.fontStack=d,this.textColor=u}}class as{constructor(i){this.sections=i}static fromString(i){return new as([new sf(i,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(i=>0!==i.text.length||i.image&&0!==i.image.namePrimary.length)}static factory(i){return i instanceof as?i:as.fromString(i)}toString(){return 0===this.sections.length?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const s of this.sections){if(s.image){i.push(["image",s.image.namePrimary]);continue}i.push(s.text);const l={};s.fontStack&&(l["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(l["font-scale"]=s.scale),s.textColor&&(l["text-color"]=["rgba"].concat(s.textColor.toArray())),i.push(l)}return i}}class fr{constructor(i){this.namePrimary=i.namePrimary,i.nameSecondary&&(this.nameSecondary=i.nameSecondary),this.available=i.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(i,s){return i?new fr({namePrimary:i,nameSecondary:s,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function v0(o,i,s,l){return"number"==typeof o&&o>=0&&o<=255&&"number"==typeof i&&i>=0&&i<=255&&"number"==typeof s&&s>=0&&s<=255?void 0===l||"number"==typeof l&&l>=0&&l<=1?null:`Invalid rgba value [${[o,i,s,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof l?[o,i,s,l]:[o,i,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function af(o){if(null===o||"string"==typeof o||"boolean"==typeof o||"number"==typeof o||o instanceof di||o instanceof hn||o instanceof as||o instanceof fr)return!0;if(Array.isArray(o)){for(const i of o)if(!af(i))return!1;return!0}if("object"==typeof o){for(const i in o)if(!af(o[i]))return!1;return!0}return!1}function zi(o){if(null===o)return nf;if("string"==typeof o)return $i;if("boolean"==typeof o)return Ki;if("number"==typeof o)return re;if(o instanceof di)return $a;if(o instanceof hn)return os;if(o instanceof as)return vi;if(o instanceof fr)return N_;if(Array.isArray(o)){const i=o.length;let s;for(const l of o){const d=zi(l);if(s){if(s===d)continue;s=Yi;break}s=d}return ta(s||Yi,i)}return $h}function j_(o){const i=typeof o;return null===o?"":"string"===i||"number"===i||"boolean"===i?String(o):o instanceof di||o instanceof as||o instanceof fr?o.toString():JSON.stringify(o)}class aD{constructor(i,s){this.type=i,this.value=s}static parse(i,s){if(2!==i.length)return s.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!af(i[1]))return s.error("invalid value");const l=i[1];let d=zi(l);const u=s.expectedType;return"array"!==d.kind||0!==d.N||!u||"array"!==u.kind||"number"==typeof u.N&&0!==u.N||(d=u),new aD(d,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof di?["rgba"].concat(this.value.toArray()):this.value instanceof as?this.value.serialize():this.value}}var kt=aD,Hr=class{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}};const lf={string:$i,number:re,boolean:Ki,object:$h};class U_{constructor(i,s){this.type=i,this.args=s}static parse(i,s){if(i.length<2)return s.error("Expected at least one argument.");let l,d=1;const u=i[0];if("array"===u){let p,g;if(i.length>2){const _=i[1];if("string"!=typeof _||!(_ in lf)||"object"===_)return s.error('The item type argument of "array" must be one of string, number, boolean',1);p=lf[_],d++}else p=Yi;if(i.length>3){if(null!==i[2]&&("number"!=typeof i[2]||i[2]<0||i[2]!==Math.floor(i[2])))return s.error('The length argument to "array" must be a positive integer literal',2);g=i[2],d++}l=ta(p,g)}else l=lf[u];const m=[];for(;d<i.length;d++){const p=s.parse(i[d],d,Yi);if(!p)return null;m.push(p)}return new U_(l,m)}evaluate(i){for(let s=0;s<this.args.length;s++){const l=this.args[s].evaluate(i);if(!z_(this.type,zi(l)))return l;if(s===this.args.length-1)throw new Hr(`Expected value to be of type ${Ar(this.type)}, but found ${Ar(zi(l))} instead.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,s=[i.kind];if("array"===i.kind){const l=i.itemType;if("string"===l.kind||"number"===l.kind||"boolean"===l.kind){s.push(l.kind);const d=i.N;("number"==typeof d||this.args.length>1)&&s.push(d)}}return s.concat(this.args.map(l=>l.serialize()))}}var Ga=U_;class cf{constructor(i){this.type=vi,this.sections=i}static parse(i,s){if(i.length<2)return s.error("Expected at least one argument.");const l=i[1];if(!Array.isArray(l)&&"object"==typeof l)return s.error("First argument must be an image or text section.");const d=[];let u=!1;for(let m=1;m<=i.length-1;++m){const p=i[m];if(u&&"object"==typeof p&&!Array.isArray(p)){u=!1;let g=null;if(p["font-scale"]&&(g=s.parse(p["font-scale"],1,re),!g))return null;let _=null;if(p["text-font"]&&(_=s.parse(p["text-font"],1,ta($i)),!_))return null;let y=null;if(p["text-color"]&&(y=s.parse(p["text-color"],1,$a),!y))return null;const v=d[d.length-1];v.scale=g,v.font=_,v.textColor=y}else{const g=s.parse(i[m],1,Yi);if(!g)return null;const _=g.type.kind;if("string"!==_&&"value"!==_&&"null"!==_&&"resolvedImage"!==_)return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");u=!0,d.push({content:g,scale:null,font:null,textColor:null})}}return new cf(d)}evaluate(i){return new as(this.sections.map(s=>{const l=s.content.evaluate(i);return zi(l)===N_?new sf("",l,null,null,null):new sf(j_(l),null,s.scale?s.scale.evaluate(i):null,s.font?s.font.evaluate(i).join(","):null,s.textColor?s.textColor.evaluate(i):null)}))}eachChild(i){for(const s of this.sections)i(s.content),s.scale&&i(s.scale),s.font&&i(s.font),s.textColor&&i(s.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const s of this.sections){i.push(s.content.serialize());const l={};s.scale&&(l["font-scale"]=s.scale.serialize()),s.font&&(l["text-font"]=s.font.serialize()),s.textColor&&(l["text-color"]=s.textColor.serialize()),i.push(l)}return i}}class ru{constructor(i,s){this.type=N_,this.inputPrimary=i,this.inputSecondary=s}static parse(i,s){if(i.length<2)return s.error("Expected two or more arguments.");const l=s.parse(i[1],1,$i);if(!l)return s.error("No image name provided.");if(2===i.length)return new ru(l);const d=s.parse(i[2],1,$i);return d?new ru(l,d):s.error("Secondary image variant is not a string.")}evaluate(i){const s=fr.fromString(this.inputPrimary.evaluate(i),this.inputSecondary?this.inputSecondary.evaluate(i):void 0);return s&&i.availableImages&&(s.available=i.availableImages.indexOf(s.namePrimary)>-1,s.nameSecondary&&s.available&&i.availableImages&&(s.available=i.availableImages.indexOf(s.nameSecondary)>-1)),s}eachChild(i){i(this.inputPrimary),this.inputSecondary&&i(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function pn(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":null===o?"null":typeof o}const F3={"to-boolean":Ki,"to-color":$a,"to-number":re,"to-string":$i};class lD{constructor(i,s){this.type=i,this.args=s}static parse(i,s){if(i.length<2)return s.error("Expected at least one argument.");const l=i[0],d=[];let u=nf;if("to-array"===l){if(!Array.isArray(i[1]))return null;const m=i[1].length;if(s.expectedType){if("array"!==s.expectedType.kind)return s.error(`Expected ${s.expectedType.kind} but found array.`);u=ta(s.expectedType.itemType,m)}else{if(!(m>0&&af(i[1][0])))return null;u=ta(zi(i[1][0]),m)}for(let p=0;p<m;p++){const g=i[1][p];let _;if("array"===pn(g))_=s.parse(g,void 0,u.itemType);else{const y=pn(g);if(y!==u.itemType.kind)return s.error(`Expected ${u.itemType.kind} but found ${y}.`);_=s.registry.literal.parse(["literal",void 0===g?null:g],s)}if(!_)return null;d.push(_)}}else{if(("to-boolean"===l||"to-string"===l)&&2!==i.length)return s.error("Expected one argument.");u=F3[l];for(let m=1;m<i.length;m++){const p=s.parse(i[m],m,Yi);if(!p)return null;d.push(p)}}return new lD(u,d)}evaluate(i){if("boolean"===this.type.kind)return!!this.args[0].evaluate(i);if("color"===this.type.kind){let s,l;for(const d of this.args){if(s=d.evaluate(i),l=null,s instanceof di)return s;if("string"==typeof s){const u=i.parseColor(s);if(u)return u}else if(Array.isArray(s)&&(l=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:v0(s[0],s[1],s[2],s[3]),!l))return new di(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Hr(l||`Could not parse color from value '${"string"==typeof s?s:String(JSON.stringify(s))}'`)}if("number"===this.type.kind){let s=null;for(const l of this.args){if(s=l.evaluate(i),null===s)return 0;const d=Number(s);if(!isNaN(d))return d}throw new Hr(`Could not convert ${JSON.stringify(s)} to number.`)}return"formatted"===this.type.kind?as.fromString(j_(this.args[0].evaluate(i))):"resolvedImage"===this.type.kind?fr.fromString(j_(this.args[0].evaluate(i))):"array"===this.type.kind?this.args.map(s=>s.evaluate(i)):j_(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if("formatted"===this.type.kind)return new cf([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ru(this.args[0]).serialize();const i="array"===this.type.kind?[]:[`to-${this.type.kind}`];return this.eachChild(s=>{i.push(s.serialize())}),i}}var Wh=lD;const L3=["Unknown","Point","LineString","Polygon"];var qh=class{constructor(o){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.options=o}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?L3[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(o){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,i=this.featureDistanceData.scale,{x:s,y:l}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(s*i-o[0])+this.featureDistanceData.bearing[1]*(l*i-o[1])}return 0}parseColor(o){let i=this._parseColorCache[o];return i||(i=this._parseColorCache[o]=di.parse(o)),i}getConfig(o){return this.options?this.options.get(o):null}};class _c{constructor(i,s,l,d,u){this.name=i,this.type=s,this._evaluate=l,this.args=d,this._overloadIndex=u}evaluate(i){if(!this._evaluate){const s=_c.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,s){const l=i[0],d=_c.definitions[l];if(!d)return s.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const u=Array.isArray(d)?d[0]:d.type,m=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,p=[];let g=null,_=-1;for(const[y,v]of m){if(Array.isArray(y)&&y.length!==i.length-1)continue;p.push(y),_++,g=new E0(s.registry,s.path,null,s.scope,void 0,s.options);const w=[];let C=!1;for(let D=1;D<i.length;D++){const k=i[D],S=Array.isArray(y)?y[D-1]:y.type,E=g.parse(k,1+w.length,S);if(!E){C=!0;break}w.push(E)}if(!C)if(Array.isArray(y)&&y.length!==w.length)g.error(`Expected ${y.length} arguments, but found ${w.length} instead.`);else{for(let D=0;D<w.length;D++){const k=Array.isArray(y)?y[D]:y.type,S=w[D];g.concat(D+1).checkSubtype(k,S.type)}if(0===g.errors.length)return new _c(l,u,v,w,_)}}if(1===p.length)s.errors.push(...g.errors);else{const y=(p.length?p:m.map(([w])=>w)).map(H_).join(" | "),v=[];for(let w=1;w<i.length;w++){const C=s.parse(i[w],1+v.length);if(!C)return null;v.push(Ar(C.type))}s.error(`Expected arguments of type ${y}, but found (${v.join(", ")}) instead.`)}return null}static register(i,s){_c.definitions=s;for(const l in s)i[l]=_c}}function H_(o){return Array.isArray(o)?`(${o.map(Ar).join(", ")})`:`(${Ar(o.type)}...)`}var Pl=_c;class $_{constructor(i,s,l){this.type=os,this.locale=l,this.caseSensitive=i,this.diacriticSensitive=s}static parse(i,s){if(2!==i.length)return s.error("Expected one argument.");const l=i[1];if("object"!=typeof l||Array.isArray(l))return s.error("Collator options argument must be an object.");const d=s.parse(void 0!==l["case-sensitive"]&&l["case-sensitive"],1,Ki);if(!d)return null;const u=s.parse(void 0!==l["diacritic-sensitive"]&&l["diacritic-sensitive"],1,Ki);if(!u)return null;let m=null;return l.locale&&(m=s.parse(l.locale,1,$i),!m)?null:new $_(d,u,m)}evaluate(i){return new hn(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}var cD={exports:{}};cD.exports=function(){function o(l,d,u,m,p){for(;m>u;){if(m-u>600){var g=m-u+1,_=d-u+1,y=Math.log(g),v=.5*Math.exp(2*y/3),w=.5*Math.sqrt(y*v*(g-v)/g)*(_-g/2<0?-1:1);o(l,d,Math.max(u,Math.floor(d-_*v/g+w)),Math.min(m,Math.floor(d+(g-_)*v/g+w)),p)}var C=l[d],D=u,k=m;for(i(l,u,d),p(l[m],C)>0&&i(l,u,m);D<k;){for(i(l,D,k),D++,k--;p(l[D],C)<0;)D++;for(;p(l[k],C)>0;)k--}0===p(l[u],C)?i(l,u,k):i(l,++k,m),k<=d&&(u=k+1),d<=k&&(m=k-1)}}function i(l,d,u){var m=l[d];l[d]=l[u],l[u]=m}function s(l,d){return l<d?-1:l>d?1:0}return function(l,d,u,m,p){o(l,d,u||0,m||l.length-1,p||s)}}();var dD=Ds(cD.exports);function Yh(o){let i=0;for(let s,l,d=0,u=o.length,m=u-1;d<u;m=d++)s=o[d],l=o[m],i+=(l.x-s.x)*(s.y+l.y);return i}function df(o,i){o[0]=Math.min(o[0],i[0]),o[1]=Math.min(o[1],i[1]),o[2]=Math.max(o[2],i[0]),o[3]=Math.max(o[3],i[1])}function Ca(o,i){return!(o[0]<=i[0]||o[2]>=i[2]||o[1]<=i[1]||o[3]>=i[3])}function vR(o,i,s){const l=o[0]-i[0],d=o[1]-i[1],u=o[0]-s[0],m=o[1]-s[1];return l*m-u*d==0&&l*u<=0&&d*m<=0}function vt(o,i,s=!1){let l=!1;for(let p=0,g=i.length;p<g;p++){const _=i[p];for(let y=0,v=_.length,w=v-1;y<v;w=y++){const C=_[w],D=_[y];if(vR(o,C,D))return s;(u=C)[1]>(d=o)[1]!=(m=D)[1]>d[1]&&d[0]<(m[0]-u[0])*(d[1]-u[1])/(m[1]-u[1])+u[0]&&(l=!l)}}var d,u,m;return l}function x0(o,i,s,l){const d=l[0]-s[0],u=l[1]-s[1],m=(o[0]-s[0])*u-d*(o[1]-s[1]),p=(i[0]-s[0])*u-d*(i[1]-s[1]);return m>0&&p<0||m<0&&p>0}function oe(o,i,s,l){return(d=[l[0]-s[0],l[1]-s[1]])[0]*(u=[i[0]-o[0],i[1]-o[1]])[1]-d[1]*u[0]!=0&&!(!x0(o,i,s,l)||!x0(s,l,o,i));var d,u}const Wa=8192;function w0(o,i){const s=(180+o[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,d=Math.pow(2,i.z);return[Math.round(s*d*Wa),Math.round(l*d*Wa)]}function uf(o,i){for(let s=0;s<i.length;s++)if(vt(o,i[s]))return!0;return!1}function xR(o,i,s){for(const l of s)for(let d=0,u=l.length,m=u-1;d<u;m=d++)if(oe(o,i,l[m],l[d]))return!0;return!1}function uD(o,i){for(let s=0;s<o.length;++s)if(!vt(o[s],i))return!1;for(let s=0;s<o.length-1;++s)if(xR(o[s],o[s+1],i))return!1;return!0}function wR(o,i){for(let s=0;s<i.length;s++)if(uD(o,i[s]))return!0;return!1}function qa(o,i,s){const l=[];for(let d=0;d<o.length;d++){const u=[];for(let m=0;m<o[d].length;m++){const p=w0(o[d][m],s);df(i,p),u.push(p)}l.push(u)}return l}function hf(o,i,s){const l=[];for(let d=0;d<o.length;d++){const u=qa(o[d],i,s);l.push(u)}return l}function ea(o,i,s,l){if(o[0]<s[0]||o[0]>s[2]){const d=.5*l;let u=o[0]-s[0]>d?-l:s[0]-o[0]>d?l:0;0===u&&(u=o[0]-s[2]>d?-l:s[2]-o[0]>d?l:0),o[0]+=u}df(i,o)}function Ya(o,i,s,l){const d=Math.pow(2,l.z)*Wa,u=[l.x*Wa,l.y*Wa],m=[];if(!o)return m;for(const p of o)for(const g of p){const _=[g.x+u[0],g.y+u[1]];ea(_,i,s,d),m.push(_)}return m}function Rn(o,i,s,l){const d=Math.pow(2,l.z)*Wa,u=[l.x*Wa,l.y*Wa],m=[];if(!o)return m;for(const g of o){const _=[];for(const y of g){const v=[y.x+u[0],y.y+u[1]];df(i,v),_.push(v)}m.push(_)}if(i[2]-i[0]<=d/2){(p=i)[0]=p[1]=1/0,p[2]=p[3]=-1/0;for(const g of m)for(const _ of g)ea(_,i,s,d)}var p;return m}class dd{constructor(i,s){this.type=Ki,this.geojson=i,this.geometries=s}static parse(i,s){if(2!==i.length)return s.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(af(i[1])){const l=i[1];if("FeatureCollection"===l.type)for(let d=0;d<l.features.length;++d){const u=l.features[d].geometry.type;if("Polygon"===u||"MultiPolygon"===u)return new dd(l,l.features[d].geometry)}else if("Feature"===l.type){const d=l.geometry.type;if("Polygon"===d||"MultiPolygon"===d)return new dd(l,l.geometry)}else if("Polygon"===l.type||"MultiPolygon"===l.type)return new dd(l,l)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(null!=i.geometry()&&null!=i.canonicalID()){if("Point"===i.geometryType())return function(s,l){const d=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],m=s.canonicalID();if(!m)return!1;if("Polygon"===l.type){const p=qa(l.coordinates,u,m),g=Ya(s.geometry(),d,u,m);if(!Ca(d,u))return!1;for(const _ of g)if(!vt(_,p))return!1}if("MultiPolygon"===l.type){const p=hf(l.coordinates,u,m),g=Ya(s.geometry(),d,u,m);if(!Ca(d,u))return!1;for(const _ of g)if(!uf(_,p))return!1}return!0}(i,this.geometries);if("LineString"===i.geometryType())return function(s,l){const d=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],m=s.canonicalID();if(!m)return!1;if("Polygon"===l.type){const p=qa(l.coordinates,u,m),g=Rn(s.geometry(),d,u,m);if(!Ca(d,u))return!1;for(const _ of g)if(!uD(_,p))return!1}if("MultiPolygon"===l.type){const p=hf(l.coordinates,u,m),g=Rn(s.geometry(),d,u,m);if(!Ca(d,u))return!1;for(const _ of g)if(!wR(_,p))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var mf=dd,G_={exports:{}};G_.exports=function(){var o={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},i=1/298.257223563,s=i*(2-i),l=Math.PI/180,d=function(_,y){if(void 0===_)throw new Error("No latitude given.");if(y&&!o[y])throw new Error("Unknown unit "+y+". Use one of: "+Object.keys(o).join(", "));var v=6378.137*l*(y?o[y]:1),w=Math.cos(_*l),C=1/(1-s*(1-w*w)),D=Math.sqrt(C);this.kx=v*D*w,this.ky=v*D*C*(1-s)},u={units:{configurable:!0}};function m(_,y){return _[0]===y[0]&&_[1]===y[1]}function p(_,y,v){var w=g(y[0]-_[0]);return[_[0]+w*v,_[1]+(y[1]-_[1])*v]}function g(_){for(;_<-180;)_+=360;for(;_>180;)_-=360;return _}return d.fromTile=function(_,y,v){var w=Math.PI*(1-2*(_+.5)/Math.pow(2,y)),C=Math.atan(.5*(Math.exp(w)-Math.exp(-w)))/l;return new d(C,v)},u.units.get=function(){return o},d.prototype.distance=function(_,y){var v=g(_[0]-y[0])*this.kx,w=(_[1]-y[1])*this.ky;return Math.sqrt(v*v+w*w)},d.prototype.bearing=function(_,y){var v=g(y[0]-_[0])*this.kx;return Math.atan2(v,(y[1]-_[1])*this.ky)/l},d.prototype.destination=function(_,y,v){var w=v*l;return this.offset(_,Math.sin(w)*y,Math.cos(w)*y)},d.prototype.offset=function(_,y,v){return[_[0]+y/this.kx,_[1]+v/this.ky]},d.prototype.lineDistance=function(_){for(var y=0,v=0;v<_.length-1;v++)y+=this.distance(_[v],_[v+1]);return y},d.prototype.area=function(_){for(var y=0,v=0;v<_.length;v++)for(var w=_[v],C=0,D=w.length,k=D-1;C<D;k=C++)y+=g(w[C][0]-w[k][0])*(w[C][1]+w[k][1])*(v?-1:1);return Math.abs(y)/2*this.kx*this.ky},d.prototype.along=function(_,y){var v=0;if(y<=0)return _[0];for(var w=0;w<_.length-1;w++){var C=_[w],D=_[w+1],k=this.distance(C,D);if((v+=k)>y)return p(C,D,(y-(v-k))/k)}return _[_.length-1]},d.prototype.pointToSegmentDistance=function(_,y,v){var w=y[0],C=y[1],D=g(v[0]-w)*this.kx,k=(v[1]-C)*this.ky,S=0;return 0===D&&0===k||((S=(g(_[0]-w)*this.kx*D+(_[1]-C)*this.ky*k)/(D*D+k*k))>1?(w=v[0],C=v[1]):S>0&&(w+=D/this.kx*S,C+=k/this.ky*S)),D=g(_[0]-w)*this.kx,k=(_[1]-C)*this.ky,Math.sqrt(D*D+k*k)},d.prototype.pointOnLine=function(_,y){for(var v,w,C,D,k=1/0,S=0;S<_.length-1;S++){var E=_[S][0],A=_[S][1],P=g(_[S+1][0]-E)*this.kx,O=(_[S+1][1]-A)*this.ky,R=0;0===P&&0===O||((R=(g(y[0]-E)*this.kx*P+(y[1]-A)*this.ky*O)/(P*P+O*O))>1?(E=_[S+1][0],A=_[S+1][1]):R>0&&(E+=P/this.kx*R,A+=O/this.ky*R));var F=(P=g(y[0]-E)*this.kx)*P+(O=(y[1]-A)*this.ky)*O;F<k&&(k=F,v=E,w=A,C=S,D=R)}return{point:[v,w],index:C,t:Math.max(0,Math.min(1,D))}},d.prototype.lineSlice=function(_,y,v){var w=this.pointOnLine(v,_),C=this.pointOnLine(v,y);if(w.index>C.index||w.index===C.index&&w.t>C.t){var D=w;w=C,C=D}var k=[w.point],S=w.index+1,E=C.index;!m(v[S],k[0])&&S<=E&&k.push(v[S]);for(var A=S+1;A<=E;A++)k.push(v[A]);return m(v[E],C.point)||k.push(C.point),k},d.prototype.lineSliceAlong=function(_,y,v){for(var w=0,C=[],D=0;D<v.length-1;D++){var k=v[D],S=v[D+1],E=this.distance(k,S);if((w+=E)>_&&0===C.length&&C.push(p(k,S,(_-(w-E))/E)),w>=y)return C.push(p(k,S,(y-(w-E))/E)),C;w>_&&C.push(S)}return C},d.prototype.bufferPoint=function(_,y){var v=y/this.ky,w=y/this.kx;return[_[0]-w,_[1]-v,_[0]+w,_[1]+v]},d.prototype.bufferBBox=function(_,y){var v=y/this.ky,w=y/this.kx;return[_[0]-w,_[1]-v,_[2]+w,_[3]+v]},d.prototype.insideBBox=function(_,y){return g(_[0]-y[0])>=0&&g(_[0]-y[2])<=0&&_[1]>=y[1]&&_[1]<=y[3]},Object.defineProperties(d,u),d}();var W_=Ds(G_.exports),Ol={exports:{}};Ol.exports=function(){var o=function(s,l){if(void 0===s&&(s=[]),void 0===l&&(l=i),this.data=s,this.length=this.data.length,this.compare=l,this.length>0)for(var d=(this.length>>1)-1;d>=0;d--)this._down(d)};function i(s,l){return s<l?-1:s>l?1:0}return o.prototype.push=function(s){this.data.push(s),this.length++,this._up(this.length-1)},o.prototype.pop=function(){if(0!==this.length){var s=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),s}},o.prototype.peek=function(){return this.data[0]},o.prototype._up=function(s){for(var l=this.data,d=this.compare,u=l[s];s>0;){var m=s-1>>1,p=l[m];if(d(u,p)>=0)break;l[s]=p,s=m}l[s]=u},o.prototype._down=function(s){for(var l=this.data,d=this.compare,u=this.length>>1,m=l[s];s<u;){var p=1+(s<<1),g=l[p],_=p+1;if(_<this.length&&d(l[_],g)<0&&(p=_,g=l[_]),d(g,m)>=0)break;l[s]=g,s=p}l[s]=m},o}();var ou=Ds(Ol.exports),pt=8192;function C0(o,i){return i.dist-o.dist}const pf=100,q_=50;function M0(o){const i=[1/0,1/0,-1/0,-1/0];if(i.length!==o.length)return!1;for(let s=0;s<i.length;s++)if(i[s]!==o[s])return!1;return!0}function ud(o){return o[1]-o[0]+1}function Fl(o,i){const s=o[1]>=o[0]&&o[1]<i;return s||console.warn("Distance Expression: Index is out of range"),s}function Y_(o,i){if(o[0]>o[1])return[null,null];const s=ud(o);if(i){if(2===s)return[o,null];const l=Math.floor(s/2);return[[o[0],o[0]+l],[o[0]+l,o[1]]]}{if(1===s)return[o,null];const l=Math.floor(s/2)-1;return[[o[0],o[0]+l],[o[0]+l+1,o[1]]]}}function su(o,i){const s=[1/0,1/0,-1/0,-1/0];if(!Fl(i,o.length))return s;for(let l=i[0];l<=i[1];++l)df(s,o[l]);return s}function ff(o){const i=[1/0,1/0,-1/0,-1/0];for(let s=0;s<o.length;++s)for(let l=0;l<o[s].length;++l)df(i,o[s][l]);return i}function Zh(o,i,s){if(M0(o)||M0(i))return NaN;let l=0,d=0;return o[2]<i[0]&&(l=i[0]-o[2]),o[0]>i[2]&&(l=o[0]-i[2]),o[1]>i[3]&&(d=o[1]-i[3]),o[3]<i[1]&&(d=i[1]-o[3]),s.distance([0,0],[l,d])}function D0(o,i){const s=Math.pow(2,i.z);return[(d=(o.x/pt+i.x)/s,360*d-180),(l=(o.y/pt+i.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,d}function Za(o,i){const s=[];for(let l=0;l<o.length;++l)s.push(D0(o[l],i));return s}function hD(o,i,s){const l=s.pointOnLine(i,o).point;return s.distance(o,l)}function k0(o,i,s,l,d){const u=s.slice(l[0],l[1]+1);let m=1/0;for(let p=i[0];p<=i[1];++p)if(0===(m=Math.min(m,hD(o[p],u,d))))return 0;return m}function S0(o,i,s,l,d){const u=Math.min(d.pointToSegmentDistance(o,s,l),d.pointToSegmentDistance(i,s,l)),m=Math.min(d.pointToSegmentDistance(s,o,i),d.pointToSegmentDistance(l,o,i));return Math.min(u,m)}function CR(o,i,s,l,d){if(!Fl(i,o.length)||!Fl(l,s.length))return NaN;let u=1/0;for(let m=i[0];m<i[1];++m)for(let p=l[0];p<l[1];++p){if(oe(o[m],o[m+1],s[p],s[p+1]))return 0;u=Math.min(u,S0(o[m],o[m+1],s[p],s[p+1],d))}return u}function MR(o,i,s,l,d){if(!Fl(i,o.length)||!Fl(l,s.length))return NaN;let u=1/0;for(let m=i[0];m<=i[1];++m)for(let p=l[0];p<=l[1];++p)if(0===(u=Math.min(u,d.distance(o[m],s[p]))))return u;return u}function DR(o,i,s){if(vt(o,i,!0))return 0;let l=1/0;for(const d of i){const u=d.length;if(u<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(d[0]!==d[u-1]&&0===(l=Math.min(l,s.pointToSegmentDistance(o,d[u-1],d[0])))||0===(l=Math.min(l,hD(o,d,s))))return l}return l}function mD(o,i,s,l){if(!Fl(i,o.length))return NaN;for(let u=i[0];u<=i[1];++u)if(vt(o[u],s,!0))return 0;let d=1/0;for(let u=i[0];u<i[1];++u)for(const m of s)for(let p=0,g=m.length,_=g-1;p<g;_=p++){if(oe(o[u],o[u+1],m[_],m[p]))return 0;d=Math.min(d,S0(o[u],o[u+1],m[_],m[p],l))}return d}function pD(o,i){for(const s of o)for(let l=0;l<=s.length-1;++l)if(vt(s[l],i,!0))return!0;return!1}function kR(o,i,s,l=1/0){const d=ff(o),u=ff(i);if(l!==1/0&&Zh(d,u,s)>=l)return l;if(Ca(d,u)){if(pD(o,i))return 0}else if(pD(i,o))return 0;let m=l;for(const p of o)for(let g=0,_=p.length,y=_-1;g<_;y=g++)for(const v of i)for(let w=0,C=v.length,D=C-1;w<C;D=w++){if(oe(p[y],p[g],v[D],v[w]))return 0;m=Math.min(m,S0(p[y],p[g],v[D],v[w],s))}return m}function Z_(o,i,s,l,d,u,m){if(null===u||null===m)return;const p=Zh(su(l,u),su(d,m),s);p<i&&o.push({dist:p,range1:u,range2:m})}function Ye(o,i,s,l,d=1/0){let u=Math.min(l.distance(o[0],s[0][0]),d);if(0===u)return u;const m=new ou([{dist:0,range1:[0,o.length-1],range2:[0,0]}],C0),p=i?q_:pf,g=ff(s);for(;m.length;){const _=m.pop();if(_.dist>=u)continue;const y=_.range1;if(ud(y)<=p){if(!Fl(y,o.length))return NaN;if(i){const v=mD(o,y,s,l);if(0===(u=Math.min(u,v)))return u}else for(let v=y[0];v<=y[1];++v){const w=DR(o[v],s,l);if(0===(u=Math.min(u,w)))return u}}else{const v=Y_(y,i);if(null!==v[0]){const w=Zh(su(o,v[0]),g,l);w<u&&m.push({dist:w,range1:v[0],range2:[0,0]})}if(null!==v[1]){const w=Zh(su(o,v[1]),g,l);w<u&&m.push({dist:w,range1:v[1],range2:[0,0]})}}}return u}function fD(o,i,s,l,d,u=1/0){let m=Math.min(u,d.distance(o[0],s[0]));if(0===m)return m;const p=new ou([{dist:0,range1:[0,o.length-1],range2:[0,s.length-1]}],C0),g=i?q_:pf,_=l?q_:pf;for(;p.length;){const y=p.pop();if(y.dist>=m)continue;const v=y.range1,w=y.range2;if(ud(v)<=g&&ud(w)<=_){if(!Fl(v,o.length)||!Fl(w,s.length))return NaN;if(i&&l?m=Math.min(m,CR(o,v,s,w,d)):i||l?i&&!l?m=Math.min(m,k0(s,w,o,v,d)):!i&&l&&(m=Math.min(m,k0(o,v,s,w,d))):m=Math.min(m,MR(o,v,s,w,d)),0===m)return m}else{const C=Y_(v,i),D=Y_(w,l);Z_(p,m,d,o,s,C[0],D[0]),Z_(p,m,d,o,s,C[0],D[1]),Z_(p,m,d,o,s,C[1],D[0]),Z_(p,m,d,o,s,C[1],D[1])}}return m}function T0(o,i,s,l,d=1/0){let u=d;const m=su(o,[0,o.length-1]);for(const p of s)if(!(u!==1/0&&Zh(m,su(p,[0,p.length-1]),l)>=u)&&(u=Math.min(u,fD(o,i,p,!0,l,u)),0===u))return u;return u}function X_(o,i,s,l,d=1/0){let u=d;const m=su(o,[0,o.length-1]);for(const p of s){if(u!==1/0&&Zh(m,ff(p),l)>=u)continue;const g=Ye(o,i,p,l,u);if(isNaN(g))return g;if(0===(u=Math.min(u,g)))return u}return u}function ei(o){return"Point"===o||"MultiPoint"===o||"LineString"===o||"MultiLineString"===o||"Polygon"===o||"MultiPolygon"===o}class gf{constructor(i,s){this.type=re,this.geojson=i,this.geometries=s}static parse(i,s){if(2!==i.length)return s.error(`'distance' expression requires either one argument, but found ' ${i.length-1} instead.`);if(af(i[1])){const l=i[1];if("FeatureCollection"===l.type){for(let d=0;d<l.features.length;++d)if(ei(l.features[d].geometry.type))return new gf(l,l.features[d].geometry)}else if("Feature"===l.type){if(ei(l.geometry.type))return new gf(l,l.geometry)}else if(ei(l.type))return new gf(l,l)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(i){const s=i.geometry(),l=i.canonicalID();if(null!=s&&null!=l){if("Point"===i.geometryType())return function(d,u,m){const p=[];for(const _ of d)for(const y of _)p.push(D0(y,u));const g=new W_(p[0][1],"meters");return"Point"===m.type||"MultiPoint"===m.type||"LineString"===m.type?fD(p,!1,"Point"===m.type?[m.coordinates]:m.coordinates,"LineString"===m.type,g):"MultiLineString"===m.type?T0(p,!1,m.coordinates,g):"Polygon"===m.type||"MultiPolygon"===m.type?X_(p,!1,"Polygon"===m.type?[m.coordinates]:m.coordinates,g):null}(s,l,this.geometries);if("LineString"===i.geometryType())return function(d,u,m){const p=[];for(const _ of d){const y=[];for(const v of _)y.push(D0(v,u));p.push(y)}const g=new W_(p[0][0][1],"meters");if("Point"===m.type||"MultiPoint"===m.type||"LineString"===m.type)return T0("Point"===m.type?[m.coordinates]:m.coordinates,"LineString"===m.type,p,g);if("MultiLineString"===m.type){let _=1/0;for(let y=0;y<m.coordinates.length;y++){const v=T0(m.coordinates[y],!0,p,g,_);if(isNaN(v))return v;if(0===(_=Math.min(_,v)))return _}return _}if("Polygon"===m.type||"MultiPolygon"===m.type){let _=1/0;for(let y=0;y<p.length;y++){const v=X_(p[y],!0,"Polygon"===m.type?[m.coordinates]:m.coordinates,g,_);if(isNaN(v))return v;if(0===(_=Math.min(_,v)))return _}return _}return null}(s,l,this.geometries);if("Polygon"===i.geometryType())return function(d,u,m){const p=[];for(const _ of function(y,v){const w=y.length;if(w<=1)return[y];const C=[];let D,k;for(let S=0;S<w;S++){const E=Yh(y[S]);0!==E&&(y[S].area=Math.abs(E),void 0===k&&(k=E<0),k===E<0?(D&&C.push(D),D=[y[S]]):D.push(y[S]))}return D&&C.push(D),C}(d)){const y=[];for(let v=0;v<_.length;++v)y.push(Za(_[v],u));p.push(y)}const g=new W_(p[0][0][0][1],"meters");if("Point"===m.type||"MultiPoint"===m.type||"LineString"===m.type)return X_("Point"===m.type?[m.coordinates]:m.coordinates,"LineString"===m.type,p,g);if("MultiLineString"===m.type){let _=1/0;for(let y=0;y<m.coordinates.length;y++){const v=X_(m.coordinates[y],!0,p,g,_);if(isNaN(v))return v;if(0===(_=Math.min(_,v)))return _}return _}return"Polygon"===m.type||"MultiPolygon"===m.type?function(_,y,v){let w=1/0;for(const C of _)for(const D of y){const k=kR(C,D,v,w);if(isNaN(k))return k;if(0===(w=Math.min(w,k)))return w}return w}("Polygon"===m.type?[m.coordinates]:m.coordinates,p,g):null}(s,l,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var K_=gf;function Mt(o){if(o instanceof Pl&&("get"===o.name&&1===o.args.length||"feature-state"===o.name||"has"===o.name&&1===o.args.length||"properties"===o.name||"geometry-type"===o.name||"id"===o.name||/^filter-/.test(o.name))||o instanceof mf||o instanceof K_)return!1;let i=!0;return o.eachChild(s=>{i&&!Mt(s)&&(i=!1)}),i}function ko(o){if(o instanceof Pl&&"feature-state"===o.name)return!1;let i=!0;return o.eachChild(s=>{i&&!ko(s)&&(i=!1)}),i}function yn(o){if(o instanceof Pl&&"config"===o.name)return!1;let i=!0;return o.eachChild(s=>{i&&!yn(s)&&(i=!1)}),i}function $r(o,i){if(o instanceof Pl&&i.indexOf(o.name)>=0)return!1;let s=!0;return o.eachChild(l=>{s&&!$r(l,i)&&(s=!1)}),s}class No{constructor(i,s){this.type=s.type,this.name=i,this.boundExpression=s}static parse(i,s){if(2!==i.length||"string"!=typeof i[1])return s.error("'var' expression requires exactly one string literal argument.");const l=i[1];return s.scope.has(l)?new No(l,s.scope.get(l)):s.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var au=No;class ls{constructor(i,s=[],l,d=new O3,u=[],m){this.registry=i,this.path=s,this.key=s.map(p=>`[${p}]`).join(""),this.scope=d,this.errors=u,this.expectedType=l,this.options=m}parse(i,s,l,d,u={}){return s||l?this.concat(s,l,d)._parse(i,u):this._parse(i,u)}_parse(i,s){function l(d,u,m){return"assert"===m?new Ga(u,[d]):"coerce"===m?new Wh(u,[d]):d}if(null!==i&&"string"!=typeof i&&"boolean"!=typeof i&&"number"!=typeof i||(i=["literal",i]),Array.isArray(i)){if(0===i.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d="string"==typeof i[0]?this.registry[i[0]]:void 0;if(d){let u=d.parse(i,this);if(!u)return null;if(this.expectedType){const m=this.expectedType,p=u.type;if("string"!==m.kind&&"number"!==m.kind&&"boolean"!==m.kind&&"object"!==m.kind&&"array"!==m.kind||"value"!==p.kind)if("color"!==m.kind&&"formatted"!==m.kind&&"resolvedImage"!==m.kind||"value"!==p.kind&&"string"!==p.kind){if(this.checkSubtype(m,p))return null}else u=l(u,m,s.typeAnnotation||"coerce");else u=l(u,m,s.typeAnnotation||"assert")}if(!(u instanceof kt)&&"resolvedImage"!==u.type.kind&&Q_(u)){const m=new qh(this.options);try{u=new kt(u.type,u.evaluate(m))}catch(p){return this.error(p.message),null}}return u}return Wh.parse(["to-array",i],this)}return this.error(void 0===i?"'undefined' value invalid. Use null instead.":"object"==typeof i?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,s,l){const d="number"==typeof i?this.path.concat(i):this.path,u=l?this.scope.concat(l):this.scope;return new ls(this.registry,d,s||null,u,this.errors,this.options)}error(i,...s){const l=`${this.key}${s.map(d=>`[${d}]`).join("")}`;this.errors.push(new fc(l,i))}checkSubtype(i,s){const l=z_(i,s);return l&&this.error(l),l}}var E0=ls;function Q_(o){if(o instanceof au)return Q_(o.boundExpression);if(o instanceof Pl&&"error"===o.name||o instanceof Pl&&"config"===o.name||o instanceof $_||o instanceof mf||o instanceof K_)return!1;const i=o instanceof Wh||o instanceof Ga;let s=!0;return o.eachChild(l=>{s=i?s&&Q_(l):s&&l instanceof kt}),!!s&&Mt(o)&&$r(o,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function lu(o,i){const s=o.length-1;let l,d,u=0,m=s,p=0;for(;u<=m;)if(p=Math.floor((u+m)/2),l=o[p],d=o[p+1],l<=i){if(p===s||i<d)return p;u=p+1}else{if(!(l>i))throw new Hr("Input is not a number.");m=p-1}return 0}class A0{constructor(i,s,l){this.type=i,this.input=s,this.labels=[],this.outputs=[];for(const[d,u]of l)this.labels.push(d),this.outputs.push(u)}static parse(i,s){if(i.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return s.error("Expected an even number of arguments.");const l=s.parse(i[1],1,re);if(!l)return null;const d=[];let u=null;s.expectedType&&"value"!==s.expectedType.kind&&(u=s.expectedType);for(let m=1;m<i.length;m+=2){const p=1===m?-1/0:i[m],g=i[m+1],_=m,y=m+1;if("number"!=typeof p)return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',_);if(d.length&&d[d.length-1][0]>=p)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',_);const v=s.parse(g,y,u);if(!v)return null;u=u||v.type,d.push([p,v])}return new A0(u,l,d)}evaluate(i){const s=this.labels,l=this.outputs;if(1===s.length)return l[0].evaluate(i);const d=this.input.evaluate(i);if(d<=s[0])return l[0].evaluate(i);const u=s.length;return d>=s[u-1]?l[u-1].evaluate(i):l[lu(s,d)].evaluate(i)}eachChild(i){i(this.input);for(const s of this.outputs)i(s)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&i.push(this.labels[s]),i.push(this.outputs[s].serialize());return i}}var I0=A0;function _e(o,i,s){return o*(1-s)+i*s}function Ie(o,i,s){return o.map((l,d)=>_e(l,i[d],s))}var Vi=Object.freeze({__proto__:null,array:Ie,color:function(o,i,s){return new di(_e(o.r,i.r,s),_e(o.g,i.g,s),_e(o.b,i.b,s),_e(o.a,i.a,s))},number:_e});const Xh=4/29,Zr=6/29,cu=3*Zr*Zr,Xr=Zr*Zr*Zr,hd=Math.PI/180,Kh=180/Math.PI;function Bi(o){return o>Xr?Math.pow(o,1/3):o/cu+Xh}function du(o){return o>Zr?o*o*o:cu*(o-Xh)}function J_(o){return 255*(o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055)}function md(o){return(o/=255)<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function Gr(o){const i=md(o.r),s=md(o.g),l=md(o.b),d=Bi((.4124564*i+.3575761*s+.1804375*l)/.95047),u=Bi((.2126729*i+.7151522*s+.072175*l)/1);return{l:116*u-16,a:500*(d-u),b:200*(u-Bi((.0193339*i+.119192*s+.9503041*l)/1.08883)),alpha:o.a}}function Qh(o){let i=(o.l+16)/116,s=isNaN(o.a)?i:i+o.a/500,l=isNaN(o.b)?i:i-o.b/200;return i=1*du(i),s=.95047*du(s),l=1.08883*du(l),new di(J_(3.2404542*s-1.5371385*i-.4985314*l),J_(-.969266*s+1.8760108*i+.041556*l),J_(.0556434*s-.2040259*i+1.0572252*l),o.alpha)}function Jh(o,i,s){const l=i-o;return o+s*(l>180||l<-180?l-360*Math.round(l/360):l)}const Ts={forward:Gr,reverse:Qh,interpolate:function(o,i,s){return{l:_e(o.l,i.l,s),a:_e(o.a,i.a,s),b:_e(o.b,i.b,s),alpha:_e(o.alpha,i.alpha,s)}}},bc={forward:function(o){const{l:i,a:s,b:l}=Gr(o),d=Math.atan2(l,s)*Kh;return{h:d<0?d+360:d,c:Math.sqrt(s*s+l*l),l:i,alpha:o.a}},reverse:function(o){const i=o.h*hd,s=o.c;return Qh({l:o.l,a:Math.cos(i)*s,b:Math.sin(i)*s,alpha:o.alpha})},interpolate:function(o,i,s){return{h:Jh(o.h,i.h,s),c:_e(o.c,i.c,s),l:_e(o.l,i.l,s),alpha:_e(o.alpha,i.alpha,s)}}};var R0=Object.freeze({__proto__:null,hcl:bc,lab:Ts});class Xa{constructor(i,s,l,d,u){this.type=i,this.operator=s,this.interpolation=l,this.input=d,this.labels=[],this.outputs=[];for(const[m,p]of u)this.labels.push(m),this.outputs.push(p)}static interpolationFactor(i,s,l,d){let u=0;if("exponential"===i.name)u=Ka(s,i.base,l,d);else if("linear"===i.name)u=Ka(s,1,l,d);else if("cubic-bezier"===i.name){const m=i.controlPoints;u=new R_(m[0],m[1],m[2],m[3]).solve(Ka(s,1,l,d))}return u}static parse(i,s){let[l,d,u,...m]=i;if(!Array.isArray(d)||0===d.length)return s.error("Expected an interpolation type expression.",1);if("linear"===d[0])d={name:"linear"};else if("exponential"===d[0]){const _=d[1];if("number"!=typeof _)return s.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:_}}else{if("cubic-bezier"!==d[0])return s.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const _=d.slice(1);if(4!==_.length||_.some(y=>"number"!=typeof y||y<0||y>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:_}}}if(i.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(u=s.parse(u,2,re),!u)return null;const p=[];let g=null;"interpolate-hcl"===l||"interpolate-lab"===l?g=$a:s.expectedType&&"value"!==s.expectedType.kind&&(g=s.expectedType);for(let _=0;_<m.length;_+=2){const y=m[_],v=m[_+1],w=_+3,C=_+4;if("number"!=typeof y)return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',w);if(p.length&&p[p.length-1][0]>=y)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',w);const D=s.parse(v,C,g);if(!D)return null;g=g||D.type,p.push([y,D])}return"number"===g.kind||"color"===g.kind||"array"===g.kind&&"number"===g.itemType.kind&&"number"==typeof g.N?new Xa(g,l,d,u,p):s.error(`Type ${Ar(g)} is not interpolatable.`)}evaluate(i){const s=this.labels,l=this.outputs;if(1===s.length)return l[0].evaluate(i);const d=this.input.evaluate(i);if(d<=s[0])return l[0].evaluate(i);const u=s.length;if(d>=s[u-1])return l[u-1].evaluate(i);const m=lu(s,d),p=Xa.interpolationFactor(this.interpolation,d,s[m],s[m+1]),g=l[m].evaluate(i),_=l[m+1].evaluate(i);return"interpolate"===this.operator?Vi[this.type.kind.toLowerCase()](g,_,p):"interpolate-hcl"===this.operator?bc.reverse(bc.interpolate(bc.forward(g),bc.forward(_),p)):Ts.reverse(Ts.interpolate(Ts.forward(g),Ts.forward(_),p))}eachChild(i){i(this.input);for(const s of this.outputs)i(s)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,i,this.input.serialize()];for(let l=0;l<this.labels.length;l++)s.push(this.labels[l],this.outputs[l].serialize());return s}}function Ka(o,i,s,l){const d=l-s,u=o-s;return 0===d?0:1===i?u/d:(Math.pow(i,u)-1)/(Math.pow(i,d)-1)}var Es=Xa;class uu{constructor(i,s){this.type=i,this.args=s}static parse(i,s){if(i.length<2)return s.error("Expectected at least one argument.");let l=null;const d=s.expectedType;d&&"value"!==d.kind&&(l=d);const u=[];for(const p of i.slice(1)){const g=s.parse(p,1+u.length,l,void 0,{typeAnnotation:"omit"});if(!g)return null;l=l||g.type,u.push(g)}const m=d&&u.some(p=>z_(d,p.type));return new uu(m?Yi:l,u)}evaluate(i){let s,l=null,d=0;for(const u of this.args){if(d++,l=u.evaluate(i),l&&l instanceof fr&&!l.available&&(s||(s=l),l=null,d===this.args.length))return s;if(null!==l)break}return l}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(s=>{i.push(s.serialize())}),i}}var fn=uu;class gD{constructor(i,s){this.type=s.type,this.bindings=[].concat(i),this.result=s}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const s of this.bindings)i(s[1]);i(this.result)}static parse(i,s){if(i.length<4)return s.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const l=[];for(let u=1;u<i.length-1;u+=2){const m=i[u];if("string"!=typeof m)return s.error(`Expected string, but found ${typeof m} instead.`,u);if(/[^a-zA-Z0-9_]/.test(m))return s.error("Variable names must contain only alphanumeric characters or '_'.",u);const p=s.parse(i[u+1],u+1);if(!p)return null;l.push([m,p])}const d=s.parse(i[i.length-1],i.length-1,s.expectedType,l);return d?new gD(l,d):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[s,l]of this.bindings)i.push(s,l.serialize());return i.push(this.result.serialize()),i}}var tb=gD;class eb{constructor(i,s,l){this.type=i,this.index=s,this.input=l}static parse(i,s){if(3!==i.length)return s.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const l=s.parse(i[1],1,re),d=s.parse(i[2],2,ta(s.expectedType||Yi));return l&&d?new eb(d.type.itemType,l,d):null}evaluate(i){const s=this.index.evaluate(i),l=this.input.evaluate(i);if(s<0)throw new Hr(`Array index out of bounds: ${s} < 0.`);if(s>=l.length)throw new Hr(`Array index out of bounds: ${s} > ${l.length-1}.`);if(s!==Math.floor(s))throw new Hr(`Array index must be an integer, but found ${s} instead.`);return l[s]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Ll=eb;class tm{constructor(i,s){this.type=Ki,this.needle=i,this.haystack=s}static parse(i,s){if(3!==i.length)return s.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const l=s.parse(i[1],1,Yi),d=s.parse(i[2],2,Yi);return l&&d?Je(l.type,[Ki,$i,re,nf,Yi])?new tm(l,d):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ar(l.type)} instead`):null}evaluate(i){const s=this.needle.evaluate(i),l=this.haystack.evaluate(i);if(null==l)return!1;if(!cd(s,["boolean","string","number","null"]))throw new Hr(`Expected first argument to be of type boolean, string, number or null, but found ${Ar(zi(s))} instead.`);if(!cd(l,["string","array"]))throw new Hr(`Expected second argument to be of type array or string, but found ${Ar(zi(l))} instead.`);return l.indexOf(s)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var em=tm;class pd{constructor(i,s,l){this.type=re,this.needle=i,this.haystack=s,this.fromIndex=l}static parse(i,s){if(i.length<=2||i.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const l=s.parse(i[1],1,Yi),d=s.parse(i[2],2,Yi);if(!l||!d)return null;if(!Je(l.type,[Ki,$i,re,nf,Yi]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ar(l.type)} instead`);if(4===i.length){const u=s.parse(i[3],3,re);return u?new pd(l,d,u):null}return new pd(l,d)}evaluate(i){const s=this.needle.evaluate(i),l=this.haystack.evaluate(i);if(!cd(s,["boolean","string","number","null"]))throw new Hr(`Expected first argument to be of type boolean, string, number or null, but found ${Ar(zi(s))} instead.`);if(!cd(l,["string","array"]))throw new Hr(`Expected second argument to be of type array or string, but found ${Ar(zi(l))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(i);return l.indexOf(s,d)}return l.indexOf(s)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var zo=pd;class _D{constructor(i,s,l,d,u,m){this.inputType=i,this.type=s,this.input=l,this.cases=d,this.outputs=u,this.otherwise=m}static parse(i,s){if(i.length<5)return s.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return s.error("Expected an even number of arguments.");let l,d;s.expectedType&&"value"!==s.expectedType.kind&&(d=s.expectedType);const u={},m=[];for(let _=2;_<i.length-1;_+=2){let y=i[_];const v=i[_+1];Array.isArray(y)||(y=[y]);const w=s.concat(_);if(0===y.length)return w.error("Expected at least one branch label.");for(const D of y){if("number"!=typeof D&&"string"!=typeof D)return w.error("Branch labels must be numbers or strings.");if("number"==typeof D&&Math.abs(D)>Number.MAX_SAFE_INTEGER)return w.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof D&&Math.floor(D)!==D)return w.error("Numeric branch labels must be integer values.");if(l){if(w.checkSubtype(l,zi(D)))return null}else l=zi(D);if(void 0!==u[String(D)])return w.error("Branch labels must be unique.");u[String(D)]=m.length}const C=s.parse(v,_,d);if(!C)return null;d=d||C.type,m.push(C)}const p=s.parse(i[1],1,Yi);if(!p)return null;const g=s.parse(i[i.length-1],i.length-1,d);return g?"value"!==p.type.kind&&s.concat(1).checkSubtype(l,p.type)?null:new _D(l,d,p,u,m,g):null}evaluate(i){const s=this.input.evaluate(i);return(zi(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),l=[],d={};for(const m of s){const p=d[this.cases[m]];void 0===p?(d[this.cases[m]]=l.length,l.push([this.cases[m],[m]])):l[p][1].push(m)}const u=m=>"number"===this.inputType.kind?Number(m):m;for(const[m,p]of l)i.push(1===p.length?u(p[0]):p.map(u)),i.push(this.outputs[m].serialize());return i.push(this.otherwise.serialize()),i}}var As=_D;class Vo{constructor(i,s,l){this.type=i,this.branches=s,this.otherwise=l}static parse(i,s){if(i.length<4)return s.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return s.error("Expected an odd number of arguments.");let l;s.expectedType&&"value"!==s.expectedType.kind&&(l=s.expectedType);const d=[];for(let m=1;m<i.length-1;m+=2){const p=s.parse(i[m],m,Ki);if(!p)return null;const g=s.parse(i[m+1],m+1,l);if(!g)return null;d.push([p,g]),l=l||g.type}const u=s.parse(i[i.length-1],i.length-1,l);return u?new Vo(l,d,u):null}evaluate(i){for(const[s,l]of this.branches)if(s.evaluate(i))return l.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[s,l]of this.branches)i(s),i(l);i(this.otherwise)}outputDefined(){return this.branches.every(([i,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(s=>{i.push(s.serialize())}),i}}var P0=Vo;class Bl{constructor(i,s,l,d){this.type=i,this.input=s,this.beginIndex=l,this.endIndex=d}static parse(i,s){if(i.length<=2||i.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const l=s.parse(i[1],1,Yi),d=s.parse(i[2],2,re);if(!l||!d)return null;if(!Je(l.type,[ta(Yi),$i,Yi]))return s.error(`Expected first argument to be of type array or string, but found ${Ar(l.type)} instead`);if(4===i.length){const u=s.parse(i[3],3,re);return u?new Bl(l.type,l,d,u):null}return new Bl(l.type,l,d)}evaluate(i){const s=this.input.evaluate(i),l=this.beginIndex.evaluate(i);if(!cd(s,["string","array"]))throw new Hr(`Expected first argument to be of type array or string, but found ${Ar(zi(s))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(i);return s.slice(l,d)}return s.slice(l)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var ib=Bl;function Da(o,i){return"=="===o||"!="===o?"boolean"===i.kind||"string"===i.kind||"number"===i.kind||"null"===i.kind||"value"===i.kind:"string"===i.kind||"number"===i.kind||"value"===i.kind}function nb(o,i,s,l){return 0===l.compare(i,s)}function im(o,i,s){const l="=="!==o&&"!="!==o;return class bW{constructor(u,m,p){this.type=Ki,this.lhs=u,this.rhs=m,this.collator=p,this.hasUntypedArgument="value"===u.type.kind||"value"===m.type.kind}static parse(u,m){if(3!==u.length&&4!==u.length)return m.error("Expected two or three arguments.");const p=u[0];let g=m.parse(u[1],1,Yi);if(!g)return null;if(!Da(p,g.type))return m.concat(1).error(`"${p}" comparisons are not supported for type '${Ar(g.type)}'.`);let _=m.parse(u[2],2,Yi);if(!_)return null;if(!Da(p,_.type))return m.concat(2).error(`"${p}" comparisons are not supported for type '${Ar(_.type)}'.`);if(g.type.kind!==_.type.kind&&"value"!==g.type.kind&&"value"!==_.type.kind)return m.error(`Cannot compare types '${Ar(g.type)}' and '${Ar(_.type)}'.`);l&&("value"===g.type.kind&&"value"!==_.type.kind?g=new Ga(_.type,[g]):"value"!==g.type.kind&&"value"===_.type.kind&&(_=new Ga(g.type,[_])));let y=null;if(4===u.length){if("string"!==g.type.kind&&"string"!==_.type.kind&&"value"!==g.type.kind&&"value"!==_.type.kind)return m.error("Cannot use collator to compare non-string types.");if(y=m.parse(u[3],3,os),!y)return null}return new bW(g,_,y)}evaluate(u){const m=this.lhs.evaluate(u),p=this.rhs.evaluate(u);if(l&&this.hasUntypedArgument){const g=zi(m),_=zi(p);if(g.kind!==_.kind||"string"!==g.kind&&"number"!==g.kind)throw new Hr(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${g.kind}, ${_.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const g=zi(m),_=zi(p);if("string"!==g.kind||"string"!==_.kind)return i(u,m,p)}return this.collator?s(u,m,p,this.collator.evaluate(u)):i(u,m,p)}eachChild(u){u(this.lhs),u(this.rhs),this.collator&&u(this.collator)}outputDefined(){return!0}serialize(){const u=[o];return this.eachChild(m=>{u.push(m.serialize())}),u}}}const SR=im("==",function(o,i,s){return i===s},nb),B3=im("!=",function(o,i,s){return i!==s},function(o,i,s,l){return!nb(0,i,s,l)}),TR=im("<",function(o,i,s){return i<s},function(o,i,s,l){return l.compare(i,s)<0}),ER=im(">",function(o,i,s){return i>s},function(o,i,s,l){return l.compare(i,s)>0}),N3=im("<=",function(o,i,s){return i<=s},function(o,i,s,l){return l.compare(i,s)<=0}),z3=im(">=",function(o,i,s){return i>=s},function(o,i,s,l){return l.compare(i,s)>=0});class bD{constructor(i,s,l,d,u,m){this.type=$i,this.number=i,this.locale=s,this.currency=l,this.unit=d,this.minFractionDigits=u,this.maxFractionDigits=m}static parse(i,s){if(3!==i.length)return s.error("Expected two arguments.");const l=s.parse(i[1],1,re);if(!l)return null;const d=i[2];if("object"!=typeof d||Array.isArray(d))return s.error("NumberFormat options argument must be an object.");let u=null;if(d.locale&&(u=s.parse(d.locale,1,$i),!u))return null;let m=null;if(d.currency&&(m=s.parse(d.currency,1,$i),!m))return null;let p=null;if(d.unit&&(p=s.parse(d.unit,1,$i),!p))return null;let g=null;if(d["min-fraction-digits"]&&(g=s.parse(d["min-fraction-digits"],1,re),!g))return null;let _=null;return d["max-fraction-digits"]&&(_=s.parse(d["max-fraction-digits"],1,re),!_)?null:new bD(l,u,m,p,g,_)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class yD{constructor(i){this.type=re,this.input=i}static parse(i,s){if(2!==i.length)return s.error(`Expected 1 argument, but found ${i.length-1} instead.`);const l=s.parse(i[1],1);return l?"array"!==l.type.kind&&"string"!==l.type.kind&&"value"!==l.type.kind?s.error(`Expected argument of type string or array, but found ${Ar(l.type)} instead.`):new yD(l):null}evaluate(i){const s=this.input.evaluate(i);if("string"==typeof s||Array.isArray(s))return s.length;throw new Hr(`Expected value to be of type string or array, but found ${Ar(zi(s))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(s=>{i.push(s.serialize())}),i}}function vD(o){return function(){o=1831565813+(o|=0)|0;let i=Math.imul(o^o>>>15,1|o);return i=i+Math.imul(i^i>>>7,61|i)^i,((i^i>>>14)>>>0)/4294967296}}const AR={"==":SR,"!=":B3,">":ER,"<":TR,">=":z3,"<=":N3,array:Ga,at:Ll,boolean:Ga,case:P0,coalesce:fn,collator:$_,format:cf,image:ru,in:em,"index-of":zo,interpolate:Es,"interpolate-hcl":Es,"interpolate-lab":Es,length:yD,let:tb,literal:kt,match:As,number:Ga,"number-format":bD,object:Ga,slice:ib,step:I0,string:Ga,"to-boolean":Wh,"to-color":Wh,"to-number":Wh,"to-string":Wh,var:au,within:mf,distance:K_};function IR(o,[i,s,l,d]){i=i.evaluate(o),s=s.evaluate(o),l=l.evaluate(o);const u=d?d.evaluate(o):1,m=v0(i,s,l,u);if(m)throw new Hr(m);return new di(i/255*u,s/255*u,l/255*u,u)}function RR(o,[i,s,l,d]){i=i.evaluate(o),s=s.evaluate(o),l=l.evaluate(o);const u=d?d.evaluate(o):1,m=(y=s,v=l,w=u,"number"==typeof(_=i)&&_>=0&&_<=360?"number"==typeof y&&y>=0&&y<=100&&"number"==typeof v&&v>=0&&v<=100?void 0===w||"number"==typeof w&&w>=0&&w<=1?null:`Invalid hsla value [${[_,y,v,w].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${("number"==typeof w?[_,y,v,w]:[_,y,v]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${("number"==typeof w?[_,y,v,w]:[_,y,v]).join(", ")}]: 'h' must be between 0 and 360.`);var _,y,v,w;if(m)throw new Hr(m);const p=`hsla(${i}, ${s}%, ${l}%, ${u})`,g=di.parse(p);if(!g)throw new Hr(`Failed to parse HSLA color: ${p}`);return g}function PR(o,i){return o in i}function xD(o,i){const s=i[o];return void 0===s?null:s}function OR(o,i){switch(o){case"string":return String(i);case"number":return+i;case"boolean":return!!i;case"color":return di.parse(i)}return i}function FR(o,i,s,l){return void 0!==l&&(o=l*Math.round(o/l)),void 0!==i&&o<i&&(o=i),void 0!==s&&o>s&&(o=s),o}function O0(o,i,s){s.length&&(i+=`\x1f${s}`);const l=o.getConfig(i);if(!l)return null;const{type:d,value:u,values:m,minValue:p,maxValue:g,stepValue:_}=l,y=l.default.evaluate(o);let v=u?u.evaluate(o):y;return d&&(v=OR(d,v)),void 0!==u&&void 0!==v&&m&&!m.includes(v)&&(v=y,d&&(v=OR(d,v))),void 0===v||void 0===p&&void 0===g&&void 0===_||("number"==typeof v?v=FR(v,p,g,_):Array.isArray(v)&&(v=v.map(w=>"number"==typeof w?FR(w,p,g,_):w))),v}function fd(o){return{type:o}}Pl.register(AR,{error:[{kind:"error"},[$i],(o,[i])=>{throw new Hr(i.evaluate(o))}],typeof:[$i,[Yi],(o,[i])=>Ar(zi(i.evaluate(o)))],"to-rgba":[ta(re,4),[$a],(o,[i])=>i.evaluate(o).toArray()],rgb:[$a,[re,re,re],IR],rgba:[$a,[re,re,re,re],IR],hsl:[$a,[re,re,re],RR],hsla:[$a,[re,re,re,re],RR],has:{type:Ki,overloads:[[[$i],(o,[i])=>PR(i.evaluate(o),o.properties())],[[$i,$h],(o,[i,s])=>PR(i.evaluate(o),s.evaluate(o))]]},get:{type:Yi,overloads:[[[$i],(o,[i])=>xD(i.evaluate(o),o.properties())],[[$i,$h],(o,[i,s])=>xD(i.evaluate(o),s.evaluate(o))]]},config:{type:Yi,overloads:[[[$i],(o,[i])=>O0(o,i.evaluate(o),"")],[[$i,$i],(o,[i,s])=>O0(o,i.evaluate(o),s.evaluate(o))]]},"feature-state":[Yi,[$i],(o,[i])=>xD(i.evaluate(o),o.featureState||{})],properties:[$h,[],o=>o.properties()],"geometry-type":[$i,[],o=>o.geometryType()],id:[Yi,[],o=>o.id()],zoom:[re,[],o=>o.globals.zoom],pitch:[re,[],o=>o.globals.pitch||0],"distance-from-center":[re,[],o=>o.distanceFromCenter()],"measure-light":[re,[$i],(o,[i])=>o.measureLight(i.evaluate(o))],"heatmap-density":[re,[],o=>o.globals.heatmapDensity||0],"line-progress":[re,[],o=>o.globals.lineProgress||0],"raster-value":[re,[],o=>o.globals.rasterValue||0],"sky-radial-progress":[re,[],o=>o.globals.skyRadialProgress||0],accumulated:[Yi,[],o=>void 0===o.globals.accumulated?null:o.globals.accumulated],"+":[re,fd(re),(o,i)=>{let s=0;for(const l of i)s+=l.evaluate(o);return s}],"*":[re,fd(re),(o,i)=>{let s=1;for(const l of i)s*=l.evaluate(o);return s}],"-":{type:re,overloads:[[[re,re],(o,[i,s])=>i.evaluate(o)-s.evaluate(o)],[[re],(o,[i])=>-i.evaluate(o)]]},"/":[re,[re,re],(o,[i,s])=>i.evaluate(o)/s.evaluate(o)],"%":[re,[re,re],(o,[i,s])=>i.evaluate(o)%s.evaluate(o)],ln2:[re,[],()=>Math.LN2],pi:[re,[],()=>Math.PI],e:[re,[],()=>Math.E],"^":[re,[re,re],(o,[i,s])=>Math.pow(i.evaluate(o),s.evaluate(o))],sqrt:[re,[re],(o,[i])=>Math.sqrt(i.evaluate(o))],log10:[re,[re],(o,[i])=>Math.log(i.evaluate(o))/Math.LN10],ln:[re,[re],(o,[i])=>Math.log(i.evaluate(o))],log2:[re,[re],(o,[i])=>Math.log(i.evaluate(o))/Math.LN2],sin:[re,[re],(o,[i])=>Math.sin(i.evaluate(o))],cos:[re,[re],(o,[i])=>Math.cos(i.evaluate(o))],tan:[re,[re],(o,[i])=>Math.tan(i.evaluate(o))],asin:[re,[re],(o,[i])=>Math.asin(i.evaluate(o))],acos:[re,[re],(o,[i])=>Math.acos(i.evaluate(o))],atan:[re,[re],(o,[i])=>Math.atan(i.evaluate(o))],min:[re,fd(re),(o,i)=>Math.min(...i.map(s=>s.evaluate(o)))],max:[re,fd(re),(o,i)=>Math.max(...i.map(s=>s.evaluate(o)))],abs:[re,[re],(o,[i])=>Math.abs(i.evaluate(o))],round:[re,[re],(o,[i])=>{const s=i.evaluate(o);return s<0?-Math.round(-s):Math.round(s)}],floor:[re,[re],(o,[i])=>Math.floor(i.evaluate(o))],ceil:[re,[re],(o,[i])=>Math.ceil(i.evaluate(o))],"filter-==":[Ki,[$i,Yi],(o,[i,s])=>o.properties()[i.value]===s.value],"filter-id-==":[Ki,[Yi],(o,[i])=>o.id()===i.value],"filter-type-==":[Ki,[$i],(o,[i])=>o.geometryType()===i.value],"filter-<":[Ki,[$i,Yi],(o,[i,s])=>{const l=o.properties()[i.value],d=s.value;return typeof l==typeof d&&l<d}],"filter-id-<":[Ki,[Yi],(o,[i])=>{const s=o.id(),l=i.value;return typeof s==typeof l&&s<l}],"filter->":[Ki,[$i,Yi],(o,[i,s])=>{const l=o.properties()[i.value],d=s.value;return typeof l==typeof d&&l>d}],"filter-id->":[Ki,[Yi],(o,[i])=>{const s=o.id(),l=i.value;return typeof s==typeof l&&s>l}],"filter-<=":[Ki,[$i,Yi],(o,[i,s])=>{const l=o.properties()[i.value],d=s.value;return typeof l==typeof d&&l<=d}],"filter-id-<=":[Ki,[Yi],(o,[i])=>{const s=o.id(),l=i.value;return typeof s==typeof l&&s<=l}],"filter->=":[Ki,[$i,Yi],(o,[i,s])=>{const l=o.properties()[i.value],d=s.value;return typeof l==typeof d&&l>=d}],"filter-id->=":[Ki,[Yi],(o,[i])=>{const s=o.id(),l=i.value;return typeof s==typeof l&&s>=l}],"filter-has":[Ki,[Yi],(o,[i])=>i.value in o.properties()],"filter-has-id":[Ki,[],o=>null!==o.id()&&void 0!==o.id()],"filter-type-in":[Ki,[ta($i)],(o,[i])=>i.value.indexOf(o.geometryType())>=0],"filter-id-in":[Ki,[ta(Yi)],(o,[i])=>i.value.indexOf(o.id())>=0],"filter-in-small":[Ki,[$i,ta(Yi)],(o,[i,s])=>s.value.indexOf(o.properties()[i.value])>=0],"filter-in-large":[Ki,[$i,ta(Yi)],(o,[i,s])=>function(l,d,u,m){for(;u<=m;){const p=u+m>>1;if(d[p]===l)return!0;d[p]>l?m=p-1:u=p+1}return!1}(o.properties()[i.value],s.value,0,s.value.length-1)],all:{type:Ki,overloads:[[[Ki,Ki],(o,[i,s])=>i.evaluate(o)&&s.evaluate(o)],[fd(Ki),(o,i)=>{for(const s of i)if(!s.evaluate(o))return!1;return!0}]]},any:{type:Ki,overloads:[[[Ki,Ki],(o,[i,s])=>i.evaluate(o)||s.evaluate(o)],[fd(Ki),(o,i)=>{for(const s of i)if(s.evaluate(o))return!0;return!1}]]},"!":[Ki,[Ki],(o,[i])=>!i.evaluate(o)],"is-supported-script":[Ki,[$i],(o,[i])=>{const s=o.globals&&o.globals.isSupportedScript;return!s||s(i.evaluate(o))}],upcase:[$i,[$i],(o,[i])=>i.evaluate(o).toUpperCase()],downcase:[$i,[$i],(o,[i])=>i.evaluate(o).toLowerCase()],concat:[$i,fd(Yi),(o,i)=>i.map(s=>j_(s.evaluate(o))).join("")],"resolved-locale":[$i,[os],(o,[i])=>i.evaluate(o).resolvedLocale()],random:[re,[re,re,Yi],(o,i)=>{const[s,l,d]=i.map(m=>m.evaluate(o));if(s>l||s===l)return s;let u;if("string"==typeof d)u=function(m){let p=0;if(0===m.length)return p;for(let g=0;g<m.length;g++)p=(p<<5)-p+m.charCodeAt(g),p&=p;return p}(d);else{if("number"!=typeof d)throw new Hr(`Invalid seed input: ${d}`);u=d}return s+vD(u)()*(l-s)}]});var rb=AR;function LR(o){return{result:"success",value:o}}function nm(o){return{result:"error",value:o}}function gd(o,i){return!!o&&!!o.parameters&&o.parameters.indexOf(i)>-1}function Is(o){return"data-driven"===o["property-type"]}function BR(o){return gd(o.expression,"measure-light")}function wD(o){return gd(o.expression,"zoom")}function ho(o){return!!o.expression&&o.expression.interpolated}function hu(o){return"object"==typeof o&&null!==o&&!Array.isArray(o)}function ka(o){return o}function F0(o,i){const s="color"===i.type,l=o.stops&&"object"==typeof o.stops[0][0],d=l||!(l||void 0!==o.property),u=o.type||(ho(i)?"exponential":"interval");if(s&&((o=Ha({},o)).stops&&(o.stops=o.stops.map(_=>[_[0],di.parse(_[1])])),o.default=di.parse(o.default?o.default:i.default)),o.colorSpace&&"rgb"!==o.colorSpace&&!R0[o.colorSpace])throw new Error(`Unknown color space: ${o.colorSpace}`);let m,p,g;if("exponential"===u)m=ob;else if("interval"===u)m=MD;else if("categorical"===u){m=CD,p=Object.create(null);for(const _ of o.stops)p[_[0]]=_[1];g=typeof o.stops[0][0]}else{if("identity"!==u)throw new Error(`Unknown function type "${u}"`);m=DD}if(l){const _={},y=[];for(let C=0;C<o.stops.length;C++){const D=o.stops[C],k=D[0].zoom;void 0===_[k]&&(_[k]={zoom:k,type:o.type,property:o.property,default:o.default,stops:[]},y.push(k)),_[k].stops.push([D[0].value,D[1]])}const v=[];for(const C of y)v.push([_[C].zoom,F0(_[C],i)]);const w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:Es.interpolationFactor.bind(void 0,w),zoomStops:v.map(C=>C[0]),evaluate:({zoom:C},D)=>ob({stops:v,base:o.base},i,C).evaluate(C,D)}}if(d){const _="exponential"===u?{name:"exponential",base:void 0!==o.base?o.base:1}:null;return{kind:"camera",interpolationType:_,interpolationFactor:Es.interpolationFactor.bind(void 0,_),zoomStops:o.stops.map(y=>y[0]),evaluate:({zoom:y})=>m(o,i,y,p,g)}}return{kind:"source",evaluate(_,y){const v=y&&y.properties?y.properties[o.property]:void 0;return void 0===v?rm(o.default,i.default):m(o,i,v,p,g)}}}function rm(o,i,s){return void 0!==o?o:void 0!==i?i:void 0!==s?s:void 0}function CD(o,i,s,l,d){return rm(typeof s===d?l[s]:void 0,o.default,i.default)}function MD(o,i,s){if("number"!==pn(s))return rm(o.default,i.default);const l=o.stops.length;if(1===l||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[l-1][0])return o.stops[l-1][1];const d=lu(o.stops.map(u=>u[0]),s);return o.stops[d][1]}function ob(o,i,s){const l=void 0!==o.base?o.base:1;if("number"!==pn(s))return rm(o.default,i.default);const d=o.stops.length;if(1===d||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[d-1][0])return o.stops[d-1][1];const u=lu(o.stops.map(y=>y[0]),s),m=function(y,v,w,C){const D=C-w,k=y-w;return 0===D?0:1===v?k/D:(Math.pow(v,k)-1)/(Math.pow(v,D)-1)}(s,l,o.stops[u][0],o.stops[u+1][0]),p=o.stops[u][1],g=o.stops[u+1][1];let _=Vi[i.type]||ka;if(o.colorSpace&&"rgb"!==o.colorSpace){const y=R0[o.colorSpace];_=(v,w)=>y.reverse(y.interpolate(y.forward(v),y.forward(w),m))}return"function"==typeof p.evaluate?{evaluate(...y){const v=p.evaluate.apply(void 0,y),w=g.evaluate.apply(void 0,y);if(void 0!==v&&void 0!==w)return _(v,w,m)}}:_(p,g,m)}function DD(o,i,s){return"color"===i.type?s=di.parse(s):"formatted"===i.type?s=as.fromString(s.toString()):"resolvedImage"===i.type?s=fr.fromString(s.toString()):pn(s)===i.type||"enum"===i.type&&i.values[s]||(s=void 0),rm(s,o.default,i.default)}class _f{constructor(i,s,l){var d;this.expression=i,this._warningHistory={},this._evaluator=new qh(l),this._defaultValue=s?"color"===(d=s).type&&(hu(d.default)||Array.isArray(d.default))?new di(0,0,0,0):"color"===d.type?di.parse(d.default)||null:void 0===d.default?null:d.default:null,this._enumValues=s&&"enum"===s.type?s.values:null}evaluateWithoutErrorHandling(i,s,l,d,u,m,p,g){return this._evaluator.globals=i,this._evaluator.feature=s,this._evaluator.featureState=l,this._evaluator.canonical=d||null,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=p||null,this._evaluator.featureDistanceData=g||null,this.expression.evaluate(this._evaluator)}evaluate(i,s,l,d,u,m,p,g){this._evaluator.globals=i,this._evaluator.feature=s||null,this._evaluator.featureState=l||null,this._evaluator.canonical=d||null,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=p||null,this._evaluator.featureDistanceData=g||null;try{const _=this.expression.evaluate(this._evaluator);if(null==_||"number"==typeof _&&_!=_)return this._defaultValue;if(this._enumValues&&!(_ in this._enumValues))throw new Hr(`Expected value to be one of ${Object.keys(this._enumValues).map(y=>JSON.stringify(y)).join(", ")}, but found ${JSON.stringify(_)} instead.`);return _}catch(_){return this._warningHistory[_.message]||(this._warningHistory[_.message]=!0,typeof console<"u"&&console.warn(_.message)),this._defaultValue}}}function om(o){return Array.isArray(o)&&o.length>0&&"string"==typeof o[0]&&o[0]in rb}function yc(o,i,s){const l=new E0(rb,[],i?function(u){const m={color:$a,string:$i,number:re,enum:$i,boolean:Ki,formatted:vi,resolvedImage:N_};return"array"===u.type?ta(m[u.value]||Yi,u.length):m[u.type]}(i):void 0,void 0,void 0,s),d=l.parse(o,void 0,void 0,void 0,i&&"string"===i.type?{typeAnnotation:"coerce"}:void 0);return d?LR(new _f(d,i,s)):nm(l.errors)}class sb{constructor(i,s,l){this.kind=i,this._styleExpression=s,this.isLightConstant=l,this.isStateDependent="constant"!==i&&!ko(s.expression),this.isConfigDependent=!yn(s.expression)}evaluateWithoutErrorHandling(i,s,l,d,u,m){return this._styleExpression.evaluateWithoutErrorHandling(i,s,l,d,u,m)}evaluate(i,s,l,d,u,m){return this._styleExpression.evaluate(i,s,l,d,u,m)}}class vc{constructor(i,s,l,d,u){this.kind=i,this.zoomStops=l,this._styleExpression=s,this.isStateDependent="camera"!==i&&!ko(s.expression),this.isLightConstant=u,this.isConfigDependent=!yn(s.expression),this.interpolationType=d}evaluateWithoutErrorHandling(i,s,l,d,u,m){return this._styleExpression.evaluateWithoutErrorHandling(i,s,l,d,u,m)}evaluate(i,s,l,d,u,m){return this._styleExpression.evaluate(i,s,l,d,u,m)}interpolationFactor(i,s,l){return this.interpolationType?Es.interpolationFactor(this.interpolationType,i,s,l):0}}function sm(o,i,s){if("error"===(o=yc(o,i,s)).result)return o;const l=o.value.expression,d=Mt(l);if(!d&&!Is(i))return nm([new fc("","data expressions not supported")]);const u=$r(l,["zoom","pitch","distance-from-center"]);if(!u&&!wD(i))return nm([new fc("","zoom expressions not supported")]);const m=$r(l,["measure-light"]);if(!m&&!BR(i))return nm([new fc("","measure-light expression not supported")]);const p=i.expression&&i.expression.relaxZoomRestriction,g=xc(l);return g||u||p?g instanceof fc?nm([g]):g instanceof Es&&!ho(i)?nm([new fc("",'"interpolate" expressions cannot be used with this property')]):LR(g?new vc(d?"camera":"composite",o.value,g.labels,g instanceof Es?g.interpolation:void 0,m):new sb(d?"constant":"source",o.value,m)):nm([new fc("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class _d{constructor(i,s){this._parameters=i,this._specification=s,Ha(this,F0(this._parameters,this._specification))}static deserialize(i){return new _d(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function xc(o){let i=null;if(o instanceof tb)i=xc(o.result);else if(o instanceof fn){for(const s of o.args)if(i=xc(s),i)break}else(o instanceof I0||o instanceof Es)&&o.input instanceof Pl&&"zoom"===o.input.name&&(i=o);return i instanceof fc||o.eachChild(s=>{const l=xc(s);l instanceof fc?i=l:i&&l&&i!==l&&(i=new fc("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function ia(o){const i=o.key,s=o.value,l=o.valueSpec||{},d=o.objectElementValidators||{},u=o.style,m=o.styleSpec;let p=[];const g=pn(s);if("object"!==g)return[new le(i,s,`object expected, ${g} found`)];for(const _ in s){const y=_.split(".")[0];let v;d[y]?v=d[y]:l[y]?v=no:d["*"]?v=d["*"]:l["*"]&&(v=no),v?p=p.concat(v({key:(i&&`${i}.`)+_,value:s[_],valueSpec:l[y]||l["*"],style:u,styleSpec:m,object:s,objectKey:_},s)):p.push(new iu(i,s[_],`unknown property "${_}"`))}for(const _ in l)d[_]||l[_].required&&void 0===l[_].default&&void 0===s[_]&&p.push(new le(i,s,`missing required property "${_}"`));return p}function NR(o){const i=o.value,s=o.valueSpec,l=o.style,d=o.styleSpec,u=o.key,m=o.arrayElementValidator||no;if("array"!==pn(i))return[new le(u,i,`array expected, ${pn(i)} found`)];if(s.length&&i.length!==s.length)return[new le(u,i,`array length ${s.length} expected, length ${i.length} found`)];if(s["min-length"]&&i.length<s["min-length"])return[new le(u,i,`array length at least ${s["min-length"]} expected, length ${i.length} found`)];let p={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};d.$version<7&&(p.function=s.function),"object"===pn(s.value)&&(p=s.value);let g=[];for(let _=0;_<i.length;_++)g=g.concat(m({array:i,arrayIndex:_,value:i[_],valueSpec:p,style:l,styleSpec:d,key:`${u}[${_}]`},!0));return g}function zR(o){const i=o.key,s=o.value,l=o.valueSpec;let d=pn(s);if("number"===d&&s!=s&&(d="NaN"),"number"!==d)return[new le(i,s,`number expected, ${d} found`)];if("minimum"in l){let u=l.minimum;if("array"===pn(l.minimum)&&(u=l.minimum[o.arrayIndex]),s<u)return[new le(i,s,`${s} is less than the minimum value ${u}`)]}if("maximum"in l){let u=l.maximum;if("array"===pn(l.maximum)&&(u=l.maximum[o.arrayIndex]),s>u)return[new le(i,s,`${s} is greater than the maximum value ${u}`)]}return[]}function VR(o){const i=o.valueSpec,s=Cn(o.value.type);let l,d,u,m={};const p="categorical"!==s&&void 0===o.value.property,g=!p,_="array"===pn(o.value.stops)&&"array"===pn(o.value.stops[0])&&"object"===pn(o.value.stops[0][0]),y=ia({key:o.key,value:o.value,valueSpec:o.styleSpec.function,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(C){if("identity"===s)return[new le(C.key,C.value,'identity function may not have a "stops" property')];let D=[];const k=C.value;return D=D.concat(NR({key:C.key,value:k,valueSpec:C.valueSpec,style:C.style,styleSpec:C.styleSpec,arrayElementValidator:v})),"array"===pn(k)&&0===k.length&&D.push(new le(C.key,k,"array must have at least one stop")),D},default:function(C){return no({key:C.key,value:C.value,valueSpec:i,style:C.style,styleSpec:C.styleSpec})}}});return"identity"===s&&p&&y.push(new le(o.key,o.value,'missing required property "property"')),"identity"===s||o.value.stops||y.push(new le(o.key,o.value,'missing required property "stops"')),"exponential"===s&&o.valueSpec.expression&&!ho(o.valueSpec)&&y.push(new le(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(g&&!Is(o.valueSpec)?y.push(new le(o.key,o.value,"property functions not supported")):p&&!wD(o.valueSpec)&&y.push(new le(o.key,o.value,"zoom functions not supported"))),"categorical"!==s&&!_||void 0!==o.value.property||y.push(new le(o.key,o.value,'"property" property is required')),y;function v(C){let D=[];const k=C.value,S=C.key;if("array"!==pn(k))return[new le(S,k,`array expected, ${pn(k)} found`)];if(2!==k.length)return[new le(S,k,`array length 2 expected, length ${k.length} found`)];if(_){if("object"!==pn(k[0]))return[new le(S,k,`object expected, ${pn(k[0])} found`)];if(void 0===k[0].zoom)return[new le(S,k,"object stop key must have zoom")];if(void 0===k[0].value)return[new le(S,k,"object stop key must have value")];const E=Cn(k[0].zoom);if("number"!=typeof E)return[new le(S,k[0].zoom,"stop zoom values must be numbers")];if(u&&u>E)return[new le(S,k[0].zoom,"stop zoom values must appear in ascending order")];E!==u&&(u=E,d=void 0,m={}),D=D.concat(ia({key:`${S}[0]`,value:k[0],valueSpec:{zoom:{}},style:C.style,styleSpec:C.styleSpec,objectElementValidators:{zoom:zR,value:w}}))}else D=D.concat(w({key:`${S}[0]`,value:k[0],valueSpec:{},style:C.style,styleSpec:C.styleSpec},k));return om(ld(k[1]))?D.concat([new le(`${S}[1]`,k[1],"expressions are not allowed in function stops.")]):D.concat(no({key:`${S}[1]`,value:k[1],valueSpec:i,style:C.style,styleSpec:C.styleSpec}))}function w(C,D){const k=pn(C.value),S=Cn(C.value),E=null!==C.value?C.value:D;if(l){if(k!==l)return[new le(C.key,E,`${k} stop domain type must match previous stop domain type ${l}`)]}else l=k;if("number"!==k&&"string"!==k&&"boolean"!==k&&"number"!=typeof S&&"string"!=typeof S&&"boolean"!=typeof S)return[new le(C.key,E,"stop domain value must be a number, string, or boolean")];if("number"!==k&&"categorical"!==s){let A=`number expected, ${k} found`;return Is(i)&&void 0===s&&(A+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new le(C.key,E,A)]}return"categorical"!==s||"number"!==k||"number"==typeof S&&isFinite(S)&&Math.floor(S)===S?"categorical"!==s&&"number"===k&&"number"==typeof S&&"number"==typeof d&&void 0!==d&&S<d?[new le(C.key,E,"stop domain values must appear in ascending order")]:(d=S,"categorical"===s&&S in m?[new le(C.key,E,"stop domain values must be unique")]:(m[S]=!0,[])):[new le(C.key,E,`integer expected, found ${String(S)}`)]}}function mu(o){const i=("property"===o.expressionContext?sm:yc)(ld(o.value),o.valueSpec);if("error"===i.result)return i.value.map(l=>new le(`${o.key}${l.key}`,o.value,l.message));const s=i.value.expression||i.value._styleExpression.expression;if("property"===o.expressionContext&&"text-font"===o.propertyKey&&!s.outputDefined())return[new le(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===o.expressionContext&&"layout"===o.propertyType&&!ko(s))return[new le(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===o.expressionContext)return kD(s,o);if(o.expressionContext&&0===o.expressionContext.indexOf("cluster")){if(!$r(s,["zoom","feature-state"]))return[new le(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===o.expressionContext&&!Mt(s))return[new le(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function kD(o,i){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(i.valueSpec&&i.valueSpec.expression)for(const d of i.valueSpec.expression.parameters)s.delete(d);if(0===s.size)return[];const l=[];return o instanceof Pl&&s.has(o.name)?[new le(i.key,i.value,`["${o.name}"] expression is not supported in a filter for a ${i.object.type} layer with id: ${i.object.id}`)]:(o.eachChild(d=>{l.push(...kD(d,i))}),l)}function L0(o){const i=o.key,s=o.value,l=o.valueSpec,d=[];return Array.isArray(l.values)?-1===l.values.indexOf(Cn(s))&&d.push(new le(i,s,`expected one of [${l.values.join(", ")}], ${JSON.stringify(s)} found`)):-1===Object.keys(l.values).indexOf(Cn(s))&&d.push(new le(i,s,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(s)} found`)),d}function ab(o){if(!0===o||!1===o)return!0;if(!Array.isArray(o)||0===o.length)return!1;switch(o[0]){case"has":return o.length>=2&&"$id"!==o[1]&&"$type"!==o[1];case"in":return o.length>=3&&("string"!=typeof o[1]||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==o.length||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const i of o.slice(1))if(!ab(i)&&"boolean"!=typeof i)return!1;return!0;default:return!0}}function am(o,i="fill"){if(null==o)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ab(o)||(o=yf(o));const s=o;let l=!0;try{l=function(_){if(!bf(_))return _;let y=ld(_);return lb(y),y=SD(y),y}(s)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(s,null,2)}\n        `)}const d=ct[`filter_${i}`],u=yc(l,d);let m=null;if("error"===u.result)throw new Error(u.value.map(_=>`${_.key}: ${_.message}`).join(", "));m=(_,y,v)=>u.value.evaluate(_,y,{},v);let p=null,g=null;if(l!==s){const _=yc(s,d);if("error"===_.result)throw new Error(_.value.map(y=>`${y.key}: ${y.message}`).join(", "));p=(y,v,w,C,D)=>_.value.evaluate(y,v,{},w,void 0,void 0,C,D),g=!Mt(_.value.expression)}return{filter:m,dynamicFilter:p||void 0,needGeometry:B0(l),needFeature:!!g}}function SD(o){if(!Array.isArray(o))return o;const i=function(s){if(V3.has(s[0]))for(let l=1;l<s.length;l++)if(bf(s[l]))return!0;return s}(o);return!0===i?i:i.map(s=>SD(s))}function lb(o){let i=!1;const s=[];if("case"===o[0]){for(let l=1;l<o.length-1;l+=2)i=i||bf(o[l]),s.push(o[l+1]);s.push(o[o.length-1])}else if("match"===o[0]){i=i||bf(o[1]);for(let l=2;l<o.length-1;l+=2)s.push(o[l+1]);s.push(o[o.length-1])}else if("step"===o[0]){i=i||bf(o[1]);for(let l=1;l<o.length-1;l+=2)s.push(o[l+1])}i&&(o.length=0,o.push("any",...s));for(let l=1;l<o.length;l++)lb(o[l])}function bf(o){if(!Array.isArray(o))return!1;if("pitch"===(i=o[0])||"distance-from-center"===i)return!0;var i;for(let s=1;s<o.length;s++)if(bf(o[s]))return!0;return!1}const V3=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function jR(o,i){return o<i?-1:o>i?1:0}function B0(o){if(!Array.isArray(o))return!1;if("within"===o[0]||"distance"===o[0])return!0;for(let i=1;i<o.length;i++)if(B0(o[i]))return!0;return!1}function yf(o){if(!o)return!0;const i=o[0];return o.length<=1?"any"!==i:"=="===i?N0(o[1],o[2],"=="):"!="===i?vf(N0(o[1],o[2],"==")):"<"===i||">"===i||"<="===i||">="===i?N0(o[1],o[2],i):"any"===i?(s=o.slice(1),["any"].concat(s.map(yf))):"all"===i?["all"].concat(o.slice(1).map(yf)):"none"===i?["all"].concat(o.slice(1).map(yf).map(vf)):"in"===i?TD(o[1],o.slice(2)):"!in"===i?vf(TD(o[1],o.slice(2))):"has"===i?ED(o[1]):"!has"!==i||vf(ED(o[1]));var s}function N0(o,i,s){switch(o){case"$type":return[`filter-type-${s}`,i];case"$id":return[`filter-id-${s}`,i];default:return[`filter-${s}`,o,i]}}function TD(o,i){if(0===i.length)return!1;switch(o){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(s=>typeof s!=typeof i[0])?["filter-in-large",o,["literal",i.sort(jR)]]:["filter-in-small",o,["literal",i]]}}function ED(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function vf(o){return["!",o]}function z0(o){return ab(ld(o.value))?mu(Ha({},o,{expressionContext:"filter",valueSpec:o.styleSpec[`filter_${o.layerType||"fill"}`]})):V0(o)}function V0(o){const i=o.value,s=o.key;if("array"!==pn(i))return[new le(s,i,`array expected, ${pn(i)} found`)];const l=o.styleSpec;let d,u=[];if(i.length<1)return[new le(s,i,"filter array must have at least 1 element")];switch(u=u.concat(L0({key:`${s}[0]`,value:i[0],valueSpec:l.filter_operator,style:o.style,styleSpec:o.styleSpec})),Cn(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&"$type"===Cn(i[1])&&u.push(new le(s,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":3!==i.length&&u.push(new le(s,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(d=pn(i[1]),"string"!==d&&u.push(new le(`${s}[1]`,i[1],`string expected, ${d} found`)));for(let m=2;m<i.length;m++)d=pn(i[m]),"$type"===Cn(i[1])?u=u.concat(L0({key:`${s}[${m}]`,value:i[m],valueSpec:l.geometry_type,style:o.style,styleSpec:o.styleSpec})):"string"!==d&&"number"!==d&&"boolean"!==d&&u.push(new le(`${s}[${m}]`,i[m],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let m=1;m<i.length;m++)u=u.concat(V0({key:`${s}[${m}]`,value:i[m],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":d=pn(i[1]),2!==i.length?u.push(new le(s,i,`filter array for "${i[0]}" operator must have 2 elements`)):"string"!==d&&u.push(new le(`${s}[1]`,i[1],`string expected, ${d} found`))}return u}function AD(o,i){const s=o.key,l=o.style,d=o.layer,u=o.styleSpec,m=o.value,p=o.objectKey,g=u[`${i}_${o.layerType}`];if(!g)return[];const _=p.match(/^(.*)-transition$/);if("paint"===i&&_&&g[_[1]]&&g[_[1]].transition)return no({key:s,value:m,valueSpec:u.transition,style:l,styleSpec:u});const y=o.valueSpec||g[p];if(!y)return[new iu(s,m,`unknown property "${p}"`)];let v;if("string"===pn(m)&&Is(y)&&!y.tokens&&(v=/^{([^}]+)}$/.exec(m))){const C=`\`{ "type": "identity", "property": ${v?JSON.stringify(v[1]):'"_"'} }\``;return[new le(s,m,`"${p}" does not support interpolation syntax\nUse an identity property function instead: ${C}.`)]}const w=[];if("symbol"===o.layerType)"text-field"!==p||!l||l.glyphs||l.imports||w.push(new le(s,m,'use of "text-field" requires a style "glyphs" property')),"text-font"===p&&hu(ld(m))&&"identity"===Cn(m.type)&&w.push(new le(s,m,'"text-font" does not support identity functions'));else if("model"===o.layerType&&"paint"===i&&d&&d.layout&&d.layout.hasOwnProperty("model-id")&&Is(y)&&(BR(y)||wD(y))){const C=sm(ld(m),y),D=C.value.expression||C.value._styleExpression.expression;D&&!$r(D,["measure-light"])&&("model-emissive-strength"===p&&Mt(D)&&ko(D)||w.push(new le(s,m,`${p} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return w.concat(no({key:o.key,value:m,valueSpec:y,style:l,styleSpec:u,expressionContext:"property",propertyType:i,propertyKey:p}))}function UR(o){return AD(o,"paint")}function ID(o){return AD(o,"layout")}function Bn(o){let i=[];const s=o.value,l=o.key,d=o.style,u=o.styleSpec;s.type||s.ref||i.push(new le(l,s,'either "type" or "ref" is required'));let m=Cn(s.type);const p=Cn(s.ref);if(s.id){const g=Cn(s.id);for(let _=0;_<o.arrayIndex;_++){const y=d.layers[_];Cn(y.id)===g&&i.push(new le(l,s.id,`duplicate layer id "${s.id}", previously used at line ${y.id.__line__}`))}}if("ref"in s){let g;["type","source","source-layer","filter","layout"].forEach(_=>{_ in s&&i.push(new le(l,s[_],`"${_}" is prohibited for ref layers`))}),d.layers.forEach(_=>{Cn(_.id)===p&&(g=_)}),g?g.ref?i.push(new le(l,s.ref,"ref cannot reference another ref layer")):m=Cn(g.type):"string"==typeof p&&i.push(new le(l,s.ref,`ref layer "${p}" not found`))}else if("background"!==m&&"sky"!==m&&"slot"!==m)if(s.source){const g=d.sources&&d.sources[s.source],_=g&&Cn(g.type);g?"vector"===_&&"raster"===m?i.push(new le(l,s.source,`layer "${s.id}" requires a raster source`)):"raster"===_&&"raster"!==m?i.push(new le(l,s.source,`layer "${s.id}" requires a vector source`)):"vector"!==_||s["source-layer"]?"raster-dem"===_&&"hillshade"!==m?i.push(new le(l,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==m||!s.paint||!s.paint["line-gradient"]&&!s.paint["line-trim-offset"]||"geojson"===_&&g.lineMetrics||i.push(new le(l,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new le(l,s,`layer "${s.id}" must specify a "source-layer"`)):i.push(new le(l,s.source,`source "${s.source}" not found`))}else i.push(new le(l,s,'missing required property "source"'));return i=i.concat(ia({key:l,value:s,valueSpec:u.layer,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{"*":()=>[],type:()=>no({key:`${l}.type`,value:s.type,valueSpec:u.layer.type,style:o.style,styleSpec:o.styleSpec,object:s,objectKey:"type"}),filter:g=>z0(Ha({layerType:m},g)),layout:g=>ia({layer:s,key:g.key,value:g.value,valueSpec:{},style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":_=>ID(Ha({layerType:m},_))}}),paint:g=>ia({layer:s,key:g.key,value:g.value,valueSpec:{},style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":_=>UR(Ha({layerType:m,layer:s},_))}})}})),i}function pu(o){const i=o.value,s=o.key,l=pn(i);return"string"!==l?[new le(s,i,`string expected, ${l} found`)]:[]}const RD={promoteId:function({key:o,value:i}){if("string"===pn(i))return pu({key:o,value:i});{const s=[];for(const l in i)s.push(...pu({key:`${o}.${l}`,value:i[l]}));return s}}};function PD(o){const i=o.value,s=o.key,l=o.styleSpec,d=o.style;if(!i.type)return[new le(s,i,'"type" is required')];const u=Cn(i.type);let m=[];switch(["vector","raster","raster-dem"].includes(u)&&(i.url||i.tiles||m.push(new le(s,i,'Either "url" or "tiles" is required.'))),u){case"vector":case"raster":case"raster-dem":return m=m.concat(ia({key:s,value:i,valueSpec:l[`source_${u.replace("-","_")}`],style:o.style,styleSpec:l,objectElementValidators:RD})),m;case"geojson":if(m=ia({key:s,value:i,valueSpec:l.source_geojson,style:d,styleSpec:l,objectElementValidators:RD}),i.cluster)for(const p in i.clusterProperties){const[g,_]=i.clusterProperties[p],y="string"==typeof g?[g,["accumulated"],["get",p]]:g;m.push(...mu({key:`${s}.${p}.map`,value:_,expressionContext:"cluster-map"})),m.push(...mu({key:`${s}.${p}.reduce`,value:y,expressionContext:"cluster-reduce"}))}return m;case"video":return ia({key:s,value:i,valueSpec:l.source_video,style:d,styleSpec:l});case"image":return ia({key:s,value:i,valueSpec:l.source_image,style:d,styleSpec:l});case"canvas":return[new le(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return L0({key:`${s}.type`,value:i.type,valueSpec:{values:OD(l)},style:d,styleSpec:l})}}function OD(o){return o.source.reduce((i,s)=>{const l=o[s];return"enum"===l.type.type&&(i=i.concat(Object.keys(l.type.values))),i},[])}function j0(o){const i=o.value;let s=[];if(!i)return s;const l=pn(i);return"string"!==l?(s=s.concat([new le(o.key,i,`string expected, "${l}" found`)]),s):(function(d){const u=-1===d.indexOf("://");try{return new URL(d,u?"http://example.com":void 0),!0}catch{return!1}}(i)||(s=s.concat([new le(o.key,i,`invalid url "${i}"`)])),s)}function FD(o){const i=o.value,s=o.styleSpec,l=s.light,d=o.style;let u=[];const m=pn(i);if(void 0===i)return u;if("object"!==m)return u=u.concat([new le("light",i,`object expected, ${m} found`)]),u;for(const p in i){const g=p.match(/^(.*)-transition$/);u=u.concat(g&&l[g[1]]&&l[g[1]].transition?no({key:p,value:i[p],valueSpec:s.transition,style:d,styleSpec:s}):l[p]?no({key:p,value:i[p],valueSpec:l[p],style:d,styleSpec:s}):[new le(p,i[p],`unknown property "${p}"`)])}return u}function cb(o){const i=o.value;let s=[];if(!i)return s;const l=pn(i);if("object"!==l)return s=s.concat([new le("light-3d",i,`object expected, ${l} found`)]),s;const d=o.styleSpec,u=d["light-3d"],m=o.key,p=o.style,g=o.style.lights;for(const v of["type","id"])if(!(v in i))return s=s.concat([new le("light-3d",i,`missing property ${v} on light`)]),s;if(i.type&&g)for(let v=0;v<o.arrayIndex;v++){const w=Cn(i.type),C=g[v];Cn(C.type)===w&&s.push(new le(m,i.id,`duplicate light type "${i.type}", previously defined at line ${C.id.__line__}`))}const _=`properties_light_${i.type}`;if(!(_ in d))return s=s.concat([new le("light-3d",i,`Invalid light type ${i.type}`)]),s;const y=d[_];for(const v in i)if("properties"===v){const w=i[v],C=pn(w);if("object"!==C)return s=s.concat([new le("properties",w,`object expected, ${C} found`)]),s;for(const D in w)s=s.concat(y[D]?no({key:D,value:w[D],valueSpec:y[D],style:p,styleSpec:d}):[new iu(o.key,w[D],`unknown property "${D}"`)])}else{const w=v.match(/^(.*)-transition$/);s=s.concat(w&&u[w[1]]&&u[w[1]].transition?no({key:v,value:i[v],valueSpec:d.transition,style:p,styleSpec:d}):u[v]?no({key:v,value:i[v],valueSpec:u[v],style:p,styleSpec:d}):[new iu(v,i[v],`unknown property "${v}"`)])}return s}function LD(o){const i=o.value,s=o.key,l=o.style,d=o.styleSpec,u=d.terrain;let m=[];const p=pn(i);if(void 0===i||"null"===p)return m;if("object"!==p)return m=m.concat([new le("terrain",i,`object expected, ${p} found`)]),m;for(const g in i){const _=g.match(/^(.*)-transition$/);m=m.concat(_&&u[_[1]]&&u[_[1]].transition?no({key:g,value:i[g],valueSpec:d.transition,style:l,styleSpec:d}):u[g]?no({key:g,value:i[g],valueSpec:u[g],style:l,styleSpec:d}):[new iu(g,i[g],`unknown property "${g}"`)])}if(i.source){const g=l.sources&&l.sources[i.source],_=g&&Cn(g.type);g?"raster-dem"!==_&&m.push(new le(s,i.source,`terrain cannot be used with a source of type ${String(_)}, it only be used with a "raster-dem" source type`)):m.push(new le(s,i.source,`source "${i.source}" not found`))}else m.push(new le(s,i,'terrain is missing required property "source"'));return m}function Qa(o){const i=o.value,s=o.style,l=o.styleSpec,d=l.fog;let u=[];const m=pn(i);if(void 0===i)return u;if("object"!==m)return u=u.concat([new le("fog",i,`object expected, ${m} found`)]),u;for(const p in i){const g=p.match(/^(.*)-transition$/);u=u.concat(g&&d[g[1]]&&d[g[1]].transition?no({key:p,value:i[p],valueSpec:l.transition,style:s,styleSpec:l}):d[p]?no({key:p,value:i[p],valueSpec:d[p],style:s,styleSpec:l}):[new iu(p,i[p],`unknown property "${p}"`)])}return u}const U0={"*":()=>[],array:NR,boolean:function(o){const i=o.value,s=o.key,l=pn(i);return"boolean"!==l?[new le(s,i,`boolean expected, ${l} found`)]:[]},number:zR,color:function(o){const i=o.key,s=o.value,l=pn(s);return"string"!==l?[new le(i,s,`color expected, ${l} found`)]:null===b0(s)?[new le(i,s,`color expected, "${s}" found`)]:[]},enum:L0,filter:z0,function:VR,layer:Bn,object:ia,source:PD,model:j0,light:FD,"light-3d":cb,terrain:LD,fog:Qa,string:pu,formatted:function(o){return 0===pu(o).length?[]:mu(o)},resolvedImage:function(o){return 0===pu(o).length?[]:mu(o)},projection:function(o){const i=o.value,s=o.styleSpec,l=s.projection,d=o.style;let u=[];const m=pn(i);if("object"===m)for(const p in i)u=u.concat(no({key:p,value:i[p],valueSpec:l[p],style:d,styleSpec:s}));else"string"!==m&&(u=u.concat([new le("projection",i,`object or string expected, ${m} found`)]));return u},import:function(o){const{value:i,styleSpec:s}=o,{data:l,...d}=i;Object.defineProperty(d,"__line__",{value:i.__line__,enumerable:!1});let u=ia(Ha({},o,{value:d,valueSpec:s.import}));return""===Cn(d.id)&&u.push(new le(`${o.key}.id`,d,"import id can't be an empty string")),l&&(u=u.concat(db(l,s,{key:`${o.key}.data`}))),u}};function no(o,i=!1){const s=o.value,l=o.valueSpec,d=o.styleSpec;if(l.expression&&hu(Cn(s)))return VR(o);if(l.expression&&om(ld(s)))return mu(o);if(l.type&&U0[l.type]){const u=U0[l.type](o);return!0===i&&u.length>0&&"array"===pn(o.value)?mu(o):u}return ia(Ha({},o,{valueSpec:l.type?d[l.type]:l}))}function cr(o){const i=o.value,s=o.key,l=pu(o);return l.length||(-1===i.indexOf("{fontstack}")&&l.push(new le(s,i,'"glyphs" url must include a "{fontstack}" token')),-1===i.indexOf("{range}")&&l.push(new le(s,i,'"glyphs" url must include a "{range}" token'))),l}function db(o,i=ct,s={}){return no({key:s.key||"",value:o,valueSpec:i.$root,styleSpec:i,style:o,objectElementValidators:{glyphs:cr,"*":()=>[]}})}function wc(o,i=ct){return Ja(db(o,i))}const Rs=o=>Ja(PD(o)),HR=o=>Ja(FD(o)),BD=o=>Ja(cb(o)),lm=o=>Ja(LD(o)),na=o=>Ja(Qa(o)),$R=o=>Ja(Bn(o)),H0=o=>Ja(z0(o)),GR=o=>Ja(UR(o)),bd=o=>Ja(ID(o)),ND=o=>Ja(j0(o));function Ja(o){return o.slice().sort((i,s)=>i.line&&s.line?i.line-s.line:0)}function xf(o,i){let s=!1;if(i&&i.length)for(const l of i)l instanceof iu?rt(l.message):(o.fire(new Yt(new Error(l.message))),s=!0);return s}var zD=Nl,Cc=3;function Nl(o,i,s){var l=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var d=new Int32Array(this.arrayBuffer);o=d[0],this.d=(i=d[1])+2*(s=d[2]);for(var u=0;u<this.d*this.d;u++){var m=d[Cc+u],p=d[Cc+u+1];l.push(m===p?null:d.subarray(m,p))}var g=d[Cc+l.length+1];this.keys=d.subarray(d[Cc+l.length],g),this.bboxes=d.subarray(g),this.insert=this._insertReadonly}else{this.d=i+2*s;for(var _=0;_<this.d*this.d;_++)l.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=o,this.padding=s,this.scale=i/o,this.uid=0;var y=s/i*o;this.min=-y,this.max=o+y}Nl.prototype.insert=function(o,i,s,l,d){this._forEachCell(i,s,l,d,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(l),this.bboxes.push(d)},Nl.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Nl.prototype._insertCell=function(o,i,s,l,d,u){this.cells[d].push(u)},Nl.prototype.query=function(o,i,s,l,d){var u=this.min,m=this.max;if(o<=u&&i<=u&&m<=s&&m<=l&&!d)return Array.prototype.slice.call(this.keys);var p=[];return this._forEachCell(o,i,s,l,this._queryCell,p,{},d),p},Nl.prototype._queryCell=function(o,i,s,l,d,u,m,p){var g=this.cells[d];if(null!==g)for(var _=this.keys,y=this.bboxes,v=0;v<g.length;v++){var w=g[v];if(void 0===m[w]){var C=4*w;(p?p(y[C+0],y[C+1],y[C+2],y[C+3]):o<=y[C+2]&&i<=y[C+3]&&s>=y[C+0]&&l>=y[C+1])?(m[w]=!0,u.push(_[w])):m[w]=!1}}},Nl.prototype._forEachCell=function(o,i,s,l,d,u,m,p){for(var g=this._convertToCellCoord(o),_=this._convertToCellCoord(i),y=this._convertToCellCoord(s),v=this._convertToCellCoord(l),w=g;w<=y;w++)for(var C=_;C<=v;C++){var D=this.d*C+w;if((!p||p(this._convertFromCellCoord(w),this._convertFromCellCoord(C),this._convertFromCellCoord(w+1),this._convertFromCellCoord(C+1)))&&d.call(this,o,i,s,l,D,u,m,p))return}},Nl.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},Nl.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},Nl.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,i=Cc+this.cells.length+1+1,s=0,l=0;l<this.cells.length;l++)s+=this.cells[l].length;var d=new Int32Array(i+s+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var u=i,m=0;m<o.length;m++){var p=o[m];d[Cc+m]=u,d.set(p,u),u+=p.length}return d[Cc+o.length]=u,d.set(this.keys,u),d[Cc+o.length+1]=u+=this.keys.length,d.set(this.bboxes,u),u+=this.bboxes.length,d.buffer};var _i=Ds(zD);const wf={};function de(o,i,s={}){Object.defineProperty(o,"_classRegistryKey",{value:i,writeable:!1}),wf[i]={klass:o,omit:s.omit||[]}}de(Object,"Object"),_i.serialize=function(o,i){const s=o.toArrayBuffer();return i&&i.add(s),{buffer:s}},_i.deserialize=function(o){return new _i(o.buffer)},Object.defineProperty(_i,"name",{value:"Grid"}),de(_i,"Grid"),de(di,"Color"),de(Error,"Error"),de(Tt,"AJAXError"),de(fr,"ResolvedImage"),de(_d,"StylePropertyFunction"),de(_f,"StyleExpression",{omit:["_evaluator"]}),de(vc,"ZoomDependentExpression"),de(sb,"ZoomConstantExpression"),de(Pl,"CompoundExpression",{omit:["_evaluate"]});for(const o in rb)wf[rb[o]._classRegistryKey]||de(rb[o],`Expression${o}`);function VD(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&"ArrayBuffer"===o.constructor.name)}function jD(o){return lt.ImageBitmap&&o instanceof lt.ImageBitmap}function cm(o,i){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp)return o;if(VD(o)||jD(o))return i&&i.add(o),o;if(ArrayBuffer.isView(o)){const s=o;return i&&i.add(s.buffer),s}if(o instanceof lt.ImageData)return i&&i.add(o.data.buffer),o;if(Array.isArray(o)){const s=[];for(const l of o)s.push(cm(l,i));return s}if(o instanceof Map){const s={$name:"Map"};for(const[l,d]of o.entries())s[l]=cm(d);return s}if("object"==typeof o){const s=o.constructor,l=s._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${l}`);const d=s.serialize?s.serialize(o,i):{};if(!s.serialize){for(const u in o)o.hasOwnProperty(u)&&(wf[l].omit.indexOf(u)>=0||(d[u]=cm(o[u],i)));o instanceof Error&&(d.message=o.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==l&&(d.$name=l),d}throw new Error("can't serialize object of type "+typeof o)}function fu(o){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||VD(o)||jD(o)||ArrayBuffer.isView(o)||o instanceof lt.ImageData)return o;if(Array.isArray(o))return o.map(fu);if("object"==typeof o){const i=o.$name||"Object";if("Map"===i){const d=new Map;for(const u of Object.keys(o))"$name"!==u&&d.set(u,fu(o[u]));return d}const{klass:s}=wf[i];if(!s)throw new Error(`can't deserialize unregistered class ${i}`);if(s.deserialize)return s.deserialize(o);const l=Object.create(s.prototype);for(const d of Object.keys(o))"$name"!==d&&(l[d]=fu(o[d]));return l}throw new Error("can't deserialize object of type "+typeof o)}const ue={"Latin-1 Supplement":o=>o>=128&&o<=255,Arabic:o=>o>=1536&&o<=1791,"Arabic Supplement":o=>o>=1872&&o<=1919,"Arabic Extended-A":o=>o>=2208&&o<=2303,"Hangul Jamo":o=>o>=4352&&o<=4607,"Unified Canadian Aboriginal Syllabics":o=>o>=5120&&o<=5759,Khmer:o=>o>=6016&&o<=6143,"Unified Canadian Aboriginal Syllabics Extended":o=>o>=6320&&o<=6399,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"CJK Radicals Supplement":o=>o>=11904&&o<=12031,"Kangxi Radicals":o=>o>=12032&&o<=12255,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Bopomofo:o=>o>=12544&&o<=12591,"Hangul Compatibility Jamo":o=>o>=12592&&o<=12687,Kanbun:o=>o>=12688&&o<=12703,"Bopomofo Extended":o=>o>=12704&&o<=12735,"CJK Strokes":o=>o>=12736&&o<=12783,"Katakana Phonetic Extensions":o=>o>=12784&&o<=12799,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"CJK Unified Ideographs Extension A":o=>o>=13312&&o<=19903,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Yi Syllables":o=>o>=40960&&o<=42127,"Yi Radicals":o=>o>=42128&&o<=42191,"Hangul Jamo Extended-A":o=>o>=43360&&o<=43391,"Hangul Syllables":o=>o>=44032&&o<=55215,"Hangul Jamo Extended-B":o=>o>=55216&&o<=55295,"Private Use Area":o=>o>=57344&&o<=63743,"CJK Compatibility Ideographs":o=>o>=63744&&o<=64255,"Arabic Presentation Forms-A":o=>o>=64336&&o<=65023,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Arabic Presentation Forms-B":o=>o>=65136&&o<=65279,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519,"CJK Unified Ideographs Extension B":o=>o>=131072&&o<=173791};function $0(o){for(const i of o)if(G0(i.charCodeAt(0)))return!0;return!1}function WR(o){for(const i of o)if(!qR(i.charCodeAt(0)))return!1;return!0}function qR(o){return!(ue.Arabic(o)||ue["Arabic Supplement"](o)||ue["Arabic Extended-A"](o)||ue["Arabic Presentation Forms-A"](o)||ue["Arabic Presentation Forms-B"](o))}function G0(o){return!(746!==o&&747!==o&&(o<4352||!(ue["Bopomofo Extended"](o)||ue.Bopomofo(o)||ue["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||ue["CJK Compatibility Ideographs"](o)||ue["CJK Compatibility"](o)||ue["CJK Radicals Supplement"](o)||ue["CJK Strokes"](o)||!(!ue["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||12336===o)||ue["CJK Unified Ideographs Extension A"](o)||ue["CJK Unified Ideographs"](o)||ue["Enclosed CJK Letters and Months"](o)||ue["Hangul Compatibility Jamo"](o)||ue["Hangul Jamo Extended-A"](o)||ue["Hangul Jamo Extended-B"](o)||ue["Hangul Jamo"](o)||ue["Hangul Syllables"](o)||ue.Hiragana(o)||ue["Ideographic Description Characters"](o)||ue.Kanbun(o)||ue["Kangxi Radicals"](o)||ue["Katakana Phonetic Extensions"](o)||ue.Katakana(o)&&12540!==o||!(!ue["Halfwidth and Fullwidth Forms"](o)||65288===o||65289===o||65293===o||o>=65306&&o<=65310||65339===o||65341===o||65343===o||o>=65371&&o<=65503||65507===o||o>=65512&&o<=65519)||!(!ue["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||ue["Unified Canadian Aboriginal Syllabics"](o)||ue["Unified Canadian Aboriginal Syllabics Extended"](o)||ue["Vertical Forms"](o)||ue["Yijing Hexagram Symbols"](o)||ue["Yi Syllables"](o)||ue["Yi Radicals"](o))))}function UD(o){return!(G0(o)||(i=o,ue["Latin-1 Supplement"](i)&&(167===i||169===i||174===i||177===i||188===i||189===i||190===i||215===i||247===i)||ue["General Punctuation"](i)&&(8214===i||8224===i||8225===i||8240===i||8241===i||8251===i||8252===i||8258===i||8263===i||8264===i||8265===i||8273===i)||ue["Letterlike Symbols"](i)||ue["Number Forms"](i)||ue["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||9003===i||i>=9085&&i<=9114||i>=9150&&i<=9165||9167===i||i>=9169&&i<=9179||i>=9186&&i<=9215)||ue["Control Pictures"](i)&&9251!==i||ue["Optical Character Recognition"](i)||ue["Enclosed Alphanumerics"](i)||ue["Geometric Shapes"](i)||ue["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||ue["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||ue["CJK Symbols and Punctuation"](i)||ue.Katakana(i)||ue["Private Use Area"](i)||ue["CJK Compatibility Forms"](i)||ue["Small Form Variants"](i)||ue["Halfwidth and Fullwidth Forms"](i)||8734===i||8756===i||8757===i||i>=9984&&i<=10087||i>=10102&&i<=10131||65532===i||65533===i));var i}function Wt(o){return o>=1424&&o<=2303||ue["Arabic Presentation Forms-A"](o)||ue["Arabic Presentation Forms-B"](o)}function Dn(o,i){return!(!i&&Wt(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||ue.Khmer(o))}function $n(o){for(const i of o)if(Wt(i.charCodeAt(0)))return!0;return!1}const Nn="deferred",mo="loading",ub="loaded";let gu=null,Ir="unavailable",zl=null;const hb=function(o){o&&"string"==typeof o&&o.indexOf("NetworkError")>-1&&(Ir="error"),gu&&gu(o)};function W0(){HD.fire(new Bt("pluginStateChange",{pluginStatus:Ir,pluginURL:zl}))}const HD=new gi,mb=function(){return Ir},$o=function(){if(Ir!==Nn||!zl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ir=mo,W0(),zl&&qt({url:zl},o=>{o?hb(o):(Ir=ub,W0())})},ro={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ir===ub||null!=ro.applyArabicShaping,isLoading:()=>Ir===mo,setState(o){Ir=o.pluginStatus,zl=o.pluginURL},isParsed:()=>null!=ro.applyArabicShaping&&null!=ro.processBidirectionalText&&null!=ro.processStyledBidirectionalText,getPluginURL:()=>zl};class zn{constructor(i,s){this.zoom=i,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(i){return function(s,l){for(const d of s)if(!Dn(d.charCodeAt(0),l))return!1;return!0}(i,ro.isLoaded())}}class Mc{constructor(i,s,l){this.property=i,this.value=s,this.expression=function(d,u,m){if(hu(d))return new _d(d,u);if(om(d)||Array.isArray(d)&&d.length>0){const p=sm(d,u,m);if("error"===p.result)throw new Error(p.value.map(g=>`${g.key}: ${g.message}`).join(", "));return p.value}{let p=d;return"string"==typeof d&&"color"===u.type&&(p=di.parse(d)),{kind:"constant",isConfigDependent:!1,evaluate:()=>p}}}(void 0===s?i.specification.default:s,i.specification,l)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(i,s,l){return this.property.possiblyEvaluate(this,i,s,l)}}class tl{constructor(i,s){this.property=i,this.value=new Mc(i,void 0,s)}transitioned(i,s){return new q0(this.property,this.value,s,se({},i.transition,this.transition),i.now)}untransitioned(){return new q0(this.property,this.value,null,{},0)}}class Cf{constructor(i,s){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._options=s,this.isConfigDependent=!1}getValue(i){return Y(this._values[i].value.value)}setValue(i,s){this._values.hasOwnProperty(i)||(this._values[i]=new tl(this._values[i].property,this._options)),this._values[i].value=new Mc(this._values[i].property,null===s?void 0:Y(s),this._options),this.isConfigDependent=this.isConfigDependent||this._values[i].value.expression.isConfigDependent}setTransitionOrValue(i,s){s&&(this._options=s);const l=this._properties.properties;if(i)for(const d in i){const u=i[d];if(nd(d,"-transition")){const m=d.slice(0,-11);l[m]&&this.setTransition(m,u)}else l[d]&&this.setValue(d,u)}}getTransition(i){return Y(this._values[i].transition)}setTransition(i,s){this._values.hasOwnProperty(i)||(this._values[i]=new tl(this._values[i].property)),this._values[i].transition=Y(s)||void 0}serialize(){const i={};for(const s of Object.keys(this._values)){const l=this.getValue(s);void 0!==l&&(i[s]=l);const d=this.getTransition(s);void 0!==d&&(i[`${s}-transition`]=d)}return i}transitioned(i,s){const l=new $D(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].transitioned(i,s._values[d]);return l}untransitioned(){const i=new $D(this._properties);for(const s of Object.keys(this._values))i._values[s]=this._values[s].untransitioned();return i}}class q0{constructor(i,s,l,d,u){const m=d.delay||0,p=d.duration||0;u=u||0,this.property=i,this.value=s,this.begin=u+m,this.end=this.begin+p,i.specification.transition&&(d.delay||d.duration)&&(this.prior=l)}possiblyEvaluate(i,s,l){const d=i.now||0,u=this.value.possiblyEvaluate(i,s,l),m=this.prior;if(m){if(d>this.end)return this.prior=null,u;if(this.value.isDataDriven())return this.prior=null,u;if(d<this.begin)return m.possiblyEvaluate(i,s,l);{const p=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(i,s,l),u,ed(p))}}return u}}class $D{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,s,l){const d=new _u(this._properties);for(const u of Object.keys(this._values))d._values[u]=this._values[u].possiblyEvaluate(i,s,l);return d}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class YR{constructor(i,s){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._options=s,this.isConfigDependent=!1}getValue(i){return Y(this._values[i].value)}setValue(i,s){this._values[i]=new Mc(this._values[i].property,null===s?void 0:Y(s),this._options),this.isConfigDependent=this.isConfigDependent||this._values[i].expression.isConfigDependent}serialize(){const i={};for(const s of Object.keys(this._values)){const l=this.getValue(s);void 0!==l&&(i[s]=l)}return i}possiblyEvaluate(i,s,l){const d=new _u(this._properties);for(const u of Object.keys(this._values))d._values[u]=this._values[u].possiblyEvaluate(i,s,l);return d}}class yd{constructor(i,s,l){this.property=i,this.value=s,this.parameters=l}isConstant(){return"constant"===this.value.kind}constantOr(i){return"constant"===this.value.kind?this.value.value:i}evaluate(i,s,l,d){return this.property.evaluate(this.value,this.parameters,i,s,l,d)}}class _u{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Ft{constructor(i){this.specification=i}possiblyEvaluate(i,s){return i.expression.evaluate(s)}interpolate(i,s,l){const d=Vi[this.specification.type];return d?d(i,s,l):i}}class ke{constructor(i,s){this.specification=i,this.overrides=s}possiblyEvaluate(i,s,l,d){return new yd(this,"constant"===i.expression.kind||"camera"===i.expression.kind?{kind:"constant",value:i.expression.evaluate(s,null,{},l,d)}:i.expression,s)}interpolate(i,s,l){if("constant"!==i.value.kind||"constant"!==s.value.kind)return i;if(void 0===i.value.value||void 0===s.value.value)return new yd(this,{kind:"constant",value:void 0},i.parameters);const d=Vi[this.specification.type];return d?new yd(this,{kind:"constant",value:d(i.value.value,s.value.value,l)},i.parameters):i}evaluate(i,s,l,d,u,m){return"constant"===i.kind?i.value:i.evaluate(s,l,d,u,m)}}class Mf{constructor(i){this.specification=i}possiblyEvaluate(i,s,l,d){return!!i.expression.evaluate(s,null,{},l,d)}interpolate(){return!1}}class Gn{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new zn(0,{});for(const l in i){const d=i[l];d.specification.overridable&&this.overridableProperties.push(l);const u=this.defaultPropertyValues[l]=new Mc(d,void 0),m=this.defaultTransitionablePropertyValues[l]=new tl(d);this.defaultTransitioningPropertyValues[l]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=u.possiblyEvaluate(s)}}}de(ke,"DataDrivenProperty"),de(Ft,"DataConstantProperty"),de(Mf,"ColorRampProperty");function Y0(o){return o.indexOf("\x1f")>=0}function So(o,i){return i?`${o}\x1f${i}`:o}function Df(o){const i=o.indexOf("\x1f");return i>=0?o.slice(0,i):o}const Z0="-transition";class cs extends gi{constructor(i,s,l){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,"custom"!==i.type&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,"background"!==i.type&&"sky"!==i.type&&"slot"!==i.type&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),this.options=l,i.slot&&(this.slot=i.slot),s.layout&&(this._unevaluatedLayout=new YR(s.layout,l),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),s.paint)){this._transitionablePaint=new Cf(s.paint,l);for(const d in i.paint)this.setPaintProperty(d,i.paint[d],{validate:!1});for(const d in i.layout)this.setLayoutProperty(d,i.layout[d],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _u(s.paint)}}setScope(i){this.scope=i,this.fqid=So(this.id,i)}getLayoutProperty(i){return"visibility"===i?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,s,l={}){if(null!=s&&this._validate(bd,`layers.${this.id}.layout.${i}`,i,s,l))return;if("custom"===this.type&&"visibility"===i)return void(this.visibility=s);const d=this._unevaluatedLayout;d._properties.properties[i]&&(d.setValue(i,s),this.isConfigDependent=this.isConfigDependent||d.isConfigDependent,"visibility"===i&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(i){return nd(i,Z0)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,s,l={}){if(null!=s&&this._validate(GR,`layers.${this.id}.paint.${i}`,i,s,l))return!1;const d=this._transitionablePaint,u=d._properties.properties;if(nd(i,Z0)){const w=i.slice(0,-11);return u[w]&&d.setTransition(w,s||void 0),!1}if(!u[i])return!1;const m=d._values[i],p=m.value.isDataDriven(),g=m.value;d.setValue(i,s),this.isConfigDependent=this.isConfigDependent||d.isConfigDependent,this._handleSpecialPaintPropertyUpdate(i);const _=d._values[i].value,y=_.isDataDriven(),v=nd(i,"pattern")||"line-dasharray"===i;return y||p||v||this._handleOverridablePaintPropertyUpdate(i,g,_)}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getDefaultProgramParams(i,s){return null}_handleOverridablePaintPropertyUpdate(i,s,l){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||"none"===this.visibility}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,s)}serialize(){return Ut({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(i,s)=>!(void 0===i||"layout"===s&&!Object.keys(i).length||"paint"===s&&!Object.keys(i).length))}_validate(i,s,l,d,u={}){return(!u||!1!==u.validate)&&xf(this,i.call(wc,{key:s,layerType:this.type,objectKey:l,value:d,styleSpec:ct,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}resize(){}isStateDependent(){for(const i in this.paint._values){const s=this.paint.get(i);if(s instanceof yd&&Is(s.property.specification)&&("source"===s.value.kind||"composite"===s.value.kind)&&s.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=am(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(){this._stats&&(this._stats.numRenderedVerticesInShadowPass=0,this._stats.numRenderedVerticesInTransparentPass=0)}}class ZR{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(i,s){this._updatedSourceCaches[i]=s,this.setDirty()}discardSourceCacheUpdate(i){delete this._updatedSourceCaches[i]}updateLayer(i){const s=i.scope;this._updatedLayers[s]=this._updatedLayers[s]||new Set,this._updatedLayers[s].add(i.id),this.setDirty()}removeLayer(i){const s=i.scope;this._removedLayers[s]=this._removedLayers[s]||{},this._updatedLayers[s]=this._updatedLayers[s]||new Set,this._removedLayers[s][i.id]=i,this._updatedLayers[s].delete(i.id),this._updatedPaintProps.delete(i.fqid),this.setDirty()}getRemovedLayer(i){return this._removedLayers[i.scope]?this._removedLayers[i.scope][i.id]:null}discardLayerRemoval(i){this._removedLayers[i.scope]&&delete this._removedLayers[i.scope][i.id]}getLayerUpdatesByScope(){const i={};for(const s in this._updatedLayers)i[s]=i[s]||{},i[s].updatedIds=Array.from(this._updatedLayers[s].values());for(const s in this._removedLayers)i[s]=i[s]||{},i[s].removedIds=Object.keys(this._removedLayers[s]);return i}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(i){this._updatedPaintProps.add(i.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(i){this._updatedImages.add(i),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}const XR={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class To{constructor(i,s){this._structArray=i,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class vn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,s){return i._trim(),s&&(i.isTransferred=!0,s.add(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const s=Object.create(this.prototype);return s.arrayBuffer=i.arrayBuffer,s.length=i.length,s.capacity=i.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Xe(o,i=1){let s=0,l=0;return{members:o.map(d=>{const u=XR[d.type].BYTES_PER_ELEMENT,m=s=Ps(s,Math.max(i,u)),p=d.components||1;return l=Math.max(l,u),s+=u*p,{name:d.name,type:d.type,components:p,offset:m}}),size:Ps(s,Math.max(l,i)),alignment:i}}function Ps(o,i){return Math.ceil(o/i)*i}class Os extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s){const l=this.length;return this.resize(l+1),this.emplace(l,i,s)}emplace(i,s,l){const d=2*i;return this.int16[d+0]=s,this.int16[d+1]=l,i}}Os.prototype.bytesPerElement=4,de(Os,"StructArrayLayout2i4");class Vl extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,i,s,l)}emplace(i,s,l,d){const u=3*i;return this.int16[u+0]=s,this.int16[u+1]=l,this.int16[u+2]=d,i}}Vl.prototype.bytesPerElement=6,de(Vl,"StructArrayLayout3i6");class bu extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l,d){const u=this.length;return this.resize(u+1),this.emplace(u,i,s,l,d)}emplace(i,s,l,d,u){const m=4*i;return this.int16[m+0]=s,this.int16[m+1]=l,this.int16[m+2]=d,this.int16[m+3]=u,i}}bu.prototype.bytesPerElement=8,de(bu,"StructArrayLayout4i8");class pb extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u){const m=this.length;return this.resize(m+1),this.emplace(m,i,s,l,d,u)}emplace(i,s,l,d,u,m){const p=5*i;return this.int16[p+0]=s,this.int16[p+1]=l,this.int16[p+2]=d,this.int16[p+3]=u,this.int16[p+4]=m,i}}pb.prototype.bytesPerElement=10,de(pb,"StructArrayLayout5i10");class fb extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u,m,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,s,l,d,u,m,p)}emplace(i,s,l,d,u,m,p,g){const _=6*i,y=12*i,v=3*i;return this.int16[_+0]=s,this.int16[_+1]=l,this.uint8[y+4]=d,this.uint8[y+5]=u,this.uint8[y+6]=m,this.uint8[y+7]=p,this.float32[v+2]=g,i}}fb.prototype.bytesPerElement=12,de(fb,"StructArrayLayout2i4ub1f12");class Sa extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l,d){const u=this.length;return this.resize(u+1),this.emplace(u,i,s,l,d)}emplace(i,s,l,d,u){const m=4*i;return this.float32[m+0]=s,this.float32[m+1]=l,this.float32[m+2]=d,this.float32[m+3]=u,i}}Sa.prototype.bytesPerElement=16,de(Sa,"StructArrayLayout4f16");class ds extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u){const m=this.length;return this.resize(m+1),this.emplace(m,i,s,l,d,u)}emplace(i,s,l,d,u,m){const p=6*i,g=3*i;return this.uint16[p+0]=s,this.uint16[p+1]=l,this.uint16[p+2]=d,this.uint16[p+3]=u,this.float32[g+2]=m,i}}ds.prototype.bytesPerElement=12,de(ds,"StructArrayLayout4ui1f12");class gb extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,l,d){const u=this.length;return this.resize(u+1),this.emplace(u,i,s,l,d)}emplace(i,s,l,d,u){const m=4*i;return this.uint16[m+0]=s,this.uint16[m+1]=l,this.uint16[m+2]=d,this.uint16[m+3]=u,i}}gb.prototype.bytesPerElement=8,de(gb,"StructArrayLayout4ui8");class yu extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u,m){const p=this.length;return this.resize(p+1),this.emplace(p,i,s,l,d,u,m)}emplace(i,s,l,d,u,m,p){const g=6*i;return this.int16[g+0]=s,this.int16[g+1]=l,this.int16[g+2]=d,this.int16[g+3]=u,this.int16[g+4]=m,this.int16[g+5]=p,i}}yu.prototype.bytesPerElement=12,de(yu,"StructArrayLayout6i12");class um extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u,m,p,g,_,y,v,w){const C=this.length;return this.resize(C+1),this.emplace(C,i,s,l,d,u,m,p,g,_,y,v,w)}emplace(i,s,l,d,u,m,p,g,_,y,v,w,C){const D=12*i;return this.int16[D+0]=s,this.int16[D+1]=l,this.int16[D+2]=d,this.int16[D+3]=u,this.uint16[D+4]=m,this.uint16[D+5]=p,this.uint16[D+6]=g,this.uint16[D+7]=_,this.int16[D+8]=y,this.int16[D+9]=v,this.int16[D+10]=w,this.int16[D+11]=C,i}}um.prototype.bytesPerElement=24,de(um,"StructArrayLayout4i4ui4i24");class hm extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u,m){const p=this.length;return this.resize(p+1),this.emplace(p,i,s,l,d,u,m)}emplace(i,s,l,d,u,m,p){const g=10*i,_=5*i;return this.int16[g+0]=s,this.int16[g+1]=l,this.int16[g+2]=d,this.float32[_+2]=u,this.float32[_+3]=m,this.float32[_+4]=p,i}}hm.prototype.bytesPerElement=20,de(hm,"StructArrayLayout3i3f20");class kf extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.uint32[1*i+0]=s,i}}kf.prototype.bytesPerElement=4,de(kf,"StructArrayLayout1ul4");class Dc extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s){const l=this.length;return this.resize(l+1),this.emplace(l,i,s)}emplace(i,s,l){const d=2*i;return this.uint16[d+0]=s,this.uint16[d+1]=l,i}}Dc.prototype.bytesPerElement=4,de(Dc,"StructArrayLayout2ui4");class _b extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u,m,p,g,_,y,v,w,C){const D=this.length;return this.resize(D+1),this.emplace(D,i,s,l,d,u,m,p,g,_,y,v,w,C)}emplace(i,s,l,d,u,m,p,g,_,y,v,w,C,D){const k=20*i,S=10*i;return this.int16[k+0]=s,this.int16[k+1]=l,this.int16[k+2]=d,this.int16[k+3]=u,this.int16[k+4]=m,this.float32[S+3]=p,this.float32[S+4]=g,this.float32[S+5]=_,this.float32[S+6]=y,this.int16[k+14]=v,this.uint32[S+8]=w,this.uint16[k+18]=C,this.uint16[k+19]=D,i}}_b.prototype.bytesPerElement=40,de(_b,"StructArrayLayout5i4f1i1ul2ui40");class bb extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u,m,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,s,l,d,u,m,p)}emplace(i,s,l,d,u,m,p,g){const _=8*i;return this.int16[_+0]=s,this.int16[_+1]=l,this.int16[_+2]=d,this.int16[_+4]=u,this.int16[_+5]=m,this.int16[_+6]=p,this.int16[_+7]=g,i}}bb.prototype.bytesPerElement=16,de(bb,"StructArrayLayout3i2i2i16");class vd extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u){const m=this.length;return this.resize(m+1),this.emplace(m,i,s,l,d,u)}emplace(i,s,l,d,u,m){const p=4*i,g=8*i;return this.float32[p+0]=s,this.float32[p+1]=l,this.float32[p+2]=d,this.int16[g+6]=u,this.int16[g+7]=m,i}}vd.prototype.bytesPerElement=16,de(vd,"StructArrayLayout2f1f2i16");class vu extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l,d){const u=this.length;return this.resize(u+1),this.emplace(u,i,s,l,d)}emplace(i,s,l,d,u){const m=12*i,p=3*i;return this.uint8[m+0]=s,this.uint8[m+1]=l,this.float32[p+1]=d,this.float32[p+2]=u,i}}vu.prototype.bytesPerElement=12,de(vu,"StructArrayLayout2ub2f12");class Cr extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,i,s,l)}emplace(i,s,l,d){const u=3*i;return this.uint16[u+0]=s,this.uint16[u+1]=l,this.uint16[u+2]=d,i}}Cr.prototype.bytesPerElement=6,de(Cr,"StructArrayLayout3ui6");class GD extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E,A,P,O,R){const F=this.length;return this.resize(F+1),this.emplace(F,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E,A,P,O,R)}emplace(i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E,A,P,O,R,F){const B=30*i,j=15*i,U=60*i;return this.int16[B+0]=s,this.int16[B+1]=l,this.int16[B+2]=d,this.float32[j+2]=u,this.float32[j+3]=m,this.uint16[B+8]=p,this.uint16[B+9]=g,this.uint32[j+5]=_,this.uint32[j+6]=y,this.uint32[j+7]=v,this.uint16[B+16]=w,this.uint16[B+17]=C,this.uint16[B+18]=D,this.float32[j+10]=k,this.float32[j+11]=S,this.uint8[U+48]=E,this.uint8[U+49]=A,this.uint8[U+50]=P,this.uint32[j+13]=O,this.int16[B+28]=R,this.uint8[U+58]=F,i}}GD.prototype.bytesPerElement=60,de(GD,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Sf extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E,A,P,O,R,F,B,j,U,H,W,q,X,G,Q,it){const st=this.length;return this.resize(st+1),this.emplace(st,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E,A,P,O,R,F,B,j,U,H,W,q,X,G,Q,it)}emplace(i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E,A,P,O,R,F,B,j,U,H,W,q,X,G,Q,it,st){const J=20*i,et=40*i,dt=80*i;return this.float32[J+0]=s,this.float32[J+1]=l,this.int16[et+4]=d,this.int16[et+5]=u,this.int16[et+6]=m,this.int16[et+7]=p,this.int16[et+8]=g,this.int16[et+9]=_,this.int16[et+10]=y,this.int16[et+11]=v,this.int16[et+12]=w,this.uint16[et+13]=C,this.uint16[et+14]=D,this.uint16[et+15]=k,this.uint16[et+16]=S,this.uint16[et+17]=E,this.uint16[et+18]=A,this.uint16[et+19]=P,this.uint16[et+20]=O,this.uint16[et+21]=R,this.uint16[et+22]=F,this.uint16[et+23]=B,this.uint16[et+24]=j,this.uint16[et+25]=U,this.uint16[et+26]=H,this.uint16[et+27]=W,this.uint32[J+14]=q,this.float32[J+15]=X,this.float32[J+16]=G,this.float32[J+17]=Q,this.float32[J+18]=it,this.uint8[dt+76]=st,i}}Sf.prototype.bytesPerElement=80,de(Sf,"StructArrayLayout2f9i15ui1ul4f1ub80");class yb extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.float32[1*i+0]=s,i}}yb.prototype.bytesPerElement=4,de(yb,"StructArrayLayout1f4");class xu extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u){const m=this.length;return this.resize(m+1),this.emplace(m,i,s,l,d,u)}emplace(i,s,l,d,u,m){const p=5*i;return this.float32[p+0]=s,this.float32[p+1]=l,this.float32[p+2]=d,this.float32[p+3]=u,this.float32[p+4]=m,i}}xu.prototype.bytesPerElement=20,de(xu,"StructArrayLayout5f20");class X0 extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u,m,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,s,l,d,u,m,p)}emplace(i,s,l,d,u,m,p,g){const _=7*i;return this.float32[_+0]=s,this.float32[_+1]=l,this.float32[_+2]=d,this.float32[_+3]=u,this.float32[_+4]=m,this.float32[_+5]=p,this.float32[_+6]=g,i}}X0.prototype.bytesPerElement=28,de(X0,"StructArrayLayout7f28");class WD extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,l,d){const u=this.length;return this.resize(u+1),this.emplace(u,i,s,l,d)}emplace(i,s,l,d,u){const m=6*i;return this.uint32[3*i+0]=s,this.uint16[m+2]=l,this.uint16[m+3]=d,this.uint16[m+4]=u,i}}WD.prototype.bytesPerElement=12,de(WD,"StructArrayLayout1ul3ui12");class vb extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.uint16[1*i+0]=s,i}}vb.prototype.bytesPerElement=2,de(vb,"StructArrayLayout1ui2");class kc extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,i,s,l)}emplace(i,s,l,d){const u=3*i;return this.float32[u+0]=s,this.float32[u+1]=l,this.float32[u+2]=d,i}}kc.prototype.bytesPerElement=12,de(kc,"StructArrayLayout3f12");class Sc extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s){const l=this.length;return this.resize(l+1),this.emplace(l,i,s)}emplace(i,s,l){const d=2*i;return this.float32[d+0]=s,this.float32[d+1]=l,i}}Sc.prototype.bytesPerElement=8,de(Sc,"StructArrayLayout2f8");class K0 extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S){const E=this.length;return this.resize(E+1),this.emplace(E,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S)}emplace(i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E){const A=16*i;return this.float32[A+0]=s,this.float32[A+1]=l,this.float32[A+2]=d,this.float32[A+3]=u,this.float32[A+4]=m,this.float32[A+5]=p,this.float32[A+6]=g,this.float32[A+7]=_,this.float32[A+8]=y,this.float32[A+9]=v,this.float32[A+10]=w,this.float32[A+11]=C,this.float32[A+12]=D,this.float32[A+13]=k,this.float32[A+14]=S,this.float32[A+15]=E,i}}K0.prototype.bytesPerElement=64,de(K0,"StructArrayLayout16f64");class xd extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,l,d,u,m,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,s,l,d,u,m,p)}emplace(i,s,l,d,u,m,p,g){const _=10*i,y=5*i;return this.uint16[_+0]=s,this.uint16[_+1]=l,this.uint16[_+2]=d,this.uint16[_+3]=u,this.float32[y+2]=m,this.float32[y+3]=p,this.float32[y+4]=g,i}}xd.prototype.bytesPerElement=20,de(xd,"StructArrayLayout4ui3f20");class Tf extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.uint8[1*i+0]=s,i}}Tf.prototype.bytesPerElement=1,de(Tf,"StructArrayLayout1ub1");class Ef extends To{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Ef.prototype.size=40;class qD extends _b{get(i){return new Ef(this,i)}}de(qD,"CollisionBoxArray");class Q0 extends To{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}Q0.prototype.size=60;class J0 extends GD{get(i){return new Q0(this,i)}}de(J0,"PlacedSymbolArray");class YD extends To{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(i){this._structArray.uint32[this._pos4+14]=i}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(i){this._structArray.float32[this._pos4+18]=i}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}YD.prototype.size=80;class el extends Sf{get(i){return new YD(this,i)}}de(el,"SymbolInstanceArray");class ZD extends yb{getoffsetX(i){return this.float32[1*i+0]}}de(ZD,"GlyphOffsetArray");class Af extends Os{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}de(Af,"SymbolLineVertexArray");class xb extends To{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}xb.prototype.size=12;class tx extends WD{get(i){return new xb(this,i)}}de(tx,"FeatureIndexArray");class If extends Dc{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}de(If,"FillExtrusionCentroidArray");const ex=Xe([{name:"a_pos",components:2,type:"Int16"}],4),KR=Xe([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class on{constructor(i=[]){this.segments=i}_prepareSegment(i,s,l,d){let u=this.segments[this.segments.length-1];return i>on.MAX_VERTEX_ARRAY_LENGTH&&rt(`Max vertices per segment is ${on.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!u||u.vertexLength+i>on.MAX_VERTEX_ARRAY_LENGTH||u.sortKey!==d)&&(u={vertexOffset:s,primitiveOffset:l,vertexLength:0,primitiveLength:0},void 0!==d&&(u.sortKey=d),this.segments.push(u)),u}prepareSegment(i,s,l,d){return this._prepareSegment(i,s.length,l.length,d)}get(){return this.segments}destroy(){for(const i of this.segments)for(const s in i.vaos)i.vaos[s].destroy()}static simpleSegment(i,s,l,d){return new on([{vertexOffset:i,primitiveOffset:s,vertexLength:l,primitiveLength:d,vaos:{},sortKey:0}])}}function ix(o,i){return 256*(o=he(Math.floor(o),0,255))+he(Math.floor(i),0,255)}on.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,de(on,"SegmentVector");const XD=Xe([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),KD=Xe([{name:"a_dash",components:4,type:"Uint16"}]);var wb={exports:{}},wu={exports:function(i,s){var l,d,u,m,p,g,_,y;for(d=i.length-(l=3&i.length),u=s,p=3432918353,g=461845907,y=0;y<d;)_=255&i.charCodeAt(y)|(255&i.charCodeAt(++y))<<8|(255&i.charCodeAt(++y))<<16|(255&i.charCodeAt(++y))<<24,++y,u=27492+(65535&(m=5*(65535&(u=(u^=_=(65535&(_=(_=(65535&_)*p+(((_>>>16)*p&65535)<<16)&4294967295)<<15|_>>>17))*g+(((_>>>16)*g&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(_=0,l){case 3:_^=(255&i.charCodeAt(y+2))<<16;case 2:_^=(255&i.charCodeAt(y+1))<<8;case 1:u^=_=(65535&(_=(_=(65535&(_^=255&i.charCodeAt(y)))*p+(((_>>>16)*p&65535)<<16)&4294967295)<<15|_>>>17))*g+(((_>>>16)*g&65535)<<16)&4294967295}return u^=i.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0}}.exports,QD={exports:{}};QD.exports=function(i,s){for(var l,d=i.length,u=s^d,m=0;d>=4;)l=1540483477*(65535&(l=255&i.charCodeAt(m)|(255&i.charCodeAt(++m))<<8|(255&i.charCodeAt(++m))<<16|(255&i.charCodeAt(++m))<<24))+((1540483477*(l>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),d-=4,++m;switch(d){case 3:u^=(255&i.charCodeAt(m+2))<<16;case 2:u^=(255&i.charCodeAt(m+1))<<8;case 1:u=1540483477*(65535&(u^=255&i.charCodeAt(m)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0};var nx=wu,JD=QD.exports;wb.exports=nx,wb.exports.murmur3=nx,wb.exports.murmur2=JD;var Cu=Ds(wb.exports);class Pf{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(i,s,l,d){this.ids.push(Go(i)),this.positions.push(s,l,d)}eachPosition(i,s){const l=Go(i);let d=0,u=this.ids.length-1;for(;d<u;){const m=d+u>>1;this.ids[m]>=l?u=m:d=m+1}for(;this.ids[d]===l;)s(this.positions[3*d],this.positions[3*d+1],this.positions[3*d+2]),d++}static serialize(i,s){const l=new Float64Array(i.ids),d=new Uint32Array(i.positions);return rx(l,d,0,l.length-1),s&&(s.add(l.buffer),s.add(d.buffer)),{ids:l,positions:d}}static deserialize(i){const s=new Pf;let l;s.ids=i.ids,s.positions=i.positions;for(const d of s.ids)d!==l&&s.uniqueIds.push(d),l=d;return s.indexed=!0,s}}function Go(o){const i=+o;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:Cu(String(o))}function rx(o,i,s,l){for(;s<l;){const d=o[s+l>>1];let u=s-1,m=l+1;for(;;){do{u++}while(o[u]<d);do{m--}while(o[m]>d);if(u>=m)break;bi(o,u,m),bi(i,3*u,3*m),bi(i,3*u+1,3*m+1),bi(i,3*u+2,3*m+2)}m-s<l-m?(rx(o,i,s,m),s=m+1):(rx(o,i,m+1,l),l=m)}}function bi(o,i,s){const l=o[i];o[i]=o[s],o[s]=l}de(Pf,"FeaturePositionMap");class il{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,s),this.initialized=!0),!!this.location}}class fi extends il{constructor(i){super(i),this.current=0}set(i,s,l){this.fetchUniformLocation(i,s)&&this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}}class Pt extends il{constructor(i){super(i),this.current=0}set(i,s,l){this.fetchUniformLocation(i,s)&&this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class Ue extends il{constructor(i){super(i),this.current=[0,0]}set(i,s,l){this.fetchUniformLocation(i,s)&&(l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1])))}}class Ke extends il{constructor(i){super(i),this.current=[0,0,0]}set(i,s,l){this.fetchUniformLocation(i,s)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2])))}}class po extends il{constructor(i){super(i),this.current=[0,0,0,0]}set(i,s,l){this.fetchUniformLocation(i,s)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3])))}}class nl extends il{constructor(i){super(i),this.current=di.transparent}set(i,s,l){this.fetchUniformLocation(i,s)&&(l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a)))}}const tk=new Float32Array(16);class ti extends il{constructor(i){super(i),this.current=tk}set(i,s,l){if(this.fetchUniformLocation(i,s)){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let d=1;d<16;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}}}const mm=new Float32Array(9);class ek extends il{constructor(i){super(i),this.current=mm}set(i,s,l){if(this.fetchUniformLocation(i,s))for(let d=0;d<9;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}const QR=new Float32Array(4);class ik extends il{constructor(i){super(i),this.current=QR}set(i,s,l){if(this.fetchUniformLocation(i,s))for(let d=0;d<4;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}}function nk(o){return[ix(255*o.r,255*o.g),ix(255*o.b,255*o.a)]}class Cb{constructor(i,s,l){this.value=i,this.uniformNames=s.map(d=>`u_${d}`),this.type=l}setUniform(i,s,l,d,u){s.set(i,u,d.constantOr(this.value))}getBinding(i,s){return"color"===this.type?new nl(i):new Pt(i)}}class Of{constructor(i,s){this.uniformNames=s.map(l=>`u_${l}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(i){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br)}setUniform(i,s,l,d,u){const m="u_pattern"===u||"u_dash"===u?this.pattern:"u_pixel_ratio"===u?this.pixelRatio:null;m&&s.set(i,u,m)}getBinding(i,s){return"u_pattern"===s||"u_dash"===s?new po(i):new Pt(i)}}class wd{constructor(i,s,l,d){this.expression=i,this.type=l,this.maxValue=0,this.paintVertexAttributes=s.map(u=>({name:`a_${u}`,type:"Float32",components:"color"===l?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(i,s,l,d,u,m,p){const g=this.paintVertexArray.length,_=this.expression.evaluate(new zn(0,{brightness:m}),s,{},u,d,p);this.paintVertexArray.resize(i),this._setPaintValue(g,i,_)}updatePaintArray(i,s,l,d,u,m,p){const g=this.expression.evaluate({zoom:0,brightness:p},l,d,void 0,u);this._setPaintValue(i,s,g)}_setPaintValue(i,s,l){if("color"===this.type){const d=nk(l);for(let u=i;u<s;u++)this.paintVertexArray.emplace(u,d[0],d[1])}else{for(let d=i;d<s;d++)this.paintVertexArray.emplace(d,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class jl{constructor(i,s,l,d,u,m){this.expression=i,this.uniformNames=s.map(p=>`u_${p}_t`),this.type=l,this.useIntegerZoom=d,this.zoom=u,this.maxValue=0,this.paintVertexAttributes=s.map(p=>({name:`a_${p}`,type:"Float32",components:"color"===l?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(i,s,l,d,u,m,p){const g=this.expression.evaluate(new zn(this.zoom,{brightness:m}),s,{},u,d,p),_=this.expression.evaluate(new zn(this.zoom+1,{brightness:m}),s,{},u,d,p),y=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(y,i,g,_)}updatePaintArray(i,s,l,d,u,m,p){const g=this.expression.evaluate({zoom:this.zoom,brightness:p},l,d,void 0,u),_=this.expression.evaluate({zoom:this.zoom+1,brightness:p},l,d,void 0,u);this._setPaintValue(i,s,g,_)}_setPaintValue(i,s,l,d){if("color"===this.type){const u=nk(l),m=nk(d);for(let p=i;p<s;p++)this.paintVertexArray.emplace(p,u[0],u[1],m[0],m[1])}else{for(let u=i;u<s;u++)this.paintVertexArray.emplace(u,l,d);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(d))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,s,l,d,u){const m=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,p=he(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);s.set(i,u,p)}getBinding(i,s){return new Pt(i)}}class ra{constructor(i,s,l,d,u){this.expression=i,this.layerId=u,this.paintVertexAttributes=("array"===l?KD:XD).members;for(let m=0;m<s.length;++m);this.paintVertexArray=new d}populatePaintArray(i,s,l){const d=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(d,i,s.patterns&&s.patterns[this.layerId],l)}updatePaintArray(i,s,l,d,u,m,p){this._setPaintValues(i,s,l.patterns&&l.patterns[this.layerId],m)}_setPaintValues(i,s,l,d){if(!d||!l)return;const u=d[l];if(!u)return;const{tl:m,br:p,pixelRatio:g}=u;for(let _=i;_<s;_++)this.paintVertexArray.emplace(_,m[0],m[1],p[0],p[1],g)}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Mu{constructor(i,s,l=(()=>!0)){this.binders={},this._buffers=[];const d=[];for(const u in i.paint._values){const m=i.paint.get(u);if(!l(u)||!(m instanceof yd&&Is(m.property.specification)))continue;const p=JR(u,i.type),g=m.value,_=m.property.specification.type,y=!!m.property.useIntegerZoom,v="line-dasharray"===u||u.endsWith("pattern"),w="line-dasharray"===u&&"constant"!==i.layout.get("line-cap").value.kind;if("constant"!==g.kind||w)if("source"===g.kind||w||v){const C=oa(u,_,"source");this.binders[u]=v?new ra(g,p,_,C,i.id):new wd(g,p,_,C),d.push(`/a_${u}`)}else{const C=oa(u,_,"composite");this.binders[u]=new jl(g,p,_,y,s,C),d.push(`/z_${u}`)}else this.binders[u]=v?new Of(g.value,p):new Cb(g.value,p,_),d.push(`/u_${u}`)}this.cacheKey=d.sort().join("")}getMaxValue(i){const s=this.binders[i];return s instanceof wd||s instanceof jl?s.maxValue:0}populatePaintArrays(i,s,l,d,u,m,p){for(const g in this.binders){const _=this.binders[g];(_ instanceof wd||_ instanceof jl||_ instanceof ra)&&_.populatePaintArray(i,s,l,d,u,m,p)}}setConstantPatternPositions(i){for(const s in this.binders){const l=this.binders[s];l instanceof Of&&l.setConstantPatternPositions(i)}}updatePaintArrays(i,s,l,d,u,m,p,g){let _=!1;const y=Object.keys(i),v=0!==y.length,w=v?y:s.uniqueIds;for(const C in this.binders){const D=this.binders[C];if((D instanceof wd||D instanceof jl||D instanceof ra)&&(!0===D.expression.isStateDependent||!1===D.expression.isLightConstant)){const k=u.paint.get(C);D.expression=k.value;for(const S of w){const E=i[S.toString()];s.eachPosition(S,(A,P,O)=>{const R=d.feature(A);D.updatePaintArray(P,O,R,E,m,p,g)})}if(!v)for(const S of l.uniqueIds){const E=i[S.toString()];l.eachPosition(S,(A,P,O)=>{const R=d.feature(A);D.updatePaintArray(P,O,R,E,m,p,g)})}_=!0}}return _}defines(){const i=[];for(const s in this.binders){const l=this.binders[s];(l instanceof Cb||l instanceof Of)&&i.push(...l.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return i}getBinderAttributes(){const i=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof wd||l instanceof jl||l instanceof ra)for(let d=0;d<l.paintVertexAttributes.length;d++)i.push(l.paintVertexAttributes[d].name)}return i}getBinderUniforms(){const i=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof Cb||l instanceof Of||l instanceof jl)for(const d of l.uniformNames)i.push(d)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const s=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof Cb||d instanceof Of||d instanceof jl)for(const u of d.uniformNames)s.push({name:u,property:l,binding:d.getBinding(i,u)})}return s}setUniforms(i,s,l,d,u){for(const{name:m,property:p,binding:g}of l)this.binders[p].setUniform(i,g,u,d.get(p),m)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const s=this.binders[i];(s instanceof wd||s instanceof jl||s instanceof ra)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(i){for(const s in this.binders){const l=this.binders[s];(l instanceof wd||l instanceof jl||l instanceof ra)&&l.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const s=this.binders[i];(s instanceof wd||s instanceof jl||s instanceof ra)&&s.destroy()}}}class Cd{constructor(i,s,l=(()=>!0)){this.programConfigurations={};for(const d of i)this.programConfigurations[d.id]=new Mu(d,s,l);this.needsUpload=!1,this._featureMap=new Pf,this._featureMapWithoutIds=new Pf,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(i,s,l,d,u,m,p,g){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(i,s,d,u,m,p,g);void 0!==s.id?this._featureMap.add(s.id,l,this._bufferOffset,i):(this._featureMapWithoutIds.add(this._idlessCounter,l,this._bufferOffset,i),this._idlessCounter+=1),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,s,l,d,u,m){for(const p of l)this.needsUpload=this.programConfigurations[p.id].updatePaintArrays(i,this._featureMap,this._featureMapWithoutIds,s,p,d,u,m||0)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const fo={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function JR(o,i){return fo[o]||[o.replace(`${i}-`,"").replace(/-/g,"_")]}const Ff={"line-pattern":{source:ds,composite:ds},"fill-pattern":{source:ds,composite:ds},"fill-extrusion-pattern":{source:ds,composite:ds},"line-dasharray":{source:gb,composite:gb}},tP={color:{source:Sc,composite:Sa},number:{source:yb,composite:Sc}};function oa(o,i,s){const l=Ff[o];return l&&l[s]||tP[i][s]}de(Cb,"ConstantBinder"),de(Of,"PatternConstantBinder"),de(wd,"SourceExpressionBinder"),de(ra,"PatternCompositeBinder"),de(jl,"CompositeExpressionBinder"),de(Mu,"ProgramConfiguration",{omit:["_buffers"]}),de(Cd,"ProgramConfigurationSet");class go{constructor(i,s){i&&(s?this.setSouthWest(i).setNorthEast(s):4===i.length?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof qe?new qe(i.lng,i.lat):qe.convert(i),this}setSouthWest(i){return this._sw=i instanceof qe?new qe(i.lng,i.lat):qe.convert(i),this}extend(i){const s=this._sw,l=this._ne;let d,u;if(i instanceof qe)d=i,u=i;else{if(!(i instanceof go))return Array.isArray(i)?4===i.length||i.every(Array.isArray)?this.extend(go.convert(i)):this.extend(qe.convert(i)):"object"==typeof i&&null!==i&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend(qe.convert(i)):this;if(d=i._sw,u=i._ne,!d||!u)return this}return s||l?(s.lng=Math.min(d.lng,s.lng),s.lat=Math.min(d.lat,s.lat),l.lng=Math.max(u.lng,l.lng),l.lat=Math.max(u.lat,l.lat)):(this._sw=new qe(d.lng,d.lat),this._ne=new qe(u.lng,u.lat)),this}getCenter(){return new qe((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new qe(this.getWest(),this.getNorth())}getSouthEast(){return new qe(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:s,lat:l}=qe.convert(i);let d=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&d}static convert(i){return!i||i instanceof go?i:new go(i)}}var Wr={},Mr={};Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.setMatrixArrayType=function(o){Mr.ARRAY_TYPE=rk=o},Mr.toRadian=function(o){return o*eP},Mr.equals=function(o,i){return Math.abs(o-i)<=pm*Math.max(1,Math.abs(o),Math.abs(i))},Mr.RANDOM=Mr.ARRAY_TYPE=Mr.EPSILON=void 0;var pm=1e-6;Mr.EPSILON=pm;var rk=typeof Float32Array<"u"?Float32Array:Array;Mr.ARRAY_TYPE=rk;var j3=Math.random;Mr.RANDOM=j3;var eP=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var o=0,i=arguments.length;i--;)o+=arguments[i]*arguments[i];return Math.sqrt(o)});var Wn={};function us(o){return(us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.create=function(){var o=new Ul.ARRAY_TYPE(4);return Ul.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0),o[0]=1,o[3]=1,o},Wn.clone=function(o){var i=new Ul.ARRAY_TYPE(4);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i},Wn.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o},Wn.identity=function(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=1,o},Wn.fromValues=function(o,i,s,l){var d=new Ul.ARRAY_TYPE(4);return d[0]=o,d[1]=i,d[2]=s,d[3]=l,d},Wn.set=function(o,i,s,l,d){return o[0]=i,o[1]=s,o[2]=l,o[3]=d,o},Wn.transpose=function(o,i){if(o===i){var s=i[1];o[1]=i[2],o[2]=s}else o[0]=i[0],o[1]=i[2],o[2]=i[1],o[3]=i[3];return o},Wn.invert=function(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=s*u-d*l;return m?(o[0]=u*(m=1/m),o[1]=-l*m,o[2]=-d*m,o[3]=s*m,o):null},Wn.adjoint=function(o,i){var s=i[0];return o[0]=i[3],o[1]=-i[1],o[2]=-i[2],o[3]=s,o},Wn.determinant=function(o){return o[0]*o[3]-o[2]*o[1]},Wn.multiply=iP,Wn.rotate=function(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=Math.sin(s),g=Math.cos(s);return o[0]=l*g+u*p,o[1]=d*g+m*p,o[2]=l*-p+u*g,o[3]=d*-p+m*g,o},Wn.scale=function(o,i,s){var l=i[1],d=i[2],u=i[3],m=s[0],p=s[1];return o[0]=i[0]*m,o[1]=l*m,o[2]=d*p,o[3]=u*p,o},Wn.fromRotation=function(o,i){var s=Math.sin(i),l=Math.cos(i);return o[0]=l,o[1]=s,o[2]=-s,o[3]=l,o},Wn.fromScaling=function(o,i){return o[0]=i[0],o[1]=0,o[2]=0,o[3]=i[1],o},Wn.str=function(o){return"mat2("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"},Wn.frob=function(o){return Math.hypot(o[0],o[1],o[2],o[3])},Wn.LDU=function(o,i,s,l){return o[2]=l[2]/l[0],s[0]=l[0],s[1]=l[1],s[3]=l[3]-o[2]*s[1],[o,i,s]},Wn.add=function(o,i,s){return o[0]=i[0]+s[0],o[1]=i[1]+s[1],o[2]=i[2]+s[2],o[3]=i[3]+s[3],o},Wn.subtract=ox,Wn.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]},Wn.equals=function(o,i){var s=o[0],l=o[1],d=o[2],u=o[3],m=i[0],p=i[1],g=i[2],_=i[3];return Math.abs(s-m)<=Ul.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(l-p)<=Ul.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(d-g)<=Ul.EPSILON*Math.max(1,Math.abs(d),Math.abs(g))&&Math.abs(u-_)<=Ul.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))},Wn.multiplyScalar=function(o,i,s){return o[0]=i[0]*s,o[1]=i[1]*s,o[2]=i[2]*s,o[3]=i[3]*s,o},Wn.multiplyScalarAndAdd=function(o,i,s,l){return o[0]=i[0]+s[0]*l,o[1]=i[1]+s[1]*l,o[2]=i[2]+s[2]*l,o[3]=i[3]+s[3]*l,o},Wn.sub=Wn.mul=void 0;var Ul=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==us(o)&&"function"!=typeof o)return{default:o};var s=Du(void 0);if(s&&s.has(o))return s.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in o)if("default"!==u&&Object.prototype.hasOwnProperty.call(o,u)){var m=d?Object.getOwnPropertyDescriptor(o,u):null;m&&(m.get||m.set)?Object.defineProperty(l,u,m):l[u]=o[u]}return l.default=o,s&&s.set(o,l),l}(Mr);function Du(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,s=new WeakMap;return(Du=function(l){return l?s:i})(o)}function iP(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=s[0],g=s[1],_=s[2],y=s[3];return o[0]=l*p+u*g,o[1]=d*p+m*g,o[2]=l*_+u*y,o[3]=d*_+m*y,o}function ox(o,i,s){return o[0]=i[0]-s[0],o[1]=i[1]-s[1],o[2]=i[2]-s[2],o[3]=i[3]-s[3],o}Wn.mul=iP,Wn.sub=ox;var qn={};function sx(o){return(sx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(qn,"__esModule",{value:!0}),qn.create=function(){var o=new Hl.ARRAY_TYPE(6);return Hl.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0,o[4]=0,o[5]=0),o[0]=1,o[3]=1,o},qn.clone=function(o){var i=new Hl.ARRAY_TYPE(6);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i},qn.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[4]=i[4],o[5]=i[5],o},qn.identity=function(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=1,o[4]=0,o[5]=0,o},qn.fromValues=function(o,i,s,l,d,u){var m=new Hl.ARRAY_TYPE(6);return m[0]=o,m[1]=i,m[2]=s,m[3]=l,m[4]=d,m[5]=u,m},qn.set=function(o,i,s,l,d,u,m){return o[0]=i,o[1]=s,o[2]=l,o[3]=d,o[4]=u,o[5]=m,o},qn.invert=function(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=i[4],p=i[5],g=s*u-l*d;return g?(o[0]=u*(g=1/g),o[1]=-l*g,o[2]=-d*g,o[3]=s*g,o[4]=(d*p-u*m)*g,o[5]=(l*m-s*p)*g,o):null},qn.determinant=function(o){return o[0]*o[3]-o[1]*o[2]},qn.multiply=sk,qn.rotate=function(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=i[4],g=i[5],_=Math.sin(s),y=Math.cos(s);return o[0]=l*y+u*_,o[1]=d*y+m*_,o[2]=l*-_+u*y,o[3]=d*-_+m*y,o[4]=p,o[5]=g,o},qn.scale=function(o,i,s){var l=i[1],d=i[2],u=i[3],m=i[4],p=i[5],g=s[0],_=s[1];return o[0]=i[0]*g,o[1]=l*g,o[2]=d*_,o[3]=u*_,o[4]=m,o[5]=p,o},qn.translate=function(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=i[4],g=i[5],_=s[0],y=s[1];return o[0]=l,o[1]=d,o[2]=u,o[3]=m,o[4]=l*_+u*y+p,o[5]=d*_+m*y+g,o},qn.fromRotation=function(o,i){var s=Math.sin(i),l=Math.cos(i);return o[0]=l,o[1]=s,o[2]=-s,o[3]=l,o[4]=0,o[5]=0,o},qn.fromScaling=function(o,i){return o[0]=i[0],o[1]=0,o[2]=0,o[3]=i[1],o[4]=0,o[5]=0,o},qn.fromTranslation=function(o,i){return o[0]=1,o[1]=0,o[2]=0,o[3]=1,o[4]=i[0],o[5]=i[1],o},qn.str=function(o){return"mat2d("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+", "+o[4]+", "+o[5]+")"},qn.frob=function(o){return Math.hypot(o[0],o[1],o[2],o[3],o[4],o[5],1)},qn.add=function(o,i,s){return o[0]=i[0]+s[0],o[1]=i[1]+s[1],o[2]=i[2]+s[2],o[3]=i[3]+s[3],o[4]=i[4]+s[4],o[5]=i[5]+s[5],o},qn.subtract=ak,qn.multiplyScalar=function(o,i,s){return o[0]=i[0]*s,o[1]=i[1]*s,o[2]=i[2]*s,o[3]=i[3]*s,o[4]=i[4]*s,o[5]=i[5]*s,o},qn.multiplyScalarAndAdd=function(o,i,s,l){return o[0]=i[0]+s[0]*l,o[1]=i[1]+s[1]*l,o[2]=i[2]+s[2]*l,o[3]=i[3]+s[3]*l,o[4]=i[4]+s[4]*l,o[5]=i[5]+s[5]*l,o},qn.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]&&o[4]===i[4]&&o[5]===i[5]},qn.equals=function(o,i){var s=o[0],l=o[1],d=o[2],u=o[3],m=o[4],p=o[5],g=i[0],_=i[1],y=i[2],v=i[3],w=i[4],C=i[5];return Math.abs(s-g)<=Hl.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(l-_)<=Hl.EPSILON*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(d-y)<=Hl.EPSILON*Math.max(1,Math.abs(d),Math.abs(y))&&Math.abs(u-v)<=Hl.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(m-w)<=Hl.EPSILON*Math.max(1,Math.abs(m),Math.abs(w))&&Math.abs(p-C)<=Hl.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))},qn.sub=qn.mul=void 0;var Hl=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==sx(o)&&"function"!=typeof o)return{default:o};var s=ok(void 0);if(s&&s.has(o))return s.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in o)if("default"!==u&&Object.prototype.hasOwnProperty.call(o,u)){var m=d?Object.getOwnPropertyDescriptor(o,u):null;m&&(m.get||m.set)?Object.defineProperty(l,u,m):l[u]=o[u]}return l.default=o,s&&s.set(o,l),l}(Mr);function ok(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,s=new WeakMap;return(ok=function(l){return l?s:i})(o)}function sk(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=i[4],g=i[5],_=s[0],y=s[1],v=s[2],w=s[3],C=s[4],D=s[5];return o[0]=l*_+u*y,o[1]=d*_+m*y,o[2]=l*v+u*w,o[3]=d*v+m*w,o[4]=l*C+u*D+p,o[5]=d*C+m*D+g,o}function ak(o,i,s){return o[0]=i[0]-s[0],o[1]=i[1]-s[1],o[2]=i[2]-s[2],o[3]=i[3]-s[3],o[4]=i[4]-s[4],o[5]=i[5]-s[5],o}qn.mul=sk,qn.sub=ak;var mn={};function fm(o){return(fm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(mn,"__esModule",{value:!0}),mn.create=function(){var o=new sa.ARRAY_TYPE(9);return sa.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o},mn.fromMat4=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[4],o[4]=i[5],o[5]=i[6],o[6]=i[8],o[7]=i[9],o[8]=i[10],o},mn.clone=function(o){var i=new sa.ARRAY_TYPE(9);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i[8]=o[8],i},mn.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[4]=i[4],o[5]=i[5],o[6]=i[6],o[7]=i[7],o[8]=i[8],o},mn.fromValues=function(o,i,s,l,d,u,m,p,g){var _=new sa.ARRAY_TYPE(9);return _[0]=o,_[1]=i,_[2]=s,_[3]=l,_[4]=d,_[5]=u,_[6]=m,_[7]=p,_[8]=g,_},mn.set=function(o,i,s,l,d,u,m,p,g,_){return o[0]=i,o[1]=s,o[2]=l,o[3]=d,o[4]=u,o[5]=m,o[6]=p,o[7]=g,o[8]=_,o},mn.identity=function(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=1,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},mn.transpose=function(o,i){if(o===i){var s=i[1],l=i[2],d=i[5];o[1]=i[3],o[2]=i[6],o[3]=s,o[5]=i[7],o[6]=l,o[7]=d}else o[0]=i[0],o[1]=i[3],o[2]=i[6],o[3]=i[1],o[4]=i[4],o[5]=i[7],o[6]=i[2],o[7]=i[5],o[8]=i[8];return o},mn.invert=function(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=i[4],p=i[5],g=i[6],_=i[7],y=i[8],v=y*m-p*_,w=-y*u+p*g,C=_*u-m*g,D=s*v+l*w+d*C;return D?(o[0]=v*(D=1/D),o[1]=(-y*l+d*_)*D,o[2]=(p*l-d*m)*D,o[3]=w*D,o[4]=(y*s-d*g)*D,o[5]=(-p*s+d*u)*D,o[6]=C*D,o[7]=(-_*s+l*g)*D,o[8]=(m*s-l*u)*D,o):null},mn.adjoint=function(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=i[4],p=i[5],g=i[6],_=i[7],y=i[8];return o[0]=m*y-p*_,o[1]=d*_-l*y,o[2]=l*p-d*m,o[3]=p*g-u*y,o[4]=s*y-d*g,o[5]=d*u-s*p,o[6]=u*_-m*g,o[7]=l*g-s*_,o[8]=s*m-l*u,o},mn.determinant=function(o){var i=o[3],s=o[4],l=o[5],d=o[6],u=o[7],m=o[8];return o[0]*(m*s-l*u)+o[1]*(-m*i+l*d)+o[2]*(u*i-s*d)},mn.multiply=lk,mn.translate=function(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=i[4],g=i[5],_=i[6],y=i[7],v=i[8],w=s[0],C=s[1];return o[0]=l,o[1]=d,o[2]=u,o[3]=m,o[4]=p,o[5]=g,o[6]=w*l+C*m+_,o[7]=w*d+C*p+y,o[8]=w*u+C*g+v,o},mn.rotate=function(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=i[4],g=i[5],_=i[6],y=i[7],v=i[8],w=Math.sin(s),C=Math.cos(s);return o[0]=C*l+w*m,o[1]=C*d+w*p,o[2]=C*u+w*g,o[3]=C*m-w*l,o[4]=C*p-w*d,o[5]=C*g-w*u,o[6]=_,o[7]=y,o[8]=v,o},mn.scale=function(o,i,s){var l=s[0],d=s[1];return o[0]=l*i[0],o[1]=l*i[1],o[2]=l*i[2],o[3]=d*i[3],o[4]=d*i[4],o[5]=d*i[5],o[6]=i[6],o[7]=i[7],o[8]=i[8],o},mn.fromTranslation=function(o,i){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=1,o[5]=0,o[6]=i[0],o[7]=i[1],o[8]=1,o},mn.fromRotation=function(o,i){var s=Math.sin(i),l=Math.cos(i);return o[0]=l,o[1]=s,o[2]=0,o[3]=-s,o[4]=l,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},mn.fromScaling=function(o,i){return o[0]=i[0],o[1]=0,o[2]=0,o[3]=0,o[4]=i[1],o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},mn.fromMat2d=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=0,o[3]=i[2],o[4]=i[3],o[5]=0,o[6]=i[4],o[7]=i[5],o[8]=1,o},mn.fromQuat=function(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=s+s,p=l+l,g=d+d,_=s*m,y=l*m,v=l*p,w=d*m,C=d*p,D=d*g,k=u*m,S=u*p,E=u*g;return o[0]=1-v-D,o[3]=y-E,o[6]=w+S,o[1]=y+E,o[4]=1-_-D,o[7]=C-k,o[2]=w-S,o[5]=C+k,o[8]=1-_-v,o},mn.normalFromMat4=function(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=i[4],p=i[5],g=i[6],_=i[7],y=i[8],v=i[9],w=i[10],C=i[11],D=i[12],k=i[13],S=i[14],E=i[15],A=s*p-l*m,P=s*g-d*m,O=s*_-u*m,R=l*g-d*p,F=l*_-u*p,B=d*_-u*g,j=y*k-v*D,U=y*S-w*D,H=y*E-C*D,W=v*S-w*k,q=v*E-C*k,X=w*E-C*S,G=A*X-P*q+O*W+R*H-F*U+B*j;return G?(o[0]=(p*X-g*q+_*W)*(G=1/G),o[1]=(g*H-m*X-_*U)*G,o[2]=(m*q-p*H+_*j)*G,o[3]=(d*q-l*X-u*W)*G,o[4]=(s*X-d*H+u*U)*G,o[5]=(l*H-s*q-u*j)*G,o[6]=(k*B-S*F+E*R)*G,o[7]=(S*O-D*B-E*P)*G,o[8]=(D*F-k*O+E*A)*G,o):null},mn.projection=function(o,i,s){return o[0]=2/i,o[1]=0,o[2]=0,o[3]=0,o[4]=-2/s,o[5]=0,o[6]=-1,o[7]=1,o[8]=1,o},mn.str=function(o){return"mat3("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+", "+o[4]+", "+o[5]+", "+o[6]+", "+o[7]+", "+o[8]+")"},mn.frob=function(o){return Math.hypot(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8])},mn.add=function(o,i,s){return o[0]=i[0]+s[0],o[1]=i[1]+s[1],o[2]=i[2]+s[2],o[3]=i[3]+s[3],o[4]=i[4]+s[4],o[5]=i[5]+s[5],o[6]=i[6]+s[6],o[7]=i[7]+s[7],o[8]=i[8]+s[8],o},mn.subtract=rl,mn.multiplyScalar=function(o,i,s){return o[0]=i[0]*s,o[1]=i[1]*s,o[2]=i[2]*s,o[3]=i[3]*s,o[4]=i[4]*s,o[5]=i[5]*s,o[6]=i[6]*s,o[7]=i[7]*s,o[8]=i[8]*s,o},mn.multiplyScalarAndAdd=function(o,i,s,l){return o[0]=i[0]+s[0]*l,o[1]=i[1]+s[1]*l,o[2]=i[2]+s[2]*l,o[3]=i[3]+s[3]*l,o[4]=i[4]+s[4]*l,o[5]=i[5]+s[5]*l,o[6]=i[6]+s[6]*l,o[7]=i[7]+s[7]*l,o[8]=i[8]+s[8]*l,o},mn.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]&&o[4]===i[4]&&o[5]===i[5]&&o[6]===i[6]&&o[7]===i[7]&&o[8]===i[8]},mn.equals=function(o,i){var s=o[0],l=o[1],d=o[2],u=o[3],m=o[4],p=o[5],g=o[6],_=o[7],y=o[8],v=i[0],w=i[1],C=i[2],D=i[3],k=i[4],S=i[5],E=i[6],A=i[7],P=i[8];return Math.abs(s-v)<=sa.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(l-w)<=sa.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(d-C)<=sa.EPSILON*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(u-D)<=sa.EPSILON*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(m-k)<=sa.EPSILON*Math.max(1,Math.abs(m),Math.abs(k))&&Math.abs(p-S)<=sa.EPSILON*Math.max(1,Math.abs(p),Math.abs(S))&&Math.abs(g-E)<=sa.EPSILON*Math.max(1,Math.abs(g),Math.abs(E))&&Math.abs(_-A)<=sa.EPSILON*Math.max(1,Math.abs(_),Math.abs(A))&&Math.abs(y-P)<=sa.EPSILON*Math.max(1,Math.abs(y),Math.abs(P))},mn.sub=mn.mul=void 0;var sa=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==fm(o)&&"function"!=typeof o)return{default:o};var s=aa(void 0);if(s&&s.has(o))return s.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in o)if("default"!==u&&Object.prototype.hasOwnProperty.call(o,u)){var m=d?Object.getOwnPropertyDescriptor(o,u):null;m&&(m.get||m.set)?Object.defineProperty(l,u,m):l[u]=o[u]}return l.default=o,s&&s.set(o,l),l}(Mr);function aa(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,s=new WeakMap;return(aa=function(l){return l?s:i})(o)}function lk(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=i[4],g=i[5],_=i[6],y=i[7],v=i[8],w=s[0],C=s[1],D=s[2],k=s[3],S=s[4],E=s[5],A=s[6],P=s[7],O=s[8];return o[0]=w*l+C*m+D*_,o[1]=w*d+C*p+D*y,o[2]=w*u+C*g+D*v,o[3]=k*l+S*m+E*_,o[4]=k*d+S*p+E*y,o[5]=k*u+S*g+E*v,o[6]=A*l+P*m+O*_,o[7]=A*d+P*p+O*y,o[8]=A*u+P*g+O*v,o}function rl(o,i,s){return o[0]=i[0]-s[0],o[1]=i[1]-s[1],o[2]=i[2]-s[2],o[3]=i[3]-s[3],o[4]=i[4]-s[4],o[5]=i[5]-s[5],o[6]=i[6]-s[6],o[7]=i[7]-s[7],o[8]=i[8]-s[8],o}mn.mul=lk,mn.sub=rl;var li={};function Mb(o){return(Mb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(li,"__esModule",{value:!0}),li.create=function(){var o=new Yn.ARRAY_TYPE(16);return Yn.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},li.clone=function(o){var i=new Yn.ARRAY_TYPE(16);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i[8]=o[8],i[9]=o[9],i[10]=o[10],i[11]=o[11],i[12]=o[12],i[13]=o[13],i[14]=o[14],i[15]=o[15],i},li.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[4]=i[4],o[5]=i[5],o[6]=i[6],o[7]=i[7],o[8]=i[8],o[9]=i[9],o[10]=i[10],o[11]=i[11],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15],o},li.fromValues=function(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k){var S=new Yn.ARRAY_TYPE(16);return S[0]=o,S[1]=i,S[2]=s,S[3]=l,S[4]=d,S[5]=u,S[6]=m,S[7]=p,S[8]=g,S[9]=_,S[10]=y,S[11]=v,S[12]=w,S[13]=C,S[14]=D,S[15]=k,S},li.set=function(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S){return o[0]=i,o[1]=s,o[2]=l,o[3]=d,o[4]=u,o[5]=m,o[6]=p,o[7]=g,o[8]=_,o[9]=y,o[10]=v,o[11]=w,o[12]=C,o[13]=D,o[14]=k,o[15]=S,o},li.identity=ax,li.transpose=function(o,i){if(o===i){var s=i[1],l=i[2],d=i[3],u=i[6],m=i[7],p=i[11];o[1]=i[4],o[2]=i[8],o[3]=i[12],o[4]=s,o[6]=i[9],o[7]=i[13],o[8]=l,o[9]=u,o[11]=i[14],o[12]=d,o[13]=m,o[14]=p}else o[0]=i[0],o[1]=i[4],o[2]=i[8],o[3]=i[12],o[4]=i[1],o[5]=i[5],o[6]=i[9],o[7]=i[13],o[8]=i[2],o[9]=i[6],o[10]=i[10],o[11]=i[14],o[12]=i[3],o[13]=i[7],o[14]=i[11],o[15]=i[15];return o},li.invert=function(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=i[4],p=i[5],g=i[6],_=i[7],y=i[8],v=i[9],w=i[10],C=i[11],D=i[12],k=i[13],S=i[14],E=i[15],A=s*p-l*m,P=s*g-d*m,O=s*_-u*m,R=l*g-d*p,F=l*_-u*p,B=d*_-u*g,j=y*k-v*D,U=y*S-w*D,H=y*E-C*D,W=v*S-w*k,q=v*E-C*k,X=w*E-C*S,G=A*X-P*q+O*W+R*H-F*U+B*j;return G?(o[0]=(p*X-g*q+_*W)*(G=1/G),o[1]=(d*q-l*X-u*W)*G,o[2]=(k*B-S*F+E*R)*G,o[3]=(w*F-v*B-C*R)*G,o[4]=(g*H-m*X-_*U)*G,o[5]=(s*X-d*H+u*U)*G,o[6]=(S*O-D*B-E*P)*G,o[7]=(y*B-w*O+C*P)*G,o[8]=(m*q-p*H+_*j)*G,o[9]=(l*H-s*q-u*j)*G,o[10]=(D*F-k*O+E*A)*G,o[11]=(v*O-y*F-C*A)*G,o[12]=(p*U-m*W-g*j)*G,o[13]=(s*W-l*U+d*j)*G,o[14]=(k*P-D*R-S*A)*G,o[15]=(y*R-v*P+w*A)*G,o):null},li.adjoint=function(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=i[4],p=i[5],g=i[6],_=i[7],y=i[8],v=i[9],w=i[10],C=i[11],D=i[12],k=i[13],S=i[14],E=i[15];return o[0]=p*(w*E-C*S)-v*(g*E-_*S)+k*(g*C-_*w),o[1]=-(l*(w*E-C*S)-v*(d*E-u*S)+k*(d*C-u*w)),o[2]=l*(g*E-_*S)-p*(d*E-u*S)+k*(d*_-u*g),o[3]=-(l*(g*C-_*w)-p*(d*C-u*w)+v*(d*_-u*g)),o[4]=-(m*(w*E-C*S)-y*(g*E-_*S)+D*(g*C-_*w)),o[5]=s*(w*E-C*S)-y*(d*E-u*S)+D*(d*C-u*w),o[6]=-(s*(g*E-_*S)-m*(d*E-u*S)+D*(d*_-u*g)),o[7]=s*(g*C-_*w)-m*(d*C-u*w)+y*(d*_-u*g),o[8]=m*(v*E-C*k)-y*(p*E-_*k)+D*(p*C-_*v),o[9]=-(s*(v*E-C*k)-y*(l*E-u*k)+D*(l*C-u*v)),o[10]=s*(p*E-_*k)-m*(l*E-u*k)+D*(l*_-u*p),o[11]=-(s*(p*C-_*v)-m*(l*C-u*v)+y*(l*_-u*p)),o[12]=-(m*(v*S-w*k)-y*(p*S-g*k)+D*(p*w-g*v)),o[13]=s*(v*S-w*k)-y*(l*S-d*k)+D*(l*w-d*v),o[14]=-(s*(p*S-g*k)-m*(l*S-d*k)+D*(l*g-d*p)),o[15]=s*(p*w-g*v)-m*(l*w-d*v)+y*(l*g-d*p),o},li.determinant=function(o){var i=o[0],s=o[1],l=o[2],d=o[3],u=o[4],m=o[5],p=o[6],g=o[7],_=o[8],y=o[9],v=o[10],w=o[11],C=o[12],D=o[13],k=o[14],S=o[15];return(i*m-s*u)*(v*S-w*k)-(i*p-l*u)*(y*S-w*D)+(i*g-d*u)*(y*k-v*D)+(s*p-l*m)*(_*S-w*C)-(s*g-d*m)*(_*k-v*C)+(l*g-d*p)*(_*D-y*C)},li.multiply=ck,li.translate=function(o,i,s){var l,d,u,m,p,g,_,y,v,w,C,D,k=s[0],S=s[1],E=s[2];return i===o?(o[12]=i[0]*k+i[4]*S+i[8]*E+i[12],o[13]=i[1]*k+i[5]*S+i[9]*E+i[13],o[14]=i[2]*k+i[6]*S+i[10]*E+i[14],o[15]=i[3]*k+i[7]*S+i[11]*E+i[15]):(d=i[1],u=i[2],m=i[3],p=i[4],g=i[5],_=i[6],y=i[7],v=i[8],w=i[9],C=i[10],D=i[11],o[0]=l=i[0],o[1]=d,o[2]=u,o[3]=m,o[4]=p,o[5]=g,o[6]=_,o[7]=y,o[8]=v,o[9]=w,o[10]=C,o[11]=D,o[12]=l*k+p*S+v*E+i[12],o[13]=d*k+g*S+w*E+i[13],o[14]=u*k+_*S+C*E+i[14],o[15]=m*k+y*S+D*E+i[15]),o},li.scale=function(o,i,s){var l=s[0],d=s[1],u=s[2];return o[0]=i[0]*l,o[1]=i[1]*l,o[2]=i[2]*l,o[3]=i[3]*l,o[4]=i[4]*d,o[5]=i[5]*d,o[6]=i[6]*d,o[7]=i[7]*d,o[8]=i[8]*u,o[9]=i[9]*u,o[10]=i[10]*u,o[11]=i[11]*u,o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15],o},li.rotate=function(o,i,s,l){var d,u,m,p,g,_,y,v,w,C,D,k,S,E,A,P,O,R,F,B,j,U,H,W,q=l[0],X=l[1],G=l[2],Q=Math.hypot(q,X,G);return Q<Yn.EPSILON?null:(q*=Q=1/Q,X*=Q,G*=Q,d=Math.sin(s),u=Math.cos(s),g=i[1],_=i[2],y=i[3],w=i[5],C=i[6],D=i[7],S=i[9],E=i[10],A=i[11],F=q*X*(m=1-u)-G*d,B=X*X*m+u,j=G*X*m+q*d,U=q*G*m+X*d,H=X*G*m-q*d,W=G*G*m+u,o[0]=(p=i[0])*(P=q*q*m+u)+(v=i[4])*(O=X*q*m+G*d)+(k=i[8])*(R=G*q*m-X*d),o[1]=g*P+w*O+S*R,o[2]=_*P+C*O+E*R,o[3]=y*P+D*O+A*R,o[4]=p*F+v*B+k*j,o[5]=g*F+w*B+S*j,o[6]=_*F+C*B+E*j,o[7]=y*F+D*B+A*j,o[8]=p*U+v*H+k*W,o[9]=g*U+w*H+S*W,o[10]=_*U+C*H+E*W,o[11]=y*U+D*H+A*W,i!==o&&(o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o)},li.rotateX=function(o,i,s){var l=Math.sin(s),d=Math.cos(s),u=i[4],m=i[5],p=i[6],g=i[7],_=i[8],y=i[9],v=i[10],w=i[11];return i!==o&&(o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o[4]=u*d+_*l,o[5]=m*d+y*l,o[6]=p*d+v*l,o[7]=g*d+w*l,o[8]=_*d-u*l,o[9]=y*d-m*l,o[10]=v*d-p*l,o[11]=w*d-g*l,o},li.rotateY=function(o,i,s){var l=Math.sin(s),d=Math.cos(s),u=i[0],m=i[1],p=i[2],g=i[3],_=i[8],y=i[9],v=i[10],w=i[11];return i!==o&&(o[4]=i[4],o[5]=i[5],o[6]=i[6],o[7]=i[7],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o[0]=u*d-_*l,o[1]=m*d-y*l,o[2]=p*d-v*l,o[3]=g*d-w*l,o[8]=u*l+_*d,o[9]=m*l+y*d,o[10]=p*l+v*d,o[11]=g*l+w*d,o},li.rotateZ=function(o,i,s){var l=Math.sin(s),d=Math.cos(s),u=i[0],m=i[1],p=i[2],g=i[3],_=i[4],y=i[5],v=i[6],w=i[7];return i!==o&&(o[8]=i[8],o[9]=i[9],o[10]=i[10],o[11]=i[11],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o[0]=u*d+_*l,o[1]=m*d+y*l,o[2]=p*d+v*l,o[3]=g*d+w*l,o[4]=_*d-u*l,o[5]=y*d-m*l,o[6]=v*d-p*l,o[7]=w*d-g*l,o},li.fromTranslation=function(o,i){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=i[0],o[13]=i[1],o[14]=i[2],o[15]=1,o},li.fromScaling=function(o,i){return o[0]=i[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=i[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},li.fromRotation=function(o,i,s){var l,d,u,m=s[0],p=s[1],g=s[2],_=Math.hypot(m,p,g);return _<Yn.EPSILON?null:(m*=_=1/_,p*=_,g*=_,l=Math.sin(i),d=Math.cos(i),o[0]=m*m*(u=1-d)+d,o[1]=p*m*u+g*l,o[2]=g*m*u-p*l,o[3]=0,o[4]=m*p*u-g*l,o[5]=p*p*u+d,o[6]=g*p*u+m*l,o[7]=0,o[8]=m*g*u+p*l,o[9]=p*g*u-m*l,o[10]=g*g*u+d,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o)},li.fromXRotation=function(o,i){var s=Math.sin(i),l=Math.cos(i);return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=l,o[6]=s,o[7]=0,o[8]=0,o[9]=-s,o[10]=l,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},li.fromYRotation=function(o,i){var s=Math.sin(i),l=Math.cos(i);return o[0]=l,o[1]=0,o[2]=-s,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=s,o[9]=0,o[10]=l,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},li.fromZRotation=function(o,i){var s=Math.sin(i),l=Math.cos(i);return o[0]=l,o[1]=s,o[2]=0,o[3]=0,o[4]=-s,o[5]=l,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},li.fromRotationTranslation=dk,li.fromQuat2=function(o,i){var s=new Yn.ARRAY_TYPE(3),l=-i[0],d=-i[1],u=-i[2],m=i[3],p=i[4],g=i[5],_=i[6],y=i[7],v=l*l+d*d+u*u+m*m;return v>0?(s[0]=2*(p*m+y*l+g*u-_*d)/v,s[1]=2*(g*m+y*d+_*l-p*u)/v,s[2]=2*(_*m+y*u+p*d-g*l)/v):(s[0]=2*(p*m+y*l+g*u-_*d),s[1]=2*(g*m+y*d+_*l-p*u),s[2]=2*(_*m+y*u+p*d-g*l)),dk(o,i,s),o},li.getTranslation=function(o,i){return o[0]=i[12],o[1]=i[13],o[2]=i[14],o},li.getScaling=ku,li.getRotation=function(o,i){var s=new Yn.ARRAY_TYPE(3);ku(s,i);var l=1/s[0],d=1/s[1],u=1/s[2],m=i[0]*l,p=i[1]*d,g=i[2]*u,_=i[4]*l,y=i[5]*d,v=i[6]*u,w=i[8]*l,C=i[9]*d,D=i[10]*u,k=m+y+D,S=0;return k>0?(S=2*Math.sqrt(k+1),o[3]=.25*S,o[0]=(v-C)/S,o[1]=(w-g)/S,o[2]=(p-_)/S):m>y&&m>D?(S=2*Math.sqrt(1+m-y-D),o[3]=(v-C)/S,o[0]=.25*S,o[1]=(p+_)/S,o[2]=(w+g)/S):y>D?(S=2*Math.sqrt(1+y-m-D),o[3]=(w-g)/S,o[0]=(p+_)/S,o[1]=.25*S,o[2]=(v+C)/S):(S=2*Math.sqrt(1+D-m-y),o[3]=(p-_)/S,o[0]=(w+g)/S,o[1]=(v+C)/S,o[2]=.25*S),o},li.fromRotationTranslationScale=function(o,i,s,l){var d=i[0],u=i[1],m=i[2],p=i[3],g=d+d,_=u+u,y=m+m,v=d*g,w=d*_,C=d*y,D=u*_,k=u*y,S=m*y,E=p*g,A=p*_,P=p*y,O=l[0],R=l[1],F=l[2];return o[0]=(1-(D+S))*O,o[1]=(w+P)*O,o[2]=(C-A)*O,o[3]=0,o[4]=(w-P)*R,o[5]=(1-(v+S))*R,o[6]=(k+E)*R,o[7]=0,o[8]=(C+A)*F,o[9]=(k-E)*F,o[10]=(1-(v+D))*F,o[11]=0,o[12]=s[0],o[13]=s[1],o[14]=s[2],o[15]=1,o},li.fromRotationTranslationScaleOrigin=function(o,i,s,l,d){var u=i[0],m=i[1],p=i[2],g=i[3],_=u+u,y=m+m,v=p+p,w=u*_,C=u*y,D=u*v,k=m*y,S=m*v,E=p*v,A=g*_,P=g*y,O=g*v,R=l[0],F=l[1],B=l[2],j=d[0],U=d[1],H=d[2],W=(1-(k+E))*R,q=(C+O)*R,X=(D-P)*R,G=(C-O)*F,Q=(1-(w+E))*F,it=(S+A)*F,st=(D+P)*B,J=(S-A)*B,et=(1-(w+k))*B;return o[0]=W,o[1]=q,o[2]=X,o[3]=0,o[4]=G,o[5]=Q,o[6]=it,o[7]=0,o[8]=st,o[9]=J,o[10]=et,o[11]=0,o[12]=s[0]+j-(W*j+G*U+st*H),o[13]=s[1]+U-(q*j+Q*U+J*H),o[14]=s[2]+H-(X*j+it*U+et*H),o[15]=1,o},li.fromQuat=function(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=s+s,p=l+l,g=d+d,_=s*m,y=l*m,v=l*p,w=d*m,C=d*p,D=d*g,k=u*m,S=u*p,E=u*g;return o[0]=1-v-D,o[1]=y+E,o[2]=w-S,o[3]=0,o[4]=y-E,o[5]=1-_-D,o[6]=C+k,o[7]=0,o[8]=w+S,o[9]=C-k,o[10]=1-_-v,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},li.frustum=function(o,i,s,l,d,u,m){var p=1/(s-i),g=1/(d-l),_=1/(u-m);return o[0]=2*u*p,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*u*g,o[6]=0,o[7]=0,o[8]=(s+i)*p,o[9]=(d+l)*g,o[10]=(m+u)*_,o[11]=-1,o[12]=0,o[13]=0,o[14]=m*u*2*_,o[15]=0,o},li.perspectiveNO=gm,li.perspectiveZO=function(o,i,s,l,d){var u,m=1/Math.tan(i/2);return o[0]=m/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=m,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,null!=d&&d!==1/0?(o[10]=d*(u=1/(l-d)),o[14]=d*l*u):(o[10]=-1,o[14]=-l),o},li.perspectiveFromFieldOfView=function(o,i,s,l){var d=Math.tan(i.upDegrees*Math.PI/180),u=Math.tan(i.downDegrees*Math.PI/180),m=Math.tan(i.leftDegrees*Math.PI/180),p=Math.tan(i.rightDegrees*Math.PI/180),g=2/(m+p),_=2/(d+u);return o[0]=g,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=_,o[6]=0,o[7]=0,o[8]=-(m-p)*g*.5,o[9]=(d-u)*_*.5,o[10]=l/(s-l),o[11]=-1,o[12]=0,o[13]=0,o[14]=l*s/(s-l),o[15]=0,o},li.orthoNO=uk,li.orthoZO=function(o,i,s,l,d,u,m){var p=1/(i-s),g=1/(l-d),_=1/(u-m);return o[0]=-2*p,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*g,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=_,o[11]=0,o[12]=(i+s)*p,o[13]=(d+l)*g,o[14]=u*_,o[15]=1,o},li.lookAt=function(o,i,s,l){var d,u,m,p,g,_,y,v,w,C,D=i[0],k=i[1],S=i[2],E=l[0],A=l[1],P=l[2],O=s[0],R=s[1],F=s[2];return Math.abs(D-O)<Yn.EPSILON&&Math.abs(k-R)<Yn.EPSILON&&Math.abs(S-F)<Yn.EPSILON?ax(o):(y=D-O,v=k-R,w=S-F,d=A*(w*=C=1/Math.hypot(y,v,w))-P*(v*=C),u=P*(y*=C)-E*w,m=E*v-A*y,(C=Math.hypot(d,u,m))?(d*=C=1/C,u*=C,m*=C):(d=0,u=0,m=0),p=v*m-w*u,g=w*d-y*m,_=y*u-v*d,(C=Math.hypot(p,g,_))?(p*=C=1/C,g*=C,_*=C):(p=0,g=0,_=0),o[0]=d,o[1]=p,o[2]=y,o[3]=0,o[4]=u,o[5]=g,o[6]=v,o[7]=0,o[8]=m,o[9]=_,o[10]=w,o[11]=0,o[12]=-(d*D+u*k+m*S),o[13]=-(p*D+g*k+_*S),o[14]=-(y*D+v*k+w*S),o[15]=1,o)},li.targetTo=function(o,i,s,l){var d=i[0],u=i[1],m=i[2],p=l[0],g=l[1],_=l[2],y=d-s[0],v=u-s[1],w=m-s[2],C=y*y+v*v+w*w;C>0&&(y*=C=1/Math.sqrt(C),v*=C,w*=C);var D=g*w-_*v,k=_*y-p*w,S=p*v-g*y;return(C=D*D+k*k+S*S)>0&&(D*=C=1/Math.sqrt(C),k*=C,S*=C),o[0]=D,o[1]=k,o[2]=S,o[3]=0,o[4]=v*S-w*k,o[5]=w*D-y*S,o[6]=y*k-v*D,o[7]=0,o[8]=y,o[9]=v,o[10]=w,o[11]=0,o[12]=d,o[13]=u,o[14]=m,o[15]=1,o},li.str=function(o){return"mat4("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+", "+o[4]+", "+o[5]+", "+o[6]+", "+o[7]+", "+o[8]+", "+o[9]+", "+o[10]+", "+o[11]+", "+o[12]+", "+o[13]+", "+o[14]+", "+o[15]+")"},li.frob=function(o){return Math.hypot(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15])},li.add=function(o,i,s){return o[0]=i[0]+s[0],o[1]=i[1]+s[1],o[2]=i[2]+s[2],o[3]=i[3]+s[3],o[4]=i[4]+s[4],o[5]=i[5]+s[5],o[6]=i[6]+s[6],o[7]=i[7]+s[7],o[8]=i[8]+s[8],o[9]=i[9]+s[9],o[10]=i[10]+s[10],o[11]=i[11]+s[11],o[12]=i[12]+s[12],o[13]=i[13]+s[13],o[14]=i[14]+s[14],o[15]=i[15]+s[15],o},li.subtract=nP,li.multiplyScalar=function(o,i,s){return o[0]=i[0]*s,o[1]=i[1]*s,o[2]=i[2]*s,o[3]=i[3]*s,o[4]=i[4]*s,o[5]=i[5]*s,o[6]=i[6]*s,o[7]=i[7]*s,o[8]=i[8]*s,o[9]=i[9]*s,o[10]=i[10]*s,o[11]=i[11]*s,o[12]=i[12]*s,o[13]=i[13]*s,o[14]=i[14]*s,o[15]=i[15]*s,o},li.multiplyScalarAndAdd=function(o,i,s,l){return o[0]=i[0]+s[0]*l,o[1]=i[1]+s[1]*l,o[2]=i[2]+s[2]*l,o[3]=i[3]+s[3]*l,o[4]=i[4]+s[4]*l,o[5]=i[5]+s[5]*l,o[6]=i[6]+s[6]*l,o[7]=i[7]+s[7]*l,o[8]=i[8]+s[8]*l,o[9]=i[9]+s[9]*l,o[10]=i[10]+s[10]*l,o[11]=i[11]+s[11]*l,o[12]=i[12]+s[12]*l,o[13]=i[13]+s[13]*l,o[14]=i[14]+s[14]*l,o[15]=i[15]+s[15]*l,o},li.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]&&o[4]===i[4]&&o[5]===i[5]&&o[6]===i[6]&&o[7]===i[7]&&o[8]===i[8]&&o[9]===i[9]&&o[10]===i[10]&&o[11]===i[11]&&o[12]===i[12]&&o[13]===i[13]&&o[14]===i[14]&&o[15]===i[15]},li.equals=function(o,i){var s=o[0],l=o[1],d=o[2],u=o[3],m=o[4],p=o[5],g=o[6],_=o[7],y=o[8],v=o[9],w=o[10],C=o[11],D=o[12],k=o[13],S=o[14],E=o[15],A=i[0],P=i[1],O=i[2],R=i[3],F=i[4],B=i[5],j=i[6],U=i[7],H=i[8],W=i[9],q=i[10],X=i[11],G=i[12],Q=i[13],it=i[14],st=i[15];return Math.abs(s-A)<=Yn.EPSILON*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(l-P)<=Yn.EPSILON*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(d-O)<=Yn.EPSILON*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(u-R)<=Yn.EPSILON*Math.max(1,Math.abs(u),Math.abs(R))&&Math.abs(m-F)<=Yn.EPSILON*Math.max(1,Math.abs(m),Math.abs(F))&&Math.abs(p-B)<=Yn.EPSILON*Math.max(1,Math.abs(p),Math.abs(B))&&Math.abs(g-j)<=Yn.EPSILON*Math.max(1,Math.abs(g),Math.abs(j))&&Math.abs(_-U)<=Yn.EPSILON*Math.max(1,Math.abs(_),Math.abs(U))&&Math.abs(y-H)<=Yn.EPSILON*Math.max(1,Math.abs(y),Math.abs(H))&&Math.abs(v-W)<=Yn.EPSILON*Math.max(1,Math.abs(v),Math.abs(W))&&Math.abs(w-q)<=Yn.EPSILON*Math.max(1,Math.abs(w),Math.abs(q))&&Math.abs(C-X)<=Yn.EPSILON*Math.max(1,Math.abs(C),Math.abs(X))&&Math.abs(D-G)<=Yn.EPSILON*Math.max(1,Math.abs(D),Math.abs(G))&&Math.abs(k-Q)<=Yn.EPSILON*Math.max(1,Math.abs(k),Math.abs(Q))&&Math.abs(S-it)<=Yn.EPSILON*Math.max(1,Math.abs(S),Math.abs(it))&&Math.abs(E-st)<=Yn.EPSILON*Math.max(1,Math.abs(E),Math.abs(st))},li.sub=li.mul=li.ortho=li.perspective=void 0;var Yn=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==Mb(o)&&"function"!=typeof o)return{default:o};var s=Lf(void 0);if(s&&s.has(o))return s.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in o)if("default"!==u&&Object.prototype.hasOwnProperty.call(o,u)){var m=d?Object.getOwnPropertyDescriptor(o,u):null;m&&(m.get||m.set)?Object.defineProperty(l,u,m):l[u]=o[u]}return l.default=o,s&&s.set(o,l),l}(Mr);function Lf(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,s=new WeakMap;return(Lf=function(l){return l?s:i})(o)}function ax(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function ck(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=i[4],g=i[5],_=i[6],y=i[7],v=i[8],w=i[9],C=i[10],D=i[11],k=i[12],S=i[13],E=i[14],A=i[15],P=s[0],O=s[1],R=s[2],F=s[3];return o[0]=P*l+O*p+R*v+F*k,o[1]=P*d+O*g+R*w+F*S,o[2]=P*u+O*_+R*C+F*E,o[3]=P*m+O*y+R*D+F*A,o[4]=(P=s[4])*l+(O=s[5])*p+(R=s[6])*v+(F=s[7])*k,o[5]=P*d+O*g+R*w+F*S,o[6]=P*u+O*_+R*C+F*E,o[7]=P*m+O*y+R*D+F*A,o[8]=(P=s[8])*l+(O=s[9])*p+(R=s[10])*v+(F=s[11])*k,o[9]=P*d+O*g+R*w+F*S,o[10]=P*u+O*_+R*C+F*E,o[11]=P*m+O*y+R*D+F*A,o[12]=(P=s[12])*l+(O=s[13])*p+(R=s[14])*v+(F=s[15])*k,o[13]=P*d+O*g+R*w+F*S,o[14]=P*u+O*_+R*C+F*E,o[15]=P*m+O*y+R*D+F*A,o}function dk(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=l+l,g=d+d,_=u+u,y=l*p,v=l*g,w=l*_,C=d*g,D=d*_,k=u*_,S=m*p,E=m*g,A=m*_;return o[0]=1-(C+k),o[1]=v+A,o[2]=w-E,o[3]=0,o[4]=v-A,o[5]=1-(y+k),o[6]=D+S,o[7]=0,o[8]=w+E,o[9]=D-S,o[10]=1-(y+C),o[11]=0,o[12]=s[0],o[13]=s[1],o[14]=s[2],o[15]=1,o}function ku(o,i){var s=i[4],l=i[5],d=i[6],u=i[8],m=i[9],p=i[10];return o[0]=Math.hypot(i[0],i[1],i[2]),o[1]=Math.hypot(s,l,d),o[2]=Math.hypot(u,m,p),o}function gm(o,i,s,l,d){var u,m=1/Math.tan(i/2);return o[0]=m/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=m,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,null!=d&&d!==1/0?(o[10]=(d+l)*(u=1/(l-d)),o[14]=2*d*l*u):(o[10]=-1,o[14]=-2*l),o}function uk(o,i,s,l,d,u,m){var p=1/(i-s),g=1/(l-d),_=1/(u-m);return o[0]=-2*p,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*g,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*_,o[11]=0,o[12]=(i+s)*p,o[13]=(d+l)*g,o[14]=(m+u)*_,o[15]=1,o}function nP(o,i,s){return o[0]=i[0]-s[0],o[1]=i[1]-s[1],o[2]=i[2]-s[2],o[3]=i[3]-s[3],o[4]=i[4]-s[4],o[5]=i[5]-s[5],o[6]=i[6]-s[6],o[7]=i[7]-s[7],o[8]=i[8]-s[8],o[9]=i[9]-s[9],o[10]=i[10]-s[10],o[11]=i[11]-s[11],o[12]=i[12]-s[12],o[13]=i[13]-s[13],o[14]=i[14]-s[14],o[15]=i[15]-s[15],o}li.perspective=gm,li.ortho=uk,li.mul=ck,li.sub=nP;var ii={},ri={};function hk(o){return(hk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(ri,"__esModule",{value:!0}),ri.create=pk,ri.clone=function(o){var i=new Tc.ARRAY_TYPE(3);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i},ri.length=Bf,ri.fromValues=function(o,i,s){var l=new Tc.ARRAY_TYPE(3);return l[0]=o,l[1]=i,l[2]=s,l},ri.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o},ri.set=function(o,i,s,l){return o[0]=i,o[1]=s,o[2]=l,o},ri.add=function(o,i,s){return o[0]=i[0]+s[0],o[1]=i[1]+s[1],o[2]=i[2]+s[2],o},ri.subtract=lx,ri.multiply=fk,ri.divide=cx,ri.ceil=function(o,i){return o[0]=Math.ceil(i[0]),o[1]=Math.ceil(i[1]),o[2]=Math.ceil(i[2]),o},ri.floor=function(o,i){return o[0]=Math.floor(i[0]),o[1]=Math.floor(i[1]),o[2]=Math.floor(i[2]),o},ri.min=function(o,i,s){return o[0]=Math.min(i[0],s[0]),o[1]=Math.min(i[1],s[1]),o[2]=Math.min(i[2],s[2]),o},ri.max=function(o,i,s){return o[0]=Math.max(i[0],s[0]),o[1]=Math.max(i[1],s[1]),o[2]=Math.max(i[2],s[2]),o},ri.round=function(o,i){return o[0]=Math.round(i[0]),o[1]=Math.round(i[1]),o[2]=Math.round(i[2]),o},ri.scale=function(o,i,s){return o[0]=i[0]*s,o[1]=i[1]*s,o[2]=i[2]*s,o},ri.scaleAndAdd=function(o,i,s,l){return o[0]=i[0]+s[0]*l,o[1]=i[1]+s[1]*l,o[2]=i[2]+s[2]*l,o},ri.distance=rP,ri.squaredDistance=dx,ri.squaredLength=oP,ri.negate=function(o,i){return o[0]=-i[0],o[1]=-i[1],o[2]=-i[2],o},ri.inverse=function(o,i){return o[0]=1/i[0],o[1]=1/i[1],o[2]=1/i[2],o},ri.normalize=function(o,i){var s=i[0],l=i[1],d=i[2],u=s*s+l*l+d*d;return u>0&&(u=1/Math.sqrt(u)),o[0]=i[0]*u,o[1]=i[1]*u,o[2]=i[2]*u,o},ri.dot=gk,ri.cross=function(o,i,s){var l=i[0],d=i[1],u=i[2],m=s[0],p=s[1],g=s[2];return o[0]=d*g-u*p,o[1]=u*m-l*g,o[2]=l*p-d*m,o},ri.lerp=function(o,i,s,l){var d=i[0],u=i[1],m=i[2];return o[0]=d+l*(s[0]-d),o[1]=u+l*(s[1]-u),o[2]=m+l*(s[2]-m),o},ri.hermite=function(o,i,s,l,d,u){var m=u*u,p=m*(2*u-3)+1,g=m*(u-2)+u,_=m*(u-1),y=m*(3-2*u);return o[0]=i[0]*p+s[0]*g+l[0]*_+d[0]*y,o[1]=i[1]*p+s[1]*g+l[1]*_+d[1]*y,o[2]=i[2]*p+s[2]*g+l[2]*_+d[2]*y,o},ri.bezier=function(o,i,s,l,d,u){var m=1-u,p=m*m,g=u*u,_=p*m,y=3*u*p,v=3*g*m,w=g*u;return o[0]=i[0]*_+s[0]*y+l[0]*v+d[0]*w,o[1]=i[1]*_+s[1]*y+l[1]*v+d[1]*w,o[2]=i[2]*_+s[2]*y+l[2]*v+d[2]*w,o},ri.random=function(o,i){i=i||1;var s=2*Tc.RANDOM()*Math.PI,l=2*Tc.RANDOM()-1,d=Math.sqrt(1-l*l)*i;return o[0]=Math.cos(s)*d,o[1]=Math.sin(s)*d,o[2]=l*i,o},ri.transformMat4=function(o,i,s){var l=i[0],d=i[1],u=i[2],m=s[3]*l+s[7]*d+s[11]*u+s[15];return o[0]=(s[0]*l+s[4]*d+s[8]*u+s[12])/(m=m||1),o[1]=(s[1]*l+s[5]*d+s[9]*u+s[13])/m,o[2]=(s[2]*l+s[6]*d+s[10]*u+s[14])/m,o},ri.transformMat3=function(o,i,s){var l=i[0],d=i[1],u=i[2];return o[0]=l*s[0]+d*s[3]+u*s[6],o[1]=l*s[1]+d*s[4]+u*s[7],o[2]=l*s[2]+d*s[5]+u*s[8],o},ri.transformQuat=function(o,i,s){var l=s[0],d=s[1],u=s[2],m=i[0],p=i[1],g=i[2],_=d*g-u*p,y=u*m-l*g,v=l*p-d*m,w=d*v-u*y,C=u*_-l*v,D=l*y-d*_,k=2*s[3];return y*=k,v*=k,C*=2,D*=2,o[0]=m+(_*=k)+(w*=2),o[1]=p+y+C,o[2]=g+v+D,o},ri.rotateX=function(o,i,s,l){var d=[],u=[];return d[0]=i[0]-s[0],d[1]=i[1]-s[1],d[2]=i[2]-s[2],u[0]=d[0],u[1]=d[1]*Math.cos(l)-d[2]*Math.sin(l),u[2]=d[1]*Math.sin(l)+d[2]*Math.cos(l),o[0]=u[0]+s[0],o[1]=u[1]+s[1],o[2]=u[2]+s[2],o},ri.rotateY=function(o,i,s,l){var d=[],u=[];return d[0]=i[0]-s[0],d[1]=i[1]-s[1],d[2]=i[2]-s[2],u[0]=d[2]*Math.sin(l)+d[0]*Math.cos(l),u[1]=d[1],u[2]=d[2]*Math.cos(l)-d[0]*Math.sin(l),o[0]=u[0]+s[0],o[1]=u[1]+s[1],o[2]=u[2]+s[2],o},ri.rotateZ=function(o,i,s,l){var d=[],u=[];return d[0]=i[0]-s[0],d[1]=i[1]-s[1],d[2]=i[2]-s[2],u[0]=d[0]*Math.cos(l)-d[1]*Math.sin(l),u[1]=d[0]*Math.sin(l)+d[1]*Math.cos(l),u[2]=d[2],o[0]=u[0]+s[0],o[1]=u[1]+s[1],o[2]=u[2]+s[2],o},ri.angle=function(o,i){var s=o[0],l=o[1],d=o[2],u=i[0],m=i[1],p=i[2],g=Math.sqrt(s*s+l*l+d*d)*Math.sqrt(u*u+m*m+p*p),_=g&&gk(o,i)/g;return Math.acos(Math.min(Math.max(_,-1),1))},ri.zero=function(o){return o[0]=0,o[1]=0,o[2]=0,o},ri.str=function(o){return"vec3("+o[0]+", "+o[1]+", "+o[2]+")"},ri.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]},ri.equals=function(o,i){var s=o[0],l=o[1],d=o[2],u=i[0],m=i[1],p=i[2];return Math.abs(s-u)<=Tc.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(l-m)<=Tc.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(d-p)<=Tc.EPSILON*Math.max(1,Math.abs(d),Math.abs(p))},ri.forEach=ri.sqrLen=ri.len=ri.sqrDist=ri.dist=ri.div=ri.mul=ri.sub=void 0;var Tc=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==hk(o)&&"function"!=typeof o)return{default:o};var s=mk(void 0);if(s&&s.has(o))return s.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in o)if("default"!==u&&Object.prototype.hasOwnProperty.call(o,u)){var m=d?Object.getOwnPropertyDescriptor(o,u):null;m&&(m.get||m.set)?Object.defineProperty(l,u,m):l[u]=o[u]}return l.default=o,s&&s.set(o,l),l}(Mr);function mk(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,s=new WeakMap;return(mk=function(l){return l?s:i})(o)}function pk(){var o=new Tc.ARRAY_TYPE(3);return Tc.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function Bf(o){return Math.hypot(o[0],o[1],o[2])}function lx(o,i,s){return o[0]=i[0]-s[0],o[1]=i[1]-s[1],o[2]=i[2]-s[2],o}function fk(o,i,s){return o[0]=i[0]*s[0],o[1]=i[1]*s[1],o[2]=i[2]*s[2],o}function cx(o,i,s){return o[0]=i[0]/s[0],o[1]=i[1]/s[1],o[2]=i[2]/s[2],o}function rP(o,i){return Math.hypot(i[0]-o[0],i[1]-o[1],i[2]-o[2])}function dx(o,i){var s=i[0]-o[0],l=i[1]-o[1],d=i[2]-o[2];return s*s+l*l+d*d}function oP(o){var i=o[0],s=o[1],l=o[2];return i*i+s*s+l*l}function gk(o,i){return o[0]*i[0]+o[1]*i[1]+o[2]*i[2]}ri.sub=lx,ri.mul=fk,ri.div=cx,ri.dist=rP,ri.sqrDist=dx,ri.len=Bf,ri.sqrLen=oP;var Ec,ux=(Ec=pk(),function(o,i,s,l,d,u){var m,p;for(i||(i=3),s||(s=0),p=l?Math.min(l*i+s,o.length):o.length,m=s;m<p;m+=i)Ec[0]=o[m],Ec[1]=o[m+1],Ec[2]=o[m+2],d(Ec,Ec,u),o[m]=Ec[0],o[m+1]=Ec[1],o[m+2]=Ec[2];return o});ri.forEach=ux;var Di={};function _k(o){return(_k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(Di,"__esModule",{value:!0}),Di.create=aP,Di.clone=function(o){var i=new Fs.ARRAY_TYPE(4);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i},Di.fromValues=function(o,i,s,l){var d=new Fs.ARRAY_TYPE(4);return d[0]=o,d[1]=i,d[2]=s,d[3]=l,d},Di.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o},Di.set=function(o,i,s,l,d){return o[0]=i,o[1]=s,o[2]=l,o[3]=d,o},Di.add=function(o,i,s){return o[0]=i[0]+s[0],o[1]=i[1]+s[1],o[2]=i[2]+s[2],o[3]=i[3]+s[3],o},Di.subtract=lP,Di.multiply=cP,Di.divide=dP,Di.ceil=function(o,i){return o[0]=Math.ceil(i[0]),o[1]=Math.ceil(i[1]),o[2]=Math.ceil(i[2]),o[3]=Math.ceil(i[3]),o},Di.floor=function(o,i){return o[0]=Math.floor(i[0]),o[1]=Math.floor(i[1]),o[2]=Math.floor(i[2]),o[3]=Math.floor(i[3]),o},Di.min=function(o,i,s){return o[0]=Math.min(i[0],s[0]),o[1]=Math.min(i[1],s[1]),o[2]=Math.min(i[2],s[2]),o[3]=Math.min(i[3],s[3]),o},Di.max=function(o,i,s){return o[0]=Math.max(i[0],s[0]),o[1]=Math.max(i[1],s[1]),o[2]=Math.max(i[2],s[2]),o[3]=Math.max(i[3],s[3]),o},Di.round=function(o,i){return o[0]=Math.round(i[0]),o[1]=Math.round(i[1]),o[2]=Math.round(i[2]),o[3]=Math.round(i[3]),o},Di.scale=function(o,i,s){return o[0]=i[0]*s,o[1]=i[1]*s,o[2]=i[2]*s,o[3]=i[3]*s,o},Di.scaleAndAdd=function(o,i,s,l){return o[0]=i[0]+s[0]*l,o[1]=i[1]+s[1]*l,o[2]=i[2]+s[2]*l,o[3]=i[3]+s[3]*l,o},Di.distance=bk,Di.squaredDistance=Nf,Di.length=zf,Di.squaredLength=hx,Di.negate=function(o,i){return o[0]=-i[0],o[1]=-i[1],o[2]=-i[2],o[3]=-i[3],o},Di.inverse=function(o,i){return o[0]=1/i[0],o[1]=1/i[1],o[2]=1/i[2],o[3]=1/i[3],o},Di.normalize=function(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=s*s+l*l+d*d+u*u;return m>0&&(m=1/Math.sqrt(m)),o[0]=s*m,o[1]=l*m,o[2]=d*m,o[3]=u*m,o},Di.dot=function(o,i){return o[0]*i[0]+o[1]*i[1]+o[2]*i[2]+o[3]*i[3]},Di.cross=function(o,i,s,l){var d=s[0]*l[1]-s[1]*l[0],u=s[0]*l[2]-s[2]*l[0],m=s[0]*l[3]-s[3]*l[0],p=s[1]*l[2]-s[2]*l[1],g=s[1]*l[3]-s[3]*l[1],_=s[2]*l[3]-s[3]*l[2],y=i[0],v=i[1],w=i[2],C=i[3];return o[0]=v*_-w*g+C*p,o[1]=-y*_+w*m-C*u,o[2]=y*g-v*m+C*d,o[3]=-y*p+v*u-w*d,o},Di.lerp=function(o,i,s,l){var d=i[0],u=i[1],m=i[2],p=i[3];return o[0]=d+l*(s[0]-d),o[1]=u+l*(s[1]-u),o[2]=m+l*(s[2]-m),o[3]=p+l*(s[3]-p),o},Di.random=function(o,i){var s,l,d,u,m,p;i=i||1;do{m=(s=2*Fs.RANDOM()-1)*s+(l=2*Fs.RANDOM()-1)*l}while(m>=1);do{p=(d=2*Fs.RANDOM()-1)*d+(u=2*Fs.RANDOM()-1)*u}while(p>=1);var g=Math.sqrt((1-m)/p);return o[0]=i*s,o[1]=i*l,o[2]=i*d*g,o[3]=i*u*g,o},Di.transformMat4=function(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3];return o[0]=s[0]*l+s[4]*d+s[8]*u+s[12]*m,o[1]=s[1]*l+s[5]*d+s[9]*u+s[13]*m,o[2]=s[2]*l+s[6]*d+s[10]*u+s[14]*m,o[3]=s[3]*l+s[7]*d+s[11]*u+s[15]*m,o},Di.transformQuat=function(o,i,s){var l=i[0],d=i[1],u=i[2],m=s[0],p=s[1],g=s[2],_=s[3],y=_*l+p*u-g*d,v=_*d+g*l-m*u,w=_*u+m*d-p*l,C=-m*l-p*d-g*u;return o[0]=y*_+C*-m+v*-g-w*-p,o[1]=v*_+C*-p+w*-m-y*-g,o[2]=w*_+C*-g+y*-p-v*-m,o[3]=i[3],o},Di.zero=function(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=0,o},Di.str=function(o){return"vec4("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"},Di.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]},Di.equals=function(o,i){var s=o[0],l=o[1],d=o[2],u=o[3],m=i[0],p=i[1],g=i[2],_=i[3];return Math.abs(s-m)<=Fs.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(l-p)<=Fs.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(d-g)<=Fs.EPSILON*Math.max(1,Math.abs(d),Math.abs(g))&&Math.abs(u-_)<=Fs.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))},Di.forEach=Di.sqrLen=Di.len=Di.sqrDist=Di.dist=Di.div=Di.mul=Di.sub=void 0;var Fs=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==_k(o)&&"function"!=typeof o)return{default:o};var s=sP(void 0);if(s&&s.has(o))return s.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in o)if("default"!==u&&Object.prototype.hasOwnProperty.call(o,u)){var m=d?Object.getOwnPropertyDescriptor(o,u):null;m&&(m.get||m.set)?Object.defineProperty(l,u,m):l[u]=o[u]}return l.default=o,s&&s.set(o,l),l}(Mr);function sP(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,s=new WeakMap;return(sP=function(l){return l?s:i})(o)}function aP(){var o=new Fs.ARRAY_TYPE(4);return Fs.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0,o[3]=0),o}function lP(o,i,s){return o[0]=i[0]-s[0],o[1]=i[1]-s[1],o[2]=i[2]-s[2],o[3]=i[3]-s[3],o}function cP(o,i,s){return o[0]=i[0]*s[0],o[1]=i[1]*s[1],o[2]=i[2]*s[2],o[3]=i[3]*s[3],o}function dP(o,i,s){return o[0]=i[0]/s[0],o[1]=i[1]/s[1],o[2]=i[2]/s[2],o[3]=i[3]/s[3],o}function bk(o,i){return Math.hypot(i[0]-o[0],i[1]-o[1],i[2]-o[2],i[3]-o[3])}function Nf(o,i){var s=i[0]-o[0],l=i[1]-o[1],d=i[2]-o[2],u=i[3]-o[3];return s*s+l*l+d*d+u*u}function zf(o){return Math.hypot(o[0],o[1],o[2],o[3])}function hx(o){var i=o[0],s=o[1],l=o[2],d=o[3];return i*i+s*s+l*l+d*d}Di.sub=lP,Di.mul=cP,Di.div=dP,Di.dist=bk,Di.sqrDist=Nf,Di.len=zf,Di.sqrLen=hx;var yk=function(){var o=aP();return function(i,s,l,d,u,m){var p,g;for(s||(s=4),l||(l=0),g=d?Math.min(d*s+l,i.length):i.length,p=l;p<g;p+=s)o[0]=i[p],o[1]=i[p+1],o[2]=i[p+2],o[3]=i[p+3],u(o,o,m),i[p]=o[0],i[p+1]=o[1],i[p+2]=o[2],i[p+3]=o[3];return i}}();function Db(o){return(Db="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Di.forEach=yk,Object.defineProperty(ii,"__esModule",{value:!0}),ii.create=mx,ii.identity=function(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o},ii.setAxisAngle=xk,ii.getAxisAngle=function(o,i){var s=2*Math.acos(i[3]),l=Math.sin(s/2);return l>Ta.EPSILON?(o[0]=i[0]/l,o[1]=i[1]/l,o[2]=i[2]/l):(o[0]=1,o[1]=0,o[2]=0),s},ii.getAngle=function(o,i){var s=fx(o,i);return Math.acos(2*s*s-1)},ii.multiply=wk,ii.rotateX=function(o,i,s){s*=.5;var l=i[0],d=i[1],u=i[2],m=i[3],p=Math.sin(s),g=Math.cos(s);return o[0]=l*g+m*p,o[1]=d*g+u*p,o[2]=u*g-d*p,o[3]=m*g-l*p,o},ii.rotateY=function(o,i,s){s*=.5;var l=i[0],d=i[1],u=i[2],m=i[3],p=Math.sin(s),g=Math.cos(s);return o[0]=l*g-u*p,o[1]=d*g+m*p,o[2]=u*g+l*p,o[3]=m*g-d*p,o},ii.rotateZ=function(o,i,s){s*=.5;var l=i[0],d=i[1],u=i[2],m=i[3],p=Math.sin(s),g=Math.cos(s);return o[0]=l*g+d*p,o[1]=d*g-l*p,o[2]=u*g+m*p,o[3]=m*g-u*p,o},ii.calculateW=function(o,i){var s=i[0],l=i[1],d=i[2];return o[0]=s,o[1]=l,o[2]=d,o[3]=Math.sqrt(Math.abs(1-s*s-l*l-d*d)),o},ii.exp=px,ii.ln=kb,ii.pow=function(o,i,s){return kb(o,i),Mk(o,o,s),px(o,o),o},ii.slerp=Sb,ii.random=function(o){var i=Ta.RANDOM(),s=Ta.RANDOM(),l=Ta.RANDOM(),d=Math.sqrt(1-i),u=Math.sqrt(i);return o[0]=d*Math.sin(2*Math.PI*s),o[1]=d*Math.cos(2*Math.PI*s),o[2]=u*Math.sin(2*Math.PI*l),o[3]=u*Math.cos(2*Math.PI*l),o},ii.invert=function(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=s*s+l*l+d*d+u*u,p=m?1/m:0;return o[0]=-s*p,o[1]=-l*p,o[2]=-d*p,o[3]=u*p,o},ii.conjugate=function(o,i){return o[0]=-i[0],o[1]=-i[1],o[2]=-i[2],o[3]=i[3],o},ii.fromMat3=Ck,ii.fromEuler=function(o,i,s,l){var d=.5*Math.PI/180;i*=d,s*=d,l*=d;var u=Math.sin(i),m=Math.cos(i),p=Math.sin(s),g=Math.cos(s),_=Math.sin(l),y=Math.cos(l);return o[0]=u*g*y-m*p*_,o[1]=m*p*y+u*g*_,o[2]=m*g*_-u*p*y,o[3]=m*g*y+u*p*_,o},ii.str=function(o){return"quat("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"},ii.setAxes=ii.sqlerp=ii.rotationTo=ii.equals=ii.exactEquals=ii.normalize=ii.sqrLen=ii.squaredLength=ii.len=ii.length=ii.lerp=ii.dot=ii.scale=ii.mul=ii.add=ii.set=ii.copy=ii.fromValues=ii.clone=void 0;var Ta=ol(Mr),vk=ol(mn),$l=ol(ri),Wo=ol(Di);function Vf(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,s=new WeakMap;return(Vf=function(l){return l?s:i})(o)}function ol(o,i){if(!i&&o&&o.__esModule)return o;if(null===o||"object"!==Db(o)&&"function"!=typeof o)return{default:o};var s=Vf(i);if(s&&s.has(o))return s.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in o)if("default"!==u&&Object.prototype.hasOwnProperty.call(o,u)){var m=d?Object.getOwnPropertyDescriptor(o,u):null;m&&(m.get||m.set)?Object.defineProperty(l,u,m):l[u]=o[u]}return l.default=o,s&&s.set(o,l),l}function mx(){var o=new Ta.ARRAY_TYPE(4);return Ta.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function xk(o,i,s){s*=.5;var l=Math.sin(s);return o[0]=l*i[0],o[1]=l*i[1],o[2]=l*i[2],o[3]=Math.cos(s),o}function wk(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=s[0],g=s[1],_=s[2],y=s[3];return o[0]=l*y+m*p+d*_-u*g,o[1]=d*y+m*g+u*p-l*_,o[2]=u*y+m*_+l*g-d*p,o[3]=m*y-l*p-d*g-u*_,o}function px(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=Math.sqrt(s*s+l*l+d*d),p=Math.exp(u),g=m>0?p*Math.sin(m)/m:0;return o[0]=s*g,o[1]=l*g,o[2]=d*g,o[3]=p*Math.cos(m),o}function kb(o,i){var s=i[0],l=i[1],d=i[2],u=i[3],m=Math.sqrt(s*s+l*l+d*d),p=m>0?Math.atan2(m,u)/m:0;return o[0]=s*p,o[1]=l*p,o[2]=d*p,o[3]=.5*Math.log(s*s+l*l+d*d+u*u),o}function Sb(o,i,s,l){var d,u,m,p,g,_=i[0],y=i[1],v=i[2],w=i[3],C=s[0],D=s[1],k=s[2],S=s[3];return(u=_*C+y*D+v*k+w*S)<0&&(u=-u,C=-C,D=-D,k=-k,S=-S),1-u>Ta.EPSILON?(d=Math.acos(u),m=Math.sin(d),p=Math.sin((1-l)*d)/m,g=Math.sin(l*d)/m):(p=1-l,g=l),o[0]=p*_+g*C,o[1]=p*y+g*D,o[2]=p*v+g*k,o[3]=p*w+g*S,o}function Ck(o,i){var s,l=i[0]+i[4]+i[8];if(l>0)s=Math.sqrt(l+1),o[3]=.5*s,o[0]=(i[5]-i[7])*(s=.5/s),o[1]=(i[6]-i[2])*s,o[2]=(i[1]-i[3])*s;else{var d=0;i[4]>i[0]&&(d=1),i[8]>i[3*d+d]&&(d=2);var u=(d+1)%3,m=(d+2)%3;s=Math.sqrt(i[3*d+d]-i[3*u+u]-i[3*m+m]+1),o[d]=.5*s,o[3]=(i[3*u+m]-i[3*m+u])*(s=.5/s),o[u]=(i[3*u+d]+i[3*d+u])*s,o[m]=(i[3*m+d]+i[3*d+m])*s}return o}ii.clone=Wo.clone,ii.fromValues=Wo.fromValues,ii.copy=Wo.copy,ii.set=Wo.set,ii.add=Wo.add,ii.mul=wk;var Mk=Wo.scale;ii.scale=Mk;var fx=Wo.dot;ii.dot=fx,ii.lerp=Wo.lerp;var Dk=Wo.length;ii.length=Dk,ii.len=Dk;var kk=Wo.squaredLength;ii.squaredLength=kk,ii.sqrLen=kk;var qo=Wo.normalize;ii.normalize=qo,ii.exactEquals=Wo.exactEquals,ii.equals=Wo.equals;var la,gx,Tb,Yo=(la=$l.create(),gx=$l.fromValues(1,0,0),Tb=$l.fromValues(0,1,0),function(o,i,s){var l=$l.dot(i,s);return l<-.999999?($l.cross(la,gx,i),$l.len(la)<1e-6&&$l.cross(la,Tb,i),$l.normalize(la,la),xk(o,la,Math.PI),o):l>.999999?(o[0]=0,o[1]=0,o[2]=0,o[3]=1,o):($l.cross(la,i,s),o[0]=la[0],o[1]=la[1],o[2]=la[2],o[3]=1+l,qo(o,o))});ii.rotationTo=Yo;var Su,Eb,Sk=(Su=mx(),Eb=mx(),function(o,i,s,l,d,u){return Sb(Su,i,d,u),Sb(Eb,s,l,u),Sb(o,Su,Eb,2*u*(1-u)),o});ii.sqlerp=Sk;var sl,Tk=(sl=vk.create(),function(o,i,s,l){return sl[0]=s[0],sl[3]=s[1],sl[6]=s[2],sl[1]=l[0],sl[4]=l[1],sl[7]=l[2],sl[2]=-i[0],sl[5]=-i[1],sl[8]=-i[2],qo(o,Ck(o,sl))});ii.setAxes=Tk;var Ii={};function Ab(o){return(Ab="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.create=function(){var o=new hs.ARRAY_TYPE(8);return hs.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0,o[4]=0,o[5]=0,o[6]=0,o[7]=0),o[3]=1,o},Ii.clone=function(o){var i=new hs.ARRAY_TYPE(8);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i},Ii.fromValues=function(o,i,s,l,d,u,m,p){var g=new hs.ARRAY_TYPE(8);return g[0]=o,g[1]=i,g[2]=s,g[3]=l,g[4]=d,g[5]=u,g[6]=m,g[7]=p,g},Ii.fromRotationTranslationValues=function(o,i,s,l,d,u,m){var p=new hs.ARRAY_TYPE(8);p[0]=o,p[1]=i,p[2]=s,p[3]=l;var g=.5*d,_=.5*u,y=.5*m;return p[4]=g*l+_*s-y*i,p[5]=_*l+y*o-g*s,p[6]=y*l+g*i-_*o,p[7]=-g*o-_*i-y*s,p},Ii.fromRotationTranslation=Ib,Ii.fromTranslation=function(o,i){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o[4]=.5*i[0],o[5]=.5*i[1],o[6]=.5*i[2],o[7]=0,o},Ii.fromRotation=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[4]=0,o[5]=0,o[6]=0,o[7]=0,o},Ii.fromMat4=function(o,i){var s=Gl.create();Ek.getRotation(s,i);var l=new hs.ARRAY_TYPE(3);return Ek.getTranslation(l,i),Ib(o,s,l),o},Ii.copy=Ik,Ii.identity=function(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o[4]=0,o[5]=0,o[6]=0,o[7]=0,o},Ii.set=function(o,i,s,l,d,u,m,p,g){return o[0]=i,o[1]=s,o[2]=l,o[3]=d,o[4]=u,o[5]=m,o[6]=p,o[7]=g,o},Ii.getDual=function(o,i){return o[0]=i[4],o[1]=i[5],o[2]=i[6],o[3]=i[7],o},Ii.setDual=function(o,i){return o[4]=i[0],o[5]=i[1],o[6]=i[2],o[7]=i[3],o},Ii.getTranslation=function(o,i){var s=i[4],l=i[5],d=i[6],u=i[7],m=-i[0],p=-i[1],g=-i[2],_=i[3];return o[0]=2*(s*_+u*m+l*g-d*p),o[1]=2*(l*_+u*p+d*m-s*g),o[2]=2*(d*_+u*g+s*p-l*m),o},Ii.translate=function(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=.5*s[0],g=.5*s[1],_=.5*s[2],y=i[4],v=i[5],w=i[6],C=i[7];return o[0]=l,o[1]=d,o[2]=u,o[3]=m,o[4]=m*p+d*_-u*g+y,o[5]=m*g+u*p-l*_+v,o[6]=m*_+l*g-d*p+w,o[7]=-l*p-d*g-u*_+C,o},Ii.rotateX=function(o,i,s){var l=-i[0],d=-i[1],u=-i[2],m=i[3],p=i[4],g=i[5],_=i[6],y=i[7],v=p*m+y*l+g*u-_*d,w=g*m+y*d+_*l-p*u,C=_*m+y*u+p*d-g*l,D=y*m-p*l-g*d-_*u;return Gl.rotateX(o,i,s),o[4]=v*(m=o[3])+D*(l=o[0])+w*(u=o[2])-C*(d=o[1]),o[5]=w*m+D*d+C*l-v*u,o[6]=C*m+D*u+v*d-w*l,o[7]=D*m-v*l-w*d-C*u,o},Ii.rotateY=function(o,i,s){var l=-i[0],d=-i[1],u=-i[2],m=i[3],p=i[4],g=i[5],_=i[6],y=i[7],v=p*m+y*l+g*u-_*d,w=g*m+y*d+_*l-p*u,C=_*m+y*u+p*d-g*l,D=y*m-p*l-g*d-_*u;return Gl.rotateY(o,i,s),o[4]=v*(m=o[3])+D*(l=o[0])+w*(u=o[2])-C*(d=o[1]),o[5]=w*m+D*d+C*l-v*u,o[6]=C*m+D*u+v*d-w*l,o[7]=D*m-v*l-w*d-C*u,o},Ii.rotateZ=function(o,i,s){var l=-i[0],d=-i[1],u=-i[2],m=i[3],p=i[4],g=i[5],_=i[6],y=i[7],v=p*m+y*l+g*u-_*d,w=g*m+y*d+_*l-p*u,C=_*m+y*u+p*d-g*l,D=y*m-p*l-g*d-_*u;return Gl.rotateZ(o,i,s),o[4]=v*(m=o[3])+D*(l=o[0])+w*(u=o[2])-C*(d=o[1]),o[5]=w*m+D*d+C*l-v*u,o[6]=C*m+D*u+v*d-w*l,o[7]=D*m-v*l-w*d-C*u,o},Ii.rotateByQuatAppend=function(o,i,s){var l=s[0],d=s[1],u=s[2],m=s[3],p=i[0],g=i[1],_=i[2],y=i[3];return o[0]=p*m+y*l+g*u-_*d,o[1]=g*m+y*d+_*l-p*u,o[2]=_*m+y*u+p*d-g*l,o[3]=y*m-p*l-g*d-_*u,o[4]=(p=i[4])*m+(y=i[7])*l+(g=i[5])*u-(_=i[6])*d,o[5]=g*m+y*d+_*l-p*u,o[6]=_*m+y*u+p*d-g*l,o[7]=y*m-p*l-g*d-_*u,o},Ii.rotateByQuatPrepend=function(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=s[0],g=s[1],_=s[2],y=s[3];return o[0]=l*y+m*p+d*_-u*g,o[1]=d*y+m*g+u*p-l*_,o[2]=u*y+m*_+l*g-d*p,o[3]=m*y-l*p-d*g-u*_,o[4]=l*(y=s[7])+m*(p=s[4])+d*(_=s[6])-u*(g=s[5]),o[5]=d*y+m*g+u*p-l*_,o[6]=u*y+m*_+l*g-d*p,o[7]=m*y-l*p-d*g-u*_,o},Ii.rotateAroundAxis=function(o,i,s,l){if(Math.abs(l)<hs.EPSILON)return Ik(o,i);var d=Math.hypot(s[0],s[1],s[2]);l*=.5;var u=Math.sin(l),m=u*s[0]/d,p=u*s[1]/d,g=u*s[2]/d,_=Math.cos(l),y=i[0],v=i[1],w=i[2],C=i[3];o[0]=y*_+C*m+v*g-w*p,o[1]=v*_+C*p+w*m-y*g,o[2]=w*_+C*g+y*p-v*m,o[3]=C*_-y*m-v*p-w*g;var D=i[4],k=i[5],S=i[6],E=i[7];return o[4]=D*_+E*m+k*g-S*p,o[5]=k*_+E*p+S*m-D*g,o[6]=S*_+E*g+D*p-k*m,o[7]=E*_-D*m-k*p-S*g,o},Ii.add=function(o,i,s){return o[0]=i[0]+s[0],o[1]=i[1]+s[1],o[2]=i[2]+s[2],o[3]=i[3]+s[3],o[4]=i[4]+s[4],o[5]=i[5]+s[5],o[6]=i[6]+s[6],o[7]=i[7]+s[7],o},Ii.multiply=_m,Ii.scale=function(o,i,s){return o[0]=i[0]*s,o[1]=i[1]*s,o[2]=i[2]*s,o[3]=i[3]*s,o[4]=i[4]*s,o[5]=i[5]*s,o[6]=i[6]*s,o[7]=i[7]*s,o},Ii.lerp=function(o,i,s,l){var d=1-l;return Rk(i,s)<0&&(l=-l),o[0]=i[0]*d+s[0]*l,o[1]=i[1]*d+s[1]*l,o[2]=i[2]*d+s[2]*l,o[3]=i[3]*d+s[3]*l,o[4]=i[4]*d+s[4]*l,o[5]=i[5]*d+s[5]*l,o[6]=i[6]*d+s[6]*l,o[7]=i[7]*d+s[7]*l,o},Ii.invert=function(o,i){var s=Uf(i);return o[0]=-i[0]/s,o[1]=-i[1]/s,o[2]=-i[2]/s,o[3]=i[3]/s,o[4]=-i[4]/s,o[5]=-i[5]/s,o[6]=-i[6]/s,o[7]=i[7]/s,o},Ii.conjugate=function(o,i){return o[0]=-i[0],o[1]=-i[1],o[2]=-i[2],o[3]=i[3],o[4]=-i[4],o[5]=-i[5],o[6]=-i[6],o[7]=i[7],o},Ii.normalize=function(o,i){var s=Uf(i);if(s>0){s=Math.sqrt(s);var l=i[0]/s,d=i[1]/s,u=i[2]/s,m=i[3]/s,p=i[4],g=i[5],_=i[6],y=i[7],v=l*p+d*g+u*_+m*y;o[0]=l,o[1]=d,o[2]=u,o[3]=m,o[4]=(p-l*v)/s,o[5]=(g-d*v)/s,o[6]=(_-u*v)/s,o[7]=(y-m*v)/s}return o},Ii.str=function(o){return"quat2("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+", "+o[4]+", "+o[5]+", "+o[6]+", "+o[7]+")"},Ii.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]&&o[4]===i[4]&&o[5]===i[5]&&o[6]===i[6]&&o[7]===i[7]},Ii.equals=function(o,i){var s=o[0],l=o[1],d=o[2],u=o[3],m=o[4],p=o[5],g=o[6],_=o[7],y=i[0],v=i[1],w=i[2],C=i[3],D=i[4],k=i[5],S=i[6],E=i[7];return Math.abs(s-y)<=hs.EPSILON*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(l-v)<=hs.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(d-w)<=hs.EPSILON*Math.max(1,Math.abs(d),Math.abs(w))&&Math.abs(u-C)<=hs.EPSILON*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(m-D)<=hs.EPSILON*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(p-k)<=hs.EPSILON*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(g-S)<=hs.EPSILON*Math.max(1,Math.abs(g),Math.abs(S))&&Math.abs(_-E)<=hs.EPSILON*Math.max(1,Math.abs(_),Math.abs(E))},Ii.sqrLen=Ii.squaredLength=Ii.len=Ii.length=Ii.dot=Ii.mul=Ii.setReal=Ii.getReal=void 0;var hs=jf(Mr),Gl=jf(ii),Ek=jf(li);function Ak(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,s=new WeakMap;return(Ak=function(l){return l?s:i})(o)}function jf(o,i){if(!i&&o&&o.__esModule)return o;if(null===o||"object"!==Ab(o)&&"function"!=typeof o)return{default:o};var s=Ak(i);if(s&&s.has(o))return s.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in o)if("default"!==u&&Object.prototype.hasOwnProperty.call(o,u)){var m=d?Object.getOwnPropertyDescriptor(o,u):null;m&&(m.get||m.set)?Object.defineProperty(l,u,m):l[u]=o[u]}return l.default=o,s&&s.set(o,l),l}function Ib(o,i,s){var l=.5*s[0],d=.5*s[1],u=.5*s[2],m=i[0],p=i[1],g=i[2],_=i[3];return o[0]=m,o[1]=p,o[2]=g,o[3]=_,o[4]=l*_+d*g-u*p,o[5]=d*_+u*m-l*g,o[6]=u*_+l*p-d*m,o[7]=-l*m-d*p-u*g,o}function Ik(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[4]=i[4],o[5]=i[5],o[6]=i[6],o[7]=i[7],o}function _m(o,i,s){var l=i[0],d=i[1],u=i[2],m=i[3],p=s[4],g=s[5],_=s[6],y=s[7],v=i[4],w=i[5],C=i[6],D=i[7],k=s[0],S=s[1],E=s[2],A=s[3];return o[0]=l*A+m*k+d*E-u*S,o[1]=d*A+m*S+u*k-l*E,o[2]=u*A+m*E+l*S-d*k,o[3]=m*A-l*k-d*S-u*E,o[4]=l*y+m*p+d*_-u*g+v*A+D*k+w*E-C*S,o[5]=d*y+m*g+u*p-l*_+w*A+D*S+C*k-v*E,o[6]=u*y+m*_+l*g-d*p+C*A+D*E+v*S-w*k,o[7]=m*y-l*p-d*g-u*_+D*A-v*k-w*S-C*E,o}Ii.getReal=Gl.copy,Ii.setReal=Gl.copy,Ii.mul=_m;var Rk=Gl.dot;Ii.dot=Rk;var Pk=Gl.length;Ii.length=Pk,Ii.len=Pk;var Uf=Gl.squaredLength;Ii.squaredLength=Uf,Ii.sqrLen=Uf;var ui={};function Rb(o){return(Rb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(ui,"__esModule",{value:!0}),ui.create=_x,ui.clone=function(o){var i=new Ea.ARRAY_TYPE(2);return i[0]=o[0],i[1]=o[1],i},ui.fromValues=function(o,i){var s=new Ea.ARRAY_TYPE(2);return s[0]=o,s[1]=i,s},ui.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o},ui.set=function(o,i,s){return o[0]=i,o[1]=s,o},ui.add=function(o,i,s){return o[0]=i[0]+s[0],o[1]=i[1]+s[1],o},ui.subtract=Pb,ui.multiply=$f,ui.divide=Ok,ui.ceil=function(o,i){return o[0]=Math.ceil(i[0]),o[1]=Math.ceil(i[1]),o},ui.floor=function(o,i){return o[0]=Math.floor(i[0]),o[1]=Math.floor(i[1]),o},ui.min=function(o,i,s){return o[0]=Math.min(i[0],s[0]),o[1]=Math.min(i[1],s[1]),o},ui.max=function(o,i,s){return o[0]=Math.max(i[0],s[0]),o[1]=Math.max(i[1],s[1]),o},ui.round=function(o,i){return o[0]=Math.round(i[0]),o[1]=Math.round(i[1]),o},ui.scale=function(o,i,s){return o[0]=i[0]*s,o[1]=i[1]*s,o},ui.scaleAndAdd=function(o,i,s,l){return o[0]=i[0]+s[0]*l,o[1]=i[1]+s[1]*l,o},ui.distance=Fk,ui.squaredDistance=Lk,ui.length=Bk,ui.squaredLength=Nk,ui.negate=function(o,i){return o[0]=-i[0],o[1]=-i[1],o},ui.inverse=function(o,i){return o[0]=1/i[0],o[1]=1/i[1],o},ui.normalize=function(o,i){var s=i[0],l=i[1],d=s*s+l*l;return d>0&&(d=1/Math.sqrt(d)),o[0]=i[0]*d,o[1]=i[1]*d,o},ui.dot=function(o,i){return o[0]*i[0]+o[1]*i[1]},ui.cross=function(o,i,s){var l=i[0]*s[1]-i[1]*s[0];return o[0]=o[1]=0,o[2]=l,o},ui.lerp=function(o,i,s,l){var d=i[0],u=i[1];return o[0]=d+l*(s[0]-d),o[1]=u+l*(s[1]-u),o},ui.random=function(o,i){i=i||1;var s=2*Ea.RANDOM()*Math.PI;return o[0]=Math.cos(s)*i,o[1]=Math.sin(s)*i,o},ui.transformMat2=function(o,i,s){var l=i[0],d=i[1];return o[0]=s[0]*l+s[2]*d,o[1]=s[1]*l+s[3]*d,o},ui.transformMat2d=function(o,i,s){var l=i[0],d=i[1];return o[0]=s[0]*l+s[2]*d+s[4],o[1]=s[1]*l+s[3]*d+s[5],o},ui.transformMat3=function(o,i,s){var l=i[0],d=i[1];return o[0]=s[0]*l+s[3]*d+s[6],o[1]=s[1]*l+s[4]*d+s[7],o},ui.transformMat4=function(o,i,s){var l=i[0],d=i[1];return o[0]=s[0]*l+s[4]*d+s[12],o[1]=s[1]*l+s[5]*d+s[13],o},ui.rotate=function(o,i,s,l){var d=i[0]-s[0],u=i[1]-s[1],m=Math.sin(l),p=Math.cos(l);return o[0]=d*p-u*m+s[0],o[1]=d*m+u*p+s[1],o},ui.angle=function(o,i){var s=o[0],l=o[1],d=i[0],u=i[1],m=Math.sqrt(s*s+l*l)*Math.sqrt(d*d+u*u);return Math.acos(Math.min(Math.max(m&&(s*d+l*u)/m,-1),1))},ui.zero=function(o){return o[0]=0,o[1]=0,o},ui.str=function(o){return"vec2("+o[0]+", "+o[1]+")"},ui.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]},ui.equals=function(o,i){var s=o[0],l=o[1],d=i[0],u=i[1];return Math.abs(s-d)<=Ea.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(l-u)<=Ea.EPSILON*Math.max(1,Math.abs(l),Math.abs(u))},ui.forEach=ui.sqrLen=ui.sqrDist=ui.dist=ui.div=ui.mul=ui.sub=ui.len=void 0;var Ea=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==Rb(o)&&"function"!=typeof o)return{default:o};var s=Hf(void 0);if(s&&s.has(o))return s.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in o)if("default"!==u&&Object.prototype.hasOwnProperty.call(o,u)){var m=d?Object.getOwnPropertyDescriptor(o,u):null;m&&(m.get||m.set)?Object.defineProperty(l,u,m):l[u]=o[u]}return l.default=o,s&&s.set(o,l),l}(Mr);function Hf(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,s=new WeakMap;return(Hf=function(l){return l?s:i})(o)}function _x(){var o=new Ea.ARRAY_TYPE(2);return Ea.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0),o}function Pb(o,i,s){return o[0]=i[0]-s[0],o[1]=i[1]-s[1],o}function $f(o,i,s){return o[0]=i[0]*s[0],o[1]=i[1]*s[1],o}function Ok(o,i,s){return o[0]=i[0]/s[0],o[1]=i[1]/s[1],o}function Fk(o,i){return Math.hypot(i[0]-o[0],i[1]-o[1])}function Lk(o,i){var s=i[0]-o[0],l=i[1]-o[1];return s*s+l*l}function Bk(o){return Math.hypot(o[0],o[1])}function Nk(o){var i=o[0],s=o[1];return i*i+s*s}ui.len=Bk,ui.sub=Pb,ui.mul=$f,ui.div=Ok,ui.dist=Fk,ui.sqrDist=Lk,ui.sqrLen=Nk;var uP=function(){var o=_x();return function(i,s,l,d,u,m){var p,g;for(s||(s=2),l||(l=0),g=d?Math.min(d*s+l,i.length):i.length,p=l;p<g;p+=s)o[0]=i[p],o[1]=i[p+1],u(o,o,m),i[p]=o[0],i[p+1]=o[1];return i}}();function Ob(o){return(Ob="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}ui.forEach=uP,Object.defineProperty(Wr,"__esModule",{value:!0});var Qi=Wr.vec4=Z=Wr.vec3=Wr.vec2=Wr.quat2=_o=Wr.quat=at=Wr.mat4=Zo=Wr.mat3=Wr.mat2d=bm=Wr.mat2=Wr.glMatrix=void 0,bx=Aa(Mr);Wr.glMatrix=bx;var yx=Aa(Wn),bm=Wr.mat2=yx,hP=Aa(qn);Wr.mat2d=hP;var vx=Aa(mn),Zo=Wr.mat3=vx,Tu=Aa(li),at=Wr.mat4=Tu,zk=Aa(ii),_o=Wr.quat=zk,U3=Aa(Ii);Wr.quat2=U3;var Fb=Aa(ui);Wr.vec2=Fb;var mP=Aa(ri),Z=Wr.vec3=mP,Vk=Aa(Di);function xx(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,s=new WeakMap;return(xx=function(l){return l?s:i})(o)}function Aa(o,i){if(!i&&o&&o.__esModule)return o;if(null===o||"object"!==Ob(o)&&"function"!=typeof o)return{default:o};var s=xx(i);if(s&&s.has(o))return s.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in o)if("default"!==u&&Object.prototype.hasOwnProperty.call(o,u)){var m=d?Object.getOwnPropertyDescriptor(o,u):null;m&&(m.get||m.set)?Object.defineProperty(l,u,m):l[u]=o[u]}return l.default=o,s&&s.set(o,l),l}Qi=Wr.vec4=Vk;const jk=Xe([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Eu}=jk,ym=Xe([{name:"a_pos_3",components:3,type:"Int16"}]);var Ac=Xe([{name:"a_pos",type:"Int16",components:2}]),Lb={};!function(s){function l(u,m,p){var g=d(256*u,256*(m=Math.pow(2,p)-m-1),p),_=d(256*(u+1),256*(m+1),p);return g[0]+","+g[1]+","+_[0]+","+_[1]}function d(u,m,p){var g=2*Math.PI*6378137/256/Math.pow(2,p);return[u*g-2*Math.PI*6378137/2,m*g-2*Math.PI*6378137/2]}s.getURL=function(u,m,p,g,_,y){return y=y||{},u+"?"+["bbox="+l(p,g,_),"format="+(y.format||"image/png"),"service="+(y.service||"WMS"),"version="+(y.version||"1.1.1"),"request="+(y.request||"GetMap"),"srs="+(y.srs||"EPSG:3857"),"width="+(y.width||256),"height="+(y.height||256),"layers="+m].join("&")},s.getTileBBox=l,s.getMercCoords=d,Object.defineProperty(s,"__esModule",{value:!0})}(Lb);var Bb=Lb;class ca{constructor(i,s,l){this.z=i,this.x=s,this.y=l,this.key=Wf(0,i,i,s,l)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,s){const l=Bb.getTileBBox(this.x,this.y,this.z),d=function(u,m,p){let g,_="";for(let y=u;y>0;y--)g=1<<y-1,_+=(m&g?1:0)+(p&g?2:0);return _}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===s?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",d).replace("{bbox-epsg-3857}",l)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Gf{constructor(i,s){this.wrap=i,this.canonical=s,this.key=Wf(i,s.z,s.z,s.x,s.y)}}class Ri{constructor(i,s,l,d,u){this.overscaledZ=i,this.wrap=s,this.canonical=new ca(l,+d,+u),this.key=0===s&&i===l?this.canonical.key:Wf(s,i,l,d,u)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const s=this.canonical.z-i;return i>this.canonical.z?new Ri(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ri(i,this.wrap,i,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(i,s=!0){if(this.overscaledZ===i&&s)return this.key;if(i>this.canonical.z)return Wf(this.wrap*+s,i,this.canonical.z,this.canonical.x,this.canonical.y);{const l=this.canonical.z-i;return Wf(this.wrap*+s,i,i,this.canonical.x>>l,this.canonical.y>>l)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const s=this.canonical.z-i.canonical.z;return 0===i.overscaledZ||i.overscaledZ<this.overscaledZ&&i.canonical.z<this.canonical.z&&i.canonical.x===this.canonical.x>>s&&i.canonical.y===this.canonical.y>>s}children(i){if(this.overscaledZ>=i)return[new Ri(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,l=2*this.canonical.x,d=2*this.canonical.y;return[new Ri(s,this.wrap,s,l,d),new Ri(s,this.wrap,s,l+1,d),new Ri(s,this.wrap,s,l,d+1),new Ri(s,this.wrap,s,l+1,d+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Ri(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Ri(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Gf(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Wf(o,i,s,l,d){const u=1<<Math.min(s,22);let m=u*(d%u)+l%u;return o&&s<22&&(m+=u*u*((o<0?-2*o-1:2*o)%(1<<2*(22-s)))),16*(32*m+s)+(i-s)}const wx=[o=>{let i=o.canonical.x-1,s=o.wrap;return i<0&&(i=(1<<o.canonical.z)-1,s--),new Ri(o.overscaledZ,s,o.canonical.z,i,o.canonical.y)},o=>{let i=o.canonical.x+1,s=o.wrap;return i===1<<o.canonical.z&&(i=0,s++),new Ri(o.overscaledZ,s,o.canonical.z,i,o.canonical.y)},o=>new Ri(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,(0===o.canonical.y?1<<o.canonical.z:o.canonical.y)-1),o=>new Ri(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y===(1<<o.canonical.z)-1?0:o.canonical.y+1)];de(ca,"CanonicalTileID"),de(Ri,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});class Nb{constructor(i,s){this.pos=i,this.dir=s}intersectsPlane(i,s,l){const d=Z.dot(s,this.dir);if(Math.abs(d)<1e-6)return!1;const u=((i[0]-this.pos[0])*s[0]+(i[1]-this.pos[1])*s[1]+(i[2]-this.pos[2])*s[2])/d;return l[0]=this.pos[0]+this.dir[0]*u,l[1]=this.pos[1]+this.dir[1]*u,l[2]=this.pos[2]+this.dir[2]*u,!0}closestPointOnSphere(i,s,l){if(Z.equals(this.pos,i)||0===s)return l[0]=l[1]=l[2]=0,!1;const[d,u,m]=this.dir,p=this.pos[0]-i[0],g=this.pos[1]-i[1],_=this.pos[2]-i[2],y=d*d+u*u+m*m,v=2*(p*d+g*u+_*m),w=v*v-4*y*(p*p+g*g+_*_-s*s);if(w<0){const C=Math.max(-v/2,0),D=p+d*C,k=g+u*C,S=_+m*C,E=Math.hypot(D,k,S);return l[0]=D*s/E,l[1]=k*s/E,l[2]=S*s/E,!1}{const C=(-v-Math.sqrt(w))/(2*y);if(C<0){const D=Math.hypot(p,g,_);return l[0]=p*s/D,l[1]=g*s/D,l[2]=_*s/D,!1}return l[0]=p+d*C,l[1]=g+u*C,l[2]=_+m*C,!0}}}class Cx{constructor(i,s,l,d,u){this.TL=i,this.TR=s,this.BR=l,this.BL=d,this.horizon=u}static fromInvProjectionMatrix(i,s,l){const d=[-1,1,1],u=[1,1,1],m=[1,-1,1],p=[-1,-1,1],g=Z.transformMat4(d,d,i),_=Z.transformMat4(u,u,i),y=Z.transformMat4(m,m,i),v=Z.transformMat4(p,p,i);return new Cx(g,_,y,v,s/l)}}function qf(o,i,s){let l=1/0,d=-1/0;const u=[];for(const m of o){Z.sub(u,m,i);const p=Z.dot(u,s);l=Math.min(l,p),d=Math.max(d,p)}return[l,d]}function Mx(o,i){let s=!0;for(let l=0;l<o.planes.length;l++){const d=o.planes[l];let u=0;for(let m=0;m<i.length;m++)u+=Z.dot(d,i[m])+d[3]>=0;if(0===u)return 0;u!==i.length&&(s=!1)}return s?2:1}function Dx(o,i){for(const s of o.projections){const l=qf(i,o.points[0],s.axis);if(s.projection[1]<l[0]||s.projection[0]>l[1])return 0}return 1}function Yf(o,i){let s=0;const l=[0,0,0,0];for(let d=0;d<o.length;d++)l[0]=o[d][0],l[1]=o[d][1],l[2]=o[d][2],l[3]=1,Qi.dot(l,i)>=0&&s++;return s}class al{constructor(i,s){this.points=i||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=gn.fromPoints(this.points),this.projections=[],this.frustumEdges=[Z.sub([],this.points[2],this.points[3]),Z.sub([],this.points[0],this.points[3]),Z.sub([],this.points[4],this.points[0]),Z.sub([],this.points[5],this.points[1]),Z.sub([],this.points[6],this.points[2]),Z.sub([],this.points[7],this.points[3])];for(const l of this.frustumEdges){const d=[0,-l[2],l[1]],u=[l[2],0,-l[0]];this.projections.push({axis:d,projection:qf(this.points,this.points[0],d)}),this.projections.push({axis:u,projection:qf(this.points,this.points[0],u)})}}static fromInvProjectionMatrix(i,s,l,d){const u=Math.pow(2,l),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(_=>{const y=Qi.transformMat4([],_,i),v=1/y[3]/s*u;return Qi.mul(y,y,[v,v,d?1/y[3]:v,v])}),p=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(_=>{const y=Z.sub([],m[_[0]],m[_[1]]),v=Z.sub([],m[_[2]],m[_[1]]),w=Z.normalize([],Z.cross([],y,v)),C=-Z.dot(w,m[_[1]]);return w.concat(C)}),g=[];for(let _=0;_<m.length;_++)g.push([m[_][0],m[_][1],m[_][2]]);return new al(g,p)}intersectsPrecise(i,s,l){for(let d=0;d<s.length;d++)if(!Yf(i,s[d]))return 0;for(let d=0;d<this.planes.length;d++)if(!Yf(i,this.planes[d]))return 0;for(const d of l)for(const u of this.frustumEdges){const m=Z.cross([],d,u),p=Z.length(m);if(0===p)continue;Z.scale(m,m,1/p);const g=qf(this.points,this.points[0],m),_=qf(i,this.points[0],m);if(g[0]>_[1]||_[0]>g[1])return 0}return 1}}class gn{static fromPoints(i){const s=[1/0,1/0,1/0],l=[-1/0,-1/0,-1/0];for(const d of i)Z.min(s,s,d),Z.max(l,l,d);return new gn(s,l)}static fromTileIdAndHeight(i,s,l){const d=1<<i.canonical.z,u=i.canonical.x,m=i.canonical.y;return new gn([u/d,m/d,s],[(u+1)/d,(m+1)/d,l])}static applyTransform(i,s){const l=i.getCorners();for(let d=0;d<l.length;++d)Z.transformMat4(l[d],l[d],s);return gn.fromPoints(l)}static projectAabbCorners(i,s){const l=i.getCorners();for(let d=0;d<l.length;++d)Z.transformMat4(l[d],l[d],s);return l}constructor(i,s){this.min=i,this.max=s,this.center=Z.scale([],Z.add([],this.min,this.max),.5)}quadrant(i){const s=[i%2==0,i<2],l=Z.clone(this.min),d=Z.clone(this.max);for(let u=0;u<s.length;u++)l[u]=s[u]?this.min[u]:this.center[u],d[u]=s[u]?this.center[u]:this.max[u];return d[2]=this.max[2],new gn(l,d)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,s=this.max;return[[i[0],i[1],i[2]],[s[0],i[1],i[2]],[s[0],s[1],i[2]],[i[0],s[1],i[2]],[i[0],i[1],s[2]],[s[0],i[1],s[2]],[s[0],s[1],s[2]],[i[0],s[1],s[2]]]}intersects(i){return this.intersectsAabb(i.bounds)?Mx(i,this.getCorners()):0}intersectsFlat(i){return this.intersectsAabb(i.bounds)?Mx(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(i,s){return s||this.intersects(i)?Dx(i,this.getCorners()):0}intersectsPreciseFlat(i,s){return s||this.intersectsFlat(i)?Dx(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(i){for(let s=0;s<3;++s)if(this.min[s]>i.max[s]||i.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(i){return!(this.min[0]>i.max[0]||i.min[0]>this.max[0]||this.min[1]>i.max[1]||i.min[1]>this.max[1])}encapsulate(i){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],i.min[s]),this.max[s]=Math.max(this.max[s],i.max[s])}encapsulatePoint(i){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],i[s]),this.max[s]=Math.max(this.max[s],i[s])}closestPoint(i){return[Math.max(Math.min(this.max[0],i[0]),this.min[0]),Math.max(Math.min(this.max[1],i[1]),this.min[1]),Math.max(Math.min(this.max[2],i[2]),this.min[2])]}}de(gn,"Aabb");const Zf=5,Md=6,ms=pt/Math.PI/2,pP=16383,kx=[64,32,16],jo=-ms,ps=ms,Sx=[new gn([jo,jo,jo],[ps,ps,ps]),new gn([jo,jo,jo],[0,0,ps]),new gn([0,jo,jo],[ps,0,ps]),new gn([jo,0,jo],[0,ps,ps]),new gn([0,0,jo],[ps,ps,ps])];function Xf(o){return o*ms/Qf}function Tx(o,i,s,l=!0){const d=Z.scale([],o._camera.position,o.worldSize),u=[i,s,1,1];Qi.transformMat4(u,u,o.pixelMatrixInverse),Qi.scale(u,u,1/u[3]);const m=Z.sub([],u,d),p=Z.normalize([],m),g=o.globeMatrix,_=[g[12],g[13],g[14]],y=Z.sub([],_,d),v=Z.length(y),w=Z.normalize([],y),C=o.worldSize/(2*Math.PI),D=Z.dot(w,p),k=Math.asin(C/v);if(k<Math.acos(D)){if(!l)return null;const W=[],q=[];Z.scale(W,p,v/D),Z.normalize(q,Z.sub(q,W,y)),Z.normalize(p,Z.add(p,y,Z.scale(p,q,Math.tan(k)*v)))}const S=[];new Nb(d,p).closestPointOnSphere(_,C,S);const E=Z.normalize([],tr(g,0)),A=Z.normalize([],tr(g,1)),P=Z.normalize([],tr(g,2)),O=Z.dot(E,S),R=Z.dot(A,S),F=Z.dot(P,S),B=jr(Math.asin(-R/C));let j=jr(Math.atan2(O,F));j=o.center.lng+function(W,q){const X=(q-W+180)%360-180;return X<-180?X+360:X}(o.center.lng,j);const U=dr(j),H=he(Rr(B),0,1);return new Ei(U,H)}class Uk{constructor(i,s,l){this.a=Z.sub([],i,l),this.b=Z.sub([],s,l),this.center=l;const d=Z.normalize([],this.a),u=Z.normalize([],this.b);this.angle=Math.acos(Z.dot(d,u))}}function Ic(o,i){if(0===o.angle)return null;let s;return s=0===o.a[i]?1/o.angle*.5*Math.PI:1/o.angle*Math.atan(o.b[i]/o.a[i]/Math.sin(o.angle)-1/Math.tan(o.angle)),s<0||s>1?null:function(l,d,u,m){const p=Math.sin(u);return l*(Math.sin((1-m)*u)/p)+d*(Math.sin(m*u)/p)}(o.a[i],o.b[i],o.angle,he(s,0,1))+o.center[i]}function da(o){if(o.z<=1)return Sx[o.z+2*o.y+o.x];const i=Ia(Xo(o));return gn.fromPoints(i)}function Rc(o,i,s){return Z.scale(o,o,1-s),Z.scaleAndAdd(o,o,i,s)}function Hk(o,i){const s=Dr(i.zoom);if(0===s)return da(o);const l=Xo(o),d=Ia(l),u=dr(l.getWest())*i.worldSize,m=dr(l.getEast())*i.worldSize,p=Rr(l.getNorth())*i.worldSize,g=Rr(l.getSouth())*i.worldSize,_=[u,p,0],y=[m,p,0],v=[u,g,0],w=[m,g,0],C=at.invert([],i.globeMatrix);return Z.transformMat4(_,_,C),Z.transformMat4(y,y,C),Z.transformMat4(v,v,C),Z.transformMat4(w,w,C),d[0]=Rc(d[0],v,s),d[1]=Rc(d[1],w,s),d[2]=Rc(d[2],y,s),d[3]=Rc(d[3],_,s),gn.fromPoints(d)}function $k(o,i,s){for(const l of o)Z.transformMat4(l,l,i),Z.scale(l,l,s)}function Ex(o,i,s,l){const d=i/o.worldSize,u=o.globeMatrix;if(s.z<=1){const U=da(s).getCorners();return $k(U,u,d),gn.fromPoints(U)}const m=Xo(s,l),p=Ia(m);$k(p,u,d);const g=Number.MAX_VALUE,_=[-g,-g,-g],y=[g,g,g];if(m.contains(o.center)){for(const W of p)Z.min(y,y,W),Z.max(_,_,W);_[2]=0;const U=o.point,H=[U.x*d,U.y*d,0];return Z.min(y,y,H),Z.max(_,_,H),new gn(y,_)}const v=[u[12]*d,u[13]*d,u[14]*d],w=m.getCenter(),C=he(o.center.lat,-or,or),D=he(w.lat,-or,or),k=dr(o.center.lng),S=Rr(C);let E=k-dr(w.lng);const A=S-Rr(D);E>.5?E-=1:E<-.5&&(E+=1);let P=0;if(Math.abs(E)>Math.abs(A))P=E>=0?1:3;else{P=A>=0?0:2;const U=[u[4]*d,u[5]*d,u[6]*d],H=-Math.sin(ni(A>=0?m.getSouth():m.getNorth()))*ms;Z.scaleAndAdd(v,v,U,H)}const O=p[P],R=p[(P+1)%4],F=new Uk(O,R,v),B=[Ic(F,0)||O[0],Ic(F,1)||O[1],Ic(F,2)||O[2]],j=Dr(o.zoom);if(j>0){const U=function({x:W,y:q,z:X},G,Q,it,st){const J=1/(1<<X);let et=W*J,dt=et+J,mt=q*J,ut=mt+J,bt=0;const yt=(et+dt)/2-it;return yt>.5?bt=-1:yt<-.5&&(bt=1),et=((et+bt)*G-(it*=G))*Q+it,dt=((dt+bt)*G-it)*Q+it,mt=(mt*G-(st*=G))*Q+st,ut=(ut*G-st)*Q+st,[[et,ut,0],[dt,ut,0],[dt,mt,0],[et,mt,0]]}(s,i,o._pixelsPerMercatorPixel,k,S);for(let W=0;W<p.length;W++)Rc(p[W],U[W],j);const H=Z.add([],U[P],U[(P+1)%4]);Z.scale(H,H,.5),Rc(B,H,j)}for(const U of p)Z.min(y,y,U),Z.max(_,_,U);return y[2]=Math.min(O[2],R[2]),Z.min(y,y,B),Z.max(_,_,B),new gn(y,_)}function Xo({x:o,y:i,z:s},l=!1){const d=1/(1<<s),u=new qe(Ls(o*d),i===(1<<s)-1&&l?-90:an((i+1)*d)),m=new qe(Ls((o+1)*d),0===i&&l?90:an(i*d));return new go(u,m)}function Ia(o){const i=ni(o.getNorth()),s=ni(o.getSouth()),l=Math.cos(i),d=Math.cos(s),u=Math.sin(i),m=Math.sin(s),p=o.getWest(),g=o.getEast();return[vm(d,m,p),vm(d,m,g),vm(l,u,g),vm(l,u,p)]}function vm(o,i,s,l=ms){return s=ni(s),[o*Math.sin(s)*l,-i*l,o*Math.cos(s)*l]}function fs(o,i,s){return vm(Math.cos(ni(o)),Math.sin(ni(o)),i,s)}function Kf(o,i,s,l){const d=1<<s.z,u=(o/pt+s.x)/d;return fs(an((i/pt+s.y)/d),Ls(u),l)}function zb({min:o,max:i}){return pP/Math.max(i[0]-o[0],i[1]-o[1],i[2]-o[2])}const Gk=new Float64Array(16);function kd(o){const i=zb(o),s=at.fromScaling(Gk,[i,i,i]);return at.translate(s,s,Z.negate([],o.min))}function Vb(o){const i=at.fromTranslation(Gk,o.min),s=1/zb(o);return at.scale(i,i,[s,s,s])}function Ax(o){const i=pt/(2*Math.PI);return o/(2*Math.PI)/i}function Wk(o,i){return pt/(512*Math.pow(2,o))*zb(da(i))}function qk(o,i,s,l,d){const u=Ax(s),m=[o,i,-s/(2*Math.PI)],p=at.identity(new Float64Array(16));return at.translate(p,p,m),at.scale(p,p,[u,u,u]),at.rotateX(p,p,ni(-d)),at.rotateY(p,p,ni(-l)),p}function Yk(o){const i=o.pixelsPerMeter,s=i/sn(1,o.center.lat),l=at.identity(new Float64Array(16));return at.translate(l,l,[o.point.x,o.point.y,0]),at.scale(l,l,[s,s,i]),Float32Array.from(l)}function Dr(o){return Il(Zf,Md,o)}function Wl(o,i,s){const l=at.identity(new Float64Array(16)),d=(i/(1<<o)-.5)*Math.PI*2;return at.rotateY(l,s.globeMatrix,d),Float32Array.from(l)}function xm(o,i,s){const l=Dr(s.zoom),d=o.style.map._antialias,u=i.options.extStandardDerivativesForceOff||o.terrain&&o.terrain.exaggeration()>0;return 0===l&&!d&&!u}function Ix(o,i,s,l){const d=i.getNorth(),u=i.getSouth(),m=i.getWest(),p=i.getEast(),g=1<<o.z,_=p-m,y=d-u,v=_/64,w=-y/kx[s],C=[0,v,0,w,0,0,d,m,0];if(o.z>0){const D=180/l;Zo.multiply(C,C,[D/_+1,0,0,0,D/y+1,0,-.5*D/v,.5*D/w,1])}return C[2]=g,C[5]=o.x,C[8]=o.y,C}function Zk(o){const i=or-5;o=he(o,-i,i)/i*90;const s=Math.pow(Math.abs(Math.sin(ni(o))),3);return Math.round(s*(kx.length-1))}function Rx(o){const i=[0,0,0],s=at.identity(new Float64Array(16));return at.multiply(s,o.pixelMatrix,o.globeMatrix),Z.transformMat4(i,i,s),new ot(i[0],i[1])}function fP(o,i){const s=fs(i.lat,i.lng),l=function(u){const m=fs(u._center.lat,u._center.lng),p=Z.fromValues(0,1,0);let g=Z.cross([],p,m);const _=at.fromRotation([],-u.angle,m);g=Z.transformMat4(g,g,_),at.fromRotation(_,-u._pitch,g);const y=Z.normalize([],m);return Z.scale(y,y,Xf(u.cameraToCenterDistance/u.pixelsPerMeter)),Z.transformMat4(y,y,_),Z.add([],m,y)}(o),d=Z.subtract([],l,s);return Z.angle(d,s)}function Px(o,i){return fP(o,i)>Math.PI/2*1.01}const gP=ni(85),Ox=Math.cos(gP),Fx=Math.sin(gP);class H3{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.withSkirts.destroy(),i.withoutSkirts.destroy()}_fillGridMeshWithLods(i,s){const l=new Os,d=new Cr,u=[],m=i+1+2,p=s[0]+1,g=s[0]+1+(1+s.length),_=(y,v,w)=>{let C=y===m-1?y-2:0===y?y:y-1;return C+=w?24575:0,[C,v]};for(let y=0;y<m;++y)l.emplaceBack(..._(y,0,!0));for(let y=0;y<p;++y)for(let v=0;v<m;++v)l.emplaceBack(..._(v,y,(0===v||v===m-1)&&!0));for(let y=0;y<s.length;++y){const v=s[y];for(let w=0;w<m;++w)l.emplaceBack(..._(w,v,!0))}for(let y=0;y<s.length;++y){const v=d.length,w=s[y]+1+2,C=new Cr;for(let S=0;S<w-1;S++){const E=S===w-2,A=E?m*(g-s.length+y-S):m;for(let P=0;P<m-1;P++){const O=S*m+P;0===S||E||0===P||P===m-2?(C.emplaceBack(O+1,O,O+A),C.emplaceBack(O+A,O+A+1,O+1)):(d.emplaceBack(O+1,O,O+A),d.emplaceBack(O+A,O+A+1,O+1))}}const D=on.simpleSegment(0,v,l.length,d.length-v);for(let S=0;S<C.uint16.length;S+=3)d.emplaceBack(C.uint16[S],C.uint16[S+1],C.uint16[S+2]);const k=on.simpleSegment(0,v,l.length,d.length-v);u.push({withoutSkirts:D,withSkirts:k})}return{vertices:l,indices:d,segments:u}}_createGrid(i){const s=this._fillGridMeshWithLods(64,kx);this._gridSegments=s.segments,this._gridBuffer=i.createVertexBuffer(s.vertices,Ac.members),this._gridIndexBuffer=i.createIndexBuffer(s.indices,!0)}_createPoles(i){const s=new Cr;for(let p=0;p<=64;p++)s.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=i.createIndexBuffer(s,!0);const l=new xu,d=new xu,u=new xu,m=new xu;this._poleSegments=[];for(let p=0,g=0;p<Zf;p++){const _=360/(1<<p);l.emplaceBack(0,-ms,0,.5,0),d.emplaceBack(0,-ms,0,.5,1),u.emplaceBack(0,-ms,0,.5,.5),m.emplaceBack(0,-ms,0,.5,.5);for(let y=0;y<=64;y++){let v=y/64,w=0;const C=_e(0,_,v),[D,k,S]=vm(Ox,Fx,C,ms);l.emplaceBack(D,k,S,v,w),d.emplaceBack(D,k,S,v,1-w);const E=ni(C);v=.5+.5*Math.sin(E),w=.5+.5*Math.cos(E),u.emplaceBack(D,k,S,v,w),m.emplaceBack(D,k,S,v,1-w)}this._poleSegments.push(on.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(l,Eu,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(d,Eu,!1),this._texturedPoleNorthVertexBuffer=i.createVertexBuffer(u,Eu,!1),this._texturedPoleSouthVertexBuffer=i.createVertexBuffer(m,Eu,!1)}getGridBuffers(i,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[i].withSkirts:this._gridSegments[i].withoutSkirts]}getPoleBuffers(i,s){return[s?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,s?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}}const Qf=6371008.8,jb=2*Math.PI*Qf;class Sd{constructor(i,s){if(isNaN(i)||isNaN(s))throw new Error(`Invalid LngLat object: (${i}, ${s})`);if(this.lng=+i,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Sd(Rl(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const s=Math.PI/180,l=this.lat*s,d=i.lat*s,u=Math.sin(l)*Math.sin(d)+Math.cos(l)*Math.cos(d)*Math.cos((i.lng-this.lng)*s);return Qf*Math.acos(Math.min(u,1))}toBounds(i=0){const s=360*i/40075017,l=s/Math.cos(Math.PI/180*this.lat);return new go(new Sd(this.lng-l,this.lat-s),new Sd(this.lng+l,this.lat+s))}toEcef(i){const s=Xf(i);return fs(this.lat,this.lng,ms+s)}static convert(i){if(i instanceof Sd)return i;if(Array.isArray(i)&&(2===i.length||3===i.length))return new Sd(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&"object"==typeof i&&null!==i)return new Sd(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var qe=Sd;const _P=0,bP=25.5;function Jf(o){return jb*Math.cos(o*Math.PI/180)}function dr(o){return(180+o)/360}function Rr(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function sn(o,i){return o/Jf(i)}function Ls(o){return 360*o-180}function an(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function Xk(o,i){return o*Jf(an(i))}const or=85.051129;function Lx(o){return Math.cos(ni(he(o,-or,or)))}function Pc(o,i){const s=he(i,_P,bP),l=Math.pow(2,s);return Lx(o)*jb/(512*l)}function Bx(o){return 1/Math.cos(o*Math.PI/180)}function tg(o,i=0){const s=Math.exp(Math.PI*(1-(o.y+i/pt)/(1<<o.z)*2));return 80150034*s/(s*s+1)/pt/(1<<o.z)}class Ei{constructor(i,s,l=0){this.x=+i,this.y=+s,this.z=+l}static fromLngLat(i,s=0){const l=qe.convert(i);return new Ei(dr(l.lng),Rr(l.lat),sn(s,l.lat))}toLngLat(){return new qe(Ls(this.x),an(this.y))}toAltitude(){return Xk(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/jb*Bx(an(this.y))}}function Nx(o,i,s,l,d,u,m,p,g){const _=(i+l)/2,y=(s+d)/2,v=new ot(_,y);p(v),function(w,C,D,k,S,E){const A=D-S,P=k-E;return Math.abs((k-C)*A-(D-w)*P)/Math.hypot(A,P)}(v.x,v.y,u.x,u.y,m.x,m.y)>=g?(Nx(o,i,s,_,y,u,v,p,g),Nx(o,_,y,l,d,v,m,p,g)):o.push(m)}function zx(o,i,s){let l=o[0],d=l.x,u=l.y;i(l);const m=[l];for(let p=1;p<o.length;p++){const g=o[p],{x:_,y}=g;i(g),Nx(m,d,u,_,y,l,g,i,s),d=_,u=y,l=g}return m}function Kk(o,i,s,l){if(l(i,s)){const d=i.add(s)._mult(.5);Kk(o,i,d,l),Kk(o,d,s,l)}else o.push(s)}function $3(o,i){let s=o[0];const l=[s];for(let d=1;d<o.length;d++){const u=o[d];Kk(l,s,u,i),s=u}return l}const Au=Math.pow(2,14)-1,wm=-Au-1;function Qk(o,i){const s=Math.round(o.x*i),l=Math.round(o.y*i);return o.x=he(s,wm,Au),o.y=he(l,wm,Au),(s<o.x||s>o.x+1||l<o.y||l>o.y+1)&&rt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),o}function ll(o,i,s){const l=o.loadGeometry(),d=o.extent,u=pt/d;if(i&&s&&s.projection.isReprojectedInTileSpace){const m=1<<i.z,{scale:p,x:g,y:_,projection:y}=s,v=w=>{const C=Ls((i.x+w.x/d)/m),D=an((i.y+w.y/d)/m),k=y.project(C,D);w.x=(k.x*p-g)*d,w.y=(k.y*p-_)*d};for(let w=0;w<l.length;w++)if(1!==o.type)l[w]=zx(l[w],v,1);else{const C=[];for(const D of l[w])D.x<0||D.x>=d||D.y<0||D.y>=d||(v(D),C.push(D));l[w]=C}}for(const m of l)for(const p of m)Qk(p,u);return l}function ql(o,i){return{type:o.type,id:o.id,properties:o.properties,geometry:i?ll(o):[]}}function Cm(o,i,s,l,d){o.emplaceBack(2*i+(l+1)/2,2*s+(d+1)/2)}function Ub(o,i,s){o.emplaceBack(i.x,i.y,i.z,16384*s[0],16384*s[1],16384*s[2])}class Hb{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new Os,this.indexArray=new Cr,this.segments=new on,this.programConfigurations=new Cd(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(i,s,l,d){const u=this.layers[0],m=[];let p=null;"circle"===u.type&&(p=u.layout.get("circle-sort-key"));for(const{feature:_,id:y,index:v,sourceLayerIndex:w}of i){const C=this.layers[0]._featureFilter.needGeometry,D=ql(_,C);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),D,l))continue;const k=p?p.evaluate(D,{},l):void 0,S={id:y,properties:_.properties,type:_.type,sourceLayerIndex:w,index:v,geometry:C?D.geometry:ll(_,l,d),patterns:{},sortKey:k};m.push(S)}p&&m.sort((_,y)=>_.sortKey-y.sortKey);let g=null;"globe"===d.projection.name&&(this.globeExtVertexArray=new yu,g=d.projection);for(const _ of m){const{geometry:y,index:v,sourceLayerIndex:w}=_,C=i[v].feature;this.addFeature(_,y,v,s.availableImages,l,g,s.brightness),s.featureIndex.insert(C,y,v,w,this.index)}}update(i,s,l,d,u){const m=0!==Object.keys(i).length;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(i,s,m?this.stateDependentLayers:this.layers,l,d,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ex.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,KR.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(i,s,l,d,u,m,p){for(const g of s)for(const _ of g){const y=_.x,v=_.y;if(y<0||y>=pt||v<0||v>=pt)continue;if(m){const D=m.projectTilePoint(y,v,u),k=m.upVector(u,y,v),S=this.globeExtVertexArray;Ub(S,D,k),Ub(S,D,k),Ub(S,D,k),Ub(S,D,k)}const w=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),C=w.vertexLength;Cm(this.layoutVertexArray,y,v,-1,-1),Cm(this.layoutVertexArray,y,v,1,-1),Cm(this.layoutVertexArray,y,v,1,1),Cm(this.layoutVertexArray,y,v,-1,1),this.indexArray.emplaceBack(C,C+1,C+2),this.indexArray.emplaceBack(C,C+2,C+3),w.vertexLength+=4,w.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,{},d,u,p)}}function Vx(o,i){for(let s=0;s<o.length;s++)if(Ed(i,o[s]))return!0;for(let s=0;s<i.length;s++)if(Ed(o,i[s]))return!0;return!!Ux(o,i)}function $b(o,i,s){return!!Ed(o,i)||!!Gb(i,o,s)}function yP(o,i){if(1===o.length)return Td(i,o[0]);for(let s=0;s<i.length;s++){const l=i[s];for(let d=0;d<l.length;d++)if(Ed(o,l[d]))return!0}for(let s=0;s<o.length;s++)if(Td(i,o[s]))return!0;for(let s=0;s<i.length;s++)if(Ux(o,i[s]))return!0;return!1}function jx(o,i,s){if(o.length>1){if(Ux(o,i))return!0;for(let l=0;l<i.length;l++)if(Gb(i[l],o,s))return!0}for(let l=0;l<o.length;l++)if(Gb(o[l],i,s))return!0;return!1}function Ux(o,i){if(0===o.length||0===i.length)return!1;for(let s=0;s<o.length-1;s++){const l=o[s],d=o[s+1];for(let u=0;u<i.length-1;u++)if(Hx(l,d,i[u],i[u+1]))return!0}return!1}function Hx(o,i,s,l){return Ot(o,s,l)!==Ot(i,s,l)&&Ot(o,i,s)!==Ot(o,i,l)}function Gb(o,i,s){const l=s*s;if(1===i.length)return o.distSqr(i[0])<l;for(let d=1;d<i.length;d++)if($x(o,i[d-1],i[d])<l)return!0;return!1}function $x(o,i,s){const l=i.distSqr(s);if(0===l)return o.distSqr(i);const d=((o.x-i.x)*(s.x-i.x)+(o.y-i.y)*(s.y-i.y))/l;return o.distSqr(d<0?i:d>1?s:s.sub(i)._mult(d)._add(i))}function Td(o,i){let s,l,d,u=!1;for(let m=0;m<o.length;m++){s=o[m];for(let p=0,g=s.length-1;p<s.length;g=p++)l=s[p],d=s[g],l.y>i.y!=d.y>i.y&&i.x<(d.x-l.x)*(i.y-l.y)/(d.y-l.y)+l.x&&(u=!u)}return u}function Ed(o,i){let s=!1;for(let l=0,d=o.length-1;l<o.length;d=l++){const u=o[l],m=o[d];u.y>i.y!=m.y>i.y&&i.x<(m.x-u.x)*(i.y-u.y)/(m.y-u.y)+u.x&&(s=!s)}return s}function Wb(o,i,s,l,d){for(const m of o)if(i<=m.x&&s<=m.y&&l>=m.x&&d>=m.y)return!0;const u=[new ot(i,s),new ot(i,d),new ot(l,d),new ot(l,s)];if(o.length>2)for(const m of u)if(Ed(o,m))return!0;for(let m=0;m<o.length-1;m++)if(qb(o[m],o[m+1],u))return!0;return!1}function qb(o,i,s){const l=s[0],d=s[2];if(o.x<l.x&&i.x<l.x||o.x>d.x&&i.x>d.x||o.y<l.y&&i.y<l.y||o.y>d.y&&i.y>d.y)return!1;const u=Ot(o,i,s[0]);return u!==Ot(o,i,s[1])||u!==Ot(o,i,s[2])||u!==Ot(o,i,s[3])}function Mm(o,i,s,l,d,u){let m=i.y-o.y,p=o.x-i.x;if(u=u||0){const g=m*m+p*p;if(0===g)return!0;const _=Math.sqrt(g);m/=_,p/=_}return!((s.x-o.x)*m+(s.y-o.y)*p-u<0||(l.x-o.x)*m+(l.y-o.y)*p-u<0||(d.x-o.x)*m+(d.y-o.y)*p-u<0)}function eg(o,i,s,l,d,u,m){return!(Mm(o,i,l,d,u,m)||Mm(i,s,l,d,u,m)||Mm(s,o,l,d,u,m)||Mm(l,d,o,i,s,m)||Mm(d,u,o,i,s,m)||Mm(u,l,o,i,s,m))}function Oc(o,i,s){const l=i.paint.get(o).value;return"constant"===l.kind?l.value:s.programConfigurations.get(i.id).getMaxValue(o)}function Ko(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function Iu(o,i,s,l,d){if(!i[0]&&!i[1])return o;const u=ot.convert(i)._mult(d);"viewport"===s&&u._rotate(-l);const m=[];for(let p=0;p<o.length;p++)m.push(o[p].sub(u));return m}function Yb(o,i,s,l){const d=ot.convert(o)._mult(l);return"viewport"===i&&d._rotate(-s),d}de(Hb,"CircleBucket",{omit:["layers"]});const vP=new Gn({"circle-sort-key":new ke(ct.layout_circle["circle-sort-key"]),visibility:new Ft(ct.layout_circle.visibility)});var xP={paint:new Gn({"circle-radius":new ke(ct.paint_circle["circle-radius"]),"circle-color":new ke(ct.paint_circle["circle-color"]),"circle-blur":new ke(ct.paint_circle["circle-blur"]),"circle-opacity":new ke(ct.paint_circle["circle-opacity"]),"circle-translate":new Ft(ct.paint_circle["circle-translate"]),"circle-translate-anchor":new Ft(ct.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ft(ct.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ft(ct.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ke(ct.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ke(ct.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ke(ct.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Ft(ct.paint_circle["circle-emissive-strength"])}),layout:vP};const Jk=at.create(),Dm=(o,i,s,l,d,u)=>{const m=o.transform,p="globe"===m.projection.name;let g;if("map"===u.paint.get("circle-pitch-alignment"))if(p){const y=Wk(m.zoom,i.canonical)*m._pixelsPerMercatorPixel;g=Float32Array.from([y,0,0,y])}else g=m.calculatePixelsToTileUnitsMatrix(s);else g=new Float32Array([m.pixelsToGLUnits[0],0,0,m.pixelsToGLUnits[1]]);const _={u_camera_to_center_distance:o.transform.getCameraToCenterDistance(m.projection),u_matrix:o.translatePosMatrix(i.projMatrix,s,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ze.devicePixelRatio,u_extrude_scale:g,u_inv_rot_matrix:Jk,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:u.paint.get("circle-emissive-strength")};if(p){_.u_inv_rot_matrix=l,_.u_merc_center=d,_.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],_.u_zoom_transition=Dr(m.zoom);const y=d[0]*pt,v=d[1]*pt;_.u_up_dir=m.projection.upVector(new ca(0,0,0),y,v)}return _},tS=o=>{const i=[];return"map"===o.paint.get("circle-pitch-alignment")&&i.push("PITCH_WITH_MAP"),"map"===o.paint.get("circle-pitch-scale")&&i.push("SCALE_WITH_MAP"),i};function eS(o,i,s,l,d,u,m,p,g){if(u&&o.queryGeometry.isAboveHorizon)return!1;u&&(g*=o.pixelToTileUnitsFactor);const _=o.tileID.canonical,y=s.projection.upVectorScale(_,s.center.lat,s.worldSize).metersToTile;for(const v of i)for(const w of v){const C=w.add(p),D=d&&s.elevation?s.elevation.exaggeration()*d.getElevationAt(C.x,C.y,!0):0,k=s.projection.projectTilePoint(C.x,C.y,_);if(D>0){const P=s.projection.upVector(_,C.x,C.y);k.x+=P[0]*y*D,k.y+=P[1]*y*D,k.z+=P[2]*y*D}const S=u?C:wP(k.x,k.y,k.z,l),E=u?o.tilespaceRays.map(P=>CP(P,D)):o.queryGeometry.screenGeometry,A=Qi.transformMat4([],[k.x,k.y,k.z,1],l);if(!m&&u?g*=A[3]/s.cameraToCenterDistance:m&&!u&&(g*=s.cameraToCenterDistance/A[3]),u){const P=an((w.y/pt+_.y)/(1<<_.z));g/=s.projection.pixelsPerMeter(P,1)/sn(1,P)}if($b(E,S,g))return!0}return!1}function wP(o,i,s,l){const d=Qi.transformMat4([],[o,i,s,1],l);return new ot(d[0]/d[3],d[1]/d[3])}const Zb=Z.fromValues(0,0,0),ig=Z.fromValues(0,0,1);function CP(o,i){const s=Z.create();return Zb[2]=i,o.intersectsPlane(Zb,ig,s),new ot(s[0],s[1])}class Gx extends Hb{}function Fc(o,{width:i,height:s},l,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==i*s*l)throw new RangeError("mismatched image size")}else d=new Uint8Array(i*s*l);return o.width=i,o.height=s,o.data=d,o}function MP(o,i,s){const{width:l,height:d}=i;l===o.width&&d===o.height||(Pr(o,i,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,l),height:Math.min(o.height,d)},s),o.width=l,o.height=d,o.data=i.data)}function Pr(o,i,s,l,d,u){if(0===d.width||0===d.height)return i;if(d.width>o.width||d.height>o.height||s.x>o.width-d.width||s.y>o.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>i.width||d.height>i.height||l.x>i.width-d.width||l.y>i.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const m=o.data,p=i.data;for(let g=0;g<d.height;g++){const _=((s.y+g)*o.width+s.x)*u,y=((l.y+g)*i.width+l.x)*u;for(let v=0;v<d.width*u;v++)p[y+v]=m[_+v]}return i}de(Gx,"HeatmapBucket",{omit:["layers"]});class cl{constructor(i,s){Fc(this,i,1,s)}resize(i){MP(this,new cl(i),1)}clone(){return new cl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,s,l,d,u){Pr(i,s,l,d,u,1)}}class _r{constructor(i,s){Fc(this,i,4,s)}resize(i){MP(this,new _r(i),4)}replace(i,s){s?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new _r({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,s,l,d,u){Pr(i,s,l,d,u,4)}}class DP{constructor(i,s){this.width=i.width,this.height=i.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}de(cl,"AlphaImage"),de(_r,"RGBAImage");const G3=new Gn({visibility:new Ft(ct.layout_heatmap.visibility)});var Xb={paint:new Gn({"heatmap-radius":new ke(ct.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ke(ct.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ft(ct.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mf(ct.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ft(ct.paint_heatmap["heatmap-opacity"])}),layout:G3};function Kb(o){const i={},s=o.resolution||256,l=o.clips?o.clips.length:1,d=o.image||new _r({width:s,height:l}),u=(m,p,g)=>{i[o.evaluationKey]=g;const _=o.expression.evaluate(i);_&&(d.data[m+p+0]=Math.floor(255*_.r/_.a),d.data[m+p+1]=Math.floor(255*_.g/_.a),d.data[m+p+2]=Math.floor(255*_.b/_.a),d.data[m+p+3]=Math.floor(255*_.a))};if(o.clips)for(let m=0,p=0;m<l;++m,p+=4*s)for(let g=0,_=0;g<s;g++,_+=4){const y=g/(s-1),{start:v,end:w}=o.clips[m];u(p,_,v*(1-y)+w*y)}else for(let m=0,p=0;m<s;m++,p+=4)u(0,p,m/(s-1));return d}const Wx=new Gn({visibility:new Ft(ct.layout_hillshade.visibility)});var qx={paint:new Gn({"hillshade-illumination-direction":new Ft(ct.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ft(ct.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ft(ct.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ft(ct.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ft(ct.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ft(ct.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Ft(ct.paint_hillshade["hillshade-emissive-strength"])}),layout:Wx};const km=Xe([{name:"a_pos",components:2,type:"Int16"}],4),{members:Yx}=km;var ng={exports:{}};function Ad(o,i,s){s=s||2;var l,d,u,m,p,g,_,y=i&&i.length,v=y?i[0]*s:o.length,w=rg(o,0,v,s,!0),C=[];if(!w||w.next===w.prev)return C;if(y&&(w=function(k,S,E,A){var P,O,R,F=[];for(P=0,O=S.length;P<O;P++)(R=rg(k,S[P]*A,P<O-1?S[P+1]*A:k.length,A,!1))===R.next&&(R.steiner=!0),F.push(SP(R));for(F.sort(og),P=0;P<F.length;P++)E=kP(F[P],E);return E}(o,i,w,s)),o.length>80*s){l=u=o[0],d=m=o[1];for(var D=s;D<v;D+=s)(p=o[D])<l&&(l=p),(g=o[D+1])<d&&(d=g),p>u&&(u=p),g>m&&(m=g);_=0!==(_=Math.max(u-l,m-d))?32767/_:0}return Ru(w,C,s,l,d,_,0),C}function rg(o,i,s,l,d){var u,m;if(d===Jx(o,i,s,l)>0)for(u=i;u<s;u+=l)m=Qx(u,o[u],o[u+1],m);else for(u=s-l;u>=i;u-=l)m=Qx(u,o[u],o[u+1],m);return m&&Jb(m,m.next)&&(Fu(m),m=m.next),m}function Ra(o,i){if(!o)return o;i||(i=o);var s,l=o;do{if(s=!1,l.steiner||!Jb(l,l.next)&&0!==Or(l.prev,l,l.next))l=l.next;else{if(Fu(l),(l=i=l.prev)===l.next)break;s=!0}}while(s||l!==i);return i}function Ru(o,i,s,l,d,u,m){if(o){!m&&u&&function(y,v,w,C){var D=y;do{0===D.z&&(D.z=Kx(D.x,D.y,v,w,C)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next}while(D!==y);D.prevZ.nextZ=null,D.prevZ=null,function(k){var S,E,A,P,O,R,F,B,j=1;do{for(E=k,k=null,O=null,R=0;E;){for(R++,A=E,F=0,S=0;S<j&&(F++,A=A.nextZ);S++);for(B=j;F>0||B>0&&A;)0!==F&&(0===B||!A||E.z<=A.z)?(P=E,E=E.nextZ,F--):(P=A,A=A.nextZ,B--),O?O.nextZ=P:k=P,P.prevZ=O,O=P;E=A}O.nextZ=null,j*=2}while(R>1)}(D)}(o,l,d,u);for(var p,g,_=o;o.prev!==o.next;)if(p=o.prev,g=o.next,u?Qb(o,l,d,u):Zx(o))i.push(p.i/s|0),i.push(o.i/s|0),i.push(g.i/s|0),Fu(o),o=g.next,_=g.next;else if((o=g)===_){m?1===m?Ru(o=W3(Ra(o),i,s),i,s,l,d,u,2):2===m&&Xx(o,i,s,l,d,u):Ru(Ra(o),i,s,l,d,u,1);break}}}function Zx(o){var i=o.prev,s=o,l=o.next;if(Or(i,s,l)>=0)return!1;for(var d=i.x,u=s.x,m=l.x,p=i.y,g=s.y,_=l.y,y=d<u?d<m?d:m:u<m?u:m,v=p<g?p<_?p:_:g<_?g:_,w=d>u?d>m?d:m:u>m?u:m,C=p>g?p>_?p:_:g>_?g:_,D=l.next;D!==i;){if(D.x>=y&&D.x<=w&&D.y>=v&&D.y<=C&&Id(d,p,u,g,m,_,D.x,D.y)&&Or(D.prev,D,D.next)>=0)return!1;D=D.next}return!0}function Qb(o,i,s,l){var d=o.prev,u=o,m=o.next;if(Or(d,u,m)>=0)return!1;for(var p=d.x,g=u.x,_=m.x,y=d.y,v=u.y,w=m.y,C=p<g?p<_?p:_:g<_?g:_,D=y<v?y<w?y:w:v<w?v:w,k=p>g?p>_?p:_:g>_?g:_,S=y>v?y>w?y:w:v>w?v:w,E=Kx(C,D,i,s,l),A=Kx(k,S,i,s,l),P=o.prevZ,O=o.nextZ;P&&P.z>=E&&O&&O.z<=A;){if(P.x>=C&&P.x<=k&&P.y>=D&&P.y<=S&&P!==d&&P!==m&&Id(p,y,g,v,_,w,P.x,P.y)&&Or(P.prev,P,P.next)>=0||(P=P.prevZ,O.x>=C&&O.x<=k&&O.y>=D&&O.y<=S&&O!==d&&O!==m&&Id(p,y,g,v,_,w,O.x,O.y)&&Or(O.prev,O,O.next)>=0))return!1;O=O.nextZ}for(;P&&P.z>=E;){if(P.x>=C&&P.x<=k&&P.y>=D&&P.y<=S&&P!==d&&P!==m&&Id(p,y,g,v,_,w,P.x,P.y)&&Or(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;O&&O.z<=A;){if(O.x>=C&&O.x<=k&&O.y>=D&&O.y<=S&&O!==d&&O!==m&&Id(p,y,g,v,_,w,O.x,O.y)&&Or(O.prev,O,O.next)>=0)return!1;O=O.nextZ}return!0}function W3(o,i,s){var l=o;do{var d=l.prev,u=l.next.next;!Jb(d,u)&&TP(d,l,l.next,u)&&Ou(d,u)&&Ou(u,d)&&(i.push(d.i/s|0),i.push(l.i/s|0),i.push(u.i/s|0),Fu(l),Fu(l.next),l=o=u),l=l.next}while(l!==o);return Ra(l)}function Xx(o,i,s,l,d,u){var m=o;do{for(var p=m.next.next;p!==m.prev;){if(m.i!==p.i&&nS(m,p)){var g=rS(m,p);return m=Ra(m,m.next),g=Ra(g,g.next),Ru(m,i,s,l,d,u,0),void Ru(g,i,s,l,d,u,0)}p=p.next}m=m.next}while(m!==o)}function og(o,i){return o.x-i.x}function kP(o,i){var s=function(d,u){var m,p=u,g=d.x,_=d.y,y=-1/0;do{if(_<=p.y&&_>=p.next.y&&p.next.y!==p.y){var v=p.x+(_-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(v<=g&&v>y&&(y=v,m=p.x<p.next.x?p:p.next,v===g))return m}p=p.next}while(p!==u);if(!m)return null;var w,C=m,D=m.x,k=m.y,S=1/0;p=m;do{g>=p.x&&p.x>=D&&g!==p.x&&Id(_<k?g:y,_,D,k,_<k?y:g,_,p.x,p.y)&&(w=Math.abs(_-p.y)/(g-p.x),Ou(p,d)&&(w<S||w===S&&(p.x>m.x||p.x===m.x&&iS(m,p)))&&(m=p,S=w)),p=p.next}while(p!==C);return m}(o,i);if(!s)return i;var l=rS(s,o);return Ra(l,l.next),Ra(s,s.next)}function iS(o,i){return Or(o.prev,o,i.prev)<0&&Or(i.next,o,o.next)<0}function Kx(o,i,s,l,d){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-s)*d|0)|o<<8))|o<<4))|o<<2))|o<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-l)*d|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function SP(o){var i=o,s=o;do{(i.x<s.x||i.x===s.x&&i.y<s.y)&&(s=i),i=i.next}while(i!==o);return s}function Id(o,i,s,l,d,u,m,p){return(d-m)*(i-p)>=(o-m)*(u-p)&&(o-m)*(l-p)>=(s-m)*(i-p)&&(s-m)*(u-p)>=(d-m)*(l-p)}function nS(o,i){return o.next.i!==i.i&&o.prev.i!==i.i&&!function(s,l){var d=s;do{if(d.i!==s.i&&d.next.i!==s.i&&d.i!==l.i&&d.next.i!==l.i&&TP(d,d.next,s,l))return!0;d=d.next}while(d!==s);return!1}(o,i)&&(Ou(o,i)&&Ou(i,o)&&function(s,l){var d=s,u=!1,m=(s.x+l.x)/2,p=(s.y+l.y)/2;do{d.y>p!=d.next.y>p&&d.next.y!==d.y&&m<(d.next.x-d.x)*(p-d.y)/(d.next.y-d.y)+d.x&&(u=!u),d=d.next}while(d!==s);return u}(o,i)&&(Or(o.prev,o,i.prev)||Or(o,i.prev,i))||Jb(o,i)&&Or(o.prev,o,o.next)>0&&Or(i.prev,i,i.next)>0)}function Or(o,i,s){return(i.y-o.y)*(s.x-i.x)-(i.x-o.x)*(s.y-i.y)}function Jb(o,i){return o.x===i.x&&o.y===i.y}function TP(o,i,s,l){var d=Pu(Or(o,i,s)),u=Pu(Or(o,i,l)),m=Pu(Or(s,l,o)),p=Pu(Or(s,l,i));return d!==u&&m!==p||!(0!==d||!ty(o,s,i))||!(0!==u||!ty(o,l,i))||!(0!==m||!ty(s,o,l))||!(0!==p||!ty(s,i,l))}function ty(o,i,s){return i.x<=Math.max(o.x,s.x)&&i.x>=Math.min(o.x,s.x)&&i.y<=Math.max(o.y,s.y)&&i.y>=Math.min(o.y,s.y)}function Pu(o){return o>0?1:o<0?-1:0}function Ou(o,i){return Or(o.prev,o,o.next)<0?Or(o,i,o.next)>=0&&Or(o,o.prev,i)>=0:Or(o,i,o.prev)<0||Or(o,o.next,i)<0}function rS(o,i){var s=new Sm(o.i,o.x,o.y),l=new Sm(i.i,i.x,i.y),d=o.next,u=i.prev;return o.next=i,i.prev=o,s.next=d,d.prev=s,l.next=s,s.prev=l,u.next=l,l.prev=u,l}function Qx(o,i,s,l){var d=new Sm(o,i,s);return l?(d.next=l.next,d.prev=l,l.next.prev=d,l.next=d):(d.prev=d,d.next=d),d}function Fu(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function Sm(o,i,s){this.i=o,this.x=i,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Jx(o,i,s,l){for(var d=0,u=i,m=s-l;u<s;u+=l)d+=(o[m]-o[u])*(o[u+1]+o[m+1]),m=u;return d}ng.exports=Ad,ng.exports.default=Ad,Ad.deviation=function(o,i,s,l){var d=i&&i.length,u=Math.abs(Jx(o,0,d?i[0]*s:o.length,s));if(d)for(var m=0,p=i.length;m<p;m++)u-=Math.abs(Jx(o,i[m]*s,m<p-1?i[m+1]*s:o.length,s));var g=0;for(m=0;m<l.length;m+=3){var _=l[m]*s,y=l[m+1]*s,v=l[m+2]*s;g+=Math.abs((o[_]-o[v])*(o[y+1]-o[_+1])-(o[_]-o[y])*(o[v+1]-o[_+1]))}return 0===u&&0===g?0:Math.abs((g-u)/u)},Ad.flatten=function(o){for(var i=o[0][0].length,s={vertices:[],holes:[],dimensions:i},l=0,d=0;d<o.length;d++){for(var u=0;u<o[d].length;u++)for(var m=0;m<i;m++)s.vertices.push(o[d][u][m]);d>0&&s.holes.push(l+=o[d-1].length)}return s};var sg=Ds(ng.exports);function tw(o,i){const s=o.length;if(s<=1)return[o];const l=[];let d,u;for(let m=0;m<s;m++){const p=Nt(o[m]);0!==p&&(o[m].area=Math.abs(p),void 0===u&&(u=p<0),u===p<0?(d&&l.push(d),d=[o[m]]):d.push(o[m]))}if(d&&l.push(d),i>1)for(let m=0;m<l.length;m++)l[m].length<=i||(dD(l[m],i,1,l[m].length-1,oS),l[m]=l[m].slice(0,i));return l}function oS(o,i){return i.area-o.area}function sS(o,i,s){const l=s.patternDependencies;let d=!1;for(const u of i){const m=u.paint.get(`${o}-pattern`);m.isConstant()||(d=!0);const p=m.constantOr(null);p&&(d=!0,l[p]=!0)}return d}function ew(o,i,s,l,d){const u=d.patternDependencies;for(const m of i){const p=m.paint.get(`${o}-pattern`).value;if("constant"!==p.kind){let g=p.evaluate({zoom:l},s,{},d.availableImages);g=g&&g.name?g.name:g,u[g]=!0,s.patterns[m.id]=g}}return s}class Lc{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Os,this.indexArray=new Cr,this.indexArray2=new Dc,this.programConfigurations=new Cd(i.layers,i.zoom),this.segments=new on,this.segments2=new on,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=i.projection}populate(i,s,l,d){this.hasPattern=sS("fill",this.layers,s);const u=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:p,id:g,index:_,sourceLayerIndex:y}of i){const v=this.layers[0]._featureFilter.needGeometry,w=ql(p,v);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),w,l))continue;const C=u?u.evaluate(w,{},l,s.availableImages):void 0,D={id:g,properties:p.properties,type:p.type,sourceLayerIndex:y,index:_,geometry:v?w.geometry:ll(p,l,d),patterns:{},sortKey:C};m.push(D)}u&&m.sort((p,g)=>p.sortKey-g.sortKey);for(const p of m){const{geometry:g,index:_,sourceLayerIndex:y}=p;if(this.hasPattern){const v=ew("fill",this.layers,p,this.zoom,s);this.patternFeatures.push(v)}else this.addFeature(p,g,_,l,{},s.availableImages,s.brightness);s.featureIndex.insert(i[_].feature,g,_,y,this.index)}}update(i,s,l,d,u){const m=0!==Object.keys(i).length;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(i,s,m?this.stateDependentLayers:this.layers,l,d,u)}addFeatures(i,s,l,d,u,m){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,s,l,d,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Yx),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,s,l,d,u,m=[],p){for(const g of tw(s,500)){let _=0;for(const k of g)_+=k.length;const y=this.segments.prepareSegment(_,this.layoutVertexArray,this.indexArray),v=y.vertexLength,w=[],C=[];for(const k of g){if(0===k.length)continue;k!==g[0]&&C.push(w.length/2);const S=this.segments2.prepareSegment(k.length,this.layoutVertexArray,this.indexArray2),E=S.vertexLength;this.layoutVertexArray.emplaceBack(k[0].x,k[0].y),this.indexArray2.emplaceBack(E+k.length-1,E),w.push(k[0].x),w.push(k[0].y);for(let A=1;A<k.length;A++)this.layoutVertexArray.emplaceBack(k[A].x,k[A].y),this.indexArray2.emplaceBack(E+A-1,E+A),w.push(k[A].x),w.push(k[A].y);S.vertexLength+=k.length,S.primitiveLength+=k.length}const D=sg(w,C);for(let k=0;k<D.length;k+=3)this.indexArray.emplaceBack(v+D[k],v+D[k+1],v+D[k+2]);y.vertexLength+=_,y.primitiveLength+=D.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,u,m,d,p)}}de(Lc,"FillBucket",{omit:["layers","patternFeatures"]});const EP=new Gn({"fill-sort-key":new ke(ct.layout_fill["fill-sort-key"]),visibility:new Ft(ct.layout_fill.visibility)});var Tm={paint:new Gn({"fill-antialias":new Ft(ct.paint_fill["fill-antialias"]),"fill-opacity":new ke(ct.paint_fill["fill-opacity"]),"fill-color":new ke(ct.paint_fill["fill-color"]),"fill-outline-color":new ke(ct.paint_fill["fill-outline-color"]),"fill-translate":new Ft(ct.paint_fill["fill-translate"]),"fill-translate-anchor":new Ft(ct.paint_fill["fill-translate-anchor"]),"fill-pattern":new ke(ct.paint_fill["fill-pattern"]),"fill-emissive-strength":new Ft(ct.paint_fill["fill-emissive-strength"])}),layout:EP};const Me=Xe([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),AP=Xe([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),ag=Xe([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Bc=Xe([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),IP=Xe([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:RP}=Me;var Yl={},PP=td,ey=lg;function lg(o,i,s,l,d){this.properties={},this.extent=s,this.type=0,this._pbf=o,this._geometry=-1,this._keys=l,this._values=d,o.readFields(iw,this,i)}function iw(o,i,s){1==o?i.id=s.readVarint():2==o?function(l,d){for(var u=l.readVarint()+l.pos;l.pos<u;){var m=d._keys[l.readVarint()],p=d._values[l.readVarint()];d.properties[m]=p}}(s,i):3==o?i.type=s.readVarint():4==o&&(i._geometry=s.pos)}function aS(o){for(var i,s,l=0,d=0,u=o.length,m=u-1;d<u;m=d++)l+=((s=o[m]).x-(i=o[d]).x)*(i.y+s.y);return l}lg.types=["Unknown","Point","LineString","Polygon"],lg.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var i,s=o.readVarint()+o.pos,l=1,d=0,u=0,m=0,p=[];o.pos<s;){if(d<=0){var g=o.readVarint();l=7&g,d=g>>3}if(d--,1===l||2===l)u+=o.readSVarint(),m+=o.readSVarint(),1===l&&(i&&p.push(i),i=[]),i.push(new PP(u,m));else{if(7!==l)throw new Error("unknown command "+l);i&&i.push(i[0].clone())}}return i&&p.push(i),p},lg.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var i=o.readVarint()+o.pos,s=1,l=0,d=0,u=0,m=1/0,p=-1/0,g=1/0,_=-1/0;o.pos<i;){if(l<=0){var y=o.readVarint();s=7&y,l=y>>3}if(l--,1===s||2===s)(d+=o.readSVarint())<m&&(m=d),d>p&&(p=d),(u+=o.readSVarint())<g&&(g=u),u>_&&(_=u);else if(7!==s)throw new Error("unknown command "+s)}return[m,g,p,_]},lg.prototype.toGeoJSON=function(o,i,s){var l,d,u=this.extent*Math.pow(2,s),m=this.extent*o,p=this.extent*i,g=this.loadGeometry(),_=lg.types[this.type];function y(C){for(var D=0;D<C.length;D++){var k=C[D];C[D]=[360*(k.x+m)/u-180,360/Math.PI*Math.atan(Math.exp((180-360*(k.y+p)/u)*Math.PI/180))-90]}}switch(this.type){case 1:var v=[];for(l=0;l<g.length;l++)v[l]=g[l][0];y(g=v);break;case 2:for(l=0;l<g.length;l++)y(g[l]);break;case 3:for(g=function(C){var D=C.length;if(D<=1)return[C];for(var k,S,E=[],A=0;A<D;A++){var P=aS(C[A]);0!==P&&(void 0===S&&(S=P<0),S===P<0?(k&&E.push(k),k=[C[A]]):k.push(C[A]))}return k&&E.push(k),E}(g),l=0;l<g.length;l++)for(d=0;d<g[l].length;d++)y(g[l][d])}1===g.length?g=g[0]:_="Multi"+_;var w={type:"Feature",geometry:{type:_,coordinates:g},properties:this.properties};return"id"in this&&(w.id=this.id),w};var OP=ey,lS=nw;function nw(o,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(FP,this,i),this.length=this._features.length}function FP(o,i,s){15===o?i.version=s.readVarint():1===o?i.name=s.readString():5===o?i.extent=s.readVarint():2===o?i._features.push(s.pos):3===o?i._keys.push(s.readString()):4===o&&i._values.push(function(l){for(var d=null,u=l.readVarint()+l.pos;l.pos<u;){var m=l.readVarint()>>3;d=1===m?l.readString():2===m?l.readFloat():3===m?l.readDouble():4===m?l.readVarint64():5===m?l.readVarint():6===m?l.readSVarint():7===m?l.readBoolean():null}return d}(s))}nw.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var i=this._pbf.readVarint()+this._pbf.pos;return new OP(this._pbf,i,this.extent,this._keys,this._values)};var cS=lS;function LP(o,i,s){if(3===o){var l=new cS(s,s.readVarint()+s.pos);l.length&&(i[l.name]=l)}}var rw=Yl.VectorTile=function(o,i){this.layers=o.readFields(LP,{},i)},ow=Yl.VectorTileFeature=ey;function cg(o,i,s,l){const d=[],u=0===l?(m,p,g,_,y,v)=>{m.push(new ot(v,g+(v-p)/(_-p)*(y-g)))}:(m,p,g,_,y,v)=>{m.push(new ot(p+(v-g)/(y-g)*(_-p),v))};for(const m of o){const p=[];for(const g of m){if(g.length<=2)continue;const _=[];for(let w=0;w<g.length-1;w++){const C=g[w].x,D=g[w].y,k=g[w+1].x,S=g[w+1].y,E=0===l?C:D,A=0===l?k:S;E<i?A>i&&u(_,C,D,k,S,i):E>s?A<s&&u(_,C,D,k,S,s):_.push(g[w]),A<i&&E>=i&&u(_,C,D,k,S,i),A>s&&E<=s&&u(_,C,D,k,S,s)}let y=g[g.length-1];const v=0===l?y.x:y.y;v>=i&&v<=s&&_.push(y),_.length&&(y=_[_.length-1],_[0].x===y.x&&_[0].y===y.y||_.push(_[0]),p.push(_))}p.length&&d.push(p)}return d}Yl.VectorTileLayer=lS;class sw{constructor(i){this._stringToNumber={},this._numberToString=[];for(let s=0;s<i.length;s++){const l=i[s];this._stringToNumber[l]=s,this._numberToString[s]=l}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}var oo={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(o,i,s,l,d){var u,m,p=8*d-l-1,g=(1<<p)-1,_=g>>1,y=-7,v=s?d-1:0,w=s?-1:1,C=o[i+v];for(v+=w,u=C&(1<<-y)-1,C>>=-y,y+=p;y>0;u=256*u+o[i+v],v+=w,y-=8);for(m=u&(1<<-y)-1,u>>=-y,y+=l;y>0;m=256*m+o[i+v],v+=w,y-=8);if(0===u)u=1-_;else{if(u===g)return m?NaN:1/0*(C?-1:1);m+=Math.pow(2,l),u-=_}return(C?-1:1)*m*Math.pow(2,u-l)},write:function(o,i,s,l,d,u){var m,p,g,_=8*u-d-1,y=(1<<_)-1,v=y>>1,w=23===d?Math.pow(2,-24)-Math.pow(2,-77):0,C=l?0:u-1,D=l?1:-1,k=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(p=isNaN(i)?1:0,m=y):(m=Math.floor(Math.log(i)/Math.LN2),i*(g=Math.pow(2,-m))<1&&(m--,g*=2),(i+=m+v>=1?w/g:w*Math.pow(2,1-v))*g>=2&&(m++,g/=2),m+v>=y?(p=0,m=y):m+v>=1?(p=(i*g-1)*Math.pow(2,d),m+=v):(p=i*Math.pow(2,v-1)*Math.pow(2,d),m=0));d>=8;o[s+C]=255&p,C+=D,p/=256,d-=8);for(m=m<<d|p,_+=d;_>0;o[s+C]=255&m,C+=D,m/=256,_-=8);o[s+C-D]|=128*k}},aw=Pn,lw=oo;function Pn(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}Pn.Varint=0,Pn.Fixed64=1,Pn.Bytes=2,Pn.Fixed32=5;var Bs=4294967296,iy=1/Bs,dS=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Rd(o){return o.type===Pn.Bytes?o.readVarint()+o.pos:o.pos+1}function ny(o,i,s){var l=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));s.realloc(l);for(var d=s.pos-1;d>=o;d--)s.buf[d+l]=s.buf[d]}function me(o,i){for(var s=0;s<o.length;s++)i.writeVarint(o[s])}function uS(o,i){for(var s=0;s<o.length;s++)i.writeSVarint(o[s])}function BP(o,i){for(var s=0;s<o.length;s++)i.writeFloat(o[s])}function q3(o,i){for(var s=0;s<o.length;s++)i.writeDouble(o[s])}function Re(o,i){for(var s=0;s<o.length;s++)i.writeBoolean(o[s])}function NP(o,i){for(var s=0;s<o.length;s++)i.writeFixed32(o[s])}function cw(o,i){for(var s=0;s<o.length;s++)i.writeSFixed32(o[s])}function zP(o,i){for(var s=0;s<o.length;s++)i.writeFixed64(o[s])}function VP(o,i){for(var s=0;s<o.length;s++)i.writeSFixed64(o[s])}function Am(o,i){return(o[i]|o[i+1]<<8|o[i+2]<<16)+16777216*o[i+3]}function Lu(o,i,s){o[s]=i,o[s+1]=i>>>8,o[s+2]=i>>>16,o[s+3]=i>>>24}function dw(o,i){return(o[i]|o[i+1]<<8|o[i+2]<<16)+(o[i+3]<<24)}Pn.prototype={destroy:function(){this.buf=null},readFields:function(o,i,s){for(s=s||this.length;this.pos<s;){var l=this.readVarint(),d=l>>3,u=this.pos;this.type=7&l,o(d,i,this),this.pos===u&&this.skip(l)}return i},readMessage:function(o,i){return this.readFields(o,i,this.readVarint()+this.pos)},readFixed32:function(){var o=Am(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=dw(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=Am(this.buf,this.pos)+Am(this.buf,this.pos+4)*Bs;return this.pos+=8,o},readSFixed64:function(){var o=Am(this.buf,this.pos)+dw(this.buf,this.pos+4)*Bs;return this.pos+=8,o},readFloat:function(){var o=lw.read(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=lw.read(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var i,s,l=this.buf;return i=127&(s=l[this.pos++]),s<128?i:(i|=(127&(s=l[this.pos++]))<<7,s<128?i:(i|=(127&(s=l[this.pos++]))<<14,s<128?i:(i|=(127&(s=l[this.pos++]))<<21,s<128?i:function(d,u,m){var p,g,_=m.buf;if(p=(112&(g=_[m.pos++]))>>4,g<128||(p|=(127&(g=_[m.pos++]))<<3,g<128)||(p|=(127&(g=_[m.pos++]))<<10,g<128)||(p|=(127&(g=_[m.pos++]))<<17,g<128)||(p|=(127&(g=_[m.pos++]))<<24,g<128)||(p|=(1&(g=_[m.pos++]))<<31,g<128))return function Em(o,i,s){return s?4294967296*i+(o>>>0):4294967296*(i>>>0)+(o>>>0)}(d,p,u);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(s=l[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var o=this.readVarint()+this.pos,i=this.pos;return this.pos=o,o-i>=12&&dS?dS.decode(this.buf.subarray(i,o)):function(s,l,d){for(var u="",m=l;m<d;){var p,g,_,y=s[m],v=null,w=y>239?4:y>223?3:y>191?2:1;if(m+w>d)break;1===w?y<128&&(v=y):2===w?128==(192&(p=s[m+1]))&&(v=(31&y)<<6|63&p)<=127&&(v=null):3===w?(g=s[m+2],128==(192&(p=s[m+1]))&&128==(192&g)&&((v=(15&y)<<12|(63&p)<<6|63&g)<=2047||v>=55296&&v<=57343)&&(v=null)):4===w&&(g=s[m+2],_=s[m+3],128==(192&(p=s[m+1]))&&128==(192&g)&&128==(192&_)&&((v=(15&y)<<18|(63&p)<<12|(63&g)<<6|63&_)<=65535||v>=1114112)&&(v=null)),null===v?(v=65533,w=1):v>65535&&(v-=65536,u+=String.fromCharCode(v>>>10&1023|55296),v=56320|1023&v),u+=String.fromCharCode(v),m+=w}return u}(this.buf,i,o)},readBytes:function(){var o=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,o);return this.pos=o,i},readPackedVarint:function(o,i){if(this.type!==Pn.Bytes)return o.push(this.readVarint(i));var s=Rd(this);for(o=o||[];this.pos<s;)o.push(this.readVarint(i));return o},readPackedSVarint:function(o){if(this.type!==Pn.Bytes)return o.push(this.readSVarint());var i=Rd(this);for(o=o||[];this.pos<i;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==Pn.Bytes)return o.push(this.readBoolean());var i=Rd(this);for(o=o||[];this.pos<i;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==Pn.Bytes)return o.push(this.readFloat());var i=Rd(this);for(o=o||[];this.pos<i;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==Pn.Bytes)return o.push(this.readDouble());var i=Rd(this);for(o=o||[];this.pos<i;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==Pn.Bytes)return o.push(this.readFixed32());var i=Rd(this);for(o=o||[];this.pos<i;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==Pn.Bytes)return o.push(this.readSFixed32());var i=Rd(this);for(o=o||[];this.pos<i;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==Pn.Bytes)return o.push(this.readFixed64());var i=Rd(this);for(o=o||[];this.pos<i;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==Pn.Bytes)return o.push(this.readSFixed64());var i=Rd(this);for(o=o||[];this.pos<i;)o.push(this.readSFixed64());return o},skip:function(o){var i=7&o;if(i===Pn.Varint)for(;this.buf[this.pos++]>127;);else if(i===Pn.Bytes)this.pos=this.readVarint()+this.pos;else if(i===Pn.Fixed32)this.pos+=4;else{if(i!==Pn.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(o,i){this.writeVarint(o<<3|i)},realloc:function(o){for(var i=this.length||16;i<this.pos+o;)i*=2;if(i!==this.length){var s=new Uint8Array(i);s.set(this.buf),this.buf=s,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),Lu(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),Lu(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),Lu(this.buf,-1&o,this.pos),Lu(this.buf,Math.floor(o*iy),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),Lu(this.buf,-1&o,this.pos),Lu(this.buf,Math.floor(o*iy),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(i,s){var l,d,u,p;if(i>=0?(l=i%4294967296|0,d=i/4294967296|0):(d=~(-i/4294967296),4294967295^(l=~(-i%4294967296))?l=l+1|0:(l=0,d=d+1|0)),i>=0x10000000000000000||i<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),u=l,(p=s).buf[p.pos++]=127&u|128,u>>>=7,p.buf[p.pos++]=127&u|128,u>>>=7,p.buf[p.pos++]=127&u|128,u>>>=7,p.buf[p.pos++]=127&u|128,p.buf[p.pos]=127&(u>>>=7),function(u,m){var p=(7&u)<<4;m.buf[m.pos++]|=p|((u>>>=3)?128:0),u&&(m.buf[m.pos++]=127&u|((u>>>=7)?128:0),u&&(m.buf[m.pos++]=127&u|((u>>>=7)?128:0),u&&(m.buf[m.pos++]=127&u|((u>>>=7)?128:0),u&&(m.buf[m.pos++]=127&u|((u>>>=7)?128:0),u&&(m.buf[m.pos++]=127&u)))))}(d,s)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(!!o)},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var i=this.pos;this.pos=function(l,d,u){for(var m,p,g=0;g<d.length;g++){if((m=d.charCodeAt(g))>55295&&m<57344){if(!p){m>56319||g+1===d.length?(l[u++]=239,l[u++]=191,l[u++]=189):p=m;continue}if(m<56320){l[u++]=239,l[u++]=191,l[u++]=189,p=m;continue}m=p-55296<<10|m-56320|65536,p=null}else p&&(l[u++]=239,l[u++]=191,l[u++]=189,p=null);m<128?l[u++]=m:(m<2048?l[u++]=m>>6|192:(m<65536?l[u++]=m>>12|224:(l[u++]=m>>18|240,l[u++]=m>>12&63|128),l[u++]=m>>6&63|128),l[u++]=63&m|128)}return u}(this.buf,o,this.pos);var s=this.pos-i;s>=128&&ny(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeFloat:function(o){this.realloc(4),lw.write(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),lw.write(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var i=o.length;this.writeVarint(i),this.realloc(i);for(var s=0;s<i;s++)this.buf[this.pos++]=o[s]},writeRawMessage:function(o,i){this.pos++;var s=this.pos;o(i,this);var l=this.pos-s;l>=128&&ny(s,l,this),this.pos=s-1,this.writeVarint(l),this.pos+=l},writeMessage:function(o,i,s){this.writeTag(o,Pn.Bytes),this.writeRawMessage(i,s)},writePackedVarint:function(o,i){i.length&&this.writeMessage(o,me,i)},writePackedSVarint:function(o,i){i.length&&this.writeMessage(o,uS,i)},writePackedBoolean:function(o,i){i.length&&this.writeMessage(o,Re,i)},writePackedFloat:function(o,i){i.length&&this.writeMessage(o,BP,i)},writePackedDouble:function(o,i){i.length&&this.writeMessage(o,q3,i)},writePackedFixed32:function(o,i){i.length&&this.writeMessage(o,NP,i)},writePackedSFixed32:function(o,i){i.length&&this.writeMessage(o,cw,i)},writePackedFixed64:function(o,i){i.length&&this.writeMessage(o,zP,i)},writePackedSFixed64:function(o,i){i.length&&this.writeMessage(o,VP,i)},writeBytesField:function(o,i){this.writeTag(o,Pn.Bytes),this.writeBytes(i)},writeFixed32Field:function(o,i){this.writeTag(o,Pn.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(o,i){this.writeTag(o,Pn.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(o,i){this.writeTag(o,Pn.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(o,i){this.writeTag(o,Pn.Fixed64),this.writeSFixed64(i)},writeVarintField:function(o,i){this.writeTag(o,Pn.Varint),this.writeVarint(i)},writeSVarintField:function(o,i){this.writeTag(o,Pn.Varint),this.writeSVarint(i)},writeStringField:function(o,i){this.writeTag(o,Pn.Bytes),this.writeString(i)},writeFloatField:function(o,i){this.writeTag(o,Pn.Fixed32),this.writeFloat(i)},writeDoubleField:function(o,i){this.writeTag(o,Pn.Fixed64),this.writeDouble(i)},writeBooleanField:function(o,i){this.writeVarintField(o,!!i)}};var ry=Ds(aw);const hS=["tile","layer","source","sourceLayer","state"];class uw{constructor(i,s,l,d,u){this.type="Feature",this._vectorTileFeature=i,this._z=s,this._x=l,this._y=d,this.properties=i.properties,this.id=u}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(i.id=this.id);for(const s of hS)void 0!==this[s]&&(i[s]=this[s]);return i}}class jP{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,s,l){const d=String(s);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][d]=this.stateChanges[i][d]||{},se(this.stateChanges[i][d],l),null===this.deletedStates[i]){this.deletedStates[i]={};for(const u in this.state[i])u!==d&&(this.deletedStates[i][u]=null)}else if(this.deletedStates[i]&&null===this.deletedStates[i][d]){this.deletedStates[i][d]={};for(const u in this.state[i][d])l[u]||(this.deletedStates[i][d][u]=null)}else for(const u in l)this.deletedStates[i]&&this.deletedStates[i][d]&&null===this.deletedStates[i][d][u]&&delete this.deletedStates[i][d][u]}removeFeatureState(i,s,l){if(null===this.deletedStates[i])return;const d=String(s);if(this.deletedStates[i]=this.deletedStates[i]||{},l&&void 0!==s)null!==this.deletedStates[i][d]&&(this.deletedStates[i][d]=this.deletedStates[i][d]||{},this.deletedStates[i][d][l]=null);else if(void 0!==s)if(this.stateChanges[i]&&this.stateChanges[i][d])for(l in this.deletedStates[i][d]={},this.stateChanges[i][d])this.deletedStates[i][d][l]=null;else this.deletedStates[i][d]=null;else this.deletedStates[i]=null}getState(i,s){const l=String(s),d=se({},(this.state[i]||{})[l],(this.stateChanges[i]||{})[l]);if(null===this.deletedStates[i])return{};if(this.deletedStates[i]){const u=this.deletedStates[i][s];if(null===u)return{};for(const m in u)delete d[m]}return d}initializeTileState(i,s){i.setFeatureState(this.state,s)}coalesceChanges(i,s){const l={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const u={};for(const m in this.stateChanges[d])this.state[d][m]||(this.state[d][m]={}),se(this.state[d][m],this.stateChanges[d][m]),u[m]=this.state[d][m];l[d]=u}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const u={};if(null===this.deletedStates[d])for(const m in this.state[d])u[m]={},this.state[d][m]={};else for(const m in this.deletedStates[d]){if(null===this.deletedStates[d][m])this.state[d][m]={};else if(this.state[d][m])for(const p of Object.keys(this.deletedStates[d][m]))delete this.state[d][m][p];u[m]=this.state[d][m]}l[d]=l[d]||{},se(l[d],u)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(l).length)for(const d in i)i[d].setFeatureState(l,s)}}class mS{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,s){const l=this.toIdx(i,s);return{min:this.minimums[l],max:this.maximums[l]}}isLeaf(i,s){return this.leaves[this.toIdx(i,s)]}toIdx(i,s){return s*this.size+i}}function pS(o,i,s,l){let d=0,u=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(l[m])<1e-15){if(s[m]<o[m]||s[m]>i[m])return null}else{const p=1/l[m];let g=(o[m]-s[m])*p,_=(i[m]-s[m])*p;if(g>_){const y=g;g=_,_=y}if(g>d&&(d=g),_<u&&(u=_),d>u)return null}return d}function hw(o,i,s,l,d,u,m,p,g,_,y){const v=l-o,w=d-i,C=u-s,D=m-o,k=p-i,S=g-s,E=y[1]*S-y[2]*k,A=y[2]*D-y[0]*S,P=y[0]*k-y[1]*D,O=v*E+w*A+C*P;if(Math.abs(O)<1e-15)return null;const R=1/O,F=_[0]-o,B=_[1]-i,j=_[2]-s,U=(F*E+B*A+j*P)*R;if(U<0||U>1)return null;const H=B*C-j*w,W=j*v-F*C,q=F*w-B*v,X=(y[0]*H+y[1]*W+y[2]*q)*R;return X<0||U+X>1?null:(D*H+k*W+S*q)*R}function Bu(o,i,s){return(o-i)/(s-i)}function Zl(o,i,s,l,d,u,m,p,g){const _=1<<s,y=u-l,v=m-d,w=(o+1)/_*y+l,C=(i+0)/_*v+d,D=(i+1)/_*v+d;p[0]=(o+0)/_*y+l,p[1]=C,g[0]=w,g[1]=D}class Nu{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(u){const m=Math.ceil(Math.log2(u.dim/8)),p=[];let g=Math.ceil(Math.pow(2,m));const _=1/g,y=(C,D,k,S,E)=>{const A=S?1:0,P=(C+1)*k-A,O=D*k,R=(D+1)*k-A;E[0]=C*k,E[1]=O,E[2]=P,E[3]=R};let v=new mS(g);const w=[];for(let C=0;C<g*g;C++){y(C%g,Math.floor(C/g),_,!1,w);const D=Pd(w[0],w[1],u),k=Pd(w[2],w[1],u),S=Pd(w[2],w[3],u),E=Pd(w[0],w[3],u);v.minimums.push(Math.min(D,k,S,E)),v.maximums.push(Math.max(D,k,S,E)),v.leaves.push(1)}for(p.push(v),g/=2;g>=1;g/=2){const C=p[p.length-1];v=new mS(g);for(let D=0;D<g*g;D++){y(D%g,Math.floor(D/g),2,!0,w);const k=C.getElevation(w[0],w[1]),S=C.getElevation(w[2],w[1]),E=C.getElevation(w[2],w[3]),A=C.getElevation(w[0],w[3]),P=C.isLeaf(w[0],w[1]),O=C.isLeaf(w[2],w[1]),R=C.isLeaf(w[2],w[3]),F=C.isLeaf(w[0],w[3]),B=Math.min(k.min,S.min,E.min,A.min),j=Math.max(k.max,S.max,E.max,A.max),U=P&&O&&R&&F;v.maximums.push(j),v.minimums.push(B),v.leaves.push(j-B<=5&&U?1:0)}p.push(v)}return p}(this.dem),l=s.length-1,d=s[l];this._addNode(d.minimums[0],d.maximums[0],d.leaves[0]),this._construct(s,0,0,l,0)}raycastRoot(i,s,l,d,u,m,p=1){return pS([i,s,-100],[l,d,this.maximums[0]*p],u,m)}raycast(i,s,l,d,u,m,p=1){if(!this.nodeCount)return null;const g=this.raycastRoot(i,s,l,d,u,m,p);if(null==g)return null;const _=[],y=[],v=[],w=[],C=[{idx:0,t:g,nodex:0,nodey:0,depth:0}];for(;C.length>0;){const{idx:D,t:k,nodex:S,nodey:E,depth:A}=C.pop();if(this.leaves[D]){Zl(S,E,A,i,s,l,d,v,w);const O=1<<A,R=(S+0)/O,F=(S+1)/O,B=(E+0)/O,j=(E+1)/O,U=Pd(R,B,this.dem)*p,H=Pd(F,B,this.dem)*p,W=Pd(F,j,this.dem)*p,q=Pd(R,j,this.dem)*p,X=hw(v[0],v[1],U,w[0],v[1],H,w[0],w[1],W,u,m),G=hw(w[0],w[1],W,v[0],w[1],q,v[0],v[1],U,u,m),Q=Math.min(null!==X?X:Number.MAX_VALUE,null!==G?G:Number.MAX_VALUE);if(Q!==Number.MAX_VALUE)return Q;{const it=Z.scaleAndAdd([],u,m,k);if(fS(U,H,q,W,Bu(it[0],v[0],w[0]),Bu(it[1],v[1],w[1]))>=it[2])return k}continue}let P=0;for(let O=0;O<this._siblingOffset.length;O++){Zl((S<<1)+this._siblingOffset[O][0],(E<<1)+this._siblingOffset[O][1],A+1,i,s,l,d,v,w),v[2]=-100,w[2]=this.maximums[this.childOffsets[D]+O]*p;const R=pS(v,w,u,m);if(null!=R){const F=R;_[O]=F;let B=!1;for(let j=0;j<P&&!B;j++)F>=_[y[j]]&&(y.splice(j,0,O),B=!0);B||(y[P]=O),P++}}for(let O=0;O<P;O++){const R=y[O];C.push({idx:this.childOffsets[D]+R,t:_[R],nodex:(S<<1)+this._siblingOffset[R][0],nodey:(E<<1)+this._siblingOffset[R][1],depth:A+1})}}return null}_addNode(i,s,l){return this.minimums.push(i),this.maximums.push(s),this.leaves.push(l),this.childOffsets.push(0),this.nodeCount++}_construct(i,s,l,d,u){if(1===i[d].isLeaf(s,l))return;this.childOffsets[u]||(this.childOffsets[u]=this.nodeCount);const m=d-1,p=i[m];let g=0,_=0;for(let y=0;y<this._siblingOffset.length;y++){const v=2*s+this._siblingOffset[y][0],w=2*l+this._siblingOffset[y][1],C=p.getElevation(v,w),D=p.isLeaf(v,w),k=this._addNode(C.min,C.max,D);D&&(g|=1<<y),_||(_=k)}for(let y=0;y<this._siblingOffset.length;y++)g&1<<y||this._construct(i,2*s+this._siblingOffset[y][0],2*l+this._siblingOffset[y][1],m,_+y)}}function fS(o,i,s,l,d,u){return _e(_e(o,s,u),_e(i,l,u),d)}function Pd(o,i,s){const l=s.dim,d=he(o*l-.5,0,l-1),u=he(i*l-.5,0,l-1),m=Math.floor(d),p=Math.floor(u),g=Math.min(m+1,l-1),_=Math.min(p+1,l-1);return fS(s.get(m,p),s.get(g,p),s.get(m,_),s.get(g,_),d-m,u-p)}const gS={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function _S(o,i,s){return(256*o*256+256*i+s)/10-1e4}function mw(o,i,s){return 256*o+i+s/256-32768}class Od{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,s,l,d=!1){if(this.uid=i,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(l&&"mapbox"!==l&&"terrarium"!==l)return rt(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const u=this.dim=s.height-2,m=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=d,this._modifiedForSources={},!d){for(let g=0;g<u;g++)m[this._idx(-1,g)]=m[this._idx(0,g)],m[this._idx(u,g)]=m[this._idx(u-1,g)],m[this._idx(g,-1)]=m[this._idx(g,0)],m[this._idx(g,u)]=m[this._idx(g,u-1)];m[this._idx(-1,-1)]=m[this._idx(0,0)],m[this._idx(u,-1)]=m[this._idx(u-1,0)],m[this._idx(-1,u)]=m[this._idx(0,u-1)],m[this._idx(u,u)]=m[this._idx(u-1,u-1)]}const p="terrarium"===l?mw:_S;for(let g=0;g<m.length;++g){const _=4*g;this.floatView[g]=p(this.pixels[_],this.pixels[_+1],this.pixels[_+2])}this._timestamp=Ze.now()}_buildQuadTree(){this._tree=new Nu(this)}get(i,s,l=!1){l&&(i=he(i,-1,this.dim),s=he(s,-1,this.dim));const d=this._idx(i,s);return this.floatView[d]}set(i,s,l){const d=this._idx(i,s),u=this.floatView[d];return this.floatView[d]=l,l-u}static getUnpackVector(i){return gS[i]}_idx(i,s){if(i<-1||i>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(i+1)}static pack(i,s){const l=[0,0,0,0],d=Od.getUnpackVector(s);let u=Math.floor((i+d[3])/d[2]);return l[2]=u%256,u=Math.floor(u/256),l[1]=u%256,u=Math.floor(u/256),l[0]=u,l}getPixels(){return new DP({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,s,l){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let d=s*this.dim,u=s*this.dim+this.dim,m=l*this.dim,p=l*this.dim+this.dim;switch(s){case-1:d=u-1;break;case 1:u=d+1}switch(l){case-1:m=p-1;break;case 1:p=m+1}const g=-s*this.dim,_=-l*this.dim;for(let y=m;y<p;y++)for(let v=d;v<u;v++){const w=4*this._idx(v,y),C=4*this._idx(v+g,y+_);this.pixels[w+0]=i.pixels[C+0],this.pixels[w+1]=i.pixels[C+1],this.pixels[w+2]=i.pixels[C+2],this.pixels[w+3]=i.pixels[C+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}de(Od,"DEMData"),de(Nu,"DemMinMaxQuadTree",{omit:["dem"]});class oy{isDataAvailableAtPoint(i){const s=this._source();if(this.isUsingMockSource()||!s||i.y<0||i.y>1)return!1;const l=s.getSource().maxzoom,d=1<<l,u=Math.floor(i.x),m=Math.floor((i.x-u)*d),p=Math.floor(i.y*d),g=this.findDEMTileFor(new Ri(l,u,l,m,p));return!(!g||!g.dem)}getAtPointOrZero(i,s=0){return this.getAtPoint(i,s)||0}getAtPoint(i,s,l=!0){if(this.isUsingMockSource())return null;null==s&&(s=null);const d=this._source();if(!d||i.y<0||i.y>1)return s;const u=d.getSource().maxzoom,m=1<<u,p=Math.floor(i.x),g=i.x-p,_=new Ri(u,p,u,Math.floor(g*m),Math.floor(i.y*m)),y=this.findDEMTileFor(_);if(!y||!y.dem)return s;const v=y.dem,w=1<<y.tileID.canonical.z,C=(g*w-y.tileID.canonical.x)*v.dim,D=(i.y*w-y.tileID.canonical.y)*v.dim,k=Math.floor(C),S=Math.floor(D);return(l?this.exaggeration():1)*_e(_e(v.get(k,S),v.get(k,S+1),D-S),_e(v.get(k+1,S),v.get(k+1,S+1),D-S),C-k)}getAtTileOffset(i,s,l){const d=1<<i.canonical.z;return this.getAtPointOrZero(new Ei(i.wrap+(i.canonical.x+s/pt)/d,(i.canonical.y+l/pt)/d))}getAtTileOffsetFunc(i,s,l,d){return u=>{const m=this.getAtTileOffset(i,u.x,u.y),p=d.upVector(i.canonical,u.x,u.y),g=d.upVectorScale(i.canonical,s,l).metersToTile;return Z.scale(p,p,m*g),p}}getForTilePoints(i,s,l,d){if(this.isUsingMockSource())return!1;const u=zu.create(this,i,d);return!!u&&(s.forEach(m=>{m[2]=this.exaggeration()*u.getElevationAt(m[0],m[1],l)}),!0)}getMinMaxForTile(i){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(i);if(!s||!s.dem)return null;const l=s.dem.tree,d=s.tileID,u=1<<i.canonical.z-d.canonical.z;let m=i.canonical.x/u-d.canonical.x,p=i.canonical.y/u-d.canonical.y,g=0;for(let _=0;_<i.canonical.z-d.canonical.z&&!l.leaves[g];_++){m*=2,p*=2;const y=2*Math.floor(p)+Math.floor(m);g=l.childOffsets[g]+y,m%=1,p%=1}return{min:this.exaggeration()*l.minimums[g],max:this.exaggeration()*l.maximums[g]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,s,l){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const i=this.visibleDemTiles;if(0===i.length)return null;let s=!1,l=Number.MAX_VALUE,d=Number.MIN_VALUE;for(const u of i){const m=this.getMinMaxForTile(u.tileID);m&&(l=Math.min(l,m.min),d=Math.max(d,m.max),s=!0)}return s?{min:l,max:d}:null}}class zu{constructor(i,s,l){this._demTile=i,this._dem=this._demTile.dem,this._scale=s,this._offset=l}static create(i,s,l){const d=l||i.findDEMTileFor(s);if(!d||!d.dem)return;const u=d.dem,m=d.tileID,p=1<<s.canonical.z-m.canonical.z;return new zu(d,u.dim/pt/p,[(s.canonical.x/p-m.canonical.x)*u.dim,(s.canonical.y/p-m.canonical.y)*u.dim])}tileCoordToPixel(i,s){const l=s*this._scale+this._offset[1],d=Math.floor(i*this._scale+this._offset[0]),u=Math.floor(l);return new ot(d,u)}getElevationAt(i,s,l,d){const u=i*this._scale+this._offset[0],m=s*this._scale+this._offset[1],p=Math.floor(u),g=Math.floor(m),_=this._dem;return d=!!d,l?_e(_e(_.get(p,g,d),_.get(p,g+1,d),m-g),_e(_.get(p+1,g,d),_.get(p+1,g+1,d),m-g),u-p):_.get(p,g,d)}getElevationAtPixel(i,s,l){return this._dem.get(i,s,!!l)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*sn(1,i)*this._dem.stride}}class sy{constructor(i,s){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new _i(pt,16,0),this.featureIndexArray=new tx,this.promoteId=s}insert(i,s,l,d,u,m=0){const p=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,d,u,m);const g=this.grid;for(let _=0;_<s.length;_++){const y=s[_],v=[1/0,1/0,-1/0,-1/0];for(let w=0;w<y.length;w++){const C=y[w];v[0]=Math.min(v[0],C.x),v[1]=Math.min(v[1],C.y),v[2]=Math.max(v[2],C.x),v[3]=Math.max(v[3],C.y)}v[0]<pt&&v[1]<pt&&v[2]>=0&&v[3]>=0&&g.insert(p,v[0],v[1],v[2],v[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new rw(new ry(this.rawTileData)).layers,this.sourceLayerCoder=new sw(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,s,l,d){this.loadVTLayers();const u=i.params||{},m=am(u.filter),p=i.tileResult,g=i.transform,_=p.bufferedTilespaceBounds,y=this.grid.query(_.min.x,_.min.y,_.max.x,_.max.y,(D,k,S,E)=>Wb(p.bufferedTilespaceGeometry,D,k,S,E));y.sort(UP);let v=null;g.elevation&&y.length>0&&(v=zu.create(g.elevation,this.tileID));const w={};let C;for(let D=0;D<y.length;D++){const k=y[D];if(k===C)continue;C=k;const S=this.featureIndexArray.get(k);let E=null;this.loadMatchingFeature(w,S,m,u.layers,u.availableImages,s,l,d,(A,P,O,R=0)=>(E||(E=ll(A,this.tileID.canonical,i.tileTransform)),P.queryIntersectsFeature(p,A,O,E,this.z,i.transform,i.pixelPosMatrix,v,R)))}return w}loadMatchingFeature(i,s,l,d,u,m,p,g,_){const{featureIndex:y,bucketIndex:v,sourceLayerIndex:w,layoutVertexArrayOffset:C}=s,D=this.bucketLayerIDs[v];if(d&&!function(A,P){for(let O=0;O<A.length;O++)if(P.indexOf(A[O])>=0)return!0;return!1}(d,D))return;const k=this.sourceLayerCoder.decode(w),S=this.vtLayers[k].feature(y);if(l.needGeometry){const A=ql(S,!0);if(!l.filter(new zn(this.tileID.overscaledZ),A,this.tileID.canonical))return}else if(!l.filter(new zn(this.tileID.overscaledZ),S))return;const E=this.getId(S,k);for(let A=0;A<D.length;A++){const P=D[A];if(d&&d.indexOf(P)<0)continue;const O=m[P];if(!O)continue;let R={};void 0!==E&&g&&(R=g.getState(O.sourceLayer||"_geojsonTileLayer",E));const F=se({},p[P]);F.paint=bS(F.paint,O.paint,S,R,u),F.layout=bS(F.layout,O.layout,S,R,u);const B=!_||_(S,O,R,C);if(!B)continue;const j=new uw(S,this.z,this.x,this.y,E);j.layer=F;let U=i[P];void 0===U&&(U=i[P]=[]),U.push({featureIndex:y,feature:j,intersectionZ:B})}}lookupSymbolFeatures(i,s,l,d,u,m,p,g){const _={};this.loadVTLayers();const y=am(u);for(const v of i)this.loadMatchingFeature(_,{bucketIndex:l,sourceLayerIndex:d,featureIndex:v,layoutVertexArrayOffset:0},y,m,p,g,s);return _}loadFeature(i){const{featureIndex:s,sourceLayerIndex:l}=i;this.loadVTLayers();const d=this.sourceLayerCoder.decode(l),u=this.vtFeatures[d];if(u[s])return u[s];const m=this.vtLayers[d].feature(s);return u[s]=m,m}hasLayer(i){for(const s of this.bucketLayerIDs)for(const l of s)if(i===l)return!0;return!1}getId(i,s){let l=i.id;if(this.promoteId){const d="string"==typeof this.promoteId?this.promoteId:this.promoteId[s];null!=d&&(l=i.properties[d]),"boolean"==typeof l&&(l=Number(l))}return l}}function bS(o,i,s,l,d){return Vh(o,(u,m)=>{const p=i instanceof _u?i.get(m):null;return p&&p.evaluate?p.evaluate(s,l,d):p})}function UP(o,i){return i-o}de(sy,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const HP=Xe([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),$P=Xe([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),yS=Xe([{name:"a_projected_pos",components:4,type:"Float32"}],4);Xe([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Y3=Xe([{name:"a_z_offset",components:1,type:"Float32"}],4),GP=Xe([{name:"a_texb",components:2,type:"Uint16"}]),Z3=Xe([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),X3=Xe([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);Xe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const pw=Xe([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),vS=Xe([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Xe([{name:"triangle",components:3,type:"Uint16"}]),Xe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Xe([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Xe([{type:"Float32",name:"offsetX"}]),Xe([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var so=24;const Ns=128;function ay(o,i){const{expression:s}=i;if("constant"===s.kind)return{kind:"constant",layoutSize:s.evaluate(new zn(o+1))};if("source"===s.kind)return{kind:"source"};{const{zoomStops:l,interpolationType:d}=s;let u=0;for(;u<l.length&&l[u]<=o;)u++;u=Math.max(0,u-1);let m=u;for(;m<l.length&&l[m]<o+1;)m++;m=Math.min(l.length-1,m);const p=l[u],g=l[m];return"composite"===s.kind?{kind:"composite",minZoom:p,maxZoom:g,interpolationType:d}:{kind:"camera",minZoom:p,maxZoom:g,minSize:s.evaluate(new zn(p)),maxSize:s.evaluate(new zn(g)),interpolationType:d}}}function Im(o,{uSize:i,uSizeT:s},{lowerSize:l,upperSize:d}){return"source"===o.kind?l/Ns:"composite"===o.kind?_e(l/Ns,d/Ns,s):i}function Xl(o,i){let s=0,l=0;if("constant"===o.kind)l=o.layoutSize;else if("source"!==o.kind){const{interpolationType:d,minZoom:u,maxZoom:m}=o,p=d?he(Es.interpolationFactor(d,i,u,m),0,1):0;"camera"===o.kind?l=_e(o.minSize,o.maxSize,p):s=p}return{uSizeT:s,uSize:l}}var xS=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ns,evaluateSizeForFeature:Im,evaluateSizeForZoom:Xl,getSizeData:ay});function wS(o,i,s){return o.sections.forEach(l=>{l.text=function(d,u,m){const p=u.layout.get("text-transform").evaluate(m,{});return"uppercase"===p?d=d.toLocaleUpperCase():"lowercase"===p&&(d=d.toLocaleLowerCase()),ro.applyArabicShaping&&(d=ro.applyArabicShaping(d)),d}(l.text,i,s)}),o}const Oi={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function St(o){return"\ufe36"===o||"\ufe48"===o||"\ufe38"===o||"\ufe44"===o||"\ufe42"===o||"\ufe3e"===o||"\ufe3c"===o||"\ufe3a"===o||"\ufe18"===o||"\ufe40"===o||"\ufe10"===o||"\ufe13"===o||"\ufe14"===o||"\uff40"===o||"\uffe3"===o||"\ufe11"===o||"\ufe12"===o}function CS(o){return"\ufe35"===o||"\ufe47"===o||"\ufe37"===o||"\ufe43"===o||"\ufe41"===o||"\ufe3d"===o||"\ufe3b"===o||"\ufe39"===o||"\ufe17"===o||"\ufe3f"===o}const z=3;function dl(o,i,s){i.glyphs=[],1===o&&s.readMessage(WP,i)}function WP(o,i,s){if(3===o){const{id:l,bitmap:d,width:u,height:m,left:p,top:g,advance:_}=s.readMessage(ly,{});i.glyphs.push({id:l,bitmap:new cl({width:u+2*z,height:m+2*z},d),metrics:{width:u,height:m,left:p,top:g,advance:_}})}else 4===o?i.ascender=s.readSVarint():5===o&&(i.descender=s.readSVarint())}function ly(o,i,s){1===o?i.id=s.readVarint():2===o?i.bitmap=s.readBytes():3===o?i.width=s.readVarint():4===o?i.height=s.readVarint():5===o?i.left=s.readSVarint():6===o?i.top=s.readSVarint():7===o&&(i.advance=s.readVarint())}const Vu=z,On={horizontal:1,vertical:2,horizontalOnly:3},Rm=-17;class Pm{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,s){const l=new Pm;return l.scale=i||1,l.fontStack=s,l}static forImage(i){const s=new Pm;return s.imageName=i,s}}class Fd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,s){const l=new Fd;for(let d=0;d<i.sections.length;d++){const u=i.sections[d];u.image?l.addImageSection(u):l.addTextSection(u,s)}return l}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCodePoint(i){return this.text.codePointAt(i)}verticalizePunctuation(i){this.text=function(s,l){let d="";for(let u=0;u<s.length;u++){const m=s.charCodeAt(u+1)||null,p=s.charCodeAt(u-1)||null;d+=!l&&(m&&UD(m)&&!Oi[s[u+1]]||p&&UD(p)&&!Oi[s[u-1]])||!Oi[s[u]]?s[u]:Oi[s[u]]}return d}(this.text,i)}trim(){let i=0;for(let l=0;l<this.text.length&&Om[this.text.charCodeAt(l)];l++)i++;let s=this.text.length;for(let l=this.text.length-1;l>=0&&l>=i&&Om[this.text.charCodeAt(l)];l--)s--;this.text=this.text.substring(i,s),this.sectionIndex=this.sectionIndex.slice(i,s)}substring(i,s){const l=new Fd;return l.text=this.text.substring(i,s),l.sectionIndex=this.sectionIndex.slice(i,s),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,s)=>Math.max(i,this.sections[s].scale),0)}addTextSection(i,s){this.text+=i.text,this.sections.push(Pm.forText(i.scale,i.fontStack||s));const l=this.sections.length-1;for(let d=0;d<i.text.length;++d)this.sectionIndex.push(l)}addImageSection(i){const s=i.image?i.image.namePrimary:"";if(0===s.length)return void rt("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCodePoint(l),this.sections.push(Pm.forImage(s)),this.sectionIndex.push(this.sections.length-1)):rt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function dg(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D){const k=Fd.fromFeature(o,d);v===On.vertical&&k.verticalizePunctuation(w);let S=[];const E=function(F,B,j,U,H,W){if(!F)return[];const q=[],X=function(st,J,et,dt,mt,ut){let bt=0;for(let yt=0;yt<st.length();yt++){const Ct=st.getSection(yt);bt+=cy(st.getCodePoint(yt),Ct,dt,mt,J,ut)}return bt/Math.max(1,Math.ceil(bt/et))}(F,B,j,U,H,W),G=F.text.indexOf("\u200b")>=0;let Q=0;for(let st=0;st<F.length();st++){const J=F.getSection(st),et=F.getCodePoint(st);if(Om[et]||(Q+=cy(et,J,U,H,B,W)),st<F.length()-1){const dt=!((it=et)<11904||!(ue["Bopomofo Extended"](it)||ue.Bopomofo(it)||ue["CJK Compatibility Forms"](it)||ue["CJK Compatibility Ideographs"](it)||ue["CJK Compatibility"](it)||ue["CJK Radicals Supplement"](it)||ue["CJK Strokes"](it)||ue["CJK Symbols and Punctuation"](it)||ue["CJK Unified Ideographs Extension A"](it)||ue["CJK Unified Ideographs"](it)||ue["Enclosed CJK Letters and Months"](it)||ue["Halfwidth and Fullwidth Forms"](it)||ue.Hiragana(it)||ue["Ideographic Description Characters"](it)||ue["Kangxi Radicals"](it)||ue["Katakana Phonetic Extensions"](it)||ue.Katakana(it)||ue["Vertical Forms"](it)||ue["Yi Radicals"](it)||ue["Yi Syllables"](it)));(MS[et]||dt||J.imageName)&&q.push(kS(st+1,Q,X,q,qP(et,F.getCodePoint(st+1),dt&&G),!1))}}var it;return fw(kS(F.length(),Q,X,q,0,!0))}(k,_,u,i,l,C),{processBidirectionalText:A,processStyledBidirectionalText:P}=ro;if(A&&1===k.sections.length){const F=A(k.toString(),E);for(const B of F){const j=new Fd;j.text=B,j.sections=k.sections;for(let U=0;U<B.length;U++)j.sectionIndex.push(0);S.push(j)}}else if(P){const F=P(k.text,k.sectionIndex,E);for(const B of F){const j=new Fd;j.text=B[0],j.sectionIndex=B[1],j.sections=k.sections,S.push(j)}}else S=function(F,B){const j=[],U=F.text;let H=0;for(const W of B)j.push(F.substring(H,W)),H=W;return H<U.length&&j.push(F.substring(H,U.length)),j}(k,E);const O=[],R={positionedLines:O,text:k.toString(),top:y[1],bottom:y[1],left:y[0],right:y[0],writingMode:v,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(F,B,j,U,H,W,q,X,G,Q,it,st){let J=0,et=0,dt=0;const mt="right"===X?1:"left"===X?0:.5;let ut=!1;for(const Gt of H){const Et=Gt.getSections();for(const te of Et){if(te.imageName)continue;const ie=B[te.fontStack];if(ie&&(ut=void 0!==ie.ascender&&void 0!==ie.descender,!ut))break}if(!ut)break}let bt=0;for(const Gt of H){Gt.trim();const Et=Gt.getMaxScale(),te=(Et-1)*so,ie={positionedGlyphs:[],lineOffset:0};F.positionedLines[bt]=ie;const He=ie.positionedGlyphs;let ve=0;if(!Gt.length()){et+=W,++bt;continue}let Ui=0,xi=0;for(let ze=0;ze<Gt.length();ze++){const Ce=Gt.getSection(ze),wi=Gt.getSectionIndex(ze),Pi=Gt.getCodePoint(ze);let ci=Ce.scale,Gi=null,ir=null,tn=null,Mn=so,mr=0;const Zn=!(G===On.horizontal||!it&&!G0(Pi)||it&&(Om[Pi]||(yt=Pi,ue.Arabic(yt)||ue["Arabic Supplement"](yt)||ue["Arabic Extended-A"](yt)||ue["Arabic Presentation Forms-A"](yt)||ue["Arabic Presentation Forms-B"](yt))));if(Ce.imageName){const kn=U[Ce.imageName];if(!kn)continue;tn=Ce.imageName,F.iconsInText=F.iconsInText||!0,ir=kn.paddedRect;const Xi=kn.displaySize;ci=ci*so/st,Gi={width:Xi[0],height:Xi[1],left:0,top:-Vu,advance:Zn?Xi[1]:Xi[0],localGlyph:!1},mr=ut?-Gi.height*ci:Rm+Et*so-Xi[1]*ci,Mn=Gi.advance;const xo=(Zn?Xi[0]:Xi[1])*ci-so*Et;xo>0&&xo>ve&&(ve=xo)}else{const kn=j[Ce.fontStack];if(!kn)continue;kn[Pi]&&(ir=kn[Pi]);const Xi=B[Ce.fontStack];if(!Xi)continue;const xo=Xi.glyphs[Pi];if(!xo)continue;if(Gi=xo.metrics,Mn=8203!==Pi?so:0,ut){const $c=void 0!==Xi.ascender?Math.abs(Xi.ascender):0,Vd=void 0!==Xi.descender?Math.abs(Xi.descender):0,oc=($c+Vd)*ci;Ui<oc&&(Ui=oc,xi=($c-Vd)/2*ci),mr=-$c*ci}else mr=Rm+(Et-ci)*so}Zn?(F.verticalizable=!0,He.push({glyph:Pi,imageName:tn,x:J,y:et+mr,vertical:Zn,scale:ci,localGlyph:Gi.localGlyph,fontStack:Ce.fontStack,sectionIndex:wi,metrics:Gi,rect:ir}),J+=Mn*ci+Q):(He.push({glyph:Pi,imageName:tn,x:J,y:et+mr,vertical:Zn,scale:ci,localGlyph:Gi.localGlyph,fontStack:Ce.fontStack,sectionIndex:wi,metrics:Gi,rect:ir}),J+=Gi.advance*ci+Q)}0!==He.length&&(dt=Math.max(J-Q,dt),ut?SS(He,mt,ve,xi,W*Et/2):SS(He,mt,ve,0,W/2)),J=0;const $e=W*Et+ve;ie.lineOffset=Math.max(ve,te),et+=$e,++bt}var yt;const Ct=et,{horizontalAlign:gt,verticalAlign:At}=dy(q);(function(Gt,Et,te,ie,He,ve){const Ui=(Et-te)*He,xi=-ve*ie;for(const $e of Gt)for(const ze of $e.positionedGlyphs)ze.x+=Ui,ze.y+=xi})(F.positionedLines,mt,gt,At,dt,Ct),F.top+=-At*Ct,F.bottom=F.top+Ct,F.left+=-gt*dt,F.right=F.left+dt,F.hasBaseline=ut}(R,i,s,l,S,m,p,g,v,_,w,D),!function(F){for(const B of F)if(0!==B.positionedGlyphs.length)return!1;return!0}(O)&&R}const Om={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},MS={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function cy(o,i,s,l,d,u){if(i.imageName){const m=l[i.imageName];return m?m.displaySize[0]*i.scale*so/u+d:0}{const m=s[i.fontStack],p=m&&m.glyphs[o];return p?p.metrics.advance*i.scale+d:0}}function DS(o,i,s,l){const d=Math.pow(o-i,2);return l?o<i?d/2:2*d:d+Math.abs(s)*s}function qP(o,i,s){let l=0;return 10===o&&(l-=1e4),s&&(l+=150),40!==o&&65288!==o||(l+=50),41!==i&&65289!==i||(l+=50),l}function kS(o,i,s,l,d,u){let m=null,p=DS(i,s,d,u);for(const g of l){const _=DS(i-g.x,s,d,u)+g.badness;_<=p&&(m=g,p=_)}return{index:o,x:i,priorBreak:m,badness:p}}function fw(o){return o?fw(o.priorBreak).concat(o.index):[]}function dy(o){let i=.5,s=.5;switch(o){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:i,verticalAlign:s}}function SS(o,i,s,l,d){if(!(i||s||l||d))return;const u=o.length-1,m=o[u],p=(m.x+m.metrics.advance*m.scale)*i;for(let g=0;g<=u;g++)o[g].x-=p,o[g].y+=s+l+d}function YP(o,i,s,l){const{horizontalAlign:d,verticalAlign:u}=dy(l),m=s[0]-o.displaySize[0]*d,p=s[1]-o.displaySize[1]*u;return{imagePrimary:o,imageSecondary:i,top:p,bottom:p+o.displaySize[1],left:m,right:m+o.displaySize[0]}}function TS(o,i,s,l,d,u){const m=o.imagePrimary;let p;if(m.content){const S=m.content,E=m.pixelRatio||1;p=[S[0]/E,S[1]/E,m.displaySize[0]-S[2]/E,m.displaySize[1]-S[3]/E]}const g=i.left*u,_=i.right*u;let y,v,w,C;"width"===s||"both"===s?(C=d[0]+g-l[3],v=d[0]+_+l[1]):(C=d[0]+(g+_-m.displaySize[0])/2,v=C+m.displaySize[0]);const D=i.top*u,k=i.bottom*u;return"height"===s||"both"===s?(y=d[1]+D-l[0],w=d[1]+k+l[2]):(y=d[1]+(D+k-m.displaySize[1])/2,w=y+m.displaySize[1]),{imagePrimary:m,imageSecondary:void 0,top:y,right:v,bottom:w,left:C,collisionPadding:p}}class Kl extends ot{constructor(i,s,l,d,u){super(i,s),this.angle=d,this.z=l,void 0!==u&&(this.segment=u)}clone(){return new Kl(this.x,this.y,this.z,this.angle,this.segment)}}function gw(o,i,s,l,d){if(void 0===i.segment)return!0;let u=i,m=i.segment+1,p=0;for(;p>-s/2;){if(m--,m<0)return!1;p-=o[m].dist(u),u=o[m]}p+=o[m].dist(o[m+1]),m++;const g=[];let _=0;for(;p<s/2;){const y=o[m],v=o[m+1];if(!v)return!1;let w=o[m-1].angleTo(y)-y.angleTo(v);for(w=Math.abs((w+3*Math.PI)%(2*Math.PI)-Math.PI),g.push({distance:p,angleDelta:w}),_+=w;p-g[0].distance>l;)_-=g.shift().angleDelta;if(_>d)return!1;m++,p+=y.dist(v)}return!0}function ES(o){let i=0;for(let s=0;s<o.length-1;s++)i+=o[s].dist(o[s+1]);return i}function AS(o,i,s){return o?.6*i*s:0}function zs(o,i){return Math.max(o?o.right-o.left:0,i?i.right-i.left:0)}function ZP(o,i,s,l,d,u){const m=AS(s,d,u),p=zs(s,l)*u;let g=0;const _=ES(o)/2;for(let y=0;y<o.length-1;y++){const v=o[y],w=o[y+1],C=v.dist(w);if(g+C>_){const D=(_-g)/C,k=_e(v.x,w.x,D),S=_e(v.y,w.y,D),E=new Kl(k,S,0,w.angleTo(v),y);return!m||gw(o,E,p,m,i)?E:void 0}g+=C}}function XP(o,i,s,l,d,u,m,p,g){const _=AS(l,u,m),y=zs(l,d),v=y*m,w=0===o[0].x||o[0].x===g||0===o[0].y||o[0].y===g;return i-v<i/4&&(i=v+i/4),KP(o,w?i/2*p%i:(y/2+2*u)*m*p%i,i,_,s,v,w,!1,g)}function KP(o,i,s,l,d,u,m,p,g){const _=u/2,y=ES(o);let v=0,w=i-s,C=[];for(let D=0;D<o.length-1;D++){const k=o[D],S=o[D+1],E=k.dist(S),A=S.angleTo(k);for(;w+s<v+E;){w+=s;const P=(w-v)/E,O=_e(k.x,S.x,P),R=_e(k.y,S.y,P);if(O>=0&&O<g&&R>=0&&R<g&&w-_>=0&&w+_<=y){const F=new Kl(O,R,0,A,D);l&&!gw(o,F,u,l,d)||C.push(F)}}v+=E}return p||C.length||m||(C=KP(o,v/2,s,l,d,u,m,!0,g)),C}function uy(o,i,s,l,d){const u=[];for(let m=0;m<o.length;m++){const p=o[m];let g;for(let _=0;_<p.length-1;_++){let y=p[_],v=p[_+1];y.x<i&&v.x<i||(y.x<i?y=new ot(i,y.y+(i-y.x)/(v.x-y.x)*(v.y-y.y))._round():v.x<i&&(v=new ot(i,y.y+(i-y.x)/(v.x-y.x)*(v.y-y.y))._round()),y.y<s&&v.y<s||(y.y<s?y=new ot(y.x+(s-y.y)/(v.y-y.y)*(v.x-y.x),s)._round():v.y<s&&(v=new ot(y.x+(s-y.y)/(v.y-y.y)*(v.x-y.x),s)._round()),y.x>=l&&v.x>=l||(y.x>=l?y=new ot(l,y.y+(l-y.x)/(v.x-y.x)*(v.y-y.y))._round():v.x>=l&&(v=new ot(l,y.y+(l-y.x)/(v.x-y.x)*(v.y-y.y))._round()),y.y>=d&&v.y>=d||(y.y>=d?y=new ot(y.x+(d-y.y)/(v.y-y.y)*(v.x-y.x),d)._round():v.y>=d&&(v=new ot(y.x+(d-y.y)/(v.y-y.y)*(v.x-y.x),d)._round()),g&&y.equals(g[g.length-1])||(g=[y],u.push(g)),g.push(v)))))}}return u}function hy(o){let i=0,s=0;for(const m of o)i+=m.w*m.h,s=Math.max(s,m.w);o.sort((m,p)=>p.h-m.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),s),h:1/0}];let d=0,u=0;for(const m of o)for(let p=l.length-1;p>=0;p--){const g=l[p];if(!(m.w>g.w||m.h>g.h)){if(m.x=g.x,m.y=g.y,u=Math.max(u,m.y+m.h),d=Math.max(d,m.x+m.w),m.w===g.w&&m.h===g.h){const _=l.pop();p<l.length&&(l[p]=_)}else m.h===g.h?(g.x+=m.w,g.w-=m.w):m.w===g.w?(g.y+=m.h,g.h-=m.h):(l.push({x:g.x+m.w,y:g.y,w:g.w-m.w,h:m.h}),g.y+=m.h,g.h-=m.h);break}}return{w:d,h:u,fill:i/(d*u)||0}}de(Kl,"Anchor");const Vs=1;class _w{constructor(i,{pixelRatio:s,version:l,stretchX:d,stretchY:u,content:m}){this.paddedRect=i,this.pixelRatio=s,this.stretchX=d,this.stretchY=u,this.content=m,this.version=l}get tl(){return[this.paddedRect.x+Vs,this.paddedRect.y+Vs]}get br(){return[this.paddedRect.x+this.paddedRect.w-Vs,this.paddedRect.y+this.paddedRect.h-Vs]}get displaySize(){return[(this.paddedRect.w-2*Vs)/this.pixelRatio,(this.paddedRect.h-2*Vs)/this.pixelRatio]}}class IS{constructor(i,s){const l={},d={};this.haveRenderCallbacks=[];const u=[];this.addImages(i,l,u),this.addImages(s,d,u);const{w:m,h:p}=hy(u),g=new _r({width:m||1,height:p||1});for(const _ in i){const y=i[_],v=l[_].paddedRect;_r.copy(y.data,g,{x:0,y:0},{x:v.x+Vs,y:v.y+Vs},y.data)}for(const _ in s){const y=s[_],v=d[_].paddedRect,w=v.x+Vs,C=v.y+Vs,D=y.data.width,k=y.data.height;_r.copy(y.data,g,{x:0,y:0},{x:w,y:C},y.data),_r.copy(y.data,g,{x:0,y:k-1},{x:w,y:C-1},{width:D,height:1}),_r.copy(y.data,g,{x:0,y:0},{x:w,y:C+k},{width:D,height:1}),_r.copy(y.data,g,{x:D-1,y:0},{x:w-1,y:C},{width:1,height:k}),_r.copy(y.data,g,{x:0,y:0},{x:w+D,y:C},{width:1,height:k})}this.image=g,this.iconPositions=l,this.patternPositions=d}addImages(i,s,l){for(const d in i){const u=i[d],m={x:0,y:0,w:u.data.width+2*Vs,h:u.data.height+2*Vs};l.push(m),s[d]=new _w(m,u),u.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(i,s,l){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(d=>i.hasImage(d,l)),i.dispatchRenderCallbacks(this.haveRenderCallbacks,l);for(const d in i.getUpdatedImages(l))this.patchUpdatedImage(this.iconPositions[d],i.getImage(d,l),s),this.patchUpdatedImage(this.patternPositions[d],i.getImage(d,l),s)}patchUpdatedImage(i,s,l){if(!i||!s||i.version===s.version)return;i.version=s.version;const[d,u]=i.tl;l.update(s.data,void 0,{x:d,y:u})}}de(_w,"ImagePosition"),de(IS,"ImageAtlas");const Fm=1e20;function RS(o,i,s,l,d,u,m,p,g){for(let _=i;_<i+l;_++)PS(o,s*u+_,u,d,m,p,g);for(let _=s;_<s+d;_++)PS(o,_*u+i,1,l,m,p,g)}function PS(o,i,s,l,d,u,m){u[0]=0,m[0]=-Fm,m[1]=Fm,d[0]=o[i];for(let p=1,g=0,_=0;p<l;p++){d[p]=o[i+p*s];const y=p*p;do{const v=u[g];_=(d[p]-d[v]+y-v*v)/(p-v)/2}while(_<=m[g]&&--g>-1);g++,u[g]=p,m[g]=_,m[g+1]=Fm}for(let p=0,g=0;p<l;p++){for(;m[g+1]<p;)g++;const _=u[g],y=p-_;o[i+p*s]=d[_]+y*y}}const ua=2;class Lm{constructor(i,s,l){this.requestManager=i,this.localGlyphMode=s,this.localFontFamily=l,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i,s){this.urls[s]=i}getGlyphs(i,s,l){const d=[],u=this.urls[s]||mi.GLYPHS_URL;for(const m in i)for(const p of i[m])d.push({stack:m,id:p});tu(d,({stack:m,id:p},g)=>{let _=this.entries[m];_||(_=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let y=_.glyphs[p];if(void 0!==y)return void g(null,{stack:m,id:p,glyph:y});if(y=this._tinySDF(_,m,p),y)return _.glyphs[p]=y,void g(null,{stack:m,id:p,glyph:y});const v=Math.floor(p/256);if(256*v>65535)return void g(new Error("glyphs > 65535 not supported"));if(_.ranges[v])return void g(null,{stack:m,id:p,glyph:y});let w=_.requests[v];w||(w=_.requests[v]=[],Lm.loadGlyphRange(m,v,u,this.requestManager,(C,D)=>{if(D){_.ascender=D.ascender,_.descender=D.descender;for(const k in D.glyphs)this._doesCharSupportLocalGlyph(+k)||(_.glyphs[+k]=D.glyphs[+k]);_.ranges[v]=!0}for(const k of w)k(C,D);delete _.requests[v]})),w.push((C,D)=>{C?g(C):D&&g(null,{stack:m,id:p,glyph:D.glyphs[p]||null})})},(m,p)=>{if(m)l(m);else if(p){const g={};for(const{stack:_,id:y,glyph:v}of p)void 0===g[_]&&(g[_]={}),void 0===g[_].glyphs&&(g[_].glyphs={}),g[_].glyphs[y]=v&&{id:v.id,bitmap:v.bitmap.clone(),metrics:v.metrics},g[_].ascender=this.entries[_].ascender,g[_].descender=this.entries[_].descender;l(null,g)}})}_doesCharSupportLocalGlyph(i){return 0!==this.localGlyphMode&&(2===this.localGlyphMode?!!this.localFontFamily:!!this.localFontFamily&&(ue["CJK Unified Ideographs"](i)||ue["Hangul Syllables"](i)||ue.Hiragana(i)||ue.Katakana(i)||ue["CJK Symbols and Punctuation"](i)||ue["CJK Unified Ideographs Extension A"](i)||ue["CJK Unified Ideographs Extension B"](i)))}_tinySDF(i,s,l){const d=this.localFontFamily;if(!d||!this._doesCharSupportLocalGlyph(l))return;let u=i.tinySDF;if(!u){let k="400";/bold/i.test(s)?k="900":/medium/i.test(s)?k="500":/light/i.test(s)&&(k="200"),u=i.tinySDF=new Lm.TinySDF({fontFamily:d,fontWeight:k,fontSize:24*ua,buffer:3*ua,radius:8*ua}),u.fontWeight=k}if(this.localGlyphs[u.fontWeight][l])return this.localGlyphs[u.fontWeight][l];const m=String.fromCodePoint(l),{data:p,width:g,height:_,glyphWidth:y,glyphHeight:v,glyphLeft:w,glyphTop:C,glyphAdvance:D}=u.draw(m);return this.localGlyphs[u.fontWeight][l]={id:l,bitmap:new cl({width:g,height:_},p),metrics:{width:y/ua,height:v/ua,left:w/ua,top:C/ua-27,advance:D/ua,localGlyph:!0}}}}Lm.loadGlyphRange=function(o,i,s,l,d){const u=256*i,m=u+255,p=l.transformRequest(l.normalizeGlyphsURL(s).replace("{fontstack}",o).replace("{range}",`${u}-${m}`),xt.Glyphs);qt(p,(g,_)=>{if(g)d(g);else if(_){const y={},v=new ry(_).readFields(dl,{});for(const w of v.glyphs)y[w.id]=w;d(null,{glyphs:y,ascender:v.ascender,descender:v.descender})}})},Lm.TinySDF=class{constructor({fontSize:o=24,buffer:i=3,radius:s=8,cutoff:l=.25,fontFamily:d="sans-serif",fontWeight:u="normal",fontStyle:m="normal"}={}){this.buffer=i,this.cutoff=l,this.radius=s;const p=this.size=o+4*i,g=this._createCanvas(p),_=this.ctx=g.getContext("2d",{willReadFrequently:!0});_.font=`${m} ${u} ${o}px ${d}`,_.textBaseline="alphabetic",_.textAlign="left",_.fillStyle="black",this.gridOuter=new Float64Array(p*p),this.gridInner=new Float64Array(p*p),this.f=new Float64Array(p),this.z=new Float64Array(p+1),this.v=new Uint16Array(p)}_createCanvas(o){const i=document.createElement("canvas");return i.width=i.height=o,i}draw(o){const{width:i,actualBoundingBoxAscent:s,actualBoundingBoxDescent:l,actualBoundingBoxLeft:d,actualBoundingBoxRight:u}=this.ctx.measureText(o),m=Math.ceil(s),p=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(u-d))),g=Math.min(this.size-this.buffer,m+Math.ceil(l)),_=p+2*this.buffer,y=g+2*this.buffer,v=Math.max(_*y,0),w=new Uint8ClampedArray(v),C={data:w,width:_,height:y,glyphWidth:p,glyphHeight:g,glyphTop:m,glyphLeft:0,glyphAdvance:i};if(0===p||0===g)return C;const{ctx:D,buffer:k,gridInner:S,gridOuter:E}=this;D.clearRect(k,k,p,g),D.fillText(o,k,k+m);const A=D.getImageData(k,k,p,g);E.fill(Fm,0,v),S.fill(0,0,v);for(let P=0;P<g;P++)for(let O=0;O<p;O++){const R=A.data[4*(P*p+O)+3]/255;if(0===R)continue;const F=(P+k)*_+O+k;if(1===R)E[F]=0,S[F]=Fm;else{const B=.5-R;E[F]=B>0?B*B:0,S[F]=B<0?B*B:0}}RS(E,0,0,_,y,_,this.f,this.v,this.z),RS(S,k,k,p,g,_,this.f,this.v,this.z);for(let P=0;P<v;P++){const O=Math.sqrt(E[P])-Math.sqrt(S[P]);w[P]=Math.round(255-255*(O/this.radius+this.cutoff))}return C}};const Ld=Vs;function OS(o,i,s,l){const d=[],u=o.imagePrimary,m=u.pixelRatio,p=u.paddedRect.w-2*Ld,g=u.paddedRect.h-2*Ld,_=o.right-o.left,y=o.bottom-o.top,v=u.stretchX||[[0,p]],w=u.stretchY||[[0,g]],C=(W,q)=>W+q[1]-q[0],D=v.reduce(C,0),k=w.reduce(C,0),S=p-D,E=g-k;let A=0,P=D,O=0,R=k,F=0,B=S,j=0,U=E;if(u.content&&l){const W=u.content;A=my(v,0,W[0]),O=my(w,0,W[1]),P=my(v,W[0],W[2]),R=my(w,W[1],W[3]),F=W[0]-A,j=W[1]-O,B=W[2]-W[0]-P,U=W[3]-W[1]-R}const H=(W,q,X,G)=>{const Q=ha(W.stretch-A,P,_,o.left),it=Bm(W.fixed-F,B,W.stretch,D),st=ha(q.stretch-O,R,y,o.top),J=Bm(q.fixed-j,U,q.stretch,k),et=ha(X.stretch-A,P,_,o.left),dt=Bm(X.fixed-F,B,X.stretch,D),mt=ha(G.stretch-O,R,y,o.top),ut=Bm(G.fixed-j,U,G.stretch,k),bt=new ot(Q,st),yt=new ot(et,st),Ct=new ot(et,mt),gt=new ot(Q,mt),At=new ot(it/m,J/m),Gt=new ot(dt/m,ut/m),Et=i*Math.PI/180;if(Et){const xi=Math.sin(Et),$e=Math.cos(Et),ze=[$e,-xi,xi,$e];bt._matMult(ze),yt._matMult(ze),gt._matMult(ze),Ct._matMult(ze)}const te=W.stretch+W.fixed,ie=X.stretch+X.fixed,He=q.stretch+q.fixed,ve=G.stretch+G.fixed,Ui=o.imageSecondary;return{tl:bt,tr:yt,bl:gt,br:Ct,texPrimary:{x:u.paddedRect.x+Ld+te,y:u.paddedRect.y+Ld+He,w:ie-te,h:ve-He},texSecondary:Ui?{x:Ui.paddedRect.x+Ld+te,y:Ui.paddedRect.y+Ld+He,w:ie-te,h:ve-He}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:At,pixelOffsetBR:Gt,minFontScaleX:B/m/_,minFontScaleY:U/m/y,isSDF:s}};if(l&&(u.stretchX||u.stretchY)){const W=FS(v,S,D),q=FS(w,E,k);for(let X=0;X<W.length-1;X++){const G=W[X],Q=W[X+1];for(let it=0;it<q.length-1;it++)d.push(H(G,q[it],Q,q[it+1]))}}else d.push(H({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:p+1},{fixed:0,stretch:g+1}));return d}function my(o,i,s){let l=0;for(const d of o)l+=Math.max(i,Math.min(s,d[1]))-Math.max(i,Math.min(s,d[0]));return l}function FS(o,i,s){const l=[{fixed:-Ld,stretch:0}];for(const[d,u]of o){const m=l[l.length-1];l.push({fixed:d-m.stretch,stretch:m.stretch}),l.push({fixed:d-m.stretch,stretch:m.stretch+(u-d)})}return l.push({fixed:i+Ld,stretch:s}),l}function ha(o,i,s,l){return o/i*s+l}function Bm(o,i,s,l){return o-i*s/l}function QP(o,i,s,l){const d=i+o.positionedLines[l].lineOffset;return 0===l?s+d/2:s+(d+(i+o.positionedLines[l-1].lineOffset))/2}function LS(o,i=1,s=!1){let l=1/0,d=1/0,u=-1/0,m=-1/0;const p=o[0];for(let C=0;C<p.length;C++){const D=p[C];(!C||D.x<l)&&(l=D.x),(!C||D.y<d)&&(d=D.y),(!C||D.x>u)&&(u=D.x),(!C||D.y>m)&&(m=D.y)}const g=Math.min(u-l,m-d);let _=g/2;const y=new ou([],JP);if(0===g)return new ot(l,d);for(let C=l;C<u;C+=g)for(let D=d;D<m;D+=g)y.push(new ju(C+_,D+_,_,o));let v=function(C){let D=0,k=0,S=0;const E=C[0];for(let A=0,P=E.length,O=P-1;A<P;O=A++){const R=E[A],F=E[O],B=R.x*F.y-F.x*R.y;k+=(R.x+F.x)*B,S+=(R.y+F.y)*B,D+=3*B}return new ju(k/D,S/D,0,C)}(o),w=y.length;for(;y.length;){const C=y.pop();(C.d>v.d||!v.d)&&(v=C,s&&console.log("found best %d after %d probes",Math.round(1e4*C.d)/1e4,w)),C.max-v.d<=i||(_=C.h/2,y.push(new ju(C.p.x-_,C.p.y-_,_,o)),y.push(new ju(C.p.x+_,C.p.y-_,_,o)),y.push(new ju(C.p.x-_,C.p.y+_,_,o)),y.push(new ju(C.p.x+_,C.p.y+_,_,o)),w+=4)}return s&&(console.log(`num probes: ${w}`),console.log(`best distance: ${v.d}`)),v.p}function JP(o,i){return i.max-o.max}class ju{constructor(i,s,l,d){this.p=new ot(i,s),this.h=l,this.d=function(u,m){let p=!1,g=1/0;for(let _=0;_<m.length;_++){const y=m[_];for(let v=0,w=y.length,C=w-1;v<w;C=v++){const D=y[v],k=y[C];D.y>u.y!=k.y>u.y&&u.x<(k.x-D.x)*(u.y-D.y)/(k.y-D.y)+D.x&&(p=!p),g=Math.min(g,$x(u,D,k))}}return(p?1:-1)*Math.sqrt(g)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}}const Uu=7,Nm=Number.POSITIVE_INFINITY,bw=Math.sqrt(2);function BS(o,[i,s]){let l=0,d=0;if(s===Nm){i<0&&(i=0);const u=i/bw;switch(o){case"top-right":case"top-left":d=u-Uu;break;case"bottom-right":case"bottom-left":d=-u+Uu;break;case"bottom":d=-i+Uu;break;case"top":d=i-Uu}switch(o){case"top-right":case"bottom-right":l=-u;break;case"top-left":case"bottom-left":l=u;break;case"left":l=i;break;case"right":l=-i}}else{switch(i=Math.abs(i),s=Math.abs(s),o){case"top-right":case"top-left":case"top":d=s-Uu;break;case"bottom-right":case"bottom-left":case"bottom":d=-s+Uu}switch(o){case"top-right":case"bottom-right":case"right":l=-i;break;case"top-left":case"bottom-left":case"left":l=i}}return[l,d]}function NS(o,i,s,l,d,u,m,p,g,_,y){o.createArrays(),o.tilePixelRatio=pt/(512*o.overscaling),o.compareText={},o.iconsNeedLinear=!1;const v=o.layers[0].layout,w=o.layers[0]._unevaluatedLayout._values,C={};if("composite"===o.textSizeData.kind){const{minZoom:E,maxZoom:A}=o.textSizeData;C.compositeTextSizes=[w["text-size"].possiblyEvaluate(new zn(E),p),w["text-size"].possiblyEvaluate(new zn(A),p)]}if("composite"===o.iconSizeData.kind){const{minZoom:E,maxZoom:A}=o.iconSizeData;C.compositeIconSizes=[w["icon-size"].possiblyEvaluate(new zn(E),p),w["icon-size"].possiblyEvaluate(new zn(A),p)]}C.layoutTextSize=w["text-size"].possiblyEvaluate(new zn(g+1),p),C.layoutIconSize=w["icon-size"].possiblyEvaluate(new zn(g+1),p),C.textMaxSize=w["text-size"].possiblyEvaluate(new zn(18),p);const D="map"===v.get("text-rotation-alignment")&&"point"!==v.get("symbol-placement"),k=v.get("text-size");let S=!1;for(const E of o.features)if(E.icon&&E.icon.nameSecondary){S=!0;break}for(const E of o.features){const A=v.get("text-font").evaluate(E,{},p).join(","),P=k.evaluate(E,{},p),O=C.layoutTextSize.evaluate(E,{},p),R=(C.layoutIconSize.evaluate(E,{},p),{horizontal:{},vertical:void 0}),F=E.text;let B,j=[0,0];if(F){const W=F.toString(),q=v.get("text-letter-spacing").evaluate(E,{},p)*so,X=v.get("text-line-height").evaluate(E,{},p)*so,G=WR(W)?q:0,Q=v.get("text-anchor").evaluate(E,{},p),it=v.get("text-variable-anchor");if(!it){const mt=v.get("text-radial-offset").evaluate(E,{},p);j=mt?BS(Q,[mt*so,Nm]):v.get("text-offset").evaluate(E,{},p).map(ut=>ut*so)}let st=D?"center":v.get("text-justify").evaluate(E,{},p);const J="point"===v.get("symbol-placement"),et=J?v.get("text-max-width").evaluate(E,{},p)*so:1/0,dt=mt=>{o.allowVerticalPlacement&&$0(W)&&(R.vertical=dg(F,i,s,d,A,et,X,Q,mt,G,j,On.vertical,!0,O,P))};if(!D&&it){const mt="auto"===st?it.map(bt=>py(bt)):[st];let ut=!1;for(let bt=0;bt<mt.length;bt++){const yt=mt[bt];if(!R.horizontal[yt])if(ut)R.horizontal[yt]=R.horizontal[0];else{const Ct=dg(F,i,s,d,A,et,X,"center",yt,G,j,On.horizontal,!1,O,P);Ct&&(R.horizontal[yt]=Ct,ut=1===Ct.positionedLines.length)}}dt("left")}else{if("auto"===st&&(st=py(Q)),J||v.get("text-writing-mode").indexOf("horizontal")>=0||!$0(W)){const mt=dg(F,i,s,d,A,et,X,Q,st,G,j,On.horizontal,!1,O,P);mt&&(R.horizontal[st]=mt)}dt(J?"left":st)}}let U=!1;if(E.icon&&E.icon.namePrimary){const W=l[E.icon.namePrimary];W&&(B=YP(d[E.icon.namePrimary],E.icon.nameSecondary?d[E.icon.nameSecondary]:void 0,v.get("icon-offset").evaluate(E,{},p),v.get("icon-anchor").evaluate(E,{},p)),U=W.sdf,void 0===o.sdfIcons?o.sdfIcons=W.sdf:o.sdfIcons!==W.sdf&&rt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(W.pixelRatio!==o.pixelRatio||0!==v.get("icon-rotate").constantOr(1))&&(o.iconsNeedLinear=!0))}const H=VS(R.horizontal)||R.vertical;o.iconsInText||(o.iconsInText=!!H&&H.iconsInText),(H||B)&&zS(o,E,R,B,l,C,O,0,j,U,m,p,_,y,S)}u&&o.generateCollisionDebugBuffers(g,o.collisionBoxArray)}function py(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function zS(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D){let k=u.textMaxSize.evaluate(i,{},v);void 0===k&&(k=m);const S=o.layers[0].layout,E=S.get("icon-offset").evaluate(i,{},v),A=VS(s.horizontal)||s.vertical,P="globe"===w.name,O=so,R=m/O,F=o.tilePixelRatio*k/O,B=(Q=o.overscaling,o.zoom>18&&Q>2&&(Q>>=1),Math.max(pt/(512*Q),1)*S.get("symbol-spacing")),j=S.get("text-padding")*o.tilePixelRatio,U=S.get("icon-padding")*o.tilePixelRatio,H=ni(S.get("text-max-angle")),W="map"===S.get("text-rotation-alignment")&&"point"!==S.get("symbol-placement"),q="map"===S.get("icon-rotation-alignment")&&"point"!==S.get("symbol-placement"),X=S.get("symbol-placement"),G=B/2;var Q;const it=S.get("icon-text-fit").evaluate(i,{},v),st=S.get("icon-text-fit-padding").evaluate(i,{},v),J="none"!==it;let et;!1===o.hasAnyIconTextFit&&J&&(o.hasAnyIconTextFit=!0),l&&J&&(o.allowVerticalPlacement&&s.vertical&&(et=TS(l,s.vertical,it,st,E,R)),A&&(l=TS(l,A,it,st,E,R)));const dt=(mt,ut,bt)=>{if(ut.x<0||ut.x>=pt||ut.y<0||ut.y>=pt)return;let yt=null;if(P){const{x:Ct,y:gt,z:At}=w.projectTilePoint(ut.x,ut.y,bt);yt={anchor:new Kl(Ct,gt,At,0,void 0),up:w.upVector(bt,ut.x,ut.y)}}!function(Ct,gt,At,Gt,Et,te,ie,He,ve,Ui,xi,$e,ze,Ce,wi,Pi,ci,Gi,ir,tn,Mn,mr,Zn,kn,Xi,xo,$c){const Vd=Ct.addToLineVertexArray(gt,Gt);let oc,Zg,Xg,sv,uA,dC,uC,hC=0,hA=0,mA=0,mC=0,$s=-1,pA=-1;const gl={};let wp=Cu("");const ch=At?At.anchor:gt,pC="none"!==ve.layout.get("icon-text-fit").evaluate(Mn,{},Xi);let fA=0,gA=0;if(void 0===ve._unevaluatedLayout.getValue("text-radial-offset")?[fA,gA]=ve.layout.get("text-offset").evaluate(Mn,{},Xi).map(Gs=>Gs*so):(fA=ve.layout.get("text-radial-offset").evaluate(Mn,{},Xi)*so,gA=Nm),Ct.allowVerticalPlacement&&Et.vertical){const Gs=Et.vertical;if(wi)dC=ug(Gs),He&&(uC=ug(He));else{const xs=ve.layout.get("text-rotate").evaluate(Mn,{},Xi)+90;Xg=fy(Ui,ch,gt,xi,$e,ze,Gs,Ce,xs,Pi),He&&(sv=fy(Ui,ch,gt,xi,$e,ze,He,Gi,xs))}}if(te){const Gs=ve.layout.get("icon-rotate").evaluate(Mn,{},Xi),xs=OS(te,Gs,Zn,pC),dh=He?OS(He,Gs,Zn,pC):void 0;Zg=fy(Ui,ch,gt,xi,$e,ze,te,Gi,Gs),hC=4*xs.length;const _A=Ct.iconSizeData;let Ud=null;"source"===_A.kind?(Ud=[Ns*ve.layout.get("icon-size").evaluate(Mn,{},Xi)],Ud[0]>Ql&&rt(`${Ct.layerIds[0]}: Value for "icon-size" is >= ${zm}. Reduce your "icon-size".`)):"composite"===_A.kind&&(Ud=[Ns*mr.compositeIconSizes[0].evaluate(Mn,{},Xi),Ns*mr.compositeIconSizes[1].evaluate(Mn,{},Xi)],(Ud[0]>Ql||Ud[1]>Ql)&&rt(`${Ct.layerIds[0]}: Value for "icon-size" is >= ${zm}. Reduce your "icon-size".`)),Ct.addSymbols(Ct.icon,xs,Ud,tn,ir,Mn,!1,At,gt,Vd.lineStartIndex,Vd.lineLength,-1,kn,Xi,xo,$c),$s=Ct.icon.placedSymbolArray.length-1,dh&&(hA=4*dh.length,Ct.addSymbols(Ct.icon,dh,Ud,tn,ir,Mn,On.vertical,At,gt,Vd.lineStartIndex,Vd.lineLength,-1,kn,Xi,xo,$c),pA=Ct.icon.placedSymbolArray.length-1)}for(const Gs in Et.horizontal){const xs=Et.horizontal[Gs];oc||(wp=Cu(xs.text),wi?uA=ug(xs):oc=fy(Ui,ch,gt,xi,$e,ze,xs,Ce,ve.layout.get("text-rotate").evaluate(Mn,{},Xi),Pi));const dh=1===xs.positionedLines.length;if(mA+=Jl(Ct,At,gt,xs,ie,ve,wi,Mn,Pi,Vd,Et.vertical?On.horizontal:On.horizontalOnly,dh?Object.keys(Et.horizontal):[Gs],gl,$s,mr,kn,Xi,xo),dh)break}Et.vertical&&(mC+=Jl(Ct,At,gt,Et.vertical,ie,ve,wi,Mn,Pi,Vd,On.vertical,["vertical"],gl,pA,mr,kn,Xi,xo));let jd=-1;const fC=(Gs,xs)=>Gs?Math.max(Gs,xs):xs;jd=fC(uA,jd),jd=fC(dC,jd),jd=fC(uC,jd);const bL=jd>-1?1:0;Ct.glyphOffsetArray.length>=Gm.MAX_GLYPHS&&rt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Mn.sortKey&&Ct.addToSortKeyRanges(Ct.symbolInstances.length,Mn.sortKey),Ct.symbolInstances.emplaceBack(gt.x,gt.y,ch.x,ch.y,ch.z,gl.right>=0?gl.right:-1,gl.center>=0?gl.center:-1,gl.left>=0?gl.left:-1,gl.vertical>=0?gl.vertical:-1,$s,pA,wp,void 0!==oc?oc:Ct.collisionBoxArray.length,void 0!==oc?oc+1:Ct.collisionBoxArray.length,void 0!==Xg?Xg:Ct.collisionBoxArray.length,void 0!==Xg?Xg+1:Ct.collisionBoxArray.length,void 0!==Zg?Zg:Ct.collisionBoxArray.length,void 0!==Zg?Zg+1:Ct.collisionBoxArray.length,sv||Ct.collisionBoxArray.length,sv?sv+1:Ct.collisionBoxArray.length,xi,mA,mC,hC,hA,bL,0,fA,gA,jd,0,pC?1:0)}(o,ut,yt,mt,s,l,d,et,o.layers[0],o.collisionBoxArray,i.index,i.sourceLayerIndex,o.index,j,W,g,0,U,q,E,i,u,_,y,v,C,D)};if("line"===X)for(const mt of uy(i.geometry,0,0,pt,pt)){const ut=XP(mt,B,H,s.vertical||A,l,O,F,o.overscaling,pt);for(const bt of ut)A&&tO(o,A.text,G,bt)||dt(mt,bt,v)}else if("line-center"===X){for(const mt of i.geometry)if(mt.length>1){const ut=ZP(mt,H,s.vertical||A,l,O,F);ut&&dt(mt,ut,v)}}else if("Polygon"===i.type)for(const mt of tw(i.geometry,0)){const ut=LS(mt,16);dt(mt[0],new Kl(ut.x,ut.y,0,0,void 0),v)}else if("LineString"===i.type)for(const mt of i.geometry)dt(mt,new Kl(mt[0].x,mt[0].y,0,0,void 0),v);else if("Point"===i.type)for(const mt of i.geometry)for(const ut of mt)dt([ut],new Kl(ut.x,ut.y,0,0,void 0),v)}const zm=255,Ql=zm*Ns;function Jl(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E){const A=function(R,F,B,j,U,H,W,q){const X=[];if(0===F.positionedLines.length)return X;const G=j.layout.get("text-rotate").evaluate(H,{})*Math.PI/180,Q=function(dt){const mt=dt[0],ut=dt[1],bt=mt*ut;return bt>0?[mt,-ut]:bt<0?[-mt,ut]:0===mt?[ut,mt]:[ut,-mt]}(B);let it=Math.abs(F.top-F.bottom);for(const dt of F.positionedLines)it-=dt.lineOffset;const st=F.positionedLines.length,J=it/st;let et=F.top-B[1];for(let dt=0;dt<st;++dt){const mt=F.positionedLines[dt];et=QP(F,J,et,dt);for(const ut of mt.positionedGlyphs){if(!ut.rect)continue;const bt=ut.rect||{};let yt=Vu+1,Ct=!0,gt=1,At=0;if(ut.imageName){const tn=W[ut.imageName];if(!tn)continue;if(tn.sdf){rt("SDF images are not supported in formatted text and will be ignored.");continue}Ct=!1,gt=tn.pixelRatio,yt=Vs/gt}const Gt=(U||q)&&ut.vertical,Et=ut.metrics.advance*ut.scale/2,te=ut.metrics,ie=ut.rect;if(null===ie)continue;q&&F.verticalizable&&(At=ut.imageName?Et-ut.metrics.width*ut.scale/2:0);const He=U?[ut.x+Et,ut.y]:[0,0];let ve=[0,0],Ui=[0,0],xi=!1;U||(Gt?(Ui=[ut.x+Et+Q[0],ut.y+Q[1]-At],xi=!0):ve=[ut.x+Et+B[0],ut.y+B[1]-At]);const $e=ie.w*ut.scale/(gt*(ut.localGlyph?ua:1)),ze=ie.h*ut.scale/(gt*(ut.localGlyph?ua:1));let Ce,wi,Pi,ci;if(Gt){const tn=ut.y-et,Mn=new ot(-Et,Et-tn),mr=-Math.PI/2,Zn=new ot(...Ui);Ce=new ot(-Et+ve[0],ve[1]),Ce._rotateAround(mr,Mn)._add(Zn),Ce.x+=-tn+Et,Ce.y-=(te.left-yt)*ut.scale;const kn=ut.imageName?te.advance*ut.scale:so*ut.scale,Xi=String.fromCodePoint(ut.glyph);St(Xi)?Ce.x+=(1-yt)*ut.scale:CS(Xi)?Ce.x+=kn-te.height*ut.scale+(-yt-1)*ut.scale:Ce.x+=ut.imageName||te.width+2*yt===ie.w&&te.height+2*yt===ie.h?(kn-ze)/2:(kn-(te.height+2*yt)*ut.scale)/2,wi=new ot(Ce.x,Ce.y-$e),Pi=new ot(Ce.x+ze,Ce.y),ci=new ot(Ce.x+ze,Ce.y-$e)}else{const tn=(te.left-yt)*ut.scale-Et+ve[0],Mn=(-te.top-yt)*ut.scale+ve[1],mr=tn+$e,Zn=Mn+ze;Ce=new ot(tn,Mn),wi=new ot(mr,Mn),Pi=new ot(tn,Zn),ci=new ot(mr,Zn)}if(G){let tn;tn=U?new ot(0,0):xi?new ot(Q[0],Q[1]):new ot(B[0],B[1]),Ce._rotateAround(G,tn),wi._rotateAround(G,tn),Pi._rotateAround(G,tn),ci._rotateAround(G,tn)}const Gi=new ot(0,0),ir=new ot(0,0);X.push({tl:Ce,tr:wi,bl:Pi,br:ci,texPrimary:bt,texSecondary:void 0,writingMode:F.writingMode,glyphOffset:He,sectionIndex:ut.sectionIndex,isSDF:Ct,pixelOffsetTL:Gi,pixelOffsetBR:ir,minFontScaleX:0,minFontScaleY:0})}}return X}(0,l,g,u,m,p,d,o.allowVerticalPlacement),P=o.textSizeData;let O=null;"source"===P.kind?(O=[Ns*u.layout.get("text-size").evaluate(p,{},S)],O[0]>Ql&&rt(`${o.layerIds[0]}: Value for "text-size" is >= ${zm}. Reduce your "text-size".`)):"composite"===P.kind&&(O=[Ns*D.compositeTextSizes[0].evaluate(p,{},S),Ns*D.compositeTextSizes[1].evaluate(p,{},S)],(O[0]>Ql||O[1]>Ql)&&rt(`${o.layerIds[0]}: Value for "text-size" is >= ${zm}. Reduce your "text-size".`)),o.addSymbols(o.text,A,O,g,m,p,y,i,s,_.lineStartIndex,_.lineLength,C,k,S,E,!1);for(const R of v)w[R]=o.text.placedSymbolArray.length-1;return 4*A.length}function VS(o){for(const i in o)return o[i];return null}function fy(o,i,s,l,d,u,m,p,g,_){let y=m.top,v=m.bottom,w=m.left,C=m.right;const D=m.collisionPadding;if(D&&(w-=D[0],y-=D[1],C+=D[2],v+=D[3]),g){const k=new ot(w,y),S=new ot(C,y),E=new ot(w,v),A=new ot(C,v),P=ni(g);let O=new ot(0,0);_&&(O=new ot(_[0],_[1])),k._rotateAround(P,O),S._rotateAround(P,O),E._rotateAround(P,O),A._rotateAround(P,O),w=Math.min(k.x,S.x,E.x,A.x),C=Math.max(k.x,S.x,E.x,A.x),y=Math.min(k.y,S.y,E.y,A.y),v=Math.max(k.y,S.y,E.y,A.y)}return o.emplaceBack(i.x,i.y,i.z,s.x,s.y,w,y,C,v,p,l,d,u),o.length-1}function ug(o){o.collisionPadding&&(o.top-=o.collisionPadding[1],o.bottom+=o.collisionPadding[3]);const i=o.bottom-o.top;return i>0?Math.max(10,i):null}function tO(o,i,s,l){const d=o.compareText;if(i in d){const u=d[i];for(let m=u.length-1;m>=0;m--)if(l.dist(u[m])<s)return!0}else d[i]=[];return d[i].push(l),!1}function yw(o,i){const s=o.fovAboveCenter,l=o.elevation?o.elevation.getMinElevationBelowMSL()*i:0,d=(o._camera.position[2]*o.worldSize-l)/Math.cos(o._pitch),u=Math.sin(s)*d/Math.sin(Math.max(Math.PI/2-o._pitch-s,.01)),m=Math.sin(o._pitch)*u+d;return Math.min(1.01*m,d*(1/o._horizonShift))}function Hu(o,i){if(!i.isReprojectedInTileSpace)return{scale:1<<o.z,x:o.x,y:o.y,x2:o.x+1,y2:o.y+1,projection:i};const s=Math.pow(2,-o.z),l=o.x*s,d=(o.x+1)*s,u=o.y*s,m=(o.y+1)*s,p=Ls(l),g=Ls(d),_=an(u),y=an(m),v=i.project(p,_),w=i.project(g,_),C=i.project(g,y),D=i.project(p,y);let k=Math.min(v.x,w.x,C.x,D.x),S=Math.min(v.y,w.y,C.y,D.y),E=Math.max(v.x,w.x,C.x,D.x),A=Math.max(v.y,w.y,C.y,D.y);const P=s/16;function O(F,B,j,U,H,W){const q=(j+H)/2,X=(U+W)/2,G=i.project(Ls(q),an(X)),Q=Math.max(0,k-G.x,S-G.y,G.x-E,G.y-A);k=Math.min(k,G.x),E=Math.max(E,G.x),S=Math.min(S,G.y),A=Math.max(A,G.y),Q>P&&(O(F,G,j,U,q,X),O(G,B,q,X,H,W))}O(v,w,l,u,d,u),O(w,C,d,u,d,m),O(C,D,d,m,l,m),O(D,v,l,m,l,u),k-=P,S-=P,E+=P,A+=P;const R=1/Math.max(E-k,A-S);return{scale:R,x:k*R,y:S*R,x2:E*R,y2:A*R,projection:i}}function hg(o,i,s,l,d,u,m,p,g){if("globe"===g.name)return Ex(o,i,new ca(s,l,d),!1);const _=Hu({z:s,x:l,y:d},g);return new gn([(u+_.x/_.scale)*i,i*(_.y/_.scale),m],[(u+_.x2/_.scale)*i,i*(_.y2/_.scale),p])}function Vm(o,{x:i,y:s},l=0){return new ot(((i-l)*o.scale-o.x)*pt,(s*o.scale-o.y)*pt)}function vw(o,i,s=0){return Z.fromValues(((i.x-s)*o.scale-o.x)*pt,(i.y*o.scale-o.y)*pt,Xk(i.z,i.y))}const gy=at.identity(new Float32Array(16));class $u{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,s){return{x:0,y:0,z:0}}unproject(i,s){return new qe(0,0)}projectTilePoint(i,s,l){return{x:i,y:s,z:0}}locationPoint(i,s,l=!0){return i._coordinatePoint(i.locationCoordinate(s),l)}pixelsPerMeter(i,s){return sn(1,i)*s}pixelSpaceConversion(i,s,l){return 1}farthestPixelDistance(i){return yw(i,i.pixelsPerMeter)}pointCoordinate(i,s,l,d){const u=i.horizonLineFromTop(!1),m=new ot(s,Math.max(u,l));return i.rayIntersectionCoordinate(i.pointRayIntersection(m,d))}pointCoordinate3D(i,s,l){const d=new ot(s,l);if(i.elevation)return i.elevation.pointCoordinate(d);{const u=this.pointCoordinate(i,d.x,d.y,0);return[u.x,u.y,u.z]}}isPointAboveHorizon(i,s){if(i.elevation)return!this.pointCoordinate3D(i,s.x,s.y);const l=i.horizonLineFromTop();return s.y<l}createInversionMatrix(i,s){return gy}createTileMatrix(i,s,l){let d,u,m;const p=l.canonical,g=at.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const _=Hu(p,this);d=1,u=_.x+l.wrap*_.scale,m=_.y,at.scale(g,g,[d/_.scale,d/_.scale,i.pixelsPerMeter/s])}else d=s/i.zoomScale(p.z),u=(p.x+Math.pow(2,p.z)*l.wrap)*d,m=p.y*d;return at.translate(g,g,[u,m,0]),at.scale(g,g,[d/pt,d/pt,1]),g}upVector(i,s,l){return[0,0,1]}upVectorScale(i,s,l){return{metersToTile:1}}}class eO extends $u{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[s,l]=this.parallels=i.parallels||[29.5,45.5],d=Math.sin(ni(s));this.n=(d+Math.sin(ni(l)))/2,this.c=1+d*(2*this.n-d),this.r0=Math.sqrt(this.c)/this.n}project(i,s){const{n:l,c:d,r0:u}=this,m=ni(i-this.center[0]),p=ni(s),g=Math.sqrt(d-2*l*Math.sin(p))/l;return{x:g*Math.sin(m*l),y:g*Math.cos(m*l)-u,z:0}}unproject(i,s){const{n:l,c:d,r0:u}=this,m=u+s;let p=Math.atan2(i,Math.abs(m))*Math.sign(m);m*l<0&&(p-=Math.PI*Math.sign(i)*Math.sign(m));const g=ni(this.center[0])*l;p=Rl(p,-Math.PI-g,Math.PI-g);const _=he(jr(p/l)+this.center[0],-180,180),y=Math.asin(he((d-(i*i+m*m)*l*l)/(2*l),-1,1)),v=he(jr(y),-or,or);return new qe(_,v)}}const jm=1.340264,Um=-.081106,mg=893e-6,pg=.003796,fg=Math.sqrt(3)/2;class jS extends $u{project(i,s){s=s/180*Math.PI,i=i/180*Math.PI;const l=Math.asin(fg*Math.sin(s)),d=l*l,u=d*d*d;return{x:.5*(i*Math.cos(l)/(fg*(jm+3*Um*d+u*(7*mg+9*pg*d)))/Math.PI+.5),y:1-.5*(l*(jm+Um*d+u*(mg+pg*d))/Math.PI+1),z:0}}unproject(i,s){i=(2*i-.5)*Math.PI;let l=s=(2*(1-s)-1)*Math.PI,d=l*l,u=d*d*d;for(let y,v,w,C=0;C<12&&(v=l*(jm+Um*d+u*(mg+pg*d))-s,w=jm+3*Um*d+u*(7*mg+9*pg*d),y=v/w,l=he(l-y,-Math.PI/3,Math.PI/3),d=l*l,u=d*d*d,!(Math.abs(y)<1e-12));++C);const m=fg*i*(jm+3*Um*d+u*(7*mg+9*pg*d))/Math.cos(l),p=Math.asin(Math.sin(l)/fg),g=he(180*m/Math.PI,-180,180),_=he(180*p/Math.PI,-or,or);return new qe(g,_)}}class gg extends $u{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,s){return{x:.5+i/360,y:.5-s/360,z:0}}unproject(i,s){const l=360*(i-.5),d=he(360*(.5-s),-or,or);return new qe(l,d)}}const Hm=Math.PI/2;function _g(o){return Math.tan((Hm+o)/2)}class US extends $u{constructor(i){super(i),this.center=i.center||[0,30];const[s,l]=this.parallels=i.parallels||[30,30];let d=ni(s),u=ni(l);this.southernCenter=d+u<0,this.southernCenter&&(d=-d,u=-u);const m=Math.cos(d),p=_g(d);this.n=d===u?Math.sin(d):Math.log(m/Math.cos(u))/Math.log(_g(u)/p),this.f=m*Math.pow(_g(d),this.n)/this.n}project(i,s){s=ni(s),this.southernCenter&&(s=-s),i=ni(i-this.center[0]);const l=1e-6,{n:d,f:u}=this;u>0?s<-Hm+l&&(s=-Hm+l):s>Hm-l&&(s=Hm-l);const m=u/Math.pow(_g(s),d);let p=m*Math.sin(d*i),g=u-m*Math.cos(d*i);return p=.5*(p/Math.PI+.5),g=.5*(g/Math.PI+.5),{x:p,y:this.southernCenter?g:1-g,z:0}}unproject(i,s){i=(2*i-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:l,f:d}=this,u=d-s,m=Math.sign(u),p=Math.sign(l)*Math.sqrt(i*i+u*u);let g=Math.atan2(i,Math.abs(u))*m;u*l<0&&(g-=Math.PI*Math.sign(i)*m);const _=he(jr(g/l)+this.center[0],-180,180),y=he(jr(2*Math.atan(Math.pow(d/p,1/l))-Hm),-or,or);return new qe(_,this.southernCenter?-y:y)}}class HS extends $u{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,s){return{x:dr(i),y:Rr(s),z:0}}unproject(i,s){const l=Ls(i),d=an(s);return new qe(l,d)}}const $S=ni(or);class bg extends $u{project(i,s){const l=(s=ni(s))*s,d=l*l;return{x:.5*((i=ni(i))*(.8707-.131979*l+d*(d*(.003971*l-.001529*d)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+l*(.015085+d*(.028874*l-.044475-.005916*d)))/Math.PI+1),z:0}}unproject(i,s){i=(2*i-.5)*Math.PI;let l=s=(2*(1-s)-1)*Math.PI,d=25,u=0,m=l*l;do{m=l*l;const _=m*m;u=(l*(1.007226+m*(.015085+_*(.028874*m-.044475-.005916*_)))-s)/(1.007226+m*(.045255+_*(.259866*m-.311325-.005916*11*_))),l=he(l-u,-$S,$S)}while(Math.abs(u)>1e-6&&--d>0);m=l*l;const p=he(jr(i/(.8707+m*(m*(m*m*m*(.003971-.001529*m)-.013791)-.131979))),-180,180),g=jr(l);return new qe(p,g)}}const GS=ni(or);class iO extends $u{project(i,s){s=ni(s),i=ni(i);const l=Math.cos(s),d=2/Math.PI,u=Math.acos(l*Math.cos(i/2)),m=Math.sin(u)/u,p=.5*(i*d+2*l*Math.sin(i/2)/m)||0,g=.5*(s+Math.sin(s)/m)||0;return{x:.5*(p/Math.PI+.5),y:1-.5*(g/Math.PI+1),z:0}}unproject(i,s){let l=i=(2*i-.5)*Math.PI,d=s=(2*(1-s)-1)*Math.PI,u=25;const m=1e-6;let p=0,g=0;do{const _=Math.cos(d),y=Math.sin(d),v=2*y*_,w=y*y,C=_*_,D=Math.cos(l/2),k=Math.sin(l/2),S=2*D*k,E=k*k,A=1-C*D*D,P=A?1/A:0,O=A?Math.acos(_*D)*Math.sqrt(1/A):0,R=.5*(2*O*_*k+2*l/Math.PI)-i,F=.5*(O*y+d)-s,B=.5*P*(C*E+O*_*D*w)+1/Math.PI,j=P*(S*v/4-O*y*k),U=.125*P*(v*k-O*y*C*S),H=.5*P*(w*D+O*E*_)+.5,W=j*U-H*B;p=(F*j-R*H)/W,g=(R*U-F*B)/W,l=he(l-p,-Math.PI,Math.PI),d=he(d-g,-GS,GS)}while((Math.abs(p)>m||Math.abs(g)>m)&&--u>0);return new qe(jr(l),jr(d))}}class WS extends $u{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ni(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,s){const{scale:l,cosPhi:d}=this;return{x:ni(i)*d*l+.5,y:-Math.sin(ni(s))/d*l+.5,z:0}}unproject(i,s){const{scale:l,cosPhi:d}=this,u=-(s-.5)/l,m=he(jr((i-.5)/l)/d,-180,180),p=Math.asin(he(u*d,-1,1)),g=he(jr(p),-or,or);return new qe(m,g)}}class nO extends HS{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,s,l){const d=Kf(i,s,l),u=kd(da(l));return Z.transformMat4(d,d,u),{x:d[0],y:d[1],z:d[2]}}locationPoint(i,s){const l=fs(s.lat,s.lng),d=Z.normalize([],l),u=i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(s),i._centerAltitude):i._centerAltitude,m=sn(1,0)*pt*u;Z.scaleAndAdd(l,l,d,m);const p=at.identity(new Float64Array(16));return at.multiply(p,i.pixelMatrix,i.globeMatrix),Z.transformMat4(l,l,p),new ot(l[0],l[1])}pixelsPerMeter(i,s){return sn(1,0)*s}pixelSpaceConversion(i,s,l){const d=sn(1,i)*s,u=_e(sn(1,45)*s,d,l);return this.pixelsPerMeter(i,s)/u}createTileMatrix(i,s,l){const d=Vb(da(l.canonical));return at.multiply(new Float64Array(16),i.globeMatrix,d)}createInversionMatrix(i,s){const{center:l}=i,d=kd(da(s));return at.rotateY(d,d,ni(l.lng)),at.rotateX(d,d,ni(l.lat)),at.scale(d,d,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(d)}pointCoordinate(i,s,l,d){return Tx(i,s,l,!0)||new Ei(0,0)}pointCoordinate3D(i,s,l){const d=this.pointCoordinate(i,s,l,0);return[d.x,d.y,d.z]}isPointAboveHorizon(i,s){return!Tx(i,s.x,s.y,!1)}farthestPixelDistance(i){const s=function(d,u){const m=d.cameraToCenterDistance,p=d._centerAltitude*u,g=d._camera,_=d._camera.forward(),y=Z.add([],Z.scale([],_,-m),[0,0,p]),v=d.worldSize/(2*Math.PI),w=[0,0,-v],C=d.width/d.height,D=Math.tan(d.fovAboveCenter),k=Z.scale([],g.up(),D),S=Z.scale([],g.right(),D*C),E=Z.normalize([],Z.add([],Z.add([],_,k),S)),A=[];let P;if(new Nb(y,E).closestPointOnSphere(w,v,A)){const O=Z.add([],A,w),R=Z.sub([],O,y);P=Math.cos(d.fovAboveCenter)*Z.length(R)}else{const O=Z.sub([],y,w),R=Z.sub([],w,y);Z.normalize(R,R);const F=Z.length(O)-v;P=Math.sqrt(F*(F+2*v));const B=Math.acos(P/(v+F))-Math.acos(Z.dot(_,R));P*=Math.cos(B)}return 1.01*P}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),l=Dr(i.zoom);if(l>0){const d=yw(i,sn(1,i.center.lat)*i.worldSize),u=i.worldSize/(2*Math.PI),m=Math.max(i.width,i.height)/i.worldSize*Math.PI;return _e(s,d+u*(1-Math.cos(m)),Math.pow(l,10))}return s}upVector(i,s,l){return Kf(s,l,i,1)}upVectorScale(i){return{metersToTile:Xf(zb(da(i)))}}}function _y(o){const i=o.parallels,s=!!i&&Math.abs(i[0]+i[1])<.01;switch(o.name){case"mercator":return new HS(o);case"equirectangular":return new gg(o);case"naturalEarth":return new bg(o);case"equalEarth":return new jS(o);case"winkelTripel":return new iO(o);case"albers":return s?new WS(o):new eO(o);case"lambertConformalConic":return s?new WS(o):new US(o);case"globe":return new nO(o)}throw new Error(`Invalid projection name: ${o.name}`)}const rO=new Gn({"symbol-placement":new Ft(ct.layout_symbol["symbol-placement"]),"symbol-spacing":new Ft(ct.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ft(ct.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ke(ct.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ft(ct.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Ft(ct.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Ft(ct.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ft(ct.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ft(ct.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ft(ct.layout_symbol["icon-rotation-alignment"]),"icon-size":new ke(ct.layout_symbol["icon-size"]),"icon-text-fit":new ke(ct.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ke(ct.layout_symbol["icon-text-fit-padding"]),"icon-image":new ke(ct.layout_symbol["icon-image"]),"icon-rotate":new ke(ct.layout_symbol["icon-rotate"]),"icon-padding":new Ft(ct.layout_symbol["icon-padding"]),"icon-keep-upright":new Ft(ct.layout_symbol["icon-keep-upright"]),"icon-offset":new ke(ct.layout_symbol["icon-offset"]),"icon-anchor":new ke(ct.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ft(ct.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ft(ct.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ft(ct.layout_symbol["text-rotation-alignment"]),"text-field":new ke(ct.layout_symbol["text-field"]),"text-font":new ke(ct.layout_symbol["text-font"]),"text-size":new ke(ct.layout_symbol["text-size"]),"text-max-width":new ke(ct.layout_symbol["text-max-width"]),"text-line-height":new ke(ct.layout_symbol["text-line-height"]),"text-letter-spacing":new ke(ct.layout_symbol["text-letter-spacing"]),"text-justify":new ke(ct.layout_symbol["text-justify"]),"text-radial-offset":new ke(ct.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ft(ct.layout_symbol["text-variable-anchor"]),"text-anchor":new ke(ct.layout_symbol["text-anchor"]),"text-max-angle":new Ft(ct.layout_symbol["text-max-angle"]),"text-writing-mode":new Ft(ct.layout_symbol["text-writing-mode"]),"text-rotate":new ke(ct.layout_symbol["text-rotate"]),"text-padding":new Ft(ct.layout_symbol["text-padding"]),"text-keep-upright":new Ft(ct.layout_symbol["text-keep-upright"]),"text-transform":new ke(ct.layout_symbol["text-transform"]),"text-offset":new ke(ct.layout_symbol["text-offset"]),"text-allow-overlap":new Ft(ct.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ft(ct.layout_symbol["text-ignore-placement"]),"text-optional":new Ft(ct.layout_symbol["text-optional"]),visibility:new Ft(ct.layout_symbol.visibility)});var xw={paint:new Gn({"icon-opacity":new ke(ct.paint_symbol["icon-opacity"]),"icon-emissive-strength":new ke(ct.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new ke(ct.paint_symbol["text-emissive-strength"]),"icon-color":new ke(ct.paint_symbol["icon-color"]),"icon-halo-color":new ke(ct.paint_symbol["icon-halo-color"]),"icon-halo-width":new ke(ct.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ke(ct.paint_symbol["icon-halo-blur"]),"icon-translate":new Ft(ct.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ft(ct.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new ke(ct.paint_symbol["icon-image-cross-fade"]),"text-opacity":new ke(ct.paint_symbol["text-opacity"]),"text-color":new ke(ct.paint_symbol["text-color"],{runtimeType:$a,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new ke(ct.paint_symbol["text-halo-color"]),"text-halo-width":new ke(ct.paint_symbol["text-halo-width"]),"text-halo-blur":new ke(ct.paint_symbol["text-halo-blur"]),"text-translate":new Ft(ct.paint_symbol["text-translate"]),"text-translate-anchor":new Ft(ct.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Ft(ct.paint_symbol["icon-color-saturation"])}),layout:rO};class qS{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:nf,this.defaultValue=i}evaluate(i){if(i.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(i.formattedSection))return s.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}de(qS,"FormatSectionOverride",{omit:["defaultValue"]});class yg extends cs{constructor(i,s){super(i,xw,s)}recalculate(i,s){super.recalculate(i,s),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const l=this.layout.get("text-writing-mode");if(l){const d=[];for(const u of l)d.indexOf(u)<0&&d.push(u);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(i,s,l,d){const u=this.layout.get(i).evaluate(s,{},l,d),m=this._unevaluatedLayout._values[i];return m.isDataDriven()||om(m.value)||!u?u:(p=s.properties,u.replace(/{([^{}]+)}/g,(_,y)=>y in p?String(p[y]):""));var p}createBucket(i){return new Gm(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of xw.paint.overridableProperties){if(!yg.hasPaintOverride(this.layout,i))continue;const s=this.paint.get(i),l=new qS(s),d=new _f(l,s.property.specification);let u=null;u="constant"===s.value.kind||"source"===s.value.kind?new sb("source",d):new vc("composite",d,s.value.zoomStops,s.value._interpolationType),this.paint._values[i]=new yd(s.property,u,s.parameters)}}_handleOverridablePaintPropertyUpdate(i,s,l){return!(!this.layout||s.isDataDriven()||l.isDataDriven())&&yg.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,s){const l=i.get("text-field"),d=xw.paint.properties[s];let u=!1;const m=p=>{for(const g of p)if(d.overrides&&d.overrides.hasOverride(g))return void(u=!0)};if("constant"===l.value.kind&&l.value.value instanceof as)m(l.value.value.sections);else if("source"===l.value.kind){const p=_=>{u||(_ instanceof kt&&zi(_.value)===vi?m(_.value.sections):_ instanceof cf?m(_.sections):_.eachChild(p))},g=l.value;g._styleExpression&&p(g._styleExpression.expression)}return u}getProgramIds(){const i=0!==this.paint.get("icon-opacity").constantOr(1),s=0!==this.paint.get("text-opacity").constantOr(1),l=[];return i&&l.push("symbolIcon"),s&&l.push("symbolSDF"),l}getDefaultProgramParams(i,s){return{config:new Mu(this,s),overrideFog:!1}}}const Xt=ow.types,oO=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Gu(o,i,s,l,d,u,m,p,g,_,y,v,w){const C=p?Math.min(Ql,Math.round(p[0])):0,D=p?Math.min(Ql,Math.round(p[1])):0;o.emplaceBack(i,s,Math.round(32*l),Math.round(32*d),u,m,(C<<1)+(g?1:0),D,16*_,16*y,256*v,256*w)}function by(o,i,s){o.emplaceBack(i,s)}function yy(o,i,s,l,d,u,m){o.emplaceBack(i,s,l,d,u,m)}function vy(o,i,s,l,d){const u=5*i+2;o.float32[u+0]=s,o.float32[u+1]=l,o.float32[u+2]=d}function $m(o,i,s,l,d){o.emplaceBack(i,s,l,d),o.emplaceBack(i,s,l,d),o.emplaceBack(i,s,l,d),o.emplaceBack(i,s,l,d)}function sO(o){for(const i of o.sections)if($n(i.text))return!0;return!1}class ww{constructor(i){this.layoutVertexArray=new um,this.indexArray=new Cr,this.programConfigurations=i,this.segments=new on,this.dynamicLayoutVertexArray=new Sa,this.opacityVertexArray=new kf,this.placedSymbolArray=new J0,this.iconTransitioningVertexArray=new Dc,this.globeExtVertexArray=new hm,this.zOffsetVertexArray=new yb}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length&&0===this.iconTransitioningVertexArray.length}upload(i,s,l,d,u){this.isEmpty()||(l&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,HP.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,yS.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,oO,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=i.createVertexBuffer(this.iconTransitioningVertexArray,GP.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,$P.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||u)&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,Y3.members,!0)),this.opacityVertexBuffer.itemSize=1),(l||d)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}de(ww,"SymbolBuffers");class Cw{constructor(i,s,l){this.layoutVertexArray=new i,this.layoutAttributes=s,this.indexArray=new l,this.segments=new on,this.collisionVertexArray=new vu,this.collisionVertexArrayExt=new Sa}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Z3.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,X3.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}de(Cw,"CollisionBuffers");class vg{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(m=>m.fqid),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=at.identity([]),this.placementViewportMatrix=at.identity([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ay(this.zoom,s["text-size"]),this.iconSizeData=ay(this.zoom,s["icon-size"]);const l=this.layers[0].layout,d=l.get("symbol-sort-key"),u=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==u&&void 0!==d.constantOr(1),this.sortFeaturesByY=("viewport-y"===u||"auto"===u&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=l.get("text-writing-mode").map(m=>On[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=i.sourceID,this.projection=i.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=l.get("symbol-z-elevate")}createArrays(){this.text=new ww(new Cd(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new ww(new Cd(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new ZD,this.lineVertexArray=new Af,this.symbolInstances=new el}calculateGlyphDependencies(i,s,l,d,u){for(let m=0;m<i.length;m++){const p=i.codePointAt(m);if(void 0===p)break;if(s[p]=!0,d&&u&&p<=65535){const g=Oi[i.charAt(m)];g&&(s[g.charCodeAt(0)]=!0)}}}populate(i,s,l,d){const u=this.layers[0],m=u.layout,p="globe"===this.projection.name,g=m.get("text-font"),_=m.get("text-field"),y=m.get("icon-image"),v=("constant"!==_.value.kind||_.value.value instanceof as&&!_.value.value.isEmpty()||_.value.value.toString().length>0)&&("constant"!==g.value.kind||g.value.value.length>0),w="constant"!==y.value.kind||!!y.value.value||Object.keys(y.parameters).length>0,C=m.get("symbol-sort-key");if(this.features=[],!v&&!w)return;const D=s.iconDependencies,k=s.glyphDependencies,S=s.availableImages,E=new zn(this.zoom);for(const{feature:A,id:P,index:O,sourceLayerIndex:R}of i){const F=u._featureFilter.needGeometry,B=ql(A,F);if(!u._featureFilter.filter(E,B,l))continue;if(F||(B.geometry=ll(A,l,d)),p&&1!==A.type&&l.z<=5){const W=B.geometry,q=.98078528056,X=(G,Q)=>{const it=Kf(G.x,G.y,l,1),st=Kf(Q.x,Q.y,l,1);return Z.dot(it,st)<q};for(let G=0;G<W.length;G++)W[G]=$3(W[G],X)}let j,U;if(v){const W=u.getValueAndResolveTokens("text-field",B,l,S),q=as.factory(W);sO(q)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===mb()||this.hasRTLText&&ro.isParsed())&&(j=wS(q,u,B))}if(w){const W=u.getValueAndResolveTokens("icon-image",B,l,S);U=W instanceof fr?W:fr.fromString(W)}if(!j&&!U)continue;const H=this.sortFeaturesByKey?C.evaluate(B,{},l):void 0;if(this.features.push({id:P,text:j,icon:U,index:O,sourceLayerIndex:R,geometry:B.geometry,properties:A.properties,type:Xt[A.type],sortKey:H}),U&&(D[U.namePrimary]=!0,U.nameSecondary&&(D[U.nameSecondary]=!0)),j){const W=g.evaluate(B,{},l).join(","),q="map"===m.get("text-rotation-alignment")&&"point"!==m.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(On.vertical)>=0;for(const X of j.sections)if(X.image)D[X.image.namePrimary]=!0;else{const G=$0(j.toString()),Q=X.fontStack||W,it=k[Q]=k[Q]||{};this.calculateGlyphDependencies(X.text,it,q,this.allowVerticalPlacement,G)}}}"line"===m.get("symbol-placement")&&(this.features=function(A){const P={},O={},R=[];let F=0;function B(W){R.push(A[W]),F++}function j(W,q,X){const G=O[W];return delete O[W],O[q]=G,R[G].geometry[0].pop(),R[G].geometry[0]=R[G].geometry[0].concat(X[0]),G}function U(W,q,X){const G=P[q];return delete P[q],P[W]=G,R[G].geometry[0].shift(),R[G].geometry[0]=X[0].concat(R[G].geometry[0]),G}function H(W,q,X){const G=X?q[0][q[0].length-1]:q[0][0];return`${W}:${G.x}:${G.y}`}for(let W=0;W<A.length;W++){const q=A[W],X=q.geometry,G=q.text?q.text.toString():null;if(!G){B(W);continue}const Q=H(G,X),it=H(G,X,!0);if(Q in O&&it in P&&O[Q]!==P[it]){const st=U(Q,it,X),J=j(Q,it,R[st].geometry);delete P[Q],delete O[it],O[H(G,R[J].geometry,!0)]=J,R[st].geometry=null}else Q in O?j(Q,it,X):it in P?U(Q,it,X):(B(W),P[Q]=F-1,O[it]=F-1)}return R.filter(W=>W.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((A,P)=>A.sortKey-P.sortKey)}update(i,s,l,d,u){const m=0!==Object.keys(i).length;if(m&&!this.stateDependentLayers.length)return;const p=m?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(i,s,p,l,d,u),this.icon.programConfigurations.updatePaintArrays(i,s,p,l,d,u)}updateZOffset(){const i=(u,m,p)=>{l+=m,l>u.length&&u.resize(l);for(let g=-m;g<0;g++)u.emplace(g+l,p)},s=(u,m,p)=>{d+=m,d>u.length&&u.resize(d);for(let g=-m;g<0;g++)u.emplace(g+d,p)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let l=0,d=0;for(let u=0;u<this.symbolInstances.length;u++){const m=this.symbolInstances.get(u),{numHorizontalGlyphVertices:p,numVerticalGlyphVertices:g,numIconVertices:_}=m,y=m.zOffset,v=_>0;if((p>0||g>0)&&(i(this.text.zOffsetVertexArray,p,y),i(this.text.zOffsetVertexArray,g,y)),v){const{placedIconSymbolIndex:w,verticalPlacedIconSymbolIndex:C}=m;w>=0&&s(this.icon.zOffsetVertexArray,_,y),C>=0&&s(this.icon.zOffsetVertexArray,m.numVerticalIconVertices,y)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=_y(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,s){const l=this.lineVertexArray.length;if(void 0!==i.segment)for(const{x:d,y:u}of s)this.lineVertexArray.emplaceBack(d,u);return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S){const E=i.indexArray,A=i.layoutVertexArray,P=i.globeExtVertexArray,O=i.segments.prepareSegment(4*s.length,A,E,this.canOverlap?m.sortKey:void 0),R=this.glyphOffsetArray.length,F=O.vertexLength,B=this.allowVerticalPlacement&&p===On.vertical?Math.PI/2:0,j=m.text&&m.text.sections;for(let H=0;H<s.length;H++){const{tl:W,tr:q,bl:X,br:G,texPrimary:Q,texSecondary:it,pixelOffsetTL:st,pixelOffsetBR:J,minFontScaleX:et,minFontScaleY:dt,glyphOffset:mt,isSDF:ut,sectionIndex:bt}=s[H],yt=O.vertexLength,Ct=mt[1];if(Gu(A,_.x,_.y,W.x,Ct+W.y,Q.x,Q.y,l,ut,st.x,st.y,et,dt),Gu(A,_.x,_.y,q.x,Ct+q.y,Q.x+Q.w,Q.y,l,ut,J.x,st.y,et,dt),Gu(A,_.x,_.y,X.x,Ct+X.y,Q.x,Q.y+Q.h,l,ut,st.x,J.y,et,dt),Gu(A,_.x,_.y,G.x,Ct+G.y,Q.x+Q.w,Q.y+Q.h,l,ut,J.x,J.y,et,dt),g){const{x:gt,y:At,z:Gt}=g.anchor,[Et,te,ie]=g.up;yy(P,gt,At,Gt,Et,te,ie),yy(P,gt,At,Gt,Et,te,ie),yy(P,gt,At,Gt,Et,te,ie),yy(P,gt,At,Gt,Et,te,ie),$m(i.dynamicLayoutVertexArray,gt,At,Gt,B)}else $m(i.dynamicLayoutVertexArray,_.x,_.y,_.z,B);if(S){const gt=it||Q;by(i.iconTransitioningVertexArray,gt.x,gt.y),by(i.iconTransitioningVertexArray,gt.x+gt.w,gt.y),by(i.iconTransitioningVertexArray,gt.x,gt.y+gt.h),by(i.iconTransitioningVertexArray,gt.x+gt.w,gt.y+gt.h)}E.emplaceBack(yt,yt+1,yt+2),E.emplaceBack(yt+1,yt+2,yt+3),O.vertexLength+=4,O.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(mt[0]),H!==s.length-1&&bt===s[H+1].sectionIndex||i.programConfigurations.populatePaintArrays(A.length,m,m.index,{},C,D,k,j&&j[bt])}const U=g?g.anchor:_;i.placedSymbolArray.emplaceBack(U.x,U.y,U.z,_.x,_.y,R,this.glyphOffsetArray.length-R,F,y,v,_.segment,l?l[0]:0,l?l[1]:0,d[0],d[1],p,0,!1,0,w,0)}_commitLayoutVertex(i,s,l,d,u,m,p){i.emplaceBack(s,l,d,u,m,Math.round(p.x),Math.round(p.y))}_addCollisionDebugVertices(i,s,l,d,u,m,p){const g=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),_=g.vertexLength,y=p.tileAnchorX,v=p.tileAnchorY;for(let C=0;C<4;C++)l.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(l.collisionVertexArrayExt,s,i.padding,p.zOffset),this._commitLayoutVertex(l.layoutVertexArray,d,u,m,y,v,new ot(i.x1,i.y1)),this._commitLayoutVertex(l.layoutVertexArray,d,u,m,y,v,new ot(i.x2,i.y1)),this._commitLayoutVertex(l.layoutVertexArray,d,u,m,y,v,new ot(i.x2,i.y2)),this._commitLayoutVertex(l.layoutVertexArray,d,u,m,y,v,new ot(i.x1,i.y2)),g.vertexLength+=4;const w=l.indexArray;w.emplaceBack(_,_+1),w.emplaceBack(_+1,_+2),w.emplaceBack(_+2,_+3),w.emplaceBack(_+3,_),g.primitiveLength+=4}_addTextDebugCollisionBoxes(i,s,l,d,u,m){for(let p=d;p<u;p++){const g=l.get(p),_=this.getSymbolInstanceTextSize(i,m,s,p);this._addCollisionDebugVertices(g,_,this.textCollisionBox,g.projectedAnchorX,g.projectedAnchorY,g.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(i,s,l,d,u,m){for(let p=d;p<u;p++){const g=l.get(p),_=this.getSymbolInstanceIconSize(i,s,m.placedIconSymbolIndex);this._addCollisionDebugVertices(g,_,this.iconCollisionBox,g.projectedAnchorX,g.projectedAnchorY,g.projectedAnchorZ,m)}}generateCollisionDebugBuffers(i,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Cw(bb,pw.members,Dc),this.iconCollisionBox=new Cw(bb,pw.members,Dc);const l=Xl(this.iconSizeData,i),d=Xl(this.textSizeData,i);for(let u=0;u<this.symbolInstances.length;u++){const m=this.symbolInstances.get(u);this._addTextDebugCollisionBoxes(d,i,s,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(d,i,s,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(l,i,s,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(l,i,s,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(i,s,l,d){const u=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:d),m=Im(this.textSizeData,i,u)/so;return this.tilePixelRatio*m}getSymbolInstanceIconSize(i,s,l){const d=this.icon.placedSymbolArray.get(l),u=Im(this.iconSizeData,i,d);return this.tilePixelRatio*u}_commitDebugCollisionVertexUpdate(i,s,l,d){i.emplaceBack(s,-l,-l,d),i.emplaceBack(s,l,-l,d),i.emplaceBack(s,l,l,d),i.emplaceBack(s,-l,l,d)}_updateTextDebugCollisionBoxes(i,s,l,d,u,m){for(let p=d;p<u;p++){const g=l.get(p),_=this.getSymbolInstanceTextSize(i,m,s,p);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,_,g.padding,m.zOffset)}}_updateIconDebugCollisionBoxes(i,s,l,d,u,m){for(let p=d;p<u;p++){const g=l.get(p),_=this.getSymbolInstanceIconSize(i,s,m.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,_,g.padding,m.zOffset)}}updateCollisionDebugBuffers(i,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const l=Xl(this.iconSizeData,i),d=Xl(this.textSizeData,i);for(let u=0;u<this.symbolInstances.length;u++){const m=this.symbolInstances.get(u);this._updateTextDebugCollisionBoxes(d,i,s,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(d,i,s,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(l,i,s,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._updateIconDebugCollisionBoxes(l,i,s,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,s,l,d,u,m,p,g,_){const y={};if(s<l){const{x1:v,y1:w,x2:C,y2:D,padding:k,projectedAnchorX:S,projectedAnchorY:E,projectedAnchorZ:A,tileAnchorX:P,tileAnchorY:O,featureIndex:R}=i.get(s);y.textBox={x1:v,y1:w,x2:C,y2:D,padding:k,projectedAnchorX:S,projectedAnchorY:E,projectedAnchorZ:A,tileAnchorX:P,tileAnchorY:O},y.textFeatureIndex=R}if(d<u){const{x1:v,y1:w,x2:C,y2:D,padding:k,projectedAnchorX:S,projectedAnchorY:E,projectedAnchorZ:A,tileAnchorX:P,tileAnchorY:O,featureIndex:R}=i.get(d);y.verticalTextBox={x1:v,y1:w,x2:C,y2:D,padding:k,projectedAnchorX:S,projectedAnchorY:E,projectedAnchorZ:A,tileAnchorX:P,tileAnchorY:O},y.verticalTextFeatureIndex=R}if(m<p){const{x1:v,y1:w,x2:C,y2:D,padding:k,projectedAnchorX:S,projectedAnchorY:E,projectedAnchorZ:A,tileAnchorX:P,tileAnchorY:O,featureIndex:R}=i.get(m);y.iconBox={x1:v,y1:w,x2:C,y2:D,padding:k,projectedAnchorX:S,projectedAnchorY:E,projectedAnchorZ:A,tileAnchorX:P,tileAnchorY:O},y.iconFeatureIndex=R}if(g<_){const{x1:v,y1:w,x2:C,y2:D,padding:k,projectedAnchorX:S,projectedAnchorY:E,projectedAnchorZ:A,tileAnchorX:P,tileAnchorY:O,featureIndex:R}=i.get(g);y.verticalIconBox={x1:v,y1:w,x2:C,y2:D,padding:k,projectedAnchorX:S,projectedAnchorY:E,projectedAnchorZ:A,tileAnchorX:P,tileAnchorY:O},y.verticalIconFeatureIndex=R}return y}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const l=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(i,s){const l=i.placedSymbolArray.get(s),d=l.vertexStartIndex+4*l.numGlyphs;for(let u=l.vertexStartIndex;u<d;u+=4)i.indexArray.emplaceBack(u,u+1,u+2),i.indexArray.emplaceBack(u+1,u+2,u+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const s=Math.sin(i),l=Math.cos(i),d=[],u=[],m=[];for(let p=0;p<this.symbolInstances.length;++p){m.push(p);const g=this.symbolInstances.get(p);d.push(0|Math.round(s*g.tileAnchorX+l*g.tileAnchorY)),u.push(g.featureIndex)}return m.sort((p,g)=>d[p]-d[g]||u[g]-u[p]),m}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let i=0;i<this.symbolInstances.length;++i)this.symbolInstanceIndexesSortedZOffset.push(i)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((i,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(i).zOffset)}addToSortKeyRanges(i,s){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===s?l.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const l=this.symbolInstances.get(s);this.featureSortOrder.push(l.featureIndex);const{rightJustifiedTextSymbolIndex:d,centerJustifiedTextSymbolIndex:u,leftJustifiedTextSymbolIndex:m,verticalPlacedTextSymbolIndex:p,placedIconSymbolIndex:g,verticalPlacedIconSymbolIndex:_}=l;d>=0&&this.addIndicesForPlacedSymbol(this.text,d),u>=0&&u!==d&&this.addIndicesForPlacedSymbol(this.text,u),m>=0&&m!==u&&m!==d&&this.addIndicesForPlacedSymbol(this.text,m),p>=0&&this.addIndicesForPlacedSymbol(this.text,p),g>=0&&this.addIndicesForPlacedSymbol(this.icon,g),_>=0&&this.addIndicesForPlacedSymbol(this.icon,_)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}de(vg,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),vg.MAX_GLYPHS=65535,vg.addDynamicAttributes=$m;var Gm=vg;const aO=Xe([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:K3}=aO,YS=Xe([{name:"a_packed",components:4,type:"Float32"}]),{members:ZS}=YS,Q3=ow.types,xy=Math.cos(Math.PI/180*37.5);class wy{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new fb,this.layoutVertexArray2=new Sa,this.indexArray=new Cr,this.programConfigurations=new Cd(i.layers,i.zoom),this.segments=new on,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(i,s,l,d){this.hasPattern=sS("line",this.layers,s);const u=this.layers[0].layout.get("line-sort-key"),m=[];for(const{feature:y,id:v,index:w,sourceLayerIndex:C}of i){const D=this.layers[0]._featureFilter.needGeometry,k=ql(y,D);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),k,l))continue;const S=u?u.evaluate(k,{},l):void 0,E={id:v,properties:y.properties,type:y.type,sourceLayerIndex:C,index:w,geometry:D?k.geometry:ll(y,l,d),patterns:{},sortKey:S};m.push(E)}u&&m.sort((y,v)=>y.sortKey-v.sortKey);const{lineAtlas:p,featureIndex:g}=s,_=this.addConstantDashes(p);for(const y of m){const{geometry:v,index:w,sourceLayerIndex:C}=y;if(_&&this.addFeatureDashes(y,p),this.hasPattern){const D=ew("line",this.layers,y,this.zoom,s);this.patternFeatures.push(D)}else this.addFeature(y,v,w,l,p.positions,s.availableImages,s.brightness);g.insert(i[w].feature,v,w,C,this.index)}}addConstantDashes(i){let s=!1;for(const l of this.layers){const d=l.paint.get("line-dasharray").value,u=l.layout.get("line-cap").value;if("constant"!==d.kind||"constant"!==u.kind)s=!0;else{const m=u.value,p=d.value;if(!p)continue;i.addDash(p,m)}}return s}addFeatureDashes(i,s){const l=this.zoom;for(const d of this.layers){const u=d.paint.get("line-dasharray").value,m=d.layout.get("line-cap").value;if("constant"===u.kind&&"constant"===m.kind)continue;let p,g;if("constant"===u.kind){if(p=u.value,!p)continue}else p=u.evaluate({zoom:l},i);g="constant"===m.kind?m.value:m.evaluate({zoom:l},i),s.addDash(p,g),i.patterns[d.id]=s.getKey(p,g)}}update(i,s,l,d,u){const m=0!==Object.keys(i).length;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(i,s,m?this.stateDependentLayers:this.layers,l,d,u)}addFeatures(i,s,l,d,u,m){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,s,l,d,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,ZS)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,K3),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,s,l,d,u,m,p){const g=this.layers[0].layout,_=g.get("line-join").evaluate(i,{}),y=g.get("line-cap").evaluate(i,{}),v=g.get("line-miter-limit"),w=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const C of s)this.addLine(C,i,_,y,v,w);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,u,m,d,p)}addLine(i,s,l,d,u,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let E=0;E<i.length-1;E++)this.totalDistance+=i[E].dist(i[E+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const p="Polygon"===Q3[s.type];let g=i.length;for(;g>=2&&i[g-1].equals(i[g-2]);)g--;let _=0;for(;_<g-1&&i[_].equals(i[_+1]);)_++;if(g<(p?3:2))return;"bevel"===l&&(u=1.05);const y=this.overscaling<=16?15*pt/(512*this.overscaling):0,v=this.segments.prepareSegment(10*g,this.layoutVertexArray,this.indexArray);let w,C,D,k,S;this.e1=this.e2=-1,p&&(w=i[g-2],S=i[_].sub(w)._unit()._perp());for(let E=_;E<g;E++){if(D=E===g-1?p?i[_+1]:void 0:i[E+1],D&&i[E].equals(D))continue;S&&(k=S),w&&(C=w),w=i[E],S=D?D.sub(w)._unit()._perp():k,k=k||S;let A=k.add(S);0===A.x&&0===A.y||A._unit();const P=k.x*S.x+k.y*S.y,O=A.x*S.x+A.y*S.y,R=0!==O?1/O:1/0,F=2*Math.sqrt(2-2*O),B=O<xy&&C&&D,j=k.x*S.y-k.y*S.x>0;if(B&&E>_){const W=w.dist(C);if(W>2*y){const q=w.sub(w.sub(C)._mult(y/W)._round());this.updateDistance(C,q),this.addCurrentVertex(q,k,0,0,v),C=q}}const U=C&&D;let H=U?l:p?"butt":d;if(U&&"round"===H&&(R<m?H="miter":R<=2&&(H="fakeround")),"miter"===H&&R>u&&(H="bevel"),"bevel"===H&&(R>2&&(H="flipbevel"),R<u&&(H="miter")),C&&this.updateDistance(C,w),"miter"===H)A._mult(R),this.addCurrentVertex(w,A,0,0,v);else if("flipbevel"===H){if(R>100)A=S.mult(-1);else{const W=R*k.add(S).mag()/k.sub(S).mag();A._perp()._mult(W*(j?-1:1))}this.addCurrentVertex(w,A,0,0,v),this.addCurrentVertex(w,A.mult(-1),0,0,v)}else if("bevel"===H||"fakeround"===H){const W=-Math.sqrt(R*R-1),q=j?W:0,X=j?0:W;if(C&&this.addCurrentVertex(w,k,q,X,v),"fakeround"===H){const G=Math.round(180*F/Math.PI/20);for(let Q=1;Q<G;Q++){let it=Q/G;if(.5!==it){const J=it-.5;it+=it*J*(it-1)*((1.0904+P*(P*(3.55645-1.43519*P)-3.2452))*J*J+(.848013+P*(.215638*P-1.06021)))}const st=S.sub(k)._mult(it)._add(k)._unit()._mult(j?-1:1);this.addHalfVertex(w,st.x,st.y,!1,j,0,v)}}D&&this.addCurrentVertex(w,S,-q,-X,v)}else if("butt"===H)this.addCurrentVertex(w,A,0,0,v);else if("square"===H){const W=C?1:-1;C||this.addCurrentVertex(w,A,W,W,v),this.addCurrentVertex(w,A,0,0,v),C&&this.addCurrentVertex(w,A,W,W,v)}else"round"===H&&(C&&(this.addCurrentVertex(w,k,0,0,v),this.addCurrentVertex(w,k,1,1,v,!0)),D&&(this.addCurrentVertex(w,S,-1,-1,v,!0),this.addCurrentVertex(w,S,0,0,v)));if(B&&E<g-1){const W=w.dist(D);if(W>2*y){const q=w.add(D.sub(w)._mult(y/W)._round());this.updateDistance(w,q),this.addCurrentVertex(q,S,0,0,v),w=q}}}}addCurrentVertex(i,s,l,d,u,m=!1){const p=s.y*d-s.x,g=-s.y-s.x*d;this.addHalfVertex(i,s.x+s.y*l,s.y-s.x*l,m,!1,l,u),this.addHalfVertex(i,p,g,m,!0,-d,u)}addHalfVertex({x:i,y:s},l,d,u,m,p,g){this.layoutVertexArray.emplaceBack((i<<1)+(u?1:0),(s<<1)+(m?1:0),Math.round(63*l)+128,Math.round(63*d)+128,1+(0===p?0:p<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const _=g.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,_),g.primitiveLength++),m?this.e2=_:this.e1=_}updateScaledDistance(){if(this.lineClips){const i=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=i*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(i,s){this.distance+=i.dist(s),this.updateScaledDistance()}}de(wy,"LineBucket",{omit:["layers","patternFeatures"]});class Un{constructor(i,s,l,d){this.context=i,this.format=l,this.texture=i.gl.createTexture(),this.update(s,d)}update(i,s,l){const{width:d,height:u}=i,{context:m}=this,{gl:p}=m,{HTMLImageElement:g,HTMLCanvasElement:_,HTMLVideoElement:y,ImageData:v,ImageBitmap:w}=lt;if(p.bindTexture(p.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===p.RGBA&&(!s||!1!==s.premultiply)),l||this.size&&this.size[0]===d&&this.size[1]===u){const{x:C,y:D}=l||{x:0,y:0};if(i instanceof g||i instanceof _||i instanceof y||i instanceof v||w&&i instanceof w)p.texSubImage2D(p.TEXTURE_2D,0,C,D,p.RGBA,p.UNSIGNED_BYTE,i);else{let k=this.format,S=p.UNSIGNED_BYTE;this.format===p.R32F&&(k=p.RED,S=p.FLOAT),p.texSubImage2D(p.TEXTURE_2D,0,C,D,d,u,k,S,i.data)}}else if(this.size=[d,u],i instanceof g||i instanceof _||i instanceof y||i instanceof v||w&&i instanceof w){let C=this.format;this.format===p.R8&&(C=p.RED),p.texImage2D(p.TEXTURE_2D,0,this.format,C,p.UNSIGNED_BYTE,i)}else{let C=this.format,D=this.format,k=p.UNSIGNED_BYTE;this.format===p.DEPTH_COMPONENT&&(C=p.DEPTH_COMPONENT16,k=p.UNSIGNED_SHORT),this.format===p.R32F&&(k=p.FLOAT,D=p.RED),p.texImage2D(p.TEXTURE_2D,0,C,d,u,0,D,k,i.data)}this.useMipmap=!(!s||!s.useMipmap),this.useMipmap&&p.generateMipmap(p.TEXTURE_2D)}bind(i,s){const{context:l}=this,{gl:d}=l;d.bindTexture(d.TEXTURE_2D,this.texture),i!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap?i===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_NEAREST:i),this.minFilter=i),s!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,s),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(i,s,l,d){const{context:u}=this,{gl:m}=u;m.bindTexture(m.TEXTURE_2D,this.texture),s!==this.magFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,s),this.magFilter=s),i!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?i===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_NEAREST:i),this.minFilter=i),l!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,l),this.wrapS=l),d!==this.wrapT&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,d),this.wrapT=d)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class Wm{constructor(i,s){this.context=i,this.texture=s}bind(i,s){const{context:l}=this,{gl:d}=l;d.bindTexture(d.TEXTURE_2D,this.texture),i!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,i),this.minFilter=i),s!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,s),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,s),this.wrapS=s)}}const Oa=new Uint16Array(8184);for(let o=0;o<2046;o++){let i=o+2,s=0,l=0,d=0,u=0,m=0,p=0;for(1&i?d=u=m=32:s=l=p=32;(i>>=1)>1;){const _=s+d>>1,y=l+u>>1;1&i?(d=s,u=l,s=m,l=p):(s=d,l=u,d=m,u=p),m=_,p=y}const g=4*o;Oa[g+0]=s,Oa[g+1]=l,Oa[g+2]=d,Oa[g+3]=u}const br=new Uint16Array(2178),js=new Uint8Array(1089),Wu=new Uint16Array(1089);function ma(o){return 0===o?-.03125:32===o?.03125:0}var Ve=Xe([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const qu={type:2,extent:pt,loadGeometry:()=>[[new ot(0,0),new ot(pt+1,0),new ot(pt+1,pt+1),new ot(0,pt+1),new ot(0,0)]]};class tc{constructor(i,s,l,d,u){this.tileID=i,this.uid=jn(),this.uses=0,this.tileSize=s,this.tileZoom=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=u,d&&d.style&&(this._lastUpdatedBrightness=d.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",d&&d.transform&&(this.projection=d.transform.projection)}registerFadeDuration(i){const s=i+this.timeAdded;s<Ze.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Hu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(i,s,l){if(this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(d,u){const m={};if(!u)return m;for(const p of d){const g=p.layerIds.map(_=>u.getLayer(_)).filter(Boolean);if(0!==g.length){p.layers=g,p.stateDependentLayerIds&&(p.stateDependentLayers=p.stateDependentLayerIds.map(_=>g.filter(y=>y.id===_)[0]));for(const _ of g)m[_.fqid]=p}}return m}(i.buckets,s.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const u=this.buckets[d];if(u instanceof Gm){if(this.hasSymbolBuckets=!0,!l)break;u.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const u=this.buckets[d];if(u instanceof Gm&&u.hasRTLText){this.hasRTLText=!0,ro.isLoading()||ro.isLoaded()||"deferred"!==mb()||$o();break}}this.queryPadding=0;for(const d in this.buckets){const u=this.buckets[d],m=s.style.getOwnLayer(d);if(!m)continue;const p=m.queryRadius(u);this.queryPadding=Math.max(this.queryPadding,p)}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),i.lineAtlas&&(this.lineAtlas=i.lineAtlas),this._lastUpdatedBrightness=i.brightness}else this.collisionBoxArray=new qD}unloadVectorData(){if(this.hasData()){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(i){return this.buckets[i.fqid]}upload(i){for(const l in this.buckets){const d=this.buckets[l];d.uploadPending()&&d.upload(i)}const s=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Un(i,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Un(i,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Un(i,this.lineAtlas.image,s.ALPHA),this.lineAtlas.uploaded=!0)}prepare(i,s,l){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture,l),!s||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const d=s.style.getBrightness();(this._lastUpdatedBrightness||d)&&(this._lastUpdatedBrightness&&d&&Math.abs(this._lastUpdatedBrightness-d)<.001||(this._lastUpdatedBrightness=d,this.updateBuckets(void 0,s)))}queryRenderedFeatures(i,s,l,d,u,m,p,g){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:d,pixelPosMatrix:p,transform:m,params:u,tileTransform:this.tileTransform},i,s,l):{}}querySourceFeatures(i,s){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const d=l.loadVTLayers(),u=s?s.sourceLayer:"",m=d._geojsonTileLayer||d[u];if(!m)return;const p=am(s&&s.filter),{z:g,x:_,y}=this.tileID.canonical,v={z:g,x:_,y};for(let w=0;w<m.length;w++){const C=m.feature(w);if(p.needGeometry){const S=ql(C,!0);if(!p.filter(new zn(this.tileID.overscaledZ),S,this.tileID.canonical))continue}else if(!p.filter(new zn(this.tileID.overscaledZ),C))continue;const D=l.getId(C,u),k=new uw(C,g,_,y,D);k.tile=v,i.push(k)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}bucketsLoaded(){for(const i in this.buckets)if(this.buckets[i].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const s=this.expirationTime;if(i.cacheControl){const l=Ee(i.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const l=Date.now();let d=!1;if(this.expirationTime>l)d=!1;else if(s)if(this.expirationTime<s)d=!0;else{const u=this.expirationTime-s;u?this.expirationTime=l+Math.max(u,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(i,s){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(i).length&&s&&this.updateBuckets(i,s)}updateBuckets(i,s){if(!this.latestFeatureIndex)return;const l=this.latestFeatureIndex.loadVTLayers(),d=s.style.listImages(),u=s.style.getBrightness();for(const m in this.buckets){if(!s.style.hasLayer(m))continue;const p=this.buckets[m],g=p.layers[0].sourceLayer||"_geojsonTileLayer",_=l[g];let y={};if(i&&(y=i[g],!_||!y||0===Object.keys(y).length))continue;if(p.update(y,_,d,this.imageAtlas&&this.imageAtlas.patternPositions||{},u),p instanceof wy||p instanceof Lc){const w=s.style.getOwnSourceCache(p.layers[0].source);s._terrain&&s._terrain.enabled&&w&&p.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(w.id,this.tileID)}const v=s&&s.style&&s.style.getOwnLayer(m);v&&(this.queryPadding=Math.max(this.queryPadding,v.queryRadius(p)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ze.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=Ze.now()+i}setTexture(i,s){const l=s.context,d=l.gl;this.texture=this.texture||s.getTileTexture(i.width),this.texture&&this.texture instanceof Un?this.texture.update(i,{useMipmap:!0}):(this.texture=new Un(l,i,d.RGBA,{useMipmap:!0}),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE))}setDependencies(i,s){const l={};for(const d of s)l[d]=!0;this.dependencies[i]=l}hasDependency(i,s){for(const l of i){const d=this.dependencies[l];if(d)for(const u of s)if(d[u])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(i,s){if(!s||"mercator"===s.name||this._tileDebugBuffer)return;const l=ll(qu,this.tileID.canonical,this.tileTransform)[0],d=new Os,u=new vb;for(let m=0;m<l.length;m++){const{x:p,y:g}=l[m];d.emplaceBack(p,g),u.emplaceBack(m)}u.emplaceBack(0),this._tileDebugIndexBuffer=i.createIndexBuffer(u),this._tileDebugBuffer=i.createVertexBuffer(d,Ac.members),this._tileDebugSegments=on.simpleSegment(0,0,d.length,u.length)}_makeTileBoundsBuffers(i,s){if(this._tileBoundsBuffer||!s||"mercator"===s.name)return;const l=ll(qu,this.tileID.canonical,this.tileTransform)[0];let d,u;if(this.isRaster){const m=function(p,g){const _=Hu(p,g),y=Math.pow(2,p.z);for(let S=0;S<33;S++)for(let E=0;E<33;E++){const A=Ls((p.x+(E+ma(E))/32)/y),P=an((p.y+(S+ma(S))/32)/y),O=g.project(A,P),R=33*S+E;br[2*R+0]=Math.round((O.x*_.scale-_.x)*pt),br[2*R+1]=Math.round((O.y*_.scale-_.y)*pt)}js.fill(0),Wu.fill(0);for(let S=2045;S>=0;S--){const E=4*S,A=Oa[E+0],P=Oa[E+1],O=Oa[E+2],R=Oa[E+3],F=A+O>>1,B=P+R>>1,j=F+B-P,U=B+A-F,H=33*P+A,W=33*R+O,q=33*B+F,X=Math.hypot((br[2*H+0]+br[2*W+0])/2-br[2*q+0],(br[2*H+1]+br[2*W+1])/2-br[2*q+1])>=16;js[q]=js[q]||(X?1:0),S<1022&&(js[q]=js[q]||js[33*(P+U>>1)+(A+j>>1)]||js[33*(R+U>>1)+(O+j>>1)])}const v=new bu,w=new Cr;let C=0;function D(S,E){const A=33*E+S;return 0===Wu[A]&&(v.emplaceBack(br[2*A+0],br[2*A+1],S*pt/32,E*pt/32),Wu[A]=++C),Wu[A]-1}function k(S,E,A,P,O,R){const F=S+A>>1,B=E+P>>1;if(Math.abs(S-O)+Math.abs(E-R)>1&&js[33*B+F])k(O,R,S,E,F,B),k(A,P,O,R,F,B);else{const j=D(S,E),U=D(A,P),H=D(O,R);w.emplaceBack(j,U,H)}}return k(0,0,32,32,32,0),k(32,32,0,0,0,32),{vertices:v,indices:w}}(this.tileID.canonical,s);d=m.vertices,u=m.indices}else{d=new bu,u=new Cr;for(const{x:p,y:g}of l)d.emplaceBack(p,g,0,0);const m=sg(d.int16,void 0,4);for(let p=0;p<m.length;p+=3)u.emplaceBack(m[p],m[p+1],m[p+2])}this._tileBoundsBuffer=i.createVertexBuffer(d,Ve.members),this._tileBoundsIndexBuffer=i.createIndexBuffer(u),this._tileBoundsSegments=on.simpleSegment(0,0,d.length,u.length)}_makeGlobeTileDebugBuffers(i,s){const l=s.projection;if(!l||"globe"!==l.name||s.freezeTileCoverage)return;const d=this.tileID.canonical,u=kd(Hk(d,s)),m=Dr(s.zoom);let p;m>0&&(p=at.invert(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(i,d,s,u,p,m),this._makeGlobeTileDebugTextBuffer(i,d,s,u,p,m)}_globePoint(i,s,l,d,u,m,p){let g=Kf(i,s,l);if(m){const _=1<<l.z,y=dr(d.center.lng),v=Rr(d.center.lat),w=(l.x+.5)/_-y;let C=0;w>.5?C=-1:w<-.5&&(C=1);let D=(i/pt+l.x)/_+C,k=(s/pt+l.y)/_;D=(D-y)*d._pixelsPerMercatorPixel+y,k=(k-v)*d._pixelsPerMercatorPixel+v;const S=[D*d.worldSize,k*d.worldSize,0];Z.transformMat4(S,S,m),g=Rc(g,S,p)}return Z.transformMat4(g,g,u)}_makeGlobeTileDebugBorderBuffer(i,s,l,d,u,m){const p=new Os,g=new vb,_=new Vl,y=(w,C,D,k,S)=>{const E=(D-w)/(S-1),A=(k-C)/(S-1),P=p.length;for(let O=0;O<S;O++){const R=w+O*E,F=C+O*A;p.emplaceBack(R,F);const B=this._globePoint(R,F,s,l,d,u,m);_.emplaceBack(B[0],B[1],B[2]),g.emplaceBack(P+O)}},v=pt;y(0,0,v,0,16),y(v,0,v,v,16),y(v,v,0,v,16),y(0,v,0,0,16),this._tileDebugIndexBuffer=i.createIndexBuffer(g),this._tileDebugBuffer=i.createVertexBuffer(p,Ac.members),this._globeTileDebugBorderBuffer=i.createVertexBuffer(_,ym.members),this._tileDebugSegments=on.simpleSegment(0,0,p.length,g.length)}_makeGlobeTileDebugTextBuffer(i,s,l,d,u,m){const p=pt/4,g=new Os,_=new Cr,y=new Vl,v=25;_.reserve(32),g.reserve(v),y.reserve(v);const w=(C,D)=>v*C+D;for(let C=0;C<v;C++){const D=C*p;for(let k=0;k<v;k++){const S=k*p;g.emplaceBack(S,D);const E=this._globePoint(S,D,s,l,d,u,m);y.emplaceBack(E[0],E[1],E[2])}}for(let C=0;C<4;C++)for(let D=0;D<4;D++){const k=w(C,D),S=w(C,D+1),E=w(C+1,D),A=w(C+1,D+1);_.emplaceBack(k,S,E),_.emplaceBack(E,S,A)}this._tileDebugTextIndexBuffer=i.createIndexBuffer(_),this._tileDebugTextBuffer=i.createVertexBuffer(g,Ac.members),this._globeTileDebugTextBuffer=i.createVertexBuffer(y,ym.members),this._tileDebugTextSegments=on.simpleSegment(0,0,v,32)}destroy(i=!1){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!i&&this.texture&&this.texture instanceof Un&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.latestFeatureIndex=null,this.state="unloaded"}}class qm{constructor(i,s){this.max=i,this.onRemove=s,this.reset()}reset(){for(const i in this.data)for(const s of this.data[i])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(i,s,l){const d=i.wrapped().key;void 0===this.data[d]&&(this.data[d]=[]);const u={value:s,timeout:void 0};if(void 0!==l&&(u.timeout=setTimeout(()=>{this.remove(i,u)},l)),this.data[d].push(u),this.order.push(d),this.order.length>this.max){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const s=this.data[i].shift();return s.timeout&&clearTimeout(s.timeout),0===this.data[i].length&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),s.value}getByKey(i){const s=this.data[i];return s?s[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,s){if(!this.has(i))return this;const l=i.wrapped().key,d=void 0===s?0:this.data[l].indexOf(s),u=this.data[l][d];return this.data[l].splice(d,1),u.timeout&&clearTimeout(u.timeout),0===this.data[l].length&&delete this.data[l],this.onRemove(u.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(i){const s=[];for(const l in this.data)for(const d of this.data[l])i(d.value)||s.push(d);for(const l of s)this.remove(l.value.tileID,l)}}let Yu=(()=>{class o{constructor(s,l,d,u){this.id=o.uniqueIdxCounter,o.uniqueIdxCounter++,this.context=s;const m=s.gl;this.buffer=m.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||u||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){this.id=o.uniqueIdxCounter,o.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}return o.uniqueIdxCounter=0,o})();const Ym={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Zm{constructor(i,s,l,d,u,m){this.length=s.length,this.attributes=l,this.itemSize=s.bytesPerElement,this.dynamicDraw=d,this.instanceCount=m,this.context=i;const p=i.gl;this.buffer=p.createBuffer(),i.bindVertexBuffer.set(this.buffer),p.bufferData(p.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||u||s.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,s){for(let l=0;l<this.attributes.length;l++){const d=s.attributes[this.attributes[l].name];void 0!==d&&i.enableVertexAttribArray(d)}}setVertexAttribPointers(i,s,l){for(let d=0;d<this.attributes.length;d++){const u=this.attributes[d],m=s.attributes[u.name];void 0!==m&&i.vertexAttribPointer(m,u.components,i[Ym[u.type]],!1,this.itemSize,u.offset+this.itemSize*(l||0))}}setVertexAttribDivisor(i,s,l){for(let d=0;d<this.attributes.length;d++){const u=s.attributes[this.attributes[d].name];void 0!==u&&this.instanceCount&&this.instanceCount>0&&i.vertexAttribDivisor(u,l)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class _n{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Xm extends _n{getDefault(){return di.transparent}set(i){const s=this.current;(i.r!==s.r||i.g!==s.g||i.b!==s.b||i.a!==s.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Km extends _n{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class XS extends _n{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class KS extends _n{getDefault(){return[!0,!0,!0,!0]}set(i){const s=this.current;(i[0]!==s[0]||i[1]!==s[1]||i[2]!==s[2]||i[3]!==s[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class QS extends _n{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class JS extends _n{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class tT extends _n{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const s=this.current;(i.func!==s.func||i.ref!==s.ref||i.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class eT extends _n{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const s=this.current;(i[0]!==s[0]||i[1]!==s[1]||i[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class iT extends _n{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;i?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=i,this.dirty=!1}}class nT extends _n{getDefault(){return[0,1]}set(i){const s=this.current;(i[0]!==s[0]||i[1]!==s[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class rT extends _n{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;i?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=i,this.dirty=!1}}class Mw extends _n{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class lO extends _n{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;i?s.enable(s.BLEND):s.disable(s.BLEND),this.current=i,this.dirty=!1}}class J3 extends _n{getDefault(){const i=this.gl;return[i.ONE,i.ZERO,i.ONE,i.ZERO]}set(i){const s=this.current;(i[0]!==s[0]||i[1]!==s[1]||i[2]!==s[2]||i[3]!==s[3]||this.dirty)&&(this.gl.blendFuncSeparate(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class tV extends _n{getDefault(){return di.transparent}set(i){const s=this.current;(i.r!==s.r||i.g!==s.g||i.b!==s.b||i.a!==s.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class cO extends _n{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(i,i),this.current=i,this.dirty=!1)}}class dO extends _n{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;i?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=i,this.dirty=!1}}class eV extends _n{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class uO extends _n{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}let iV=class extends _n{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}};class hO extends _n{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class mO extends _n{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const s=this.current;(i[0]!==s[0]||i[1]!==s[1]||i[2]!==s[2]||i[3]!==s[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class pO extends _n{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Dw extends _n{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class xg extends _n{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class kw extends _n{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Cy extends _n{getDefault(){return null}set(i){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class oT extends _n{getDefault(){return null}set(i){this.gl&&(i!==this.current||this.dirty)&&(this.gl.bindVertexArray(i),this.current=i,this.dirty=!1)}}class wg extends _n{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class sT extends _n{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class fO extends _n{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class Zu extends _n{constructor(i,s){super(i),this.context=i,this.parent=s}getDefault(){return null}}class gO extends Zu{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class aT extends Zu{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,this.attachment(),s.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class _O extends Zu{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,this.attachment(),s.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class bO extends aT{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Sw{constructor(i,s,l,d,u){this.context=i,this.width=s,this.height=l;const m=this.framebuffer=i.gl.createFramebuffer();d&&(this.colorAttachment=new gO(i,m)),u&&(this.depthAttachmentType=u,this.depthAttachment="renderbuffer"===u?new aT(i,m):new _O(i,m))}destroy(){const i=this.context.gl;if(this.colorAttachment){const s=this.colorAttachment.get();s&&i.deleteTexture(s)}if(this.depthAttachment&&this.depthAttachmentType)if("renderbuffer"===this.depthAttachmentType){const s=this.depthAttachment.get();s&&i.deleteRenderbuffer(s)}else{const s=this.depthAttachment.get();s&&i.deleteTexture(s)}i.deleteFramebuffer(this.framebuffer)}}class Be{constructor(i,s,l){this.func=i,this.mask=s,this.range=l}}Be.ReadOnly=!1,Be.ReadWrite=!0,Be.disabled=new Be(519,Be.ReadOnly,[0,1]);class pi{constructor(i,s,l,d,u,m){this.test=i,this.ref=s,this.mask=l,this.fail=d,this.depthFail=u,this.pass=m}}pi.disabled=new pi({func:519,mask:0},0,0,7680,7680,7680);class ji{constructor(i,s,l,d){this.blendFunction=i,this.blendColor=s,this.mask=l,this.blendEquation=d}}ji.Replace=[1,0,1,0],ji.disabled=new ji(ji.Replace,di.transparent,[!1,!1,!1,!1]),ji.unblended=new ji(ji.Replace,di.transparent,[!0,!0,!0,!0]),ji.alphaBlended=new ji([1,771,1,771],di.transparent,[!0,!0,!0,!0]),ji.multiply=new ji([774,0,774,0],di.transparent,[!0,!0,!0,!0]);class hi{constructor(i,s,l){this.enable=i,this.mode=s,this.frontFace=l}}hi.disabled=new hi(!1,1029,2305),hi.backCCW=new hi(!0,1029,2305),hi.backCW=new hi(!0,1029,2304),hi.frontCW=new hi(!0,1028,2304),hi.frontCCW=new hi(!0,1028,2305);class yO{constructor(i,s){this.gl=i,this.clearColor=new Xm(this),this.clearDepth=new Km(this),this.clearStencil=new XS(this),this.colorMask=new KS(this),this.depthMask=new QS(this),this.stencilMask=new JS(this),this.stencilFunc=new tT(this),this.stencilOp=new eT(this),this.stencilTest=new iT(this),this.depthRange=new nT(this),this.depthTest=new rT(this),this.depthFunc=new Mw(this),this.blend=new lO(this),this.blendFunc=new J3(this),this.blendColor=new tV(this),this.blendEquation=new cO(this),this.cullFace=new dO(this),this.cullFaceSide=new eV(this),this.frontFace=new uO(this),this.program=new iV(this),this.activeTexture=new hO(this),this.viewport=new mO(this),this.bindFramebuffer=new pO(this),this.bindRenderbuffer=new Dw(this),this.bindTexture=new xg(this),this.bindVertexBuffer=new kw(this),this.bindElementBuffer=new Cy(this),this.bindVertexArrayOES=new oT(this),this.pixelStoreUnpack=new wg(this),this.pixelStoreUnpackPremultiplyAlpha=new sT(this),this.pixelStoreUnpackFlipY=new fO(this),this.options=s?{...s}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=i.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=i.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=i.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=i.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,s,l){return new Yu(this,i,s,l)}createVertexBuffer(i,s,l,d,u){return new Zm(this,i,s,l,d,u)}createRenderbuffer(i,s,l){const d=this.gl,u=d.createRenderbuffer();return this.bindRenderbuffer.set(u),d.renderbufferStorage(d.RENDERBUFFER,i,s,l),this.bindRenderbuffer.set(null),u}createFramebuffer(i,s,l,d){return new Sw(this,i,s,l,d)}clear({color:i,depth:s,stencil:l,colorMask:d}){const u=this.gl;let m=0;i&&(m|=u.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set(d||[!0,!0,!0,!0])),void 0!==s&&(m|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),void 0!==l&&(m|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),u.clear(m)}setCullFace(i){!1===i.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){Ni(i.blendFunction,ji.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor),i.blendEquation?this.blendEquation.set(i.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(i.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class ul extends gi{constructor(i,s,l){super(),this.id=i,this._onlySymbols=l,s.on("data",d=>{"source"===d.dataType&&"metadata"===d.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===d.dataType&&"content"===d.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new qm(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this._coveredTiles={},this._shadowCasterTiles={},this._state=new jP,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(i){this.map=i,this._minTileCacheSize=void 0===this._minTileCacheSize&&i?i._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&i?i._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const s=this._tiles[i];if("errored"!==s.state&&("loaded"!==s.state||!s.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(i,s){return i.isSymbolTile=this._onlySymbols,i.isExtraShadowCaster=this._shadowCasterTiles[i.tileID.key],this._source.loadTile(i,s)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){if(this._source.abortTile)return this._source.abortTile(i,()=>{})}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const l=this._tiles[s];l.upload(i),l.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return we(this._tiles).map(i=>i.tileID).sort(Kt).map(i=>i.key)}getRenderableIds(i,s){const l=[];for(const d in this._tiles)this._isIdRenderable(+d,i,s)&&l.push(this._tiles[d]);return i?l.sort((d,u)=>{const m=d.tileID,p=u.tileID,g=new ot(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),_=new ot(p.canonical.x,p.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-p.overscaledZ||_.y-g.y||_.x-g.x}).map(d=>d.tileID.key):l.map(d=>d.tileID).sort(Kt).map(d=>d.key)}hasRenderableParent(i){const s=this.findLoadedParent(i,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(i,s,l){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(s||!this._tiles[i].holdingForFade())&&(l||!this._shadowCasterTiles[i])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)"errored"!==this._tiles[i].state&&this._reloadTile(+i,"reloading")}}_reloadTile(i,s){const l=this._tiles[i];l&&("loading"!==l.state&&(l.state=s),this._loadTile(l,this._tileLoaded.bind(this,l,i,s)))}_tileLoaded(i,s,l,d){if(d)if(i.state="errored",404!==d.status)this._source.fire(new Yt(d,{tile:i}));else{if(!(i.tileID.key in this._loadedParentTiles))return void this._source.fire(new Bt("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const u=this.map.painter.terrain;this.update(this.transform,u.getScaledDemTileSize(),!0),u.resetTileLookupCache(this.id)}else this.update(this.transform)}else i.timeAdded=Ze.now(),"expired"===l&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(s,i),"raster-dem"===this._source.type&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new Bt("data",{dataType:"source",tile:i,coord:i.tileID,sourceCacheId:this.id}))}_backfillDEM(i){const s=this.getRenderableIds();for(let d=0;d<s.length;d++){const u=s[d];if(i.neighboringTiles&&i.neighboringTiles[u]){const m=this.getTileByID(u);l(i,m),l(m,i)}}function l(d,u){if(!d.dem||d.dem.borderReady)return;d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0;let m=u.tileID.canonical.x-d.tileID.canonical.x;const p=u.tileID.canonical.y-d.tileID.canonical.y,g=Math.pow(2,d.tileID.canonical.z),_=u.tileID.key;0===m&&0===p||Math.abs(p)>1||(Math.abs(m)>1&&(1===Math.abs(m+g)?m+=g:1===Math.abs(m-g)&&(m-=g)),u.dem&&d.dem&&(d.dem.backfillBorder(u.dem,m,p),d.neighboringTiles&&d.neighboringTiles[_]&&(d.neighboringTiles[_].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,s,l,d){for(const u in this._tiles){let m=this._tiles[u];if(d[u]||!m.hasData()||m.tileID.overscaledZ<=s||m.tileID.overscaledZ>l)continue;let p=m.tileID;for(;m&&m.tileID.overscaledZ>s+1;){const _=m.tileID.scaledTo(m.tileID.overscaledZ-1);m=this._tiles[_.key],m&&m.hasData()&&(p=_)}let g=p;for(;g.overscaledZ>s;)if(g=g.scaledTo(g.overscaledZ-1),i[g.key]){d[p.key]=p;break}}}findLoadedParent(i,s){if(i.key in this._loadedParentTiles){const l=this._loadedParentTiles[i.key];return l&&l.tileID.overscaledZ>=s?l:null}for(let l=i.overscaledZ-1;l>=s;l--){const d=i.scaledTo(l),u=this._getLoadedTile(d);if(u)return u}}_getLoadedTile(i){const s=this._tiles[i.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?i.wrapped().key:i.canonical.key)}updateCacheSize(i,s){s=s||this._source.tileSize;const l=Math.ceil(i.width/s)+1,d=Math.ceil(i.height/s)+1,u=Math.floor(l*d*5),m="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,u):u,p="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(p)}handleWrapJump(i){const s=Math.round((i-(void 0===this._prevLng?i:this._prevLng))/360);if(this._prevLng=i,s){const l={};for(const d in this._tiles){const u=this._tiles[d];u.tileID=u.tileID.unwrapTo(u.tileID.wrap+s),l[u.tileID.key]=u}this._tiles=l;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(+d,this._tiles[d])}}update(i,s,l,d){if(this.transform=i,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!l)return;let u;if(this.updateCacheSize(i,s),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(g=>new Ri(g.canonical.z,g.wrap,g.canonical.z,g.canonical.x,g.canonical.y)):(u=i.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(g=>this._source.hasTile(g)))):u=[],u.length>0&&this.castsShadows&&d&&"globe"!==this.transform.projection.name&&!this.usedForTerrain&&!Dy(this._source.type)){const g=i.coveringZoomLevel({tileSize:s||this._source.tileSize,roundZoom:this._source.roundZoom&&!l}),_=Math.min(g,this._source.maxzoom),y=i.extendTileCoverForShadows(u,d,_);for(const v of y)this._shadowCasterTiles[v.key]=!0,u.push(v)}const m=this._updateRetainedTiles(u);if(Dy(this._source.type)&&0!==u.length){const g={},_={},y=Object.keys(m);for(const w of y){const C=m[w],D=this._tiles[w];if(!D||D.fadeEndTime&&D.fadeEndTime<=Ze.now())continue;const k=this.findLoadedParent(C,Math.max(C.overscaledZ-ul.maxOverzooming,this._source.minzoom));k&&(this._addTile(k.tileID),g[k.tileID.key]=k.tileID),_[w]=C}const v=u[u.length-1].overscaledZ;for(const w in this._tiles){const C=this._tiles[w];if(m[w]||!C.hasData())continue;let D=C.tileID;for(;D.overscaledZ>v;){D=D.scaledTo(D.overscaledZ-1);const k=this._tiles[D.key];if(k&&k.hasData()&&_[D.key]){m[w]=C.tileID;break}}}for(const w in g)m[w]||(this._coveredTiles[w]=!0,m[w]=g[w])}for(const g in m)this._tiles[g].clearFadeHold();const p=function(g,_){const y=[];for(const v in g)v in _||y.push(v);return y}(this._tiles,m);for(const g of p){const _=this._tiles[g];_.hasSymbolBuckets&&!_.holdingForFade()?_.setHoldDuration(this.map._fadeDuration):_.hasSymbolBuckets&&!_.symbolFadeFinished()||this._removeTile(+g)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(+i)}_updateRetainedTiles(i){const s={};if(0===i.length)return s;const l={},d=i.reduce((_,y)=>Math.min(_,y.overscaledZ),1/0),u=i[0].overscaledZ,m=Math.max(u-ul.maxOverzooming,this._source.minzoom),p=Math.max(u+ul.maxUnderzooming,this._source.minzoom),g={};for(const _ of i){const y=this._addTile(_);s[_.key]=_,y.hasData()||d<this._source.maxzoom&&(g[_.key]=_)}this._retainLoadedChildren(g,d,p,s);for(const _ of i){let y=this._tiles[_.key];if(y.hasData())continue;if(_.canonical.z>=this._source.maxzoom){const w=_.children(this._source.maxzoom)[0],C=this.getTile(w);if(C&&C.hasData()){s[w.key]=w;continue}}else{const w=_.children(this._source.maxzoom);if(s[w[0].key]&&s[w[1].key]&&s[w[2].key]&&s[w[3].key])continue}let v=y.wasRequested();for(let w=_.overscaledZ-1;w>=m;--w){const C=_.scaledTo(w);if(l[C.key]||(l[C.key]=!0,y=this.getTile(C),!y&&v&&(y=this._addTile(C)),y&&(s[C.key]=C,v=y.wasRequested(),y.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const s=[];let l,d=this._tiles[i].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){l=this._loadedParentTiles[d.key];break}s.push(d.key);const u=d.scaledTo(d.overscaledZ-1);if(l=this._getLoadedTile(u),l)break;d=u}for(const u of s)this._loadedParentTiles[u]=l}}_addTile(i){let s=this._tiles[i.key];if(s)return!0!==s.isExtraShadowCaster||this._shadowCasterTiles[i.key]||this._reloadTile(i.key,"reloading"),s;s=this._cache.getAndRemove(i),s&&(this._setTileReloadTimer(i.key,s),s.tileID=i,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,s)));const l=!!s;if(!l){const d=this.map?this.map.painter:null;s=new tc(i,this._source.tileSize*i.overscaleFactor(),this.transform.tileZoom,d,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,i.key,s.state))}return s?(s.uses++,this._tiles[i.key]=s,l||this._source.fire(new Bt("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(i,s){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const l=s.getExpiryTimeout();l&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},l))}_removeTile(i){const s=this._tiles[i];s&&(s.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),s.uses>0||(s.hasData()&&"reloading"!==s.state?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(+i);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(i,s,l){const d=[],u=this.transform;if(!u)return d;const m="globe"===u.projection.name,p=dr(u.center.lng);for(const g in this._tiles){const _=this._tiles[g];if(l&&_.clearQueryDebugViz(),_.holdingForFade())continue;let y;if(m){const v=_.tileID.canonical;if(0===v.z){const w=[Math.abs(he(p,...Jm(v,-1))-p),Math.abs(he(p,...Jm(v,1))-p)];y=[0,2*w.indexOf(Math.min(...w))-1]}else{const w=[Math.abs(he(p,...Jm(v,-1))-p),Math.abs(he(p,...Jm(v,0))-p),Math.abs(he(p,...Jm(v,1))-p)];y=[w.indexOf(Math.min(...w))-1]}}else y=[0];for(const v of y){const w=i.containsTile(_,u,s,v);w&&d.push(w)}}return d}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(i){return this._getRenderableCoordinates(i)}_getRenderableCoordinates(i,s){const l=this.getRenderableIds(i,s).map(u=>this._tiles[u].tileID),d="globe"===this.transform.projection.name;for(const u of l)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped()),u.expandedProjMatrix=d?this.transform.calculateProjMatrix(u.toUnwrapped(),!1,!0):u.projMatrix;return l}sortCoordinatesByDistance(i){const s=i.slice(),l=this.transform._camera.position,d=this.transform._camera.forward(),u={};for(const m of s){const p=1/(1<<m.canonical.z);u[m.key]=((m.canonical.x+.5)*p+m.wrap-l[0])*d[0]+((m.canonical.y+.5)*p-l[1])*d[1]-l[2]*d[2]}return s.sort((m,p)=>u[m.key]-u[p.key]),s}hasTransition(){if(this._source.hasTransition())return!0;if(Dy(this._source.type))for(const i in this._tiles){const s=this._tiles[i];if(void 0!==s.fadeEndTime&&s.fadeEndTime>=Ze.now())return!0}return!1}setFeatureState(i,s,l){this._state.updateState(i=i||"_geojsonTileLayer",s,l)}removeFeatureState(i,s,l){this._state.removeFeatureState(i=i||"_geojsonTileLayer",s,l)}getFeatureState(i,s){return this._state.getState(i=i||"_geojsonTileLayer",s)}setDependencies(i,s,l){const d=this._tiles[i];d&&d.setDependencies(s,l)}reloadTilesForDependencies(i,s){for(const l in this._tiles)this._tiles[l].hasDependency(i,s)&&this._reloadTile(+l,"reloading");this._cache.filter(l=>!l.hasDependency(i,s))}_preloadTiles(i,s){if(!this._sourceLoaded){const p=()=>{this._sourceLoaded&&(this._source.off("data",p),this._preloadTiles(i,s))};return void this._source.on("data",p)}const l=new Map,d=Array.isArray(i)?i:[i],u=this.map.painter.terrain,m=this.usedForTerrain&&u?u.getScaledDemTileSize():this._source.tileSize;for(const p of d){const g=p.coveringTiles({tileSize:m,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const _ of g)l.set(_.key,_);this.usedForTerrain&&p.updateElevation(!1)}tu(Array.from(l.values()),(p,g)=>{const _=new tc(p,this._source.tileSize*p.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(_,y=>{"raster-dem"===this._source.type&&_.dem&&this._backfillDEM(_),g(y,_)})},s)}}function Kt(o,i){const s=Math.abs(2*o.wrap)-+(o.wrap<0),l=Math.abs(2*i.wrap)-+(i.wrap<0);return o.overscaledZ-i.overscaledZ||l-s||i.canonical.y-o.canonical.y||i.canonical.x-o.canonical.x}function Dy(o){return"raster"===o||"image"===o||"video"===o||"custom"===o}function Jm(o,i){const s=1<<o.z;return[o.x/s+i,(o.x+1)/s+i]}ul.maxOverzooming=10,ul.maxUnderzooming=3;const vO=Xe([{name:"a_pos_3f",components:3,type:"Float32"}]),xO=Xe([{name:"a_color_3f",components:3,type:"Float32"}]),wO=Xe([{name:"a_color_4f",components:4,type:"Float32"}]),Kr=Xe([{name:"a_uv_2f",components:2,type:"Float32"}]),It=Xe([{name:"a_normal_3f",components:3,type:"Float32"}]),Ew=Xe([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),CO=Xe([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class ht{constructor(i=0,s=0,l=0,d=0){if(isNaN(i)||i<0||isNaN(s)||s<0||isNaN(l)||l<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=s,this.left=l,this.right=d}interpolate(i,s,l){return null!=s.top&&null!=i.top&&(this.top=_e(i.top,s.top,l)),null!=s.bottom&&null!=i.bottom&&(this.bottom=_e(i.bottom,s.bottom,l)),null!=s.left&&null!=i.left&&(this.left=_e(i.left,s.left,l)),null!=s.right&&null!=i.right&&(this.right=_e(i.right,s.right,l)),this}getCenter(i,s){const l=he((this.left+i-this.right)/2,0,i),d=he((this.top+s-this.bottom)/2,0,s);return new ot(l,d)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new ht(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ft(o,i){const s=tr(o,3);at.fromQuat(o,i),eo(o,3,s)}function je(o,i){const s=_o.identity([]);return _o.rotateZ(s,s,-i),_o.rotateX(s,s,-o),s}function Aw(o,i){const s=[o[0],o[1],0],l=[i[0],i[1],0];if(Z.length(s)>=1e-15){const m=Z.normalize([],s);Z.scale(l,m,Z.dot(l,m)),i[0]=l[0],i[1]=l[1]}const d=Z.cross([],i,o);if(Z.len(d)<1e-15)return null;const u=Math.atan2(-d[1],d[0]);return je(Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2]),u)}class lT{constructor(i,s){this.position=i,this.orientation=s}get position(){return this._position}set position(i){if(i){const s=i instanceof Ei?i:new Ei(i[0],i[1],i[2]);this._renderWorldCopies&&(s.x=Rl(s.x,0,1)),this._position=s}else this._position=null}lookAtPoint(i,s){if(this.orientation=null,!this.position)return;const l=this.position,d=this._elevation?this._elevation.getAtPointOrZero(Ei.fromLngLat(i)):0,u=Ei.fromLngLat(i,d),m=[u.x-l.x,u.y-l.y,u.z-l.z];s||(s=[0,0,1]),s[2]=Math.abs(s[2]),this.orientation=Aw(m,s)}setPitchBearing(i,s){this.orientation=je(ni(i),ni(-s))}}class ky{constructor(i,s){this._transform=at.identity([]),this.orientation=s,this.position=i}get mercatorPosition(){const i=this.position;return new Ei(i[0],i[1],i[2])}get position(){const i=tr(this._transform,3);return[i[0],i[1],i[2]]}set position(i){var s;i&&eo(this._transform,3,[(s=i)[0],s[1],s[2],1])}get orientation(){return this._orientation}set orientation(i){this._orientation=i||_o.identity([]),i&&ft(this._transform,this._orientation)}getPitchBearing(){const i=this.forward(),s=this.right();return{bearing:Math.atan2(-s[1],s[0]),pitch:Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2])}}setPitchBearing(i,s){this._orientation=je(i,s),ft(this._transform,this._orientation)}forward(){const i=tr(this._transform,2);return[-i[0],-i[1],-i[2]]}up(){const i=tr(this._transform,1);return[-i[0],-i[1],-i[2]]}right(){const i=tr(this._transform,0);return[i[0],i[1],i[2]]}getCameraToWorld(i,s){const l=new Float64Array(16);return at.invert(l,this.getWorldToCamera(i,s)),l}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(i,s,l){const d=this.position;Z.scale(d,d,-i);const u=new Float64Array(16);return at.fromScaling(u,[l,l,l]),at.translate(u,u,d),u[10]*=s,u}getWorldToCamera(i,s){const l=new Float64Array(16),d=new Float64Array(4),u=this.position;return _o.conjugate(d,this._orientation),Z.scale(u,u,-i),at.fromQuat(l,d),at.translate(l,l,u),l[1]*=-1,l[5]*=-1,l[9]*=-1,l[13]*=-1,l[8]*=s,l[9]*=s,l[10]*=s,l[11]*=s,l}getCameraToClipPerspective(i,s,l,d){const u=new Float64Array(16);return at.perspective(u,i,s,l,d),u}getCameraToClipOrthographic(i,s,l,d,u,m){const p=new Float64Array(16);return at.ortho(p,i,s,l,d,u,m),p}getDistanceToElevation(i,s=!1){const l=0===i?0:sn(i,s?an(this.position[1]):this.position[1]),d=this.forward();return(l-this.position[2])/d[2]}clone(){return new ky([...this.position],[...this.orientation])}}function cT(o,i){const s=Qr(o.projection,o.zoom,o.width,o.height),l=function(u,m,p,g,_){const y=new qe(p.lng-180*yo,p.lat),v=new qe(p.lng+180*yo,p.lat),w=u.project(y.lng,y.lat),C=u.project(v.lng,v.lat),D=-Math.atan2(C.y-w.y,C.x-w.x),k=Ei.fromLngLat(p);k.y=he(k.y,-1+yo,1-yo);const S=k.toLngLat(),E=u.project(S.lng,S.lat),A=Ei.fromLngLat(S);A.x+=yo;const P=A.toLngLat(),O=u.project(P.lng,P.lat),R=dT(O.x-E.x,O.y-E.y,D),F=Ei.fromLngLat(S);F.y+=yo;const B=F.toLngLat(),j=u.project(B.lng,B.lat),U=dT(j.x-E.x,j.y-E.y,D),H=Math.abs(R.x)/Math.abs(U.y),W=at.identity([]);at.rotateZ(W,W,-D*(1-(_?0:g)));const q=at.identity([]);return at.scale(q,q,[1,1-(1-H)*g,1]),q[4]=-U.x/U.y*g,at.rotateZ(q,q,D),at.multiply(q,W,q),q}(o.projection,0,o.center,s,i),d=Eo(o);return at.scale(l,l,[d,d,1]),l}function Eo(o){const i=o.projection,s=Qr(o.projection,o.zoom,o.width,o.height),l=Iw(i,o.center),d=Iw(i,qe.convert(i.center));return Math.pow(2,l*s+(1-s)*d)}function Qr(o,i,s,l,d=1/0){const u=o.range;if(!u)return 0;const m=Math.min(d,Math.max(s,l)),p=Math.log(m/1024)/Math.LN2;return Il(u[0]+p,u[1]+p,i)}const yo=1/4e4;function Iw(o,i){const s=he(i.lat,-or,or),l=new qe(i.lng-180*yo,s),d=new qe(i.lng+180*yo,s),u=o.project(l.lng,s),m=o.project(d.lng,s),p=Ei.fromLngLat(l),g=Ei.fromLngLat(d),_=m.x-u.x,y=m.y-u.y,v=g.x-p.x,w=g.y-p.y,C=Math.sqrt((v*v+w*w)/(_*_+y*y));return Math.log(C)/Math.LN2}function dT(o,i,s){const l=Math.cos(s),d=Math.sin(s);return{x:o*l-i*d,y:o*d+i*l}}function Xu(o,i,s){return i*(pt/(o.tileSize*Math.pow(2,s-o.tileID.overscaledZ)))}const vo={unknown:0,flipRequired:1,flipNotRequired:2},Mg=Math.tan(85*Math.PI/180);function Dg(o,i,s,l,d,u,m){const p=at.create();if(s)if("globe"===u.name){const g=function(_,y){const{x:v,y:w}=_.point,C=qk(v,w,_.worldSize/_._pixelsPerMercatorPixel,0,0);return at.multiply(C,C,Vb(da(y)))}(d,i);at.multiply(p,p,g)}else{const g=bm.invert([],m);p[0]=g[0],p[1]=g[1],p[4]=g[2],p[5]=g[3],l||at.rotateZ(p,p,d.angle)}else at.multiply(p,d.labelPlaneMatrix,o);return p}function Se(o,i,s,l,d,u,m){const p=Dg(o,i,s,l,d,u,m);return"globe"===u.name&&s||(p[2]=p[6]=p[10]=p[14]=0),p}function kg(o,i,s,l,d,u,m){if(s){if("globe"===u.name){const p=Dg(o,i,s,l,d,u,m);return at.invert(p,p),at.multiply(p,o,p),p}{const p=at.clone(o),g=at.identity([]);return g[0]=m[0],g[1]=m[1],g[4]=m[2],g[5]=m[3],at.multiply(p,p,g),l||at.rotateZ(p,p,-d.angle),p}}return d.glCoordMatrix}function hl(o,i,s,l){const d=[o,i,s,1];s?Qi.transformMat4(d,d,l):Pw(d,d,l);const u=d[3];return d[0]/=u,d[1]/=u,d[2]/=u,d}function Rw(o,i){return Math.min(.5+o/i*.5,1.5)}function uT(o,i){const s=o[0]/o[3],l=o[1]/o[3];return s>=-i[0]&&s<=i[0]&&l>=-i[1]&&l<=i[1]}function hT(o,i,s,l,d,u,m,p,g,_){const y=s.transform,v=l?o.textSizeData:o.iconSizeData,w=Xl(v,s.transform.zoom),C="globe"===y.projection.name,D=[256/s.width*2+1,256/s.height*2+1],k=l?o.text.dynamicLayoutVertexArray:o.icon.dynamicLayoutVertexArray;k.clear();let S=null;C&&(S=l?o.text.globeExtVertexArray:o.icon.globeExtVertexArray);const E=o.lineVertexArray,A=l?o.text.placedSymbolArray:o.icon.placedSymbolArray,P=s.transform.width/s.transform.height;let O,R=!1;for(let F=0;F<A.length;F++){const B=A.get(F),{numGlyphs:j,writingMode:U}=B;if(U!==On.vertical||R||O===On.horizontal||(R=!0),O=U,(B.hidden||U===On.vertical)&&!R){Ku(j,k);continue}R=!1;const H=new ot(B.tileAnchorX,B.tileAnchorY);let{x:W,y:q,z:X}=y.projection.projectTilePoint(H.x,H.y,_.canonical);if(g){const[bt,yt,Ct]=g(H);W+=bt,q+=yt,X+=Ct}const G=[W,q,X,1];if(Qi.transformMat4(G,G,i),!uT(G,D)){Ku(j,k);continue}const Q=G[3],it=Rw(s.transform.getCameraToCenterDistance(y.projection),Q),st=Im(v,w,B),J=m?st/it:st*it,et=hl(W,q,X,d);if(et[3]<=0){Ku(j,k);continue}let dt={};const mt=m?null:g,ut=xn(B,J,!1,p,i,d,u,o.glyphOffsetArray,E,k,S,et,H,dt,P,mt,y.projection,_,m);R=ut.useVertical,mt&&ut.needsFlipping&&(dt={}),(ut.notEnoughRoom||R||ut.needsFlipping&&xn(B,J,!0,p,i,d,u,o.glyphOffsetArray,E,k,S,et,H,dt,P,mt,y.projection,_,m).notEnoughRoom)&&Ku(j,k)}l?(o.text.dynamicLayoutVertexBuffer.updateData(k),S&&o.text.globeExtVertexBuffer&&o.text.globeExtVertexBuffer.updateData(S)):(o.icon.dynamicLayoutVertexBuffer.updateData(k),S&&o.icon.globeExtVertexBuffer&&o.icon.globeExtVertexBuffer.updateData(S))}function Ne(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k){const{lineStartIndex:S,glyphStartIndex:E,segment:A}=p,P=E+p.numGlyphs,O=S+p.lineLength,R=i.getoffsetX(E),F=i.getoffsetX(P-1),B=tp(o*R,s,l,d,u,m,A,S,O,g,_,y,v,w,!0,C,D,k);if(!B)return null;const j=tp(o*F,s,l,d,u,m,A,S,O,g,_,y,v,w,!0,C,D,k);return j?{first:B,last:j}:null}function mT(o,i,s,l){return o===On.horizontal&&Math.abs(l)>Math.abs(s)?{useVertical:!0}:o===On.vertical?l>0?{needsFlipping:!0}:null:i!==vo.unknown&&(0===(d=s)||Math.abs(l/d)>Mg)?i===vo.flipRequired?{needsFlipping:!0}:null:s<0?{needsFlipping:!0}:null;var d}function xn(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E,A){const P=i/24,O=o.lineOffsetX*P,R=o.lineOffsetY*P,{lineStartIndex:F,glyphStartIndex:B,numGlyphs:j,segment:U,writingMode:H,flipState:W}=o,q=F+o.lineLength,X=G=>{if(y){const[J,et,dt]=G.up,mt=_.length;vy(y,mt+0,J,et,dt),vy(y,mt+1,J,et,dt),vy(y,mt+2,J,et,dt),vy(y,mt+3,J,et,dt)}const[Q,it,st]=G.point;$m(_,Q,it,st,G.angle)};if(j>1){const G=Ne(P,p,O,R,s,v,w,o,g,u,C,k,!1,S,E,A);if(!G)return{notEnoughRoom:!0};if(l&&!s){let[Q,it,st]=G.first.point,[J,et,dt]=G.last.point;[Q,it]=hl(Q,it,st,m),[J,et]=hl(J,et,dt,m);const mt=mT(H,W,(J-Q)*D,et-it);if(o.flipState=mt&&mt.needsFlipping?vo.flipRequired:vo.flipNotRequired,mt)return mt}X(G.first);for(let Q=B+1;Q<B+j-1;Q++){const it=tp(P*p.getoffsetX(Q),O,R,s,v,w,U,F,q,g,u,C,k,!1,!1,S,E,A);if(!it)return _.length-=4*(Q-B),{notEnoughRoom:!0};X(it)}X(G.last)}else{if(l&&!s){const Q=hl(w.x,w.y,0,d),it=F+U+1,st=new ot(g.getx(it),g.gety(it)),J=hl(st.x,st.y,0,d),et=J[3]>0?J:Sy(w,st,Q,1,d,void 0,S,E.canonical),dt=mT(H,W,(et[0]-Q[0])*D,et[1]-Q[1]);if(o.flipState=dt&&dt.needsFlipping?vo.flipRequired:vo.flipNotRequired,dt)return dt}const G=tp(P*p.getoffsetX(B),O,R,s,v,w,U,F,q,g,u,C,k,!1,!1,S,E,A);if(!G)return{notEnoughRoom:!0};X(G)}return{}}function Oe(o,i,s,l,d){const{x:u,y:m,z:p}=l.projectTilePoint(o.x,o.y,i);if(!d)return hl(u,m,p,s);const[g,_,y]=d(o);return hl(u+g,m+_,p+y,s)}function Sy(o,i,s,l,d,u,m,p){const g=Oe(o.sub(i)._unit()._add(o),p,d,m,u);return Z.sub(g,s,g),Z.normalize(g,g),Z.scaleAndAdd(g,s,g,l)}function tp(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E){const A=l?o-i:o+i;let P=A>0?1:-1,O=0;l&&(P*=-1,O=Math.PI),P<0&&(O+=Math.PI);let R=p+m+(P>0?0:1)|0,F=d,B=d,j=0,U=0;const H=Math.abs(A),W=[],q=[];let X=u,G=X;const Q=()=>Sy(G,X,B,H-j+1,y,w,k,S.canonical);for(;j+U<=H;){if(R+=P,R<p||R>=g)return null;if(B=F,G=X,W.push(B),C&&q.push(G),X=new ot(_.getx(R),_.gety(R)),F=v[R],!F){const yt=Oe(X,S.canonical,y,k,w);F=yt[3]>0?v[R]=yt:Q()}j+=U,U=Z.distance(B,F)}D&&w&&(v[R]&&(F=Q(),U=Z.distance(B,F)),v[R]=F);const it=(H-j)/U,st=X.sub(G)._mult(it)._add(G),J=Z.sub([],F,B),et=Z.scaleAndAdd([],B,J,it);let dt=[0,0,1],mt=J[0],ut=J[1];if(E&&(dt=k.upVector(S.canonical,st.x,st.y),0!==dt[0]||0!==dt[1]||1!==dt[2])){const yt=[dt[2],0,-dt[0]],Ct=Z.cross([],dt,yt);Z.normalize(yt,yt),Z.normalize(Ct,Ct),mt=Z.dot(J,yt),ut=Z.dot(J,Ct)}if(s){const yt=Z.cross([],dt,J);Z.normalize(yt,yt),Z.scaleAndAdd(et,et,yt,s*P)}const bt=O+Math.atan2(ut,mt);return W.push(et),C&&q.push(st),{point:et,angle:bt,path:W,tilePath:q,up:dt}}function Ku(o,i){const s=i.length,l=s+4*o;i.resize(l),i.float32.fill(-1/0,4*s,4*l)}function Pw(o,i,s){const l=i[0],d=i[1];return o[0]=s[0]*l+s[4]*d+s[12],o[1]=s[1]*l+s[5]*d+s[13],o[3]=s[3]*l+s[7]*d+s[15],o}const Ow=(o,i,s)=>(1-s)*o+s*i,Fw=o=>o*o*o*o*o;class Ty{constructor(i,s,l,d,u,m,p){this.tileSize=512,this._renderWorldCopies=void 0===u||u,this._minZoom=i||0,this._maxZoom=s||22,this._minPitch=l??0,this._maxPitch=d??60,this.setProjection(m),this.setMaxBounds(p),this.width=0,this.height=0,this._center=new qe(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new ht,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new ky,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const i=new Ty(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return i._elevation=this._elevation,i._centerAltitude=this._centerAltitude,i._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,i.tileSize=this.tileSize,i.mercatorFromTransition=this.mercatorFromTransition,i.width=this.width,i.height=this.height,i.cameraElevationReference=this.cameraElevationReference,i._center=this._center,i._setZoom(this.zoom),i._seaLevelZoom=this._seaLevelZoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._nearZ=this._nearZ,i._farZ=this._farZ,i._averageElevation=this._averageElevation,i._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._camera=this._camera.clone(),i._calcMatrices(),i.freezeTileCoverage=this.freezeTileCoverage,i.frustumCorners=this.frustumCorners,i}get isOrthographic(){return"globe"!==this.projection.name&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(i){this._elevation!==i&&(this._elevation=i,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return"globe"!==this.projection.name&&!this.isOrthographic}updateElevation(i,s=!1){const l=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||l)&&this._updateCameraOnTerrain(),(i||l)&&this._constrainCamera(s),this._calcMatrices()}getProjection(){return is(this.projection,["name","center","parallels"])}setProjection(i){this.projectionOptions=i||{name:"mercator"};const s=this.projection?this.getProjection():void 0;this.projection=_y(this.projectionOptions);const l=!Ni(s,this.getProjection());return l&&this._calcMatrices(),this.mercatorFromTransition=!1,l}setOrthographicProjectionAtLowPitch(i){return this._orthographicProjectionAtLowPitch!==i&&(this._orthographicProjectionAtLowPitch=i,this._calcMatrices(),!0)}setMercatorFromTransition(){const i=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=_y({name:"mercator"});const s=i!==this.projection.name;return s&&this._calcMatrices(),s}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(i){void 0===i?i=!0:null===i&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get cameraWorldSize(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return sn(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new ot(this.width,this.height)}get bearing(){return Rl(this.rotation,-180,180)}set bearing(i){this.rotation=i}get rotation(){return-this.angle/Math.PI*180}set rotation(i){const s=-i*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=bm.create(),bm.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const s=he(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const i=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/i)}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=ni(i),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(i){this._averageElevation=i,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(i){const s=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._setZoom(s),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(i){this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom}_updateCameraOnTerrain(){const i=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,s=this.elevation&&i===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||i===Number.NEGATIVE_INFINITY&&(!s||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const l=this._elevation;s||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&l.exaggeration()&&this._centerAltitudeValidForExaggeration!==l.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*l.exaggeration(),this._centerAltitudeValidForExaggeration=l.exaggeration()):(this._centerAltitude=i||0,this._centerAltitudeValidForExaggeration=l.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const i=this._elevation,s=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],l=this.horizonLineFromTop();let d=0,u=0;for(let m=0;m<s.length;m++){const p=new ot(s[m][0]*this.width,l+s[m][1]*(this.height-l)),g=i.pointCoordinate(p);if(!g)continue;const _=1/Math.hypot(g[0]-this._camera.position[0],g[1]-this._camera.position[1]);d+=g[3]*_,u+=_}return 0===u?NaN:d/u}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const i=this._seaLevelZoom,s=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),l=this.pixelsPerMeter/this.worldSize*s,d=this._mercatorZfromZoom(i),u=this._mercatorZfromZoom(this._maxZoom),m=Math.max(d-l,u);this._setZoom(this._zoomFromMercatorZ(m))}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}computeZoomRelativeTo(i){const s=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,i.toAltitude()));let l;l=i.z<this._camera.position[2]?[s.x,s.y,s.z]:[i.x,i.y,i.z];const d=Z.length(Z.sub([],this._camera.position,l));return he(this._zoomFromMercatorZ(d),this._minZoom,this._maxZoom)}setFreeCameraOptions(i){if(!this.height||!i.position&&!i.orientation)return;this._updateCameraState();let s=!1;if(i.orientation&&!_o.exactEquals(i.orientation,this._camera.orientation)&&(s=this._setCameraOrientation(i.orientation)),i.position){const l=[i.position.x,i.position.y,i.position.z];Z.exactEquals(l,this._camera.position)||(this._setCameraPosition(l),s=!0)}s&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const i=this._camera.position,s=new lT;return s.position=new Ei(i[0],i[1],i[2]),s.orientation=this._camera.orientation,s._elevation=this.elevation,s._renderWorldCopies=this.renderWorldCopies,s}_setCameraOrientation(i){if(!_o.length(i))return!1;_o.normalize(i,i);const s=Z.transformQuat([],[0,0,-1],i),l=Z.transformQuat([],[0,-1,0],i);if(l[2]<0)return!1;const d=Aw(s,l);return!!d&&(this._camera.orientation=d,!0)}_setCameraPosition(i){const s=this.zoomScale(this.minZoom)*this.tileSize,l=this.zoomScale(this.maxZoom)*this.tileSize,d=this.cameraToCenterDistance;i[2]=he(i[2],d/l,d/s),this._camera.position=i}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,s,l){this._unmodified=!1,this._edgeInsets.interpolate(i,s,l),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const s=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(i){const s=[new Gf(0,i)];if(this.renderWorldCopies){const l=this.pointCoordinate(new ot(0,0)),d=this.pointCoordinate(new ot(this.width,0)),u=this.pointCoordinate(new ot(this.width,this.height)),m=this.pointCoordinate(new ot(0,this.height)),p=Math.floor(Math.min(l.x,d.x,u.x,m.x)),g=Math.floor(Math.max(l.x,d.x,u.x,m.x)),_=1;for(let y=p-_;y<=g+_;y++)0!==y&&s.push(new Gf(y,i))}return s}isLODDisabled(i){return(!i||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(i,s,l){let d=[];if(0===s[0]&&0===s[1])return d;for(const m of i){const p=m.canonical,g=m.overscaledZ,_=m.wrap,y=1<<p.z,v=p.x+1<y,w=p.x>0,C=p.y+1<y,D=p.y>0,k=m.wrap-(w?0:1),S=m.wrap+(v?0:1),E=w?p.x-1:y-1,A=v?p.x+1:0;s[0]<0?(d.push(new Ri(g,S,p.z,A,p.y)),s[1]<0&&C&&(d.push(new Ri(g,_,p.z,p.x,p.y+1)),d.push(new Ri(g,S,p.z,A,p.y+1))),s[1]>0&&D&&(d.push(new Ri(g,_,p.z,p.x,p.y-1)),d.push(new Ri(g,S,p.z,A,p.y-1)))):s[0]>0?(d.push(new Ri(g,k,p.z,E,p.y)),s[1]<0&&C&&(d.push(new Ri(g,_,p.z,p.x,p.y+1)),d.push(new Ri(g,k,p.z,E,p.y+1))),s[1]>0&&D&&(d.push(new Ri(g,_,p.z,p.x,p.y-1)),d.push(new Ri(g,k,p.z,E,p.y-1)))):s[1]<0&&C?d.push(new Ri(g,_,p.z,p.x,p.y+1)):D&&d.push(new Ri(g,_,p.z,p.x,p.y-1))}if(d.length>1){d.sort((g,_)=>g.overscaledZ-_.overscaledZ||g.wrap-_.wrap||g.canonical.z-_.canonical.z||g.canonical.x-_.canonical.x||g.canonical.y-_.canonical.y);let m=0,p=0;for(;p<d.length;)d[p].equals(d[m])?++p:d[++m]=d[p++];d.length=m+1}const u=[];for(const m of d)d.some(p=>m.isChildOf(p))||u.push(m);return d=u.filter(m=>!i.some(p=>!!(m.overscaledZ<l&&p.isChildOf(m))||m.equals(p)||m.isChildOf(p))),d}coveringTiles(i){let s=this.coveringZoomLevel(i);const l=s,d=this.elevation&&this.elevation.exaggeration(),u=d&&!i.isTerrainDEM,m="mercator"===this.projection.name;if(void 0!==i.minzoom&&s<i.minzoom)return[];void 0!==i.maxzoom&&s>i.maxzoom&&(s=i.maxzoom);const p=this.locationCoordinate(this.center),g=this.center.lat,_=1<<s,y=[_*p.x,_*p.y,0],v="globe"===this.projection.name,w=!v,C=al.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,w),D=v?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),k=_*sn(1,this.center.lat),S=this._camera.position[2]/sn(1,this.center.lat),E=[_*D.x,_*D.y,S*(w?1:k)],A=v||d,P=this.cameraToCenterDistance/i.tileSize*(i.roundZoom?1:.502),O=this.isLODDisabled(!0)?s:0;let R;if(this._elevation&&i.isTerrainDEM)R=1e4*this._elevation.exaggeration();else if(this._elevation){const J=this._elevation.getMinMaxForVisibleTiles();R=J?J.max:this._centerAltitude}else R=this._centerAltitude;const F=i.isTerrainDEM?-R:this._elevation?this._elevation.getMinElevationBelowMSL():0,B=this.projection.isReprojectedInTileSpace?Eo(this):1,j=J=>{const dt=new Ei(J.x+25e-6,J.y,J.z),mt=new Ei(J.x,J.y+25e-6,J.z),ut=J.toLngLat(),bt=dt.toLngLat(),yt=mt.toLngLat(),Ct=this.locationCoordinate(ut),gt=this.locationCoordinate(bt),At=this.locationCoordinate(yt),Gt=Math.hypot(gt.x-Ct.x,gt.y-Ct.y),Et=Math.hypot(At.x-Ct.x,At.y-Ct.y);return Math.sqrt(Gt*Et)*B/25e-6},U=J=>{const et=R,dt=F;return{aabb:hg(this,_,0,0,0,J,dt,et,this.projection),zoom:0,x:0,y:0,minZ:dt,maxZ:et,wrap:J,fullyVisible:!1}},H=[];let W=[];const q=s,X=i.reparseOverscaled?l:s,G=J=>J*J,Q=G((S-this._centerAltitude)*k),it=J=>{if(!this._elevation||!J.tileID||!m)return;const et=this._elevation.getMinMaxForTile(J.tileID),dt=J.aabb;et?(dt.min[2]=et.min,dt.max[2]=et.max,dt.center[2]=(dt.min[2]+dt.max[2])/2):(J.shouldSplit=st(J),J.shouldSplit||(dt.min[2]=dt.max[2]=dt.center[2]=this._centerAltitude))},st=J=>{if(J.zoom<O)return!0;if(J.zoom===q)return!1;if(null!=J.shouldSplit)return J.shouldSplit;const et=J.aabb.distanceX(E),dt=J.aabb.distanceY(E);let mt=Q,ut=1;if(v){mt=G(J.aabb.distanceZ(E));const Ct=Math.pow(2,J.zoom),gt=an((J.y+1)/Ct),At=an(J.y/Ct),Gt=Math.min(Math.max(g,gt),At),Et=Jf(Gt)/Jf(g);if(ut=Gt===g?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Et/this._mercatorScaleRatio),this.zoom<=Zf&&J.zoom===q-1&&Et>=.9)return!0}else if(u&&(mt=G(J.aabb.distanceZ(E)*k)),this.projection.isReprojectedInTileSpace&&l<=5){const Ct=Math.pow(2,J.zoom),gt=j(new Ei((J.x+.5)/Ct,(J.y+.5)/Ct));ut=gt>.85?1:gt}const bt=et*et+dt*dt+mt;return bt<G((1<<q-J.zoom)*P*ut*((Ct,gt)=>{if(gt*G(.707)<Ct)return 1;const At=Math.sqrt(gt/Ct);return At/(1.4144271570014144+(Math.pow(1.1,At-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(mt,Q),bt))};if(this.renderWorldCopies)for(let J=1;J<=3;J++)H.push(U(-J)),H.push(U(J));for(H.push(U(0));H.length>0;){const J=H.pop(),et=J.x,dt=J.y;let mt=J.fullyVisible;const ut=()=>"globe"===this.projection.name&&(0===J.y||J.y===(1<<J.zoom)-1);if(!mt){let bt=A?J.aabb.intersects(C):J.aabb.intersectsFlat(C);if(0===bt&&ut()){const yt=new ca(J.zoom,et,dt);bt=Ex(this,_,yt,!0).intersects(C)}if(0===bt)continue;mt=2===bt}if(J.zoom!==q&&st(J))for(let bt=0;bt<4;bt++){const yt=(et<<1)+bt%2,Ct=(dt<<1)+(bt>>1),gt={aabb:m?J.aabb.quadrant(bt):hg(this,_,J.zoom+1,yt,Ct,J.wrap,J.minZ,J.maxZ,this.projection),zoom:J.zoom+1,x:yt,y:Ct,wrap:J.wrap,fullyVisible:mt,tileID:void 0,shouldSplit:void 0,minZ:J.minZ,maxZ:J.maxZ};u&&!v&&(gt.tileID=new Ri(J.zoom+1===q?X:J.zoom+1,J.wrap,J.zoom+1,yt,Ct),it(gt)),H.push(gt)}else{const bt=J.zoom===q?X:J.zoom;if(i.minzoom&&i.minzoom>bt)continue;if(!mt){let At=A?J.aabb.intersectsPrecise(C):J.aabb.intersectsPreciseFlat(C);if(0===At&&ut()){const Gt=new ca(J.zoom,et,dt);At=Ex(this,_,Gt,!0).intersectsPrecise(C)}if(0===At)continue}const yt=y[0]-(.5+et+(J.wrap<<J.zoom))*(1<<s-J.zoom),Ct=y[1]-.5-dt,gt=J.tileID?J.tileID:new Ri(bt,J.wrap,J.zoom,et,dt);W.push({tileID:gt,distanceSq:yt*yt+Ct*Ct})}}if(this.fogCullDistSq){const J=this.fogCullDistSq,et=this.horizonLineFromTop();W=W.filter(dt=>{const mt=[0,0,0,1],ut=[pt,pt,0,1],bt=this.calculateFogTileMatrix(dt.tileID.toUnwrapped());Qi.transformMat4(mt,mt,bt),Qi.transformMat4(ut,ut,bt);const yt=function(At,Gt,Et){let te=0;for(let ie=0;ie<2;++ie)At[ie]>0&&(te+=(At[ie]-0)*(At[ie]-0)),Gt[ie]<0&&(te+=(0-Gt[ie])*(0-Gt[ie]));return te}(Qi.min([],mt,ut),Qi.max([],mt,ut));if(0===yt)return!0;let Ct=!1;const gt=this._elevation;if(gt&&yt>J&&0!==et){const At=this.calculateProjMatrix(dt.tileID.toUnwrapped());let Gt;i.isTerrainDEM||(Gt=gt.getMinMaxForTile(dt.tileID)),Gt||(Gt={min:F,max:R});const Et=function(ie){const He=Math.round((ie+45+360)%360/90)%4;return h0[He]}(this.rotation),te=[Et[0]*pt,Et[1]*pt,Gt.max];Z.transformMat4(te,te,At),Ct=(1-te[1])*this.height*.5<et}return yt<J||Ct})}return W.sort((J,et)=>J.distanceSq-et.distanceSq).map(J=>J.tileID)}resize(i,s){this.width=i,this.height=s,this.pixelsToGLUnits=[2/i,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const s=he(i.lat,-or,or),l=this.projection.project(i.lng,s);return new ot(l.x*this.worldSize,l.y*this.worldSize)}unproject(i){return this.projection.unproject(i.x/this.worldSize,i.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/sn(1,this.center.lat)/this.worldSize}setLocationAtPoint(i,s){let l,d;const u=this.centerPoint;if("globe"===this.projection.name){const p=this.worldSize;l=(s.x-u.x)/p,d=(s.y-u.y)/p}else{const p=this.pointCoordinate(s),g=this.pointCoordinate(u);l=p.x-g.x,d=p.y-g.y}const m=this.locationCoordinate(i);this.setLocation(new Ei(m.x-l,m.y-d))}setLocation(i){this.center=this.coordinateLocation(i),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(i){return this.projection.locationPoint(this,i)}locationPoint3D(i){return this.projection.locationPoint(this,i,!0)}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}pointLocation3D(i){return this.coordinateLocation(this.pointCoordinate3D(i))}locationCoordinate(i,s){const l=s?sn(s,i.lat):void 0,d=this.projection.project(i.lng,i.lat);return new Ei(d.x,d.y,l)}coordinateLocation(i){return this.projection.unproject(i.x,i.y)}pointRayIntersection(i,s){const l=s??this._centerAltitude,d=[i.x,i.y,0,1],u=[i.x,i.y,1,1];Qi.transformMat4(d,d,this.pixelMatrixInverse),Qi.transformMat4(u,u,this.pixelMatrixInverse);const m=u[3];Qi.scale(d,d,1/d[3]),Qi.scale(u,u,1/m);const p=d[2],g=u[2];return{p0:d,p1:u,t:p===g?0:(l-p)/(g-p)}}screenPointToMercatorRay(i){const s=[i.x,i.y,0,1],l=[i.x,i.y,1,1];return Qi.transformMat4(s,s,this.pixelMatrixInverse),Qi.transformMat4(l,l,this.pixelMatrixInverse),Qi.scale(s,s,1/s[3]),Qi.scale(l,l,1/l[3]),s[2]=sn(s[2],this._center.lat)*this.worldSize,l[2]=sn(l[2],this._center.lat)*this.worldSize,Qi.scale(s,s,1/this.worldSize),Qi.scale(l,l,1/this.worldSize),new Nb([s[0],s[1],s[2]],Z.normalize([],Z.sub([],l,s)))}rayIntersectionCoordinate(i){const{p0:s,p1:l,t:d}=i,u=sn(s[2],this._center.lat),m=sn(l[2],this._center.lat);return new Ei(_e(s[0],l[0],d)/this.worldSize,_e(s[1],l[1],d)/this.worldSize,_e(u,m,d))}pointCoordinate(i,s=this._centerAltitude){return this.projection.pointCoordinate(this,i.x,i.y,s)}pointCoordinate3D(i){if(!this.elevation)return this.pointCoordinate(i);let s=this.projection.pointCoordinate3D(this,i.x,i.y);if(s)return new Ei(s[0],s[1],s[2]);let l=0,d=this.horizonLineFromTop();if(i.y>d)return this.pointCoordinate(i);const u=.02*d,m=i.clone();for(let p=0;p<10&&d-l>u;p++){m.y=_e(l,d,.66);const g=this.projection.pointCoordinate3D(this,m.x,m.y);g?(d=m.y,s=g):l=m.y}return s?new Ei(s[0],s[1],s[2]):this.pointCoordinate(i)}isPointAboveHorizon(i){return this.projection.isPointAboveHorizon(this,i)}isPointOnSurface(i){if(i.y<0||i.y>this.height||i.x<0||i.x>this.width)return!1;if(this.elevation||this.zoom>=Md)return!this.isPointAboveHorizon(i);const s=this.pointCoordinate(i);return s.y>=0&&s.y<=1}_coordinatePoint(i,s){const l=s&&this.elevation?this.elevation.getAtPointOrZero(i,this._centerAltitude):this._centerAltitude,d=[i.x*this.worldSize,i.y*this.worldSize,l+i.toAltitude(),1];return Qi.transformMat4(d,d,this.pixelMatrix),d[3]>0?new ot(d[0]/d[3],d[1]/d[3]):new ot(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:i,left:s}=this._edgeInsets,l=this.height-this._edgeInsets.bottom,d=this.width-this._edgeInsets.right,u=this.pointLocation3D(new ot(s,i)),m=this.pointLocation3D(new ot(d,i)),p=this.pointLocation3D(new ot(d,l)),g=this.pointLocation3D(new ot(s,l));let _=Math.min(u.lng,m.lng,p.lng,g.lng),y=Math.max(u.lng,m.lng,p.lng,g.lng),v=Math.min(u.lat,m.lat,p.lat,g.lat),w=Math.max(u.lat,m.lat,p.lat,g.lat);const C=Math.pow(2,-this.zoom)/16*270,D="globe"===this.projection.name?1:4,k=(S,E,A,P,O)=>{const R=(S+A)/2,F=(E+P)/2,B=new ot(R,F),{lng:j,lat:U}=this.pointLocation3D(B),H=Math.max(0,_-j,v-U,j-y,U-w);_=Math.min(_,j),y=Math.max(y,j),v=Math.min(v,U),w=Math.max(w,U),(O<D||H>C)&&(k(S,E,R,F,O+1),k(R,F,A,P,O+1))};if(k(s,i,d,i,1),k(d,i,d,l,1),k(d,l,s,l,1),k(s,l,s,i,1),"globe"===this.projection.name){const[S,E]=function(A){const P=at.identity(new Float64Array(16));at.multiply(P,A.pixelMatrix,A.globeMatrix);const O=[0,jo,0],R=[0,ps,0];return Z.transformMat4(O,O,P),Z.transformMat4(R,R,P),[O[0]>0&&O[0]<=A.width&&O[1]>0&&O[1]<=A.height&&!Px(A,new qe(A.center.lat,90)),R[0]>0&&R[0]<=A.width&&R[1]>0&&R[1]<=A.height&&!Px(A,new qe(A.center.lat,-90))]}(this);S?(w=90,y=180,_=-180):E&&(v=-90,y=180,_=-180)}return new go(new qe(_,v),new qe(y,w))}_getBoundsRectangular(i,s){const{top:l,left:d}=this._edgeInsets,u=this.height-this._edgeInsets.bottom,m=this.width-this._edgeInsets.right,p=new ot(d,l),g=new ot(m,l),_=new ot(m,u),y=new ot(d,u);let v=this.pointCoordinate(p,i),w=this.pointCoordinate(g,i);const C=this.pointCoordinate(_,s),D=this.pointCoordinate(y,s),k=(S,E)=>(E.y-S.y)/(E.x-S.x);return v.y>1&&w.y>=0?v=new Ei((1-D.y)/k(D,v)+D.x,1):v.y<0&&w.y<=1&&(v=new Ei(-D.y/k(D,v)+D.x,0)),w.y>1&&v.y>=0?w=new Ei((1-C.y)/k(C,w)+C.x,1):w.y<0&&v.y<=1&&(w=new Ei(-C.y/k(C,w)+C.x,0)),(new go).extend(this.coordinateLocation(v)).extend(this.coordinateLocation(w)).extend(this.coordinateLocation(D)).extend(this.coordinateLocation(C))}_getBoundsRectangularTerrain(){const i=this.elevation;if(!i.visibleDemTiles.length||i.isUsingMockSource())return this._getBoundsRectangular(0,0);const s=i.visibleDemTiles.reduce((l,d)=>{if(d.dem){const u=d.dem.tree;l.min=Math.min(l.min,u.minimums[0]),l.max=Math.max(l.max,u.maximums[0])}return l},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(s.min*i.exaggeration(),s.max*i.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(i=!0){const s=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,l=this.height/2-s*(1-this._horizonShift);return i?Math.max(0,l):l}getMaxBounds(){return this.maxBounds}setMaxBounds(i){this.maxBounds=i,this.minLat=-or,this.maxLat=or,this.minLng=-180,this.maxLng=180,i&&(this.minLat=i.getSouth(),this.maxLat=i.getNorth(),this.minLng=i.getWest(),this.maxLng=i.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=dr(this.minLng)*this.tileSize,this.worldMaxX=dr(this.maxLng)*this.tileSize,this.worldMinY=Rr(this.maxLat)*this.tileSize,this.worldMaxY=Rr(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(i,s){return this.projection.createTileMatrix(this,s,i)}calculateDistanceTileData(i){const s=i.key,l=this._distanceTileDataCache;if(l[s])return l[s];const d=i.canonical,u=1/this.height,m=this.cameraWorldSize,p=m/this.zoomScale(d.z),g=(d.x+Math.pow(2,d.z)*i.wrap)*p,_=d.y*p,y=this.point;y.x*=m/this.worldSize,y.y*=m/this.worldSize;const v=this.angle,w=Math.sin(-v),C=-Math.cos(-v);return l[s]={bearing:[w,C],center:[(y.x-g)*u,(y.y-_)*u],scale:p/pt*u},l[s]}calculateFogTileMatrix(i){const s=i.key,l=this._fogTileMatrixCache;if(l[s])return l[s];const d=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,i);return at.multiply(d,this.worldToFogMatrix,d),l[s]=new Float32Array(d),l[s]}calculateProjMatrix(i,s=!1,l=!1){const d=i.key;let u;if(u=l?this._expandedProjMatrixCache:s?this._alignedProjMatrixCache:this._projMatrixCache,u[d])return u[d];const m=this.calculatePosMatrix(i,this.worldSize);let p;return p=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:l?this.expandedFarZProjMatrix:s?this.alignedProjMatrix:this.projMatrix,at.multiply(m,p,m),u[d]=new Float32Array(m),u[d]}calculatePixelsToTileUnitsMatrix(i){const s=i.tileID.key,l=this._pixelsToTileUnitsCache;if(l[s])return l[s];const d=function(u,m){const{scale:p}=u.tileTransform,g=p*pt/(u.tileSize*Math.pow(2,m.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return bm.scale(new Float32Array(4),m.inverseAdjustmentMatrix,[g,g])}(i,this);return l[s]=d,l[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const i=1/this.worldSize,s=at.fromScaling([],[i,i,i]);return at.multiply(s,s,this.globeMatrix),s}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const i=this._elevation;this._updateCameraState();const s=sn(1,this._center.lat)*this.worldSize,l=this._computeCameraPosition(s),d=this._camera.forward(),u=sn(1,this._center.lat);l[2]/=u,d[2]/=u,Z.normalize(d,d);const m=i.raycast(l,d,i.exaggeration());if(m){const p=Z.scaleAndAdd([],l,d,m),g=new Ei(p[0],p[1],sn(p[2],an(p[1]))),_=(g.z+Z.length([g.x-l[0],g.y-l[1],g.z-l[2]*u]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(_),this._centerAltitude=g.toAltitude(),this._center=this.coordinateLocation(g),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(i=!1){if(!this._elevation)return;const s=this._elevation,l=sn(1,this._center.lat)*this.worldSize,d=this._computeCameraPosition(l),u=s.getAtPointOrZero(new Ei(...d)),m=this.pixelsPerMeter/this.worldSize*u,p=this._minimumHeightOverTerrain(),g=d[2]-m;if(g<=p)if(g<0||i){const _=this.locationCoordinate(this._center,this._centerAltitude),y=[d[0],d[1],_.z-d[2]],v=Z.length(y);y[2]-=(p-g)/this._pixelsPerMercatorPixel;const w=Z.length(y);if(0===w)return;Z.scale(y,y,v/w*this._pixelsPerMercatorPixel),this._camera.position=[d[0],d[1],_.z*this._pixelsPerMercatorPixel-y[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||i){const w=this.center;return w.lat=he(w.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!i)&&(w.lng=he(w.lng,this.minLng,this.maxLng)),this.center=w,void(this._constraining=!1)}const s=this._unmodified,{x:l,y:d}=this.point;let u=0,m=l,p=d;const g=this.width/2,_=this.height/2,y=this.worldMinY*this.scale,v=this.worldMaxY*this.scale;if(d-_<y&&(p=y+_),d+_>v&&(p=v-_),v-y<this.height&&(u=Math.max(u,this.height/(v-y)),p=(v+y)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const w=this.worldMinX*this.scale,C=this.worldMaxX*this.scale,D=this.worldSize/2-(w+C)/2;m=(l+D+this.worldSize)%this.worldSize-D,m-g<w&&(m=w+g),m+g>C&&(m=C-g),C-w<this.width&&(u=Math.max(u,this.width/(C-w)),m=(C+w)/2)}m===l&&p===d||(this.center=this.unproject(new ot(m,p))),u&&(this.zoom+=this.scaleZoom(u)),this._constrainCamera(),this._unmodified=s,this._constraining=!1}_minZoomForBounds(){let i=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(i=Math.max(i,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),i}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,s="globe"===this.projection.name,l=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=sn(1,this.center.lat)/sn(1,45));const d=Qr(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,d),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const u="meters"===this.projection.zAxisUnit?l:1,m=this._camera.getWorldToCamera(this.worldSize,u);let p;const g=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(g[8]=2*-i.x/this.width,g[9]=2*i.y/this.height,this.isOrthographic){let U=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),H=U*this.aspect,W=-H,q=-U;H-=i.x,W-=i.x,U+=i.y,q+=i.y,p=this._camera.getCameraToClipOrthographic(W,H,q,U,this._nearZ,this._farZ),((X,G,Q,it)=>{for(let st=0;st<16;st++)X[st]=Ow(G[st],Q[st],it)})(p,p,g,Fw(this.pitch>=15?1:this.pitch/15))}else p=g;const _=at.mul([],g,m);let y=at.mul([],p,m);if(this.projection.isReprojectedInTileSpace){const U=this.locationCoordinate(this.center),H=at.identity([]);at.translate(H,H,[U.x*this.worldSize,U.y*this.worldSize,0]),at.multiply(H,H,cT(this)),at.translate(H,H,[-U.x*this.worldSize,-U.y*this.worldSize,0]),at.multiply(y,y,H),at.multiply(_,_,H),this.inverseAdjustmentMatrix=function(W){const q=cT(W,!0);return bm.invert([],[q[0],q[1],q[4],q[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=at.scale([],y,[this.worldSize,this.worldSize,this.worldSize/u,1]),this.projMatrix=y,this.invProjMatrix=at.invert(new Float64Array(16),this.projMatrix),s){const U=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);U[8]=2*-i.x/this.width,U[9]=2*i.y/this.height,this.expandedFarZProjMatrix=at.mul([],U,m)}else this.expandedFarZProjMatrix=this.projMatrix;const v=at.invert([],p);this.frustumCorners=Cx.fromInvProjectionMatrix(v,this.horizonLineFromTop(),this.height),this.cameraFrustum=al.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!s);const w=new Float32Array(16);at.identity(w),at.scale(w,w,[1,-1,1]),at.rotateX(w,w,this._pitch),at.rotateZ(w,w,this.angle);const C=at.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=at.clone(C);const D=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;C[8]=2*-i.x/this.width,C[9]=2*(i.y+D)/this.height,this.skyboxMatrix=at.multiply(w,C,w);const k=this.point,S=k.x,E=k.y,A=this.width%2/2,P=this.height%2/2,O=Math.cos(this.angle),R=Math.sin(this.angle),F=S-Math.round(S)+O*A+R*P,B=E-Math.round(E)+O*P+R*A,j=new Float64Array(y);if(at.translate(j,j,[F>.5?F-1:F,B>.5?B-1:B,0]),this.alignedProjMatrix=j,y=at.create(),at.scale(y,y,[this.width/2,-this.height/2,1]),at.translate(y,y,[1,-1,0]),this.labelPlaneMatrix=y,y=at.create(),at.scale(y,y,[1,-1,1]),at.translate(y,y,[-1,-1,0]),at.scale(y,y,[2/this.width,2/this.height,1]),this.glCoordMatrix=y,this.pixelMatrix=at.multiply(new Float64Array(16),this.labelPlaneMatrix,_),this._calcFogMatrices(),this._distanceTileDataCache={},y=at.invert(new Float64Array(16),this.pixelMatrix),!y)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=y,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=function(H){const{x:W,y:q}=H.point,{lng:X,lat:G}=H._center;return qk(W,q,H.worldSize,X,G)}(this);const U=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=Z.transformMat4(U,U,m),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=y;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const i=this.cameraWorldSizeForFog,s=this.cameraPixelsPerMeter,l=this._camera.position,d=1/this.height/this._pixelsPerMercatorPixel,u=[i,i,s];Z.scale(u,u,d),Z.scale(l,l,-1),Z.multiply(l,l,u);const m=at.create();at.translate(m,m,l),at.scale(m,m,u),this.mercatorFogMatrix=m,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(i,s,d)}_computeCameraPosition(i){const s=(i=i||this.pixelsPerMeter)/this.pixelsPerMeter,l=this._camera.forward(),d=this.point,u=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*s-i/this.worldSize*this._centerAltitude;return[d.x/this.worldSize-l[0]*u,d.y/this.worldSize-l[1]*u,i/this.worldSize*this._centerAltitude-l[2]*u]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(i){const s=this._maxCameraBoundsDistance()*Math.cos(this._pitch),l=this._camera.position[2],d=i[2];let u=1;this.projection.wrap&&(this.center=this.center.wrap()),d>0&&(u=Math.min((s-l)/d,1)),this._camera.position=Z.scaleAndAdd([],this._camera.position,i,u),this._updateStateFromCamera()}_updateStateFromCamera(){const i=this._camera.position,s=this._camera.forward(),{pitch:l,bearing:d}=this._camera.getPitchBearing(),u=sn(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,m=this._mercatorZfromZoom(this._maxZoom)*Math.cos(ni(this._maxPitch)),p=Math.max((i[2]-u)/Math.cos(l),m),g=this._zoomFromMercatorZ(p);Z.scaleAndAdd(i,i,s,p),this._pitch=he(l,ni(this.minPitch),ni(this.maxPitch)),this.angle=Rl(d,-Math.PI,Math.PI),this._setZoom(he(g,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new Ei(i[0],i[1],i[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(i){return Math.pow(2,i)*this.tileSize}_mercatorZfromZoom(i){return this.cameraToCenterDistance/this._worldSizeFromZoom(i)}_minimumHeightOverTerrain(){const i=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(i)}_zoomFromMercatorZ(i){return this.scaleZoom(this.cameraToCenterDistance/(i*this.tileSize))}zoomFromMercatorZAdjusted(i){let s=0,l=Md,d=0,u=1/0;for(;l-s>1e-6&&l>s;){const m=s+.5*(l-s),p=this.tileSize*Math.pow(2,m),g=this.getCameraToCenterDistance(this.projection,m,p),_=this.scaleZoom(g/(i*this.tileSize)),y=Math.abs(m-_);y<u&&(u=y,d=m),m<_?s=m:l=m}return d}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(rt("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(i,s){const l=Math.min(i.x,s.x),d=Math.max(i.x,s.x),u=Math.min(i.y,s.y),m=Math.max(i.y,s.y);if(u<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const p=[new ot(l,u),new ot(d,m),new ot(l,m),new ot(d,u)],g=this.renderWorldCopies?-3:0,_=this.renderWorldCopies?4:1;for(const y of p){const v=this.pointRayIntersection(y);if(v.t<0)return!0;const w=this.rayIntersectionCoordinate(v);if(w.x<g||w.y<0||w.x>_||w.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+jr(this.fovAboveCenter)>88||this.anyCornerOffEdge(new ot(0,0),new ot(this.width,this.height))}zoomDeltaToMovement(i,s){const l=Z.length(Z.sub([],this._camera.position,i)),d=this._zoomFromMercatorZ(l)+s;return l-this._mercatorZfromZoom(d)}getCameraPoint(){if("globe"===this.projection.name){const i=function([s,l,d],u){const m=[s,l,d,1];Qi.transformMat4(m,m,u);const p=m[3]=Math.max(m[3],1e-6);return m[0]/=p,m[1]/=p,m[2]/=p,m}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new ot(i[0],i[1])}{const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new ot(0,i))}}getCameraToCenterDistance(i,s=this.zoom,l=this.worldSize){const d=Qr(i,s,this.width,this.height,1024),u=i.pixelSpaceConversion(this.center.lat,l,d);let m=.5/Math.tan(.5*this._fov)*this.height*u;return this.isOrthographic&&(m=Ow(1,m,Fw(this.pitch>=15?1:this.pitch/15))),m}getWorldToCameraMatrix(){const i=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&at.multiply(i,i,this.globeMatrix),i}getFrustum(i){return al.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i,"meters"===this.projection.zAxisUnit)}}function Lw(o,i,s){at.identity(o),at.rotateZ(o,o,ni(i[2])),at.rotateX(o,o,ni(i[0])),at.rotateY(o,o,ni(i[1])),at.scale(o,o,s),at.multiply(o,o,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Sg(o,i,s,l,d,u,m,p){const g=[s[0]-i[0],s[1]-i[1],0],_=[l[0]-i[0],l[1]-i[1],0];if(Z.length(g)<1e-12||Z.length(_)<1e-12)return _o.identity(o);const y=Z.cross([],g,_);Z.normalize(y,y),Z.subtract(_,l,i),g[2]=(u-d)*p,_[2]=(m-d)*p;const v=g;return Z.cross(v,g,_),Z.normalize(v,v),_o.rotationTo(o,y,v)}function Bw(o,i,s=!1){const l=Dr(i.zoom),d=function(u,m,p){const g=m.worldSize,_=[u[12],u[13],u[14]],y=an(_[1]/g),v=Ls(_[0]/g),w=at.identity([]),C=sn(1,y)*g,D=sn(1,0)*g*Pc(y,m.zoom),k=1/Ax(g);let S=D*k;if(p){const O=Qr(m.projection,m.zoom,m.width,m.height,1024);S=k*m.projection.pixelSpaceConversion(m.center.lat,g,O)}const E=fs(y,v);Z.add(E,E,Z.scale([],Z.normalize([],E),C*S*_[2]));const A=function(O){const R=[O[0],O[1],O[2]];let F=[0,1,0];const B=Z.cross([],F,R);return Z.cross(F,R,B),0===Z.squaredLength(F)&&(F=[0,1,0],Z.cross(B,R,F)),Z.normalize(B,B),Z.normalize(F,F),Z.normalize(R,R),[B[0],B[1],B[2],0,F[0],F[1],F[2],0,R[0],R[1],R[2],0,O[0],O[1],O[2],1]}(E);at.scale(w,w,[S,S,S*C]),at.translate(w,w,[-_[0],-_[1],-_[2]]);const P=at.multiply([],m.globeMatrix,A);return at.multiply(P,P,w),at.multiply(P,P,u),P}(o,i,s);return l>0?function(m,p,g){const _=(D,k,S)=>{const E=Z.length(D),A=Z.length(k),P=Rc(D,k,S);return Z.scale(P,P,1/Z.length(P)*_e(E,A,S))},y=_([m[0],m[1],m[2]],[p[0],p[1],p[2]],g),v=_([m[4],m[5],m[6]],[p[4],p[5],p[6]],g),w=_([m[8],m[9],m[10]],[p[8],p[9],p[10]],g),C=Rc([m[12],m[13],m[14]],[p[12],p[13],p[14]],g);return[y[0],y[1],y[2],0,v[0],v[1],v[2],0,w[0],w[1],w[2],0,C[0],C[1],C[2],1]}(d,function(m,p){const g=p.worldSize,_=sn(1,0)*g*Pc(p.center.lat,p.zoom)/Ax(g),y=sn(1,p.center.lat)*g,v=at.identity([]);return at.rotateY(v,v,ni(p.center.lng)),at.rotateX(v,v,ni(p.center.lat)),at.translate(v,v,[0,0,ms]),at.scale(v,v,[_,_,_*y]),at.translate(v,v,[p.point.x-.5*g,p.point.y-.5*g,0]),at.multiply(v,v,m),at.multiply(v,p.globeMatrix,v)}(o,i),l):d}const Bd=[1,1,1];class pT{constructor(i,s,l,d){this.id=i,this.position=null!=s?new qe(s[0],s[1]):new qe(0,0),this.orientation=l??[0,0,0],this.nodes=d,this.uploaded=!1,this.aabb=new gn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(i,s){if(at.multiply(i.matrix,s,i.matrix),i.meshes)for(const l of i.meshes){const d=gn.applyTransform(l.aabb,i.matrix);this.aabb.encapsulate(d)}if(i.children)for(const l of i.children)this._applyTransformations(l,i.matrix)}computeBoundsAndApplyParent(){const i=at.identity([]);for(const s of this.nodes)this._applyTransformations(s,i)}_positionModelOnTerrain(i,s){const l=i.elevation;if(!l)return 0;const d=gn.projectAabbCorners(this.aabb,this.matrix),u=sn(1,this.position.lat)*i.worldSize,m=function(E,A){const P=[0,0,1],O=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const R of O){const F=E[R.corners[0]],B=E[R.corners[1]],j=E[R.corners[2]],U=[B[0]-F[0],B[1]-F[1],A*(B[2]-F[2])],H=Z.cross(U,U,[j[0]-F[0],j[1]-F[1],A*(j[2]-F[2])]);Z.normalize(H,H),R.dotProductWithUp=Z.dot(H,P)}return O.sort((R,F)=>R.dotProductWithUp-F.dotProductWithUp),O[0].corners}(d,u),p=d[m[0]],g=d[m[1]],_=d[m[2]],y=d[m[3]],v=l.getAtPointOrZero(new Ei(p[0]/i.worldSize,p[1]/i.worldSize),0),w=l.getAtPointOrZero(new Ei(g[0]/i.worldSize,g[1]/i.worldSize),0),C=l.getAtPointOrZero(new Ei(_[0]/i.worldSize,_[1]/i.worldSize),0),D=l.getAtPointOrZero(new Ei(y[0]/i.worldSize,y[1]/i.worldSize),0),k=(v+D)/2,S=(w+C)/2;return k>S?w<C?Sg(s,g,y,p,w,D,v,u):Sg(s,_,p,y,C,v,D,u):v<D?Sg(s,p,g,_,v,w,C,u):Sg(s,y,_,g,D,C,w,u),Math.max(k,S)}computeModelMatrix(i,s,l,d,u,m,p=!1){const g=i.transform,_=g.zoom,y=g.project(this.position),v=Pc(this.position.lat,_),w=1/v;at.identity(this.matrix),at.translate(this.matrix,this.matrix,[y.x+d[0]*w,y.y+d[1]*w,d[2]]);let C=1,D=1;const k=g.worldSize;if(p){if("mercator"===g.projection.name){let P=0;g.elevation&&(P=g.elevation.getAtPointOrZero(new Ei(y.x/k,y.y/k),0));const O=Qi.transformMat4([],[y.x,y.y,P,1],g.projMatrix)[3]/g.cameraToCenterDistance;C=O,D=O*Pc(g.center.lat,_)}else if("globe"===g.projection.name){const P=Bw(this.matrix,g),O=at.multiply([],g.projMatrix,P),R=[0,0,0,1];Qi.transformMat4(R,R,O);const F=R[3]/g.cameraToCenterDistance,B=Dr(_),j=g.projection.pixelsPerMeter(this.position.lat,k)*Pc(this.position.lat,_),U=g.projection.pixelsPerMeter(g.center.lat,k)*Pc(g.center.lat,_);C=F/_e(j,Lx(g.center.lat),B),D=F*v/j,C*=U,D*=U}}else C=w;at.scale(this.matrix,this.matrix,[C,C,D]);const S=[...this.matrix],E=this.orientation,A=[];if(Lw(A,[E[0]+s[0],E[1]+s[1],E[2]+s[2]],l),at.multiply(this.matrix,S,A),u&&g.elevation){let P=0;const O=[];if(m&&g.elevation){P=this._positionModelOnTerrain(g,O);const R=at.fromQuat([],O),F=at.multiply([],R,A);at.multiply(this.matrix,S,F)}else P=g.elevation.getAtPointOrZero(new Ei(y.x/k,y.y/k),0);0!==P&&(this.matrix[14]+=P)}}upload(i){if(!this.uploaded){for(const s of this.nodes)Nc(s,i);for(const s of this.nodes)ep(s);this.uploaded=!0}}destroy(){for(const i of this.nodes)Ey(i)}}function Tg(o,i,s=!1){o.uploaded||(o.gfxTexture=new Un(i,o.image,s?i.gl.R8:i.gl.RGBA,{useMipmap:o.sampler.minFilter>=i.gl.NEAREST_MIPMAP_NEAREST}),o.uploaded=!0,o.image=null)}function Nw(o,i,s){o.indexBuffer=i.createIndexBuffer(o.indexArray,!1,!0),o.vertexBuffer=i.createVertexBuffer(o.vertexArray,vO.members,!1,!0),o.normalArray&&(o.normalBuffer=i.createVertexBuffer(o.normalArray,It.members,!1,!0)),o.texcoordArray&&(o.texcoordBuffer=i.createVertexBuffer(o.texcoordArray,Kr.members,!1,!0)),o.colorArray&&(o.colorBuffer=i.createVertexBuffer(o.colorArray,(12===o.colorArray.bytesPerElement?xO:wO).members,!1,!0)),o.featureArray&&(o.pbrBuffer=i.createVertexBuffer(o.featureArray,CO.members,!0)),o.segments=on.simpleSegment(0,0,o.vertexArray.length,o.indexArray.length);const l=o.material;l.pbrMetallicRoughness.baseColorTexture&&Tg(l.pbrMetallicRoughness.baseColorTexture,i),l.pbrMetallicRoughness.metallicRoughnessTexture&&Tg(l.pbrMetallicRoughness.metallicRoughnessTexture,i),l.normalTexture&&Tg(l.normalTexture,i),l.occlusionTexture&&Tg(l.occlusionTexture,i,s),l.emissionTexture&&Tg(l.emissionTexture,i)}function Nc(o,i,s){if(o.meshes)for(const l of o.meshes)Nw(l,i,s);if(o.children)for(const l of o.children)Nc(l,i,s)}function ep(o){if(o.meshes)for(const i of o.meshes)i.indexArray.destroy(),i.vertexArray.destroy(),i.colorArray&&i.colorArray.destroy(),i.normalArray&&i.normalArray.destroy(),i.texcoordArray&&i.texcoordArray.destroy(),i.featureArray&&i.featureArray.destroy();if(o.children)for(const i of o.children)ep(i)}function Ey(o){if(o.meshes)for(const s of o.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((i=s.material).pbrMetallicRoughness.baseColorTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),i.pbrMetallicRoughness.metallicRoughnessTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),i.normalTexture&&i.normalTexture.gfxTexture&&i.normalTexture.gfxTexture.destroy(),i.emissionTexture&&i.emissionTexture.gfxTexture&&i.emissionTexture.gfxTexture.destroy(),i.occlusionTexture&&i.occlusionTexture.gfxTexture&&i.occlusionTexture.gfxTexture.destroy()));var i;if(o.children)for(const s of o.children)Ey(s)}class Ay{constructor(i,s){this.feature=i,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class MO{constructor(){this.instancedDataArray=new K0,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class DO{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.fqid),this.projection=i.projection,this.index=i.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(i,s,l,d){this.tileToMeter=tg(l);const u=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:m,id:p,index:g,sourceLayerIndex:_}of i){const y=ql(m,u);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),y,l))continue;const v={id:p,sourceLayerIndex:_,index:g,geometry:u?y.geometry:ll(m,l,d),properties:m.properties,type:m.type,patterns:{}},w=this.addFeature(v,v.geometry,y);w&&s.featureIndex.insert(m,v.geometry,g,_,this.index,this.instancesPerModel[w].instancedDataArray.length)}this.lookup=null}update(i,s,l,d){for(const u in this.instancesPerModel){const m=this.instancesPerModel[u];for(const p in i)m.idToFeaturesIndex.hasOwnProperty(p)&&this.evaluate(m.features[m.idToFeaturesIndex[p]],i[p],m,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let i=!1;for(const s in this.instancesPerModel){const l=this.instancesPerModel[s];for(const d of l.features){const u=this.layers[0],m=d.feature,p=this.canonical,g=u.paint.get("model-rotation").evaluate(m,{},p),_=u.paint.get("model-scale").evaluate(m,{},p),y=u.paint.get("model-translation").evaluate(m,{},p);Z.exactEquals(d.rotation,g)&&Z.exactEquals(d.scale,_)&&Z.exactEquals(d.translation,y)||(this.evaluate(d,d.featureStates,l,!0),i=!0)}}return i}isEmpty(){for(const i in this.instancesPerModel)if(0!==this.instancesPerModel[i].instancedDataArray.length)return!1;return!0}uploadPending(){return!this.uploaded}upload(i){if(!this.uploaded)for(const s in this.instancesPerModel){const l=this.instancesPerModel[s];l.instancedDataArray.length<0||0===l.instancedDataArray.length||(l.instancedDataBuffer?l.instancedDataBuffer.updateData(l.instancedDataArray):l.instancedDataBuffer=i.createVertexBuffer(l.instancedDataArray,Ew.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const i in this.instancesPerModel){const s=this.instancesPerModel[i];0!==s.instancedDataArray.length&&s.instancedDataBuffer&&s.instancedDataBuffer.destroy()}}addFeature(i,s,l){const d=this.layers[0],u=d.layout.get("model-id").evaluate(l,{},this.canonical);if(!u)return rt(`modelId is not evaluated for layer ${d.id} and it is not going to get rendered.`),u;this.instancesPerModel[u]||(this.instancesPerModel[u]=new MO);const m=this.instancesPerModel[u],p=m.instancedDataArray,g=new Ay(l,p.length);for(const _ of s)for(const y of _){if(y.x<0||y.x>=pt||y.y<0||y.y>=pt)continue;const v=(this.lookupDim-1)/pt,w=this.lookupDim*(y.y*v|0)+y.x*v|0;if(this.lookup){if(0!==this.lookup[w])continue;this.lookup[w]=1}this.instanceCount++;const C=p.length;p.resize(C+1),m.instancesEvaluatedElevation.push(0),p.float32[16*C]=y.x,p.float32[16*C+1]=y.y}return g.instancedDataCount=m.instancedDataArray.length-g.instancedDataOffset,g.instancedDataCount>0&&(i.id&&(m.idToFeaturesIndex[i.id]=m.features.length),m.features.push(g),this.evaluate(g,{},m,!1)),u}evaluate(i,s,l,d){const u=this.layers[0],m=i.feature,p=this.canonical,g=i.rotation=u.paint.get("model-rotation").evaluate(m,s,p),_=i.scale=u.paint.get("model-scale").evaluate(m,s,p),y=i.translation=u.paint.get("model-translation").evaluate(m,s,p),v=u.paint.get("model-color").evaluate(m,s,p);v.a=u.paint.get("model-color-mix-intensity").evaluate(m,s,p);const w=[];this.maxVerticalOffset<y[2]&&(this.maxVerticalOffset=y[2]),this.maxScale=Math.max(Math.max(this.maxScale,_[0]),Math.max(_[1],_[2])),Lw(w,g,_);const C=Math.round(100*v.a)+v.b/1.05;for(let D=0;D<i.instancedDataCount;++D){const k=i.instancedDataOffset+D,S=16*k,E=l.instancedDataArray.float32;let A=0;d&&(A=E[S+6]-l.instancesEvaluatedElevation[k]);const P=0|E[S+1];E[S]=(0|E[S])+v.r/1.05,E[S+1]=P+v.g/1.05,E[S+2]=C,E[S+3]=1/(p.z>10?this.tileToMeter:tg(p,P)),E[S+4]=y[0],E[S+5]=y[1],E[S+6]=y[2]+A,E[S+7]=w[0],E[S+8]=w[1],E[S+9]=w[2],E[S+10]=w[4],E[S+11]=w[5],E[S+12]=w[6],E[S+13]=w[8],E[S+14]=w[9],E[S+15]=w[10],l.instancesEvaluatedElevation[k]=y[2]}}}de(DO,"ModelBucket",{omit:["layers"]}),de(MO,"PerModelAttributes"),de(Ay,"ModelFeature");const kO=new Gn({visibility:new Ft(ct.layout_model.visibility),"model-id":new ke(ct.layout_model["model-id"])});var SO={paint:new Gn({"model-opacity":new Ft(ct.paint_model["model-opacity"]),"model-rotation":new ke(ct.paint_model["model-rotation"]),"model-scale":new ke(ct.paint_model["model-scale"]),"model-translation":new ke(ct.paint_model["model-translation"]),"model-color":new ke(ct.paint_model["model-color"]),"model-color-mix-intensity":new ke(ct.paint_model["model-color-mix-intensity"]),"model-type":new Ft(ct.paint_model["model-type"]),"model-cast-shadows":new Ft(ct.paint_model["model-cast-shadows"]),"model-receive-shadows":new Ft(ct.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Ft(ct.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new ke(ct.paint_model["model-emissive-strength"]),"model-roughness":new ke(ct.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new ke(ct.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Ft(ct.paint_model["model-cutoff-fade-range"])}),layout:kO};const Iy=new Float32Array(262144),Qu=new Uint8Array(262144);function ao(o){let i=0;if(o.meshes)for(const s of o.meshes)i=Math.max(i,s.aabb.max[2]);if(o.children)for(const s of o.children)i=Math.max(i,ao(s));return i}const zw=["","wall","door","roof","window","lamp","logo"];class fT{constructor(i){this.node=i,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:i.id,geometry:[],properties:{height:ao(i)}}}}class gT{constructor(i,s,l,d){this.nodes=i,this.id=s,this.modelTraits|=1,this.uploaded=!1,this.hasPattern=!1,l&&(this.modelTraits|=4),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=d,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(i){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const l of s){const d=l.node;this.uploaded?this.updatePbrBuffer(d):Nc(d,i,!0)}for(const l of s)ep(l.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(i){let s=!1;if(!i.meshes)return s;for(const l of i.meshes)l.pbrBuffer&&(l.pbrBuffer.updateData(l.featureArray),s=!0);return s}needsReEvaluation(i,s,l){const d=i.transform.projectionOptions,u=i.style.getBrightness(),m=this.brightness!==u;return!!(!this.uploaded||this.dirty||d.name!==this.projection.name||ip(l.paint.get("model-color").value,m)||ip(l.paint.get("model-color-mix-intensity").value,m)||ip(l.paint.get("model-roughness").value,m)||ip(l.paint.get("model-emissive-strength").value,m)||ip(l.paint.get("model-height-based-emissive-strength-multiplier").value,m))&&(this.projection=d,this.brightness=u,!0)}evaluateScale(i,s){if(i.transform.zoom===this.zoom)return;this.zoom=i.transform.zoom;const l=this.getNodesInfo(),d=this.id.canonical;for(const u of l){const m=u.feature;u.evaluatedScale=s.paint.get("model-scale").evaluate(m,{},d)}}evaluate(i){const s=this.getNodesInfo();for(const l of s){if(!l.node.meshes)continue;const d=l.feature,u=l.node.meshes&&l.node.meshes[0].featureData,m=l.evaluatedColor[2],p=l.evaluatedRMEA[2],g=this.id.canonical;if(l.hasTranslucentParts=!1,u){for(let _=0;_<zw.length;_++){const y=zw[_];y.length&&(d.properties.part=y);const v=i.paint.get("model-color").evaluate(d,{},g),w=i.paint.get("model-color-mix-intensity").evaluate(d,{},g);l.evaluatedColor[_]=[v.r,v.g,v.b,w],l.evaluatedRMEA[_][0]=i.paint.get("model-roughness").evaluate(d,{},g),l.evaluatedRMEA[_][2]=i.paint.get("model-emissive-strength").evaluate(d,{},g),l.evaluatedRMEA[_][3]=v.a,l.emissionHeightBasedParams[_]=i.paint.get("model-height-based-emissive-strength-multiplier").evaluate(d,{},g),!l.hasTranslucentParts&&v.a<1&&(l.hasTranslucentParts=!0)}delete d.properties.part,_T(l,m!==l.evaluatedColor[2]||p!==l.evaluatedRMEA[2])}l.evaluatedScale=i.paint.get("model-scale").evaluate(d,{},g),this.updatePbrBuffer(l.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(i,s,l,d){const u=i.findDEMTileFor(l);if(u&&(u.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(u.dem&&u.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=u.tileID.overscaledZ;const m=zu.create(i,l,u);if(!m)return;4&this.modelTraits&&this.updateDEM(i,m,l,d);for(const p of this.getNodesInfo()){const g=p.node;if(!g.footprint||!g.footprint.vertices||!g.footprint.vertices.length)continue;const _=g.footprint.vertices;let y=m.getElevationAt(_[0].x,_[0].y,!0,!0);for(let v=1;v<_.length;v++)y=Math.min(y,m.getElevationAt(_[v].x,_[v].y,!0,!0));g.elevation=y}}this.terrainTile=u.tileID.canonical,this.terrainExaggeration=s}}updateDEM(i,s,l,d){let u=s._dem._modifiedForSources[d];if(void 0===u&&(s._dem._modifiedForSources[d]=[],u=s._dem._modifiedForSources[d]),u.includes(l.canonical))return;const m=s._dem.dim;u.push(l.canonical);let p=!1;for(const g of this.getNodesInfo()){const _=g.node;if(!_.footprint||!_.footprint.grid)continue;const y=_.footprint.grid,v=s.tileCoordToPixel(y.min.x,y.min.y),w=s.tileCoordToPixel(y.max.x,y.max.y),C=Math.min(Math.min(m-w.y,v.x),Math.min(v.y,m-w.x));if(C<0)continue;const D=he(C,2,5);let k=Math.max(0,v.x-D),S=Math.max(0,v.y-D),E=Math.min(w.x+D,m-1),A=Math.min(w.y+D,m-1);for(let F=S;F<=A;++F)for(let B=k;B<=E;++B)Qu[F*m+B]=255;let P=0,O=0;for(let F=0;F<y.cellsY;++F)for(let B=0;B<y.cellsX;++B){if(!y.cells[F*y.cellsX+B])continue;const j=s.tileCoordToPixel(y.min.x+B/y.xScale,y.min.y+F/y.yScale),U=s.tileCoordToPixel(y.min.x+(B+1)/y.xScale,y.min.y+(F+1)/y.yScale);for(let H=j.y;H<=Math.min(U.y+1,m-1);++H)for(let W=j.x;W<=Math.min(U.x+1,m-1);++W)255===Qu[H*m+W]&&(Qu[H*m+W]=0,P+=s.getElevationAtPixel(W,H),O++)}const R=P/O;k=Math.max(1,v.x-D),S=Math.max(1,v.y-D),E=Math.min(w.x+D,m-2),A=Math.min(w.y+D,m-2),p=!0;for(let F=S;F<=A;++F)for(let B=k;B<=E;++B)0===Qu[F*m+B]&&(Iy[F*m+B]=s._dem.set(B,F,R));for(let F=1;F<D;++F){k=Math.max(1,v.x-F),S=Math.max(1,v.y-F),E=Math.min(w.x+F,m-2),A=Math.min(w.y+F,m-2);for(let B=S;B<=A;++B)for(let j=k;j<=E;++j){const U=B*m+j;if(255===Qu[U]){let H=0,W=0,q=-1,X=-1;for(let G=-1;G<=1;++G)for(let Q=-1;Q<=1;++Q){const it=(B+G)*m+j+Q;if(Qu[it]>=F)continue;const st=Iy[it],J=Math.abs(st);J>W&&(H=st,W=J,q=Q,X=G)}if(W>.1){const G=1-(F+.5*Math.abs(q*X))/D;let Q=s._dem.get(j,B)+H*G;const it=s._dem.get(j+q,B+X),st=s._dem.get(j-q,B-X,!0);(Q-it)*(Q-st)>0&&(Q=(it+st)/2),Iy[U]=s._dem.set(j,B,Q),Qu[U]=F}}}}}p&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=Ze.now())}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const i of this.nodes)this.nodesInfo.push(new fT(i));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const i of this.nodes)Ey(i);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const i=this.getNodesInfo();for(const s of i)ep(s.node),Ey(s.node)}isEmpty(){return!this.nodes.length}updateReplacement(i,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const l=s.getReplacementRegionsForTile(i.toUnwrapped()),d=this.getNodesInfo();for(let u=0;u<this.nodesInfo.length;u++){const m=d[u].node;d[u].hiddenByReplacement=!!m.footprint&&!l.find(p=>p.footprint===m.footprint)}}getHeightAtTileCoord(i,s){const l=this.getNodesInfo(),d=[];for(let u=0;u<this.nodesInfo.length;u++){const m=l[u],p=m.node.meshes[0];if(i<p.aabb.min[0]||s<p.aabb.min[1]||i>p.aabb.max[0]||s>p.aabb.max[1])continue;const g=(i-p.aabb.min[0])/(p.aabb.max[0]-p.aabb.min[0])*64|0,_=64*Math.min(63,(s-p.aabb.min[1])/(p.aabb.max[1]-p.aabb.min[1])*64|0)+Math.min(63,g);if(!(p.heightmap[_]<0&&m.node.footprint))return m.hiddenByReplacement?void 0:{height:p.heightmap[_],maxHeight:m.feature.properties.height,hidden:!1,verticalScale:m.evaluatedScale[2]};if(m.node.footprint.grid.query(new ot(i,s),new ot(i,s),d),d.length>0)return{height:void 0,maxHeight:m.feature.properties.height,hidden:m.hiddenByReplacement,verticalScale:m.evaluatedScale[2]}}}}function ip(o,i){return!o.isLightConstant&&i}function TO(o,i,s,l,d,u,m,p){let g=(61440&i|(61440&i)>>4)>>8,_=(3840&i|(3840&i)>>4)>>4,y=240&i|(240&i)>>4;s[3]>0&&(g=_e(g,255*s[0],s[3]),_=_e(_,255*s[1],s[3]),y=_e(y,255*s[2],s[3]));const v=g<<8|_,w=y<<8|Math.floor(255*l[3]),C=function(F){const B=he(F,0,2);return Math.min(Math.round(.5*B*255),255)}(l[2])<<8|15*l[0]<<4|15*l[1],D=he(d[0],0,1),k=he(d[1],0,1),S=he(d[2],0,1),E=he(d[3],0,1);let A,P,O,R;if(D!==k&&m!==u&&k!==D){const F=m-u;P=1/(F*(k-D)),O=-(u+F*D)/(F*(k-D));const B=he(d[4],-1,1);R=Math.pow(10,B),A=255*S<<8|255*E}else A=65535,P=0,O=1,R=1;if(o.emplaceBack(v,w,C,A,P,O,R),p){const F=p.length;p.clear();for(let B=0;B<F;B++)p.emplaceBack(v,w,C,A,P,O,R)}}function _T(o,i){const s=o.node;let l=0;for(const d of s.meshes){if(s.lights&&s.lightMeshIndex===l||!d.featureData)continue;d.featureArray=new xd,d.featureArray.reserve(d.featureData.length);let u=i;for(const m of d.featureData){let p;const g=65535&m,_=(15&g)<8?15&g:0,y=m>>16&65535,v=o.evaluatedRMEA[_],w=o.evaluatedColor[_],C=o.emissionHeightBasedParams[_];if(u&&2===_&&s.lights&&(p=new xd,p.resize(10*s.lights.length)),TO(d.featureArray,y,w,v,C,d.aabb.min[2],d.aabb.max[2],p),p&&u){u=!1;const D=s.meshes[s.lightMeshIndex];D.featureArray=p,D.featureArray._trim()}}d.featureArray._trim(),l++}}de(gT,"Tiled3dModelBucket",{omit:["layers"]}),de(fT,"Tiled3dModelFeature");class bT{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(i){const s=Vw(new ot(0,0),new ot(pt,pt),i),l=[];for(const d of this._activeRegions){if(d.hiddenByOverlap||!vT(s,d))continue;const u=EO(d.min,d.max,i);l.push({min:u.min,max:u.max,sourceId:this._sourceIds[d.priority],footprint:d.footprint,footprintTileId:d.tileId})}return l}setSources(i){this._setSources(i.map(s=>({getSourceId:()=>s.cache.id,getFootprints:()=>{const l=[];for(const d of s.cache.getVisibleCoordinates()){const u=s.cache.getTile(d).buckets[s.layer];if(u)for(const m of u.getNodesInfo()){const p=m.node;p.footprint&&l.push({footprint:p.footprint,id:d.toUnwrapped()})}}return l}})))}_addSource(i){const s=i.getFootprints();if(0!==s.length){for(const l of s){if(!l.footprint)continue;const d=Vw(l.footprint.min,l.footprint.max,l.id);this._activeRegions.push({min:d.min,max:d.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:l.id,footprint:l.footprint})}this._sourceIds.push(i.getSourceId())}}_computeReplacement(){this._activeRegions.sort((s,l)=>s.priority-l.priority||zc(s.min,l.min)||zc(s.max,l.max));let i=this._activeRegions.length!==this._prevRegions.length;if(!i){let s=0,l=0;for(;!i&&s!==this._activeRegions.length;){const d=this._activeRegions[s],u=this._prevRegions[l];i=d.priority!==u.priority||!yT(d,u),++s,++l}}if(i){++this._updateTime;const s=l=>{const d=this._activeRegions;if(l>=d.length)return l;const u=d[l].priority;for(;l<d.length&&d[l].priority===u;)++l;return l};if(this._sourceIds.length>1){let l=0,d=s(l);for(;l!==d;){let u=l;const m=l;for(;u!==d;){const p=this._activeRegions[u];p.hiddenByOverlap=!1;for(let g=0;g<m;g++){const _=this._activeRegions[g];if(!_.hiddenByOverlap&&vT(p,_)&&(p.hiddenByOverlap=AO(p.footprint,p.tileId,_.footprint,_.tileId),p.hiddenByOverlap))break}++u}l=d,d=s(l)}}}}_setSources(i){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let s=i.length-1;s>=0;s--)this._addSource(i[s]);this._computeReplacement()}}function zc(o,i){return o.x-i.x||o.y-i.y}function yT(o,i){return 0===zc(o.min,i.min)&&0===zc(o.max,i.max)}function vT(o,i){return!(o.min.x>i.max.x||o.max.x<i.min.x||o.min.y>i.max.y||o.max.y<i.min.y)}function Vw(o,i,s){const l=1/pt,d=1/(1<<s.canonical.z),u=(i.x*l+s.canonical.x)*d+s.wrap,m=(i.y*l+s.canonical.y)*d;return{min:new ot((o.x*l+s.canonical.x)*d+s.wrap,(o.y*l+s.canonical.y)*d),max:new ot(u,m)}}function EO(o,i,s){const l=1<<s.canonical.z,d=((i.x-s.wrap)*l-s.canonical.x)*pt,u=(i.y*l-s.canonical.y)*pt;return{min:new ot(((o.x-s.wrap)*l-s.canonical.x)*pt,(o.y*l-s.canonical.y)*pt),max:new ot(d,u)}}function jw(o,i,s,l,d,u,m){const p=o.indices,g=o.vertices,_=[];for(let y=l;y<l+d;y+=3){const v=i[s[y+0]+u],w=i[s[y+1]+u],C=i[s[y+2]+u],D=Math.min(v.x,w.x,C.x),k=Math.max(v.x,w.x,C.x),S=Math.min(v.y,w.y,C.y),E=Math.max(v.y,w.y,C.y);_.length=0,o.grid.query(new ot(D,S),new ot(k,E),_);for(let A=0;A<_.length;A++){const P=_[A];if(eg(g[p[3*P+0]],g[p[3*P+1]],g[p[3*P+2]],v,w,C,m))return!0}}return!1}function AO(o,i,s,l){if(!o||!s)return!1;let d=o.vertices;if(!i.canonical.equals(l.canonical)||i.wrap!==l.wrap){if(s.vertices.length<o.vertices.length)return AO(s,l,o,i);const u=i.canonical,m=l.canonical,p=Math.pow(2,m.z-u.z);d=o.vertices.map(g=>new ot(g.x*u.x*pt*p-m.x*pt,g.y*u.y*pt*p-m.y*pt))}return jw(s,d,o.indices,0,o.indices.length,0,0)}const pa=ow.types,Qe=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],ic=["fill-extrusion-flood-light-ground-radius"],IO=Math.pow(2,13),RO=Math.pow(2,15)-1,ml=new ot(0,1),lo=2147483648;function gs(o,i,s,l,d,u,m,p){o.emplaceBack((i<<1)+m,(s<<1)+u,(Math.floor(l*IO)<<1)+d,Math.round(p))}function Eg(o,i,s,l,d,u){o.emplaceBack(i.x,i.y,(s.x<<1)+l,(s.y<<1)+d,u)}function np(o,i,s){o.emplaceBack(i.x,i.y,i.z,16384*s[0],16384*s[1],16384*s[2])}class xT{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class wT{constructor(){this.centroidXY=new ot(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new ot(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new ot(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new ot(this.max.x-this.min.x,this.max.y-this.min.y)}}class CT{constructor(){this.acc=new ot(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(i,s){i.min.x===Number.MAX_VALUE&&(i.min.x=i.max.x=s.x,i.min.y=i.max.y=s.y)}appendEdge(i,s,l){this.accCount++,this.acc._add(s);let d=!!this.borders;s.x<i.min.x?(i.min.x=s.x,d=!0):s.x>i.max.x&&(i.max.x=s.x,d=!0),s.y<i.min.y?(i.min.y=s.y,d=!0):s.y>i.max.y&&(i.max.y=s.y,d=!0),((0===s.x||s.x===pt)&&s.x===l.x)!=((0===s.y||s.y===pt)&&s.y===l.y)&&this.processBorderOverlap(s,l),d&&this.checkBorderIntersection(s,l)}checkBorderIntersection(i,s){s.x<0!=i.x<0&&this.addBorderIntersection(0,_e(s.y,i.y,(0-s.x)/(i.x-s.x))),s.x>pt!=i.x>pt&&this.addBorderIntersection(1,_e(s.y,i.y,(pt-s.x)/(i.x-s.x))),s.y<0!=i.y<0&&this.addBorderIntersection(2,_e(s.x,i.x,(0-s.y)/(i.y-s.y))),s.y>pt!=i.y>pt&&this.addBorderIntersection(3,_e(s.x,i.x,(pt-s.y)/(i.y-s.y)))}addBorderIntersection(i,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const l=this.borders[i];s<l[0]&&(l[0]=s),s>l[1]&&(l[1]=s)}processBorderOverlap(i,s){if(i.x===s.x){if(i.y===s.y)return;const l=0===i.x?0:1;this.addBorderIntersection(l,s.y),this.addBorderIntersection(l,i.y)}else{const l=0===i.y?2:3;this.addBorderIntersection(l,s.x),this.addBorderIntersection(l,i.x)}}centroid(){return 0===this.accCount?new ot(0,0):new ot(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((i,s)=>i+ +(s[0]!==Number.MAX_VALUE),0):0}}function MT(o,i){const s=o.add(i)._unit(),l=he(o.x*s.x+o.y*s.y,-1,1);var d,u,m;return d=Math.acos(l),Math.min(4,Math.max(-4,Math.tan(d)))/4*RO*((u=o).x*(m=i).y-u.y*m.x<0?-1:1)}const Uw=[o=>o.x<0,o=>o.x>pt,o=>o.y<0,o=>o.y>pt];function Ag(o,i,s,l){const d=[4];if(0===l)return d;s._mult(l);const u=o.sub(s),m=i.sub(s),p=[o,i,u,m];for(let g=0;g<4;g++)for(const _ of p)if(Uw[g](_)){d.push(g);break}return d}class DT{constructor(i){this.vertexArray=new pb,this.indexArray=new Cr,this.programConfigurations=new Cd(i.layers,i.zoom,s=>ic.includes(s)),this._segments=new on,this.hiddenByLandmarkVertexArray=new Tf,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new on}getDefaultSegment(){return this.regionSegments[4]}hasData(){return 0!==this.vertexArray.length}addData(i,s,l,d=!1){const u=i.length;if(u>2){let m=Math.max(0,this._segments.get().length-1);const p=this._segments._prepareSegment(4*u,this.vertexArray.length,2*this._segmentToGroundQuads[m].length);let g;m!==this._segments.get().length-1&&(m++,this._segmentToGroundQuads[m]=[],this._segmentToRegionTriCounts[m]=[0,0,0,0,0]);{const _=i[0],y=i[1];g=MT(_.sub(i[u-1])._perp()._unit(),y.sub(_)._perp()._unit())}for(let _=0;_<u;_++){const y=_===u-1?0:_+1,v=i[_],w=i[y],C=i[y===u-1?0:y+1],D=w.sub(v)._perp()._unit(),k=MT(D,C.sub(w)._perp()._unit()),S=g,E=k;if(Ry(v,w,s)||d&&Ig(v,s)&&Ig(w,s)){g=k;continue}const A=p.vertexLength;Eg(this.vertexArray,v,w,1,1,S),Eg(this.vertexArray,v,w,1,0,S),Eg(this.vertexArray,v,w,0,1,E),Eg(this.vertexArray,v,w,0,0,E),p.vertexLength+=4;const P=Ag(v,w,D,l);for(const O of P)this._segmentToGroundQuads[m].push({id:A,region:O}),this._segmentToRegionTriCounts[m][O]+=2,p.primitiveLength+=2;g=k}}}prepareBorderSegments(){if(!this.hasData())return;const i=this._segments.get(),s=i.length;for(let l=0;l<s;l++)this._segmentToGroundQuads[l].sort((d,u)=>d.region-u.region);for(let l=0;l<s;l++){const d=this._segmentToGroundQuads[l],u=i[l],m=this._segmentToRegionTriCounts[l];m.reduce((g,_)=>g+_,0);let p=0;for(let g=0;g<=4;g++){const _=m[g];if(0!==_){let y=this.regionSegments[g];y||(y=this.regionSegments[g]=new on);const v={vertexOffset:u.vertexOffset,primitiveOffset:u.primitiveOffset+p,vertexLength:u.vertexLength,primitiveLength:_};y.get().push(v)}p+=_}for(let g=0;g<d.length;g++){const _=d[g].id;this.indexArray.emplaceBack(_,_+1,_+3),this.indexArray.emplaceBack(_,_+3,_+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(i,s,l,d,u,m){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,i,s,l,d,u,m)}upload(i){this.hasData()&&(this.vertexBuffer=i.createVertexBuffer(this.vertexArray,AP.members),this.indexBuffer=i.createIndexBuffer(this.indexArray))}uploadPaintProperties(i){this.hasData()&&this.programConfigurations.upload(i)}update(i,s,l,d,u,m){this.hasData()&&this.programConfigurations.updatePaintArrays(i,s,l,d,u,m)}updateHiddenByLandmark(i){if(!this.hasData())return;const s=i.groundVertexCount+i.groundVertexArrayOffset;if(0===i.groundVertexCount)return;const l=i.flags&lo?1:0;for(let d=i.groundVertexArrayOffset;d<s;++d)this.hiddenByLandmarkVertexArray.emplace(d,l);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(i){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=i.createVertexBuffer(this.hiddenByLandmarkVertexArray,Bc.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let i=0;i<=4;i++){const s=this.regionSegments[i];s&&s.destroy()}}}}class rp{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Cr,this.footprintVertices=new Os,this.footprintSegments=[],this.layoutVertexArray=new bu,this.centroidVertexArray=new If,this.indexArray=new Cr,this.programConfigurations=new Cd(i.layers,i.zoom,s=>Qe.includes(s)),this.segments=new on,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.groundEffect=new DT(i),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(i,s,l,d){this.features=[],this.hasPattern=sS("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=tg(l),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:u,id:m,index:p,sourceLayerIndex:g}of i){const _=this.layers[0]._featureFilter.needGeometry,y=ql(u,_);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),y,l))continue;const v={id:m,sourceLayerIndex:g,index:p,geometry:_?y.geometry:ll(u,l,d),properties:u.properties,type:u.type,patterns:{}},w=this.layoutVertexArray.length;this.hasPattern?this.features.push(ew("fill-extrusion",this.layers,v,this.zoom,s)):this.addFeature(v,v.geometry,p,l,{},s.availableImages,d,s.brightness),s.featureIndex.insert(u,v.geometry,p,g,this.index,w)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(i,s,l,d,u,m){for(const p of this.features){const{geometry:g}=p;this.addFeature(p,g,p.index,s,l,d,u,m)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles()}update(i,s,l,d,u){const m=0!==Object.keys(i).length;if(m&&!this.stateDependentLayers.length)return;const p=m?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(i,s,p,l,d,u),this.groundEffect.update(i,s,p,l,d,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,RP),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,IP.members,!0)),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.groundEffect.uploadHiddenByLandmark(i),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,ag.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,s,l,d,u,m,p,g){const _=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(i,{})/this.tileToMeter,y=[new ot(0,0),new ot(pt,pt)],v=p.projection,w="globe"===v.name,C="Polygon"===pa[i.type],D=new CT;D.centroidDataIndex=this.centroidData.length;const k=new wT,S=this.layers[0].paint.get("fill-extrusion-base").evaluate(i,{},d)<=0,E=this.layers[0].paint.get("fill-extrusion-height").evaluate(i,{},d);k.height=E,k.vertexArrayOffset=this.layoutVertexArray.length,k.groundVertexArrayOffset=this.groundEffect.vertexArray.length,w&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new yu);const A=tw(s,500);for(let j=A.length-1;j>=0;j--){const U=A[j];(0===U.length||(P=U[0]).every(H=>H.x<=0)||P.every(H=>H.x>=pt)||P.every(H=>H.y<=0)||P.every(H=>H.y>=pt))&&A.splice(j,1)}var P;let O;if(w)O=Gw(A,y,d);else{O=[];for(const j of A)O.push({polygon:j,bounds:y})}const R=C?this.edgeRadius:0,F=R>0&&this.zoom<17,B=(j,U)=>{if(0===j.length)return!1;const H=j[j.length-1];return U.x===H.x&&U.y===H.y};for(const{polygon:j,bounds:U}of O){let H=0,W=0;for(const Q of j)C&&!Q[0].equals(Q[Q.length-1])&&Q.push(Q[0]),W+=C?Q.length-1:Q.length;const q=this.segments.prepareSegment((C?5:4)*W,this.layoutVertexArray,this.indexArray);k.footprintSegIdx<0&&(k.footprintSegIdx=this.footprintSegments.length),k.polygonSegIdx<0&&(k.polygonSegIdx=this.polygonSegments.length);const X={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},G=new xT;if(G.vertexOffset=this.footprintVertices.length,G.indexOffset=3*this.footprintIndices.length,G.ringIndices=[],C){const Q=[],it=[];H=q.vertexLength;for(let J=0;J<j.length;J++){const et=j[J];et.length&&0!==J&&it.push(Q.length/2);const dt=[];let mt,ut;mt=et[1].sub(et[0])._perp()._unit(),G.ringIndices.push(et.length-1);for(let bt=1;bt<et.length;bt++){const yt=et[bt],Ct=et[bt===et.length-1?1:bt+1],gt=yt.clone();if(R){ut=Ct.sub(yt)._perp()._unit();const At=mt.add(ut)._unit(),Gt=R*Math.min(4,1/(mt.x*At.x+mt.y*At.y));gt.x+=Gt*At.x,gt.y+=Gt*At.y,gt.x=Math.round(gt.x),gt.y=Math.round(gt.y),mt=ut}!S||0!==R&&!F||B(dt,gt)||dt.push(gt),gs(this.layoutVertexArray,gt.x,gt.y,0,0,1,1,0),q.vertexLength++,this.footprintVertices.emplaceBack(yt.x,yt.y),Q.push(yt.x,yt.y),w&&np(this.layoutVertexExtArray,v.projectTilePoint(gt.x,gt.y,d),v.upVector(d,gt.x,gt.y))}S&&(0===R||F)&&(0!==dt.length&&B(dt,dt[0])&&dt.pop(),this.groundEffect.addData(dt,U,_))}const st=sg(Q,it);for(let J=0;J<st.length;J+=3)this.footprintIndices.emplaceBack(G.vertexOffset+st[J+0],G.vertexOffset+st[J+1],G.vertexOffset+st[J+2]),this.indexArray.emplaceBack(H+st[J],H+st[J+2],H+st[J+1]),q.primitiveLength++;G.indexCount+=st.length,G.vertexCount+=this.footprintVertices.length-G.vertexOffset}for(let Q=0;Q<j.length;Q++){const it=j[Q];D.startRing(k,it[0]);let st=it.length>4&&ST(it[it.length-2],it[0],it[1]),J=R?PO(it[it.length-2],it[0],it[1],R):0;const et=[];let dt,mt,ut;mt=it[1].sub(it[0])._perp()._unit();let bt=!0;for(let yt=1,Ct=0;yt<it.length;yt++){let gt=it[yt-1],At=it[yt];const Gt=it[yt===it.length-1?1:yt+1];if(D.appendEdge(k,At,gt),Ry(At,gt,U)){R&&(mt=Gt.sub(At)._perp()._unit(),bt=!bt);continue}const Et=At.sub(gt)._perp(),te=Et.x/(Math.abs(Et.x)+Math.abs(Et.y)),ie=Et.y>0?1:0,He=gt.dist(At);if(Ct+He>32768&&(Ct=0),R){ut=Gt.sub(At)._perp()._unit();let $e=Hw(gt,At,Gt,kT(mt,ut),R);isNaN($e)&&($e=0);const ze=At.sub(gt)._unit();gt=gt.add(ze.mult(J))._round(),At=At.add(ze.mult(-$e))._round(),J=$e,mt=ut,S&&this.zoom>=17&&(B(et,gt)||et.push(gt),B(et,At)||et.push(At))}const ve=q.vertexLength,Ui=it.length>4&&ST(gt,At,Gt);let xi=$w(Ct,st,bt);if(gs(this.layoutVertexArray,gt.x,gt.y,te,ie,0,0,xi),gs(this.layoutVertexArray,gt.x,gt.y,te,ie,0,1,xi),Ct+=He,xi=$w(Ct,Ui,!bt),st=Ui,gs(this.layoutVertexArray,At.x,At.y,te,ie,0,0,xi),gs(this.layoutVertexArray,At.x,At.y,te,ie,0,1,xi),q.vertexLength+=4,this.indexArray.emplaceBack(ve+0,ve+1,ve+2),this.indexArray.emplaceBack(ve+1,ve+3,ve+2),q.primitiveLength+=2,R){const $e=H+(1===yt?it.length-2:yt-2),ze=1===yt?H:$e+1;if(this.indexArray.emplaceBack(ve+1,$e,ve+3),this.indexArray.emplaceBack($e,ze,ve+3),q.primitiveLength+=2,void 0===dt&&(dt=ve),!Ry(Gt,it[yt],U)){const Ce=yt===it.length-1?dt:q.vertexLength;this.indexArray.emplaceBack(ve+2,ve+3,Ce),this.indexArray.emplaceBack(ve+3,Ce+1,Ce),this.indexArray.emplaceBack(ve+3,ze,Ce+1),q.primitiveLength+=3}bt=!bt}if(w){const $e=this.layoutVertexExtArray,ze=v.projectTilePoint(gt.x,gt.y,d),Ce=v.projectTilePoint(At.x,At.y,d),wi=v.upVector(d,gt.x,gt.y),Pi=v.upVector(d,At.x,At.y);np($e,ze,wi),np($e,ze,wi),np($e,Ce,Pi),np($e,Ce,Pi)}}C&&(H+=it.length-1),S&&R&&this.zoom>=17&&(0!==et.length&&B(et,et[0])&&et.pop(),this.groundEffect.addData(et,U,_,R>0))}this.footprintSegments.push(G),X.triangleCount=this.indexArray.length-X.triangleArrayOffset,this.polygonSegments.push(X),++k.footprintSegLen,++k.polygonSegLen}if(k.vertexCount=this.layoutVertexArray.length-k.vertexArrayOffset,k.groundVertexCount=this.groundEffect.vertexArray.length-k.groundVertexArrayOffset,0!==k.vertexCount){if(k.centroidXY=D.borders?ml:this.encodeCentroid(D,k),this.centroidData.push(k),D.borders){this.featuresOnBorder.push(D);const j=this.featuresOnBorder.length-1;for(let U=0;U<D.borders.length;U++)D.borders[U][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[U].push(j)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,u,m,d,g),this.groundEffect.addPaintPropertiesData(i,l,u,m,d,g),this.maxHeight=Math.max(this.maxHeight,E)}}sortBorders(){for(let i=0;i<this.borderFeatureIndices.length;i++)this.borderFeatureIndices[i].sort((s,l)=>this.featuresOnBorder[s].borders[i][0]-this.featuresOnBorder[l].borders[i][0])}splitToSubtiles(){const i=[];for(let p=0;p<this.centroidData.length;p++){const g=this.centroidData[p],_=+(g.min.y+g.max.y>pt),y=2*_+(+(g.min.x+g.max.x>pt)^_);for(let v=0;v<g.polygonSegLen;v++){const w=g.polygonSegIdx+v;i.push({centroidIdx:p,subtile:y,polygonSegmentIdx:w,triangleSegmentIdx:this.polygonSegments[w].triangleSegIdx})}}const s=new Cr;i.sort((p,g)=>p.triangleSegmentIdx===g.triangleSegmentIdx?p.subtile-g.subtile:p.triangleSegmentIdx-g.triangleSegmentIdx);let l=0,d=0,u=0;for(const p of i){if(p.triangleSegmentIdx!==l)break;u++}const m=i.length;for(;d!==i.length;){l=i[d].triangleSegmentIdx;let p=0,g=d,_=d;for(let y=g;y<u&&i[y].subtile===p;y++)_++;for(;g!==u;){const y=i[g];p=y.subtile;const v=this.centroidData[y.centroidIdx].min.clone(),w=this.centroidData[y.centroidIdx].max.clone(),C={vertexOffset:this.segments.segments[l].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[l].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let D=g;D<_;D++){const k=i[D],S=this.polygonSegments[k.polygonSegmentIdx],E=this.centroidData[k.centroidIdx].min,A=this.centroidData[k.centroidIdx].max,P=this.indexArray.uint16;for(let O=S.triangleArrayOffset;O<S.triangleArrayOffset+S.triangleCount;O++)s.emplaceBack(P[3*O],P[3*O+1],P[3*O+2]);C.primitiveLength+=S.triangleCount,v.x=Math.min(v.x,E.x),v.y=Math.min(v.y,E.y),w.x=Math.max(w.x,A.x),w.y=Math.max(w.y,A.y)}C.primitiveLength>0&&this.triangleSubSegments.push({segment:C,min:v,max:w}),g=_;for(let D=g;D<u&&i[D].subtile===i[g].subtile;D++)_++}d=u;for(let y=d;y<m&&i[y].triangleSegmentIdx===i[d].triangleSegmentIdx;y++)u++}s._trim(),this.indexArray=s}getVisibleSegments(i,s,l){let d=0,u=0;const m=1<<i.canonical.z;if(s){const k=s.getMinMaxForTile(i);k&&(d=k.min,u=k.max)}u+=this.maxHeight;const p=i.toUnwrapped();let g;const _=[p.canonical.x/m+p.wrap,p.canonical.y/m],y=[(p.canonical.x+1)/m+p.wrap,(p.canonical.y+1)/m],v=new on,w=(k,S,E)=>[k[0]*(1-E[0])+S[0]*E[0],k[1]*(1-E[1])+S[1]*E[1]],C=[],D=[];for(const k of this.triangleSubSegments){C[0]=k.min.x/pt,C[1]=k.min.y/pt,D[0]=k.max.x/pt,D[1]=k.max.y/pt;const S=w(_,y,C),E=w(_,y,D);if(0===new gn([S[0],S[1],d],[E[0],E[1],u]).intersectsPrecise(l)){g&&(v.segments.push(g),g=void 0);continue}const A=k.segment;g&&g.vertexOffset!==A.vertexOffset&&(v.segments.push(g),g=void 0),g?(g.vertexLength+=A.vertexLength,g.primitiveLength+=A.primitiveLength):g={vertexOffset:A.vertexOffset,primitiveLength:A.primitiveLength,vertexLength:A.vertexLength,primitiveOffset:A.primitiveOffset,sortKey:void 0,vaos:{}}}return g&&v.segments.push(g),v}encodeCentroid(i,s){const l=i.centroid(),d=s.span(),u=Math.min(7,Math.round(d.x*this.tileToMeter/10)),m=Math.min(7,Math.round(d.y*this.tileToMeter/10));return new ot(he(l.x,1,pt-1)<<3|u,he(l.y,1,pt-1)<<3|m)}showCentroid(i){const s=this.centroidData[i.centroidDataIndex];s.flags&=lo,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(i){this.groundEffect.updateHiddenByLandmark(i);const s=i.vertexArrayOffset,l=i.vertexCount+i.vertexArrayOffset,d=i.flags&lo?ml:i.centroidXY,u=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==d.y||u!==d.x){for(let m=s;m<l;++m)this.centroidVertexArray.emplace(m,d.x,d.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const i of this.centroidData)this.writeCentroidToBuffer(i)}updateReplacement(i,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const l=s.getReplacementRegionsForTile(i.toUnwrapped());if(function(u,m){if(u.length!==m.length)return!1;for(let p=0;p<u.length;p++)if(u[p].sourceId!==m[p].sourceId||!yT(u[p],m[p]))return!1;return!0}(this.activeReplacements,l))return;if(this.activeReplacements=l,0===this.centroidVertexArray.length)this.createCentroidsBuffer();else for(const u of this.centroidData)u.flags&=2147483647;const d=[];for(const u of this.activeReplacements){const m=Math.pow(2,u.footprintTileId.canonical.z-i.canonical.z);for(const p of this.centroidData)if(!(p.flags&lo||u.min.x>p.max.x||p.min.x>u.max.x||u.min.y>p.max.y||p.min.y>u.max.y))for(let g=0;g<p.footprintSegLen;g++){const _=this.footprintSegments[p.footprintSegIdx+g];if(d.length=0,OO(this.footprintVertices,_.vertexOffset,_.vertexCount,u.footprintTileId.canonical,i.canonical,d),jw(u.footprint,d,this.footprintIndices.uint16,_.indexOffset,_.indexCount,-_.vertexOffset,-m)){p.flags|=lo;break}}}for(const u of this.centroidData)this.writeCentroidToBuffer(u);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(i,s,l){let d=!1;for(let u=0;u<l.footprintSegLen;u++){const m=this.footprintSegments[l.footprintSegIdx+u];let p=0;for(const g of m.ringIndices){for(let _=p,y=g+p-1;_<g+p;y=_++){const v=this.footprintVertices.int16[2*(_+m.vertexOffset)+0],w=this.footprintVertices.int16[2*(_+m.vertexOffset)+1],C=this.footprintVertices.int16[2*(y+m.vertexOffset)+1];w>s!=C>s&&i<(this.footprintVertices.int16[2*(y+m.vertexOffset)+0]-v)*(s-w)/(C-w)+v&&(d=!d)}p=g}}return d}getHeightAtTileCoord(i,s){let l=Number.NEGATIVE_INFINITY,d=!0;const u=4*(i+pt)*pt+(s+pt);if(this.partLookup.hasOwnProperty(u)){const m=this.partLookup[u];return m?{height:m.height,hidden:!!(m.flags&lo)}:void 0}for(const m of this.centroidData)i>m.max.x||m.min.x>i||s>m.max.y||m.min.y>s||this.footprintContainsPoint(i,s,m)&&m&&m.height>l&&(l=m.height,this.partLookup[u]=m,d=!!(m.flags&lo));if(l!==Number.NEGATIVE_INFINITY)return{height:l,hidden:d};this.partLookup[u]=void 0}}function kT(o,i){const s=o.add(i)._unit();return o.x*s.x+o.y*s.y}function PO(o,i,s,l){const d=i.sub(o)._perp()._unit(),u=s.sub(i)._perp()._unit();return Hw(o,i,s,kT(d,u),l)}function Hw(o,i,s,l,d){const u=Math.sqrt(1-l*l);return Math.min(o.dist(i)/3,i.dist(s)/3,d*u/l)}function Ry(o,i,s){return o.x<s[0].x&&i.x<s[0].x||o.x>s[1].x&&i.x>s[1].x||o.y<s[0].y&&i.y<s[0].y||o.y>s[1].y&&i.y>s[1].y}function Ig(o,i){return o.x<i[0].x||o.x>i[1].x||o.y<i[0].y||o.y>i[1].y}function ST(o,i,s){if(o.x<0||o.x>=pt||i.x<0||i.x>=pt||s.x<0||s.x>=pt)return!1;const l=s.sub(i),d=l.perp(),u=o.sub(i);return(l.x*u.x+l.y*u.y)/Math.sqrt((l.x*l.x+l.y*l.y)*(u.x*u.x+u.y*u.y))>-.866&&d.x*u.x+d.y*u.y<0}function $w(o,i,s){const l=i?2|o:-3&o;return s?1|l:-2&l}function be(){const o=Math.PI/32,i=Math.tan(o),s=Qf;return s*Math.sqrt(1+2*i*i)-s}function Gw(o,i,s){const l=1<<s.z,d=Ls(s.x/l),u=Ls((s.x+1)/l),m=an(s.y/l),p=an((s.y+1)/l);return function(g,_,y,v,w=0,C){const D=[];if(!g.length||!y||!v)return D;const k=(F,B)=>{for(const j of F)D.push({polygon:j,bounds:B})},S=Math.ceil(Math.log2(y)),E=Math.ceil(Math.log2(v)),A=S-E,P=[];for(let F=0;F<Math.abs(A);F++)P.push(A>0?0:1);for(let F=0;F<Math.min(S,E);F++)P.push(0),P.push(1);let O=g;if(O=cg(O,_[0].y-w,_[1].y+w,1),O=cg(O,_[0].x-w,_[1].x+w,0),!O.length)return D;const R=[];for(P.length?R.push({polygons:O,bounds:_,depth:0}):k(O,_);R.length;){const F=R.pop(),B=F.depth,j=P[B],U=F.bounds[0],H=F.bounds[1],W=0===j?U.x:U.y,q=0===j?H.x:H.y,X=C?C(j,W,q):.5*(W+q),G=cg(F.polygons,W-w,X+w,j),Q=cg(F.polygons,X-w,q+w,j);if(G.length){const it=[U,new ot(0===j?X:H.x,1===j?X:H.y)];P.length>B+1?R.push({polygons:G,bounds:it,depth:B+1}):k(G,it)}if(Q.length){const it=[new ot(0===j?X:U.x,1===j?X:U.y),H];P.length>B+1?R.push({polygons:Q,bounds:it,depth:B+1}):k(Q,it)}}return D}(o,i,Math.ceil((u-d)/11.25),Math.ceil((m-p)/11.25),1,(g,_,y)=>{if(0===g)return.5*(_+y);{const v=an((s.y+_/pt)/l);return(Rr(.5*(an((s.y+y/pt)/l)+v))*l-s.y)*pt}})}function OO(o,i,s,l,d,u){const m=Math.pow(2,l.z-d.z);for(let p=0;p<s;p++){let g=o.int16[2*(p+i)+0],_=o.int16[2*(p+i)+1];g=(g+d.x*pt)*m-l.x*pt,_=(_+d.y*pt)*m-l.y*pt,u.push(new ot(g,_))}}de(rp,"FillExtrusionBucket",{omit:["layers","features"]}),de(wT,"PartData"),de(xT,"FootprintSegment"),de(CT,"BorderCentroidData"),de(DT,"GroundEffect");const FO=new Gn({visibility:new Ft(ct["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Ft(ct["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var _s={paint:new Gn({"fill-extrusion-opacity":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ke(ct["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ke(ct["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ke(ct["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ke(ct["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new ke(ct["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new ke(ct["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Ft(ct["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:FO};class Ln extends ot{constructor(i,s,l){super(i,s),this.z=l}}function Ju(o,i){return o.x*i.x+o.y*i.y}function Ww(o,i){if(1===o.length){let s=0;const l=i[s++];let d;for(;!d||l.equals(d);)if(d=i[s++],!d)return 1/0;for(;s<i.length;s++){const u=i[s],m=o[0],p=d.sub(l),g=u.sub(l),_=m.sub(l),y=Ju(p,p),v=Ju(p,g),w=Ju(g,g),C=Ju(_,p),D=Ju(_,g),k=y*w-v*v,S=(w*C-v*D)/k,E=(y*D-v*C)/k,A=l.z*(1-S-E)+d.z*S+u.z*E;if(isFinite(A))return A}return 1/0}{let s=1/0;for(const l of i)s=Math.min(s,l.z);return s}}function qw(o,i,s,l,d,u,m,p){const g=m*d.getElevationAt(o,i,!0,!0),_=0!==u[0],y=_?0===u[1]?m*(u[0]/7-450):m*function(v,w,C){const D=Math.floor(w[0]/8),k=Math.floor(w[1]/8),S=10*(w[0]-8*D),E=10*(w[1]-8*k),A=v.getElevationAt(D,k,!0,!0),P=v.getMeterToDEM(C),O=Math.floor(.5*(S*P-1)),R=Math.floor(.5*(E*P-1)),F=v.tileCoordToPixel(D,k),B=2*O+1,j=2*R+1,U=(J=B,et=j,[(Q=v).getElevationAtPixel(it=F.x-O,st=F.y-R,!0),Q.getElevationAtPixel(it+et,st,!0),Q.getElevationAtPixel(it,st+et,!0),Q.getElevationAtPixel(it+J,st+et,!0)]),H=Math.abs(U[0]-U[1]),W=Math.abs(U[2]-U[3]),q=Math.abs(U[0]-U[2])+Math.abs(U[1]-U[3]),X=Math.min(.25,.5*P*(H+W)/B),G=Math.min(.25,.5*P*q/j);var Q,it,st,J,et;return A+Math.max(X*S,G*E)}(d,u,p):g;return{base:g+(0===s)?-1:s,top:_?Math.max(y+l,g+s+2):g+l}}const TT=new Gn({"line-cap":new ke(ct.layout_line["line-cap"]),"line-join":new ke(ct.layout_line["line-join"]),"line-miter-limit":new Ft(ct.layout_line["line-miter-limit"]),"line-round-limit":new Ft(ct.layout_line["line-round-limit"]),"line-sort-key":new ke(ct.layout_line["line-sort-key"]),visibility:new Ft(ct.layout_line.visibility)});var Yw={paint:new Gn({"line-opacity":new ke(ct.paint_line["line-opacity"]),"line-color":new ke(ct.paint_line["line-color"]),"line-translate":new Ft(ct.paint_line["line-translate"]),"line-translate-anchor":new Ft(ct.paint_line["line-translate-anchor"]),"line-width":new ke(ct.paint_line["line-width"]),"line-gap-width":new ke(ct.paint_line["line-gap-width"]),"line-offset":new ke(ct.paint_line["line-offset"]),"line-blur":new ke(ct.paint_line["line-blur"]),"line-dasharray":new ke(ct.paint_line["line-dasharray"]),"line-pattern":new ke(ct.paint_line["line-pattern"]),"line-gradient":new Mf(ct.paint_line["line-gradient"]),"line-trim-offset":new Ft(ct.paint_line["line-trim-offset"]),"line-emissive-strength":new Ft(ct.paint_line["line-emissive-strength"]),"line-border-width":new ke(ct.paint_line["line-border-width"]),"line-border-color":new ke(ct.paint_line["line-border-color"])}),layout:TT};const ET=(o,i,s,l,d,u,m)=>{const p=o.transform,g=p.calculatePixelsToTileUnitsMatrix(i);return{u_matrix:Xw(o,i,s,l),u_pixels_to_tile_units:g,u_device_pixel_ratio:u,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:d,u_texsize:RT(s)&&i.lineAtlasTexture?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Zw(i,o.transform),u_alpha_discard_threshold:0,u_trim_offset:m,u_emissive_strength:s.paint.get("line-emissive-strength")}},AT=(o,i,s,l,d)=>{const u=o.transform;return{u_matrix:Xw(o,i,s,l),u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:u.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:d,u_image:0,u_tile_units_to_pixels:Zw(i,u),u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Zw(o,i){return 1/Xu(o,1,i.tileZoom)}function Xw(o,i,s,l){return o.translatePosMatrix(l||i.tileID.projMatrix,i,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const IT=o=>{const i=[];RT(o)&&i.push("RENDER_LINE_DASH"),o.paint.get("line-gradient")&&i.push("RENDER_LINE_GRADIENT");const s=o.paint.get("line-trim-offset");return 0===s[0]&&0===s[1]||i.push("RENDER_LINE_TRIM_OFFSET"),0!==o.paint.get("line-border-width").constantOr(1)&&i.push("RENDER_LINE_BORDER"),i};function RT(o){const i=o.paint.get("line-dasharray").value;return i.value||"constant"!==i.kind}const PT=new class extends ke{possiblyEvaluate(o,i){return i=new zn(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,transition:i.transition}),super.possiblyEvaluate(o,i)}evaluate(o,i,s,l){return i=se({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(o,i,s,l)}}(Yw.paint.properties["line-width"].specification);function OT(o,i){return i>0?i+2*o:o}PT.useIntegerZoom=!0;const LO=new Gn({visibility:new Ft(ct.layout_background.visibility)});var BO={paint:new Gn({"background-color":new Ft(ct.paint_background["background-color"]),"background-pattern":new Ft(ct.paint_background["background-pattern"]),"background-opacity":new Ft(ct.paint_background["background-opacity"]),"background-emissive-strength":new Ft(ct.paint_background["background-emissive-strength"])}),layout:LO};const NO=new Gn({visibility:new Ft(ct.layout_raster.visibility)});var zO={paint:new Gn({"raster-opacity":new Ft(ct.paint_raster["raster-opacity"]),"raster-color":new Mf(ct.paint_raster["raster-color"]),"raster-color-mix":new Ft(ct.paint_raster["raster-color-mix"]),"raster-color-range":new Ft(ct.paint_raster["raster-color-range"]),"raster-hue-rotate":new Ft(ct.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ft(ct.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ft(ct.paint_raster["raster-brightness-max"]),"raster-saturation":new Ft(ct.paint_raster["raster-saturation"]),"raster-contrast":new Ft(ct.paint_raster["raster-contrast"]),"raster-resampling":new Ft(ct.paint_raster["raster-resampling"]),"raster-fade-duration":new Ft(ct.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Ft(ct.paint_raster["raster-emissive-strength"]),"raster-array-band":new Ft(ct.paint_raster["raster-array-band"]),"raster-elevation":new Ft(ct.paint_raster["raster-elevation"])}),layout:NO};function FT(o,i,s,l,d,u,m,p){const g=[o,s,d,i,l,u,1,1,1],_=[m,p,1],y=Zo.adjoint([],g),[v,w,C]=Z.transformMat3(_,_,Zo.transpose(y,y));return Zo.multiply(g,[v,0,0,0,w,0,0,0,C],g)}class Fa extends gi{constructor(i,s,l,d){super(),this.id=i,this.dispatcher=l,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(d),this.options=s,this._dirty=!1}load(i,s){if(this._loaded=s||!1,this.fire(new Bt("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return i&&(this.coordinates=i),this._loaded=!0,void this._finishLoading();this._imageRequest=ai(this.map._requestManager.transformRequest(this.url,xt.Image),(l,d)=>{if(this._imageRequest=null,this._loaded=!0,l)this.fire(new Yt(l));else if(d){const{HTMLImageElement:u}=lt;this.image=d instanceof u?Ze.getImageData(d):d,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading()}})}loaded(){return this._loaded}updateImage(i){return i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}setTexture(i){if(!(i.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Wm(this.map.painter.context,i.handle),this.width=i.dimensions[0],this.height=i.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Bt("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Wm||this.texture.destroy()}setCoordinates(i){if(this.coordinates=i,this._boundsArray=void 0,!i.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=i[0][1],l=i[0][1];for(const u of i)u[1]>l&&(l=u[1]),u[1]<s&&(s=u[1]);const d=(l+s)/2;if(d>or?this.onNorthPole=!0:d<-or&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const u=i.map(Ei.fromLngLat);this.tileID=function(m){let p=1/0,g=1/0,_=-1/0,y=-1/0;for(const D of m)p=Math.min(p,D.x),g=Math.min(g,D.y),_=Math.max(_,D.x),y=Math.max(y,D.y);const v=Math.max(_-p,y-g),w=Math.max(0,Math.floor(-Math.log(v)/Math.LN2)),C=Math.pow(2,w);return new ca(w,Math.floor((p+_)/2*C),Math.floor((g+y)/2*C))}(u),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Bt("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(i){for(const g in this.tiles){const _=this.tiles[g];"loaded"!==_.state&&(_.state="loaded",_.texture=this.texture)}if(this._boundsArray)return;const s=Hu(this.tileID,this.map.transform.projection),[l,d,u,m]=this.coordinates.map(g=>{const _=s.projection.project(g[0],g[1]);return Vm(s,_)._round()});this.perspectiveTransform=function(g,_,y,v,w,C,D,k,S,E){const A=FT(0,0,g,0,0,_,g,_),P=FT(y,v,w,C,D,k,S,E);return Zo.multiply(P,Zo.adjoint(A,A),P),[P[6]/P[8]*g/pt,P[7]/P[8]*_/pt]}(this.width,this.height,l.x,l.y,d.x,d.y,m.x,m.y,u.x,u.y);const p=this._boundsArray=new bu;p.emplaceBack(l.x,l.y,0,0),p.emplaceBack(d.x,d.y,pt,0),p.emplaceBack(m.x,m.y,0,pt),p.emplaceBack(u.x,u.y,pt,pt),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=i.createVertexBuffer(p,Ve.members),this.boundsSegments=on.simpleSegment(0,0,4,2)}prepare(){const i=0!==Object.keys(this.tiles).length;if(this.tileID&&!i)return;const s=this.map.painter.context,l=s.gl;!this._dirty||this.texture instanceof Wm||(this.texture?this.texture.update(this.image):(this.texture=new Un(s,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this._dirty=!1),i&&this._prepareData(s)}loadTile(i,s){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},s(null)):(i.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class VO extends cs{constructor(i){super(i,{}),this.implementation=i,i.slot&&(this.slot=i.slot)}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(i){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}const jO=new Gn({visibility:new Ft(ct.layout_sky.visibility)});var UO={paint:new Gn({"sky-type":new Ft(ct.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ft(ct.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ft(ct.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ft(ct.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ft(ct.paint_sky["sky-gradient-radius"]),"sky-gradient":new Mf(ct.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ft(ct.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ft(ct.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ft(ct.paint_sky["sky-opacity"])}),layout:jO};function Kw(o,i,s){const l=[0,0,1],d=_o.identity([]);return _o.rotateY(d,d,s?-ni(o)+Math.PI:ni(o)),_o.rotateX(d,d,-ni(i)),Z.transformQuat(l,l,d),Z.normalize(l,l)}var HO={paint:new Gn({})};const $O={circle:class extends cs{constructor(o,i){super(o,xP,i)}createBucket(o){return new Hb(o)}queryRadius(o){const i=o;return Oc("circle-radius",this,i)+Oc("circle-stroke-width",this,i)+Ko(this.paint.get("circle-translate"))}queryIntersectsFeature(o,i,s,l,d,u,m,p){const g=Yb(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),u.angle,o.pixelToTileUnitsFactor),_=this.paint.get("circle-radius").evaluate(i,s)+this.paint.get("circle-stroke-width").evaluate(i,s);return eS(o,l,u,m,p,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),g,_)}getProgramIds(){return["circle"]}getDefaultProgramParams(o,i){const s=tS(this);return{config:new Mu(this,i),defines:s,overrideFog:!1}}},heatmap:class extends cs{createBucket(o){return new Gx(o)}constructor(o,i){super(o,Xb,i),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"heatmap-color"===o&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Kb({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(o){return Oc("heatmap-radius",this,o)}queryIntersectsFeature(o,i,s,l,d,u,m,p){const g=this.paint.get("heatmap-radius").evaluate(i,s);return eS(o,l,u,m,p,!0,!0,new ot(0,0),g)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(o,i){return"heatmap"===o?{config:new Mu(this,i),overrideFog:!1}:{}}},hillshade:class extends cs{constructor(o,i){super(o,qx,i)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(o,i){return{overrideFog:!1}}},fill:class extends cs{constructor(o,i){super(o,Tm,i)}getProgramIds(){const o=this.paint.get("fill-pattern"),i=o&&o.constantOr(1),s=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(o,i){return{config:new Mu(this,i),overrideFog:!1}}recalculate(o,i){super.recalculate(o,i);const s=this.paint._values["fill-outline-color"];"constant"===s.value.kind&&void 0===s.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(o){return new Lc(o)}queryRadius(){return Ko(this.paint.get("fill-translate"))}queryIntersectsFeature(o,i,s,l,d,u){return!o.queryGeometry.isAboveHorizon&&yP(Iu(o.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),u.angle,o.pixelToTileUnitsFactor),l)}isTileClipped(){return!0}},"fill-extrusion":class extends cs{constructor(o,i){super(o,_s,i),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(o){return new rp(o)}queryRadius(){return Ko(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(o,i,s,l,d,u,m,p,g){const _=Yb(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),u.angle,o.pixelToTileUnitsFactor),y=this.paint.get("fill-extrusion-height").evaluate(i,s),v=this.paint.get("fill-extrusion-base").evaluate(i,s),w=[0,0],C=p&&u.elevation,D=u.elevation?u.elevation.exaggeration():1,k=o.tile.getBucket(this);if(C&&k instanceof rp){const O=k.centroidVertexArray,R=g+1;R<O.length&&(w[0]=O.geta_centroid_pos0(R),w[1]=O.geta_centroid_pos1(R))}if(0===w[0]&&1===w[1])return!1;"globe"===u.projection.name&&(l=Gw([l],[new ot(0,0),new ot(pt,pt)],o.tileID.canonical).map(O=>O.polygon).flat());const S=C?p:null,[E,A]=(R=l,F=v,B=y,j=_,U=m,H=S,W=w,q=D,X=u.center.lat,"globe"===(O=u).projection.name?function(Q,it,st,J,et,dt,mt,ut,bt,yt,Ct){const gt=[],At=[],Gt=Q.projection.upVectorScale(Ct,Q.center.lat,Q.worldSize).metersToTile,Et=[0,0,0,1],te=[0,0,0,1],ie=(ve,Ui,xi,$e)=>{ve[0]=Ui,ve[1]=xi,ve[2]=$e,ve[3]=1},He=be();st>0&&(st+=He),J+=He;for(const ve of it){const Ui=[],xi=[];for(const $e of ve){const ze=$e.x+et.x,Ce=$e.y+et.y,wi=Q.projection.projectTilePoint(ze,Ce,Ct),Pi=Q.projection.upVector(Ct,$e.x,$e.y);let ci=st,Gi=J;if(mt){const ir=qw(ze,Ce,st,J,mt,ut,bt,yt);ci+=ir.base,Gi+=ir.top}0!==st?ie(Et,wi.x+Pi[0]*Gt*ci,wi.y+Pi[1]*Gt*ci,wi.z+Pi[2]*Gt*ci):ie(Et,wi.x,wi.y,wi.z),ie(te,wi.x+Pi[0]*Gt*Gi,wi.y+Pi[1]*Gt*Gi,wi.z+Pi[2]*Gt*Gi),Z.transformMat4(Et,Et,dt),Z.transformMat4(te,te,dt),Ui.push(new Ln(Et[0],Et[1],Et[2])),xi.push(new Ln(te[0],te[1],te[2]))}gt.push(Ui),At.push(xi)}return[gt,At]}(O,R,F,B,j,U,H,W,q,X,o.tileID.canonical):H?function(Q,it,st,J,et,dt,mt,ut,bt){const yt=[],Ct=[],gt=[0,0,0,1];for(const At of Q){const Gt=[],Et=[];for(const te of At){const ie=te.x+J.x,He=te.y+J.y,ve=qw(ie,He,it,st,dt,mt,ut,bt);gt[0]=ie,gt[1]=He,gt[2]=ve.base,gt[3]=1,Qi.transformMat4(gt,gt,et),gt[3]=Math.max(gt[3],1e-5);const Ui=new Ln(gt[0]/gt[3],gt[1]/gt[3],gt[2]/gt[3]);gt[0]=ie,gt[1]=He,gt[2]=ve.top,gt[3]=1,Qi.transformMat4(gt,gt,et),gt[3]=Math.max(gt[3],1e-5);const xi=new Ln(gt[0]/gt[3],gt[1]/gt[3],gt[2]/gt[3]);Gt.push(Ui),Et.push(xi)}yt.push(Gt),Ct.push(Et)}return[yt,Ct]}(R,F,B,j,U,H,W,q,X):function(Q,it,st,J,et){const dt=[],mt=[],ut=et[8]*it,bt=et[9]*it,yt=et[10]*it,Ct=et[11]*it,gt=et[8]*st,At=et[9]*st,Gt=et[10]*st,Et=et[11]*st;for(const te of Q){const ie=[],He=[];for(const ve of te){const Ui=ve.x+J.x,xi=ve.y+J.y,$e=et[0]*Ui+et[4]*xi+et[12],ze=et[1]*Ui+et[5]*xi+et[13],Ce=et[2]*Ui+et[6]*xi+et[14],wi=et[3]*Ui+et[7]*xi+et[15],Pi=$e+ut,ci=ze+bt,Gi=Ce+yt,ir=Math.max(wi+Ct,1e-5),tn=$e+gt,Mn=ze+At,mr=Ce+Gt,Zn=Math.max(wi+Et,1e-5);ie.push(new Ln(Pi/ir,ci/ir,Gi/ir)),He.push(new Ln(tn/Zn,Mn/Zn,mr/Zn))}dt.push(ie),mt.push(He)}return[dt,mt]}(R,F,B,j,U)),P=o.queryGeometry;var O,R,F,B,j,U,H,W,q,X;return function(O,R,F){let B=1/0;yP(F,R)&&(B=Ww(F,R[0]));for(let j=0;j<R.length;j++){const U=R[j],H=O[j];for(let W=0;W<U.length-1;W++){const q=U[W],X=[q,U[W+1],H[W+1],H[W],q];Vx(F,X)&&(B=Math.min(B,Ww(F,X)))}}return B!==1/0&&B}(E,A,P.isPointQuery()?P.screenBounds:P.screenGeometry)}},line:class extends cs{constructor(o,i){super(o,Yw,i),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(o){if("line-gradient"===o){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof I0,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(o,i){super.recalculate(o,i),this.paint._values["line-floorwidth"]=PT.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,o)}createBucket(o){return new wy(o)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(o,i){const s=IT(this);return{config:new Mu(this,i),defines:s,overrideFog:!1}}queryRadius(o){const i=o,s=OT(Oc("line-width",this,i),Oc("line-gap-width",this,i)),l=Oc("line-offset",this,i);return s/2+Math.abs(l)+Ko(this.paint.get("line-translate"))}queryIntersectsFeature(o,i,s,l,d,u){if(o.queryGeometry.isAboveHorizon)return!1;const m=Iu(o.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),u.angle,o.pixelToTileUnitsFactor),p=o.pixelToTileUnitsFactor/2*OT(this.paint.get("line-width").evaluate(i,s),this.paint.get("line-gap-width").evaluate(i,s)),g=this.paint.get("line-offset").evaluate(i,s);return g&&(l=function(_,y){const v=[],w=new ot(0,0);for(let C=0;C<_.length;C++){const D=_[C],k=[];for(let S=0;S<D.length;S++){const E=D[S],A=D[S+1],P=0===S?w:E.sub(D[S-1])._unit()._perp(),O=S===D.length-1?w:A.sub(E)._unit()._perp(),R=P._add(O)._unit();R._mult(1/(R.x*O.x+R.y*O.y)),k.push(R._mult(y)._add(E))}v.push(k)}return v}(l,g*o.pixelToTileUnitsFactor)),function(_,y,v){for(let w=0;w<y.length;w++){const C=y[w];if(_.length>=3)for(let D=0;D<C.length;D++)if(Ed(_,C[D]))return!0;if(jx(_,C,v))return!0}return!1}(m,l,p)}isTileClipped(){return!0}},symbol:yg,background:class extends cs{constructor(o,i){super(o,BO,i)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(o,i){return{overrideFog:!1}}},raster:class extends cs{constructor(o,i){super(o,zO,i),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}isLayerDraped(o){return!(o&&o._source instanceof Fa)||!o._source.onNorthPole&&!o._source.onSouthPole&&0===this.paint.get("raster-elevation")}_handleSpecialPaintPropertyUpdate(o){"raster-color"!==o&&"raster-color-range"!==o||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const o=this._transitionablePaint._values["raster-color"].value.expression,[i,s]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=Kb({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:i,end:s}],resolution:256}),this.colorRampTexture=null}},sky:class extends cs{constructor(o,i){super(o,UO,i),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"sky-gradient"===o?this._updateColorRamp():"sky-atmosphere-sun"!==o&&"sky-atmosphere-halo-color"!==o&&"sky-atmosphere-color"!==o&&"sky-atmosphere-sun-intensity"!==o||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Kb({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(o){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=o.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(o,i){if("atmosphere"===this.paint.get("sky-type")){const l=this.paint.get("sky-atmosphere-sun"),d=!l,u=o.style.light,m=u.properties.get("position");return d&&"viewport"===u.properties.get("anchor")&&rt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),d?Kw(m.azimuthal,90-m.polar,i):Kw(l[0],90-l[1],i)}const s=this.paint.get("sky-gradient-center");return Kw(s[0],90-s[1],i)}isSky(){return!0}markSkyboxValid(o){this._skyboxInvalidated=!1,this._lightPosition=o.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const o=this.paint.get("sky-type");return"atmosphere"===o?["skyboxCapture","skybox"]:"gradient"===o?["skyboxGradient"]:null}},slot:class extends cs{constructor(o,i){super(o,HO)}},model:class extends cs{constructor(o,i){super(o,SO,i)}createBucket(o){return new DO(o)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(){return 0}queryIntersectsFeature(){return!1}_handleOverridablePaintPropertyUpdate(o,i,s){return!(!this.layout||i.isDataDriven()||s.isDataDriven()||"model-color"!==o&&"model-color-mix-intensity"!==o&&"model-rotation"!==o&&"model-scale"!==o&&"model-translation"!==o&&"model-emissive-strength"!==o)}_isPropertyZoomDependent(o){const i=this._transitionablePaint._values[o];return null!=i&&null!=i.value&&null!=i.value.expression&&i.value.expression instanceof vc}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}}};function Py(o,i){return"custom"===o.type?new VO(o):new $O[o.type](o,i)}function LT(o){const{userImage:i}=o;return!!(i&&i.render&&i.render())&&(o.data.replace(new Uint8Array(i.data.buffer)),!0)}class BT extends gi{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(i){this.images[i]={},this.loaded[i]=!1,this.updatedImages[i]={},this.patterns[i]={},this.callbackDispatchedThisFrame[i]={},this.atlasImage[i]=new _r({width:1,height:1})}isLoaded(){for(const i in this.loaded)if(!this.loaded[i])return!1;return!0}setLoaded(i,s){if(this.loaded[s]!==i&&(this.loaded[s]=i,i)){for(const{ids:l,callback:d}of this.requestors)this._notify(l,s,d);this.requestors=[]}}hasImage(i,s){return!!this.getImage(i,s)}getImage(i,s){return this.images[s][i]}addImage(i,s,l){this._validate(i,l)&&(this.images[s][i]=l)}_validate(i,s){let l=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new Yt(new Error(`Image "${i}" has invalid "stretchX" value`))),l=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new Yt(new Error(`Image "${i}" has invalid "stretchY" value`))),l=!1),this._validateContent(s.content,s)||(this.fire(new Yt(new Error(`Image "${i}" has invalid "content" value`))),l=!1),l}_validateStretch(i,s){if(!i)return!0;let l=0;for(const d of i){if(d[0]<l||d[1]<d[0]||s<d[1])return!1;l=d[1]}return!0}_validateContent(i,s){return!(i&&(4!==i.length||i[0]<0||s.data.width<i[0]||i[1]<0||s.data.height<i[1]||i[2]<0||s.data.width<i[2]||i[3]<0||s.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,s,l){l.version=this.images[s][i].version+1,this.images[s][i]=l,this.updatedImages[s][i]=!0}removeImage(i,s){const l=this.images[s][i];delete this.images[s][i],delete this.patterns[s][i],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(i){return Object.keys(this.images[i])}getImages(i,s,l){let d=!0;const u=!!this.loaded[s];if(!u)for(const m of i)this.images[s][m]||(d=!1);u||d?this._notify(i,s,l):this.requestors.push({ids:i,scope:s,callback:l})}getUpdatedImages(i){return this.updatedImages[i]}_notify(i,s,l){const d={};for(const u of i){this.images[s][u]||this.fire(new Bt("styleimagemissing",{id:u}));const m=this.images[s][u];m?d[u]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,hasRenderCallback:!(!m.userImage||!m.userImage.render)}:rt(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}l(null,d)}getPixelSize(i){const{width:s,height:l}=this.atlasImage[i];return{width:s,height:l}}getPattern(i,s){const l=this.patterns[s][i],d=this.getImage(i,s);if(!d)return null;if(l&&l.position.version===d.version)return l.position;if(l)l.position.version=d.version;else{const u={w:d.data.width+2,h:d.data.height+2,x:0,y:0},m=new _w(u,d);this.patterns[s][i]={bin:u,position:m}}return this._updatePatternAtlas(s),this.patterns[s][i].position}bind(i,s){const l=i.gl;let d=this.atlasTexture[s];d?this.dirty&&(d.update(this.atlasImage[s]),this.dirty=!1):(d=new Un(i,this.atlasImage[s],l.RGBA),this.atlasTexture[s]=d),d.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(i){const s=[];for(const m in this.patterns[i])s.push(this.patterns[i][m].bin);const{w:l,h:d}=hy(s),u=this.atlasImage[i];u.resize({width:l||1,height:d||1});for(const m in this.patterns[i]){const{bin:p}=this.patterns[i][m],g=p.x+1,_=p.y+1,y=this.images[i][m].data,v=y.width,w=y.height;_r.copy(y,u,{x:0,y:0},{x:g,y:_},{width:v,height:w}),_r.copy(y,u,{x:0,y:w-1},{x:g,y:_-1},{width:v,height:1}),_r.copy(y,u,{x:0,y:0},{x:g,y:_+w},{width:v,height:1}),_r.copy(y,u,{x:v-1,y:0},{x:g-1,y:_},{width:1,height:w}),_r.copy(y,u,{x:0,y:0},{x:g+v,y:_},{width:1,height:w})}this.dirty=!0}beginFrame(){for(const i in this.images)this.callbackDispatchedThisFrame[i]={}}dispatchRenderCallbacks(i,s){for(const l of i){if(this.callbackDispatchedThisFrame[s][l])continue;this.callbackDispatchedThisFrame[s][l]=!0;const d=this.images[s][l];LT(d)&&this.updateImage(l,s,d)}}}const NT=new Gn({anchor:new Ft(ct.light.anchor),position:new class{constructor(o){this.specification=o}possiblyEvaluate(o,i){return ne(o.expression.evaluate(i))}interpolate(o,i,s){return{x:_e(o.x,i.x,s),y:_e(o.y,i.y,s),z:_e(o.z,i.z,s),azimuthal:_e(o.azimuthal,i.azimuthal,s),polar:_e(o.polar,i.polar,s)}}}(ct.light.position),color:new Ft(ct.light.color),intensity:new Ft(ct.light.intensity)});class Qw extends gi{constructor(i,s="flat"){super(),this._transitionable=new Cf(NT),this.setLight(i,s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,s,l={}){this._validate(HR,i,l)||(this._transitionable.setTransitionOrValue(i),this.id=s)}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,s,l){return(!l||!1!==l.validate)&&xf(this,i.call(wc,se({value:s,style:{glyphs:!0,sprite:!0},styleSpec:ct})))}}const zT=new Gn({source:new Ft(ct.terrain.source),exaggeration:new Ft(ct.terrain.exaggeration)});let VT=class extends gi{constructor(o,i,s,l){super(),this.scope=s,this._transitionable=new Cf(zT,l),this._transitionable.setTransitionOrValue(o,l),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=i}get(){return this._transitionable.serialize()}set(o,i){this._transitionable.setTransitionOrValue(o,i)}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}getExaggeration(o){return this._transitioning.possiblyEvaluate(new zn(o)).get("exaggeration")}isZoomDependent(){const o=this._transitionable._values.exaggeration;return null!=o&&null!=o.value&&null!=o.value.expression&&o.value.expression instanceof vc}};const Jw=45,t1=65,Nd=.05;function Ao(o,i,s,l){const d=Il(Jw,t1,s),[u,m]=Rg(o,l);let p=1-Math.min(1,Math.exp((i-u)/(m-u)*-6));return p*=p*p,p=Math.min(1,1.00747*p),p*d*o.alpha}function Rg(o,i){const s=.5/Math.tan(.5*i);return[o.range[0]+s,o.range[1]+s]}function zd(o,i,s,l,d){const u=Z.transformMat4([],[i,s,l],d.mercatorFogMatrix);return Ao(o,Z.length(u),d.pitch,d._fov)}function jT(o,i,s,l,d,u,m){const p=[[s,l,0],[d,l,0],[d,u,0],[s,u,0]];let g=Number.MAX_VALUE,_=-Number.MAX_VALUE;for(const y of p){const v=Z.transformMat4([],y,i),w=Z.length(v);g=Math.min(g,w),_=Math.max(_,w)}return[Ao(o,g,m.pitch,m._fov),Ao(o,_,m.pitch,m._fov)]}const GO=new Gn({range:new Ft(ct.fog.range),color:new Ft(ct.fog.color),"high-color":new Ft(ct.fog["high-color"]),"space-color":new Ft(ct.fog["space-color"]),"horizon-blend":new Ft(ct.fog["horizon-blend"]),"star-intensity":new Ft(ct.fog["star-intensity"]),"vertical-range":new Ft(ct.fog["vertical-range"])});class op extends gi{constructor(i,s){super(),this._transitionable=new Cf(GO),this.set(i),this._transitioning=this._transitionable.untransitioned(),this._transform=s}get state(){const i=this._transform,s="globe"===i.projection.name,l=Dr(i.zoom),d=this.properties.get("range"),u=[.5,3];return{range:s?[_e(u[0],d[0],l),_e(u[1],d[1],l)]:d,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(i,s={}){if(this._validate(na,i,s))return;const l=se({},i);for(const d of Object.keys(ct.fog))void 0===l[d]&&(l[d]=ct.fog[d].default);this._transitionable.setTransitionOrValue(l)}getOpacity(i){if(!this._transform.projection.supportsFog)return 0;const s=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:Il(Jw,t1,i))*s.a}getOpacityAtLatLng(i,s){return this._transform.projection.supportsFog?function(l,d,u){const m=Ei.fromLngLat(d),p=u.elevation?u.elevation.getAtPointOrZero(m):0;return zd(l,m.x,m.y,p,u)}(this.state,i,s):0}getOpacityForTile(i){if(!this._transform.projection.supportsFog)return[1,1];const s=this._transform.calculateFogTileMatrix(i.toUnwrapped());return jT(this.state,s,0,0,pt,pt,this._transform)}getOpacityForBounds(i,s,l,d,u){return this._transform.projection.supportsFog?jT(this.state,i,s,l,d,u,this._transform):[1,1]}getFovAdjustedRange(i){return this._transform.projection.supportsFog?Rg(this.state,i):[0,1]}isVisibleOnFrustum(i){if(!this._transform.projection.supportsFog)return!1;const s=[4,5,6,7];for(const l of s){const d=i.points[l];let u;if(d[2]>=0)u=d;else{const m=i.points[l-4];u=Ie(m,d,m[2]/(m[2]-d[2]))}if(zd(this.state,u[0],u[1],0,this._transform)>=Nd)return!0}return!1}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,s,l){return(!l||!1!==l.validate)&&xf(this,i.call(wc,se({value:s,style:{glyphs:!0,sprite:!0},styleSpec:ct})))}}class nV{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class bs{constructor(){this.tasks={},this.taskQueue=[],qr(["process"],this),this.invoker=new nV(this.process),this.nextId=0}add(i,s){const l=this.nextId++,d=function({type:u,isSymbolTile:m,zoom:p}){return p=p||0,"message"===u?0:"maybePrepare"!==u||m?"parseTile"!==u||m?"parseTile"===u&&m?300-p:"maybePrepare"===u&&m?400-p:500:200-p:100-p}(s);if(0===d){Lt();try{i()}finally{}return{cancel:()=>{}}}return this.tasks[l]={fn:i,metadata:s,priority:d,id:l},this.taskQueue.push(l),this.invoker.trigger(),{cancel:()=>{delete this.tasks[l]}}}process(){Lt();try{if(this.taskQueue=this.taskQueue.filter(l=>!!this.tasks[l]),!this.taskQueue.length)return;const i=this.pick();if(null===i)return;const s=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let i=null,s=1/0;for(let d=0;d<this.taskQueue.length;d++){const u=this.tasks[this.taskQueue[d]];u.priority<s&&(s=u.priority,i=d)}if(null===i)return null;const l=this.taskQueue[i];return this.taskQueue.splice(i,1),l}remove(){this.invoker.remove()}}class WO{constructor(i,s,l){this.target=i,this.parent=s,this.mapId=l,this.callbacks={},this.cancelCallbacks={},qr(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new bs}send(i,s,l,d,u=!1,m){const p=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=m,this.callbacks[p]=l);const g=new Set;return this.target.postMessage({id:p,type:i,hasCallback:!!l,targetMapId:d,mustQueue:u,sourceMapId:this.mapId,data:cm(s,g)},g),{cancel:()=>{l&&delete this.callbacks[p],this.target.postMessage({id:p,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(i){const s=i.data,l=s.id;if(l&&(!s.targetMapId||this.mapId===s.targetMapId))if("<cancel>"===s.type){const d=this.cancelCallbacks[l];delete this.cancelCallbacks[l],d&&d.cancel()}else if(s.mustQueue||Lt()){const d=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,s),d&&d.metadata||{type:"message"})}else this.processTask(l,s)}processTask(i,s){if("<response>"===s.type){const l=this.callbacks[i];delete this.callbacks[i],l&&(s.error?l(fu(s.error)):l(null,fu(s.data)))}else{const l=new Set,d=s.hasCallback?(m,p)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:m?cm(m):null,data:cm(p,l)},l)}:m=>{},u=fu(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,u,d);else if(this.parent.getWorkerSource){const m=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,m[0],u.source,u.scope)[m[1]](u,d)}else d(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}let Pg=(()=>{class o{constructor(s,l){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=jn();const d=this.workerPool.acquire(this.id);for(let u=0;u<d.length;u++){const m=new o.Actor(d[u],l,this.id);m.name=`Worker ${u}`,this.actors.push(m)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(s,l,d){tu(this.actors,(u,m)=>{u.send(s,l,m)},d=d||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(s=>{s.remove()}),this.actors=[],this.workerPool.release(this.id)}}return o.Actor=WO,o})();class e1 extends gi{constructor(i,s,l,d){super(),this.scope=l,this._options=i,this.properties=new _u(s),this._transitionable=new Cf(s,new Map(d)),this._transitionable.setTransitionOrValue(i.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(i){this._transitionable.setTransitionOrValue(this._options.properties,new Map(i))}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(i,s){this._options=i,this._transitionable.setTransitionOrValue(i.properties,s)}shadowsEnabled(){return!!this.properties&&!0===this.properties.get("cast-shadows")}}const rV=new Gn({color:new Ft(ct.properties_light_ambient.color),intensity:new Ft(ct.properties_light_ambient.intensity)}),ur=new Gn({direction:new class{constructor(o){this.specification=o}possiblyEvaluate(o,i){return function([s,l]){const d=ne([1,s,l]);return{x:d.x,y:d.y,z:d.z}}(o.expression.evaluate(i))}interpolate(o,i,s){return{x:_e(o.x,i.x,s),y:_e(o.y,i.y,s),z:_e(o.z,i.z,s)}}}(ct.properties_light_directional.direction),color:new Ft(ct.properties_light_directional.color),intensity:new Ft(ct.properties_light_directional.intensity),"cast-shadows":new Ft(ct.properties_light_directional["cast-shadows"]),"shadow-intensity":new Ft(ct.properties_light_directional["shadow-intensity"])});class n1{constructor(i,s,l,d){this.screenBounds=i,this.cameraPoint=s,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=l,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,d)}static createFromScreenPoints(i,s){let l,d;if(i instanceof ot||"number"==typeof i[0]){const u=ot.convert(i);l=[u],d=s.isPointAboveHorizon(u)}else{const u=ot.convert(i[0]),m=ot.convert(i[1]);l=[u,m],d=Jd(u,m).every(p=>s.isPointAboveHorizon(p))}return new n1(l,s.getCameraPoint(),d,s)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(i){return Jd(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],i)}bufferedCameraGeometry(i){const s=this.screenBounds[0],l=1===this.screenBounds.length?this.screenBounds[0].add(new ot(1,1)):this.screenBounds[1],d=Jd(s,l,0,!1);return this.cameraPoint.y>l.y&&(this.cameraPoint.x>s.x&&this.cameraPoint.x<l.x?d.splice(3,0,this.cameraPoint):this.cameraPoint.x>=l.x?d[2]=this.cameraPoint:this.cameraPoint.x<=s.x&&(d[3]=this.cameraPoint)),function(u,m){const p=[];for(let g=0;g<u.length;g++){const _=Rl(g-1,-1,u.length-1),y=Rl(g+1,-1,u.length-1),v=u[g],w=u[y],C=u[_].sub(v).unit(),D=w.sub(v).unit(),k=D.angleWithSep(C.x,C.y),S=C.add(D).unit().mult(-1*m/Math.sin(k/2));p.push(v.add(S))}return p}(d,i)}bufferedCameraGeometryGlobe(i){const s=this.screenBounds[0],l=1===this.screenBounds.length?this.screenBounds[0].add(new ot(1,1)):this.screenBounds[1],d=Jd(s,l,i),u=this.cameraPoint.clone();switch(3*((u.y>s.y)+(u.y>l.y))+((u.x>s.x)+(u.x>l.x))){case 0:d[0]=u,d[4]=u.clone();break;case 1:d.splice(1,0,u);break;case 2:d[1]=u;break;case 3:d.splice(4,0,u);break;case 5:d.splice(2,0,u);break;case 6:d[3]=u;break;case 7:d.splice(3,0,u);break;case 8:d[2]=u}return d}containsTile(i,s,l,d=0){const u=i.queryPadding/s._pixelsPerMercatorPixel+1,m=l?this._bufferedCameraMercator(u,s):this._bufferedScreenMercator(u,s);let p=i.tileID.wrap+(m.unwrapped?d:0);const g=m.polygon.map(S=>Vm(i.tileTransform,S,p));if(!Wb(g,0,0,pt,pt))return;p=i.tileID.wrap+(this.screenGeometryMercator.unwrapped?d:0);const _=this.screenGeometryMercator.polygon.map(S=>vw(i.tileTransform,S,p)),y=_.map(S=>new ot(S[0],S[1])),v=s.getFreeCameraOptions().position||new Ei(0,0,0),w=vw(i.tileTransform,v,p),C=_.map(S=>{const E=Z.sub(S,S,w);return Z.normalize(E,E),new Nb(w,E)}),D=Xu(i,1,s.zoom)*s._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:y,tilespaceRays:C,bufferedTilespaceGeometry:g,bufferedTilespaceBounds:(k=Al(g),k.min.x=he(k.min.x,0,pt),k.min.y=he(k.min.y,0,pt),k.max.x=he(k.max.x,0,pt),k.max.y=he(k.max.y,0,pt),k),tile:i,tileID:i.tileID,pixelToTileUnitsFactor:D};var k}_bufferedScreenMercator(i,s){const l=th(i);if(this._screenRaycastCache[l])return this._screenRaycastCache[l];{let d;return d="globe"===s.projection.name?this._projectAndResample(this.bufferedScreenGeometry(i),s):{polygon:this.bufferedScreenGeometry(i).map(u=>s.pointCoordinate3D(u)),unwrapped:!0},this._screenRaycastCache[l]=d,d}}_bufferedCameraMercator(i,s){const l=th(i);if(this._cameraRaycastCache[l])return this._cameraRaycastCache[l];{let d;return d="globe"===s.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(i),s):{polygon:this.bufferedCameraGeometry(i).map(u=>s.pointCoordinate3D(u)),unwrapped:!0},this._cameraRaycastCache[l]=d,d}}_projectAndResample(i,s){const l=function(u,m){const p=at.multiply([],m.pixelMatrix,m.globeMatrix),g=[0,-ms,0,1],_=[0,ms,0,1],y=[0,0,0,1];Qi.transformMat4(g,g,p),Qi.transformMat4(_,_,p),Qi.transformMat4(y,y,p);const v=new ot(g[0]/g[3],g[1]/g[3]),w=new ot(_[0]/_[3],_[1]/_[3]),C=Ed(u,v)&&g[3]<y[3],D=Ed(u,w)&&_[3]<y[3];if(!C&&!D)return null;const k=function(B,j,U){for(let H=1;H<B.length;H++){const W=Og(j.pointCoordinate3D(B[H-1]).x),q=Og(j.pointCoordinate3D(B[H]).x);if(U<0){if(W<q)return{idx:H,t:-W/(q-1-W)}}else if(q<W)return{idx:H,t:(1-W)/(q+1-W)}}return null}(u,m,C?-1:1);if(!k)return null;const{idx:S,t:E}=k;let A=S>1?r1(u.slice(0,S),m):[],P=S<u.length?r1(u.slice(S),m):[];A=A.map(B=>new ot(Og(B.x),B.y)),P=P.map(B=>new ot(Og(B.x),B.y));const O=[...A];0===O.length&&O.push(P[P.length-1]);const R=_e(O[O.length-1].y,(0===P.length?A[0]:P[0]).y,E);let F;return F=C?[new ot(0,R),new ot(0,0),new ot(1,0),new ot(1,R)]:[new ot(1,R),new ot(1,1),new ot(0,1),new ot(0,R)],O.push(...F),0===P.length?O.push(A[0]):O.push(...P),{polygon:O.map(B=>new Ei(B.x,B.y)),unwrapped:!1}}(i,s);if(l)return l;const d=function(u,m){let p=!1,g=-1/0,_=0;for(let v=0;v<u.length-1;v++)u[v].x>g&&(g=u[v].x,_=v);for(let v=0;v<u.length-1;v++){const w=(_+v)%(u.length-1),C=u[w],D=u[w+1];Math.abs(C.x-D.x)>.5&&(C.x<D.x?(C.x+=1,0===w&&(u[u.length-1].x+=1)):(D.x+=1,w+1===u.length-1&&(u[0].x+=1)),p=!0)}const y=dr(m.center.lng);return p&&y<Math.abs(y-1)&&u.forEach(v=>{v.x-=1}),{polygon:u,unwrapped:p}}(r1(i,s).map(u=>new ot(Og(u.x),u.y)),s);return{polygon:d.polygon.map(u=>new Ei(u.x,u.y)),unwrapped:d.unwrapped}}}function r1(o,i){return zx(o,s=>{const l=i.pointCoordinate3D(s);s.x=l.x,s.y=l.y},1/256)}function Og(o){return o<0?1+o%1:o%1}function th(o){return 100*o|0}function o1(o,i,s,l,d){const u=function(m,p){if(m)return d(m);if(p){o.url&&p.tiles&&o.tiles&&delete o.tiles;const g=is(se(p,o),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);p.vector_layers&&(g.vectorLayers=p.vector_layers,g.vectorLayerIds=g.vectorLayers.map(_=>_.id)),g.tiles=i.canonicalizeTileset(g,o.url),d(null,g)}};return o.url?jt(i.transformRequest(i.normalizeSourceURL(o.url,null,s,l),xt.Source),u):Ze.frame(()=>u(null,o))}class eh{constructor(i,s,l){this.bounds=go.convert(this.validateBounds(i)),this.minzoom=s||0,this.maxzoom=l||24}validateBounds(i){return Array.isArray(i)&&4===i.length?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const s=Math.pow(2,i.z),l=Math.floor(dr(this.bounds.getWest())*s),d=Math.floor(Rr(this.bounds.getNorth())*s),u=Math.ceil(dr(this.bounds.getEast())*s),m=Math.ceil(Rr(this.bounds.getSouth())*s);return i.x>=l&&i.x<u&&i.y>=d&&i.y<m}}class Fg{constructor(i,s){this.width=i,this.height=s,this.nextRow=0,this.image=new cl({width:i,height:s}),this.positions={},this.uploaded=!1}getDash(i,s){const l=this.getKey(i,s);return this.positions[l]}trim(){const i=this.width,s=this.height=Ti(this.nextRow);this.image.resize({width:i,height:s})}getKey(i,s){return i.join(",")+s}getDashRanges(i,s,l){const d=[];let u=i.length%2==1?-i[i.length-1]*l:0,m=i[0]*l,p=!0;d.push({left:u,right:m,isDash:p,zeroLength:0===i[0]});let g=i[0];for(let _=1;_<i.length;_++){p=!p;const y=i[_];u=g*l,g+=y,m=g*l,d.push({left:u,right:m,isDash:p,zeroLength:0===y})}return d}addRoundDash(i,s,l){const d=s/2;for(let u=-l;u<=l;u++){const m=this.width*(this.nextRow+l+u);let p=0,g=i[p];for(let _=0;_<this.width;_++){_/g.right>1&&(g=i[++p]);const y=Math.abs(_-g.left),v=Math.abs(_-g.right),w=Math.min(y,v);let C;const D=u/l*(d+1);if(g.isDash){const k=d-Math.abs(D);C=Math.sqrt(w*w+k*k)}else C=d-Math.sqrt(w*w+D*D);this.image.data[m+_]=Math.max(0,Math.min(255,C+128))}}}addRegularDash(i,s){for(let g=i.length-1;g>=0;--g){const _=i[g],y=i[g+1];_.zeroLength?i.splice(g,1):y&&y.isDash===_.isDash&&(y.left=_.left,i.splice(g,1))}const l=i[0],d=i[i.length-1];l.isDash===d.isDash&&(l.left=d.left-this.width,d.right=l.right+this.width);const u=this.width*this.nextRow;let m=0,p=i[m];for(let g=0;g<this.width;g++){g/p.right>1&&(p=i[++m]);const _=Math.abs(g-p.left),y=Math.abs(g-p.right),v=Math.min(_,y);this.image.data[u+g]=Math.max(0,Math.min(255,(p.isDash?v:-v)+s+128))}}addDash(i,s){const l=this.getKey(i,s);if(this.positions[l])return this.positions[l];const d="round"===s,u=d?7:0,m=2*u+1;if(this.nextRow+m>this.height)return rt("LineAtlas out of space"),null;0===i.length&&i.push(1);let p=0;for(let y=0;y<i.length;y++)i[y]<0&&(rt("Negative value is found in line dasharray, replacing values with 0"),i[y]=0),p+=i[y];if(0!==p){const y=this.width/p,v=this.getDashRanges(i,this.width,y);d?this.addRoundDash(v,y,u):this.addRegularDash(v,"square"===s?.5*y:0)}const g=this.nextRow+u;this.nextRow+=m;const _={tl:[g,u],br:[p,0]};return this.positions[l]=_,_}}de(Fg,"LineAtlas");const ys=1*ua;class qO{constructor(i){const s={},l=[];for(const p in i){const g=i[p],_=s[p]={};for(const y in g.glyphs){const v=g.glyphs[+y];if(!v||0===v.bitmap.width||0===v.bitmap.height)continue;const w=v.metrics.localGlyph?ys:1,C={x:0,y:0,w:v.bitmap.width+2*w,h:v.bitmap.height+2*w};l.push(C),_[y]=C}}const{w:d,h:u}=hy(l),m=new cl({width:d||1,height:u||1});for(const p in i){const g=i[p];for(const _ in g.glyphs){const y=g.glyphs[+_];if(!y||0===y.bitmap.width||0===y.bitmap.height)continue;const v=s[p][_],w=y.metrics.localGlyph?ys:1;cl.copy(y.bitmap,m,{x:0,y:0},{x:v.x+w,y:v.y+w},y.bitmap)}}this.image=m,this.positions=s}}de(qO,"GlyphAtlas");class UT{constructor(i){this.tileID=new Ri(i.tileID.overscaledZ,i.tileID.wrap,i.tileID.canonical.z,i.tileID.canonical.x,i.tileID.canonical.y),this.tileZoom=i.tileZoom,this.uid=i.uid,this.zoom=i.zoom,this.canonical=i.tileID.canonical,this.pixelRatio=i.pixelRatio,this.tileSize=i.tileSize,this.source=i.source,this.scope=i.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=i.showCollisionBoxes,this.collectResourceTiming=!!i.collectResourceTiming,this.promoteId=i.promoteId,this.isSymbolTile=i.isSymbolTile,this.tileTransform=Hu(i.tileID.canonical,i.projection),this.projection=i.projection,this.brightness=i.brightness,this.extraShadowCaster=!!i.extraShadowCaster}parse(i,s,l,d,u){this.status="parsing",this.data=i,this.collisionBoxArray=new qD;const m=new sw(Object.keys(i.layers).sort()),p=new sy(this.tileID,this.promoteId);p.bucketLayerIDs=[];const g={},_=new Fg(256,256),y={featureIndex:p,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:_,availableImages:l,brightness:this.brightness},v=s.familiesBySource[this.source];for(const A in v){const P=i.layers[A];if(!P)continue;let O=!1,R=!1,F=!1;for(const U of v[A])"symbol"===U[0].type?O=!0:R=!0,U[0].is3D()&&"model"!==U[0].type&&(F=!0);if(this.extraShadowCaster&&!F||!0===this.isSymbolTile&&!O||!1===this.isSymbolTile&&!R)continue;1===P.version&&rt(`Vector tile source "${this.source}" layer "${A}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const B=m.encode(A),j=[];for(let U=0;U<P.length;U++){const H=P.feature(U),W=p.getId(H,A);j.push({feature:H,id:W,index:U,sourceLayerIndex:B})}for(const U of v[A]){const H=U[0];(!this.extraShadowCaster||H.is3D()&&"model"!==H.type)&&(void 0!==this.isSymbolTile&&"symbol"===H.type!==this.isSymbolTile||H.minzoom&&this.zoom<Math.floor(H.minzoom)||H.maxzoom&&this.zoom>=H.maxzoom||"none"!==H.visibility&&(Oy(U,this.zoom,y.brightness,l),(g[H.id]=H.createBucket({index:p.bucketLayerIDs.length,layers:U,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:B,sourceID:this.source,projection:this.projection.spec})).populate(j,y,this.tileID.canonical,this.tileTransform),p.bucketLayerIDs.push(U.map(W=>W.id))))}}let w,C,D,k;_.trim();const S={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},E=()=>{if(w)return this.status="done",u(w);if(this.extraShadowCaster)this.status="done",u(null,{buckets:we(g).filter(A=>!A.isEmpty()),featureIndex:p,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:y.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(C&&D&&k){const A=new qO(C),P=new IS(D,k);for(const O in g){const R=g[O];R instanceof Gm?(Oy(R.layers,this.zoom,y.brightness,l),NS(R,C,A.positions,D,P.iconPositions,this.showCollisionBoxes,l,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):R.hasPattern&&(R instanceof wy||R instanceof Lc||R instanceof rp)&&(Oy(R.layers,this.zoom,y.brightness,l),R.addFeatures(y,this.tileID.canonical,P.patternPositions,l,this.tileTransform,this.brightness))}this.status="done",u(null,{buckets:we(g).filter(O=>!O.isEmpty()),featureIndex:p,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:A.image,lineAtlas:_,imageAtlas:P,brightness:y.brightness})}};if(!this.extraShadowCaster){const A=Vh(y.glyphDependencies,R=>Object.keys(R).map(Number));Object.keys(A).length?d.send("getGlyphs",{uid:this.uid,stacks:A,scope:this.scope},(R,F)=>{w||(w=R,C=F,E())},void 0,!1,S):C={};const P=Object.keys(y.iconDependencies);P.length?d.send("getImages",{icons:P,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(R,F)=>{w||(w=R,D=F,E())},void 0,!1,S):D={};const O=Object.keys(y.patternDependencies);O.length?d.send("getImages",{icons:O,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(R,F)=>{w||(w=R,k=F,E())},void 0,!1,S):k={}}E()}}function Oy(o,i,s,l){const d=new zn(i,{brightness:s});for(const u of o)u.recalculate(d,l)}class HT{constructor(i){this.entries={},this.scheduler=i}request(i,s,l,d){const u=this.entries[i]=this.entries[i]||{callbacks:[]};if(u.result){const[m,p]=u.result;return this.scheduler?this.scheduler.add(()=>{d(m,p)},s):d(m,p),()=>{}}return u.callbacks.push(d),u.cancel||(u.cancel=l((m,p)=>{u.result=[m,p];for(const g of u.callbacks)this.scheduler?this.scheduler.add(()=>{g(m,p)},s):g(m,p);setTimeout(()=>delete this.entries[i],3e3)})),()=>{u.result||(u.callbacks=u.callbacks.filter(m=>m!==d),u.callbacks.length||(u.cancel(),delete this.entries[i]))}}}function s1(o,i,s){const l=JSON.stringify(o.request);return o.data&&(this.deduped.entries[l]={result:[null,o.data]}),this.deduped.request(l,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom},d=>{const u=qt(o.request,(m,p,g,_)=>{m?d(m):p&&d(null,{vectorTile:s?void 0:new rw(new ry(p)),rawData:p,cacheControl:g,expires:_})});return()=>{u.cancel(),d()}},i)}class a1 extends gi{constructor(i,s,l,d){if(super(),this.id=i,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,se(this,is(s,["url","scheme","tileSize","promoteId"])),this._options=se({type:"vector"},s),this._collectResourceTiming=!!s.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d),this._tileWorkers={},this._deduped=new HT}load(i){this._loaded=!1,this.fire(new Bt("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map._worldview;this._tileJSONRequest=o1(this._options,this.map._requestManager,s,l,(d,u)=>{this._tileJSONRequest=null,this._loaded=!0,d?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),l&&2!==l.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new Yt(d))):u&&(se(this,u),u.bounds&&(this.tileBounds=new eh(u.bounds,this.minzoom,this.maxzoom)),sd(u.tiles,this.map._requestManager._customAccessToken),this.fire(new Bt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Bt("data",{dataType:"source",sourceDataType:"content"}))),i&&i(d)})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest();const i=So(this.id,this.scope);this.load(()=>this.map.style.clearSource(i))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return se({},this._options)}loadTile(i,s){const l=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme)),d={request:this.map._requestManager.transformRequest(l,xt.Tile),data:void 0,uid:i.uid,tileID:i.tileID,tileZoom:i.tileZoom,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:Ze.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:i.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:i.isExtraShadowCaster};if(d.request.collectResourceTiming=this._collectResourceTiming,i.actor&&"expired"!==i.state)"loading"===i.state?i.reloadCallback=s:i.request=i.actor.send("reloadTile",d,u.bind(this));else if(i.actor=this._tileWorkers[l]=this._tileWorkers[l]||this.dispatcher.getActor(),this.dispatcher.ready)i.request=i.actor.send("loadTile",d,u.bind(this),void 0,!0);else{const m=s1.call({deduped:this._deduped},d,(p,g)=>{p||!g?u.call(this,p):(d.data={cacheControl:g.cacheControl,expires:g.expires,rawData:g.rawData.slice(0)},i.actor&&i.actor.send("loadTile",d,u.bind(this),void 0,!0))},!0);i.request={cancel:m}}function u(m,p){return delete i.request,i.aborted?s(null):m&&404!==m.status?s(m):(p&&p.resourceTiming&&(i.resourceTiming=p.resourceTiming),this.map._refreshExpiredTiles&&p&&i.setExpiryData(p),i.loadVectorData(p,this.map.painter),Uh(this.dispatcher),s(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(i){i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id,scope:this.scope}),i.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Fy extends gi{constructor(i,s,l,d){super(),this.id=i,this.dispatcher=l,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=se({type:"raster"},s),se(this,is(s,["url","scheme","tileSize"]))}load(i){this._loaded=!1,this.fire(new Bt("dataloading",{dataType:"source"})),this._tileJSONRequest=o1(this._options,this.map._requestManager,null,null,(s,l)=>{this._tileJSONRequest=null,this._loaded=!0,s?this.fire(new Yt(s)):l&&(se(this,l),l.bounds&&(this.tileBounds=new eh(l.bounds,this.minzoom,this.maxzoom)),sd(l.tiles),this.fire(new Bt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Bt("data",{dataType:"source",sourceDataType:"content"}))),i&&i(s)})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest();const i=So(this.id,this.scope);this.load(()=>this.map.style.clearSource(i))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return se({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,s){const l=Ze.devicePixelRatio>=2,d=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),l,this.tileSize);i.request=ai(this.map._requestManager.transformRequest(d,xt.Tile),(u,m,p,g)=>(delete i.request,i.aborted?(i.state="unloaded",s(null)):u?(i.state="errored",s(u)):m?(this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:p,expires:g}),i.setTexture(m,this.map.painter),i.state="loaded",Uh(this.dispatcher),void s(null)):s(null)))}abortTile(i,s){i.request&&(i.request.cancel(),delete i.request),s()}unloadTile(i,s){i.texture&&i.texture instanceof Un?(i.destroy(!0),i.texture&&i.texture instanceof Un&&this.map.painter.saveTileTexture(i.texture)):i.destroy(),s()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function $T(){return null!=Yg.workerClass?new Yg.workerClass:new lt.Worker(Yg.workerUrl)}const l1="mapboxgl_preloaded_worker_pool";class sp{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<sp.workerCount;)this.workers.push(new $T);return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.workers&&0===this.numActive()&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[l1]}numActive(){return Object.keys(this.active).length}}let Lg;function Vc(){return Lg||(Lg=new sp),Lg}sp.workerCount=2;let Ly,c1,pl,ap=null;function d1(){return Lt()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:c1||mi.DRACO_URL}const By=5123,Ny=5126,u1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,[By]:Uint16Array,5125:Uint32Array,[Ny]:Float32Array},Bg={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",[By]:"DT_UINT16",5125:"DT_UINT32",[Ny]:"DT_FLOAT32"},ih={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function GT(o,i,s){const l=s.json.bufferViews.length,d=s.buffers.length;i.bufferView=l,s.json.bufferViews[l]={buffer:d,byteLength:o.byteLength},s.buffers[d]=o}const h1="KHR_draco_mesh_compression";function YO(o,i){const s=o.extensions&&o.extensions[h1];if(!s)return;const l=new pl.Decoder,d=g1(i,s.bufferView),u=new pl.Mesh;if(!l.DecodeArrayToMesh(d,d.byteLength,u))throw new Error("Failed to decode Draco mesh");const m=i.json.accessors[o.indices],p=u1[m.componentType],g=m.count*p.BYTES_PER_ELEMENT,_=pl._malloc(g);p===Uint16Array?l.GetTrianglesUInt16Array(u,g,_):l.GetTrianglesUInt32Array(u,g,_),GT(pl.memory.buffer.slice(_,_+g),m,i),pl._free(_);for(const y of Object.keys(s.attributes)){const v=l.GetAttributeByUniqueId(u,s.attributes[y]),w=i.json.accessors[o.attributes[y]],C=Bg[w.componentType],D=w.count*ih[w.type]*u1[w.componentType].BYTES_PER_ELEMENT,k=pl._malloc(D);l.GetAttributeDataArrayForAllPoints(u,v,pl[C],D,k),GT(pl.memory.buffer.slice(k,k+D),w,i),pl._free(k)}l.destroy(),u.destroy(),delete o.extensions[h1]}const m1=1179937895,p1=new TextDecoder("utf8");function f1(o,i){return new URL(o,i).href}function ZO(o,i,s,l){return fetch(f1(o.uri,l)).then(d=>d.arrayBuffer()).then(d=>{i.buffers[s]=d})}function g1(o,i){const s=o.json.bufferViews[i];return new Uint8Array(o.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function XO(o,i,s,l){if(o.uri){const d=f1(o.uri,l);return fetch(d).then(u=>u.blob()).then(u=>lt.createImageBitmap(u)).then(u=>{i.images[s]=u})}if(void 0!==o.bufferView){const d=g1(i,o.bufferView),u=new lt.Blob([d],{type:o.mimeType});return lt.createImageBitmap(u).then(m=>{i.images[s]=m})}}function WT(o,i=0,s){const l={json:null,images:[],buffers:[]};if(new Uint32Array(o,i,1)[0]===m1){const _=new Uint32Array(o,i);let y=2;const v=(_[y++]>>2)-3,w=_[y++]>>2;if(y++,l.json=JSON.parse(p1.decode(_.subarray(y,y+w))),y+=w,y<v){const C=_[y++];y++;const D=i+(y<<2);l.buffers[0]=o.slice(D,D+C)}}else l.json=JSON.parse(p1.decode(new Uint8Array(o,i)));const{buffers:d,images:u,meshes:m,extensionsUsed:p}=l.json;let g=Promise.resolve();if(d){const _=[];for(let y=0;y<d.length;y++){const v=d[y];v.uri?_.push(ZO(v,l,y,s)):l.buffers[y]||(l.buffers[y]=null)}g=Promise.all(_)}return g.then(()=>{const _=[],y=p&&p.includes(h1);if(y&&_.push(function(){if(!pl)return Ly||(Ly=function(v){let w,C=null;function D(){w=new Uint8Array(C.buffer)}function k(){throw new Error("Unexpected Draco error.")}const S={a:{a:k,d:function(E,A,P){return w.copyWithin(E,A,A+P)},c:function(E){const A=w.length,P=Math.max(E>>>0,Math.ceil(1.2*A)),O=Math.ceil((P-A)/65536);try{return C.grow(O),D(),!0}catch{return!1}},b:k}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(v,S):v.then(E=>E.arrayBuffer()).then(E=>WebAssembly.instantiate(E,S))).then(E=>{const{Rb:A,Qb:P,P:O,T:R,X:F,Ja:B,La:j,Qa:U,Va:H,Wa:W,eb:q,jb:X,f:G,e:Q,yb:it,zb:st,Ab:J,Bb:et,Db:dt,Gb:mt}=E.instance.exports;C=Q;const ut=(()=>{let bt=0,yt=0,Ct=0,gt=0;return At=>{Ct&&(A(gt),A(bt),yt+=Ct,Ct=bt=0),bt||(yt+=128,bt=P(yt));const Gt=At.length+7&-8;let Et=bt;Gt>=yt&&(Ct=Gt,Et=gt=P(Gt));for(let te=0;te<At.length;te++)w[Et+te]=At[te];return Et}})();return D(),G(),{memory:Q,_free:A,_malloc:P,Mesh:class{constructor(){this.ptr=O()}destroy(){R(this.ptr)}},Decoder:class{constructor(){this.ptr=B()}destroy(){X(this.ptr)}DecodeArrayToMesh(bt,yt,Ct){const gt=ut(bt),At=j(this.ptr,gt,yt,Ct.ptr);return!!F(At)}GetAttributeByUniqueId(bt,yt){return{ptr:U(this.ptr,bt.ptr,yt)}}GetTrianglesUInt16Array(bt,yt,Ct){H(this.ptr,bt.ptr,yt,Ct)}GetTrianglesUInt32Array(bt,yt,Ct){W(this.ptr,bt.ptr,yt,Ct)}GetAttributeDataArrayForAllPoints(bt,yt,Ct,gt,At){q(this.ptr,bt.ptr,yt.ptr,Ct,gt,At)}},DT_INT8:it(),DT_UINT8:st(),DT_INT16:J(),DT_UINT16:et(),DT_UINT32:dt(),DT_FLOAT32:mt()}})}(fetch(d1())),Ly.then(v=>{pl=v,Ly=void 0}))}()),u)for(let v=0;v<u.length;v++)_.push(XO(u[v],l,v,s));return(_.length?Promise.all(_):Promise.resolve()).then(()=>{if(y&&m)for(const{primitives:v}of m)for(const w of v)YO(w,l);return l})})}function KO(o){return fetch(o).then(i=>i.arrayBuffer()).then(i=>WT(i,0,o))}class QO{constructor(i,s,l){if(this.triangleCount=s.length/3,this.min=new ot(0,0),this.max=new ot(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],0===this.triangleCount||0===i.length||0===l)return;const d=i.map(y=>y.x),u=i.map(y=>y.y);this.min=new ot(Math.min(...d),Math.min(...u)),this.max=new ot(Math.max(...d),Math.max(...u));const m=this.max.sub(this.min);m.x=Math.max(m.x,1),m.y=Math.max(m.y,1);const p=Math.max(m.x,m.y)/l;this.cellsX=Math.max(1,Math.ceil(m.x/p)),this.cellsY=Math.max(1,Math.ceil(m.y/p)),this.xScale=1/p,this.yScale=1/p;const g=[];for(let y=0;y<this.triangleCount;y++){const v=i[s[3*y+0]].sub(this.min),w=i[s[3*y+1]].sub(this.min),C=i[s[3*y+2]].sub(this.min),D=nh(Math.floor(Math.min(v.x,w.x,C.x)),this.xScale,this.cellsX),k=nh(Math.floor(Math.max(v.x,w.x,C.x)),this.xScale,this.cellsX),S=nh(Math.floor(Math.min(v.y,w.y,C.y)),this.yScale,this.cellsY),E=nh(Math.floor(Math.max(v.y,w.y,C.y)),this.yScale,this.cellsY),A=new ot(0,0),P=new ot(0,0),O=new ot(0,0),R=new ot(0,0);for(let F=S;F<=E;++F){A.y=P.y=F*p,O.y=R.y=(F+1)*p;for(let B=D;B<=k;++B)A.x=O.x=B*p,P.x=R.x=(B+1)*p,(eg(v,w,C,A,P,R)||eg(v,w,C,A,R,O))&&g.push({cellIdx:F*this.cellsX+B,triIdx:y})}}if(0===g.length)return;g.sort((y,v)=>y.cellIdx-v.cellIdx||y.triIdx-v.triIdx);let _=0;for(;_<g.length;){const y=g[_].cellIdx,v={start:this.payload.length,len:0};for(;_<g.length&&g[_].cellIdx===y;)++v.len,this.payload.push(g[_++].triIdx);this.cells[y]=v}}query(i,s,l){if(0===this.triangleCount||0===this.cells.length||i.x>this.max.x||this.min.x>s.x||i.y>this.max.y||this.min.y>s.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let g=0;g<this.lookup.length;g++)this.lookup[g]=0;const d=nh(i.x-this.min.x,this.xScale,this.cellsX),u=nh(s.x-this.min.x,this.xScale,this.cellsX),m=nh(i.y-this.min.y,this.yScale,this.cellsY),p=nh(s.y-this.min.y,this.yScale,this.cellsY);for(let g=m;g<=p;g++)for(let _=d;_<=u;_++){const y=this.cells[g*this.cellsX+_];if(y)for(let v=0;v<y.len;v++){const w=this.payload[y.start+v],C=Math.floor(w/8),D=1<<w%8;if(!(this.lookup[C]&D)&&(this.lookup[C]|=D,l.push(w),l.length===this.triangleCount))return}}}}function nh(o,i,s){return Math.max(0,Math.min(s-1,Math.floor(o*i)))}function lp(o,i){const s=o.json.bufferViews[i.bufferView];return new u1[i.componentType](o.buffers[s.buffer],(i.byteOffset||0)+(s.byteOffset||0),i.count*ih[i.type])}function qT(o,i,s){const l=o.indices,d=o.attributes,u={};u.indexArray=new Cr;const m=i.json.accessors[l],p=m.count/3;u.indexArray.reserve(p);const g=lp(i,m);for(let w=0;w<p;w++)u.indexArray.emplaceBack(g[3*w],g[3*w+1],g[3*w+2]);u.indexArray._trim(),u.vertexArray=new kc;const _=i.json.accessors[d.POSITION];u.vertexArray.reserve(_.count);const y=lp(i,_);for(let w=0;w<_.count;w++)u.vertexArray.emplaceBack(y[3*w],y[3*w+1],y[3*w+2]);if(u.vertexArray._trim(),u.aabb=new gn(_.min,_.max),u.centroid=function(w,C){const D=[0,0,0],k=w.length;if(k>0){for(let S=0;S<k;S++){const E=3*w[S];D[0]+=C[E],D[1]+=C[E+1],D[2]+=C[E+2]}D[0]/=k,D[1]/=k,D[2]/=k}return D}(g,y),void 0!==d.COLOR_0){const w=i.json.accessors[d.COLOR_0],C=ih[w.type];if(w.componentType===Ny){u.colorArray=3===C?new kc:new Sa,u.colorArray.reserve(w.count);const D=lp(i,w);if(3===C)for(let k=0;k<w.count;k++)u.colorArray.emplaceBack(D[3*k],D[3*k+1],D[3*k+2]);else for(let k=0;k<w.count;k++)u.colorArray.emplaceBack(D[4*k],D[4*k+1],D[4*k+2],D[4*k+3]);u.colorArray._trim()}else if(w.componentType===By&&4===C){u.colorArray=new Sa,u.colorArray.resize(w.count);const D=lp(i,w),k=1/65535,S=u.colorArray.float32;for(let E=0;E<4*D.length;++E)S[E]=D[E]*k}else rt(`glTF color buffer parsing for accessor ${JSON.stringify(w)} is not supported`)}if(void 0!==d.NORMAL){u.normalArray=new kc;const w=i.json.accessors[d.NORMAL];u.normalArray.reserve(w.count);const C=lp(i,w);for(let D=0;D<w.count;D++)u.normalArray.emplaceBack(C[3*D],C[3*D+1],C[3*D+2]);u.normalArray._trim()}if(void 0!==d.TEXCOORD_0&&s.length>0){u.texcoordArray=new Sc;const w=i.json.accessors[d.TEXCOORD_0];u.texcoordArray.reserve(w.count);const C=lp(i,w);for(let D=0;D<w.count;D++)u.texcoordArray.emplaceBack(C[2*D],C[2*D+1]);u.texcoordArray._trim()}const v=o.material;return u.material=function(w,C){const{emissiveFactor:D=[0,0,0],alphaMode:k="OPAQUE",alphaCutoff:S=.5,normalTexture:E,occlusionTexture:A,emissiveTexture:P,doubleSided:O}=w,{baseColorFactor:R=[1,1,1,1],metallicFactor:F=1,roughnessFactor:B=1,baseColorTexture:j,metallicRoughnessTexture:U}=w.pbrMetallicRoughness||{};return{pbrMetallicRoughness:{baseColorFactor:new di(...R),metallicFactor:F,roughnessFactor:B,baseColorTexture:j?C[j.index]:void 0,metallicRoughnessTexture:U?C[U.index]:void 0},doubleSided:O,emissiveFactor:D,alphaMode:k,alphaCutoff:S,normalTexture:E?C[E.index]:void 0,occlusionTexture:A?C[A.index]:void 0,emissionTexture:P?C[P.index]:void 0,defined:void 0===w.defined}}(void 0!==v?i.json.materials[v]:{defined:!1},s),void 0!==d._FEATURE_RGBA4444&&(u.featureData=new Uint32Array(lp(i,i.json.accessors[d._FEATURE_RGBA4444]).buffer)),u}function Ng(o,i,s){const{matrix:l,rotation:d,translation:u,scale:m,mesh:p,extras:g,children:_}=o,y={};if(y.matrix=l||at.fromRotationTranslationScale([],d||[0,0,0,1],u||[0,0,0],m||[1,1,1]),void 0!==p){y.meshes=s[p];const v=y.anchor=[0,0];for(const w of y.meshes){const{min:C,max:D}=w.aabb;v[0]+=C[0]+D[0],v[1]+=C[1]+D[1]}v[0]=Math.floor(v[0]/y.meshes.length/2),v[1]=Math.floor(v[1]/y.meshes.length/2)}if(g&&(g.id&&(y.id=g.id),g.lights&&(y.lights=function(v){if(!v.length)return[];const w=function(E){const A=atob(E),P=new Uint8Array(A.length);for(let O=0;O<A.length;O++)P[O]=A.codePointAt(O);return P}(v),C=[],D=w.length/24,k=new Uint16Array(w.buffer),S=new Float32Array(w.buffer);for(let E=0;E<D;E++){const A=k[2*E*6]/30,P=k[2*E*6+1]/30,O=k[2*E*6+10]/100,R=S[6*E+1],F=S[6*E+2],B=S[6*E+3],j=S[6*E+4],U=B-R,H=j-F,W=Math.hypot(U,H);C.push({pos:[R+.5*U,F+.5*H,P],normal:[H/W,-U/W,0],width:W,height:A,depth:O,points:[R,F,B,j]})}return C}(g.lights))),_){const v=[];for(const w of _)v.push(Ng(i.json.nodes[w],i,s));y.children=v}return y}function JO(o){if(0===o.vertices.length||0===o.indices.length)return null;const[i,s]=[o.vertices[0].clone(),o.vertices[0].clone()];for(let m=1;m<o.vertices.length;++m){const p=o.vertices[m];i.x=Math.min(i.x,p.x),i.y=Math.min(i.y,p.y),s.x=Math.max(s.x,p.x),s.y=Math.max(s.y,p.y)}const l=Math.ceil(Math.max(s.x-i.x,s.y-i.y)/256),d=Math.max(8,l),u=new QO(o.vertices,o.indices,d);return{vertices:o.vertices,indices:o.indices,grid:u,min:i,max:s}}function tF(o){if(!o.extras||!o.extras.ground)return null;const i=o.extras.ground;if(!i||!Array.isArray(i)||0===i.length)return null;const s=i[0];if(!s||!Array.isArray(s)||0===s.length)return null;const l=[];for(const m of s){if(!Array.isArray(m)||2!==m.length)continue;const p=m[0],g=m[1];"number"==typeof p&&"number"==typeof g&&l.push(new ot(p,g))}if(l.length<3)return null;l.length>1&&l[l.length-1].equals(l[0])&&l.pop();let d=0;for(let m=0;m<l.length;m++){const p=l[m],g=l[(m+1)%l.length],_=l[(m+2)%l.length];d+=(p.x-g.x)*(_.y-g.y)-(_.x-g.x)*(p.y-g.y)}d>0&&l.reverse();const u=sg(l.flatMap(m=>[m.x,m.y]),[]);return 0===u.length?null:{vertices:l,indices:u}}function YT(o){const i=[],s=[];let l=0;for(const d of o){l=i.length;const u=d.vertexArray.float32,m=d.indexArray.uint16;for(let p=0;p<d.vertexArray.length;p++)i.push(new ot(u[3*p+0],u[3*p+1]));for(let p=0;p<3*d.indexArray.length;p++)s.push(m[p]+l)}if(s.length%3!=0)return null;for(let d=0;d<s.length;d+=3){const u=i[s[d+0]],m=i[s[d+1]],p=i[s[d+2]];(u.x-m.x)*(p.y-m.y)-(p.x-m.x)*(u.y-m.y)>0&&([s[d+1],s[d+2]]=[s[d+2],s[d+1]])}return{vertices:i,indices:s}}function rh(o){const s=function(g,_){const y=[];for(const v of g.json.meshes){const w=[];for(const C of v.primitives)w.push(qT(C,g,_));y.push(w)}return y}(o,function(g,_){const y=[],v=lt.WebGL2RenderingContext;if(g.json.textures)for(const w of g.json.textures){const C={magFilter:v.LINEAR,minFilter:v.NEAREST,wrapS:v.REPEAT,wrapT:v.REPEAT};void 0!==w.sampler&&Object.assign(C,g.json.samplers[w.sampler]),y.push({image:_[w.source],sampler:C,uploaded:!1})}return y}(o,o.images)),{scenes:l,scene:d,nodes:u}=o.json,m=l?l[d||0].nodes:u,p=[];for(const g of m)p.push(Ng(u[g],o,s));return function(g,_,y){const v={},w=new Set;for(let C=0;C<g.length;C++){const D=y[_[C]];if(!D.extras)continue;const k=D.extras["mapbox:footprint:version"],S=D.extras["mapbox:footprint:id"];(k||S)&&w.add(C),"1.0.0"===k&&S&&(v[S]=C)}for(let C=0;C<g.length;C++){if(w.has(C))continue;const D=g[C],k=y[_[C]];if(!k.extras)continue;let S=null;D.id in v&&(S=YT(g[v[D.id]].meshes)),S||(S=tF(k)),S&&(D.footprint=JO(S))}if(w.size>0){const C=Array.from(w.values()).sort((D,k)=>D-k);for(let D=C.length-1;D>=0;D--)g.splice(C[D],1)}}(p,m,o.json.nodes),p}function eF(o){o.heightmap=new Float32Array(4096),o.heightmap.fill(-1);const i=o.vertexArray.float32,s=o.aabb.min[0]-1,l=o.aabb.min[1]-1,d=64/(o.aabb.max[0]-s+2),u=64/(o.aabb.max[1]-l+2);for(let m=0;m<i.length;m+=3){const p=i[m+2],g=(i[m+0]-s)*d|0,_=(i[m+1]-l)*u|0;p>o.heightmap[64*_+g]&&(o.heightmap[64*_+g]=p)}}function iF(o,i){const s={};s.indexArray=new Cr,s.indexArray.reserve(4*o.length),s.vertexArray=new kc,s.vertexArray.reserve(10*o.length),s.colorArray=new Sa,s.vertexArray.reserve(10*o.length);let l=0;for(const m of o){const p=Math.min(10,Math.max(4,1.3*m.height))*i,g=[-m.normal[1],m.normal[0],0],_=Math.min(.29,.1*m.width/m.depth),y=m.width-2*m.depth*i*(_+.01),v=Z.scaleAndAdd([],m.pos,g,y/2),w=Z.scaleAndAdd([],m.pos,g,-y/2),C=[v[0],v[1],v[2]+m.height],D=[w[0],w[1],w[2]+m.height],k=Z.scaleAndAdd([],m.normal,g,_);Z.scale(k,k,p);const S=Z.scaleAndAdd([],m.normal,g,-_);Z.scale(S,S,p),Z.add(k,v,k),Z.add(S,w,S),v[2]+=.1,w[2]+=.1,s.vertexArray.emplaceBack(k[0],k[1],k[2]),s.vertexArray.emplaceBack(S[0],S[1],S[2]),s.vertexArray.emplaceBack(v[0],v[1],v[2]),s.vertexArray.emplaceBack(w[0],w[1],w[2]),s.vertexArray.emplaceBack(C[0],C[1],C[2]),s.vertexArray.emplaceBack(D[0],D[1],D[2]),s.vertexArray.emplaceBack(v[0],v[1],v[2]),s.vertexArray.emplaceBack(w[0],w[1],w[2]),s.vertexArray.emplaceBack(k[0],k[1],k[2]),s.vertexArray.emplaceBack(S[0],S[1],S[2]);const E=y/p/2;s.colorArray.emplaceBack(-E-_,-1,E,.8),s.colorArray.emplaceBack(E+_,-1,E,.8),s.colorArray.emplaceBack(-E,0,E,1.3),s.colorArray.emplaceBack(E,0,E,1.3),s.colorArray.emplaceBack(E+_,-.8,E,.7),s.colorArray.emplaceBack(E+_,-.8,E,.7),s.colorArray.emplaceBack(0,0,E,1.3),s.colorArray.emplaceBack(0,0,E,1.3),s.colorArray.emplaceBack(E+_,-1.2,E,.8),s.colorArray.emplaceBack(E+_,-1.2,E,.8),s.indexArray.emplaceBack(6+l,4+l,8+l),s.indexArray.emplaceBack(7+l,9+l,5+l),s.indexArray.emplaceBack(0+l,1+l,2+l),s.indexArray.emplaceBack(1+l,3+l,2+l),l+=10}const d={defined:!0,emissiveFactor:[0,0,0]},u={};return u.baseColorFactor=di.white,d.pbrMetallicRoughness=u,s.material=d,s.aabb=new gn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}de(QO,"TriangleGridIndex");const _1={vector:a1,raster:Fy,"raster-dem":class extends Fy{constructor(o,i,s,l){super(o,i,s,l),this.type="raster-dem",this.maxzoom=22,this._options=se({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(o,i){const s=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function l(d,u){d&&(o.state="errored",i(d)),u&&(o.dem=u,o.dem.onDeserialize(),o.needsHillshadePrepare=!0,o.needsDEMTextureUpload=!0,o.state="loaded",i(null))}o.request=ai(this.map._requestManager.transformRequest(s,xt.Tile),function(d,u,m,p){if(delete o.request,o.aborted)o.state="unloaded",i(null);else if(d)o.state="errored",i(d);else if(u){this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:m,expires:p});const _=lt.ImageBitmap&&u instanceof lt.ImageBitmap&&tf(),y=1-(u.width-((g=u.width)<=1?1:Math.pow(2,Math.floor(Math.log(g)/Math.LN2))))/2;y<1||o.neighboringTiles||(o.neighboringTiles=this._getNeighboringTiles(o.tileID));const v=_?u:Ze.getImageData(u,y),w={uid:o.uid,coord:o.tileID,source:this.id,scope:this.scope,rawImageData:v,encoding:this.encoding,padding:y};o.actor&&"expired"!==o.state||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",w,l.bind(this),void 0,!0))}var g}.bind(this))}_getNeighboringTiles(o){const i=o.canonical,s=Math.pow(2,i.z),l=(i.x-1+s)%s,d=0===i.x?o.wrap-1:o.wrap,u=(i.x+1+s)%s,m=i.x+1===s?o.wrap+1:o.wrap,p={};return p[new Ri(o.overscaledZ,d,i.z,l,i.y).key]={backfilled:!1},p[new Ri(o.overscaledZ,m,i.z,u,i.y).key]={backfilled:!1},i.y>0&&(p[new Ri(o.overscaledZ,d,i.z,l,i.y-1).key]={backfilled:!1},p[new Ri(o.overscaledZ,o.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},p[new Ri(o.overscaledZ,m,i.z,u,i.y-1).key]={backfilled:!1}),i.y+1<s&&(p[new Ri(o.overscaledZ,d,i.z,l,i.y+1).key]={backfilled:!1},p[new Ri(o.overscaledZ,o.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},p[new Ri(o.overscaledZ,m,i.z,u,i.y+1).key]={backfilled:!1}),p}},geojson:class extends gi{constructor(o,i,s,l){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=s.getActor(),this.setEventedParent(l),this._data=i.data,this._options=se({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const d=pt/this.tileSize;this.workerOptions=se({source:this.id,scope:this.scope,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*d,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*d,extent:pt,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:pt,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*d,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(o){this.map=o,this.setData(this._data)}setData(o){return this._data=o,this._updateWorkerData(),this}getClusterExpansionZoom(o,i){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id,scope:this.scope},i),this}getClusterChildren(o,i){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id,scope:this.scope},i),this}getClusterLeaves(o,i,s,l){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:o,limit:i,offset:s},l),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new Bt("dataloading",{dataType:"source"})),this._loaded=!1;const o=se({},this.workerOptions);o.scope=this.scope;const i=this._data;"string"==typeof i?(o.request=this.map._requestManager.transformRequest(Ze.resolveURL(i),xt.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,o,(s,l)=>{if(this._loaded=!0,this._pendingLoad=null,s)this.fire(new Yt(s));else{const d={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&l&&l.resourceTiming&&l.resourceTiming[this.id]&&(d.resourceTiming=l.resourceTiming[this.id]),this.fire(new Bt("data",d)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(o,i){const s=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const l={type:this.type,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:Ze.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};o.request=this.actor.send(s,l,(d,u)=>(delete o.request,o.destroy(),o.aborted?i(null):d?i(d):(o.loadVectorData(u,this.map.painter,"reloadTile"===s),i(null))),void 0,"loadTile"===s)}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope}),o.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return se({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Fa{constructor(o,i,s,l){super(o,i,s,l),this.roundZoom=!0,this.type="video",this.options=i}load(){this._loaded=!1;const o=this.options;this.urls=[];for(const i of o.urls)this.urls.push(this.map._requestManager.transformRequest(i,xt.Source).url);!function(i,s){const l=lt.document.createElement("video");l.muted=!0,l.onloadstart=function(){s(null,l)};for(let d=0;d<i.length;d++){const u=lt.document.createElement("source");Qt(i[d])||(l.crossOrigin="Anonymous"),u.src=i[d],l.appendChild(u)}}(this.urls,(i,s)=>{this._loaded=!0,i?this.fire(new Yt(i)):s&&(this.video=s,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const i=this.video.seekable;o<i.start(0)||o>i.end(0)?this.fire(new Yt(new le(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const o=this.map.painter.context,i=o.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new Un(o,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(o)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Fa,model:class extends gi{constructor(o,i,s,l){super(),this.id=o,this.type="model",this.models=[],this._loaded=!1,this._options=i}load(){const o=[];for(const i in this._options.models){const s=this._options.models[i],l=KO(this.map._requestManager.transformRequest(s.uri,xt.Model).url).then(d=>{if(!d)return;const u=rh(d),m=new pT(i,s.position,s.orientation,u);m.computeBoundsAndApplyParent(),this.models.push(m)}).catch(d=>{this.fire(new Yt(new Error(`Could not load model ${i} from ${s.uri}: ${d.message}`)))});o.push(l)}return Promise.allSettled(o).then(()=>{this._loaded=!0,this.fire(new Bt("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(i=>{this.fire(new Yt(new Error(`Could not load models: ${i.message}`)))})}onAdd(o){this.map=o,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(o,i){}serialize(){return{type:"model"}}},"batched-model":class extends gi{constructor(o,i,s,l){super(),this.type="batched-model",this.id=o,this.tileSize=512,this._options=i,this.tiles=this._options.tiles,this.maxzoom=i.maxzoom||19,this.minzoom=i.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=s,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(l)}onAdd(o){this.map=o,this.load()}load(o){this._loaded=!1,this.fire(new Bt("dataloading",{dataType:"source"}));const i=Array.isArray(this.map._language)?this.map._language.join():this.map._language,s=this.map._worldview;this._tileJSONRequest=o1(this._options,this.map._requestManager,i,s,(l,d)=>{this._tileJSONRequest=null,this._loaded=!0,l?(i&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${i}`),s&&2!==s.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${s}`),this.fire(new Yt(l))):d&&(se(this,d),d.bounds&&(this.tileBounds=new eh(d.bounds,this.minzoom,this.maxzoom)),sd(d.tiles,this.map._requestManager._customAccessToken),this.fire(new Bt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Bt("data",{dataType:"source",sourceDataType:"content"}))),o&&o(l)})}hasTransition(){return!1}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loaded(){return this._loaded}loadTile(o,i){const s=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),l={request:this.map._requestManager.transformRequest(s,xt.Tile),data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:o.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(o.actor&&"expired"!==o.state)if("loading"===o.state)o.reloadCallback=i;else{if(o.buckets){const u=Object.values(o.buckets);for(const m of u)m.dirty=!0;return void(o.state="loaded")}o.request=o.actor.send("reloadTile",l,d.bind(this))}else o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",l,d.bind(this),void 0,!0);function d(u,m){return o.aborted?i(null):u&&404!==u.status?i(u):(m&&(m.resourceTiming&&(o.resourceTiming=m.resourceTiming),this.map._refreshExpiredTiles&&o.setExpiryData(m),o.buckets={...o.buckets,...m.buckets}),o.state="loaded",void i(null))}}serialize(){return se({},this._options)}},canvas:class extends Fa{constructor(o,i,s,l){super(o,i,s,l),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(d=>!Array.isArray(d)||2!==d.length||d.some(u=>"number"!=typeof u))||this.fire(new Yt(new le(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new Yt(new le(`sources.${o}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new Yt(new le(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof lt.HTMLCanvasElement||this.fire(new Yt(new le(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new Yt(new le(`sources.${o}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof lt.HTMLCanvasElement?this.options.canvas:lt.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new Yt(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const i=this.map.painter.context;this.texture?!o&&!this._playing||this.texture instanceof Wm||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Un(i,this.canvas,i.gl.RGBA,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}},custom:class extends gi{constructor(o,i,s,l){super(),this.id=o,this.type="custom",this._dataType="raster",this._dispatcher=s,this._implementation=i,this.setEventedParent(l),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new Yt(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new Yt(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new eh(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.clearTiles=this._clearTiles.bind(this),i.coveringTiles=this._coveringTiles.bind(this),se(this,is(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return is(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new Bt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Bt("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(o){this._map=o,this._loaded=!1,this.fire(new Bt("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(o),this.load()}onRemove(o){this._implementation.onRemove&&this._implementation.onRemove(o)}hasTile(o){if(this._implementation.hasTile){const{x:i,y:s,z:l}=o.canonical;return this._implementation.hasTile({x:i,y:s,z:l})}return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,i){const{x:s,y:l,z:d}=o.tileID.canonical,u=new lt.AbortController;o.request=Promise.resolve(this._implementation.loadTile({x:s,y:l,z:d},{signal:u.signal})).then(function(m){return delete o.request,o.aborted?(o.state="unloaded",i(null)):void 0===m?(o.state="errored",i(null)):null===m?(this.loadTileData(o,{width:this.tileSize,height:this.tileSize,data:null}),o.state="loaded",i(null)):(p=m)instanceof lt.ImageData||p instanceof lt.HTMLCanvasElement||p instanceof lt.ImageBitmap||p instanceof lt.HTMLImageElement?(this.loadTileData(o,m),o.state="loaded",void i(null)):(o.state="errored",i(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var p}.bind(this)).catch(m=>{20!==m.code&&(o.state="errored",i(m))}),o.request.cancel=()=>u.abort()}loadTileData(o,i){o.setTexture(i,this._map.painter)}unloadTile(o,i){if(o.texture&&o.texture instanceof Un?(o.destroy(!0),o.texture&&o.texture instanceof Un&&this._map.painter.saveTileTexture(o.texture)):o.destroy(),this._implementation.unloadTile){const{x:s,y:l,z:d}=o.tileID.canonical;this._implementation.unloadTile({x:s,y:l,z:d})}i()}abortTile(o,i){o.request&&o.request.cancel&&(o.request.cancel(),delete o.request),i()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(o=>({x:o.canonical.x,y:o.canonical.y,z:o.canonical.z}))}_clearTiles(){const o=So(this.id,this.scope);this._map.style.clearSource(o)}_update(){this.fire(new Bt("data",{dataType:"source",sourceDataType:"content"}))}}},b1=function(o,i,s,l){const d=new _1[i.type](o,i,s,l);if(d.id!==o)throw new Error(`Expected Source id to be ${o} instead of ${d.id}`);return qr(["load","abort","unload","serialize","prepare"],d),d};function oV(o,i){const s=at.identity([]);return at.scale(s,s,[.5*o.width,.5*-o.height,1]),at.translate(s,s,[1,-1,0]),at.multiply(s,s,o.calculateProjMatrix(i.toUnwrapped())),Float32Array.from(s)}function nF(o,i,s,l,d,u,m,p=!1){const g=o.tilesIn(l,m,p);g.sort(XT);const _=[];for(const v of g)_.push({wrappedTileID:v.tile.tileID.wrapped().key,queryResults:v.tile.queryRenderedFeatures(i,s,o._state,v,d,u,oV(o.transform,v.tile.tileID),p)});const y=function(v){const w={},C={};for(const D of v){const k=D.queryResults,S=D.wrappedTileID,E=C[S]=C[S]||{};for(const A in k){const P=k[A],O=E[A]=E[A]||{},R=w[A]=w[A]||[];for(const F of P)O[F.featureIndex]||(O[F.featureIndex]=!0,R.push(F))}}return w}(_);for(const v in y)y[v].forEach(w=>{const C=w.feature,D=C.layer;D&&"background"!==D.type&&"sky"!==D.type&&"slot"!==D.type&&(C.source=D.source,D["source-layer"]&&(C.sourceLayer=D["source-layer"]),C.state=void 0!==C.id?o.getFeatureState(D["source-layer"],C.id):{})});return y}function ZT(o,i){const s=o.getRenderableIds().map(u=>o.getTileByID(u)),l=[],d={};for(let u=0;u<s.length;u++){const m=s[u],p=m.tileID.canonical.key;d[p]||(d[p]=!0,m.querySourceFeatures(l,i))}return l}function XT(o,i){const s=o.tileID,l=i.tileID;return s.overscaledZ-l.overscaledZ||s.canonical.y-l.canonical.y||s.wrap-l.wrap||s.canonical.x-l.canonical.x}class rF{constructor(i){this.style=i}processLayersChanged(){this.layers=[];for(const i in this.style._mergedLayers){const s=this.style._mergedLayers[i];if("fill-extrusion"===s.type)this.layers.push(s);else if("model"===s.type){const l=this.style.getLayerSource(s);l&&"batched-model"===l.type&&this.layers.push(s)}}}updateZOffset(i,s){this.currentBuildingBuckets=[];for(let d=0;d<this.layers.length;++d){const u=this.layers[d],m=this.style.getLayerSourceCache(u);let p=1;"fill-extrusion"===u.type&&(p=u.paint.get("fill-extrusion-opacity")>0?u.paint.get("fill-extrusion-vertical-scale"):0);let g=m?m.getTile(s):null;if(!g&&m&&s.canonical.z>m.getSource().minzoom){let _=s.scaledTo(Math.min(m.getSource().maxzoom,s.overscaledZ-1));for(;_.overscaledZ>=m.getSource().minzoom&&(g=m.getTile(_),!g&&0!==_.overscaledZ);)_=_.scaledTo(_.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:g?g.getBucket(u):null,tileID:g?g.tileID:s,verticalScale:p})}i.hasAnyZOffset=!1;let l=!1;for(let d=0;d<i.symbolInstances.length;d++){const u=i.symbolInstances.get(d),m=u.zOffset,p=this._getHeightAtTileOffset(s,u.tileAnchorX,u.tileAnchorY);u.zOffset=-1!==p?p:m,l||m===u.zOffset||(l=!0),i.hasAnyZOffset||0===u.zOffset||(i.hasAnyZOffset=!0)}l&&(i.zOffsetBuffersNeedUpload=!0,i.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(i,s,l,d){let u=s,m=l;if(i.canonical.z!==d.canonical.z){const p=d.canonical,g=1/(1<<i.canonical.z-p.z);u=(s+i.canonical.x*pt)*g-p.x*pt|0,m=(l+i.canonical.y*pt)*g-p.y*pt|0}return{tileX:u,tileY:m}}_getHeightAtTileOffset(i,s,l){let d;for(let u=0;u<this.layers.length;++u){if("fill-extrusion"!==this.layers[u].type)continue;const{bucket:m,tileID:p,verticalScale:g}=this.currentBuildingBuckets[u];if(!m)continue;const{tileX:_,tileY:y}=this._mapCoordToOverlappingTile(i,s,l,p),v=m.getHeightAtTileCoord(_,y);if(v&&void 0!==v.height){if(!v.hidden)return v.height*g;d=v.height}}for(let u=0;u<this.layers.length;++u){if("model"!==this.layers[u].type)continue;const{bucket:m,tileID:p}=this.currentBuildingBuckets[u];if(!m)continue;const{tileX:g,tileY:_}=this._mapCoordToOverlappingTile(i,s,l,p),y=m.getHeightAtTileCoord(g,_);if(y&&!y.hidden)return void 0===y.height&&void 0!==d?Math.min(y.maxHeight,d)*y.verticalScale:(y.height||0)*y.verticalScale}return-1}}var cp=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function oF(o,i){const s={};for(const l in o)"ref"!==l&&(s[l]=o[l]);return cp.forEach(l=>{l in i&&(s[l]=i[l])}),s}function y1(o){o=o.slice();const i=Object.create(null);for(let s=0;s<o.length;s++)i[o[s].id]=o[s];for(let s=0;s<o.length;s++)"ref"in o[s]&&(o[s]=oF(o[s],i[o[s].ref]));return o}const Zi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",setImportUrl:"setImportUrl",setImportData:"setImportData",setImportConfig:"setImportConfig"};function v1(o,i,s){s.push({command:Zi.addSource,args:[o,i[o]]})}function KT(o,i,s){i.push({command:Zi.removeSource,args:[o]}),s[o]=!0}function QT(o,i,s,l){KT(o,s,l),v1(o,i,s)}function sF(o,i,s){let l;for(l in o[s])if(o[s].hasOwnProperty(l)&&"data"!==l&&!Ni(o[s][l],i[s][l]))return!1;for(l in i[s])if(i[s].hasOwnProperty(l)&&"data"!==l&&!Ni(o[s][l],i[s][l]))return!1;return!0}function dp(o,i,s,l,d,u){let m;for(m in i=i||{},o=o||{})o.hasOwnProperty(m)&&(Ni(o[m],i[m])||s.push({command:u,args:[l,m,i[m],d]}));for(m in i)i.hasOwnProperty(m)&&!o.hasOwnProperty(m)&&(Ni(o[m],i[m])||s.push({command:u,args:[l,m,i[m],d]}))}function zy(o){return o.id}function zg(o,i){return o[i.id]=i,o}class JT{constructor(i,s){this.reset(i,s)}reset(i,s){this.points=i||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(1===this.points.length)return this.points[0];i=he(i,0,1);let s=1,l=this._distances[s];const d=i*this.paddedLength+this.padding;for(;l<d&&s<this._distances.length;)l=this._distances[++s];const u=s-1,m=this._distances[u],p=l-m,g=p>0?(d-m)/p:0;return this.points[u].mult(1-g).add(this.points[s].mult(g))}}class tE{constructor(i,s,l){const d=this.boxCells=[],u=this.circleCells=[];this.xCellCount=Math.ceil(i/l),this.yCellCount=Math.ceil(s/l);for(let m=0;m<this.xCellCount*this.yCellCount;m++)d.push([]),u.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=s,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,s,l,d,u){this._forEachCell(s,l,d,u,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(s),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(u)}insertCircle(i,s,l,d){this._forEachCell(s-d,l-d,s+d,l+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(s),this.circles.push(l),this.circles.push(d)}_insertBoxCell(i,s,l,d,u,m){this.boxCells[u].push(m)}_insertCircleCell(i,s,l,d,u,m){this.circleCells[u].push(m)}_query(i,s,l,d,u,m){if(l<0||i>this.width||d<0||s>this.height)return!u&&[];const p=[];if(i<=0&&s<=0&&this.width<=l&&this.height<=d){if(u)return!0;for(let g=0;g<this.boxKeys.length;g++)p.push({key:this.boxKeys[g],x1:this.bboxes[4*g],y1:this.bboxes[4*g+1],x2:this.bboxes[4*g+2],y2:this.bboxes[4*g+3]});for(let g=0;g<this.circleKeys.length;g++){const _=this.circles[3*g],y=this.circles[3*g+1],v=this.circles[3*g+2];p.push({key:this.circleKeys[g],x1:_-v,y1:y-v,x2:_+v,y2:y+v})}return m?p.filter(m):p}return this._forEachCell(i,s,l,d,this._queryCell,p,{hitTest:u,seenUids:{box:{},circle:{}}},m),u?p.length>0:p}_queryCircle(i,s,l,d,u){const m=i-l,p=i+l,g=s-l,_=s+l;if(p<0||m>this.width||_<0||g>this.height)return!d&&[];const y=[];return this._forEachCell(m,g,p,_,this._queryCellCircle,y,{hitTest:d,circle:{x:i,y:s,radius:l},seenUids:{box:{},circle:{}}},u),d?y.length>0:y}query(i,s,l,d,u){return this._query(i,s,l,d,!1,u)}hitTest(i,s,l,d,u){return this._query(i,s,l,d,!0,u)}hitTestCircle(i,s,l,d){return this._queryCircle(i,s,l,!0,d)}_queryCell(i,s,l,d,u,m,p,g){const _=p.seenUids,y=this.boxCells[u];if(null!==y){const w=this.bboxes;for(const C of y)if(!_.box[C]){_.box[C]=!0;const D=4*C;if(i<=w[D+2]&&s<=w[D+3]&&l>=w[D+0]&&d>=w[D+1]&&(!g||g(this.boxKeys[C]))){if(p.hitTest)return m.push(!0),!0;m.push({key:this.boxKeys[C],x1:w[D],y1:w[D+1],x2:w[D+2],y2:w[D+3]})}}}const v=this.circleCells[u];if(null!==v){const w=this.circles;for(const C of v)if(!_.circle[C]){_.circle[C]=!0;const D=3*C;if(this._circleAndRectCollide(w[D],w[D+1],w[D+2],i,s,l,d)&&(!g||g(this.circleKeys[C]))){if(p.hitTest)return m.push(!0),!0;{const k=w[D],S=w[D+1],E=w[D+2];m.push({key:this.circleKeys[C],x1:k-E,y1:S-E,x2:k+E,y2:S+E})}}}}}_queryCellCircle(i,s,l,d,u,m,p,g){const _=p.circle,y=p.seenUids,v=this.boxCells[u];if(null!==v){const C=this.bboxes;for(const D of v)if(!y.box[D]){y.box[D]=!0;const k=4*D;if(this._circleAndRectCollide(_.x,_.y,_.radius,C[k+0],C[k+1],C[k+2],C[k+3])&&(!g||g(this.boxKeys[D])))return m.push(!0),!0}}const w=this.circleCells[u];if(null!==w){const C=this.circles;for(const D of w)if(!y.circle[D]){y.circle[D]=!0;const k=3*D;if(this._circlesCollide(C[k],C[k+1],C[k+2],_.x,_.y,_.radius)&&(!g||g(this.circleKeys[D])))return m.push(!0),!0}}}_forEachCell(i,s,l,d,u,m,p,g){const _=this._convertToXCellCoord(i),y=this._convertToYCellCoord(s),v=this._convertToXCellCoord(l),w=this._convertToYCellCoord(d);for(let C=_;C<=v;C++)for(let D=y;D<=w;D++)if(u.call(this,i,s,l,d,this.xCellCount*D+C,m,p,g))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,s,l,d,u,m){const p=d-i,g=u-s,_=l+m;return _*_>p*p+g*g}_circleAndRectCollide(i,s,l,d,u,m,p){const g=(m-d)/2,_=Math.abs(i-(d+g));if(_>g+l)return!1;const y=(p-u)/2,v=Math.abs(s-(u+y));if(v>y+l)return!1;if(_<=g||v<=y)return!0;const w=_-g,C=v-y;return w*w+C*C<=l*l}}const nc=100;class aF{constructor(i,s,l=new tE(i.width+200,i.height+200,25),d=new tE(i.width+200,i.height+200,25)){this.transform=i,this.grid=l,this.ignoredGrid=d,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+nc,this.screenBottomBoundary=i.height+nc,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.fogState=s}placeCollisionBox(i,s,l,d,u,m,p,g){let _=l.projectedAnchorX,y=l.projectedAnchorY,v=l.projectedAnchorZ;const w=l.elevation,C=l.tileID,D=i.getProjection();if(w&&C){const[F,B,j]=D.upVector(C.canonical,l.tileAnchorX,l.tileAnchorY),U=D.upVectorScale(C.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;_+=F*w*U,y+=B*w*U,v+=j*w*U}const k=this.projectAndGetPerspectiveRatio(p,_,y,v,l.tileID,"globe"===D.name||!!w||this.transform.pitch>0,D),S=m*k.perspectiveRatio,E=(l.x1*s+d.x-l.padding)*S+k.point.x,A=(l.y1*s+d.y-l.padding)*S+k.point.y,P=(l.x2*s+d.x+l.padding)*S+k.point.x,O=(l.y2*s+d.y+l.padding)*S+k.point.y,R=k.perspectiveRatio<=.55||k.occluded;return!this.isInsideGrid(E,A,P,O)||!u&&this.grid.hitTest(E,A,P,O,g)||R?{box:[],offscreen:!1,occluded:k.occluded}:{box:[E,A,P,O],offscreen:this.isOffscreen(E,A,P,O),occluded:!1}}placeCollisionCircles(i,s,l,d,u,m,p,g,_,y,v,w,C,D,k){const S=[],E=this.transform.elevation,A=i.getProjection(),P=E?E.getAtTileOffsetFunc(k,this.transform.center.lat,this.transform.worldSize,A):null,O=new ot(l.tileAnchorX,l.tileAnchorY);let{x:R,y:F,z:B}=A.projectTilePoint(O.x,O.y,k.canonical);if(P){const[st,J,et]=P(O);R+=st,F+=J,B+=et}const j="globe"===A.name,U=this.projectAndGetPerspectiveRatio(p,R,F,B,k,j||!!E||this.transform.pitch>0,A),{perspectiveRatio:H}=U,W=(v?m/H:m*H)/so,q=hl(R,F,B,g),X=U.signedDistanceFromCamera>0?Ne(W,u,l.lineOffsetX*W,l.lineOffsetY*W,!1,q,O,l,d,g,{},E&&!v?P:null,v&&!!E,A,k,v):null;let G=!1,Q=!1,it=!0;if(X&&!U.occluded){const st=.5*C*H+D,J=new ot(-100,-100),et=new ot(this.screenRightBoundary,this.screenBottomBoundary),dt=new JT,{first:mt,last:ut}=X,bt=mt.path.length;let yt=[];for(let At=bt-1;At>=1;At--)yt.push(mt.path[At]);for(let At=1;At<ut.path.length;At++)yt.push(ut.path[At]);const Ct=2.5*st;_&&(yt=yt.map(([At,Gt,Et],te)=>(P&&!j&&(Et=P(te<bt-1?mt.tilePath[bt-1-te]:ut.tilePath[te-bt+2])[2]),hl(At,Gt,Et,_))),yt.some(At=>At[3]<=0)&&(yt=[]));let gt=[];if(yt.length>0){let At=1/0,Gt=-1/0,Et=1/0,te=-1/0;for(const ie of yt)At=Math.min(At,ie[0]),Et=Math.min(Et,ie[1]),Gt=Math.max(Gt,ie[0]),te=Math.max(te,ie[1]);Gt>=J.x&&At<=et.x&&te>=J.y&&Et<=et.y&&(gt=[yt.map(ie=>new ot(ie[0],ie[1]))],(At<J.x||Gt>et.x||Et<J.y||te>et.y)&&(gt=uy(gt,J.x,J.y,et.x,et.y)))}for(const At of gt){dt.reset(At,.25*st);let Gt=0;Gt=dt.length<=.5*st?1:Math.ceil(dt.paddedLength/Ct)+1;for(let Et=0;Et<Gt;Et++){const te=Et/Math.max(Gt-1,1),ie=dt.lerp(te),He=ie.x+nc,ve=ie.y+nc;S.push(He,ve,st,0);const Ui=He-st,xi=ve-st,$e=He+st,ze=ve+st;if(it=it&&this.isOffscreen(Ui,xi,$e,ze),Q=Q||this.isInsideGrid(Ui,xi,$e,ze),!s&&this.grid.hitTestCircle(He,ve,st,w)&&(G=!0,!y))return{circles:[],offscreen:!1,collisionDetected:G,occluded:!1}}}}return{circles:!y&&G||!Q?[]:S,offscreen:it,collisionDetected:G,occluded:U.occluded}}queryRenderedSymbols(i){if(0===i.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const s=[];let l=1/0,d=1/0,u=-1/0,m=-1/0;for(const y of i){const v=new ot(y.x+nc,y.y+nc);l=Math.min(l,v.x),d=Math.min(d,v.y),u=Math.max(u,v.x),m=Math.max(m,v.y),s.push(v)}const p=this.grid.query(l,d,u,m).concat(this.ignoredGrid.query(l,d,u,m)),g={},_={};for(const y of p){const v=y.key;void 0===g[v.bucketInstanceId]&&(g[v.bucketInstanceId]={}),g[v.bucketInstanceId][v.featureIndex]||Vx(s,[new ot(y.x1,y.y1),new ot(y.x2,y.y1),new ot(y.x2,y.y2),new ot(y.x1,y.y2)])&&(g[v.bucketInstanceId][v.featureIndex]=!0,void 0===_[v.bucketInstanceId]&&(_[v.bucketInstanceId]=[]),_[v.bucketInstanceId].push(v.featureIndex))}return _}insertCollisionBox(i,s,l,d,u){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:l,featureIndex:d,collisionGroupID:u},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,s,l,d,u){const m=s?this.ignoredGrid:this.grid,p={bucketInstanceId:l,featureIndex:d,collisionGroupID:u};for(let g=0;g<i.length;g+=4)m.insertCircle(p,i[g],i[g+1],i[g+2])}projectAndGetPerspectiveRatio(i,s,l,d,u,m,p){const g=[s,l,d,1];let _=!1;d||this.transform.pitch>0?(Qi.transformMat4(g,g,i),this.fogState&&u&&"globe"!==p.name&&(_=function(w,C,D,k,S,E){const A=E.calculateFogTileMatrix(S),P=[C,D,k];return Z.transformMat4(P,P,A),Ao(w,Z.length(P),E.pitch,E._fov)}(this.fogState,s,l,d,u.toUnwrapped(),this.transform)>.9)):Pw(g,g,i);const y=g[3];return{point:new ot((g[0]/y+1)/2*this.transform.width+nc,(-g[1]/y+1)/2*this.transform.height+nc),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(p)/y*.5,1.5),signedDistanceFromCamera:y,occluded:m&&g[2]>y||_}}isOffscreen(i,s,l,d){return l<nc||i>=this.screenRightBoundary||d<nc||s>this.screenBottomBoundary}isInsideGrid(i,s,l,d){return l>=0&&i<this.gridRightBoundary&&d>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const i=at.identity([]);return at.translate(i,i,[-100,-100,0]),i}}function Vg(o,i,s){const l=i.createTileMatrix(o,o.worldSize,s.toUnwrapped());return at.multiply(new Float32Array(16),o.projMatrix,l)}function lF(o,i,s){if(i.projection.name===s.projection.name)return o.projMatrix;const l=s.clone();return l.setProjection(i.projection),Vg(l,i.getProjection(),o)}function Vy(o,i,s){return i.name===s.projection.name?o.projMatrix:Vg(s,i,o)}class eE{constructor(i,s,l,d){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?s:-s))):d&&l?1:0,this.placed=l}isHidden(){return 0===this.opacity&&!this.placed}}class jg{constructor(i,s,l,d,u,m=!1){this.text=new eE(i?i.text:null,s,l,u),this.icon=new eE(i?i.icon:null,s,d,u),this.clipped=m}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class x1{constructor(i,s,l,d=!1){this.text=i,this.icon=s,this.skipFade=l,this.clipped=d}}class cF{constructor(){this.invProjMatrix=at.create(),this.viewportMatrix=at.create(),this.circles=[]}}class dF{constructor(i,s,l,d,u){this.bucketInstanceId=i,this.featureIndex=s,this.sourceLayerIndex=l,this.bucketIndex=d,this.tileID=u}}class uF{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const s=++this.maxGroupID;this.collisionGroups[i]={ID:s,predicate:l=>l.collisionGroupID===s}}return this.collisionGroups[i]}}function iE(o,i,s,l,d){const{horizontalAlign:u,verticalAlign:m}=dy(o),p=-(u-.5)*i,g=-(m-.5)*s,_=BS(o,l);return new ot(p+_[0]*d,g+_[1]*d)}function w1(o,i,s,l,d){const u=new ot(o,i);return s&&u._rotate(l?d:-d),u}class nE{constructor(i,s,l,d,u,m){this.transform=i.clone(),this.projection=i.projection.name,this.collisionIndex=new aF(this.transform,u),this.buildingIndex=m,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new uF(l),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,s,l,d){const u=l.getBucket(s),m=l.latestFeatureIndex;if(!u||!m||s.fqid!==u.layerIds[0])return;const p=u.layers[0].layout,g=l.collisionBoxArray,_=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),y=l.tileSize/pt,v=l.tileID.toUnwrapped();this.transform.setProjection(u.projection);const w=(C=l.tileID,D=u.getProjection(),k=this.transform,D.name===this.projection?k.calculateProjMatrix(C.toUnwrapped()):Vg(k,D,C));var C,D,k;const S="map"===p.get("text-pitch-alignment"),E="map"===p.get("text-rotation-alignment");s.compileFilter();const A=s.dynamicFilter(),P=s.dynamicFilterNeedsFeature(),O=this.transform.calculatePixelsToTileUnitsMatrix(l),R=Se(w,l.tileID.canonical,S,E,this.transform,u.getProjection(),O);let F=null;if(S){const U=kg(w,l.tileID.canonical,S,E,this.transform,u.getProjection(),O);F=at.multiply([],this.transform.labelPlaneMatrix,U)}let B=null;A&&l.latestFeatureIndex&&(B={unwrappedTileID:v,dynamicFilter:A,dynamicFilterNeedsFeature:P,featureIndex:l.latestFeatureIndex}),this.retainedQueryData[u.bucketInstanceId]=new dF(u.bucketInstanceId,m,u.sourceLayerIndex,u.index,l.tileID);const j={bucket:u,layout:p,posMatrix:w,textLabelPlaneMatrix:R,labelToScreenMatrix:F,clippingData:B,scale:_,textPixelRatio:y,holdingForFade:l.holdingForFade(),collisionBoxArray:g,partiallyEvaluatedTextSize:Xl(u.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:Xl(u.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(u.sourceID)};if(d)for(const U of u.sortKeyRanges){const{sortKey:H,symbolInstanceStart:W,symbolInstanceEnd:q}=U;i.push({sortKey:H,symbolInstanceStart:W,symbolInstanceEnd:q,parameters:j})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:u.symbolInstances.length,parameters:j})}attemptAnchorPlacement(i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E,A){const{textOffset0:P,textOffset1:O,crossTileID:R}=w,F=[P,O],B=iE(i,l,d,F,u),j=this.collisionIndex.placeCollisionBox(D,u,s,w1(B.x,B.y,m,p,this.transform.angle),v,g,_,y.predicate);if(S){const U=D.getSymbolInstanceIconSize(A,this.transform.zoom,w.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(D,U,S,w1(B.x,B.y,m,p,this.transform.angle),v,g,_,y.predicate).box.length)return}if(j.box.length>0){let U;return this.prevPlacement&&this.prevPlacement.variableOffsets[R]&&this.prevPlacement.placements[R]&&this.prevPlacement.placements[R].text&&(U=this.prevPlacement.variableOffsets[R].anchor),this.variableOffsets[R]={textOffset:F,width:l,height:d,anchor:i,textScale:u,prevAnchor:U},this.markUsedJustification(D,i,w,k),D.allowVerticalPlacement&&(this.markUsedOrientation(D,k,w),this.placedOrientations[R]=k),{shift:B,placedGlyphBoxes:j}}}placeLayerBucketPart(i,s,l,d){const{bucket:u,layout:m,posMatrix:p,textLabelPlaneMatrix:g,labelToScreenMatrix:_,clippingData:y,textPixelRatio:v,holdingForFade:w,collisionBoxArray:C,partiallyEvaluatedTextSize:D,partiallyEvaluatedIconSize:k,collisionGroup:S}=i.parameters,E=m.get("text-optional"),A=m.get("icon-optional"),P=m.get("text-allow-overlap"),O=m.get("icon-allow-overlap"),R="map"===m.get("text-rotation-alignment"),F="map"===m.get("text-pitch-alignment"),B="viewport-y"===m.get("symbol-z-order"),j=m.get("symbol-z-elevate");this.transform.setProjection(u.projection);let U=P&&(O||!u.hasIconData()||A),H=O&&(P||!u.hasTextData()||E);!u.collisionArrays&&C&&u.deserializeCollisionBoxes(C),l&&d&&u.updateCollisionDebugBuffers(this.transform.zoom,C);const W=(q,X,G)=>{const{crossTileID:Q,numVerticalGlyphVertices:it}=q;if(y){const $e={zoom:this.transform.zoom,pitch:this.transform.pitch};let ze=null;if(y.dynamicFilterNeedsFeature){const Ce=this.retainedQueryData[u.bucketInstanceId];ze=y.featureIndex.loadFeature({featureIndex:q.featureIndex,bucketIndex:Ce.bucketIndex,sourceLayerIndex:Ce.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,y.dynamicFilter)($e,ze,this.retainedQueryData[u.bucketInstanceId].tileID.canonical,new ot(q.tileAnchorX,q.tileAnchorY),this.transform.calculateDistanceTileData(y.unwrappedTileID)))return this.placements[Q]=new x1(!1,!1,!1,!0),void s.add(Q)}if(s.has(Q))return;if(w)return void(this.placements[Q]=new x1(!1,!1,!1));let st=!1,J=!1,et=!0,dt=!1,mt=!1,ut=null,bt={box:null,offscreen:null,occluded:null},yt={box:null,offscreen:null,occluded:null},Ct=null,gt=null,At=null,Gt=0,Et=0,te=0;G.textFeatureIndex?Gt=G.textFeatureIndex:q.useRuntimeCollisionCircles&&(Gt=q.featureIndex),G.verticalTextFeatureIndex&&(Et=G.verticalTextFeatureIndex);const ie=$e=>{$e.tileID=this.retainedQueryData[u.bucketInstanceId].tileID;const ze=this.transform.elevation;$e.elevation=q.zOffset+(ze?ze.getAtTileOffset($e.tileID,$e.tileAnchorX,$e.tileAnchorY):0)},He=G.textBox;if(He){ie(He);const $e=Ce=>{let wi=On.horizontal;if(u.allowVerticalPlacement&&!Ce&&this.prevPlacement){const Pi=this.prevPlacement.placedOrientations[Q];Pi&&(this.placedOrientations[Q]=Pi,wi=Pi,this.markUsedOrientation(u,wi,q))}return wi},ze=(Ce,wi)=>{if(u.allowVerticalPlacement&&it>0&&G.verticalTextBox){for(const Pi of u.writingModes)if(Pi===On.vertical?(bt=wi(),yt=bt):bt=Ce(),bt&&bt.box&&bt.box.length)break}else bt=Ce()};if(m.get("text-variable-anchor")){let Ce=m.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Q]){const ci=this.prevPlacement.variableOffsets[Q];Ce.indexOf(ci.anchor)>0&&(Ce=Ce.filter(Gi=>Gi!==ci.anchor),Ce.unshift(ci.anchor))}const wi=(ci,Gi,ir)=>{const tn=u.getSymbolInstanceTextSize(D,q,this.transform.zoom,X),Mn=(ci.x2-ci.x1)*tn+2*ci.padding,mr=(ci.y2-ci.y1)*tn+2*ci.padding,Zn=q.hasIconTextFit&&!O?Gi:null;Zn&&ie(Zn);let kn={box:[],offscreen:!1,occluded:!1};const Xi=P?2*Ce.length:Ce.length;for(let xo=0;xo<Xi;++xo){const $c=this.attemptAnchorPlacement(Ce[xo%Ce.length],ci,Mn,mr,tn,R,F,v,p,S,xo>=Ce.length,q,X,u,ir,Zn,D,k);if($c&&(kn=$c.placedGlyphBoxes,kn&&kn.box&&kn.box.length)){st=!0,ut=$c.shift;break}}return kn};ze(()=>wi(He,G.iconBox,On.horizontal),()=>{const ci=G.verticalTextBox;return ci&&ie(ci),u.allowVerticalPlacement&&!(bt&&bt.box&&bt.box.length)&&it>0&&ci?wi(ci,G.verticalIconBox,On.vertical):{box:null,offscreen:null,occluded:null}}),bt&&(st=bt.box,et=bt.offscreen,dt=bt.occluded);const Pi=$e(!(!bt||!bt.box));if(!st&&this.prevPlacement){const ci=this.prevPlacement.variableOffsets[Q];ci&&(this.variableOffsets[Q]=ci,this.markUsedJustification(u,ci.anchor,q,Pi))}}else{const Ce=(wi,Pi)=>{const ci=u.getSymbolInstanceTextSize(D,q,this.transform.zoom,X),Gi=this.collisionIndex.placeCollisionBox(u,ci,wi,new ot(0,0),P,v,p,S.predicate);return Gi&&Gi.box&&Gi.box.length&&(this.markUsedOrientation(u,Pi,q),this.placedOrientations[Q]=Pi),Gi};ze(()=>Ce(He,On.horizontal),()=>{const wi=G.verticalTextBox;return u.allowVerticalPlacement&&it>0&&wi?(ie(wi),Ce(wi,On.vertical)):{box:null,offscreen:null,occluded:null}}),$e(!!(bt&&bt.box&&bt.box.length))}}if(Ct=bt,st=Ct&&Ct.box&&Ct.box.length>0,et=Ct&&Ct.offscreen,dt=Ct&&Ct.occluded,q.useRuntimeCollisionCircles){const $e=u.text.placedSymbolArray.get(q.centerJustifiedTextSymbolIndex>=0?q.centerJustifiedTextSymbolIndex:q.verticalPlacedTextSymbolIndex),ze=Im(u.textSizeData,D,$e),Ce=m.get("text-padding");gt=this.collisionIndex.placeCollisionCircles(u,P,$e,u.lineVertexArray,u.glyphOffsetArray,ze,p,g,_,l,F,S.predicate,q.collisionCircleDiameter*ze/so,Ce,this.retainedQueryData[u.bucketInstanceId].tileID),st=P||gt.circles.length>0&&!gt.collisionDetected,et=et&&gt.offscreen,dt=gt.occluded}if(G.iconFeatureIndex&&(te=G.iconFeatureIndex),G.iconBox){const $e=ze=>{ie(ze);const Ce=q.hasIconTextFit&&ut?w1(ut.x,ut.y,R,F,this.transform.angle):new ot(0,0),wi=u.getSymbolInstanceIconSize(k,this.transform.zoom,q.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(u,wi,ze,Ce,O,v,p,S.predicate)};yt&&yt.box&&yt.box.length&&G.verticalIconBox?(At=$e(G.verticalIconBox),J=At.box.length>0):(At=$e(G.iconBox),J=At.box.length>0),et=et&&At.offscreen,mt=At.occluded}const ve=E||0===q.numHorizontalGlyphVertices&&0===it,Ui=A||0===q.numIconVertices;if(ve||Ui?Ui?ve||(J=J&&st):st=J&&st:J=st=J&&st,st&&Ct&&Ct.box&&this.collisionIndex.insertCollisionBox(Ct.box,m.get("text-ignore-placement"),u.bucketInstanceId,yt&&yt.box&&Et?Et:Gt,S.ID),J&&At&&this.collisionIndex.insertCollisionBox(At.box,m.get("icon-ignore-placement"),u.bucketInstanceId,te,S.ID),gt&&(st&&this.collisionIndex.insertCollisionCircles(gt.circles,m.get("text-ignore-placement"),u.bucketInstanceId,Gt,S.ID),l)){const $e=u.bucketInstanceId;let ze=this.collisionCircleArrays[$e];void 0===ze&&(ze=this.collisionCircleArrays[$e]=new cF);for(let Ce=0;Ce<gt.circles.length;Ce+=4)ze.circles.push(gt.circles[Ce+0]),ze.circles.push(gt.circles[Ce+1]),ze.circles.push(gt.circles[Ce+2]),ze.circles.push(gt.collisionDetected?1:0)}const xi="globe"!==u.projection.name;U=U&&(xi||!dt),H=H&&(xi||!mt),this.placements[Q]=new x1(st||U,J||H,et||u.justReloaded),s.add(Q)};if(j&&this.buildingIndex&&(this.buildingIndex.updateZOffset(u,this.retainedQueryData[u.bucketInstanceId].tileID),u.updateZOffset()),B){const q=u.getSortedSymbolIndexes(this.transform.angle);for(let X=q.length-1;X>=0;--X){const G=q[X];W(u.symbolInstances.get(G),G,u.collisionArrays[G])}u.hasAnyZOffset&&rt(`${u.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(u.hasAnyZOffset){const q=u.getSortedIndexesByZOffset();for(let X=0;X<q.length;++X){const G=q[X];W(u.symbolInstances.get(G),G,u.collisionArrays[G])}}else for(let q=i.symbolInstanceStart;q<i.symbolInstanceEnd;q++)W(u.symbolInstances.get(q),q,u.collisionArrays[q]);if(l&&u.bucketInstanceId in this.collisionCircleArrays){const q=this.collisionCircleArrays[u.bucketInstanceId];at.invert(q.invProjMatrix,p),q.viewportMatrix=this.collisionIndex.getViewportMatrix()}u.justReloaded=!1}markUsedJustification(i,s,l,d){const{leftJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:m,rightJustifiedTextSymbolIndex:p,verticalPlacedTextSymbolIndex:g,crossTileID:_}=l,y=py(s),v=d===On.vertical?g:"left"===y?u:"center"===y?m:"right"===y?p:-1;u>=0&&(i.text.placedSymbolArray.get(u).crossTileID=v>=0&&u!==v?0:_),m>=0&&(i.text.placedSymbolArray.get(m).crossTileID=v>=0&&m!==v?0:_),p>=0&&(i.text.placedSymbolArray.get(p).crossTileID=v>=0&&p!==v?0:_),g>=0&&(i.text.placedSymbolArray.get(g).crossTileID=v>=0&&g!==v?0:_)}markUsedOrientation(i,s,l){const d=s===On.horizontal||s===On.horizontalOnly?s:0,u=s===On.vertical?s:0,{leftJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:p,rightJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:_}=l,y=i.text.placedSymbolArray;m>=0&&(y.get(m).placedOrientation=d),p>=0&&(y.get(p).placedOrientation=d),g>=0&&(y.get(g).placedOrientation=d),_>=0&&(y.get(_).placedOrientation=u)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let l=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const d=s?s.symbolFadeChange(i):1,u=s?s.opacities:{},m=s?s.variableOffsets:{},p=s?s.placedOrientations:{};for(const g in this.placements){const _=this.placements[g],y=u[g];y?(this.opacities[g]=new jg(y,d,_.text,_.icon,null,_.clipped),l=l||_.text!==y.text.placed||_.icon!==y.icon.placed):(this.opacities[g]=new jg(null,d,_.text,_.icon,_.skipFade,_.clipped),l=l||_.text||_.icon)}for(const g in u){const _=u[g];if(!this.opacities[g]){const y=new jg(_,d,!1,!1);y.isHidden()||(this.opacities[g]=y,l=l||_.text.placed||_.icon.placed)}}for(const g in m)this.variableOffsets[g]||!this.opacities[g]||this.opacities[g].isHidden()||(this.variableOffsets[g]=m[g]);for(const g in p)this.placedOrientations[g]||!this.opacities[g]||this.opacities[g].isHidden()||(this.placedOrientations[g]=p[g]);l?this.lastPlacementChangeTime=i:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:i)}updateLayerOpacities(i,s){const l=new Set;for(const d of s){const u=d.getBucket(i);u&&d.latestFeatureIndex&&i.fqid===u.layerIds[0]&&(this.updateBucketOpacities(u,l,d.collisionBoxArray),u.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(u,d.tileID),u.updateZOffset()))}}updateBucketOpacities(i,s,l){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const d=i.layers[0].layout,u=!!i.layers[0].dynamicFilter(),m=new jg(null,0,!1,!1,!0),p=d.get("text-allow-overlap"),g=d.get("icon-allow-overlap"),_=d.get("text-variable-anchor"),y="map"===d.get("text-rotation-alignment"),v="map"===d.get("text-pitch-alignment"),w=new jg(null,0,p&&(g||!i.hasIconData()||d.get("icon-optional")),g&&(p||!i.hasTextData()||d.get("text-optional")),!0);!i.collisionArrays&&l&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(l);const C=(k,S,E)=>{for(let A=0;A<S/4;A++)k.opacityVertexArray.emplaceBack(E)};let D=0;for(let k=0;k<i.symbolInstances.length;k++){const S=i.symbolInstances.get(k),{numHorizontalGlyphVertices:E,numVerticalGlyphVertices:A,crossTileID:P,numIconVertices:O}=S,R=s.has(P);let F=this.opacities[P];R?F=m:F||(F=w,this.opacities[P]=F),s.add(P);const B=E>0||A>0,j=O>0,U=this.placedOrientations[P],H=U===On.vertical,W=U===On.horizontal||U===On.horizontalOnly;if(!B&&!j||F.isHidden()||D++,B){const q=jy(F.text);C(i.text,E,H?up:q),C(i.text,A,W?up:q);const X=F.text.isHidden(),{leftJustifiedTextSymbolIndex:G,centerJustifiedTextSymbolIndex:Q,rightJustifiedTextSymbolIndex:it,verticalPlacedTextSymbolIndex:st}=S,J=i.text.placedSymbolArray,et=X||H?1:0;G>=0&&(J.get(G).hidden=et),Q>=0&&(J.get(Q).hidden=et),it>=0&&(J.get(it).hidden=et),st>=0&&(J.get(st).hidden=X||W?1:0);const dt=this.variableOffsets[P];dt&&this.markUsedJustification(i,dt.anchor,S,U);const mt=this.placedOrientations[P];mt&&(this.markUsedJustification(i,"left",S,mt),this.markUsedOrientation(i,mt,S))}if(j){const q=jy(F.icon),{placedIconSymbolIndex:X,verticalPlacedIconSymbolIndex:G}=S,Q=i.icon.placedSymbolArray,it=F.icon.isHidden()?1:0;X>=0&&(C(i.icon,O,H?up:q),Q.get(X).hidden=it),G>=0&&(C(i.icon,S.numVerticalIconVertices,W?up:q),Q.get(G).hidden=it)}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const q=i.collisionArrays[k];if(q){let X=new ot(0,0),G=!0;if(q.textBox||q.verticalTextBox){if(_){const it=this.variableOffsets[P];it?(X=iE(it.anchor,it.width,it.height,it.textOffset,it.textScale),y&&X._rotate(v?this.transform.angle:-this.transform.angle)):G=!1}u&&(G=!F.clipped),q.textBox&&Ug(i.textCollisionBox.collisionVertexArray,F.text.placed,!G||H,X.x,X.y),q.verticalTextBox&&Ug(i.textCollisionBox.collisionVertexArray,F.text.placed,!G||W,X.x,X.y)}const Q=G&&!(W||!q.verticalIconBox);q.iconBox&&Ug(i.iconCollisionBox.collisionVertexArray,F.icon.placed,Q,S.hasIconTextFit?X.x:0,S.hasIconTextFit?X.y:0),q.verticalIconBox&&Ug(i.iconCollisionBox.collisionVertexArray,F.icon.placed,!Q,S.hasIconTextFit?X.x:0,S.hasIconTextFit?X.y:0)}}}if(i.fullyClipped=0===D,i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){const k=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=k.invProjMatrix,i.placementViewportMatrix=k.viewportMatrix,i.collisionCircleArray=k.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return 0===this.fadeDuration?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,s){const l=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*l>i}setStale(){this.stale=!0}}function Ug(o,i,s,l,d){o.emplaceBack(i?1:0,s?1:0,l||0,d||0),o.emplaceBack(i?1:0,s?1:0,l||0,d||0),o.emplaceBack(i?1:0,s?1:0,l||0,d||0),o.emplaceBack(i?1:0,s?1:0,l||0,d||0)}const hF=Math.pow(2,25),mF=Math.pow(2,24),rE=Math.pow(2,17),pF=Math.pow(2,16),fF=Math.pow(2,9),gF=Math.pow(2,8),_F=Math.pow(2,1);function jy(o){if(0===o.opacity&&!o.placed)return 0;if(1===o.opacity&&o.placed)return 4294967295;const i=o.placed?1:0,s=Math.floor(127*o.opacity);return s*hF+i*mF+s*rE+i*pF+s*fF+i*gF+s*_F+i}const up=0;class oE{constructor(i){this._sortAcrossTiles="viewport-y"!==i.layout.get("symbol-z-order")&&void 0!==i.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(i,s,l,d,u){const m=this._bucketParts;for(;this._currentTileIndex<i.length;)if(s.getBucketParts(m,d,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,u())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,m.sort((p,g)=>p.sortKey-g.sortKey));this._currentPartIndex<m.length;){const p=m[this._currentPartIndex];if(s.placeLayerBucketPart(p,this._seenCrossTileIDs,l,0===p.symbolInstanceStart),this._currentPartIndex++,u())return!0}return!1}}class C1{constructor(i,s,l,d,u,m,p,g,_){this.placement=new nE(i,u,m,p,g,_),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=d,this._done=!1}isDone(){return this._done}continuePlacement(i,s,l,d){const u=Ze.now(),m=()=>{const p=Ze.now()-u;return!this._forceFullPlacement&&p>2};for(;this._currentPlacementIndex>=0;){const p=s[i[this._currentPlacementIndex]],g=this.placement.collisionIndex.transform.zoom;if("symbol"===p.type&&(!p.minzoom||p.minzoom<=g)&&(!p.maxzoom||p.maxzoom>g)){const _=p,y=_.layout.get("symbol-z-elevate"),v=this._inProgressLayer=this._inProgressLayer||new oE(_),w=So(p.source,p.scope);if(v.continuePlacement(y?d[w]:l[w],this.placement,this._showCollisionBoxes,p,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const sE=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Uy{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,l]=new Uint8Array(i,0,2);if(219!==s)throw new Error("Data does not appear to be in a KDBush format.");const d=l>>4;if(1!==d)throw new Error(`Got v${d} data when expected v1.`);const u=sE[15&l];if(!u)throw new Error("Unrecognized array type.");const[m]=new Uint16Array(i,2,1),[p]=new Uint32Array(i,4,1);return new Uy(p,m,u,i)}constructor(i,s=64,l=Float64Array,d){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=l,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const u=sE.indexOf(this.ArrayType),m=2*i*this.ArrayType.BYTES_PER_ELEMENT,p=i*this.IndexArrayType.BYTES_PER_ELEMENT,g=(8-p%8)%8;if(u<0)throw new Error(`Unexpected typed array class: ${l}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+p+g,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+m+p+g),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+p+g,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+u]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=i)}add(i,s){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=i,this.coords[this._pos++]=s,l}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return Hg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,s,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:m,nodeSize:p}=this,g=[0,u.length-1,0],_=[];for(;g.length;){const y=g.pop()||0,v=g.pop()||0,w=g.pop()||0;if(v-w<=p){for(let S=w;S<=v;S++){const E=m[2*S],A=m[2*S+1];E>=i&&E<=l&&A>=s&&A<=d&&_.push(u[S])}continue}const C=w+v>>1,D=m[2*C],k=m[2*C+1];D>=i&&D<=l&&k>=s&&k<=d&&_.push(u[C]),(0===y?i<=D:s<=k)&&(g.push(w),g.push(C-1),g.push(1-y)),(0===y?l>=D:d>=k)&&(g.push(C+1),g.push(v),g.push(1-y))}return _}within(i,s,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:u,nodeSize:m}=this,p=[0,d.length-1,0],g=[],_=l*l;for(;p.length;){const y=p.pop()||0,v=p.pop()||0,w=p.pop()||0;if(v-w<=m){for(let S=w;S<=v;S++)M1(u[2*S],u[2*S+1],i,s)<=_&&g.push(d[S]);continue}const C=w+v>>1,D=u[2*C],k=u[2*C+1];M1(D,k,i,s)<=_&&g.push(d[C]),(0===y?i-l<=D:s-l<=k)&&(p.push(w),p.push(C-1),p.push(1-y)),(0===y?i+l>=D:s+l>=k)&&(p.push(C+1),p.push(v),p.push(1-y))}return g}}function Hg(o,i,s,l,d,u){if(d-l<=s)return;const m=l+d>>1;aE(o,i,m,l,d,u),Hg(o,i,s,l,m-1,1-u),Hg(o,i,s,m+1,d,1-u)}function aE(o,i,s,l,d,u){for(;d>l;){if(d-l>600){const _=d-l+1,y=s-l+1,v=Math.log(_),w=.5*Math.exp(2*v/3),C=.5*Math.sqrt(v*w*(_-w)/_)*(y-_/2<0?-1:1);aE(o,i,s,Math.max(l,Math.floor(s-y*w/_+C)),Math.min(d,Math.floor(s+(_-y)*w/_+C)),u)}const m=i[2*s+u];let p=l,g=d;for(Te(o,i,l,s),i[2*d+u]>m&&Te(o,i,l,d);p<g;){for(Te(o,i,p,g),p++,g--;i[2*p+u]<m;)p++;for(;i[2*g+u]>m;)g--}i[2*l+u]===m?Te(o,i,l,g):(g++,Te(o,i,g,d)),g<=s&&(l=g+1),s<=g&&(d=g-1)}}function Te(o,i,s,l){jc(o,s,l),jc(i,2*s,2*l),jc(i,2*s+1,2*l+1)}function jc(o,i,s){const l=o[i];o[i]=o[s],o[s]=l}function M1(o,i,s,l){const d=o-s,u=i-l;return d*d+u*u}const D1=512/pt/2;class sV{constructor(i,s,l){this.tileID=i,this.bucketInstanceId=l,this.index=new Uy(s.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const d=i.canonical.x*pt,u=i.canonical.y*pt;for(let m=0;m<s.length;m++){const{key:p,crossTileID:g,tileAnchorX:_,tileAnchorY:y}=s.get(m),v=Math.floor((d+_)*D1),w=Math.floor((u+y)*D1);this.index.add(v,w),this.keys.push(p),this.crossTileIDs.push(g)}this.index.finish()}findMatches(i,s,l){const d=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),u=D1/Math.pow(2,s.canonical.z-this.tileID.canonical.z),m=s.canonical.x*pt,p=s.canonical.y*pt;for(let g=0;g<i.length;g++){const _=i.get(g);if(_.crossTileID)continue;const{key:y,tileAnchorX:v,tileAnchorY:w}=_,C=Math.floor((m+v)*u),D=Math.floor((p+w)*u),k=this.index.range(C-d,D-d,C+d,D+d);for(const S of k){const E=this.crossTileIDs[S];if(this.keys[S]===y&&!l.has(E)){l.add(E),_.crossTileID=E;break}}}}}class k1{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class S1{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const s=Math.round((i-this.lng)/360);if(0!==s)for(const l in this.indexes){const d=this.indexes[l],u={};for(const m in d){const p=d[m];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+s),u[p.tileID.key]=p}this.indexes[l]=u}this.lng=i}addBucket(i,s,l){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let u=0;u<s.symbolInstances.length;u++)s.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]=new Set);const d=this.usedCrossTileIDs[i.overscaledZ];for(const u in this.indexes){const m=this.indexes[u];if(Number(u)>i.overscaledZ)for(const p in m){const g=m[p];g.tileID.isChildOf(i)&&g.findMatches(s.symbolInstances,i,d)}else{const p=m[i.scaledTo(Number(u)).key];p&&p.findMatches(s.symbolInstances,i,d)}}for(let u=0;u<s.symbolInstances.length;u++){const m=s.symbolInstances.get(u);m.crossTileID||(m.crossTileID=l.generate(),d.add(m.crossTileID))}return void 0===this.indexes[i.overscaledZ]&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new sV(i,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(i,s){for(const l of s.crossTileIDs)this.usedCrossTileIDs[i].delete(l)}removeStaleBuckets(i){let s=!1;for(const l in this.indexes){const d=this.indexes[l];for(const u in d)i[d[u].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,d[u]),delete d[u],s=!0)}return s}}class bF{constructor(){this.layerIndexes={},this.crossTileIDs=new k1,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,s,l,d){let u=this.layerIndexes[i.fqid];void 0===u&&(u=this.layerIndexes[i.fqid]=new S1);let m=!1;const p={};"globe"!==d.name&&u.handleWrapJump(l);for(const g of s){const _=g.getBucket(i);_&&i.fqid===_.layerIds[0]&&(_.bucketInstanceId||(_.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(g.tileID,_,this.crossTileIDs)&&(m=!0),p[_.bucketInstanceId]=!0)}return u.removeStaleBuckets(p)&&(m=!0),m}pruneUnusedLayers(i){const s={};i.forEach(l=>{s[l]=!0});for(const l in this.layerIndexes)s[l]||delete this.layerIndexes[l]}}var T1="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef RENDER_CUTOFF\nfloat cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w-0.0001;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}\n#endif",Hy="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",lE="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",E1="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",$y="highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {\n#ifdef FOG_DITHERING\nvec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);\n#else\nreturn color;\n#endif\n}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",A1="#ifdef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);vec4 _raTexLinearCoord(vec2 texCoord,vec2 texResolution,out vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return (texCoord.xxyy+vec2(1.5,0.5).xyxy)/texResolution.xxyy;}vec2 _raTexLinearMix(vec2 fxy,vec4 colorMix,float colorOffset,vec4 t00,vec4 t10,vec4 t01,vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image0,c.yz),texture(u_image0,c.xz),texture(u_image0,c.yw),texture(u_image0,c.xw)\n);}vec2 raTexture2D_image1_linear(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image1,c.yz),texture(u_image1,c.xz),texture(u_image1,c.yw),texture(u_image1,c.xw)\n);}vec2 raTexture2D_image0_nearest(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec4 t=texture(u_image0,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec4 t=texture(u_image1,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}\n#endif",I1="#ifdef RENDER_SHADOWS\nuniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}\n#endif//RENDER_SHADOWS",R1="#ifdef RENDER_SHADOWS\n#ifdef DEPTH_TEXTURE\nuniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;\n#else\nuniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;\n#endif\nuniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_1,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_0,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;\n#ifdef NATIVE\nhighp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));\n#else\nhighp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(\nshadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)\n);\n#endif\nvec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {\n#ifdef SHADOWS_SINGLE_CASCADE\nlight_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);\n#else\nlight_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));\n#endif\n}highp float calculate_shadow_bias(float NDotL) {\n#ifdef NORMAL_OFFSET\nreturn 0.5*u_shadow_bias.x;\n#else\nreturn 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));\n#endif\n}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}\n#endif";const P1=[];F1(T1,P1);const Gy={"_prelude_fog.vertex.glsl":E1,"_prelude_terrain.vertex.glsl":lE,"_prelude_shadow.vertex.glsl":I1,"_prelude_fog.fragment.glsl":$y,"_prelude_shadow.fragment.glsl":R1,"_prelude_lighting.glsl":"\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}\n#endif//LIGHTING_3D_MODE","_prelude_raster_array.glsl":A1},Wy={};Ji("",lE),Ji($y,E1),Ji(R1,I1),Ji(A1,"");const cE=Ji("\nout vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#ifdef INDICATOR_CUTOUT\nuniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;\n#endif\nvec4 applyCutout(vec4 color) {\n#ifdef INDICATOR_CUTOUT\nfloat holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);\n#else\nreturn color;\n#endif\n}\n#ifdef DEBUG_WIREFRAME\n#define HANDLE_WIREFRAME_DEBUG \\\nglFragColor=vec4(0.7,0.0,0.0,0.7); \\\ngl_FragDepth=gl_FragCoord.z-0.0001;\n#else\n#define HANDLE_WIREFRAME_DEBUG\n#endif\n#ifdef RENDER_CUTOFF\nuniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;\n#endif","\n#define EXTENT 8192.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}\n#ifdef RENDER_CUTOFF\nuniform vec4 u_cutoff_params;out float v_cutoff_opacity;\n#endif\nconst vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}"),dE=T1;var O1={background:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nin vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),backgroundPattern:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),circle:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\nglFragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}'),clippingMask:Ji("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ji('#include "_prelude_fog.fragment.glsl"\nuniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),heatmapTexture:Ji("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(0.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}","in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ji("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",'#include "_prelude_terrain.vertex.glsl"\nin vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}'),collisionCircle:Ji("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}","in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ji("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",'#include "_prelude_terrain.vertex.glsl"\nin vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;\n#endif\nout vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}'),fill:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutline:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutlinePattern:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in vec2 v_pos;in vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;out vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillPattern:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillExtrusion:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec4 v_color;in vec4 v_flat;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;\n#endif\nuniform lowp float u_opacity;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec2 v_ao;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nin vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nin highp vec3 v_normal;\n#endif\nuniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nin float v_flood_radius;in float v_has_floodlight;\n#endif\nuniform float u_emissive_strength;in float v_height;void main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nvec3 normal=normalize(v_normal);\n#endif\nfloat z;vec4 color=v_color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);\n#ifdef LIGHTING_3D_MODE\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#else\ncolor=mix(v_color,v_roof_color,z);\n#endif\n#endif\nfloat h=max(0.0,v_height);float ao_shade=1.0;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\ncolor.rgb*=mix(ao_shade,1.0,v_has_floodlight);\n#else\ncolor.rgb*=ao_shade;\n#endif\n#else\ncolor.rgb*=ao_shade;\n#endif\n#endif\n#ifdef LIGHTING_3D_MODE\nfloat flood_radiance=0.0;\n#ifdef FLOOD_LIGHT\nflood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef FLOOD_LIGHT\nfloat ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);\n#else\nfloat shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);\n#endif\n#else\ncolor.rgb=apply_lighting(color.rgb,normal);\n#ifdef FLOOD_LIGHT\ncolor.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);\n#endif\n#endif\ncolor.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));\n#endif\n#ifdef RENDER_CUTOFF\ncolor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_lighting.glsl"\n#ifdef RENDER_CUTOFF\ninvariant gl_Position;\n#endif\nuniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nuniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nout vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nout highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec2 v_ao;\n#endif\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nout float v_flood_radius;out float v_has_floodlight;\n#endif\nout float v_height;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define highp float flood_light_wall_radius\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize highp float flood_light_wall_radius\nbase*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);h=h-ele;v_height=h;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=pos;vec3 shd_pos1=pos;\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifndef LIGHTING_3D_MODE\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#endif\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\nfloat is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;\n#endif\nv_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);\n#else\nv_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),fillExtrusionDepth:Ji("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\nout highp float v_depth;void main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\nbase*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nvec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);\n#else\npos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}'),fillExtrusionPattern:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nin vec3 v_normal;\n#endif\nin vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nout vec2 v_pos;out vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nout vec3 v_normal;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_normal=normal;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}'),groundShadow:Ji('#include "_prelude_shadow.fragment.glsl"\nprecision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\nvoid main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);\n#ifdef RENDER_CUTOFF\nshadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,v_depth));\n#endif\n#ifdef FOG\nshadow=mix(shadow,vec3(1.0),v_fog_opacity);\n#endif\n#ifdef INDICATOR_CUTOUT\nshadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);\n#endif\nglFragColor=vec4(shadow,1.0);}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);\n#endif\n}'),fillExtrusionGroundEffect:Ji("uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;\n#ifdef SDF_SUBPASS\nin highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}\n#ifdef FOG\nin highp float v_fog;\n#endif\n#endif\nvoid main() {\n#ifdef CLEAR_SUBPASS\nvec4 color=vec4(1.0);\n#ifdef CLEAR_FROM_TEXTURE\ncolor=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));\n#endif\nglFragColor=color;\n#else\n#ifdef SDF_SUBPASS\nhighp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;\n#ifdef FOG\nfog=v_fog;\n#endif\n#ifdef RENDER_CUTOFF\nfog*=v_cutoff_opacity;\n#endif\nglFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));\n#else\nvec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);\n#ifdef OVERDRAW_INSPECTOR\ncolor=vec4(1.0);\n#endif\nglFragColor=color;HANDLE_WIREFRAME_DEBUG;\n#endif\n#endif\n}",'#include "_prelude_fog.vertex.glsl"\nin highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;\n#ifdef SDF_SUBPASS\nout highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;\n#ifdef FOG\nout highp float v_fog;\n#endif\n#endif\nuniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;\n#pragma mapbox: define highp float flood_light_ground_radius\nconst float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {\n#pragma mapbox: initialize highp float flood_light_ground_radius\nvec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;\n#ifdef FORCE_ABS_FL_GROUND_RADIUS\nfl_ground_radius=abs(flood_light_ground_radius);\n#endif\nfloat flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;\n#ifdef SDF_SUBPASS\nv_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);\n#ifdef FOG\nv_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);\n#endif\n#endif\nfloat hidden_by_landmark=0.0;\n#ifdef HAS_CENTROID\nhidden_by_landmark=a_hidden_by_landmark;\n#endif\nfloat isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),hillshadePrepare:Ji("precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\nglFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);\n#endif\n#ifdef FOG\nglFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),line:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;in vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nfloat luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\nif (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    \nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#define EXTRUDE_SCALE 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nin highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nin float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),linePattern:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting_ground(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;in float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),raster:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_raster_array.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;\n#ifndef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;\n#endif\n#ifdef RASTER_COLOR\nuniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;\n#endif\nvoid main() {vec4 color0,color1,color;vec2 value;\n#ifdef RASTER_COLOR\n#ifdef RASTER_ARRAY\n#ifdef RASTER_ARRAY_LINEAR\nvalue=mix(\nraTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#else\nvalue=mix(\nraTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#endif\nif (value.y > 0.0) value.x/=value.y;\n#else\ncolor=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);\n#endif\ncolor=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;\n#else\ncolor0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);\n#endif\ncolor.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef RENDER_CUTOFF\nglFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform vec4 u_tl_br;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#elif defined(PROJECTION_GLOBE_VIEW)\nin vec2 a_pos;\n#else\nin vec2 a_pos;in vec2 a_texture_pos;\n#endif\nout vec2 v_pos0;out vec2 v_pos1;out float v_depth;void main() {vec2 uv;\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);\n#endif\n#else\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec2 globe_tl=vec2(u_tl_br.x,u_tl_br.y);vec2 globe_br=vec2(u_tl_br.z,u_tl_br.w);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=1.0-((mercatorY-globe_br.y)/(globe_tl.y-globe_br.y));float mercatorX=mercatorXfromLng(latLng[1]);float uvX=(mercatorX-globe_br.x)/(globe_tl.x-globe_br.x);vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);uv=vec2(uvX,uvY);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\nfloat w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\nuv=a_texture_pos/8192.0;\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;\n#ifdef RENDER_CUTOFF\nv_depth=gl_Position.z;\n#endif\n}'),symbolIcon:Ji('#include "_prelude_lighting.glsl"\nuniform sampler2D u_texture;\n#ifdef ICON_TRANSITION\nuniform float u_icon_transition;\n#endif\nin float v_fade_opacity;in vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nin vec2 v_tex_b;\n#endif\nuniform mediump float u_icon_saturation;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nlowp float alpha=opacity*v_fade_opacity;vec4 out_color;\n#ifdef ICON_TRANSITION\nvec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;\n#else\nout_color=texture(u_texture,v_tex_a)*alpha;\n#endif\n#ifdef SATURATION\nvec3 luma=vec3(dot(out_color.rgb,vec3(0.2126,0.7152,0.0722)));out_color.rgb=mix(luma,out_color.rgb,u_icon_saturation);\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef ICON_TRANSITION\nin vec2 a_texb;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nout vec2 v_tex_b;\n#endif\nout float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nv_tex_a=a_tex/u_texsize;\n#ifdef ICON_TRANSITION\nv_tex_b=a_texb/u_texsize;\n#endif\nv_fade_opacity=out_fade_opacity;}'),symbolSDF:Ji('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\nuniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}'),symbolTextAndIcon:Ji('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nfloat out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}'),terrainRaster:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;\n#endif\nuniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;\n#ifdef LIGHTING_3D_MODE\nconst vec3 normal=vec3(0.0,0.0,1.0);\n#ifdef RENDER_SHADOWS\nfloat cutoffOpacity=1.0;\n#ifdef RENDER_CUTOFF\ncutoffOpacity=cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nvec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;\n#else\nfloat lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));\n#endif\n#else\nfloat lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;\n#endif\n#endif\n#else\ncolor=image_color;\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#endif\nvoid main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}'),terrainDepth:Ji("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}'),skybox:Ji('#include "_prelude_fog.fragment.glsl"\nin lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Hy),skyboxGradient:Ji('#include "_prelude_fog.fragment.glsl"\nin highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Hy),skyboxCapture:Ji("\nin highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}","in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nraster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);\n#else\nraster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;\n#else\ncolor=apply_lighting_ground(color);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;\n#endif\nout vec2 v_pos0;void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);globe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}'),globeAtmosphere:Ji('#include "_prelude_fog.fragment.glsl"\nuniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {\n#ifdef ALPHA_PASS\nglFragColor=vec4(0,0,0,0);return;\n#else\n#ifdef NATIVE\nglFragColor=vec4(1,1,1,1);\n#else\nglFragColor=vec4(0,0,0,1);\n#endif\nreturn;\n#endif\n}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;\n#ifdef ALPHA_PASS\nfloat a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);\n#else\nvec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;\n#ifndef NATIVE\nc=dither(c,gl_FragCoord.xy+u_temporal_offset);\n#endif\nglFragColor=vec4(c*t,t);\n#endif\n}',"in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}"),model:Ji('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;\n#endif\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#ifdef HAS_ATTRIBUTE_a_pbr\nin lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;\n#endif\n#ifdef HAS_TEXTURE_u_baseColorTexture\nuniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;\n#endif\n#ifdef HAS_TEXTURE_u_metallicRoughnessTexture\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\n#ifdef HAS_TEXTURE_u_occlusionTexture\nuniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;\n#endif\n#ifdef HAS_TEXTURE_u_normalTexture\nuniform sampler2D u_normalTexture;\n#endif\n#ifdef HAS_TEXTURE_u_emissionTexture\nuniform sampler2D u_emissionTexture;\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nin highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}\n#endif\n#define saturate(_x) clamp(_x,0.,1.)\nvec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)\n{\n#ifdef LIGHTING_3D_MODE\nvec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));\n#endif\nreturn apply_lighting(albedo,transformed_normal,lighting_factor);\n#else\nvec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;\n#endif\n}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;\n#ifdef HAS_ATTRIBUTE_a_color_3f\nalbedo*=vec4(color_3f,1.0);\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#else\n#ifdef HAS_ATTRIBUTE_a_color_4f\nalbedo*=color_4f;\n#endif\n#endif\n#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)\nvec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}\n#ifdef UNPREMULT_TEXTURE_IN_SHADER\nif(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;\n#endif\ntexColor.rgb=sRGBToLinear(texColor.rgb);if(u_baseTextureIsAlpha) {if (texColor.w < 0.5) {discard;}albedo*=mix(vec4(texColor.rgb,texColor.a),vec4(texColor.a),float(u_baseTextureIsAlpha));} else {albedo*=texColor;}\n#endif\nreturn vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {\n#ifdef HAS_TEXTURE_u_normalTexture\nhighp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;\n#else\nreturn mat3(1.0);\n#endif\n}highp vec3 getNormal(){highp vec3 n;\n#ifdef HAS_ATTRIBUTE_a_normal_3f\nn=normalize(normal_3f);\n#else\nhighp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;\n#endif\n#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nvec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);\n#endif\nreturn n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;\n#ifdef HAS_ATTRIBUTE_a_pbr\nmat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;\n#endif\n#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) \nvec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;\n#endif\nconst float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)\n{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)\n{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)\n{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)\n{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)\n{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)\n{\n#ifdef LIGHTING_3D_MODE\nreturn mat.diffuseColor;\n#else\nreturn mat.diffuseColor/PI;\n#endif\n}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)\n{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)\n{vec3 env_light=vec3(0.65,0.65,0.65);\n#ifdef LIGHTING_3D_MODE\nfloat ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;\n#endif\nvec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)\n{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=NdotL;\n#endif\nvec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;\n#if !defined(LIGHTING_3D_MODE)\nconst vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);\n#endif\ncolor*=intensityFactor;return color;}void main() {\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nif (isOccluded()) {discard;}\n#endif\nvec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;\n#ifdef LIGHTING_3D_MODE\nlightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;\n#endif\nvec4 finalColor;\n#ifdef DIFFUSE_SHADED\nvec3 N=getNormal();vec3 diffuse=getDiffuseShadedColor(getBaseColor().rgb,N,lightDir,lightColor);\n#ifdef HAS_TEXTURE_u_occlusionTexture\nfloat ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;\n#endif\nfinalColor=vec4(diffuse,1.0)*u_opacity;\n#else\nMaterial mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;\n#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nao=(texture(u_occlusionTexture,uv_2f).x-1.0)*u_aoIntensity+1.0;color*=ao;\n#endif\nvec4 emissive=u_emissiveFactor;\n#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nemissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);\n#endif\ncolor+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;\n#ifdef HAS_ATTRIBUTE_a_pbr\nfloat resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));\n#ifdef HAS_ATTRIBUTE_a_color_4f\nfloat distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);\n#endif\n#endif\nvec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);\n#endif\n#ifdef FOG\nfinalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));\n#endif\n#ifdef RENDER_CUTOFF\nfinalColor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nfinalColor=applyCutout(finalColor);\n#endif\nglFragColor=finalColor;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec3 a_pos_3f;\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr\n#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength\nuniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_normal_matrix;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;\n#endif\nout vec4 v_position_height;out lowp vec4 v_color_mix;\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nout highp float v_depth;\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\nout lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;\n#endif\nvec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute-custom highp vec4 pbr\n#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength\nhighp mat4 normal_matrix;\n#ifdef INSTANCED_ARRAYS\nnormal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\nnormal_matrix=u_normal_matrix;\n#endif\nvec3 local_pos;mat3 rs;\n#ifdef MODEL_POSITION_ON_GPU\nvec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;\n#else\nlocal_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);\n#endif\nv_position_height.w=a_pos_3f.z;\n#ifdef HAS_ATTRIBUTE_a_pbr\nvec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(local_pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nfloat x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);\n#else\nnormal_3f=vec3(normal_matrix*vec4(normal_3f,0));\n#endif\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#ifdef HAS_ATTRIBUTE_a_color_4f\nv_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 shadow_pos=local_pos;\n#ifdef NORMAL_OFFSET\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nvec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();\n#else\nvec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();\n#endif\n#endif\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;\n#endif\n}'),modelDepth:Ji("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}","in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;\n#ifdef MODEL_POSITION_ON_GPU\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_instance;\n#endif\nuniform highp mat4 u_node_matrix;\n#endif\nvoid main() {\n#ifdef MODEL_POSITION_ON_GPU\nhighp mat4 instance;\n#ifdef INSTANCED_ARRAYS\ninstance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\ninstance=u_instance;\n#endif\nvec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;\n#else\ngl_Position=u_matrix*vec4(a_pos_3f,1);\n#endif\nv_depth=gl_Position.z/gl_Position.w;}"),stars:Ji("in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)\n{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}","\nin vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}")};function F1(o,i){const s=o.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let l of s)if(l=l.trim(),"#"===l[0]&&l.includes("if")&&!l.includes("endif")){l=l.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const d=l.split(" ");for(const u of d)i.includes(u)||i.push(u)}}function Ji(o,i){const s=/#include\s+"([^"]+)"/g,l=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let d=i.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);d&&(d=d.map(_=>{const y=_.split(" ");return y[y.length-1]}),d=[...new Set(d)]);const u={},m=[],p=[];o=o.replace(s,(_,y)=>(p.push(y),"")),i=i.replace(s,(_,y)=>(m.push(y),""));let g=[...P1];F1(o,g),F1(i,g);for(const _ of[...m,...p])Gy[_]||console.error(`Undefined include: ${_}`),Wy[_]||(Wy[_]=[],F1(Gy[_],Wy[_])),g=[...g,...Wy[_]];return{fragmentSource:o=o.replace(l,(_,y,v,w,C)=>(u[C]=!0,"define"===y?`\n#ifndef HAS_UNIFORM_u_${C}\nin ${v} ${w} ${C};\n#else\nuniform ${v} ${w} u_${C};\n#endif\n`:"initialize"===y?`\n#ifdef HAS_UNIFORM_u_${C}\n    ${v} ${w} ${C} = u_${C};\n#endif\n`:"define-attribute"===y?`\n#ifdef HAS_ATTRIBUTE_a_${C}\n    in ${v} ${w} ${C};\n#endif\n`:"initialize-attribute"===y?"":void 0)),vertexSource:i=i.replace(l,(_,y,v,w,C)=>{const D="float"===w?"vec2":w,k=C.match(/color/)?"color":D;return"define-attribute-vertex-shader-only"===y?`\n#ifdef HAS_ATTRIBUTE_a_${C}\nin ${v} ${w} a_${C};\n#endif\n`:u[C]?"define"===y?`\n#ifndef HAS_UNIFORM_u_${C}\nuniform lowp float u_${C}_t;\nin ${v} ${D} a_${C};\nout ${v} ${w} ${C};\n#else\nuniform ${v} ${w} u_${C};\n#endif\n`:"initialize"===y?"vec4"===k?`\n#ifndef HAS_UNIFORM_u_${C}\n    ${C} = a_${C};\n#else\n    ${v} ${w} ${C} = u_${C};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${C}\n    ${C} = unpack_mix_${k}(a_${C}, u_${C}_t);\n#else\n    ${v} ${w} ${C} = u_${C};\n#endif\n`:"define-attribute"===y?`\n#ifdef HAS_ATTRIBUTE_a_${C}\n    in ${v} ${w} a_${C};\n    out ${v} ${w} ${C};\n#endif\n`:"initialize-attribute"===y?`\n#ifdef HAS_ATTRIBUTE_a_${C}\n    ${C} = a_${C};\n#endif\n`:void 0:"define"===y?`\n#ifndef HAS_UNIFORM_u_${C}\nuniform lowp float u_${C}_t;\nin ${v} ${D} a_${C};\n#else\nuniform ${v} ${w} u_${C};\n#endif\n`:"define-instanced"===y?"mat4"===k?`\n#ifdef INSTANCED_ARRAYS\nin vec4 a_${C}0;\nin vec4 a_${C}1;\nin vec4 a_${C}2;\nin vec4 a_${C}3;\n#else\nuniform ${v} ${w} u_${C};\n#endif\n`:`\n#ifdef INSTANCED_ARRAYS\nin ${v} ${D} a_${C};\n#else\nuniform ${v} ${w} u_${C};\n#endif\n`:"initialize-attribute-custom"===y?`\n#ifdef HAS_ATTRIBUTE_a_${C}\n    ${v} ${w} ${C} = a_${C};\n#endif\n`:"vec4"===k?`\n#ifndef HAS_UNIFORM_u_${C}\n    ${v} ${w} ${C} = a_${C};\n#else\n    ${v} ${w} ${C} = u_${C};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${C}\n    ${v} ${w} ${C} = unpack_mix_${k}(a_${C}, u_${C}_t);\n#else\n    ${v} ${w} ${C} = u_${C};\n#endif\n`}),staticAttributes:d,usedDefines:g,vertexIncludes:m,fragmentIncludes:p}}class yF{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(i,s,l,d,u,m,p,g){this.context=i;let _=this.boundPaintVertexBuffers.length!==d.length;for(let v=0;!_&&v<d.length;v++)this.boundPaintVertexBuffers[v]!==d[v]&&(_=!0);let y=this.boundDynamicVertexBuffers.length!==p.length;for(let v=0;!y&&v<p.length;v++)this.boundDynamicVertexBuffers[v]!==p[v]&&(y=!0);if(!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==l||_||y||this.boundIndexBuffer!==u||this.boundVertexOffset!==m)this.freshBind(s,l,d,u,m,p,g);else{i.bindVertexArrayOES.set(this.vao);for(const v of p)v&&(v.bind(),g&&v.instanceCount&&v.setVertexAttribDivisor(i.gl,s,g));u&&u.dynamicDraw&&u.bind()}}freshBind(i,s,l,d,u,m,p){const g=i.numAttributes,_=this.context,y=_.gl;this.vao&&this.destroy(),this.vao=_.gl.createVertexArray(),_.bindVertexArrayOES.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=d,this.boundVertexOffset=u,this.boundDynamicVertexBuffers=m,s.enableAttributes(y,i),s.bind(),s.setVertexAttribPointers(y,i,u);for(const v of l)v.enableAttributes(y,i),v.bind(),v.setVertexAttribPointers(y,i,u);for(const v of m)v&&(v.enableAttributes(y,i),v.bind(),v.setVertexAttribPointers(y,i,u),p&&v.instanceCount&&v.setVertexAttribDivisor(y,i,p));d&&d.bind(),_.currentNumAttributes=g}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function vF(o,i){const s=Math.pow(2,i.canonical.z),l=i.canonical.y;return[new Ei(0,l/s).toLngLat().lat,new Ei(0,(l+1)/s).toLngLat().lat]}function aV(o,i,s,l,d,u,m){const p=o.context,g=p.gl,_=s.hillshadeFBO;if(!_)return;o.prepareDrawTile();const y=o.isTileAffectedByFog(i),v=o.getOrCreateProgram("hillshade",{overrideFog:y});p.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,_.colorAttachment.get());const w=((S,E,A,P)=>{const O=A.paint.get("hillshade-shadow-color"),R=A.paint.get("hillshade-highlight-color"),F=A.paint.get("hillshade-accent-color"),B=A.paint.get("hillshade-emissive-strength");let j=ni(A.paint.get("hillshade-illumination-direction"));if("viewport"===A.paint.get("hillshade-illumination-anchor"))j-=S.transform.angle;else if(S.style&&S.style.enable3dLights()&&S.style.directionalLight){const H=S.style.directionalLight.properties.get("direction");j=ni(ye(H.x,H.y,H.z)[1])}const U=!S.options.moving;return{u_matrix:P||S.transform.calculateProjMatrix(E.tileID.toUnwrapped(),U),u_image:0,u_latrange:vF(0,E.tileID),u_light:[A.paint.get("hillshade-exaggeration"),j],u_shadow:O,u_highlight:R,u_emissive_strength:B,u_accent:F}})(o,s,l,o.terrain?i.projMatrix:null);o.uploadCommonUniforms(p,v,i.toUnwrapped());const{tileBoundsBuffer:C,tileBoundsIndexBuffer:D,tileBoundsSegments:k}=o.getTileBoundsBuffers(s);v.draw(o,g.TRIANGLES,d,u,m,hi.disabled,w,l.id,C,D,k)}function uE(o,i,s){if(!i.needsDEMTextureUpload)return;const l=o.context,d=l.gl;l.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||o.getTileTexture(s.stride);const u=s.getPixels();i.demTexture?i.demTexture.update(u,{premultiply:!1}):i.demTexture=new Un(l,u,d.R32F,{premultiply:!1}),i.needsDEMTextureUpload=!1}function xF(o,i,s){const l=o.context,d=l.gl;if(!i.dem)return;const u=i.dem;if(l.activeTexture.set(d.TEXTURE1),uE(o,i,u),!i.demTexture)return;i.demTexture.bind(d.NEAREST,d.CLAMP_TO_EDGE);const m=u.dim;l.activeTexture.set(d.TEXTURE0);let p=i.hillshadeFBO;if(!p){const w=new Un(l,{width:m,height:m,data:null},d.RGBA);w.bind(d.LINEAR,d.CLAMP_TO_EDGE),p=i.hillshadeFBO=l.createFramebuffer(m,m,!0,"renderbuffer"),p.colorAttachment.set(w.texture)}l.bindFramebuffer.set(p.framebuffer),l.viewport.set([0,0,m,m]);const{tileBoundsBuffer:g,tileBoundsIndexBuffer:_,tileBoundsSegments:y}=o.getMercatorTileBoundsBuffers(),v=[];o.linearFloatFilteringSupported()&&v.push("TERRAIN_DEM_FLOAT_FORMAT"),o.getOrCreateProgram("hillshadePrepare",{defines:v}).draw(o,d.TRIANGLES,Be.disabled,pi.disabled,ji.unblended,hi.disabled,((w,C)=>{const D=C.stride,k=at.create();return at.ortho(k,0,pt,-pt,0,0,1),at.translate(k,k,[0,-pt,0]),{u_matrix:k,u_image:1,u_dimension:[D,D],u_zoom:w.overscaledZ}})(i.tileID,u),s.id,g,_,y),i.needsHillshadePrepare=!1}const L1=o=>({u_matrix:new ti(o),u_image0:new fi(o),u_skirt_height:new Pt(o),u_ground_shadow_factor:new Ke(o)}),hE=(o,i,s)=>({u_matrix:o,u_image0:0,u_skirt_height:i,u_ground_shadow_factor:s}),mE=(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D)=>({u_proj_matrix:Float32Array.from(o),u_globe_matrix:i,u_normalize_matrix:Float32Array.from(l),u_merc_matrix:s,u_zoom_transition:d,u_merc_center:u,u_image0:0,u_frustum_tl:m,u_frustum_tr:p,u_frustum_br:g,u_frustum_bl:_,u_globe_pos:y,u_globe_radius:v,u_viewport:w,u_grid_matrix:D?Float32Array.from(D):new Float32Array(9),u_skirt_height:C}),hp=(o,i)=>{if(i>0&&o.terrain&&rt("Cutoff is currently disabled on terrain"),i<=0||o.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,0]}};const s=o.transform,l=Math.max(Math.abs(s._zoom-(o.minCutoffZoom-1)),1),d=s.isLODDisabled(!1)?Il(60,45,s.pitch):Il(30,15,s.pitch),u=s._farZ-s._nearZ,m=i*s.height,p=((1-(g=d))*(.75*s.cameraToCenterDistance)+g*(s._farZ+m))*l;var g;return{shouldRenderCutoff:d<1,uniformValues:{u_cutoff_params:[s._nearZ,s._farZ,(p-s._nearZ)/u,(p-m-s._nearZ)/u]}}};function pE(o,i){return null!=o&&null!=i&&!(!o.hasData()||!i.hasData())&&null!=o.demTexture&&null!=i.demTexture&&o.tileID.key!==i.tileID.key}const mp=new class{constructor(){this.operations={}}newMorphing(o,i,s,l,d){if(o in this.operations){const u=this.operations[o];u.to.tileID.key!==s.tileID.key&&(u.queued=s)}else this.operations[o]={startTime:l,phase:0,duration:d,from:i,to:s,queued:null}}getMorphValuesForProxy(o){if(!(o in this.operations))return null;const i=this.operations[o];return{from:i.from,to:i.to,phase:i.phase}}update(o){for(const i in this.operations){const s=this.operations[i];for(s.phase=(o-s.startTime)/s.duration;s.phase>=1||!this._validOp(s);)if(!this._nextOp(s,o)){delete this.operations[i];break}}}_nextOp(o,i){return!!o.queued&&(o.from=o.to,o.to=o.queued,o.queued=null,o.phase=0,o.startTime=i,!0)}_validOp(o){return o.from.hasData()&&o.to.hasData()}},fE={0:null,1:"TERRAIN_VERTEX_MORPHING"};function gE(o,i,s){if(0===i)return 0;const l=i<1&&514===s?.25/i:1;return 6*Math.pow(1.5,22-o)*Math.max(i,1)*l}function wF(o,i){const s=1<<o.z;return!i&&(0===o.x||o.x===s-1)||0===o.y||o.y===s-1}const B1=o=>({u_matrix:o});function pp(o,i,s,l,d){if(d>0){const u=Ze.now(),m=(u-o.timeAdded)/d,p=i?(u-i.timeAdded)/d:-1,g=s.getSource(),_=l.coveringZoomLevel({tileSize:g.tileSize,roundZoom:g.roundZoom}),y=!i||Math.abs(i.tileID.overscaledZ-_)>Math.abs(o.tileID.overscaledZ-_),v=y&&o.refreshedUponExpiration?1:he(y?m:1-p,0,1);return o.refreshedUponExpiration&&m>=1&&(o.refreshedUponExpiration=!1),i?{opacity:1,mix:1-v}:{opacity:v,mix:0}}return{opacity:1,mix:0}}class _E extends ul{constructor(i){const s={type:"raster-dem",maxzoom:i.transform.maxZoom},l=new Pg(Vc(),null),d=b1("mock-dem",s,l,i.style);super("mock-dem",d,!1),d.setEventedParent(this),this._sourceLoaded=!0}_loadTile(i,s){i.state="loaded",s(null)}}class bE extends ul{constructor(i){const s=b1("proxy",{type:"geojson",maxzoom:i.transform.maxZoom},new Pg(Vc(),null),i.style);super("proxy",s,!1),s.setEventedParent(this),this.map=this.getSource().map=i,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(i,s,l){if(i.freezeTileCoverage)return;this.transform=i;const d=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((u,m)=>{if(u[m.key]="",!this._tiles[m.key]){const p=new tc(m,this._source.tileSize*m.overscaleFactor(),i.tileZoom);p.state="loaded",this._tiles[m.key]=p}return u},{});for(const u in this._tiles)u in d||(this.freeFBO(u),this._tiles[u].unloadVectorData(),delete this._tiles[u])}freeFBO(i){const s=this.proxyCachedFBO[i];if(void 0!==s){const l=Object.values(s);this.renderCachePool.push(...l),delete this.proxyCachedFBO[i]}}deallocRenderCache(){this.renderCache.forEach(i=>i.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class N1 extends Ri{constructor(i,s,l){super(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y),this.proxyTileKey=s,this.projMatrix=l}}class yE extends oy{constructor(i,s){super(),this.painter=i,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[l,d,u]=function(g){const _=new Os,y=new Cr,v=131;_.reserve(17161),y.reserve(33800);const w=pt/128,C=pt+w/2,D=C+w;for(let S=-w;S<D;S+=w)for(let E=-w;E<D;E+=w){const A=E<0||E>C||S<0||S>C?24575:0,P=he(Math.round(E),0,pt),O=he(Math.round(S),0,pt);_.emplaceBack(P+A,O)}const k=(S,E)=>{const A=E*v+S;y.emplaceBack(A+1,A,A+v),y.emplaceBack(A+v,A+v+1,A+1)};for(let S=1;S<129;S++)for(let E=1;E<129;E++)k(E,S);return[0,129].forEach(S=>{for(let E=0;E<130;E++)k(E,S),k(S,E)}),[_,y,32768]}(),m=i.context;this.gridBuffer=m.createVertexBuffer(l,Ac.members),this.gridIndexBuffer=m.createIndexBuffer(d),this.gridSegments=on.simpleSegment(0,0,l.length,d.length),this.gridNoSkirtSegments=on.simpleSegment(0,0,l.length,u),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new bE(s.map),this.orthoMatrix=at.create(),at.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,pt,0,pt,0,1);const p=m.gl;this._overlapStencilMode=new pi({func:p.GEQUAL,mask:255},0,255,p.KEEP,p.KEEP,p.REPLACE),this._previousZoom=i.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=s,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new _E(s.map),this._pendingGroundEffectLayers=[]}set style(i){i.on("data",this._onStyleDataEvent.bind(this)),this._style=i,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(i,s,l){if(i&&i.terrain){this._style!==i&&(this.style=i,this._evaluationZoom=void 0);const d=i.terrain.properties,u=0===i.terrain.drapeRenderMode,m=i.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=Ze.now();const p=i.terrain&&i.terrain.scope,g=d.get("source"),_=u?this._mockSourceCache:i.getSourceCache(g,p);if(!_)return void rt(`Couldn't find terrain source "${g}".`);if(this.sourceCache=_,this._exaggeration=m?this.calculateExaggeration(s):d.get("exaggeration"),!s.projection.requiresDraping&&m&&0===this._exaggeration)return void this._disable();this.enabled=!0;const y=()=>{this.sourceCache.used&&rt(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const v=this.getScaledDemTileSize();this.sourceCache.update(s,v,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,y(),this._initializing=!0),y(),s.updateElevation(!0,l),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(s),this._emptyDEMTextureDirty=!0,this._previousZoom=s.zoom}else this._disable()}calculateExaggeration(i){const s=this._previousCameraAltitude,l=i.getFreeCameraOptions().position.z/i.pixelsPerMeter*i.worldSize;this._previousCameraAltitude=l;const d=null!=s?l-s:Number.MAX_VALUE;if(Math.abs(d)<2)return this._exaggeration;const u=i.zoom,m=this._style.terrain;if(!this._previousUpdateTimestamp)return m.getExaggeration(u);let p=u-this._previousZoom;const g=this._previousUpdateTimestamp;let _=u;null!=this._evaluationZoom&&(_=this._evaluationZoom,Math.abs(u-_)>.5&&(p=.5*(u-_+p)),p*d<0&&(_+=p)),this._evaluationZoom=_;const y=m.getExaggeration(_),v=y===m.getExaggeration(Math.max(0,_-.1));if(v&&Math.abs(y-this._exaggeration)<.01)return y;let w=Math.min(.1,.00375*(this._updateTimestamp-g));return(v||y<.1||Math.abs(p)<1e-4)&&(w=Math.min(.2,4*w)),_e(this._exaggeration,y,w)}resetTileLookupCache(i){this._findCoveringTileCache[i]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(i){i.coord&&"source"===i.dataType?this._clearRenderCacheForTile(i.sourceCacheId,i.coord):"style"===i.dataType&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const i in this._style._mergedSourceCaches)this._style._mergedSourceCaches[i].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(i=>i.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const i=2*this.proxySourceCache.getSource().tileSize;return[i,i]}set useVertexMorphing(i){this._useVertexMorphing=i}updateTileBinding(i){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const s=this.proxySourceCache,l=this.painter.transform;this._initializing&&(this._initializing=0===l._centerAltitude&&-1===this.getAtPointOrZero(Ei.fromLngLat(l.center),-1),this._emptyDEMTextureDirty=!this._initializing);const d=this.proxyCoords=s.getIds().map(g=>{const _=s.getTileByID(g).tileID;return _.projMatrix=l.calculateProjMatrix(_.toUnwrapped()),_});!function(g,_){const y=_.transform.pointCoordinate(_.transform.getCameraPoint()),v=new ot(y.x,y.y);g.sort((w,C)=>{if(C.overscaledZ-w.overscaledZ)return C.overscaledZ-w.overscaledZ;const D=new ot(w.canonical.x+(1<<w.canonical.z)*w.wrap,w.canonical.y),k=new ot(C.canonical.x+(1<<C.canonical.z)*C.wrap,C.canonical.y),S=v.mult(1<<w.canonical.z);return S.x-=.5,S.y-=.5,S.distSqr(D)-S.distSqr(k)})}(d,this.painter);const u=this.proxyToSource||{};this.proxyToSource={},d.forEach(g=>{this.proxyToSource[g.key]={}}),this.terrainTileForTile={};const m=this._style._mergedSourceCaches;for(const g in m){const _=m[g];if(!_.used||(_!==this.sourceCache&&this.resetTileLookupCache(_.id),this._setupProxiedCoordsForOrtho(_,i[g],u),_.usedForTerrain))continue;const y=i[g];_.getSource().reparseOverscaled&&this._assignTerrainTiles(y)}this.proxiedCoords[s.id]=d.map(g=>new N1(g,g.key,this.orthoMatrix)),this._assignTerrainTiles(d),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(u),this.renderingToTexture=!1;const p={};this._visibleDemTiles=[];for(const g of this.proxyCoords){const _=this.terrainTileForTile[g.key];if(!_)continue;const y=_.tileID.key;y in p||(this._visibleDemTiles.push(_),p[y]=y)}}_assignTerrainTiles(i){this._initializing||i.forEach(s=>{if(this.terrainTileForTile[s.key])return;const l=this._findTileCoveringTileID(s,this.sourceCache);l&&(this.terrainTileForTile[s.key]=l)})}_prepareDEMTextures(){const i=this.painter.context,s=i.gl;for(const l in this.terrainTileForTile){const d=this.terrainTileForTile[l],u=d.dem;!u||d.demTexture&&!d.needsDEMTextureUpload||(i.activeTexture.set(s.TEXTURE1),uE(this.painter,d,u))}}_prepareDemTileUniforms(i,s,l,d){if(!s||null==s.demTexture)return!1;const u=i.tileID.canonical,m=Math.pow(2,s.tileID.canonical.z-u.z),p=d||"";return l[`u_dem_tl${p}`]=[u.x*m%1,u.y*m%1],l[`u_dem_scale${p}`]=m,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const i=this.painter.context,s=i.gl;if(!this._emptyDepthBufferTexture){const l=new _r({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new Un(i,l,s.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let i=0;const s=this._visibleDemTiles.reduce((l,d)=>{if(!d.dem)return l;const u=d.dem.tree.minimums[0];return u>0&&i++,l+u},0);return i?s/i:0}_updateEmptyDEMTexture(){const i=this.painter.context,s=i.gl;i.activeTexture.set(s.TEXTURE2);const l=this._getLoadedAreaMinimum(),[d,u]=(()=>{const p=new DP({width:1,height:1},new Float32Array([l]));return[s.R32F,p]})();this._emptyDEMTextureDirty=!1;let m=this._emptyDEMTexture;return m?m.update(u,{premultiply:!1}):m=this._emptyDEMTexture=new Un(i,u,d,{premultiply:!1}),m}setupElevationDraw(i,s,l){const d=this.painter.context,u=d.gl,m={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};m.u_exaggeration=this.exaggeration();let p=null,g=null,_=1;if(l&&l.morphing&&this._useVertexMorphing){const w=l.morphing.srcDemTile,C=l.morphing.dstDemTile;_=l.morphing.phase,w&&C&&(this._prepareDemTileUniforms(i,w,m,"_prev")&&(g=w),this._prepareDemTileUniforms(i,C,m)&&(p=C))}const y=w=>w&&w.demTexture&&this.painter.linearFloatFilteringSupported()?u.LINEAR:u.NEAREST,v=w=>{m.u_dem_size=1===w.size[0]?1:w.size[0]-2};if(g&&p)d.activeTexture.set(u.TEXTURE2),p.demTexture.bind(y(p),u.CLAMP_TO_EDGE),d.activeTexture.set(u.TEXTURE4),g.demTexture.bind(y(g),u.CLAMP_TO_EDGE),p.demTexture&&v(p.demTexture),m.u_dem_lerp=_;else{p=this.terrainTileForTile[i.tileID.key],d.activeTexture.set(u.TEXTURE2);const w=this._prepareDemTileUniforms(i,p,m)?p.demTexture:this.emptyDEMTexture;w.bind(y(p),u.CLAMP_TO_EDGE),v(w)}if(d.activeTexture.set(u.TEXTURE3),l&&l.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE),this._depthFBO&&(m.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE),m.u_depth_size_inv=[1,1]),l&&l.useMeterToDem&&p){const w=(1<<p.tileID.canonical.z)*sn(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;m.u_meter_to_dem=w}if(l&&l.labelPlaneMatrixInv&&(m.u_label_plane_matrix_inv=l.labelPlaneMatrixInv),s.setTerrainUniformValues(d,m),"globe"===this.painter.transform.projection.name){const w=this.globeUniformValues(this.painter.transform,i.tileID.canonical,l&&l.useDenormalizedUpVectorScale);s.setGlobeUniformValues(d,w)}}globeUniformValues(i,s,l){const d=i.projection;return{u_tile_tl_up:d.upVector(s,0,0),u_tile_tr_up:d.upVector(s,pt,0),u_tile_br_up:d.upVector(s,pt,pt),u_tile_bl_up:d.upVector(s,0,pt),u_tile_up_scale:l?Xf(1):d.upVectorScale(s,i.center.lat,i.worldSize).metersToTile}}renderToBackBuffer(i){const s=this.painter,l=this.painter.context;0!==i.length&&(l.bindFramebuffer.set(null),l.viewport.set([0,0,s.width,s.height]),s.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(d,u,m,p,g){if("globe"===d.transform.projection.name)!function(_,y,v,w,C){const D=_.context,k=D.gl;let S,E;const A=_.transform,P=xm(_,D,A),O=(X,G)=>{if(E===G)return;const Q=[fE[G],"PROJECTION_GLOBE_VIEW"];P&&Q.push("CUSTOM_ANTIALIASING");const it=_.isTileAffectedByFog(X);S=_.getOrCreateProgram("globeRaster",{defines:Q,overrideFog:it}),E=G},R=_.colorModeForRenderPass(),F=new Be(k.LEQUAL,Be.ReadWrite,_.depthRangeFor3D);mp.update(C);const B=Yk(A),j=[dr(A.center.lng),Rr(A.center.lat)],U=_.globeSharedBuffers,H=[A.width*Ze.devicePixelRatio,A.height*Ze.devicePixelRatio],W=Float32Array.from(A.globeMatrix),q={useDenormalizedUpVectorScale:!0};{const X=_.transform,G=gE(X.zoom,y.exaggeration(),y.sourceCache._source.tileSize);E=-1;const Q=k.TRIANGLES;for(const it of w){const st=v.getTile(it),J=pi.disabled,et=y.prevTerrainTileForTile[it.key],dt=y.terrainTileForTile[it.key];pE(et,dt)&&mp.newMorphing(it.key,et,dt,C,250),D.activeTexture.set(k.TEXTURE0),st.texture&&st.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE);const mt=mp.getMorphValuesForProxy(it.key),ut=mt?1:0;mt&&Ha(q,{morphing:{srcDemTile:mt.from,dstDemTile:mt.to,phase:ed(mt.phase)}});const bt=Xo(it.canonical),yt=Zk(bt.getCenter().lat),Ct=Ix(it.canonical,bt,yt,X.worldSize/X._pixelsPerMercatorPixel),gt=kd(da(it.canonical)),At=mE(X.expandedFarZProjMatrix,W,B,gt,Dr(X.zoom),j,X.frustumCorners.TL,X.frustumCorners.TR,X.frustumCorners.BR,X.frustumCorners.BL,X.globeCenterInViewSpace,X.globeRadius,H,G,Ct);if(O(it,ut),S&&(y.setupElevationDraw(st,S,q),_.uploadCommonUniforms(D,S,it.toUnwrapped()),U)){const[Gt,Et,te]=U.getGridBuffers(yt,0!==G);S.draw(_,Q,F,J,R,hi.backCCW,At,"globe_raster",Gt,Et,te)}}}if(U&&(_.renderDefaultNorthPole||_.renderDefaultSouthPole)){const X=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];P&&X.push("CUSTOM_ANTIALIASING"),S=_.getOrCreateProgram("globeRaster",{defines:X});for(const G of w){const{x:Q,y:it,z:st}=G.canonical,J=0===it,et=it===(1<<st)-1,[dt,mt,ut,bt]=U.getPoleBuffers(st,!1);if(bt&&(J||et)){const yt=v.getTile(G);D.activeTexture.set(k.TEXTURE0),yt.texture&&yt.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE);let Ct=Wl(st,Q,A);const gt=kd(da(G.canonical)),At=(Gt,Et)=>Gt.draw(_,k.TRIANGLES,F,pi.disabled,R,hi.disabled,mE(A.expandedFarZProjMatrix,Ct,Ct,gt,0,j,A.frustumCorners.TL,A.frustumCorners.TR,A.frustumCorners.BR,A.frustumCorners.BL,A.globeCenterInViewSpace,A.globeRadius,H,0),"globe_pole_raster",Et,ut,bt);y.setupElevationDraw(yt,S,q),_.uploadCommonUniforms(D,S,G.toUnwrapped()),J&&_.renderDefaultNorthPole&&At(S,dt),et&&_.renderDefaultSouthPole&&(Ct=at.scale(at.create(),Ct,[1,-1,1]),At(S,mt))}}}}(d,u,m,p,g);else{const _=d.context,y=_.gl;let v,w;const C=d.shadowRenderer,D=hp(d,d.longestCutoffRange),k=R=>{if(w===R)return;const F=[];F.push(fE[R]),D.shouldRenderCutoff&&F.push("RENDER_CUTOFF"),v=d.getOrCreateProgram("terrainRaster",{defines:F}),w=R},S=d.colorModeForRenderPass(),E=new Be(y.LEQUAL,Be.ReadWrite,d.depthRangeFor3D);mp.update(g);const A=d.transform,P=gE(A.zoom,u.exaggeration(),u.sourceCache._source.tileSize);let O=[0,0,0];if(C){const R=d.style.directionalLight,F=d.style.ambientLight;R&&F&&(O=VE(R,F))}{w=-1;const R=y.TRIANGLES,[F,B]=[u.gridIndexBuffer,u.gridSegments];for(const j of p){const U=m.getTile(j),H=pi.disabled,W=u.prevTerrainTileForTile[j.key],q=u.terrainTileForTile[j.key];pE(W,q)&&mp.newMorphing(j.key,W,q,g,250),_.activeTexture.set(y.TEXTURE0),U.texture&&U.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE);const X=mp.getMorphValuesForProxy(j.key),G=X?1:0;let Q;X&&(Q={morphing:{srcDemTile:X.from,dstDemTile:X.to,phase:ed(X.phase)}});const it=hE(j.projMatrix,wF(j.canonical,A.renderWorldCopies)?P/10:P,O);if(k(G),!v)continue;u.setupElevationDraw(U,v,Q);const st=j.toUnwrapped();C&&C.setupShadows(st,v),d.uploadCommonUniforms(_,v,st,null,D),v.draw(d,R,E,H,S,hi.backCCW,it,"terrain_raster",u.gridBuffer,F,B)}}}}(s,this,this.proxySourceCache,i,this._updateTimestamp),this.renderingToTexture=!0,s.gpuTimingDeferredRenderEnd(),i.splice(0,i.length))}renderBatch(i){if(0===this._drapedRenderBatches.length)return i+1;this.renderingToTexture=!0;const s=this.painter,l=this.painter.context,d=this.proxySourceCache,u=this.proxiedCoords[d.id],m=this._drapedRenderBatches.shift(),p=s.style.order,g=[];let _=0;for(const y of u){const v=d.getTileByID(y.proxyTileKey),w=d.proxyCachedFBO[y.key]?d.proxyCachedFBO[y.key][i]:void 0,C=void 0!==w?d.renderCache[w]:this.pool[_++],D=void 0!==w;if(v.texture=C.tex,D&&!C.dirty){g.push(v.tileID);continue}let k;l.bindFramebuffer.set(C.fb.framebuffer),this.renderedToTile=!1,C.dirty&&(l.clear({color:di.transparent,stencil:0}),C.dirty=!1);for(let S=m.start;S<=m.end;++S){const E=s.style._mergedLayers[p[S]];if(E.isHidden(s.transform.zoom))continue;const A=s.style.getLayerSourceCache(E),P=A?this.proxyToSource[y.key][A.id]:[y];if(!P)continue;const O=P;l.viewport.set([0,0,C.fb.width,C.fb.height]),k!==(A?A.id:null)&&(this._setupStencil(C,P,E,A),k=A?A.id:null),s.renderLayer(s,A,E,O)}if(0===this._drapedRenderBatches.length)for(const S of this._pendingGroundEffectLayers){const E=s.style._mergedLayers[p[S]];if(E.isHidden(s.transform.zoom))continue;const A=s.style.getLayerSourceCache(E),P=A?this.proxyToSource[y.key][A.id]:[y];if(!P)continue;const O=P;l.viewport.set([0,0,C.fb.width,C.fb.height]),k!==(A?A.id:null)&&(this._setupStencil(C,P,E,A),k=A?A.id:null),s.renderLayer(s,A,E,O)}this.renderedToTile?(C.dirty=!0,g.push(v.tileID)):D||--_,5===_&&(_=0,this.renderToBackBuffer(g))}return this.renderToBackBuffer(g),this.renderingToTexture=!1,l.bindFramebuffer.set(null),l.viewport.set([0,0,s.width,s.height]),m.end+1}postRender(){}isLayerOrderingCorrect(i){const s=i.order.length;let l=-1,d=s;for(let u=0;u<s;++u)this._style.isLayerDraped(i._mergedLayers[i.order[u]])?l=Math.max(l,u):d=Math.min(d,u);return d>l}getMinElevationBelowMSL(){let i=0;return this._visibleDemTiles.filter(s=>s.dem).forEach(s=>{i=Math.min(i,s.dem.tree.minimums[0])}),0===i?i:(i-30)*this._exaggeration}raycast(i,s,l){if(!this._visibleDemTiles)return null;const d=this._visibleDemTiles.filter(u=>u.dem).map(u=>{const m=u.tileID,p=1<<m.overscaledZ,{x:g,y:_}=m.canonical,y=g/p,v=(g+1)/p,w=_/p,C=(_+1)/p;return{minx:y,miny:w,maxx:v,maxy:C,t:u.dem.tree.raycastRoot(y,w,v,C,i,s,l),tile:u}});d.sort((u,m)=>(null!==u.t?u.t:Number.MAX_VALUE)-(null!==m.t?m.t:Number.MAX_VALUE));for(const u of d){if(null==u.t)return null;const m=u.tile.dem.tree.raycast(u.minx,u.miny,u.maxx,u.maxy,i,s,l);if(null!=m)return m}return null}_createFBO(){const i=this.painter.context,s=i.gl,l=this.drapeBufferSize;i.activeTexture.set(s.TEXTURE0);const d=new Un(i,{width:l[0],height:l[1],data:null},s.RGBA);d.bind(s.LINEAR,s.CLAMP_TO_EDGE);const u=i.createFramebuffer(l[0],l[1],!0,null);return u.colorAttachment.set(d.texture),u.depthAttachment=new bO(i,u.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=i.createRenderbuffer(i.gl.DEPTH_STENCIL,l[0],l[1]),this._stencilRef=0,u.depthAttachment.set(this._sharedDepthStencil),i.clear({stencil:0})):u.depthAttachment.set(this._sharedDepthStencil),i.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax),{fb:u,tex:d,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.hasLightTransitions())return!0;for(const i in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[i].hasTransition())return!0;return this._style.order.some(i=>{const s=this._style._mergedLayers[i],l=s.isHidden(this.painter.transform.zoom);return"custom"===s.type?!l&&s.shouldRedrape():!l&&s.hasTransition()})}_clearLineLayersFromRenderCache(){let i=!1;for(const l of this._style.getSources())if(l instanceof a1){i=!0;break}if(!i)return;const s={};for(let l=0;l<this._style.order.length;++l){const d=this._style._mergedLayers[this._style.order[l]],u=this._style.getLayerSourceCache(d);if(u&&!s[u.id]&&!d.isHidden(this.painter.transform.zoom)&&"line"===d.type&&d.widthExpression()instanceof vc){s[u.id]=!0;for(const m of this.proxyCoords){const p=this.proxyToSource[m.key][u.id];if(p)for(const g of p)this._clearRenderCacheForTile(u.id,g)}}}}_clearRasterLayersFromRenderCache(){let i=!1;for(const l in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[l]._source instanceof Fy){i=!0;break}if(!i)return;const s={};for(let l=0;l<this._style.order.length;++l){const d=this._style._mergedLayers[this._style.order[l]],u=this._style.getLayerSourceCache(d);if(!u||s[u.id]||d.isHidden(this.painter.transform.zoom)||"raster"!==d.type)continue;const m=d.paint.get("raster-fade-duration");for(const p of this.proxyCoords){const g=this.proxyToSource[p.key][u.id];if(g)for(const _ of g){const y=pp(u.getTile(_),u.findLoadedParent(_,0),u,this.painter.transform,m);(1!==y.opacity||0!==y.mix)&&this._clearRenderCacheForTile(u.id,_)}}}}_setupDrapedRenderBatches(){const i=this._style.order,s=i.length;if(0===s)return;const l=[];this._pendingGroundEffectLayers=[];let d,u=0,m=this._style._mergedLayers[i[u]];for(;!this._style.isLayerDraped(m)&&m.isHidden(this.painter.transform.zoom)&&++u<s;)m=this._style._mergedLayers[i[u]];for(;u<s;++u){const p=this._style._mergedLayers[i[u]];p.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(p)?void 0===d&&(d=u):("fill-extrusion"===p.type&&this._pendingGroundEffectLayers.push(u),void 0!==d&&(l.push({start:d,end:u-1}),d=void 0)))}if(void 0!==d&&l.push({start:d,end:u-1}),0!==l.length){const p=l[l.length-1];this._pendingGroundEffectLayers.every(_=>_>p.end)||rt("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=l}_setupRenderCache(i){const s=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,s.renderCache.length>s.renderCachePool.length){const m=Object.values(s.proxyCachedFBO);s.proxyCachedFBO={};for(let p=0;p<m.length;++p){const g=Object.values(m[p]);s.renderCachePool.push(...g)}}return}this._clearRasterLayersFromRenderCache();const l=this.proxyCoords,d=this._tilesDirty;for(let m=l.length-1;m>=0;m--){const p=l[m];if(s.getTileByID(p.key),void 0!==s.proxyCachedFBO[p.key]){const g=i[p.key],_=this.proxyToSource[p.key];let y=0;for(const v in _){const w=_[v],C=g[v];if(!C||C.length!==w.length||w.some((D,k)=>D!==C[k]||d[v]&&d[v].hasOwnProperty(D.key))){y=-1;break}++y}for(const v in s.proxyCachedFBO[p.key])s.renderCache[s.proxyCachedFBO[p.key][v]].dirty=y<0||y!==Object.values(g).length}}const u=[...this._drapedRenderBatches];u.sort((m,p)=>p.end-p.start-(m.end-m.start));for(const m of u)for(const p of l){if(s.proxyCachedFBO[p.key])continue;let g=s.renderCachePool.pop();void 0===g&&s.renderCache.length<50&&(g=s.renderCache.length,s.renderCache.push(this._createFBO())),void 0!==g&&(s.proxyCachedFBO[p.key]={},s.proxyCachedFBO[p.key][m.start]=g,s.renderCache[g].dirty=!0)}this._tilesDirty={}}_setupStencil(i,s,l,d){if(!d||!this._sourceTilesOverlap[d.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const u=this.painter.context,m=u.gl;if(s.length<=1)return void(this._overlapStencilType=!1);let p;if(l.isTileClipped())p=s.length,this._overlapStencilMode.test={func:m.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(s[0].overscaledZ>s[s.length-1].overscaledZ))return void(this._overlapStencilType=!1);p=1,this._overlapStencilMode.test={func:m.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+p>255&&(u.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=p,this._overlapStencilMode.ref=this._stencilRef,l.isTileClipped()&&this._renderTileClippingMasks(s,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(i){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[i.key]),this._overlapStencilMode):pi.disabled}_renderTileClippingMasks(i,s){const l=this.painter,d=this.painter.context,u=d.gl;l._tileClippingMaskIDs={},d.setColorMode(ji.disabled),d.setDepthMode(Be.disabled);const m=l.getOrCreateProgram("clippingMask");for(const p of i){const g=l._tileClippingMaskIDs[p.key]=--s;m.draw(l,u.TRIANGLES,Be.disabled,new pi({func:u.ALWAYS,mask:0},g,255,u.KEEP,u.KEEP,u.REPLACE),ji.disabled,hi.disabled,B1(p.projMatrix),"$clipping",l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments)}}pointCoordinate(i){const s=this.painter.transform;if(i.x<0||i.x>s.width||i.y<0||i.y>s.height)return null;const l=[i.x,i.y,1,1];Qi.transformMat4(l,l,s.pixelMatrixInverse),Qi.scale(l,l,1/l[3]),l[0]/=s.worldSize,l[1]/=s.worldSize;const d=s._camera.position,u=sn(1,s.center.lat),m=[d[0],d[1],d[2]/u,0],p=Z.subtract([],l.slice(0,3),m);Z.normalize(p,p);const g=this.raycast(m,p,this._exaggeration);return null!==g&&g?(Z.scaleAndAdd(m,m,p,g),m[3]=m[2],m[2]*=u,m):null}drawDepth(){const i=this.painter,s=i.context,l=this.proxySourceCache,d=Math.ceil(i.width),u=Math.ceil(i.height);if(!this._depthFBO||this._depthFBO.width===d&&this._depthFBO.height===u||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const m=s.gl,p=s.createFramebuffer(d,u,!0,"renderbuffer");s.activeTexture.set(m.TEXTURE0);const g=new Un(s,{width:d,height:u,data:null},m.RGBA);g.bind(m.NEAREST,m.CLAMP_TO_EDGE),p.colorAttachment.set(g.texture);const _=s.createRenderbuffer(s.gl.DEPTH_COMPONENT16,d,u);p.depthAttachment.set(_),this._depthFBO=p,this._depthTexture=g}s.bindFramebuffer.set(this._depthFBO.framebuffer),s.viewport.set([0,0,d,u]),function(m,p,g,_){if("globe"===m.transform.projection.name)return;const y=m.context,v=y.gl;y.clear({depth:1});const w=m.getOrCreateProgram("terrainDepth"),C=new Be(v.LESS,Be.ReadWrite,m.depthRangeFor3D);for(const D of _){const k=g.getTile(D),S=hE(D.projMatrix,0,[0,0,0]);p.setupElevationDraw(k,w),w.draw(m,v.TRIANGLES,C,pi.disabled,ji.unblended,hi.backCCW,S,"terrain_depth",p.gridBuffer,p.gridIndexBuffer,p.gridNoSkirtSegments)}}(i,this,l,this.proxyCoords)}_setupProxiedCoordsForOrtho(i,s,l){if(i.getSource()instanceof Fa)return this._setupProxiedCoordsForImageSource(i,s,l);this._findCoveringTileCache[i.id]=this._findCoveringTileCache[i.id]||{};const d=this.proxiedCoords[i.id]=[],u=this.proxyCoords;for(let p=0;p<u.length;p++){const g=u[p],_=this._findTileCoveringTileID(g,i);if(_){const y=this._createProxiedId(g,_,l[g.key]&&l[g.key][i.id]);d.push(y),this.proxyToSource[g.key][i.id]=[y]}}let m=!1;for(let p=0;p<s.length;p++){const g=i.getTile(s[p]);if(!g||!g.hasData())continue;const _=this._findTileCoveringTileID(g.tileID,this.proxySourceCache);if(_&&_.tileID.canonical.z!==g.tileID.canonical.z){const y=this.proxyToSource[_.tileID.key][i.id],v=this._createProxiedId(_.tileID,g,l[_.tileID.key]&&l[_.tileID.key][i.id]);y?y.splice(y.length-1,0,v):this.proxyToSource[_.tileID.key][i.id]=[v],d.push(v),m=!0}}this._sourceTilesOverlap[i.id]=m}_setupProxiedCoordsForImageSource(i,s,l){if(!i.getSource().loaded())return;const d=this.proxiedCoords[i.id]=[],u=this.proxyCoords,m=i.getSource(),p=m.tileID;if(!p)return;const g=new ot(p.x,p.y)._div(1<<p.z),_=m.coordinates.map(Ei.fromLngLat).reduce((v,w)=>(v.min.x=Math.min(v.min.x,w.x-g.x),v.min.y=Math.min(v.min.y,w.y-g.y),v.max.x=Math.max(v.max.x,w.x-g.x),v.max.y=Math.max(v.max.y,w.y-g.y),v),{min:new ot(Number.MAX_VALUE,Number.MAX_VALUE),max:new ot(-Number.MAX_VALUE,-Number.MAX_VALUE)}),y=(v,w)=>{const C=v.wrap+v.canonical.x/(1<<v.canonical.z),D=v.canonical.y/(1<<v.canonical.z),k=pt/(1<<v.canonical.z),S=w.wrap+w.canonical.x/(1<<w.canonical.z),E=w.canonical.y/(1<<w.canonical.z);return C+k<S+_.min.x||C>S+_.max.x||D+k<E+_.min.y||D>E+_.max.y};for(let v=0;v<u.length;v++){const w=u[v];for(let C=0;C<s.length;C++){const D=i.getTile(s[C]);if(!D||!D.hasData()||y(w,D.tileID))continue;const k=this._createProxiedId(w,D,l[w.key]&&l[w.key][i.id]),S=this.proxyToSource[w.key][i.id];S?S.push(k):this.proxyToSource[w.key][i.id]=[k],d.push(k)}}}_createProxiedId(i,s,l){let d=this.orthoMatrix;if(l){const u=l.find(m=>m.key===s.tileID.key);if(u)return u}if(s.tileID.key!==i.key){const u=i.canonical.z-s.tileID.canonical.z;let m,p,g;d=at.create();const _=s.tileID.wrap-i.wrap<<i.overscaledZ;u>0?(m=pt>>u,p=m*((s.tileID.canonical.x<<u)-i.canonical.x+_),g=m*((s.tileID.canonical.y<<u)-i.canonical.y)):(m=pt<<-u,p=pt*(s.tileID.canonical.x-(i.canonical.x+_<<-u)),g=pt*(s.tileID.canonical.y-(i.canonical.y<<-u))),at.ortho(d,0,m,0,m,0,1),at.translate(d,d,[p,g,0])}return new N1(s.tileID,i.key,d)}_findTileCoveringTileID(i,s){let l=s.getTile(i);if(l&&l.hasData())return l;const d=this._findCoveringTileCache[s.id],u=d[i.key];if(l=u?s.getTileByID(u):null,l&&l.hasData()||null===u)return l;let m=l?l.tileID:i,p=m.overscaledZ;const g=s.getSource().minzoom,_=[];if(!u){const v=s.getSource().maxzoom;if(i.canonical.z>=v){const w=i.canonical.z-v;s.getSource().reparseOverscaled?(p=Math.max(i.canonical.z+2,s.transform.tileZoom),m=new Ri(p,i.wrap,v,i.canonical.x>>w,i.canonical.y>>w)):0!==w&&(p=v,m=new Ri(p,i.wrap,v,i.canonical.x>>w,i.canonical.y>>w))}m.key!==i.key&&(_.push(m.key),l=s.getTile(m))}const y=v=>{_.forEach(w=>{d[w]=v}),_.length=0};for(p-=1;p>=g&&(!l||!l.hasData());p--){l&&y(l.tileID.key);const v=m.calculateScaledKey(p);if(l=s.getTileByID(v),l&&l.hasData())break;const w=d[v];if(null===w)break;void 0===w?_.push(v):l=s.getTileByID(w)}return y(l?l.tileID.key:null),l&&l.hasData()?l:null}findDEMTileFor(i){return this.enabled?this._findTileCoveringTileID(i,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(i,s){let l=this._tilesDirty[i];l||(l=this._tilesDirty[i]={}),l[s.key]=!0}}function vE(o,i,s){const l=function(p,g,_){const y=Z.dot(g,p),v=Z.dot(_,[.2126,.7152,.0722]),w=(D,k,S)=>(1-S)*D+S*k,C=w(1-.3*Math.min(v,1),1,Math.min(y+1,1));return w(.92,1,Math.asin(he(g[2],-1,1))/Math.PI+.5)*C}(o,[0,0,1],i),d=[0,0,0];Z.scale(d,s.slice(0,3),l);const u=[0,0,0];Z.scale(u,i.slice(0,3),o[2]);const m=[0,0,0];return Z.add(m,d,u),En(m)}const xE=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],CF=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class MF{static cacheKey(i,s,l,d){let u=`${s}${d?d.cacheKey:""}`;for(const m of l)i.usedDefines.includes(m)&&(u+=`/${m}`);return u}constructor(i,s,l,d,u,m){const p=i.gl;this.program=p.createProgram(),this.configuration=d,this.name=s,this.fixedDefines=[...m];const g=d?d.getBinderAttributes():[],_=(l.staticAttributes||[]).concat(g);let y=d?d.defines():[];y=y.concat(m.map(S=>`#define ${S}`));const v="#version 300 es\n";let w=v+y.concat("precision mediump float;",dE,cE.fragmentSource).join("\n");for(const S of l.fragmentIncludes)w+=`\n${Gy[S]}`;w+=`\n${l.fragmentSource}`;let C=v+y.concat("precision highp float;",dE,cE.vertexSource).join("\n");for(const S of l.vertexIncludes)C+=`\n${Gy[S]}`;C+=`\n${l.vertexSource}`;const D=p.createShader(p.FRAGMENT_SHADER);if(p.isContextLost())return void(this.failedToCreate=!0);p.shaderSource(D,w),p.compileShader(D),p.attachShader(this.program,D);const k=p.createShader(p.VERTEX_SHADER);if(p.isContextLost())this.failedToCreate=!0;else{p.shaderSource(k,C),p.compileShader(k),p.attachShader(this.program,k),this.attributes={},this.numAttributes=_.length;for(let S=0;S<this.numAttributes;S++)if(_[S]){const E=_[S].startsWith("a_")?_[S]:`a_${_[S]}`;p.bindAttribLocation(this.program,S,E),this.attributes[E]=S}p.linkProgram(this.program),p.deleteShader(k),p.deleteShader(D),this.fixedUniforms=u(i),this.binderUniforms=d?d.getUniforms(i):[],m.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new fi(S=i),u_dem_prev:new fi(S),u_dem_tl:new Ue(S),u_dem_scale:new Pt(S),u_dem_tl_prev:new Ue(S),u_dem_scale_prev:new Pt(S),u_dem_size:new Pt(S),u_dem_lerp:new Pt(S),u_exaggeration:new Pt(S),u_depth:new fi(S),u_depth_size_inv:new Ue(S),u_meter_to_dem:new Pt(S),u_label_plane_matrix_inv:new ti(S)}),m.includes("GLOBE")&&(this.globeUniforms=(S=>({u_tile_tl_up:new Ke(S),u_tile_tr_up:new Ke(S),u_tile_br_up:new Ke(S),u_tile_bl_up:new Ke(S),u_tile_up_scale:new Pt(S)}))(i)),m.includes("FOG")&&(this.fogUniforms=(S=>({u_fog_matrix:new ti(S),u_fog_range:new Ue(S),u_fog_color:new po(S),u_fog_horizon_blend:new Pt(S),u_fog_vertical_limit:new Ue(S),u_fog_temporal_offset:new Pt(S),u_frustum_tl:new Ke(S),u_frustum_tr:new Ke(S),u_frustum_br:new Ke(S),u_frustum_bl:new Ke(S),u_globe_pos:new Ke(S),u_globe_radius:new Pt(S),u_globe_transition:new Pt(S),u_is_globe:new fi(S),u_viewport:new Ue(S)}))(i)),m.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(S=>({u_cutoff_params:new po(S)}))(i)),m.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(S=>({u_lighting_ambient_color:new Ke(S),u_lighting_directional_dir:new Ke(S),u_lighting_directional_color:new Ke(S),u_ground_radiance:new Ke(S)}))(i)),m.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(S=>({u_light_matrix_0:new ti(S),u_light_matrix_1:new ti(S),u_fade_range:new Ue(S),u_shadow_normal_offset:new Ke(S),u_shadow_intensity:new Pt(S),u_shadow_texel_size:new Pt(S),u_shadow_map_resolution:new Pt(S),u_shadow_direction:new Ke(S),u_shadow_bias:new Ke(S),u_shadowmap_0:new fi(S),u_shadowmap_1:new fi(S)}))(i))}var S}setTerrainUniformValues(i,s){if(!this.terrainUniforms)return;const l=this.terrainUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const d in s)l[d]&&l[d].set(this.program,d,s[d])}}setGlobeUniformValues(i,s){if(!this.globeUniforms)return;const l=this.globeUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const d in s)l[d]&&l[d].set(this.program,d,s[d])}}setFogUniformValues(i,s){if(!this.fogUniforms)return;const l=this.fogUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const d in s)l[d].set(this.program,d,s[d])}}setCutoffUniformValues(i,s){if(!this.cutoffUniforms)return;const l=this.cutoffUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const d in s)l[d].set(this.program,d,s[d])}}setLightsUniformValues(i,s){if(!this.lightsUniforms)return;const l=this.lightsUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const d in s)l[d].set(this.program,d,s[d])}}setShadowUniformValues(i,s){if(this.failedToCreate||!this.shadowUniforms)return;const l=this.shadowUniforms;i.program.set(this.program);for(const d in s)l[d].set(this.program,d,s[d])}_drawDebugWireframe(i,s,l,d,u,m,p,g,_,y){const v=i.options.wireframe;if(!1===v.terrain&&!1===v.layers2D&&!1===v.layers3D)return;const w=i.context;if(!(()=>!(!v.terrain||"terrainRaster"!==this.name&&"globeRaster"!==this.name)||!(!v.layers2D||i._terrain&&i._terrain.renderingToTexture||!xE.includes(this.name))||!(!v.layers3D||!CF.includes(this.name)))())return;const C=w.gl,D=i.wireframeDebugCache.getLinesFromTrianglesBuffer(i.frameCounter,u,w);if(!D)return;const k=[...this.fixedDefines];k.push("DEBUG_WIREFRAME");const S=i.getOrCreateProgram(this.name,{config:this.configuration,defines:k});w.program.set(S.program);const E=(O,R,F)=>{if(R[O]&&F[O])for(const B in R[O])F[O][B]&&F[O][B].set(F.program,B,R[O][B].current)};_&&_.setUniforms(S.program,w,S.binderUniforms,p,{zoom:g}),E("fixedUniforms",this,S),E("terrainUniforms",this,S),E("globeUniforms",this,S),E("fogUniforms",this,S),E("lightsUniforms",this,S),E("shadowUniforms",this,S),D.bind(),w.setColorMode(new ji([C.ONE,C.ONE_MINUS_SRC_ALPHA,C.ZERO,C.ONE],di.transparent,[!0,!0,!0,!1])),w.setDepthMode(new Be(s.func===C.LESS?C.LEQUAL:s.func,Be.ReadOnly,s.range)),w.setStencilMode(pi.disabled);const A=3*m.primitiveLength*2,P=3*m.primitiveOffset*2*2;y&&y>1?C.drawElementsInstanced(C.LINES,A,C.UNSIGNED_SHORT,P,y):C.drawElements(C.LINES,A,C.UNSIGNED_SHORT,P),u.bind(),w.program.set(this.program),w.setDepthMode(s),w.setStencilMode(l),w.setColorMode(d)}draw(i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S){const E=i.context,A=E.gl;if(this.failedToCreate)return;E.program.set(this.program),E.setDepthMode(l),E.setStencilMode(d),E.setColorMode(u),E.setCullFace(m);for(const R of Object.keys(this.fixedUniforms))this.fixedUniforms[R].set(this.program,R,p[R]);D&&D.setUniforms(this.program,E,this.binderUniforms,w,{zoom:C});const P={[A.LINES]:2,[A.TRIANGLES]:3,[A.LINE_STRIP]:1}[s],O=S&&S>0?1:void 0;for(const R of v.get()){const F=R.vaos||(R.vaos={});(F[g]||(F[g]=new yF)).bind(E,this,_,D?D.getPaintVertexBuffers():[],y,R.vertexOffset,k||[],O),S&&S>1?A.drawElementsInstanced(s,R.primitiveLength*P,A.UNSIGNED_SHORT,R.primitiveOffset*P*2,S):A.drawElements(s,R.primitiveLength*P,A.UNSIGNED_SHORT,R.primitiveOffset*P*2),s===A.TRIANGLES&&this._drawDebugWireframe(i,l,d,u,y,R,w,C,D,S)}}}function DF(o,i){const s=Math.pow(2,i.tileID.overscaledZ),l=i.tileSize*Math.pow(2,o.transform.tileZoom)/s,d=l*(i.tileID.canonical.x+i.tileID.wrap*s),u=l*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/Xu(i,1,o.transform.tileZoom),u_pixel_coord_upper:[d>>16,u>>16],u_pixel_coord_lower:[65535&d,65535&u]}}const wE=at.create(),CE=(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k)=>{const S=i.style.light,E=S.properties.get("position"),A=[E.x,E.y,E.z],P=Zo.create();"viewport"===S.properties.get("anchor")&&(Zo.fromRotation(P,-i.transform.angle),Z.transformMat3(A,A,P));const O=S.properties.get("color"),R=i.transform,F={u_matrix:o,u_lightpos:A,u_lightintensity:S.properties.get("intensity"),u_lightcolor:[O.r,O.g,O.b],u_vertical_gradient:+s,u_opacity:l,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:wE,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:d,u_edge_radius:u,u_flood_light_color:v,u_vertical_scale:w,u_flood_light_intensity:C,u_ground_shadow_factor:D,u_emissive_strength:k};return"globe"===R.projection.name&&(F.u_tile_id=[m.canonical.x,m.canonical.y,1<<m.canonical.z],F.u_zoom_transition=g,F.u_inv_rot_matrix=y,F.u_merc_center=_,F.u_up_dir=R.projection.upVector(new ca(0,0,0),_[0]*pt,_[1]*pt),F.u_height_lift=p),F},kF=(o,i,s)=>({u_matrix:o,u_edge_radius:i,u_vertical_scale:s}),SF=(o,i,s,l,d,u,m,p,g,_,y,v,w,C)=>{const D=CE(o,i,s,l,d,u,m,g,_,y,v,w,C,1,[0,0,0],0),k={u_height_factor:-Math.pow(2,m.overscaledZ)/p.tileSize/8};return se(D,DF(i,p),k)},ME=(o,i)=>({u_matrix:o,u_emissive_strength:i}),fp=(o,i,s,l)=>se(ME(o,i),DF(s,l)),TF=(o,i,s)=>({u_matrix:o,u_world:s,u_emissive_strength:i}),oh=(o,i,s,l,d)=>se(fp(o,i,s,l),{u_world:d}),EF=(o,i,s,l)=>{const d=pt/s.tileSize;return{u_matrix:o,u_camera_to_center_distance:i.getCameraToCenterDistance(l),u_extrude_scale:[i.pixelsToGLUnits[0]/d,i.pixelsToGLUnits[1]/d]}},AF=(o,i,s=1)=>({u_matrix:o,u_color:i,u_overlay:0,u_overlay_scale:s}),IF=at.create(),lV=(o,i,s,l,d,u,m)=>{const p=o.transform,g="globe"===p.projection.name,_=g?Wk(p.zoom,i.canonical)*p._pixelsPerMercatorPixel:Xu(s,1,u),y={u_matrix:i.projMatrix,u_extrude_scale:_,u_intensity:m,u_inv_rot_matrix:IF,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(g){y.u_inv_rot_matrix=l,y.u_merc_center=d,y.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],y.u_zoom_transition=Dr(p.zoom);const v=d[0]*pt,w=d[1]*pt;y.u_up_dir=p.projection.upVector(new ca(0,0,0),v,w)}return y},Jr=(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E,A,P,O,R)=>{return{u_matrix:o,u_normalize_matrix:i,u_globe_matrix:s,u_merc_matrix:l,u_grid_matrix:d,u_tl_parent:u,u_scale_parent:y,u_fade_t:v.mix,u_opacity:v.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(B=w.paint.get("raster-saturation"),B>0?1-1/(1.001-B):-B),u_contrast_factor:(F=w.paint.get("raster-contrast"),F>0?1/(1-F):1+F),u_spin_weights:RF(w.paint.get("raster-hue-rotate")),u_perspective_transform:C,u_raster_elevation:D,u_tl_br:m,u_zoom_transition:p,u_merc_center:g,u_cutoff_params:_,u_colorization_mix:PF(S,A),u_colorization_offset:OF(E,A),u_color_ramp:k,u_texture_offset:[O/(P+2*O),P/(P+2*O)],u_texture_res:[P+2*O,P+2*O],u_emissive_strength:R};var F,B};function RF(o){o*=Math.PI/180;const i=Math.sin(o),s=Math.cos(o);return[(2*s+1)/3,(-Math.sqrt(3)*i-s+1)/3,(Math.sqrt(3)*i-s+1)/3]}function PF([o,i,s,l],[d,u]){if(d===u)return[0,0,0,0];const m=259/257/(u-d);return[o*m,i*m,s*m,l*m]}function OF(o,[i,s]){return i===s?0:((o-i)/(s-i)*259-1)/257}const $g=at.create(),z1=(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E)=>{const A=d.transform,P={u_is_size_zoom_constant:+("constant"===o||"source"===o),u_is_size_feature_constant:+("constant"===o||"camera"===o),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:A.getCameraToCenterDistance(k),u_rotate_symbol:+s,u_aspect_ratio:A.width/A.height,u_fade_change:d.options.fadeDuration?d.symbolFadeChange:1,u_matrix:u,u_label_plane_matrix:m,u_coord_matrix:p,u_is_text:+g,u_pitch_with_map:+l,u_texsize:_,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:$g,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:$g,u_up_vector:[0,-1,0],u_icon_transition:E||0,u_icon_saturation:S};return"globe"===k.name&&(P.u_tile_id=[y.canonical.x,y.canonical.y,1<<y.canonical.z],P.u_zoom_transition=v,P.u_inv_rot_matrix=C,P.u_merc_center=w,P.u_camera_forward=A._camera.forward(),P.u_ecef_origin=function(O,R){const F=[0,0,0],B=kd(da(R.canonical));return Z.transformMat4(F,F,B),Z.transformMat4(F,F,O),F}(A.globeMatrix,y.toUnwrapped()),P.u_tile_matrix=Float32Array.from(A.globeMatrix),P.u_up_vector=D),P},DE=(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S)=>se(z1(o,i,s,l,d,u,m,p,g,_,v,w,C,D,k,S,1),{u_gamma_scale:l?d.transform.getCameraToCenterDistance(S)*Math.cos(d.terrain?0:d.transform._pitch):1,u_device_pixel_ratio:Ze.devicePixelRatio,u_is_halo:+y,undefined:void 0}),kE=(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k)=>se(DE(o,i,s,l,d,u,m,p,!0,g,!0,y,v,w,C,D,k),{u_texsize_icon:_,u_texture_icon:1}),qy=(o,i,s,l)=>({u_matrix:o,u_emissive_strength:i,u_opacity:s,u_color:l}),FF=(o,i,s,l,d,u,m)=>se(function(p,g,_,y){const v=_.imageManager.getPattern(p.toString(),g),{width:w,height:C}=_.imageManager.getPixelSize(g),D=Math.pow(2,y.tileID.overscaledZ),k=y.tileSize*Math.pow(2,_.transform.tileZoom)/D,S=k*(y.tileID.canonical.x+y.tileID.wrap*D),E=k*y.tileID.canonical.y;return{u_image:0,u_pattern_tl:v.tl,u_pattern_br:v.br,u_texsize:[w,C],u_pattern_size:v.displaySize,u_tile_units_to_pixels:1/Xu(y,1,_.transform.tileZoom),u_pixel_coord_upper:[S>>16,E>>16],u_pixel_coord_lower:[65535&S,65535&E]}}(d,u,l,m),{u_matrix:o,u_emissive_strength:i,u_opacity:s}),Us={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},Yy=(o,i,s,l,d,u,m,p,g,_,y,v,w=[0,0,0])=>{const C=l.style.light,D=C.properties.get("position"),k=[-D.x,-D.y,D.z],S=Zo.create();"viewport"===C.properties.get("anchor")&&(Zo.fromRotation(S,-l.transform.angle),Z.transformMat3(k,k,S));const E="MASK"===_.alphaMode,A=C.properties.get("color"),P=v.paint.get("model-ambient-occlusion-intensity"),O=v.paint.get("model-color").constantOr(di.white),R=v.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:o,u_lighting_matrix:i,u_normal_matrix:s,u_lightpos:k,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[A.r,A.g,A.b],u_camera_pos:w,u_opacity:d,u_baseTextureIsAlpha:0,u_alphaMask:+E,u_alphaCutoff:_.alphaCutoff,u_baseColorFactor:[u.r,u.g,u.b,u.a],u_emissiveFactor:[m[0],m[1],m[2],1],u_metallicFactor:p,u_roughnessFactor:g,u_baseColorTexture:Us.BaseColor,u_metallicRoughnessTexture:Us.MetallicRoughness,u_normalTexture:Us.Normal,u_occlusionTexture:Us.Occlusion,u_emissionTexture:Us.Emission,u_color_mix:[O.r,O.g,O.b,R],u_aoIntensity:P,u_emissive_strength:y}},SE=new Float32Array(16),TE=(o,i=SE,s=SE)=>({u_matrix:o,u_instance:i,u_node_matrix:s}),EE={fillExtrusion:o=>({u_matrix:new ti(o),u_lightpos:new Ke(o),u_lightintensity:new Pt(o),u_lightcolor:new Ke(o),u_vertical_gradient:new Pt(o),u_opacity:new Pt(o),u_edge_radius:new Pt(o),u_ao:new Ue(o),u_tile_id:new Ke(o),u_zoom_transition:new Pt(o),u_inv_rot_matrix:new ti(o),u_merc_center:new Ue(o),u_up_dir:new Ke(o),u_height_lift:new Pt(o),u_flood_light_color:new Ke(o),u_vertical_scale:new Pt(o),u_flood_light_intensity:new Pt(o),u_ground_shadow_factor:new Ke(o),u_emissive_strength:new Pt(o)}),fillExtrusionDepth:o=>({u_matrix:new ti(o),u_edge_radius:new Pt(o),u_vertical_scale:new Pt(o)}),fillExtrusionPattern:o=>({u_matrix:new ti(o),u_lightpos:new Ke(o),u_lightintensity:new Pt(o),u_lightcolor:new Ke(o),u_vertical_gradient:new Pt(o),u_height_factor:new Pt(o),u_edge_radius:new Pt(o),u_ao:new Ue(o),u_tile_id:new Ke(o),u_zoom_transition:new Pt(o),u_inv_rot_matrix:new ti(o),u_merc_center:new Ue(o),u_up_dir:new Ke(o),u_height_lift:new Pt(o),u_image:new fi(o),u_texsize:new Ue(o),u_pixel_coord_upper:new Ue(o),u_pixel_coord_lower:new Ue(o),u_tile_units_to_pixels:new Pt(o),u_opacity:new Pt(o)}),fillExtrusionGroundEffect:o=>({u_matrix:new ti(o),u_opacity:new Pt(o),u_ao_pass:new Pt(o),u_meter_to_tile:new Pt(o),u_ao:new Ue(o),u_flood_light_intensity:new Pt(o),u_flood_light_color:new Ke(o),u_attenuation:new Pt(o),u_edge_radius:new Pt(o),u_fb:new fi(o),u_fb_size:new Pt(o)}),fill:o=>({u_matrix:new ti(o),u_emissive_strength:new Pt(o)}),fillPattern:o=>({u_matrix:new ti(o),u_emissive_strength:new Pt(o),u_image:new fi(o),u_texsize:new Ue(o),u_pixel_coord_upper:new Ue(o),u_pixel_coord_lower:new Ue(o),u_tile_units_to_pixels:new Pt(o)}),fillOutline:o=>({u_matrix:new ti(o),u_emissive_strength:new Pt(o),u_world:new Ue(o)}),fillOutlinePattern:o=>({u_matrix:new ti(o),u_emissive_strength:new Pt(o),u_world:new Ue(o),u_image:new fi(o),u_texsize:new Ue(o),u_pixel_coord_upper:new Ue(o),u_pixel_coord_lower:new Ue(o),u_tile_units_to_pixels:new Pt(o)}),circle:o=>({u_camera_to_center_distance:new Pt(o),u_extrude_scale:new ik(o),u_device_pixel_ratio:new Pt(o),u_matrix:new ti(o),u_inv_rot_matrix:new ti(o),u_merc_center:new Ue(o),u_tile_id:new Ke(o),u_zoom_transition:new Pt(o),u_up_dir:new Ke(o),u_emissive_strength:new Pt(o)}),collisionBox:o=>({u_matrix:new ti(o),u_camera_to_center_distance:new Pt(o),u_extrude_scale:new Ue(o)}),collisionCircle:o=>({u_matrix:new ti(o),u_inv_matrix:new ti(o),u_camera_to_center_distance:new Pt(o),u_viewport_size:new Ue(o)}),debug:o=>({u_color:new nl(o),u_matrix:new ti(o),u_overlay:new fi(o),u_overlay_scale:new Pt(o)}),clippingMask:o=>({u_matrix:new ti(o)}),heatmap:o=>({u_extrude_scale:new Pt(o),u_intensity:new Pt(o),u_matrix:new ti(o),u_inv_rot_matrix:new ti(o),u_merc_center:new Ue(o),u_tile_id:new Ke(o),u_zoom_transition:new Pt(o),u_up_dir:new Ke(o)}),heatmapTexture:o=>({u_image:new fi(o),u_color_ramp:new fi(o),u_opacity:new Pt(o)}),hillshade:o=>({u_matrix:new ti(o),u_image:new fi(o),u_latrange:new Ue(o),u_light:new Ue(o),u_shadow:new nl(o),u_highlight:new nl(o),u_emissive_strength:new Pt(o),u_accent:new nl(o)}),hillshadePrepare:o=>({u_matrix:new ti(o),u_image:new fi(o),u_dimension:new Ue(o),u_zoom:new Pt(o)}),line:o=>({u_matrix:new ti(o),u_pixels_to_tile_units:new ik(o),u_device_pixel_ratio:new Pt(o),u_units_to_pixels:new Ue(o),u_dash_image:new fi(o),u_gradient_image:new fi(o),u_image_height:new Pt(o),u_texsize:new Ue(o),u_tile_units_to_pixels:new Pt(o),u_alpha_discard_threshold:new Pt(o),u_trim_offset:new Ue(o),u_emissive_strength:new Pt(o)}),linePattern:o=>({u_matrix:new ti(o),u_texsize:new Ue(o),u_pixels_to_tile_units:new ik(o),u_device_pixel_ratio:new Pt(o),u_image:new fi(o),u_units_to_pixels:new Ue(o),u_tile_units_to_pixels:new Pt(o),u_alpha_discard_threshold:new Pt(o)}),raster:o=>({u_matrix:new ti(o),u_normalize_matrix:new ti(o),u_globe_matrix:new ti(o),u_merc_matrix:new ti(o),u_grid_matrix:new ek(o),u_tl_parent:new Ue(o),u_scale_parent:new Pt(o),u_fade_t:new Pt(o),u_opacity:new Pt(o),u_image0:new fi(o),u_image1:new fi(o),u_brightness_low:new Pt(o),u_brightness_high:new Pt(o),u_saturation_factor:new Pt(o),u_contrast_factor:new Pt(o),u_spin_weights:new Ke(o),u_perspective_transform:new Ue(o),u_raster_elevation:new Pt(o),u_tl_br:new po(o),u_zoom_transition:new Pt(o),u_merc_center:new Ue(o),u_cutoff_params:new po(o),u_colorization_mix:new po(o),u_colorization_offset:new Pt(o),u_color_ramp:new fi(o),u_texture_offset:new Ue(o),u_texture_res:new Ue(o),u_emissive_strength:new Pt(o)}),symbolIcon:o=>({u_is_size_zoom_constant:new fi(o),u_is_size_feature_constant:new fi(o),u_size_t:new Pt(o),u_size:new Pt(o),u_camera_to_center_distance:new Pt(o),u_rotate_symbol:new fi(o),u_aspect_ratio:new Pt(o),u_fade_change:new Pt(o),u_matrix:new ti(o),u_label_plane_matrix:new ti(o),u_coord_matrix:new ti(o),u_is_text:new fi(o),u_pitch_with_map:new fi(o),u_texsize:new Ue(o),u_tile_id:new Ke(o),u_zoom_transition:new Pt(o),u_inv_rot_matrix:new ti(o),u_merc_center:new Ue(o),u_camera_forward:new Ke(o),u_tile_matrix:new ti(o),u_up_vector:new Ke(o),u_ecef_origin:new Ke(o),u_texture:new fi(o),u_icon_transition:new Pt(o),u_icon_saturation:new Pt(o)}),symbolSDF:o=>({u_is_size_zoom_constant:new fi(o),u_is_size_feature_constant:new fi(o),u_size_t:new Pt(o),u_size:new Pt(o),u_camera_to_center_distance:new Pt(o),u_rotate_symbol:new fi(o),u_aspect_ratio:new Pt(o),u_fade_change:new Pt(o),u_matrix:new ti(o),u_label_plane_matrix:new ti(o),u_coord_matrix:new ti(o),u_is_text:new fi(o),u_pitch_with_map:new fi(o),u_texsize:new Ue(o),u_texture:new fi(o),u_gamma_scale:new Pt(o),u_device_pixel_ratio:new Pt(o),u_tile_id:new Ke(o),u_zoom_transition:new Pt(o),u_inv_rot_matrix:new ti(o),u_merc_center:new Ue(o),u_camera_forward:new Ke(o),u_tile_matrix:new ti(o),u_up_vector:new Ke(o),u_ecef_origin:new Ke(o),u_is_halo:new fi(o)}),symbolTextAndIcon:o=>({u_is_size_zoom_constant:new fi(o),u_is_size_feature_constant:new fi(o),u_size_t:new Pt(o),u_size:new Pt(o),u_camera_to_center_distance:new Pt(o),u_rotate_symbol:new fi(o),u_aspect_ratio:new Pt(o),u_fade_change:new Pt(o),u_matrix:new ti(o),u_label_plane_matrix:new ti(o),u_coord_matrix:new ti(o),u_is_text:new fi(o),u_pitch_with_map:new fi(o),u_texsize:new Ue(o),u_texsize_icon:new Ue(o),u_texture:new fi(o),u_texture_icon:new fi(o),u_gamma_scale:new Pt(o),u_device_pixel_ratio:new Pt(o),u_is_halo:new fi(o)}),background:o=>({u_matrix:new ti(o),u_emissive_strength:new Pt(o),u_opacity:new Pt(o),u_color:new nl(o)}),backgroundPattern:o=>({u_matrix:new ti(o),u_emissive_strength:new Pt(o),u_opacity:new Pt(o),u_image:new fi(o),u_pattern_tl:new Ue(o),u_pattern_br:new Ue(o),u_texsize:new Ue(o),u_pattern_size:new Ue(o),u_pixel_coord_upper:new Ue(o),u_pixel_coord_lower:new Ue(o),u_tile_units_to_pixels:new Pt(o)}),terrainRaster:L1,terrainDepth:L1,skybox:o=>({u_matrix:new ti(o),u_sun_direction:new Ke(o),u_cubemap:new fi(o),u_opacity:new Pt(o),u_temporal_offset:new Pt(o)}),skyboxGradient:o=>({u_matrix:new ti(o),u_color_ramp:new fi(o),u_center_direction:new Ke(o),u_radius:new Pt(o),u_opacity:new Pt(o),u_temporal_offset:new Pt(o)}),skyboxCapture:o=>({u_matrix_3f:new ek(o),u_sun_direction:new Ke(o),u_sun_intensity:new Pt(o),u_color_tint_r:new po(o),u_color_tint_m:new po(o),u_luminance:new Pt(o)}),globeRaster:o=>({u_proj_matrix:new ti(o),u_globe_matrix:new ti(o),u_normalize_matrix:new ti(o),u_merc_matrix:new ti(o),u_zoom_transition:new Pt(o),u_merc_center:new Ue(o),u_image0:new fi(o),u_grid_matrix:new ek(o),u_skirt_height:new Pt(o),u_frustum_tl:new Ke(o),u_frustum_tr:new Ke(o),u_frustum_br:new Ke(o),u_frustum_bl:new Ke(o),u_globe_pos:new Ke(o),u_globe_radius:new Pt(o),u_viewport:new Ue(o)}),globeAtmosphere:o=>({u_frustum_tl:new Ke(o),u_frustum_tr:new Ke(o),u_frustum_br:new Ke(o),u_frustum_bl:new Ke(o),u_horizon:new Pt(o),u_transition:new Pt(o),u_fadeout_range:new Pt(o),u_color:new po(o),u_high_color:new po(o),u_space_color:new po(o),u_temporal_offset:new Pt(o),u_horizon_angle:new Pt(o)}),model:o=>({u_matrix:new ti(o),u_lighting_matrix:new ti(o),u_normal_matrix:new ti(o),u_lightpos:new Ke(o),u_lightintensity:new Pt(o),u_lightcolor:new Ke(o),u_camera_pos:new Ke(o),u_opacity:new Pt(o),u_baseColorFactor:new po(o),u_emissiveFactor:new po(o),u_metallicFactor:new Pt(o),u_roughnessFactor:new Pt(o),u_baseTextureIsAlpha:new fi(o),u_alphaMask:new fi(o),u_alphaCutoff:new Pt(o),u_baseColorTexture:new fi(o),u_metallicRoughnessTexture:new fi(o),u_normalTexture:new fi(o),u_occlusionTexture:new fi(o),u_emissionTexture:new fi(o),u_color_mix:new po(o),u_aoIntensity:new Pt(o),u_emissive_strength:new Pt(o)}),modelDepth:o=>({u_matrix:new ti(o),u_instance:new ti(o),u_node_matrix:new ti(o)}),groundShadow:o=>({u_matrix:new ti(o),u_ground_shadow_factor:new Ke(o)}),stars:o=>({u_matrix:new ti(o),u_up:new Ke(o),u_right:new Ke(o),u_intensity_multiplier:new Pt(o)})};let hr;function AE(o,i,s,l,d,u,m){const p=o.context,g=p.gl,_=o.transform,y=o.getOrCreateProgram("collisionBox"),v=[];let w=0,C=0;for(let O=0;O<l.length;O++){const R=l[O],F=i.getTile(R),B=F.getBucket(s);if(!B)continue;const j=lF(R,B,_);let U=j;0===d[0]&&0===d[1]||(U=o.translatePosMatrix(j,F,d,u));const H=m?B.textCollisionBox:B.iconCollisionBox,W=B.collisionCircleArray;if(W.length>0){const q=at.create(),X=U;at.mul(q,B.placementInvProjMatrix,_.glCoordMatrix),at.mul(q,q,B.placementViewportMatrix),v.push({circleArray:W,circleOffset:C,transform:X,invTransform:q,projection:B.getProjection()}),w+=W.length/4,C=w}H&&(o.terrain&&o.terrain.setupElevationDraw(F,y),y.draw(o,g.LINES,Be.disabled,pi.disabled,o.colorModeForRenderPass(),hi.disabled,EF(U,_,F,B.getProjection()),s.id,H.layoutVertexBuffer,H.indexBuffer,H.segments,null,_.zoom,null,[H.collisionVertexBuffer,H.collisionVertexBufferExt]))}if(!m||!v.length)return;const D=o.getOrCreateProgram("collisionCircle"),k=new vd;k.resize(4*w),k._trim();let S=0;for(const O of v)for(let R=0;R<O.circleArray.length/4;R++){const F=4*R,B=O.circleArray[F+0],j=O.circleArray[F+1],U=O.circleArray[F+2],H=O.circleArray[F+3];k.emplace(S++,B,j,U,H,0),k.emplace(S++,B,j,U,H,1),k.emplace(S++,B,j,U,H,2),k.emplace(S++,B,j,U,H,3)}(!hr||hr.length<2*w)&&(hr=function(O){const R=2*O,F=new Cr;F.resize(R),F._trim();for(let B=0;B<R;B++){const j=6*B;F.uint16[j+0]=4*B+0,F.uint16[j+1]=4*B+1,F.uint16[j+2]=4*B+2,F.uint16[j+3]=4*B+2,F.uint16[j+4]=4*B+3,F.uint16[j+5]=4*B+0}return F}(w));const E=p.createIndexBuffer(hr,!0),A=p.createVertexBuffer(k,vS.members,!0);for(const O of v){const R={u_matrix:O.transform,u_inv_matrix:O.invTransform,u_camera_to_center_distance:(P=_).getCameraToCenterDistance(O.projection),u_viewport_size:[P.width,P.height]};D.draw(o,g.TRIANGLES,Be.disabled,pi.disabled,o.colorModeForRenderPass(),hi.disabled,R,s.id,A,E,on.simpleSegment(0,2*O.circleOffset,O.circleArray.length,O.circleArray.length/2),null,_.zoom)}var P;A.destroy(),E.destroy()}const IE=at.create();function RE({width:o,height:i,anchor:s,textOffset:l,textScale:d},u){const{horizontalAlign:m,verticalAlign:p}=dy(s),g=-(m-.5)*o,_=-(p-.5)*i,y=BS(s,l);return new ot((g/d+y[0])*u,(_/d+y[1])*u)}function PE(o,i,s,l,d,u,m,p,g,_,y){const v=o.text.placedSymbolArray,w=o.text.dynamicLayoutVertexArray,C=o.icon.dynamicLayoutVertexArray,D={},k=o.getProjection(),S=Vy(p,k,u),E=u.elevation,A=k.upVectorScale(p.canonical,u.center.lat,u.worldSize).metersToTile;w.clear();for(let P=0;P<v.length;P++){const O=v.get(P),{tileAnchorX:R,tileAnchorY:F,numGlyphs:B}=O,j=O.hidden||!O.crossTileID||o.allowVerticalPlacement&&!O.placedOrientation?null:l[O.crossTileID];if(j){let U=0,H=0,W=0;if(E){const dt=E?E.getAtTileOffset(p,R,F):0,[mt,ut,bt]=k.upVector(p.canonical,R,F);U=dt*mt*A,H=dt*ut*A,W=dt*bt*A}let[q,X,G,Q]=hl(O.projectedAnchorX+U,O.projectedAnchorY+H,O.projectedAnchorZ+W,s?S:m);const it=Rw(u.getCameraToCenterDistance(k),Q);let st=d.evaluateSizeForFeature(o.textSizeData,_,O)*it/so;s&&(st*=o.tilePixelRatio/g);const J=RE(j,st);s?(({x:q,y:X,z:G}=k.projectTilePoint(R+J.x,F+J.y,p.canonical)),[q,X,G]=hl(q+U,X+H,G+W,m)):(i&&J._rotate(-u.angle),q+=J.x,X+=J.y,G=0);const et=o.allowVerticalPlacement&&O.placedOrientation===On.vertical?Math.PI/2:0;for(let dt=0;dt<B;dt++)$m(w,q,X,G,et);y&&O.associatedIconIndex>=0&&(D[O.associatedIconIndex]={x:q,y:X,z:G,angle:et})}else Ku(B,w)}if(y){C.clear();const P=o.icon.placedSymbolArray;for(let O=0;O<P.length;O++){const R=P.get(O),{numGlyphs:F}=R,B=D[O];if(R.hidden||!B)Ku(F,C);else{const{x:j,y:U,z:H,angle:W}=B;for(let q=0;q<F;q++)$m(C,j,U,H,W)}}o.icon.dynamicLayoutVertexBuffer.updateData(C)}o.text.dynamicLayoutVertexBuffer.updateData(w)}function V1(o,i,s){return s.iconsInText&&i?"symbolTextAndIcon":o?"symbolSDF":"symbolIcon"}function j1(o,i,s,l,d,u,m,p,g,_,y,v,w){const C=o.context,D=C.gl,k=o.transform,S="map"===p,E="map"===g,A=S&&"point"!==s.layout.get("symbol-placement"),P=S&&!E&&!A,O=void 0!==s.layout.get("symbol-sort-key").constantOr(1);let R=!1;const F=o.depthModeForSublayer(0,Be.ReadOnly),B=[dr(k.center.lng),Rr(k.center.lat)],j=s.layout.get("text-variable-anchor"),U="globe"===k.projection.name,H=[],W=[0,-1,0];let q=W;!U&&!k.mercatorFromTransition||S||(q=function(X){const G=X._camera.getWorldToCamera(X.worldSize,1),Q=at.multiply([],G,X.globeMatrix);at.invert(Q,Q);const it=[0,0,0],st=[0,1,0,0];return Qi.transformMat4(st,st,Q),it[0]=st[0],it[1]=st[1],it[2]=st[2],Z.normalize(it,it),it}(k));for(const X of l){const G=i.getTile(X),Q=G.getBucket(s);if(!Q||"mercator"===Q.projection.name&&U)continue;const it=d?Q.text:Q.icon;if(!it||Q.fullyClipped||!it.segments.get().length)continue;const st=it.programConfigurations.get(s.id),J=d||Q.sdfIcons,et=d?Q.textSizeData:Q.iconSizeData,dt=E||0!==k.pitch,mt=Xl(et,k.zoom);let ut,bt,yt,Ct,gt=[0,0],At=null;if(d)bt=G.glyphAtlasTexture?G.glyphAtlasTexture:null,yt=D.LINEAR,ut=G.glyphAtlasTexture?G.glyphAtlasTexture.size:[0,0],Q.iconsInText&&(gt=G.imageAtlasTexture?G.imageAtlasTexture.size:[0,0],At=G.imageAtlasTexture?G.imageAtlasTexture:null,Ct=dt||o.options.rotating||o.options.zooming||"composite"===et.kind||"camera"===et.kind?D.LINEAR:D.NEAREST);else{const kn=1!==s.layout.get("icon-size").constantOr(0)||Q.iconsNeedLinear;bt=G.imageAtlasTexture?G.imageAtlasTexture:null,yt=J||o.options.rotating||o.options.zooming||kn||dt?D.LINEAR:D.NEAREST,ut=G.imageAtlasTexture?G.imageAtlasTexture.size:[0,0]}const Gt="globe"===Q.projection.name,Et=Gt?q:W,te=Gt?Dr(k.zoom):0,ie=Vy(X,Q.getProjection(),k),He=k.calculatePixelsToTileUnitsMatrix(G),ve=Dg(ie,G.tileID.canonical,E,S,k,Q.getProjection(),He),Ui=o.terrain&&E&&A?at.invert(at.create(),ve):IE,xi=kg(ie,G.tileID.canonical,E,S,k,Q.getProjection(),He),$e=j&&Q.hasTextData(),ze=Q.hasIconTextFit()&&$e&&Q.hasIconData();if(A){const kn=k.elevation,Xi=kn?kn.getAtTileOffsetFunc(X,k.center.lat,k.worldSize,Q.getProjection()):null,xo=Se(ie,G.tileID.canonical,E,S,k,Q.getProjection(),He);hT(Q,ie,o,d,xo,xi,E,_,Xi,X)}const Ce=A||d&&j||ze,wi=o.translatePosMatrix(ie,G,u,m),Pi=Ce?IE:ve,ci=o.translatePosMatrix(xi,G,u,m,!0),Gi=Q.getProjection().createInversionMatrix(k,X.canonical),ir=s.paint.get("icon-image-cross-fade").constantOr(0),tn=[];o.terrainRenderModeElevated()&&E&&tn.push("PITCH_WITH_MAP_TERRAIN"),Gt&&(tn.push("PROJECTION_GLOBE_VIEW"),Ce&&tn.push("PROJECTED_POS_ON_VIEWPORT")),ir>0&&tn.push("ICON_TRANSITION"),it.zOffsetVertexBuffer&&tn.push("Z_OFFSET");const Mn=J&&0!==s.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1);let mr;J?mr=Q.iconsInText?kE(et.kind,mt,P,E,o,wi,Pi,ci,ut,gt,X,te,B,Gi,Et,Q.getProjection()):DE(et.kind,mt,P,E,o,wi,Pi,ci,d,ut,!0,X,te,B,Gi,Et,Q.getProjection()):(y<1&&tn.push("SATURATION"),mr=z1(et.kind,mt,P,E,o,wi,Pi,ci,d,ut,X,te,B,Gi,Et,Q.getProjection(),y,ir));const Zn={program:o.getOrCreateProgram(V1(J,d,Q),{config:st,defines:tn}),buffers:it,uniformValues:mr,atlasTexture:bt,atlasTextureIcon:At,atlasInterpolation:yt,atlasInterpolationIcon:Ct,isSDF:J,hasHalo:Mn,tile:G,labelPlaneMatrixInv:Ui};if(O&&Q.canOverlap){R=!0;const kn=it.segments.get();for(const Xi of kn)H.push({segments:new on([Xi]),sortKey:Xi.sortKey,state:Zn})}else H.push({segments:it.segments,sortKey:0,state:Zn})}R&&H.sort((X,G)=>X.sortKey-G.sortKey);for(const X of H){const G=X.state;if(o.terrain&&o.terrain.setupElevationDraw(G.tile,G.program,{useDepthForOcclusion:k.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:G.labelPlaneMatrixInv}),C.activeTexture.set(D.TEXTURE0),G.atlasTexture&&G.atlasTexture.bind(G.atlasInterpolation,D.CLAMP_TO_EDGE),G.atlasTextureIcon&&(C.activeTexture.set(D.TEXTURE1),G.atlasTextureIcon&&G.atlasTextureIcon.bind(G.atlasInterpolationIcon,D.CLAMP_TO_EDGE)),o.uploadCommonLightUniforms(o.context,G.program),G.hasHalo){const Q=G.uniformValues;Q.u_is_halo=1,U1(G.buffers,X.segments,s,o,G.program,F,v,w,Q,2),Q.u_is_halo=0}else{if(G.isSDF){const Q=G.uniformValues;G.hasHalo&&(Q.u_is_halo=1,U1(G.buffers,X.segments,s,o,G.program,F,v,w,Q,1)),Q.u_is_halo=0}U1(G.buffers,X.segments,s,o,G.program,F,v,w,G.uniformValues,1)}}}function U1(o,i,s,l,d,u,m,p,g,_){const y=[o.dynamicLayoutVertexBuffer,o.opacityVertexBuffer,o.iconTransitioningVertexBuffer,o.globeExtVertexBuffer,o.zOffsetVertexBuffer];d.draw(l,l.context.gl.TRIANGLES,u,m,p,hi.disabled,g,s.id,o.layoutVertexBuffer,o.indexBuffer,i,s.paint,l.transform.zoom,o.programConfigurations.get(s.id),y,_)}function H1(o,i,s,l,d,u,m){const p=o.context.gl,g=s.paint.get("fill-pattern"),_=g&&g.constantOr(1);let y,v,w,C,D;m?(v=_&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",y=p.LINES):(v=_?"fillPattern":"fill",y=p.TRIANGLES);for(const k of l){const S=i.getTile(k);if(_&&!S.patternsLoaded())continue;const E=S.getBucket(s);if(!E)continue;o.prepareDrawTile();const A=E.programConfigurations.get(s.id),P=o.isTileAffectedByFog(k),O=o.getOrCreateProgram(v,{config:A,overrideFog:P});_&&(o.context.activeTexture.set(p.TEXTURE0),S.imageAtlasTexture&&S.imageAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),A.updatePaintBuffers());const R=g.constantOr(null);if(R&&S.imageAtlas){const j=S.imageAtlas.patternPositions[R.toString()];j&&A.setConstantPatternPositions(j)}const F=o.translatePosMatrix(k.projMatrix,S,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor")),B=s.paint.get("fill-emissive-strength");if(m){C=E.indexBuffer2,D=E.segments2;const j=o.terrain&&o.terrain.renderingToTexture?o.terrain.drapeBufferSize:[p.drawingBufferWidth,p.drawingBufferHeight];w="fillOutlinePattern"===v&&_?oh(F,B,o,S,j):TF(F,B,j)}else C=E.indexBuffer,D=E.segments,w=_?fp(F,B,o,S):ME(F,B);o.uploadCommonUniforms(o.context,O,k.toUnwrapped()),O.draw(o,y,d,o.stencilModeForClipping(k),u,hi.disabled,w,s.id,E.layoutVertexBuffer,C,D,s.paint,o.transform.zoom,A,void 0)}}function Gg(o,i,s,l,d,u,m,p){s.resetLayerRenderingStats();const g=o.context,_=g.gl,y=o.transform,v=s.paint.get("fill-extrusion-pattern"),w=v.constantOr(1),C=s.paint.get("fill-extrusion-opacity"),D=o.style.enable3dLights(),k=s.paint.get(D&&!w?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),S=[s.paint.get("fill-extrusion-ambient-occlusion-intensity"),k],E=s.layout.get("fill-extrusion-edge-radius"),A=E>0&&!s.paint.get("fill-extrusion-rounded-roof"),P=A?0:E,O="globe"===y.projection.name?be():0,R="globe"===y.projection.name,F=R?Dr(y.zoom):0,B=[dr(y.center.lng),Rr(y.center.lat)],j=s.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),U=s.paint.get("fill-extrusion-flood-light-intensity"),H=s.paint.get("fill-extrusion-vertical-scale"),W=hp(o,s.paint.get("fill-extrusion-cutoff-fade-range")),q=s.paint.get("fill-extrusion-emissive-strength"),X=[];let G;R&&X.push("PROJECTION_GLOBE_VIEW"),S[0]>0&&X.push("FAUX_AO"),A&&X.push("ZERO_ROOF_RADIUS"),p&&X.push("HAS_CENTROID"),U>0&&X.push("FLOOD_LIGHT"),W.shouldRenderCutoff&&X.push("RENDER_CUTOFF");const Q="shadow"===o.renderPass,it=o.shadowRenderer,st=Q&&!!it;o.shadowRenderer&&(o.shadowRenderer.useNormalOffset=!0);let J=[0,0,0];if(it){const mt=o.style.directionalLight,ut=o.style.ambientLight;mt&&ut&&(J=VE(mt,ut)),G=X.concat(["SHADOWS_SINGLE_CASCADE"])}const et=st?"fillExtrusionDepth":w?"fillExtrusionPattern":"fillExtrusion",dt=s.getLayerRenderingStats();for(const mt of l){const ut=i.getTile(mt),bt=ut.getBucket(s);if(!bt||bt.projection.name!==y.projection.name)continue;let yt=!1;it&&(yt=0===it.getMaxCascadeForTile(mt.toUnwrapped()));const Ct=o.isTileAffectedByFog(mt),gt=bt.programConfigurations.get(s.id),At=o.getOrCreateProgram(et,{config:gt,defines:yt?G:X,overrideFog:Ct});if(o.terrain&&o.terrain.setupElevationDraw(ut,At,{useMeterToDem:!0}),!bt.centroidVertexBuffer){const ve=At.attributes.a_centroid_pos;void 0!==ve&&_.vertexAttrib2f(ve,0,0)}!Q&&it&&it.setupShadows(ut.tileID.toUnwrapped(),At,"vector-tile",ut.tileID.overscaledZ),w&&(o.context.activeTexture.set(_.TEXTURE0),ut.imageAtlasTexture&&ut.imageAtlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),gt.updatePaintBuffers());const Gt=v.constantOr(null);if(Gt&&ut.imageAtlas){const ve=ut.imageAtlas.patternPositions[Gt.toString()];ve&&gt.setConstantPatternPositions(ve)}const Et=s.paint.get("fill-extrusion-vertical-gradient");let te;if(Q&&it){if(W1(ut.tileID,bt,o))continue;const ve=it.calculateShadowPassMatrixFromTile(ut.tileID.toUnwrapped());te=kF(ve,P,H)}else{const ve=o.translatePosMatrix(mt.expandedProjMatrix,ut,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Ui=y.projection.createInversionMatrix(y,mt.canonical);te=w?SF(ve,o,Et,C,S,P,mt,ut,O,F,B,Ui,j,H):CE(ve,o,Et,C,S,P,mt,O,F,B,Ui,j,H,U,J,q)}o.uploadCommonUniforms(g,At,mt.toUnwrapped(),null,W);let ie=bt.segments;if("mercator"===y.projection.name&&!Q&&(ie=bt.getVisibleSegments(ut.tileID,o.terrain,o.transform.getFrustum(0)),!ie.get().length))continue;if(dt)if(Q)for(const ve of ie.get())dt.numRenderedVerticesInShadowPass+=ve.primitiveLength;else for(const ve of ie.get())dt.numRenderedVerticesInTransparentPass+=ve.primitiveLength;const He=[];(o.terrain||p)&&He.push(bt.centroidVertexBuffer),R&&He.push(bt.layoutVertexExtBuffer),At.draw(o,g.gl.TRIANGLES,d,u,m,hi.backCCW,te,s.id,bt.layoutVertexBuffer,bt.indexBuffer,ie,s.paint,o.transform.zoom,gt,He)}o.shadowRenderer&&(o.shadowRenderer.useNormalOffset=!1)}function gp(o,i,s,l,d,u,m,p,g,_,y,v,w,C,D,k,S,E,A){const P=o.context,O=P.gl,R=o.transform,F=o.transform.zoom,B=[],j=hp(o,s.paint.get("fill-extrusion-cutoff-fade-range"));"clear"===_?(B.push("CLEAR_SUBPASS"),A&&(B.push("CLEAR_FROM_TEXTURE"),P.activeTexture.set(O.TEXTURE0),A.bind(O.LINEAR,O.CLAMP_TO_EDGE))):"sdf"===_&&B.push("SDF_SUBPASS"),S&&B.push("HAS_CENTROID"),j.shouldRenderCutoff&&B.push("RENDER_CUTOFF");const U=s.layout.get("fill-extrusion-edge-radius"),H=(W,q,X,G,Q)=>{const it=q.programConfigurations.get(s.id),st=o.isTileAffectedByFog(W),J=o.getOrCreateProgram("fillExtrusionGroundEffect",{config:it,defines:B,overrideFog:st}),et={u_matrix:G,u_opacity:y,u_ao_pass:g?1:0,u_meter_to_tile:Q,u_ao:[v,w*Q],u_flood_light_intensity:C,u_flood_light_color:D,u_attenuation:k,u_edge_radius:F>=17?0:U*Q,u_fb:0,u_fb_size:A?A.size[0]:0},dt=[];S&&dt.push(q.hiddenByLandmarkVertexBuffer),o.uploadCommonUniforms(P,J,W.toUnwrapped(),null,j),J.draw(o,P.gl.TRIANGLES,d,u,m,p,et,s.id,q.vertexBuffer,q.indexBuffer,X,s.paint,F,it,dt)};for(const W of l){const q=i.getTile(W),X=q.getBucket(s);if(!X||X.projection.name!==R.projection.name||!X.groundEffect||X.groundEffect&&!X.groundEffect.hasData())continue;const G=X.groundEffect,Q=1/X.tileToMeter;{const it=o.translatePosMatrix(W.projMatrix,q,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),st=G.getDefaultSegment();H(W,G,st,it,Q)}if(E)for(let it=0;it<4;it++){const st=wx[it](W),J=i.getTile(st);if(!J)continue;const et=J.getBucket(s);if(!et||et.projection.name!==R.projection.name||!et.groundEffect||et.groundEffect&&!et.groundEffect.hasData())continue;const dt=et.groundEffect;let mt,ut;0===it?(mt=[-pt,0,0],ut=1):1===it?(mt=[pt,0,0],ut=0):2===it?(mt=[0,-pt,0],ut=3):(mt=[0,pt,0],ut=2);const bt=dt.regionSegments[ut];if(!bt)continue;const yt=new Float32Array(16);at.translate(yt,W.projMatrix,mt),H(W,dt,bt,o.translatePosMatrix(yt,q,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Q)}}}function LF(o,i,s,l,d,u,m){0===l.centroidVertexArray.length&&l.createCentroidsBuffer();const p=u?u.findDEMTileFor(s):null;if(!(p&&p.dem||m))return;const g=E=>{const A=i.getSource().minzoom,P=R=>{const F=i.getTileByID(R);if(F&&F.hasData())return F.getBucket(d)},O=[0,-1,1];for(const R of O){if(E.overscaledZ+R<A)continue;const F=P(E.calculateScaledKey(E.overscaledZ+R));if(F)return F}},_=[0,0,0],y=(E,A)=>(_[0]=Math.min(E.min.y,A.min.y),_[1]=Math.max(E.max.y,A.max.y),_[2]=pt-A.min.x>E.max.x?A.min.x-pt:E.max.x,_),v=(E,A)=>(_[0]=Math.min(E.min.x,A.min.x),_[1]=Math.max(E.max.x,A.max.x),_[2]=pt-A.min.y>E.max.y?A.min.y-pt:E.max.y,_),w=[(E,A)=>y(E,A),(E,A)=>y(A,E),(E,A)=>v(E,A),(E,A)=>v(A,E)],C=(E,A,P,O,R,F,B)=>{if(!u)return 0;const j=[[F?P:E,F?E:P,0],[F?P:A,F?A:P,0]],U=B<0?pt+B:B,H=[F?U:(E+A)/2,F?(E+A)/2:U,0];return 0===P&&B<0||0!==P&&B>0?u.getForTilePoints(R,[H],!0,O):j.push(H),u.getForTilePoints(s,j,!0,p),Math.max(j[0][2],j[1][2],H[2])/u.exaggeration()};for(let E=0;E<4;E++){const A=l.borderFeatureIndices[E];if(0===A.length)continue;const P=wx[E](s),O=g(P);if(!(O&&O instanceof rp)||l.borderDoneWithNeighborZ[E]===O.canonical.z)continue;0===O.centroidVertexArray.length&&O.createCentroidsBuffer();const R=u?u.findDEMTileFor(P):null;if(!(R&&R.dem||m))continue;const F=(E<2?1:5)-E,B=O.borderDoneWithNeighborZ[F]!==l.canonical.z,j=O.borderFeatureIndices[F];let U=0;if(l.canonical.z!==O.canonical.z){for(const H of A)l.showCentroid(l.featuresOnBorder[H]);if(B)for(const H of j)O.showCentroid(O.featuresOnBorder[H]);l.borderDoneWithNeighborZ[E]=O.canonical.z,O.borderDoneWithNeighborZ[F]=l.canonical.z}for(const H of A){const W=l.featuresOnBorder[H],q=l.centroidData[W.centroidDataIndex],X=W.borders[E];let G;for(;U<j.length;){G=O.featuresOnBorder[j[U]];const Q=G.borders[F];if(Q[1]>X[0]+3||Q[0]>X[0]-3)break;O.showCentroid(G),U++}if(G&&U<j.length){const Q=U;let it=0;for(;!(G.borders[F][0]>X[1]-3)&&(it++,++U!==j.length);)G=O.featuresOnBorder[j[U]];if(G=O.featuresOnBorder[j[Q]],it>1){const et=G.borders[F];Math.abs(X[0]-et[0])<3&&Math.abs(X[1]-et[1])<3&&(it=1,U=Q+1)}else if(0===it){l.showCentroid(W);continue}const st=O.centroidData[G.centroidDataIndex];m&&1===it&&(((k=q).flags|(S=st).flags)&lo?(k.flags|=lo,S.flags|=lo):(k.flags&=2147483647,S.flags&=2147483647));let J=new ot(0,0);if(it>1)U=Q;else if(R&&R.dem&&!(W.intersectsCount()>1||G.intersectsCount()>1)){const et=w[E](q,st),dt=E%2?pt-1:0;D=C(et[0],Math.min(pt-1,et[1]),dt,R,P,E<2,et[2]),J=new ot(Math.ceil(7*(D+450)),0)}q.centroidXY=st.centroidXY=J,l.writeCentroidToBuffer(q),O.writeCentroidToBuffer(st)}else l.showCentroid(W)}l.borderDoneWithNeighborZ[E]=O.canonical.z,O.borderDoneWithNeighborZ[F]=l.canonical.z}var D,k,S;(l.needsCentroidUpdate||!l.centroidVertexBuffer&&0!==l.centroidVertexArray.length)&&l.uploadCentroid(o)}const $1=[1,0,0],G1=[0,1,0],OE=[0,0,1];function W1(o,i,s){const l=s.transform,d=s.shadowRenderer;if(!d)return!0;const u=o.toUnwrapped(),m=l.tileSize*d._cascades[s.currentShadowCascade].scale;let p=i.maxHeight;if(l.elevation){const k=l.elevation.getMinMaxForTile(o);k&&(p+=k.max)}const g=[...d.shadowDirection];g[2]=-g[2];const _=d.computeSimplifiedTileShadowVolume(u,p,m,g);if(!_)return!1;const y=[$1,G1,OE,g,[g[0],0,g[2]],[0,g[1],g[2]]],v="globe"===l.projection.name,w=l.scaleZoom(m),C=al.fromInvProjectionMatrix(l.invProjMatrix,l.worldSize,w,!v),D=d.getCurrentCascadeFrustum();return 0===C.intersectsPrecise(_.vertices,_.planes,y)||0===D.intersectsPrecise(_.vertices,_.planes,y)}function q1(o){const i=o._nearZ,s=o.projection.farthestPixelDistance(o),l=s-i,d=.2*o.height,u=i+d;return[i,s,(u-d-i)/l,(u-i)/l]}const BF=new di(1,0,0,1),NF=new di(0,1,0,1),zF=new di(0,0,1,1),VF=new di(1,0,1,1),FE=new di(0,1,1,1);function Y1(o,i,s){const l=o.context,d=o.transform,u=l.gl,m="globe"===d.projection.name,p=m?["PROJECTION_GLOBE_VIEW"]:[];let g=s.projMatrix;if(m&&Dr(d.zoom)>0){const H=Vb(Hk(s.canonical,d));g=at.multiply(new Float32Array(16),d.globeMatrix,H),at.multiply(g,d.projMatrix,g)}const _=o.getOrCreateProgram("debug",{defines:p}),y=i.getTileByID(s.key);o.terrain&&o.terrain.setupElevationDraw(y,_);const v=Be.disabled,w=pi.disabled,C=o.colorModeForRenderPass(),D="$debug";l.activeTexture.set(u.TEXTURE0),o.emptyTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),m?y._makeGlobeTileDebugBuffers(o.context,d):y._makeDebugTileBoundsBuffers(o.context,d.projection);const k=y._tileDebugBuffer||o.debugBuffer,S=y._tileDebugIndexBuffer||o.debugIndexBuffer,E=y._tileDebugSegments||o.debugSegments;_.draw(o,u.LINE_STRIP,v,w,C,hi.disabled,AF(g,di.red),D,k,S,E,null,null,null,[y._globeTileDebugBorderBuffer]);const A=y.latestRawTileData,P=Math.floor((A&&A.byteLength||0)/1024),O=i.getTile(s).tileSize,R=512/Math.min(O,512)*(s.overscaledZ/d.zoom)*.5;let F=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(F+=` => ${s.overscaledZ}`),F+=` ${P}kb`,function(H,W){H.initDebugOverlayCanvas();const q=H.debugOverlayCanvas,X=H.context.gl,G=H.debugOverlayCanvas.getContext("2d");G.clearRect(0,0,q.width,q.height),G.shadowColor="white",G.shadowBlur=2,G.lineWidth=1.5,G.strokeStyle="white",G.textBaseline="top",G.font="bold 36px Open Sans, sans-serif",G.fillText(W,5,5),G.strokeText(W,5,5),H.debugOverlayTexture.update(q),H.debugOverlayTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE)}(o,F);const B=y._tileDebugTextBuffer||o.debugBuffer,j=y._tileDebugTextIndexBuffer||o.quadTriangleIndexBuffer,U=y._tileDebugTextSegments||o.debugSegments;_.draw(o,u.TRIANGLES,v,w,ji.alphaBlended,hi.disabled,AF(g,di.transparent,R),D,B,j,U,null,null,null,[y._globeTileDebugTextBuffer])}function pe(o,i,s,l){Fi(o,0,i+s/2,o.transform.width,s,l)}function Hi(o,i,s,l){Fi(o,i-s/2,0,s,o.transform.height,l)}function Fi(o,i,s,l,d,u){const m=o.context,p=m.gl;p.enable(p.SCISSOR_TEST),p.scissor(i*Ze.devicePixelRatio,s*Ze.devicePixelRatio,l*Ze.devicePixelRatio,d*Ze.devicePixelRatio),m.clear({color:u}),p.disable(p.SCISSOR_TEST)}const fe=Xe([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:jF}=fe;function Uc(o,i,s,l){o.emplaceBack(i,s,l)}class Z1{constructor(i){this.vertexArray=new kc,this.indices=new Cr,Uc(this.vertexArray,-1,-1,1),Uc(this.vertexArray,1,-1,1),Uc(this.vertexArray,-1,1,1),Uc(this.vertexArray,1,1,1),Uc(this.vertexArray,-1,-1,-1),Uc(this.vertexArray,1,-1,-1),Uc(this.vertexArray,-1,1,-1),Uc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,jF),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=on.simpleSegment(0,0,36,12)}}function _p(o,i,s,l,d,u){const m=o.context.gl,p=i.paint.get("sky-atmosphere-color"),g=i.paint.get("sky-atmosphere-halo-color"),_=i.paint.get("sky-atmosphere-sun-intensity"),y={u_matrix_3f:Zo.fromMat4(Zo.create(),l),u_sun_direction:d,u_sun_intensity:_,u_color_tint_r:[(D=p).r,D.g,D.b,D.a],u_color_tint_m:[(k=g).r,k.g,k.b,k.a],u_luminance:5e-5};var D,k;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_CUBE_MAP_POSITIVE_X+u,i.skyboxTexture,0),s.draw(o,m.TRIANGLES,Be.disabled,pi.disabled,ji.unblended,hi.frontCW,y,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const LE=Xe([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class bp{constructor(i){const s=new xu;s.emplaceBack(-1,1,1,0,0),s.emplaceBack(1,1,1,1,0),s.emplaceBack(1,-1,1,1,1),s.emplaceBack(-1,-1,1,0,1);const l=new Cr;l.emplaceBack(0,1,2),l.emplaceBack(2,3,0),this.vertexBuffer=i.createVertexBuffer(s,LE.members),this.indexBuffer=i.createIndexBuffer(l),this.segments=on.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const vs=Xe([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class yp{constructor(){this.colorModeAlphaBlendedWriteRGB=new ji([1,771,1,771],di.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new ji([1,0,1,0],di.transparent,[!1,!1,!1,!0])}update(i){const s=i.context;if(!this.atmosphereBuffer){this.atmosphereBuffer=new bp(s);const l=100,d=200,u=function(y){const v=vD(30),w=[];for(let C=0;C<16e3;++C){const D=2*Math.PI*v(),k=Math.acos(1-2*v())-.5*Math.PI;w.push(Z.fromValues(Math.cos(k)*Math.cos(D),Math.cos(k)*Math.sin(D),Math.sin(k)))}return w}(),m=vD(300),p=new X0,g=new Cr;let _=0;for(let y=0;y<u.length;++y){const v=Z.scale([],u[y],200),w=Math.max(0,1+.01*l*(1*m()-.5)),C=Math.max(0,1+.01*d*(1*m()-.5));p.emplaceBack(v[0],v[1],v[2],-1,-1,w,C),p.emplaceBack(v[0],v[1],v[2],1,-1,w,C),p.emplaceBack(v[0],v[1],v[2],1,1,w,C),p.emplaceBack(v[0],v[1],v[2],-1,1,w,C),g.emplaceBack(_+0,_+1,_+2),g.emplaceBack(_+0,_+2,_+3),_+=4}this.starsVx=s.createVertexBuffer(p,vs.members),this.starsIdx=s.createIndexBuffer(g),this.starsSegments=on.simpleSegment(0,0,p.length,g.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(i,s){const l=i.context,d=l.gl,u=i.transform,m=new Be(d.LEQUAL,Be.ReadOnly,[0,1]),p=Dr(u.zoom),g=s.properties.get("color").toArray01(),_=s.properties.get("high-color").toArray01(),y=s.properties.get("space-color").toArray01PremultipliedAlpha(),v=5e-4,w=he((s.properties.get("horizon-blend")-0)/1*.2495+v,5e-4,.25),C=xm(i,l,u)&&w===v?u.worldSize/(2*Math.PI*1.025)-1:u.globeRadius,D=i.frameCounter/1e3%1,k=Z.length(u.globeCenterInViewSpace),S=Math.sqrt(Math.pow(k,2)-Math.pow(C,2)),E=Math.acos(S/k),A=P=>{const O="globe"===u.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];P&&O.push("ALPHA_PASS");const R=i.getOrCreateProgram("globeAtmosphere",{defines:O}),F={u_frustum_tl:u.frustumCorners.TL,u_frustum_tr:u.frustumCorners.TR,u_frustum_br:u.frustumCorners.BR,u_frustum_bl:u.frustumCorners.BL,u_horizon:u.frustumCorners.horizon,u_transition:p,u_fadeout_range:w,u_color:g,u_high_color:_,u_space_color:y,u_temporal_offset:D,u_horizon_angle:E};i.uploadCommonUniforms(l,R);const B=this.atmosphereBuffer;B&&R.draw(i,d.TRIANGLES,m,pi.disabled,P?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,hi.backCW,F,P?"atmosphere_glow_alpha":"atmosphere_glow",B.vertexBuffer,B.indexBuffer,B.segments)};A(!1),A(!0)}drawStars(i,s){const l=he(s.properties.get("star-intensity"),0,1);if(0===l)return;const d=i.context,u=d.gl,m=i.transform,p=i.getOrCreateProgram("stars"),g=_o.identity([]);_o.rotateX(g,g,-m._pitch),_o.rotateZ(g,g,-m.angle),_o.rotateX(g,g,ni(m._center.lat)),_o.rotateY(g,g,-ni(m._center.lng));const _=at.fromQuat(new Float32Array(16),g),y=at.multiply([],m.starsProjMatrix,_),v=Zo.fromMat4([],_),w=Zo.invert([],v),C=[0,1,0];Z.transformMat3(C,C,w),Z.scale(C,C,.15);const D=[1,0,0];Z.transformMat3(D,D,w),Z.scale(D,D,.15);const k=(E=C,A=D,P=l,{u_matrix:Float32Array.from(y),u_up:E,u_right:A,u_intensity_multiplier:P});var E,A,P;i.uploadCommonUniforms(d,p),this.starsVx&&this.starsIdx&&p.draw(i,u.TRIANGLES,Be.disabled,pi.disabled,this.colorModeAlphaBlendedWriteRGB,hi.disabled,k,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function BE(o,i){const s=[...o],l=i.cameraWorldSizeForFog/i.worldSize,d=at.identity([]);return at.scale(d,d,[l,l,1]),at.multiply(s,d,s),at.multiply(s,i.worldToFogMatrix,s),s}function X1(o,i,s,l){const d=s.material,u=l.context,{baseColorTexture:m,metallicRoughnessTexture:p}=d.pbrMetallicRoughness,{normalTexture:g,occlusionTexture:_,emissionTexture:y}=d;function v(w,C,D){if(w&&(o.push(C),u.activeTexture.set(u.gl.TEXTURE0+D),w.gfxTexture)){const{minFilter:k,magFilter:S,wrapS:E,wrapT:A}=w.sampler;w.gfxTexture.bindExtraParam(k,S,E,A)}}v(m,"HAS_TEXTURE_u_baseColorTexture",Us.BaseColor),v(p,"HAS_TEXTURE_u_metallicRoughnessTexture",Us.MetallicRoughness),v(g,"HAS_TEXTURE_u_normalTexture",Us.Normal),v(_,"HAS_TEXTURE_u_occlusionTexture",Us.Occlusion),v(y,"HAS_TEXTURE_u_emissionTexture",Us.Emission),s.texcoordBuffer&&(o.push("HAS_ATTRIBUTE_a_uv_2f"),i.push(s.texcoordBuffer)),s.colorBuffer&&(o.push(12===s.colorBuffer.itemSize?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),i.push(s.colorBuffer)),s.normalBuffer&&(o.push("HAS_ATTRIBUTE_a_normal_3f"),i.push(s.normalBuffer)),s.pbrBuffer&&(o.push("HAS_ATTRIBUTE_a_pbr"),o.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),i.push(s.pbrBuffer)),"OPAQUE"!==d.alphaMode&&"MASK"!==d.alphaMode||o.push("UNPREMULT_TEXTURE_IN_SHADER"),d.defined||o.push("DIFFUSE_SHADED"),o.push("USE_STANDARD_DERIVATIVES")}function K1(o,i,s,l,d,u){const m=s.paint.get("model-opacity"),p=i.context,g=new Be(i.context.gl.LEQUAL,Be.ReadWrite,i.depthRangeFor3D),_=i.transform,y=o.mesh,v=y.material,w=v.pbrMetallicRoughness,C=i.style.fog;let D;D="pixels"===i.transform.projection.zAxisUnit?[...o.nodeModelMatrix]:at.multiply([],l.zScaleMatrix,o.nodeModelMatrix),at.multiply(D,l.negCameraPosMatrix,D);const k=at.invert([],D);at.transpose(k,k);const S=s.paint.get("model-emissive-strength").constantOr(0),E=Yy(new Float32Array(o.worldViewProjection),new Float32Array(D),new Float32Array(k),i,m,w.baseColorFactor,v.emissiveFactor,w.metallicFactor,w.roughnessFactor,v,S,s),A={defines:[]},P=[];X1(A.defines,P,y,i);const O=i.shadowRenderer;O&&(O.useNormalOffset=!1);let R=null;if(C){const j=BE(o.nodeModelMatrix,i.transform);if(R=new Float32Array(j),"globe"!==_.projection.name){const U=y.aabb.min,H=y.aabb.max,[W,q]=C.getOpacityForBounds(j,U[0],U[1],H[0],H[1]);A.overrideFog=W>=Nd||q>=Nd}}const F=hp(i,s.paint.get("model-cutoff-fade-range"));F.shouldRenderCutoff&&A.defines.push("RENDER_CUTOFF");const B=i.getOrCreateProgram("model",A);i.uploadCommonUniforms(p,B,null,R,F),"shadow"!==i.renderPass&&O&&O.setupShadowsFromMatrix(o.nodeModelMatrix,B),B.draw(i,p.gl.TRIANGLES,g,d,u,y.material.doubleSided?hi.disabled:hi.backCCW,E,s.id,y.vertexBuffer,y.indexBuffer,y.segments,s.paint,i.transform.zoom,void 0,P)}function UF(o,i,s,l,d,u,m){let p;p="globe"===o.projection.name?Bw(s,o):[...s],at.multiply(p,p,i.matrix);const g=at.multiply([],l,p);if(i.meshes)for(const _ of i.meshes){if("BLEND"!==_.material.alphaMode){m.push({mesh:_,depth:0,modelIndex:d,worldViewProjection:g,nodeModelMatrix:p});continue}const y=Z.transformMat4([],_.centroid,g);y[2]>0&&u.push({mesh:_,depth:y[2],modelIndex:d,worldViewProjection:g,nodeModelMatrix:p})}if(i.children)for(const _ of i.children)UF(o,_,s,l,d,u,m)}function Zy(o,i,s,l){const d=s.shadowRenderer;if(!d)return;const u=d.getShadowPassDepthMode(),m=d.getShadowPassColorMode(),p=d.calculateShadowPassMatrixFromMatrix(i),g=TE(p);s.getOrCreateProgram("modelDepth",{defines:["DEPTH_TEXTURE"]}).draw(s,s.context.gl.TRIANGLES,u,pi.disabled,m,hi.backCCW,g,l.id,o.vertexBuffer,o.indexBuffer,o.segments,l.paint,s.transform.zoom,void 0,void 0)}function Q1(o,i,s){const l=i.updateZoomBasedPaintProperties(),d=function(u,m,p){let g,_,y,v=u.terrain?u.terrain.exaggeration():0;if(u.terrain&&v>0){const w=u.terrain,C=w.findDEMTileFor(p);C&&C.dem?g=zu.create(w,p,C):v=0}if(0===v&&(m.terrainElevationMin=0,m.terrainElevationMax=0),v===m.validForExaggeration&&(0===v||g&&g._demTile&&g._demTile.tileID===m.validForDEMTile.id&&g._dem._timestamp===m.validForDEMTile.timestamp))return!1;for(const w in m.instancesPerModel){const C=m.instancesPerModel[w];for(let D=0;D<C.instancedDataArray.length;++D){const k=(g?v*g.getElevationAt(0|C.instancedDataArray.float32[16*D],0|C.instancedDataArray.float32[16*D+1],!0,!0):0)+C.instancesEvaluatedElevation[D];C.instancedDataArray.float32[16*D+6]=k,_=_?Math.min(m.terrainElevationMin,k):k,y=y?Math.max(m.terrainElevationMax,k):k}}return m.terrainElevationMin=_||0,m.terrainElevationMax=y||0,m.validForExaggeration=v,m.validForDEMTile=g&&g._demTile?{id:g._demTile.tileID,timestamp:g._dem._timestamp}:{id:void 0,timestamp:0},!0}(o,i,s);(l||d)&&(i.uploaded=!1,i.upload(o.context))}const Hc={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new gn([0,0,0],[pt,pt,0])};function cV(o,i){const s=1<<o.canonical.z,l=i.getFreeCameraOptions().position,d=i.elevation,u=o.canonical.x/s,m=(o.canonical.x+1)/s,p=o.canonical.y/s,g=(o.canonical.y+1)/s;let _=i._centerAltitude;if(d){const C=d.getMinMaxForTile(o);C&&C.max>_&&(_=C.max)}const y=he(l.x,u,m)-l.x,v=he(l.y,p,g)-l.y,w=sn(_,i.center.lat)-l.z;return i._zoomFromMercatorZ(Math.sqrt(y*y+v*v+w*w))}function HF(o,i,s,l,d,u,m){const p=o.context,g="shadow"===o.renderPass,_=o.shadowRenderer,y=g&&_?_.getShadowPassDepthMode():new Be(p.gl.LEQUAL,Be.ReadWrite,o.depthRangeFor3D),v=o.isTileAffectedByFog(u);if(s.meshes)for(const w of s.meshes){const C=["MODEL_POSITION_ON_GPU"],D=[];let k,S,E;l.instancedDataArray.length>20&&C.push("INSTANCED_ARRAYS");const A=hp(o,i.paint.get("model-cutoff-fade-range"));if(A.shouldRenderCutoff&&C.push("RENDER_CUTOFF"),g&&_)k=o.getOrCreateProgram("modelDepth",{defines:C}),S=TE(m.shadowTileMatrix,m.shadowTileMatrix,Float32Array.from(s.matrix)),E=_.getShadowPassColorMode();else{X1(C,D,w,o),k=o.getOrCreateProgram("model",{defines:C,overrideFog:v});const O=w.material,R=O.pbrMetallicRoughness,F=i.paint.get("model-opacity"),B=i.paint.get("model-emissive-strength").constantOr(0);S=Yy(u.expandedProjMatrix,Float32Array.from(s.matrix),new Float32Array(16),o,F,R.baseColorFactor,O.emissiveFactor,R.metallicFactor,R.roughnessFactor,O,B,i,d),_&&(m.shadowUniformsInitialized?k.setShadowUniformValues(p,_.getShadowUniformValues()):(_.setupShadows(u.toUnwrapped(),k,"model-tile",u.overscaledZ),m.shadowUniformsInitialized=!0)),E=A.shouldRenderCutoff||F<1||"OPAQUE"!==O.alphaMode?ji.alphaBlended:ji.unblended}o.uploadCommonUniforms(p,k,u.toUnwrapped(),null,A);const P=w.material.doubleSided?hi.disabled:hi.backCCW;if(l.instancedDataArray.length>20)D.push(l.instancedDataBuffer),k.draw(o,p.gl.TRIANGLES,y,pi.disabled,E,P,S,i.id,w.vertexBuffer,w.indexBuffer,w.segments,i.paint,o.transform.zoom,void 0,D,l.instancedDataArray.length);else{const O=g?"u_instance":"u_normal_matrix";for(let R=0;R<l.instancedDataArray.length;++R)S[O]=new Float32Array(l.instancedDataArray.arrayBuffer,64*R,16),k.draw(o,p.gl.TRIANGLES,y,pi.disabled,E,P,S,i.id,w.vertexBuffer,w.indexBuffer,w.segments,i.paint,o.transform.zoom,void 0,D)}}if(s.children)for(const w of s.children)HF(o,i,w,l,d,u,m)}const Wg=[1,-1,1];function $F(o,i,s,l){if(!s.modelManager)return!0;const d=s.modelManager;if(!s.shadowRenderer)return!0;const u=s.shadowRenderer,m=i.aabb;let p=!0,g=o.maxHeight;if(0===g){let y=0;for(const v in o.instancesPerModel){const w=d.getModel(v,l);w?y=Math.max(y,Math.max(Math.max(w.aabb.max[0],w.aabb.max[1]),w.aabb.max[2])):p=!1}g=o.maxScale*y*1.41+o.maxVerticalOffset,p&&(o.maxHeight=g)}m.max[2]=g,m.min[2]+=o.terrainElevationMin,m.max[2]+=o.terrainElevationMax,Z.transformMat4(m.min,m.min,i.tileMatrix),Z.transformMat4(m.max,m.max,i.tileMatrix);const _=m.intersects(u.getCurrentCascadeFrustum());return 0===s.currentShadowCascade&&(o.isInsideFirstShadowMapFrustum=2===_),0===_}class J1{}class GF{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(i,s,l){{const v=this._storage.get(s.id);if(v)return v.lastUsedFrameIdx=i,v.buf}const d=l.gl,u=d.getBufferParameter(d.ELEMENT_ARRAY_BUFFER,d.BUFFER_SIZE),m=new ArrayBuffer(u),p=new Int16Array(m);d.getBufferSubData(d.ELEMENT_ARRAY_BUFFER,0,new Int16Array(m));const g=new Dc;for(let v=0;v<u/2;v+=3){const w=p[v],C=p[v+1],D=p[v+2];g.emplaceBack(w,C),g.emplaceBack(C,D),g.emplaceBack(D,w)}const _=l.bindVertexArrayOES.current,y=new J1;return y.buf=new Yu(l,g),y.lastUsedFrameIdx=i,this._storage.set(s.id,y),l.bindVertexArrayOES.set(_),y.buf}update(i){for(const[s,l]of this._storage)i-l.lastUsedFrameIdx>30&&(l.buf.destroy(),this._storage.delete(s))}destroy(){for(const[i,s]of this._storage)s.buf.destroy(),this._storage.delete(i)}}const tC={symbol:function(o,i,s,l,d){if("translucent"!==o.renderPass)return;const u=pi.disabled,m=o.colorModeForRenderPass();s.layout.get("text-variable-anchor")&&function(p,g,_,y,v,w,C){const D=g.transform,k="map"===v,S="map"===w;for(const E of p){const A=y.getTile(E),P=A.getBucket(_);if(!P||!P.text||!P.text.segments.get().length)continue;const O=Xl(P.textSizeData,D.zoom),R=Vy(E,P.getProjection(),D),F=D.calculatePixelsToTileUnitsMatrix(A),B=Dg(R,A.tileID.canonical,S,k,D,P.getProjection(),F),j=P.hasIconTextFit()&&P.hasIconData();if(O){const U=Math.pow(2,D.zoom-A.tileID.overscaledZ);PE(P,k,S,C,xS,D,B,E,U,O,j)}}}(l,o,s,i,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),d),0!==s.paint.get("icon-opacity").constantOr(1)&&j1(o,i,s,l,!1,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),s.layout.get("icon-rotation-alignment"),s.layout.get("icon-pitch-alignment"),s.layout.get("icon-keep-upright"),s.paint.get("icon-color-saturation"),u,m),0!==s.paint.get("text-opacity").constantOr(1)&&j1(o,i,s,l,!0,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),s.layout.get("text-keep-upright"),s.paint.get("icon-color-saturation"),u,m),i.map.showCollisionBoxes&&(AE(o,i,s,l,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),AE(o,i,s,l,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(o,i,s,l){if("translucent"!==o.renderPass)return;const d=s.paint.get("circle-opacity"),u=s.paint.get("circle-stroke-width"),m=s.paint.get("circle-stroke-opacity"),p=void 0!==s.layout.get("circle-sort-key").constantOr(1),g=s.paint.get("circle-emissive-strength");if(0===d.constantOr(1)&&(0===u.constantOr(1)||0===m.constantOr(1)))return;const _=o.context,y=_.gl,v=o.transform,w=o.depthModeForSublayer(0,Be.ReadOnly),C=pi.disabled,D=o.colorModeForDrapableLayerRenderPass(g),k="globe"===v.projection.name,S=[dr(v.center.lng),Rr(v.center.lat)],E=[];for(let P=0;P<l.length;P++){const O=l[P],R=i.getTile(O),F=R.getBucket(s);if(!F||F.projection.name!==v.projection.name)continue;const B=F.programConfigurations.get(s.id),j=tS(s),U=o.isTileAffectedByFog(O);k&&j.push("PROJECTION_GLOBE_VIEW");const H=o.getOrCreateProgram("circle",{config:B,defines:j,overrideFog:U}),W=F.layoutVertexBuffer,q=F.globeExtVertexBuffer,X=F.indexBuffer,G=v.projection.createInversionMatrix(v,O.canonical),Q={programConfiguration:B,program:H,layoutVertexBuffer:W,globeExtVertexBuffer:q,indexBuffer:X,uniformValues:Dm(o,O,R,G,S,s),tile:R};if(p){const it=F.segments.get();for(const st of it)E.push({segments:new on([st]),sortKey:st.sortKey,state:Q})}else E.push({segments:F.segments,sortKey:0,state:Q})}p&&E.sort((P,O)=>P.sortKey-O.sortKey);const A={useDepthForOcclusion:v.depthOcclusionForSymbolsAndCircles};for(const P of E){const{programConfiguration:O,program:R,layoutVertexBuffer:F,globeExtVertexBuffer:B,indexBuffer:j,uniformValues:U,tile:H}=P.state,W=P.segments;o.terrain&&o.terrain.setupElevationDraw(H,R,A),o.uploadCommonUniforms(_,R,H.tileID.toUnwrapped()),R.draw(o,y.TRIANGLES,w,C,D,hi.disabled,U,s.id,F,j,W,s.paint,v.zoom,O,[B])}},heatmap:function(o,i,s,l){if(0!==s.paint.get("heatmap-opacity"))if("offscreen"===o.renderPass){const d=o.context,u=d.gl,m=pi.disabled,p=new ji([u.ONE,u.ONE,u.ONE,u.ONE],di.transparent,[!0,!0,!0,!0]);(function(C,D,k,S){const E=C.gl,A=D.width*S,P=D.height*S;C.activeTexture.set(E.TEXTURE1),C.viewport.set([0,0,A,P]);let O=k.heatmapFbo;if(!O||O&&(O.width!==A||O.height!==P)){O&&O.destroy();const R=E.createTexture();E.bindTexture(E.TEXTURE_2D,R),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.LINEAR),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.LINEAR),O=k.heatmapFbo=C.createFramebuffer(A,P,!0,null),function(F,B,j,U,H,W){const q=F.gl;q.texImage2D(q.TEXTURE_2D,0,F.extRenderToTextureHalfFloat?q.RGBA16F:q.RGBA,H,W,0,q.RGBA,F.extRenderToTextureHalfFloat?q.HALF_FLOAT:q.UNSIGNED_BYTE,null),U.colorAttachment.set(j)}(C,0,R,O,A,P)}else E.bindTexture(E.TEXTURE_2D,O.colorAttachment.get()),C.bindFramebuffer.set(O.framebuffer)})(d,o,s,"globe"===o.transform.projection.name?.5:.25),d.clear({color:di.transparent});const g=o.transform,_="globe"===g.projection.name,y=_?["PROJECTION_GLOBE_VIEW"]:[],v=_?hi.frontCCW:hi.disabled,w=[dr(g.center.lng),Rr(g.center.lat)];for(let C=0;C<l.length;C++){const D=l[C];if(i.hasRenderableParent(D))continue;const k=i.getTile(D),S=k.getBucket(s);if(!S||S.projection.name!==g.projection.name)continue;const E=o.isTileAffectedByFog(D),A=S.programConfigurations.get(s.id),P=o.getOrCreateProgram("heatmap",{config:A,defines:y,overrideFog:E}),{zoom:O}=o.transform;o.terrain&&o.terrain.setupElevationDraw(k,P),o.uploadCommonUniforms(d,P,D.toUnwrapped());const R=g.projection.createInversionMatrix(g,D.canonical);P.draw(o,u.TRIANGLES,Be.disabled,m,p,v,lV(o,D,k,R,w,O,s.paint.get("heatmap-intensity")),s.id,S.layoutVertexBuffer,S.indexBuffer,S.segments,s.paint,o.transform.zoom,A,_?[S.globeExtVertexBuffer]:null)}d.viewport.set([0,0,o.width,o.height])}else"translucent"===o.renderPass&&(o.context.setColorMode(o.colorModeForRenderPass()),function(d,u){const m=d.context,p=m.gl,g=u.heatmapFbo;if(!g)return;m.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,g.colorAttachment.get()),m.activeTexture.set(p.TEXTURE1);let _=u.colorRampTexture;_||(_=u.colorRampTexture=new Un(m,u.colorRamp,p.RGBA)),_.bind(p.LINEAR,p.CLAMP_TO_EDGE),d.getOrCreateProgram("heatmapTexture").draw(d,p.TRIANGLES,Be.disabled,pi.disabled,d.colorModeForRenderPass(),hi.disabled,{u_image:0,u_color_ramp:1,u_opacity:u.paint.get("heatmap-opacity")},u.id,d.viewportBuffer,d.quadTriangleIndexBuffer,d.viewportSegments,u.paint,d.transform.zoom)}(o,s))},line:function(o,i,s,l){if("translucent"!==o.renderPass)return;const d=s.paint.get("line-opacity"),u=s.paint.get("line-width");if(0===d.constantOr(1)||0===u.constantOr(1))return;const m=s.paint.get("line-emissive-strength"),p=o.depthModeForSublayer(0,Be.ReadOnly),g=o.colorModeForDrapableLayerRenderPass(m),_=o.terrain&&o.terrain.renderingToTexture?1:Ze.devicePixelRatio,y=s.paint.get("line-dasharray"),v=y.constantOr(1),w=s.layout.get("line-cap"),C=s.paint.get("line-pattern"),D=C.constantOr(1),k=s.paint.get("line-pattern").constantOr(1),S=1!==s.paint.get("line-opacity").constantOr(1);let E=!k&&S;const A=s.paint.get("line-gradient"),P=D?"linePattern":"line",O=o.context,R=O.gl,F=IT(s);o.terrain&&o.terrain.clipOrMaskOverlapStencilType()&&(E=!1);for(const B of l){const j=i.getTile(B);if(D&&!j.patternsLoaded())continue;const U=j.getBucket(s);if(!U)continue;o.prepareDrawTile();const H=U.programConfigurations.get(s.id),W=o.isTileAffectedByFog(B),q=o.getOrCreateProgram(P,{config:H,defines:F,overrideFog:W}),X=C.constantOr(null);if(X&&j.imageAtlas){const mt=j.imageAtlas.patternPositions[X.toString()];mt&&H.setConstantPatternPositions(mt)}const G=y.constantOr(null),Q=w.constantOr(null);if(!D&&G&&Q&&j.lineAtlas){const mt=j.lineAtlas.getDash(G,Q);mt&&H.setConstantPatternPositions(mt)}let[it,st]=s.paint.get("line-trim-offset");("round"===Q||"square"===Q)&&it!==st&&(0===it&&(it-=1),1===st&&(st+=1));const J=o.terrain?B.projMatrix:null,et=D?AT(o,j,s,J,_):ET(o,j,s,J,U.lineClipsArray.length,_,[it,st]);if(A){const mt=U.gradients[s.id];let ut=mt.texture;if(s.gradientVersion!==mt.version){let bt=256;if(s.stepInterpolant){const yt=i.getSource().maxzoom,Ct=B.canonical.z===yt?Math.ceil(1<<o.transform.maxZoom-B.canonical.z):1;bt=he(Ti(U.maxLineLength/pt*1024*Ct),256,O.maxTextureSize)}mt.gradient=Kb({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:bt,image:mt.gradient||void 0,clips:U.lineClipsArray}),mt.texture?mt.texture.update(mt.gradient):mt.texture=new Un(O,mt.gradient,R.RGBA),mt.version=s.gradientVersion,ut=mt.texture}O.activeTexture.set(R.TEXTURE1),ut.bind(s.stepInterpolant?R.NEAREST:R.LINEAR,R.CLAMP_TO_EDGE)}v&&(O.activeTexture.set(R.TEXTURE0),j.lineAtlasTexture&&j.lineAtlasTexture.bind(R.LINEAR,R.REPEAT),H.updatePaintBuffers()),D&&(O.activeTexture.set(R.TEXTURE0),j.imageAtlasTexture&&j.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),H.updatePaintBuffers()),o.uploadCommonUniforms(O,q,B.toUnwrapped());const dt=mt=>{q.draw(o,R.TRIANGLES,p,mt,g,hi.disabled,et,s.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,s.paint,o.transform.zoom,H,[U.layoutVertexBuffer2])};if(E){const mt=o.stencilModeForClipping(B).ref;0===mt&&o.terrain&&O.clear({stencil:0});const ut={func:R.EQUAL,mask:255};et.u_alpha_discard_threshold=.8,dt(new pi(ut,mt,255,R.KEEP,R.KEEP,R.INVERT)),et.u_alpha_discard_threshold=0,dt(new pi(ut,mt,255,R.KEEP,R.KEEP,R.KEEP))}else dt(o.stencilModeForClipping(B))}E&&(o.resetStencilClippingMasks(),o.terrain&&O.clear({stencil:0}))},fill:function(o,i,s,l){const d=s.paint.get("fill-color"),u=s.paint.get("fill-opacity");if(0===u.constantOr(1))return;const m=s.paint.get("fill-emissive-strength"),p=o.colorModeForDrapableLayerRenderPass(m),g=s.paint.get("fill-pattern"),_=o.opaquePassEnabledForLayer()&&!g.constantOr(1)&&1===d.constantOr(di.transparent).a&&1===u.constantOr(0)?"opaque":"translucent";if(o.renderPass===_){const y=o.depthModeForSublayer(1,"opaque"===o.renderPass?Be.ReadWrite:Be.ReadOnly);H1(o,i,s,l,y,p,!1)}if("translucent"===o.renderPass&&s.paint.get("fill-antialias")){const y=o.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,Be.ReadOnly);H1(o,i,s,l,y,p,!0)}},"fill-extrusion":function(o,i,s,l){const d=s.paint.get("fill-extrusion-opacity"),u=o.context,m=u.gl,p=o.terrain,g=p&&p.renderingToTexture,_=s.paint.get("fill-extrusion-cutoff-fade-range");if(0===d)return;const y=o.conflationActive&&o.layerUsedInConflation(s,i.getSource());if(y&&function(v,w,C,D){for(const k of D){const S=w.getTile(k).getBucket(C);S&&(S.updateReplacement(k,v.replacementSource),S.uploadCentroid(v.context))}}(o,i,s,l),p||y)for(const v of l){const w=i.getTile(v).getBucket(s);w&&LF(o.context,i,v,w,s,p,y)}if("shadow"===o.renderPass&&o.shadowRenderer){const v=o.shadowRenderer;if(p&&d<.65&&s._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof vc)return;const w=v.getShadowPassDepthMode(),C=v.getShadowPassColorMode();Gg(o,i,s,l,w,pi.disabled,C,y)}else if("translucent"===o.renderPass){const v=!s.paint.get("fill-extrusion-pattern").constantOr(1);if(!g){const w=new Be(o.context.gl.LEQUAL,Be.ReadWrite,o.depthRangeFor3D);0===_&&1===d&&v?Gg(o,i,s,l,w,pi.disabled,ji.unblended,y):(Gg(o,i,s,l,w,pi.disabled,ji.disabled,y),Gg(o,i,s,l,w,o.stencilModeFor3D(),o.colorModeForRenderPass(),y),o.resetStencilClippingMasks())}if(o.style.enable3dLights()&&v&&(!p&&"globe"!==o.transform.projection.name||g)){const w=s.paint.get("fill-extrusion-opacity"),C=s.paint.get("fill-extrusion-ambient-occlusion-intensity"),D=s.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),k=s.paint.get("fill-extrusion-flood-light-intensity"),S=s.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),E=C>0&&D>0,A=k>0,P=(R,F,B)=>(1-B)*R+B*F,O=R=>{const F=o.depthModeForSublayer(1,Be.ReadOnly,m.LEQUAL,!0),B=s.paint.get(R?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),j=P(.1,3,B),U=o._showOverdrawInspector;if(!U){const H=new pi({func:m.ALWAYS,mask:255},255,255,m.KEEP,m.KEEP,m.REPLACE),W=new ji([m.ONE,m.ONE,m.ONE,m.ONE],di.transparent,[!1,!1,!1,!0],m.MIN);gp(o,i,s,l,F,H,W,hi.disabled,R,"sdf",w,C,D,k,S,j,y,!1)}{const H=U?pi.disabled:new pi({func:m.EQUAL,mask:255},255,255,m.KEEP,m.DECR,m.DECR),W=U?o.colorModeForRenderPass():new ji([m.ONE_MINUS_DST_ALPHA,m.DST_ALPHA,m.ONE,m.ONE],di.transparent,[!0,!0,!0,!0]);gp(o,i,s,l,F,H,W,hi.disabled,R,"color",w,C,D,k,S,j,y,!1)}};if(g){const R=(F,B,j)=>{const U=o.depthModeForSublayer(1,Be.ReadOnly,m.LEQUAL,!1),H=s.paint.get(F?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),W=P(.1,3,H);{const q=new ji([m.ONE,m.ONE,m.ONE,m.ONE],di.transparent,[!1,!1,!1,!0]);gp(o,i,s,l,U,pi.disabled,q,hi.disabled,F,"clear",w,C,D,k,S,W,y,B)}{const q=new pi({func:m.ALWAYS,mask:255},255,255,m.KEEP,m.KEEP,m.REPLACE),X=new ji([m.ONE,m.ONE,m.ONE,m.ONE],di.transparent,[!1,!1,!1,!0],m.MIN);gp(o,i,s,l,U,q,X,hi.disabled,F,"sdf",w,C,D,k,S,W,y,B)}{const q=F?m.ZERO:m.ONE_MINUS_DST_ALPHA,X=new pi({func:m.EQUAL,mask:255},255,255,m.KEEP,m.DECR,m.DECR),G=new ji([q,m.DST_ALPHA,m.ONE_MINUS_DST_ALPHA,m.ZERO],di.transparent,[!0,!0,!0,!0]);gp(o,i,s,l,U,X,G,hi.disabled,F,"color",w,C,D,k,S,W,y,B)}{const q=new ji([m.ONE,m.ONE,m.ONE,F?m.ZERO:m.ONE],di.transparent,[!1,!1,!1,!0],F?m.FUNC_ADD:m.MAX);gp(o,i,s,l,U,pi.disabled,q,hi.disabled,F,"clear",w,C,D,k,S,W,y,B,j)}};if(E||A){let F;if(o.prepareDrawTile(),p){const B=p.drapeBufferSize[0],j=p.drapeBufferSize[1];F=p.framebufferCopyTexture,F&&(!F||F.size[0]===B&&F.size[1]===j)||(F&&F.destroy(),F=p.framebufferCopyTexture=new Un(u,new _r({width:B,height:j}),m.RGBA)),F.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.copyTexImage2D(m.TEXTURE_2D,0,m.RGBA,0,0,B,j,0)}E&&R(!0,!1,F),A&&R(!1,!0,F)}}else E&&O(!0),A&&O(!1)}}},hillshade:function(o,i,s,l){if("offscreen"!==o.renderPass&&"translucent"!==o.renderPass||o.style.disableElevatedTerrain)return;const d=o.context,u=o.terrain&&o.terrain.renderingToTexture,[m,p]="translucent"!==o.renderPass||u?[{},l]:o.stencilConfigForOverlap(l);for(const g of p){const _=i.getTile(g);if(_.needsHillshadePrepare&&"offscreen"===o.renderPass)xF(o,_,s);else if("translucent"===o.renderPass){const y=o.depthModeForSublayer(0,Be.ReadOnly),v=s.paint.get("hillshade-emissive-strength"),w=o.colorModeForDrapableLayerRenderPass(v),C=u&&o.terrain?o.terrain.stencilModeForRTTOverlap(g):m[g.overscaledZ];aV(o,g,_,s,y,C,w)}}d.viewport.set([0,0,o.width,o.height]),o.resetStencilClippingMasks()},raster:function(o,i,s,l,d,u){if("translucent"!==o.renderPass||0===s.paint.get("raster-opacity"))return;const m=o.context,p=m.gl,g=i.getSource(),_=function(B,j,U){const H=B.paint.get("raster-color"),W=[],q=B.paint.get("raster-resampling"),X=B.paint.get("raster-color-mix"),G=B.paint.get("raster-color-range"),Q=[X[0],X[1],X[2],0],it=X[3],st="nearest"===q?U.NEAREST:U.LINEAR;if(H&&W.push("RASTER_COLOR"),H){j.activeTexture.set(U.TEXTURE2);let J=B.colorRampTexture;J||(J=B.colorRampTexture=new Un(j,B.colorRamp,U.RGBA)),J.bind(U.LINEAR,U.CLAMP_TO_EDGE)}return{mix:Q,range:G,offset:it,defines:W,resampling:st}}(s,m,p),y=_.defines,v="globe"===o.transform.projection.name;let w=!1;if(g instanceof Fa&&!l.length){if(!v)return;if(g.onNorthPole)w=!0,y.push("GLOBE_POLES");else{if(!g.onSouthPole)return;w=!0,y.push("GLOBE_POLES")}}const C=s.paint.get("raster-emissive-strength"),D=o.colorModeForDrapableLayerRenderPass(C),k=o.terrain&&o.terrain.renderingToTexture,S=g instanceof Fa&&0!==s.paint.get("raster-elevation"),E=!o.options.moving,A="nearest"===s.paint.get("raster-resampling")?p.NEAREST:p.LINEAR;if(w){const B=i.getSource();if(!(B instanceof Fa))return;const j=B.texture;if(!j)return;const U=o.globeSharedBuffers;if(!U)return;const H=new Be(p.LEQUAL,Be.ReadWrite,o.depthRangeFor3D),W=Float32Array.from(o.transform.expandedFarZProjMatrix);let q=Wl(0,0,o.transform);const X=Float32Array.from(kd(da(new ca(0,0,0)))),G={opacity:1,mix:0};o.terrain&&o.terrain.prepareDrawTile(),m.activeTexture.set(p.TEXTURE0),j.bind(A,p.CLAMP_TO_EDGE),m.activeTexture.set(p.TEXTURE1),j.bind(A,p.CLAMP_TO_EDGE),j.useMipmap&&m.extTextureFilterAnisotropic&&o.transform.pitch>20&&p.texParameterf(p.TEXTURE_2D,m.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,m.extTextureFilterAnisotropicMax);const[Q,it,st,J]=U.getPoleBuffers(0,!0);let et;B.onNorthPole?(et=Q,o.renderDefaultNorthPole=!1):(q=at.scale(at.create(),q,[1,-1,1]),et=it,o.renderDefaultSouthPole=!1);const dt=(ut=W,bt=X,yt=q,Ct=G,gt=s,At=B.perspectiveTransform||[0,0],Gt=s.paint.get("raster-elevation"),te=_.mix,ie=_.offset,He=_.range,ve=C,Jr(ut,bt,yt,new Float32Array(16),new Float32Array(9),[0,0],[0,0,0,0],0,[0,0],[0,0,0,0],1,Ct,gt,At||[0,0],Gt,2,te,ie,He,1,0,ve)),mt=o.getOrCreateProgram("raster",{defines:_.defines});return o.uploadCommonUniforms(m,mt,null),void mt.draw(o,p.TRIANGLES,H,pi.disabled,D,hi.disabled,dt,s.id,et,st,J)}var ut,bt,yt,Ct,gt,At,Gt,te,ie,He,ve;if(!l.length)return;const[P,O]=g instanceof Fa||k?[{},l]:o.stencilConfigForOverlap(l),R=O[O.length-1].overscaledZ,F=S&&v;F&&_.defines.push("PROJECTION_GLOBE_VIEW"),S&&_.defines.push("RENDER_CUTOFF");for(const B of O){const j=B.toUnwrapped(),U=i.getTile(B);if(k&&(!U||!U.hasData())||!U.texture)continue;let H,W;k?(H=Be.disabled,W=B.projMatrix):S?(H=new Be(p.LEQUAL,Be.ReadWrite,o.depthRangeFor3D),W=v?Float32Array.from(o.transform.expandedFarZProjMatrix):o.transform.calculateProjMatrix(j,E)):(H=o.depthModeForSublayer(B.overscaledZ-R,1===s.paint.get("raster-opacity")?Be.ReadWrite:Be.ReadOnly,p.LESS),W=o.transform.calculateProjMatrix(j,E));const q=o.terrain&&k?o.terrain.stencilModeForRTTOverlap(B):P[B.overscaledZ],X=u?0:s.paint.get("raster-fade-duration");U.registerFadeDuration(X);const G=i.findLoadedParent(B,0),Q=pp(U,G,i,o.transform,X);let it,st;o.terrain&&o.terrain.prepareDrawTile(),m.activeTexture.set(p.TEXTURE0),U.texture&&U.texture.bind(A,p.CLAMP_TO_EDGE),m.activeTexture.set(p.TEXTURE1),G?(G.texture&&G.texture.bind(A,p.CLAMP_TO_EDGE),it=Math.pow(2,G.tileID.overscaledZ-U.tileID.overscaledZ),st=[U.tileID.canonical.x*it%1,U.tileID.canonical.y*it%1]):U.texture&&U.texture.bind(A,p.CLAMP_TO_EDGE),U.texture&&U.texture.useMipmap&&m.extTextureFilterAnisotropic&&o.transform.pitch>20&&p.texParameterf(p.TEXTURE_2D,m.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,m.extTextureFilterAnisotropicMax);const J=o.transform,et=g instanceof Fa?g.perspectiveTransform:[0,0],dt=S?q1(J):[0,0,0,0];let mt,ut,bt,yt,Ct,gt;if(F&&g instanceof Fa&&g.coordinates.length>3){mt=Float32Array.from(kd(da(new ca(0,0,0)))),ut=Float32Array.from(J.globeMatrix),bt=Float32Array.from(Yk(J)),yt=[dr(J.center.lng),Rr(J.center.lat)],gt=[dr(g.coordinates[1][0]),Rr(g.coordinates[1][1]),dr(g.coordinates[3][0]),Rr(g.coordinates[3][1])];const te=new go(g.coordinates[1],g.coordinates[3]);Ct=Float32Array.from(Ix(new ca(0,0,0),te,0,J.worldSize/o.transform._pixelsPerMercatorPixel))}else mt=new Float32Array(16),ut=new Float32Array(9),bt=new Float32Array(16),yt=[0,0],Ct=new Float32Array(16),gt=[0,0,0,0];const At=Jr(W,mt,ut,bt,Ct,st||[0,0],gt,Dr(o.transform.zoom),yt,dt,it||1,Q,s,et,S?s.paint.get("raster-elevation"):0,2,_.mix,_.offset,_.range,1,0,C),Gt=o.isTileAffectedByFog(B),Et=o.getOrCreateProgram("raster",{defines:_.defines,overrideFog:Gt});if(o.uploadCommonUniforms(m,Et,j),g instanceof Fa){if(k||!v)g.boundsBuffer&&g.boundsSegments&&Et.draw(o,p.TRIANGLES,H,pi.disabled,D,hi.disabled,At,s.id,g.boundsBuffer,o.quadTriangleIndexBuffer,g.boundsSegments);else if(o.globeSharedBuffers){const[te,ie,He]=o.globeSharedBuffers.getGridBuffers(0,!1);Et.draw(o,p.TRIANGLES,H,pi.disabled,D,hi.frontCCW,At,s.id,te,ie,He),Et.draw(o,p.TRIANGLES,H,pi.disabled,D,hi.backCCW,At,s.id,te,ie,He)}}else{const{tileBoundsBuffer:te,tileBoundsIndexBuffer:ie,tileBoundsSegments:He}=o.getTileBoundsBuffers(U);Et.draw(o,p.TRIANGLES,H,q,D,hi.disabled,At,s.id,te,ie,He)}}o.resetStencilClippingMasks()},background:function(o,i,s,l){const d=s.paint.get("background-color"),u=s.paint.get("background-opacity"),m=s.paint.get("background-emissive-strength");if(0===u)return;const p=o.context,g=p.gl,_=o.transform,y=_.tileSize,v=s.paint.get("background-pattern");if(o.isPatternMissing(v,s.scope))return;const w=!v&&1===d.a&&1===u&&o.opaquePassEnabledForLayer()?"opaque":"translucent";if(o.renderPass!==w)return;const C=pi.disabled,D=o.depthModeForSublayer(0,"opaque"===w?Be.ReadWrite:Be.ReadOnly),k=o.colorModeForDrapableLayerRenderPass(m),S=v?"backgroundPattern":"background";let E,A=l;A||(E=o.getBackgroundTiles(),A=Object.values(E).map(P=>P.tileID)),v&&(p.activeTexture.set(g.TEXTURE0),o.imageManager.bind(o.context,s.scope));for(const P of A){const O=o.isTileAffectedByFog(P),R=o.getOrCreateProgram(S,{overrideFog:O}),F=P.toUnwrapped(),B=l?P.projMatrix:o.transform.calculateProjMatrix(F);o.prepareDrawTile();const j=i?i.getTile(P):E?E[P.key]:new tc(P,y,_.zoom,o),U=v?FF(B,m,u,o,v,s.scope,{tileID:P,tileSize:y}):qy(B,m,u,d);o.uploadCommonUniforms(p,R,F);const{tileBoundsBuffer:H,tileBoundsIndexBuffer:W,tileBoundsSegments:q}=o.getTileBoundsBuffers(j);R.draw(o,g.TRIANGLES,D,C,k,hi.disabled,U,s.id,H,W,q)}},sky:function(o,i,s){const l=o._atmosphere?Dr(o.transform.zoom):1,d=s.paint.get("sky-opacity")*l;if(0===d)return;const u=o.context,m=s.paint.get("sky-type"),p=new Be(u.gl.LEQUAL,Be.ReadOnly,[0,1]),g=o.frameCounter/1e3%1;"atmosphere"===m?"offscreen"===o.renderPass?s.needsSkyboxCapture(o)&&(function(_,y,v,w){const C=_.context,D=C.gl;let k=y.skyboxFbo;if(!k){k=y.skyboxFbo=C.createFramebuffer(32,32,!0,null),y.skyboxGeometry=new Z1(C),y.skyboxTexture=C.gl.createTexture(),D.bindTexture(D.TEXTURE_CUBE_MAP,y.skyboxTexture),D.texParameteri(D.TEXTURE_CUBE_MAP,D.TEXTURE_WRAP_S,D.CLAMP_TO_EDGE),D.texParameteri(D.TEXTURE_CUBE_MAP,D.TEXTURE_WRAP_T,D.CLAMP_TO_EDGE),D.texParameteri(D.TEXTURE_CUBE_MAP,D.TEXTURE_MIN_FILTER,D.LINEAR),D.texParameteri(D.TEXTURE_CUBE_MAP,D.TEXTURE_MAG_FILTER,D.LINEAR);for(let P=0;P<6;++P)D.texImage2D(D.TEXTURE_CUBE_MAP_POSITIVE_X+P,0,D.RGBA,32,32,0,D.RGBA,D.UNSIGNED_BYTE,null)}C.bindFramebuffer.set(k.framebuffer),C.viewport.set([0,0,32,32]);const S=y.getCenter(_,!0),E=_.getOrCreateProgram("skyboxCapture"),A=new Float64Array(16);at.identity(A),at.rotateY(A,A,.5*-Math.PI),_p(_,y,E,A,S,0),at.identity(A),at.rotateY(A,A,.5*Math.PI),_p(_,y,E,A,S,1),at.identity(A),at.rotateX(A,A,.5*-Math.PI),_p(_,y,E,A,S,2),at.identity(A),at.rotateX(A,A,.5*Math.PI),_p(_,y,E,A,S,3),at.identity(A),_p(_,y,E,A,S,4),at.identity(A),at.rotateY(A,A,Math.PI),_p(_,y,E,A,S,5),C.viewport.set([0,0,_.width,_.height])}(o,s),s.markSkyboxValid(o)):"sky"===o.renderPass&&function(_,y,v,w,C){const D=_.context,k=D.gl,S=_.transform,E=_.getOrCreateProgram("skybox");D.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_CUBE_MAP,y.skyboxTexture);const A={u_matrix:S.skyboxMatrix,u_sun_direction:y.getCenter(_,!1),u_cubemap:0,u_opacity:w,u_temporal_offset:C};_.uploadCommonUniforms(D,E),E.draw(_,k.TRIANGLES,v,pi.disabled,_.colorModeForRenderPass(),hi.backCW,A,"skybox",y.skyboxGeometry.vertexBuffer,y.skyboxGeometry.indexBuffer,y.skyboxGeometry.segment)}(o,s,p,d,g):"gradient"===m&&"sky"===o.renderPass&&function(_,y,v,w,C){const D=_.context,k=D.gl,S=_.transform,E=_.getOrCreateProgram("skyboxGradient");y.skyboxGeometry||(y.skyboxGeometry=new Z1(D)),D.activeTexture.set(k.TEXTURE0);let A=y.colorRampTexture;A||(A=y.colorRampTexture=new Un(D,y.colorRamp,k.RGBA)),A.bind(k.LINEAR,k.CLAMP_TO_EDGE);const P=(B=w,j=C,{u_matrix:S.skyboxMatrix,u_color_ramp:0,u_center_direction:y.getCenter(_,!1),u_radius:ni(y.paint.get("sky-gradient-radius")),u_opacity:B,u_temporal_offset:j});var B,j;_.uploadCommonUniforms(D,E),E.draw(_,k.TRIANGLES,v,pi.disabled,_.colorModeForRenderPass(),hi.backCW,P,"skyboxGradient",y.skyboxGeometry.vertexBuffer,y.skyboxGeometry.indexBuffer,y.skyboxGeometry.segment)}(o,s,p,d,g)},debug:function(o,i,s){for(let l=0;l<s.length;l++)Y1(o,i,s[l])},custom:function(o,i,s,l){const d=o.context,u=s.implementation;if(!o.transform.projection.unsupportedLayers||!o.transform.projection.unsupportedLayers.includes("custom")||o.terrain&&(o.terrain.renderingToTexture||"offscreen"===o.renderPass)&&s.isLayerDraped(i)){if("offscreen"===o.renderPass){const m=u.prerender;if(m){if(o.setCustomLayerDefaults(),d.setColorMode(o.colorModeForRenderPass()),"globe"===o.transform.projection.name){const p=o.transform.pointMerc;m.call(u,d.gl,o.transform.customLayerMatrix(),o.transform.getProjection(),o.transform.globeToMercatorMatrix(),Dr(o.transform.zoom),[p.x,p.y],o.transform.pixelsPerMeterRatio)}else m.call(u,d.gl,o.transform.customLayerMatrix());d.setDirty(),o.setBaseState()}}else if("translucent"===o.renderPass){if(o.terrain&&o.terrain.renderingToTexture){const p=u.renderToTile;if(p){const g=l[0].canonical,_=new Ei(g.x+l[0].wrap*(1<<g.z),g.y,g.z);d.setDepthMode(Be.disabled),d.setStencilMode(pi.disabled),d.setColorMode(o.colorModeForRenderPass()),o.setCustomLayerDefaults(),p.call(u,d.gl,_),d.setDirty(),o.setBaseState()}return}o.setCustomLayerDefaults(),d.setColorMode(o.colorModeForRenderPass()),d.setStencilMode(pi.disabled);const m="3d"===u.renderingMode?new Be(o.context.gl.LEQUAL,Be.ReadWrite,o.depthRangeFor3D):o.depthModeForSublayer(0,Be.ReadOnly);if(d.setDepthMode(m),"globe"===o.transform.projection.name){const p=o.transform.pointMerc;u.render(d.gl,o.transform.customLayerMatrix(),o.transform.getProjection(),o.transform.globeToMercatorMatrix(),Dr(o.transform.zoom),[p.x,p.y],o.transform.pixelsPerMeterRatio)}else u.render(d.gl,o.transform.customLayerMatrix());d.setDirty(),o.setBaseState(),d.bindFramebuffer.set(null)}}else rt("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(o,i,s,l){if("opaque"===o.renderPass)return;const d=s.paint.get("model-opacity");if(0===d)return;const u=s.paint.get("model-cast-shadows");if("shadow"===o.renderPass&&(!u||o.terrain&&d<.65&&s._transitionablePaint._values["model-opacity"].value.expression instanceof vc))return;const m=o.shadowRenderer,p=s.paint.get("model-receive-shadows");m&&(m.useNormalOffset=!0,p||(m.enabled=!1));const g=()=>{m&&(m.useNormalOffset=!0,p||(m.enabled=!0))},_=i.getSource();if("light-beam"===o.renderPass&&"batched-model"!==_.type)return;if("vector"===_.type||"geojson"===_.type)return function(E,A,P,O){const R=E.transform;if("mercator"!==R.projection.name)return void rt(`Drawing 3D models for ${R.projection.name} projection is not yet implemented`);const F=R.getFreeCameraOptions().position;if(!E.modelManager)return;const B=E.modelManager,j=E.shadowRenderer;if(!P._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const U=P._unevaluatedLayout._values["model-id"],H={...P.layout.get("model-id").parameters};for(const W of O){const q=A.getTile(W).getBucket(P);if(!q||q.projection.name!==R.projection.name)continue;const X=cV(W,R);H.zoom=X;const G=U.possiblyEvaluate(H);if(Q1(E,q,W),Hc.shadowUniformsInitialized=!1,Hc.useSingleShadowCascade=!!j&&0===j.getMaxCascadeForTile(W.toUnwrapped()),"shadow"===E.renderPass&&j){if(1===E.currentShadowCascade&&q.isInsideFirstShadowMapFrustum)continue;const st=R.calculatePosMatrix(W.toUnwrapped(),R.worldSize);if(Hc.tileMatrix.set(st),Hc.shadowTileMatrix=Float32Array.from(j.calculateShadowPassMatrixFromMatrix(st)),Hc.aabb.min.fill(0),Hc.aabb.max[0]=Hc.aabb.max[1]=pt,Hc.aabb.max[2]=0,$F(q,Hc,E,P.scope))continue}const Q=1<<W.canonical.z,it=[((F.x-W.wrap)*Q-W.canonical.x)*pt,(F.y*Q-W.canonical.y)*pt,F.z*Q*pt];for(let st in q.instancesPerModel){const J=q.instancesPerModel[st];J.features.length>0&&(st=G.evaluate(J.features[0].feature,{}));const et=B.getModel(st,P.scope);if(et&&et.uploaded)for(const dt of et.nodes)HF(E,P,dt,J,it,W,Hc)}}}(o,i,s,l),void g();if(!_.loaded())return;if("batched-model"===_.type)return function(E,A,P,O){const R=E.context,F=E.transform,B=E.style.fog,j=E.shadowRenderer;if("mercator"!==F.projection.name)return void rt(`Drawing 3D landmark models for ${F.projection.name} projection is not yet implemented`);const U=E.transform.getFreeCameraOptions().position,H=Z.scale([],[U.x,U.y,U.z],E.transform.worldSize);Z.negate(H,H);const W=at.identity([]),q=Pc(F.center.lat,F.zoom),X=at.fromScaling([],[1,1,1/q]);at.translate(W,W,H);const G=P.paint.get("model-opacity"),Q=new Be(R.gl.LEQUAL,Be.ReadWrite,E.depthRangeFor3D),it=new Be(R.gl.LEQUAL,Be.ReadOnly,E.depthRangeFor3D),st=function(J,et){for(const dt of O){const mt=A.getTile(dt).getBucket(P);if(!mt||!mt.uploaded)continue;let ut=!1;j&&(ut=0===j.getMaxCascadeForTile(dt.toUnwrapped()));const bt=F.calculatePosMatrix(dt.toUnwrapped(),F.worldSize),yt=mt.modelTraits;for(const Ct of mt.getNodesInfo()){if(Ct.hiddenByReplacement||!Ct.node.meshes)continue;const gt=Ct.node,At="light-beam"===E.renderPass,Gt=[...bt],Et=Ct.evaluatedScale;let te=0;E.terrain&&gt.elevation&&(te=gt.elevation*E.terrain.exaggeration()),at.translate(Gt,Gt,[(gt.anchor?gt.anchor[0]:0)*(Et[0]-1),(gt.anchor?gt.anchor[1]:0)*(Et[1]-1),te]),Et!==Bd&&at.scale(Gt,Gt,Et),at.multiply(Gt,Gt,gt.matrix);const ie=at.multiply([],X,Gt);at.multiply(ie,W,ie);const He=at.invert([],ie);at.transpose(He,He),at.scale(He,He,Wg);const ve=at.multiply([],F.expandedFarZProjMatrix,Gt);for(let Ui=0;Ui<gt.meshes.length;++Ui){const xi=gt.meshes[Ui],$e=Ui===gt.lightMeshIndex;if($e){if(!At&&!E.terrain&&E.shadowRenderer){E.currentLayer<E.firstLightBeamLayer&&(E.firstLightBeamLayer=E.currentLayer);continue}}else if(At)continue;const ze={defines:[]},Ce=[];X1(ze.defines,Ce,xi,E),4&yt||ze.defines.push("DIFFUSE_SHADED"),ut&&ze.defines.push("SHADOWS_SINGLE_CASCADE");const wi="shadow"===E.renderPass;if(wi){Zy(xi,Gt,E,P);continue}let Pi=null;if(B){const mr=BE(Gt,E.transform);if(Pi=new Float32Array(mr),"globe"!==F.projection.name){const Zn=xi.aabb.min,kn=xi.aabb.max,[Xi,xo]=B.getOpacityForBounds(mr,Zn[0],Zn[1],kn[0],kn[1]);ze.overrideFog=Xi>=Nd||xo>=Nd}}const ci=E.getOrCreateProgram("model",ze);!wi&&j&&(j.useNormalOffset=!!xi.normalBuffer,j.setupShadowsFromMatrix(Gt,ci,j.useNormalOffset)),E.uploadCommonUniforms(R,ci,dt.toUnwrapped(),Pi);const Gi=xi.material,ir=Gi.pbrMetallicRoughness;ir.metallicFactor=.9,ir.roughnessFactor=.5;const tn=0,Mn=Yy(new Float32Array(ve),new Float32Array(ie),new Float32Array(He),E,G,ir.baseColorFactor,Gi.emissiveFactor,ir.metallicFactor,ir.roughnessFactor,Gi,tn,P);ci.draw(E,R.gl.TRIANGLES,et&&!$e?Q:it,pi.disabled,J?$e||G<1||Ct.hasTranslucentParts?ji.alphaBlended:ji.unblended:ji.disabled,hi.backCCW,Mn,P.id,xi.vertexBuffer,xi.indexBuffer,xi.segments,P.paint,E.transform.zoom,void 0,Ce)}}}};(function(J,et,dt,mt){const ut=J.terrain?J.terrain.exaggeration():0,bt=J.transform.zoom;for(const yt of mt){const Ct=et.getTile(yt).getBucket(dt);Ct&&(J.conflationActive&&Ct.updateReplacement(yt,J.replacementSource),Ct.evaluateScale(J,dt),J.terrain&&ut>0&&Ct.elevationUpdate(J.terrain,ut,yt,dt.source),Ct.needsReEvaluation(J,bt,dt)&&Ct.evaluate(dt))}})(E,A,P,O),1===G?st(!0,!0):(st(!1,!0),st(!0,!1))}(o,i,s,l),void g();const y=_.getModels(),v=[],w=o.transform.getFreeCameraOptions().position,C=Z.scale([],[w.x,w.y,w.z],o.transform.worldSize);Z.negate(C,C);const D=[],k=[];let S=0;for(const E of y){const A=s.paint.get("model-rotation").constantOr(null),P=s.paint.get("model-scale").constantOr(null),O=s.paint.get("model-translation").constantOr(null);E.computeModelMatrix(o,A,P,O,!0,!0,!1);const R=at.identity([]),F=Pc(E.position.lat,o.transform.zoom),B=at.fromScaling([],[1,1,1/F]);at.translate(R,R,C),v.push({zScaleMatrix:B,negCameraPosMatrix:R});for(const j of E.nodes)UF(o.transform,j,E.matrix,o.transform.expandedFarZProjMatrix,S,D,k);S++}if(D.sort((E,A)=>A.depth-E.depth),"shadow"!==o.renderPass){if(1===d)for(const E of k)K1(E,o,s,v[E.modelIndex],pi.disabled,o.colorModeForRenderPass());else{for(const E of k)K1(E,o,s,v[E.modelIndex],pi.disabled,ji.disabled);for(const E of k)K1(E,o,s,v[E.modelIndex],o.stencilModeFor3D(),o.colorModeForRenderPass());o.resetStencilClippingMasks()}for(const E of D)K1(E,o,s,v[E.modelIndex],pi.disabled,o.colorModeForRenderPass());g()}else{for(const E of k)Zy(E.mesh,E.nodeModelMatrix,o,s);for(const E of D)Zy(E.mesh,E.nodeModelMatrix,o,s);g()}}},NE={modelUpload:function(o,i,s){const l=i.getSource();if(!l.loaded())return;if("vector"===l.type||"geojson"===l.type)return void(o.modelManager&&o.modelManager.upload(o,s));if("batched-model"===l.type)return;const d=l.getModels();for(const u of d)u.upload(o.context)}};class WF{constructor(i,s,l){this.context=new yO(i,s),this.transform=l,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=ul.maxUnderzooming+ul.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new bT,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new qF(this),this._wireframeDebugCache=new GF,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(i,s){const l=!!i&&!!i.terrain&&this.transform.projection.supportsTerrain;if(!(l||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new yE(this,i));const d=this._terrain;this.transform.elevation=l?d:null,d.update(i,this.transform,s),this.transform.elevation&&!d.enabled&&(this.transform.elevation=null)}_updateFog(i){const s=i.fog;if(!s||"globe"===this.transform.projection.name||s.getOpacity(this.transform.pitch)<1||s.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[l,d]=s.getFovAdjustedRange(this.transform._fov);if(l>d)return void(this.transform.fogCullDistSq=null);const u=l+.78*(d-l);this.transform.fogCullDistSq=u*u}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(i,s){if(this.width=i*Ze.devicePixelRatio,this.height=s*Ze.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const l of this.style.order)this.style._mergedLayers[l].resize()}setup(){const i=this.context,s=new Os;s.emplaceBack(0,0),s.emplaceBack(pt,0),s.emplaceBack(0,pt),s.emplaceBack(pt,pt),this.tileExtentBuffer=i.createVertexBuffer(s,Ac.members),this.tileExtentSegments=on.simpleSegment(0,0,4,2);const l=new Os;l.emplaceBack(0,0),l.emplaceBack(pt,0),l.emplaceBack(0,pt),l.emplaceBack(pt,pt),this.debugBuffer=i.createVertexBuffer(l,Ac.members),this.debugSegments=on.simpleSegment(0,0,4,5);const d=new Os;d.emplaceBack(-1,-1),d.emplaceBack(1,-1),d.emplaceBack(-1,1),d.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(d,Ac.members),this.viewportSegments=on.simpleSegment(0,0,4,2);const u=new bu;u.emplaceBack(0,0,0,0),u.emplaceBack(pt,0,pt,0),u.emplaceBack(0,pt,0,pt),u.emplaceBack(pt,pt,pt,pt),this.mercatorBoundsBuffer=i.createVertexBuffer(u,Ve.members),this.mercatorBoundsSegments=on.simpleSegment(0,0,4,2);const m=new Cr;m.emplaceBack(0,1,2),m.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(m);const p=new vb;for(const _ of[0,1,3,2,0])p.emplaceBack(_);this.debugIndexBuffer=i.createIndexBuffer(p),this.emptyTexture=new Un(i,new _r({width:1,height:1},Uint8Array.of(0,0,0,0)),i.gl.RGBA),this.identityMat=at.create();const g=this.context.gl;this.stencilClearMode=new pi({func:g.ALWAYS,mask:0},0,255,g.ZERO,g.ZERO,g.ZERO),this.loadTimeStamps.push(lt.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(i){return i._makeTileBoundsBuffers(this.context,this.transform.projection),i._tileBoundsBuffer?{tileBoundsBuffer:i._tileBoundsBuffer,tileBoundsIndexBuffer:i._tileBoundsIndexBuffer,tileBoundsSegments:i._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const i=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,i.TRIANGLES,Be.disabled,this.stencilClearMode,ji.disabled,hi.disabled,B1(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(i,s,l){if(!s||this.currentStencilSource===s.id||!i.isTileClipped()||!l||0===l.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let p=!1;for(const g of l)if(void 0===this._tileClippingMaskIDs[g.key]){p=!0;break}if(!p)return}this.currentStencilSource=s.id;const d=this.context,u=d.gl;this.nextStencilID+l.length>256&&this.clearStencil(),d.setColorMode(ji.disabled),d.setDepthMode(Be.disabled);const m=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const p of l){const g=s.getTile(p),_=this._tileClippingMaskIDs[p.key]=this.nextStencilID++,{tileBoundsBuffer:y,tileBoundsIndexBuffer:v,tileBoundsSegments:w}=this.getTileBoundsBuffers(g);m.draw(this,u.TRIANGLES,Be.disabled,new pi({func:u.ALWAYS,mask:0},_,255,u.KEEP,u.KEEP,u.REPLACE),ji.disabled,hi.disabled,B1(p.projMatrix),"$clipping",y,v,w)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,s=this.context.gl;return new pi({func:s.NOTEQUAL,mask:255},i,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(i){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(i);const s=this.context.gl;return new pi({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(i){const s=this.context.gl,l=i.sort((m,p)=>p.overscaledZ-m.overscaledZ),d=l[l.length-1].overscaledZ,u=l[0].overscaledZ-d+1;if(u>1){this.currentStencilSource=void 0,this.nextStencilID+u>256&&this.clearStencil();const m={};for(let p=0;p<u;p++)m[p+d]=new pi({func:s.GEQUAL,mask:255},p+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=u,[m,l]}return[{[d]:pi.disabled},l]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new ji([i.CONSTANT_COLOR,i.ONE,i.CONSTANT_COLOR,i.ONE],new di(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?ji.unblended:ji.alphaBlended}colorModeForDrapableLayerRenderPass(i){const s=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&"translucent"===this.renderPass?new ji([s.ONE,s.ONE_MINUS_SRC_ALPHA,s.CONSTANT_ALPHA,s.ONE_MINUS_SRC_ALPHA],new di(0,0,0,void 0===i?0:i),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(i,s,l,d=!1){if(!this.opaquePassEnabledForLayer()&&!d)return Be.disabled;const u=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new Be(l||this.context.gl.LEQUAL,s,[u,u])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,s){this._wireframeDebugCache.update(this.frameCounter),this.style=i,this.options=s;const l=this.style._mergedLayers,d=this.style.order,u=d.map(R=>l[R]),m=this.style._mergedSourceCaches;this.imageManager=i.imageManager,this.modelManager=i.modelManager,this.symbolFadeChange=i.placement.symbolFadeChange(Ze.now()),this.imageManager.beginFrame();let p=0,g=!1;for(const R in m){const F=m[R];F.used&&(F.prepare(this.context),F.getSource().usedInConflation&&++p)}const _={},y={},v={},w={},C={};for(const R in m){const F=m[R];_[R]=F.getVisibleCoordinates(),y[R]=_[R].slice().reverse(),v[R]=F.getVisibleCoordinates(!0).reverse(),w[R]=F.getShadowCasterCoordinates(),C[R]=F.sortCoordinatesByDistance(_[R])}const D=R=>{const F=this.style.getLayerSourceCache(R);return F&&F.used?F.getSource():null};if(p){const R=[];for(const F of u)this.layerUsedInConflation(F,D(F))&&R.push(F);if(R&&R.length>1){const F=[];for(const B of R){const j=this.style.getLayerSourceCache(B);j&&j.used&&j.getSource().usedInConflation&&F.push({layer:B.fqid,cache:j})}this.replacementSource.setSources(F),g=!0}}g||this.replacementSource.clear(),this.conflationActive=g,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const R of u){const F=R.cutoffRange();if(this.longestCutoffRange=Math.max(F,this.longestCutoffRange),F>0){const B=D(R);B&&(this.minCutoffZoom=Math.max(B.minzoom,this.minCutoffZoom)),R.minzoom&&(this.minCutoffZoom=Math.max(R.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let R=0;R<u.length;R++)if(u[R].is3D()){this.opaquePassCutoff=R;break}const k=this.style&&this.style.fog;k?(this._fogVisible=0!==k.getOpacity(this.transform.pitch),this._fogVisible&&"globe"!==this.transform.projection.name&&(this._fogVisible=k.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(v),this.opaquePassCutoff=0);const S=this._shadowRenderer;if(S){S.updateShadowParameters(this.transform,this.style.directionalLight);for(const R in m)for(const F of _[R]){let B={min:0,max:0};this.terrain&&(B=this.terrain.getMinMaxForTile(F)||B),S.addShadowReceiver(F.toUnwrapped(),B.min,B.max)}}"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new H3(this.context));for(const R of u){if(R.isHidden(this.transform.zoom))continue;const F=i.getLayerSourceCache(R);this.uploadLayer(this,R,F)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new yp),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!ad.has(this.context.gl))return;this.renderPass="offscreen";for(const R of u){const F=i.getLayerSourceCache(R);if(!R.hasOffscreenPass()||R.isHidden(this.transform.zoom))continue;const B=F?y[F.id]:void 0;("custom"===R.type||"raster"===R.type||R.isSky()||B&&B.length)&&this.renderLayer(this,F,R,B)}this.depthRangeFor3D=[0,1-(u.length+2)*this.numSublayers*this.depthEpsilon];const E=this.terrain;E&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&E.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,w)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const A="globe"===this.transform.projection.name||this.transform.isHorizonVisible(),P=(()=>{if(s.showOverdrawInspector)return di.black;if(this.style.fog&&this.transform.projection.supportsFog&&!A){const R=this.style.fog.properties.get("color").toArray01();return new di(...R)}if(this.style.fog&&this.transform.projection.supportsFog&&A){const R=this.style.fog.properties.get("space-color").toArray01();return new di(...R)}return di.transparent})();if(this.context.clear({color:P,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&A&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){const R=u[this.currentLayer],F=i.getLayerSourceCache(R);if(R.isSky())continue;const B=F?(R.is3D()?C:y)[F.id]:void 0;this._renderTileClippingMasks(R,F,B),this.renderLayer(this,F,R,B)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&A&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||Dr(this.transform.zoom)>0)&&("globe"===this.transform.projection.name||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){const R=u[this.currentLayer],F=i.getLayerSourceCache(R);R.isSky()&&this.renderLayer(this,F,R,F?y[F.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let O=0;for(S&&(O=S.getShadowCastingLayerCount());this.currentLayer<d.length;){const R=u[this.currentLayer],F=i.getLayerSourceCache(R);if(R.isSky()){++this.currentLayer;continue}if(E&&this.style.isLayerDraped(R)){if(R.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=E.renderBatch(this.currentLayer);continue}let B;if(F&&(B=("symbol"===R.type?v:R.is3D()?C:y)[F.id]),this._renderTileClippingMasks(R,F,F?_[F.id]:void 0),this.renderLayer(this,F,R,B),!E&&S&&O>0&&R.hasShadowPass()&&0==--O&&(S.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const j=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=j;this.currentLayer++){const U=u[this.currentLayer];if(!U.hasLightBeamPass())continue;const H=i.getLayerSourceCache(U);this.renderLayer(this,H,U,H?y[H.id]:void 0)}this.currentLayer=j,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let R=null;u.forEach(F=>{const B=i.getLayerSourceCache(F);B&&!F.isHidden(this.transform.zoom)&&B.getVisibleCoordinates().length&&(!R||R.getSource().maxzoom<B.getSource().maxzoom)&&(R=B)}),R&&this.options.showTileBoundaries&&tC.debug(this,R,R.getVisibleCoordinates())}this.options.showPadding&&function(R){const F=R.transform.padding;pe(R,R.transform.height-(F.top||0),3,BF),pe(R,F.bottom||0,3,NF),Hi(R,F.left||0,3,zF),Hi(R,R.transform.width-(F.right||0),3,VF);const B=R.transform.centerPoint;var j,U,H,W;Fi(j=R,(U=B.x)-1,(H=R.transform.height-B.y)-10,2,20,W=FE),Fi(j,U-10,H-1,20,2,W)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(lt.performance.now()),this.saveCanvasCopy()),g||(this.conflationActive=!1)}uploadLayer(i,s,l){this.gpuTimingStart(s),(!i.transform.projection.unsupportedLayers||!i.transform.projection.unsupportedLayers.includes(s.type)||i.terrain&&"custom"===s.type)&&NE[`${s.type}Upload`]&&NE[`${s.type}Upload`](i,l,s.scope),this.gpuTimingEnd()}renderLayer(i,s,l,d){l.isHidden(this.transform.zoom)||("background"===l.type||"sky"===l.type||"custom"===l.type||"model"===l.type||"raster"===l.type||d&&d.length)&&(this.id=l.id,this.gpuTimingStart(l),(!i.transform.projection.unsupportedLayers||!i.transform.projection.unsupportedLayers.includes(l.type)||i.terrain&&"custom"===l.type)&&tC[l.type](i,s,l,d,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery,l=this.context.gl;let d=this.gpuTimers[i.id];d||(d=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:l.createQuery()}),d.calls++,l.beginQuery(s.TIME_ELAPSED_EXT,d.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const i=this.context.extTimerQuery,s=this.context.gl,l=s.createQuery();this.deferredRenderGpuTimeQueries.push(l),s.beginQuery(i.TIME_ELAPSED_EXT,l)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}collectDeferredRenderGpuQueries(){const i=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],i}queryGpuTimers(i){const s={};for(const l in i){const d=i[l],u=this.context.extTimerQuery,m=u.getQueryParameter(d.query,this.context.gl.QUERY_RESULT)/1e6;u.deleteQueryEXT(d.query),s[l]=m}return s}queryGpuTimeDeferredRender(i){if(!this.options.gpuTimingDeferredRender)return 0;const s=this.context.extTimerQuery,l=this.context.gl;let d=0;for(const u of i)d+=s.getQueryParameter(u,l.QUERY_RESULT)/1e6,s.deleteQueryEXT(u);return d}translatePosMatrix(i,s,l,d,u){if(!l[0]&&!l[1])return i;const m=u?"map"===d?this.transform.angle:0:"viewport"===d?-this.transform.angle:0;if(m){const _=Math.sin(m),y=Math.cos(m);l=[l[0]*y-l[1]*_,l[0]*_+l[1]*y]}const p=[u?l[0]:Xu(s,l[0],this.transform.zoom),u?l[1]:Xu(s,l[1],this.transform.zoom),0],g=new Float32Array(16);return at.translate(g,i,p),g}saveTileTexture(i){const s=i.size[0],l=this._tileTextures[s];l?l.push(i):this._tileTextures[s]=[i]}getTileTexture(i){const s=this._tileTextures[i];return s&&s.length>0?s.pop():null}isPatternMissing(i,s){return null===i||void 0!==i&&!this.imageManager.getPattern(i.toString(),s)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return null!=this.context.extTextureFloatLinear}currentGlobalDefines(i,s,l){const d=void 0===l?this.terrain&&this.terrain.renderingToTexture:l,u=this.terrain&&0===this.terrain.exaggeration(),m=[];return this.style&&this.style.enable3dLights()&&("globeRaster"===i||"terrainRaster"===i?(m.push("LIGHTING_3D_MODE"),m.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):d||m.push("LIGHTING_3D_MODE")),"shadow"===this.renderPass?this._shadowMapDebug||m.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?m.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):m.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(m.push("TERRAIN"),this.linearFloatFilteringSupported()&&m.push("TERRAIN_DEM_FLOAT_FORMAT"),u&&m.push("ZERO_EXAGGERATION")),"globe"===this.transform.projection.name&&m.push("GLOBE"),!this._fogVisible||d||void 0!==s&&!s||m.push("FOG","FOG_DITHERING"),d&&m.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&m.push("OVERDRAW_INSPECTOR"),m}getOrCreateProgram(i,s){this.cache=this.cache||{};const l=s&&s.defines||[],d=s&&s.config,u=this.currentGlobalDefines(i,s&&s.overrideFog,s&&s.overrideRtt).concat(l),m=MF.cacheKey(O1[i],i,u,d);return this.cache[m]||(this.cache[m]=new MF(this.context,i,O1[i],d,EE[i],u)),this.cache[m]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=lt.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Un(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(i,s){if(this.style.enable3dLights()){const l=this.style.directionalLight,d=this.style.ambientLight;if(l&&d){const u=((m,p)=>{const g=m.properties.get("direction"),_=m.properties.get("color").toArray01(),y=m.properties.get("intensity"),v=p.properties.get("color").toArray01(),w=p.properties.get("intensity"),C=[g.x,g.y,g.z],D=er(v,w),k=er(_,y);return{u_lighting_ambient_color:D,u_lighting_directional_dir:C,u_lighting_directional_color:k,u_ground_radiance:vE(C,k,D)}})(l,d);s.setLightsUniformValues(i,u)}}}uploadCommonUniforms(i,s,l,d,u){if(this.uploadCommonLightUniforms(i,s),this.terrain&&this.terrain.renderingToTexture)return;const m=this.style.fog;if(m){const p=m.getOpacity(this.transform.pitch),g=((_,y,v,w,C,D,k,S,E,A,P,O)=>{const R=_.transform,F=y.properties.get("color").toArray01();F[3]=w;const B=_.frameCounter/1e3%1,[j,U]=y.properties.get("vertical-range");return{u_fog_matrix:v?R.calculateFogTileMatrix(v):O||_.identityMat,u_fog_range:y.getFovAdjustedRange(R._fov),u_fog_color:F,u_fog_horizon_blend:y.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(j,U),U],u_fog_temporal_offset:B,u_frustum_tl:C,u_frustum_tr:D,u_frustum_br:k,u_frustum_bl:S,u_globe_pos:E,u_globe_radius:A,u_viewport:P,u_globe_transition:Dr(R.zoom),u_is_globe:+("globe"===R.projection.name)}})(this,m,l,p,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*Ze.devicePixelRatio,this.transform.height*Ze.devicePixelRatio],d);s.setFogUniformValues(i,g)}u&&s.setCutoffUniformValues(i,u.uniformValues)}setTileLoadedFlag(i){this.tileLoaded=i}saveCanvasCopy(){const i=this.canvasCopy();i&&(this.frameCopies.push(i),this.tileLoaded=!1)}canvasCopy(){const i=this.context.gl,s=i.createTexture();return i.bindTexture(i.TEXTURE_2D,s),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,i.drawingBufferWidth,i.drawingBufferHeight,0),s}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const i=this.style&&this.style.fog;return!!i&&0!==i.getOpacity(this.transform.pitch)}getBackgroundTiles(){const i=this._backgroundTiles,s=this._backgroundTiles={},l=this.transform.coveringTiles({tileSize:512});for(const d of l)s[d.key]=i[d.key]||new tc(d,512,this.transform.tileZoom,this);return s}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(i,s){return!(!i.is3D()||i.minzoom&&i.minzoom>this.transform.zoom||"building"!==i.sourceLayer&&(!s||"batched-model"!==s.type))}isTileAffectedByFog(i){if(!this.style||!this.style.fog)return!1;if("globe"===this.transform.projection.name)return!0;let s=this._cachedTileFogOpacities[i.key];return s||(this._cachedTileFogOpacities[i.key]=s=this.style.fog.getOpacityForTile(i)),s[0]>=Nd||s[1]>=Nd}}const sh=2048;class eC{constructor(i,s){this.aabb=i,this.lastCascade=s}}class zE{add(i,s){const l=this.receivers[i.key];void 0!==l?(l.aabb.min[0]=Math.min(l.aabb.min[0],s.min[0]),l.aabb.min[1]=Math.min(l.aabb.min[1],s.min[1]),l.aabb.min[2]=Math.min(l.aabb.min[2],s.min[2]),l.aabb.max[0]=Math.max(l.aabb.max[0],s.max[0]),l.aabb.max[1]=Math.max(l.aabb.max[1],s.max[1]),l.aabb.max[2]=Math.max(l.aabb.max[2],s.max[2])):this.receivers[i.key]=new eC(s,null)}clear(){this.receivers={}}get(i){return this.receivers[i.key]}computeRequiredCascades(i,s,l){const d=gn.fromPoints(i.points);let u=0;for(const m in this.receivers){const p=this.receivers[m];if(!p||!d.intersectsAabb(p.aabb))continue;p.aabb.min=d.closestPoint(p.aabb.min),p.aabb.max=d.closestPoint(p.aabb.max);const g=p.aabb.getCorners();for(let _=0;_<l.length;_++){let y=!0;for(const v of g){const w=[v[0]*s,v[1]*s,v[2]];if(Z.transformMat4(w,w,l[_].matrix),w[0]<-1||w[0]>1||w[1]<-1||w[1]>1){y=!1;break}}if(p.lastCascade=_,u=Math.max(u,_),y)break}}return u+1}}class qF{constructor(i){this.painter=i,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new zE,this._depthMode=new Be(i.context.gl.LEQUAL,Be.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1}destroy(){for(const i of this._cascades)i.texture.destroy(),i.framebuffer.destroy();this._cascades=[]}updateShadowParameters(i,s){const l=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!s||!s.properties)return;const d=s.properties.get("shadow-intensity");if(!s.shadowsEnabled()||d<=0||(this._shadowLayerCount=l.style.order.reduce((C,D)=>{const k=l.style._mergedLayers[D];return C+(k.hasShadowPass()&&!k.isHidden(i.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const u=l.context,m=sh,p=sh;if(0===this._cascades.length)for(let C=0;C<2;++C){const D=l._shadowMapDebug,k=u.gl,S=u.createFramebuffer(m,p,D,"texture"),E=new Un(u,{width:m,height:p,data:null},k.DEPTH_COMPONENT);if(S.depthAttachment.set(E.texture),D){const A=new Un(u,{width:m,height:p,data:null},k.RGBA);S.colorAttachment.set(A.texture)}this._cascades.push({framebuffer:S,texture:E,matrix:[],far:0,boundingSphereRadius:0,frustum:new al,scale:0})}this.shadowDirection=Xy(s);let g=0;if(i.elevation){const C=i.elevation,D=[1e4,-1e4];C.visibleDemTiles.filter(k=>k.dem).forEach(k=>{const S=k.dem.tree;D[0]=Math.min(D[0],S.minimums[0]),D[1]=Math.max(D[1],S.maximums[0])}),1e4!==D[0]&&(g=(D[1]-D[0])*C.exaggeration())}const _=1.5*i.cameraToCenterDistance,y=3*_,v=new Float64Array(16);for(let C=0;C<2;++C){const D=this._cascades[C];let k=i.height/50,S=1;0===C?S=_:(k=_,S=y);const[E,A]=jE(i,this.shadowDirection,k,S,sh,g);D.scale=i.scale,D.matrix=E,D.boundingSphereRadius=A,at.invert(v,D.matrix),D.frustum=al.fromInvProjectionMatrix(v,1,0,!0),D.far=S}this._uniformValues.u_fade_range=[.75*this._cascades[1].far,this._cascades[1].far],this._uniformValues.u_shadow_intensity=d,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=.00048828125,this._uniformValues.u_shadow_map_resolution=sh,this._uniformValues.u_shadowmap_0=Us.ShadowMap0,this._uniformValues.u_shadowmap_1=Us.ShadowMap0+1,this._groundShadowTiles=l.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const w=l.transform.elevation;for(const C of this._groundShadowTiles){let D={min:0,max:0};if(w){const k=w.getMinMaxForTile(C);k&&(D=k)}this.addShadowReceiver(C.toUnwrapped(),D.min,D.max)}}get enabled(){return this._enabled}set enabled(i){this._enabled=i}drawShadowPass(i,s){if(!this._enabled)return;const l=this.painter,d=l.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(l.transform.getFrustum(0),l.transform.worldSize,this._cascades),d.viewport.set([0,0,sh,sh]);for(let u=0;u<this._numCascadesToRender;++u){l.currentShadowCascade=u,d.bindFramebuffer.set(this._cascades[u].framebuffer.framebuffer),d.clear({color:di.white,depth:1});for(const m of i.order){const p=i._mergedLayers[m];if(!p.hasShadowPass()||p.isHidden(l.transform.zoom))continue;const g=i.getLayerSourceCache(p),_=g?s[g.id]:void 0;("model"===p.type||_&&_.length)&&l.renderLayer(l,g,p,_)}}l.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const i=this.painter,s=i.style,l=i.context,d=s.directionalLight,u=s.ambientLight;if(!d||!u)return;const m=[],p=hp(i,i.longestCutoffRange);p.shouldRenderCutoff&&m.push("RENDER_CUTOFF");const g=VE(d,u),_=new Be(l.gl.LEQUAL,Be.ReadOnly,i.depthRangeFor3D);for(const y of this._groundShadowTiles){const v=y.toUnwrapped(),w=i.isTileAffectedByFog(y),C=i.getOrCreateProgram("groundShadow",{defines:m,overrideFog:w});this.setupShadows(v,C),i.uploadCommonUniforms(l,C,v,null,p);const D={u_matrix:i.transform.calculateProjMatrix(v),u_ground_shadow_factor:g};C.draw(i,l.gl.TRIANGLES,_,pi.disabled,ji.multiply,hi.disabled,D,"ground_shadow",i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments,{},i.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?ji.unblended:ji.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(i){const s=this.painter.transform,l=s.calculatePosMatrix(i,s.worldSize);return at.multiply(l,this._cascades[this.painter.currentShadowCascade].matrix,l),Float32Array.from(l)}calculateShadowPassMatrixFromMatrix(i){return at.multiply(i,this._cascades[this.painter.currentShadowCascade].matrix,i),Float32Array.from(i)}setupShadows(i,s,l,d=0){if(!this._enabled)return;const u=this.painter.transform,m=this.painter.context,p=m.gl,g=this._uniformValues,_=new Float64Array(16),y=u.calculatePosMatrix(i,u.worldSize);for(let v=0;v<2;v++)at.multiply(_,this._cascades[v].matrix,y),g[0===v?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(_),m.activeTexture.set(p.TEXTURE0+Us.ShadowMap0+v),this._cascades[v].texture.bind(p.NEAREST,p.CLAMP_TO_EDGE);if(this.useNormalOffset=!!l,this.useNormalOffset){const v=tg(i.canonical),w=2/u.tileSize*pt/sh,C=w*this._cascades[0].boundingSphereRadius,D=w*this._cascades[1].boundingSphereRadius,k=("vector-tile"===l?1:3)/Math.pow(2,d-i.canonical.z-(1-u.zoom+Math.floor(u.zoom)));g.u_shadow_normal_offset=[v,C*k,D*k],g.u_shadow_bias=[6e-5,.0012,.012]}else g.u_shadow_bias=[36e-5,.0012,.012];s.setShadowUniformValues(m,g)}setupShadowsFromMatrix(i,s,l=!1){if(!this._enabled)return;const d=this.painter.context,u=d.gl,m=this._uniformValues,p=new Float64Array(16);for(let g=0;g<2;g++)at.multiply(p,this._cascades[g].matrix,i),m[0===g?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(p),d.activeTexture.set(u.TEXTURE0+Us.ShadowMap0+g),this._cascades[g].texture.bind(u.NEAREST,u.CLAMP_TO_EDGE);this.useNormalOffset=l,l?(m.u_shadow_normal_offset=[1,5,5],m.u_shadow_bias=[6e-5,.0012,.012]):m.u_shadow_bias=[36e-5,.0012,.012],s.setShadowUniformValues(d,m)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(i,s,l,d){if(d[2]>=0)return{};const u=function(g,_,y){const v=y/(1<<g.canonical.z);return new gn([g.canonical.x*v+g.wrap*y,g.canonical.y*v+g.wrap*y,0],[(g.canonical.x+1)*v+g.wrap*y,(g.canonical.y+1)*v+g.wrap*y,_])}(i,s,l).getCorners(),m=s/-d[2];d[0]<0?(Z.add(u[0],u[0],[d[0]*m,0,0]),Z.add(u[3],u[3],[d[0]*m,0,0])):d[0]>0&&(Z.add(u[1],u[1],[d[0]*m,0,0]),Z.add(u[2],u[2],[d[0]*m,0,0])),d[1]<0?(Z.add(u[0],u[0],[0,d[1]*m,0]),Z.add(u[1],u[1],[0,d[1]*m,0])):d[1]>0&&(Z.add(u[2],u[2],[0,d[1]*m,0]),Z.add(u[3],u[3],[0,d[1]*m,0]));const p={};return p.vertices=u,p.planes=[ah(u[1],u[0],u[4]),ah(u[2],u[1],u[5]),ah(u[3],u[2],u[6]),ah(u[0],u[3],u[7])],p}addShadowReceiver(i,s,l){this._receivers.add(i,gn.fromTileIdAndHeight(i,s,l))}getMaxCascadeForTile(i){const s=this._receivers.get(i);return s&&s.lastCascade?s.lastCascade:0}}function ah(o,i,s){const l=Z.sub([],s,i),d=Z.sub([],o,i),u=Z.cross([],l,d),m=Z.length(u);return 0===m?[0,0,1,0]:(Z.scale(u,u,1/m),[u[0],u[1],u[2],-Z.dot(u,i)])}function Xy(o){const i=o.properties.get("direction"),s=ye(i.x,i.y,i.z);s[2]=he(s[2],0,75);const l=ne([s[0],s[1],s[2]]);return Z.fromValues(l.x,l.y,l.z)}function VE(o,i){const s=o.properties.get("color"),l=o.properties.get("intensity"),d=o.properties.get("direction"),u=[d.x,d.y,d.z],m=i.properties.get("color"),p=i.properties.get("intensity"),g=Math.max(Z.dot([0,0,1],u),0),_=[0,0,0];Z.scale(_,m.toArray01Linear().slice(0,3),p);const y=[0,0,0];return Z.scale(y,s.toArray01Linear().slice(0,3),g*l),En([_[0]>0?_[0]/(_[0]+y[0]):0,_[1]>0?_[1]/(_[1]+y[1]):0,_[2]>0?_[2]/(_[2]+y[2]):0])}function jE(o,i,s,l,d,u){const m=o.zoom,p=o.scale,g=o.worldSize,_=1/g,y=o.aspect,v=Math.sqrt(1+y*y)*Math.tan(.5*o.fovX),w=v*v,C=l-s,D=l+s;let k,S;w>C/D?(k=l,S=l*v):(k=.5*D*(1+w),S=.5*Math.sqrt(C*C+2*(l*l+s*s)*w+D*D*w*w));const E=o.projection.pixelsPerMeter(o.center.lat,g),A=o._camera.getCameraToWorldMercator(),P=[0,0,-k*_];Z.transformMat4(P,P,A);let O=S*_;const R=o._edgeInsets;if(!(0===R.left&&0===R.top&&0===R.right&&0===R.bottom||R.left===R.right&&R.top===R.bottom)){const mt=o._camera.getWorldToCamera(o.worldSize,"meters"===o.projection.zAxisUnit?E:1),ut=o._camera.getCameraToClipPerspective(o._fov,o.width/o.height,s,l);ut[8]=2*-o.centerOffset.x/o.width,ut[9]=2*o.centerOffset.y/o.height;const bt=new Float64Array(16);at.mul(bt,ut,mt);const yt=new Float64Array(16);at.invert(yt,bt);const Ct=al.fromInvProjectionMatrix(yt,g,m,!0);for(const gt of Ct.points){const At=((F=gt)[0]/=p,F[1]/=p,F[2]=sn(F[2],o._center.lat),F);O=Math.max(O,Z.len(Z.subtract([],P,At)))}}var F;O*=d/(d-1);const B=Math.acos(i[2]),j=Math.atan2(-i[0],-i[1]),U=new ky;U.position=P,U.setPitchBearing(B,j);const H=U.getWorldToCamera(g,E),W=O*g,q=Math.min(o._mercatorZfromZoom(17)*g*-2,-2*W),X=U.getCameraToClipOrthographic(-W,W,-W,W,q,(W+u*E)/i[2]),G=new Float64Array(16);at.multiply(G,X,H);const Q=Z.fromValues(Math.floor(1e6*P[0])/1e6*g,Math.floor(1e6*P[1])/1e6*g,0),it=.5*d,st=[0,0,0];Z.transformMat4(st,Q,G),Z.scale(st,st,it);const J=[Math.floor(st[0]),Math.floor(st[1]),Math.floor(st[2])],et=[0,0,0];Z.sub(et,st,J),Z.scale(et,et,-1/it);const dt=new Float64Array(16);return at.identity(dt),at.translate(dt,dt,et),at.multiply(G,dt,G),[G,W]}class YF extends gi{constructor(i){super(),this.requestManager=i,this.models={"":{}},this.numModelsLoading={}}loadModel(i,s){return KO(this.requestManager.transformRequest(s,xt.Model).url).then(l=>{if(!l)return;const d=rh(l),u=new pT(i,void 0,void 0,d);return u.computeBoundsAndApplyParent(),u}).catch(l=>{this.fire(new Yt(new Error(`Could not load model ${i} from ${s}: ${l.message}`)))})}load(i,s){this.models[s]||(this.models[s]={});const l=Object.keys(i);this.numModelsLoading[s]=(this.numModelsLoading[s]||0)+l.length;const d=[];for(const u of l)d.push(this.loadModel(u,i[u]));Promise.allSettled(d).then(u=>{for(let m=0;m<u.length;m++){const{status:p,value:g}=u[m];"fulfilled"===p&&g&&(this.models[s][l[m]]=g)}this.numModelsLoading[s]-=l.length,this.fire(new Bt("data",{dataType:"style"}))}).catch(u=>{this.fire(new Yt(new Error(`Could not load models: ${u.message}`)))})}isLoaded(){for(const i in this.numModelsLoading)if(this.numModelsLoading[i]>0)return!1;return!0}hasModel(i,s){return!!this.getModel(i,s)}getModel(i,s){return this.models[s]||(this.models[s]={}),this.models[s][i]}addModel(i,s,l){this.models[l]||(this.models[l]={}),this.hasModel(i,l)&&this.removeModel(i,l),this.load({[i]:this.requestManager.normalizeModelURL(s)},l)}addModels(i,s){const l={};for(const d in i)l[d]=this.requestManager.normalizeModelURL(i[d]);this.load(l,s)}removeModel(i,s){this.models[s]||(this.models[s]={});const l=this.models[s][i];delete this.models[s][i],l.destroy()}listModels(i){return this.models[i]||(this.models[i]={}),Object.keys(this.models[i])}upload(i,s){this.models[s]||(this.models[s]={});for(const l in this.models[s])this.models[s][l].upload(i.context)}}const vp=(o,i)=>xf(o,i&&i.filter(s=>"source.canvas"!==s.identifier)),xp=is(Zi,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","setImportUrl","setImportData","setImportConfig"]),ZF=is(Zi,["setCenter","setZoom","setBearing","setPitch"]),iC={version:8,layers:[],sources:{}},Ky={duration:300,delay:0},dV=new Set(["fill","line","background","hillshade","raster"]);class fl extends gi{constructor(i,s={}){super(),this.map=i,this.scope=s.scope||"",this.fragments=[],this.importDepth=s.importDepth||0,this.importsCache=s.importsCache||new Map,this.resolvedImports=s.resolvedImports||new Set,this.transition=se({},Ky),this._buildingIndex=new rF(this),this.crossTileSymbolIndex=new bF,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=s.styleChanges||new ZR,this.dispatcher=s.dispatcher?s.dispatcher:new Pg(Vc(),this),s.imageManager?this.imageManager=s.imageManager:(this.imageManager=new BT,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=s.glyphManager?s.glyphManager:new Lm(i._requestManager,s.localFontFamily?2:s.localIdeographFontFamily?1:0,s.localFontFamily||s.localIdeographFontFamily),s.modelManager?this.modelManager=s.modelManager:(this.modelManager=new YF(i._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=new Map,this._configDependentLayers=new Set,this._config=s.config,this.dispatcher.broadcast("setReferrer",zt());const l=this;this._rtlTextPluginCallback=fl.registerForPluginStateChange(d=>{l.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:d.pluginStatus,pluginURL:d.pluginURL},(u,m)=>{if(hb(u),m&&m.every(p=>p))for(const p in l._sourceCaches){const g=l._sourceCaches[p],_=g.getSource().type;"vector"!==_&&"geojson"!==_||g.reload()}})}),this.on("data",d=>{if("source"!==d.dataType||"metadata"!==d.sourceDataType)return;const u=this.getOwnSource(d.sourceId);if(u&&u.vectorLayerIds)for(const m in this._layers){const p=this._layers[m];p.source===u.id&&this._validateLayer(p)}})}loadURL(i,s={}){this.fire(new Bt("dataloading",{dataType:"style"}));const l="boolean"==typeof s.validate?s.validate:!nn(i);i=this.map._requestManager.normalizeStyleURL(i,s.accessToken),this.resolvedImports.add(i);const d=this.importsCache.get(i);if(d)return this._load(d,l);const u=this.map._requestManager.transformRequest(i,xt.Style);this._request=jt(u,(m,p)=>{if(this._request=null,m)this.fire(new Yt(m));else if(p)return this.importsCache.set(i,p),this._load(p,l)})}loadJSON(i,s={}){this.fire(new Bt("dataloading",{dataType:"style"})),this._request=Ze.frame(()=>{this._request=null,this._load(i,!1!==s.validate)})}loadEmpty(){this.fire(new Bt("dataloading",{dataType:"style"})),this._load(iC,!1)}_loadImports(i,s){if(this.importDepth>=4)return rt("Style doesn't support nesting deeper than 5"),Promise.resolve();const l=[];for(const d of i){const u=this._createFragmentStyle(d),m=new Promise(g=>{u.once("style.import.load",g),u.once("error",g)}).then(()=>this.mergeAll());if(l.push(m),this.resolvedImports.has(d.url)){u.loadEmpty();continue}const p=d.data||this.importsCache.get(d.url);p?u.loadJSON(p,{validate:s}):d.url?u.loadURL(d.url,{validate:s}):u.loadEmpty(),this.fragments.push({style:u,id:d.id,config:d.config})}return Promise.allSettled(l)}_createFragmentStyle(i){const s=this.scope?So(i.id,this.scope):i.id,l=new fl(this.map,{scope:s,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:i.config});return l.setEventedParent(this.map,{style:l}),l}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const i=this.isRootStyle();this._shouldPrecompile=i,this.fire(new Bt(i?"style.load":"style.import.load"))}_load(i,s){const l=i.schema;if(this.isRootStyle()&&(i.fragment||l&&!1!==i.fragment)){const m=se({},iC,{imports:[{id:"basemap",data:i,url:""}]});return void this._load(m,s)}if(this.setConfig(this._config,l),s&&vp(this,wc(i)))return;this._loaded=!0,this.stylesheet=Y(i);for(const m in i.sources)this.addSource(m,i.sources[m],{validate:!1,isInitialLoad:!0});i.sprite?this._loadSprite(i.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(i.glyphs,this.scope);const d=y1(this.stylesheet.layers);if(this._order=d.map(m=>m.id),this.stylesheet.light&&rt("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(1===this.stylesheet.lights.length&&"flat"===this.stylesheet.lights[0].type){const m=this.stylesheet.lights[0];this.light=new Qw(m.properties,m.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Qw(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const m of d){const p=Py(m,this.options);p.setScope(this.scope),p.isConfigDependent&&this._configDependentLayers.add(p.fqid),p.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=p,this._serializedLayers[p.id]=p.serialize();const g=this.getOwnLayerSourceCache(p),_=!!this.directionalLight&&this.directionalLight.shadowsEnabled();g&&p.canCastShadows()&&_&&(g.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const u=this.stylesheet.terrain;u&&(void 0===this.disableElevatedTerrain&&(this.disableElevatedTerrain=Ze.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?rt("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(u,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new Bt("data",{dataType:"style"})),i.imports?this._loadImports(i.imports,s).then(()=>this._reloadImports()):this._reloadImports()}isRootStyle(){return 0===this.importDepth}mergeAll(){let i,s,l,d,u,m,p,g;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(_=>{if(_.stylesheet){if(null!=_.light&&(i=_.light),_.stylesheet.lights)for(const y of _.stylesheet.lights)"ambient"===y.type&&null!=_.ambientLight&&(s=_.ambientLight),"directional"===y.type&&null!=_.directionalLight&&(l=_.directionalLight);d=this._prioritizeTerrain(d,_.terrain,_.stylesheet.terrain),_.stylesheet.fog&&null!=_.fog&&(u=_.fog),null!=_.stylesheet.camera&&(g=_.stylesheet.camera),null!=_.stylesheet.projection&&(m=_.stylesheet.projection),null!=_.stylesheet.transition&&(p=_.stylesheet.transition)}}),this.light=i,this.ambientLight=s,this.directionalLight=l,this.fog=u,null===d?delete this.terrain:this.terrain=d,this.camera=g||{"camera-projection":"perspective"},this.projection=m||{name:"mercator"},this.transition=se({},Ky,p),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(i){const s=l=>{for(const d of l.fragments)s(d.style);i(l)};s(this)}_prioritizeTerrain(i,s,l){const d=i&&0===i.drapeRenderMode;return null===l?s&&0===s.drapeRenderMode?s:d?i:null:null!=s&&(!i||d||s&&1===s.drapeRenderMode)?s:i}mergeTerrain(){let i;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(s=>{i=this._prioritizeTerrain(i,s.terrain,s.stylesheet.terrain)}),null===i?delete this.terrain:this.terrain=i}mergeProjection(){let i;this.forEachFragmentStyle(s=>{null!=s.stylesheet.projection&&(i=s.stylesheet.projection)}),this.projection=i||{name:"mercator"}}mergeSources(){const i={},s={},l={};this.forEachFragmentStyle(d=>{for(const u in d._sourceCaches){const m=So(u,d.scope);i[m]=d._sourceCaches[u]}for(const u in d._otherSourceCaches){const m=So(u,d.scope);s[m]=d._otherSourceCaches[u]}for(const u in d._symbolSourceCaches){const m=So(u,d.scope);l[m]=d._symbolSourceCaches[u]}}),this._mergedSourceCaches=i,this._mergedOtherSourceCaches=s,this._mergedSymbolSourceCaches=l}mergeLayers(){const i={},s=[],l={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(u=>{for(const m of u._order){const p=u._layers[m];if("slot"===p.type){const g=Df(m);if(i[g])continue;i[g]=[]}p.slot&&i[p.slot]?i[p.slot].push(p):s.push(p)}}),this._mergedOrder=[];const d=(u=[])=>{for(const m of u)if("slot"===m.type){const p=Df(m.id);i[p]&&d(i[p])}else{const p=So(m.id,m.scope);this._mergedOrder.push(p),l[p]=m,m.is3D()&&(this._has3DLayers=!0),"circle"===m.type&&(this._hasCircleLayers=!0),"symbol"===m.type&&(this._hasSymbolLayers=!0)}};d(s),this._mergedLayers=l,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}getCamera(){return this.stylesheet.camera}setCamera(i){return this.stylesheet.camera=se({},this.stylesheet.camera,i),this.camera=this.stylesheet.camera,this}setProjection(i){i?this.stylesheet.projection=i:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(i){this._spriteRequest=function(s,l,d){let u,m,p;const g=Ze.devicePixelRatio>1?"@2x":"";let _=jt(l.transformRequest(l.normalizeSpriteURL(s,g,".json"),xt.SpriteJSON),(w,C)=>{_=null,p||(p=w,u=C,v())}),y=ai(l.transformRequest(l.normalizeSpriteURL(s,g,".png"),xt.SpriteImage),(w,C)=>{y=null,p||(p=w,m=C,v())});function v(){if(p)d(p);else if(u&&m){const w=Ze.getImageData(m),C={};for(const D in u){const{width:k,height:S,x:E,y:A,sdf:P,pixelRatio:O,stretchX:R,stretchY:F,content:B}=u[D],j=new _r({width:k,height:S});_r.copy(w,j,{x:E,y:A},{x:0,y:0},{width:k,height:S}),C[D]={data:j,pixelRatio:O,sdf:P,stretchX:R,stretchY:F,content:B}}d(null,C)}}return{cancel(){_&&(_.cancel(),_=null),y&&(y.cancel(),y=null)}}}(i,this.map._requestManager,(s,l)=>{if(this._spriteRequest=null,s)this.fire(new Yt(s));else if(l)for(const d in l)this.imageManager.addImage(d,this.scope,l[d]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new Bt("data",{dataType:"style"}))})}_validateLayer(i){const s=this.getOwnSource(i.source);if(!s)return;const l=i.sourceLayer;l&&("geojson"===s.type||s.vectorLayerIds&&-1===s.vectorLayerIds.indexOf(l))&&this.fire(new Yt(new Error(`Source layer "${l}" does not exist on source "${s.id}" as specified by style layer "${i.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const i in this._sourceCaches)if(!this._sourceCaches[i].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:i}of this.fragments)if(!i.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((i,s)=>{const l=this.fragments[s];return l&&l.style&&(i.data=l.style.serialize()),i})}_serializeSources(){const i={};for(const s in this._sourceCaches){const l=this._sourceCaches[s].getSource();i[l.id]||(i[l.id]=l.serialize())}return i}_serializeLayers(i){const s=[];for(const l of i){const d=this._layers[l];d&&"custom"!==d.type&&s.push(d.serialize())}return s}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const i in this._sourceCaches)if(this._sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(i){return!!this.terrain&&("function"==typeof i.isLayerDraped?i.isLayerDraped(this.getLayerSourceCache(i)):dV.has(i.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(i){const s=this.getOwnLayer(i);if(s)return s;this.fire(new Yt(new Error(`The layer '${i}' does not exist in the map's style.`)))}_checkSource(i){const s=this.getOwnSource(i);if(s)return s;this.fire(new Yt(new Error(`The source '${i}' does not exist in the map's style.`)))}update(i){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(i),this.directionalLight&&this.directionalLight.recalculate(i);const s=this.calculateLightsBrightness();i.brightness=s||0,s!==this._brightness&&(this._brightness=s,this.dispatcher.broadcast("setBrightness",s));const l=this._changes.isDirty();if(this._changes.isDirty()){const u=this._changes.getLayerUpdatesByScope();for(const m in u){const{updatedIds:p,removedIds:g}=u[m];(p||g)&&this._updateWorkerLayers(m,p,g)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(i),this.light&&this.light.updateTransitions(i),this.ambientLight&&this.ambientLight.updateTransitions(i),this.directionalLight&&this.directionalLight.updateTransitions(i),this.fog&&this.fog.updateTransitions(i),this._changes.reset()}const d={};for(const u in this._mergedSourceCaches){const m=this._mergedSourceCaches[u];d[u]=m.used,m.used=!1}for(const u of this._mergedOrder){const m=this._mergedLayers[u];if(m.recalculate(i,this._availableImages),!m.isHidden(i.zoom)){const p=this.getLayerSourceCache(m);p&&(p.used=!0)}if(!this._precompileDone&&this._shouldPrecompile)for(let p=m.minzoom||0;p<(m.maxzoom||25.5);p++){const g=this.map.painter;if(g){const _=m.getProgramIds();if(!_)continue;for(const y of _){const v=m.getDefaultProgramParams(y,i.zoom);v&&(g.style=this,this.fog&&(g._fogVisible=!0,v.overrideFog=!0,g.getOrCreateProgram(y,v)),g._fogVisible=!1,v.overrideFog=!1,g.getOrCreateProgram(y,v),(this.stylesheet.terrain||this.stylesheet.projection&&"globe"===this.stylesheet.projection.name)&&(v.overrideRtt=!0,g.getOrCreateProgram(y,v)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const u in d){const m=this._mergedSourceCaches[u];d[u]!==m.used&&m.getSource().fire(new Bt("data",{sourceDataType:"visibility",dataType:"source",sourceId:m.getSource().id}))}this.light&&this.light.recalculate(i),this.terrain&&this.terrain.recalculate(i),this.fog&&this.fog.recalculate(i),this.z=i.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),l&&this.fire(new Bt("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=this._changes.getUpdatedImages();if(i.length){for(const s in this._sourceCaches)this._sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],i);this._changes.resetUpdatedImages()}}_updateWorkerLayers(i,s,l){const d=this.getFragmentStyle(i);d&&this.dispatcher.broadcast("updateLayers",{layers:s?d._serializeLayers(s):[],scope:i,removedIds:l||[],options:d.options})}setState(i){if(this._checkLoaded(),vp(this,wc(i)))return!1;(i=Y(i)).layers=y1(i.layers);const s=function(d,u){if(!d)return[{command:Zi.setStyle,args:[u]}];let m=[];try{if(!Ni(d.version,u.version))return[{command:Zi.setStyle,args:[u]}];Ni(d.center,u.center)||m.push({command:Zi.setCenter,args:[u.center]}),Ni(d.zoom,u.zoom)||m.push({command:Zi.setZoom,args:[u.zoom]}),Ni(d.bearing,u.bearing)||m.push({command:Zi.setBearing,args:[u.bearing]}),Ni(d.pitch,u.pitch)||m.push({command:Zi.setPitch,args:[u.pitch]}),Ni(d.sprite,u.sprite)||m.push({command:Zi.setSprite,args:[u.sprite]}),Ni(d.glyphs,u.glyphs)||m.push({command:Zi.setGlyphs,args:[u.glyphs]}),Ni(d.imports,u.imports)||function(v=[],w=[],C){w=w||[];const D=(v=v||[]).map(zy),k=w.map(zy),S=v.reduce(zg,{}),E=w.reduce(zg,{}),A=D.slice();let P,O,R,F;for(P=0,O=0;P<D.length;P++)R=D[P],E.hasOwnProperty(R)?O++:(C.push({command:Zi.removeImport,args:[R]}),A.splice(A.indexOf(R,O),1));for(P=0,O=0;P<k.length;P++)R=k[k.length-1-P],A[A.length-1-P]!==R&&(S.hasOwnProperty(R)?(C.push({command:Zi.removeImport,args:[R]}),A.splice(A.lastIndexOf(R,A.length-O),1)):O++,F=A[A.length-P],C.push({command:Zi.addImport,args:[E[R],F]}),A.splice(A.length-P,0,R));for(const B of w){const j=S[B.id];if(!j||Ni(j,B))continue;Ni(j.config,B.config)||C.push({command:Zi.setImportConfig,args:[B.id,B.config]}),Ni(j.url,B.url)||C.push({command:Zi.setImportUrl,args:[B.id,B.url]});const U=B.data;Ni(j&&j.data,U)||C.push({command:Zi.setImportData,args:[B.id,U]})}}(d.imports,u.imports,m),Ni(d.transition,u.transition)||m.push({command:Zi.setTransition,args:[u.transition]}),Ni(d.light,u.light)||m.push({command:Zi.setLight,args:[u.light]}),Ni(d.fog,u.fog)||m.push({command:Zi.setFog,args:[u.fog]}),Ni(d.projection,u.projection)||m.push({command:Zi.setProjection,args:[u.projection]}),Ni(d.lights,u.lights)||m.push({command:Zi.setLights,args:[u.lights]}),Ni(d.camera,u.camera)||m.push({command:Zi.setCamera,args:[u.camera]});const p={},g=[];!function(v,w,C,D){let k;for(k in w=w||{},v=v||{})v.hasOwnProperty(k)&&(w.hasOwnProperty(k)||KT(k,C,D));for(k in w){if(!w.hasOwnProperty(k))continue;const S=w[k];v.hasOwnProperty(k)?Ni(v[k],S)||("geojson"===v[k].type&&"geojson"===S.type&&sF(v,w,k)?C.push({command:Zi.setGeoJSONSourceData,args:[k,S.data]}):QT(k,w,C,D)):v1(k,w,C)}}(d.sources,u.sources,g,p);const _=[];d.layers&&d.layers.forEach(v=>{v.source&&p[v.source]?m.push({command:Zi.removeLayer,args:[v.id]}):_.push(v)});let y=d.terrain;y&&p[y.source]&&(m.push({command:Zi.setTerrain,args:[void 0]}),y=void 0),m=m.concat(g),Ni(y,u.terrain)||m.push({command:Zi.setTerrain,args:[u.terrain]}),function(v,w,C){w=w||[];const D=(v=v||[]).map(zy),k=w.map(zy),S=v.reduce(zg,{}),E=w.reduce(zg,{}),A=D.slice(),P=Object.create(null);let O,R,F,B,j,U,H;for(O=0,R=0;O<D.length;O++)F=D[O],E.hasOwnProperty(F)?R++:(C.push({command:Zi.removeLayer,args:[F]}),A.splice(A.indexOf(F,R),1));for(O=0,R=0;O<k.length;O++)F=k[k.length-1-O],A[A.length-1-O]!==F&&(S.hasOwnProperty(F)?(C.push({command:Zi.removeLayer,args:[F]}),A.splice(A.lastIndexOf(F,A.length-R),1)):R++,U=A[A.length-O],C.push({command:Zi.addLayer,args:[E[F],U]}),A.splice(A.length-O,0,F),P[F]=!0);for(O=0;O<k.length;O++)if(F=k[O],B=S[F],j=E[F],!P[F]&&!Ni(B,j))if(Ni(B.source,j.source)&&Ni(B["source-layer"],j["source-layer"])&&Ni(B.type,j.type)){for(H in dp(B.layout,j.layout,C,F,null,Zi.setLayoutProperty),dp(B.paint,j.paint,C,F,null,Zi.setPaintProperty),Ni(B.slot,j.slot)||C.push({command:Zi.setSlot,args:[F,j.slot]}),Ni(B.filter,j.filter)||C.push({command:Zi.setFilter,args:[F,j.filter]}),Ni(B.minzoom,j.minzoom)&&Ni(B.maxzoom,j.maxzoom)||C.push({command:Zi.setLayerZoomRange,args:[F,j.minzoom,j.maxzoom]}),B)B.hasOwnProperty(H)&&"layout"!==H&&"paint"!==H&&"filter"!==H&&"metadata"!==H&&"minzoom"!==H&&"maxzoom"!==H&&"slot"!==H&&(0===H.indexOf("paint.")?dp(B[H],j[H],C,F,H.slice(6),Zi.setPaintProperty):Ni(B[H],j[H])||C.push({command:Zi.setLayerProperty,args:[F,H,j[H]]}));for(H in j)j.hasOwnProperty(H)&&!B.hasOwnProperty(H)&&"layout"!==H&&"paint"!==H&&"filter"!==H&&"metadata"!==H&&"minzoom"!==H&&"maxzoom"!==H&&"slot"!==H&&(0===H.indexOf("paint.")?dp(B[H],j[H],C,F,H.slice(6),Zi.setPaintProperty):Ni(B[H],j[H])||C.push({command:Zi.setLayerProperty,args:[F,H,j[H]]}))}else C.push({command:Zi.removeLayer,args:[F]}),U=A[A.lastIndexOf(F)+1],C.push({command:Zi.addLayer,args:[j,U]})}(_,u.layers,m)}catch(p){console.warn("Unable to compute style diff:",p),m=[{command:Zi.setStyle,args:[u]}]}return m}(this.serialize(),i).filter(d=>!(d.command in ZF));if(0===s.length)return!1;const l=s.filter(d=>!(d.command in xp));if(l.length>0)throw new Error(`Unimplemented: ${l.map(d=>d.command).join(", ")}.`);return s.forEach(d=>{this[d.command].apply(this,d.args)}),this.stylesheet=i,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(i,s){return this.getImage(i)?this.fire(new Yt(new Error("An image with this name already exists."))):(this.imageManager.addImage(i,this.scope,s),this._afterImageUpdated(i),this)}updateImage(i,s){this.imageManager.updateImage(i,this.scope,s)}getImage(i){return this.imageManager.getImage(i,this.scope)}removeImage(i){return this.getImage(i)?(this.imageManager.removeImage(i,this.scope),this._afterImageUpdated(i),this):this.fire(new Yt(new Error("No image with this name exists.")))}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(i),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new Bt("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(i,s,l={}){return this._checkLoaded(),this._validate(ND,`models.${i}`,s,null,l)||(this.modelManager.addModel(i,s,this.scope),this._changes.setDirty()),this}hasModel(i){return this.modelManager.hasModel(i,this.scope)}removeModel(i){return this.hasModel(i)?(this.modelManager.removeModel(i,this.scope),this):this.fire(new Yt(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(i,s,l={}){if(this._checkLoaded(),void 0!==this.getOwnSource(i))throw new Error(`There is already a source with ID "${i}".`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(Rs,`sources.${i}`,s,null,l))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const d=b1(i,s,this.dispatcher,this);d.scope=this.scope,d.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(d.id),source:d.serialize(),sourceId:d.id}));const u=m=>{const p=(m?"symbol:":"other:")+d.id,g=So(p,this.scope),_=this._sourceCaches[p]=new ul(g,d,m);(m?this._symbolSourceCaches:this._otherSourceCaches)[d.id]=_,_.onAdd(this.map)};u(!1),"vector"!==s.type&&"geojson"!==s.type||u(!0),d.onAdd&&d.onAdd(this.map),l.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(i){this._checkLoaded();const s=this.getOwnSource(i);if(!s)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===i)return this.fire(new Yt(new Error(`Source "${i}" cannot be removed while layer "${d}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===i)return this.fire(new Yt(new Error(`Source "${i}" cannot be removed while terrain is using it.`)));const l=this.getOwnSourceCaches(i);for(const d of l){const u=Df(d.id);delete this._sourceCaches[u],this._changes.discardSourceCacheUpdate(d.id),d.fire(new Bt("data",{sourceDataType:"metadata",dataType:"source",sourceId:d.getSource().id})),d.setEventedParent(null),d.clearTiles()}return delete this._otherSourceCaches[i],delete this._symbolSourceCaches[i],this.mergeSources(),s.setEventedParent(null),s.onRemove&&s.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(i,s){this._checkLoaded(),this.getOwnSource(i).setData(s),this._changes.setDirty()}getOwnSource(i){const s=this.getOwnSourceCache(i);return s&&s.getSource()}getOwnSources(){const i=[];for(const s in this._otherSourceCaches){const l=this.getOwnSourceCache(s);l&&i.push(l.getSource())}return i}setLights(i){if(this._checkLoaded(),!i)return delete this.ambientLight,void delete this.directionalLight;const s=this._getTransitionParameters();for(const d of i){if(this._validate(BD,"lights",d))return;switch(d.type){case"ambient":if(this.ambientLight){const u=this.ambientLight;u.set(d),u.updateTransitions(s)}else this.ambientLight=new e1(d,rV,this.scope,this.options);break;case"directional":if(this.directionalLight){const u=this.directionalLight;u.set(d),u.updateTransitions(s)}else this.directionalLight=new e1(d,ur,this.scope,this.options)}}const l=new zn(this.z||0,s);this.ambientLight&&this.ambientLight.recalculate(l),this.directionalLight&&this.directionalLight.recalculate(l),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const i=this.directionalLight,s=this.ambientLight;if(!i||!s)return;const l=v=>.2126*(v[0]<=.03928?v[0]/12.92:Math.pow((v[0]+.055)/1.055,2.4))+.7152*(v[1]<=.03928?v[1]/12.92:Math.pow((v[1]+.055)/1.055,2.4))+.0722*(v[2]<=.03928?v[2]/12.92:Math.pow((v[2]+.055)/1.055,2.4)),d=i.properties.get("color").toArray01(),u=i.properties.get("intensity"),m=i.properties.get("direction"),p=1-ye(m.x,m.y,m.z)[2]/90,g=l(d)*u*p,_=s.properties.get("color").toArray01(),y=s.properties.get("intensity");return(g+l(_)*y)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const i=[];return this.directionalLight&&i.push(this.directionalLight.get()),this.ambientLight&&i.push(this.ambientLight.get()),i}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(i){if(!i)return this;if(Y0(i)){const s=function(u){const m=u.indexOf("\x1f");return m>=0?u.slice(m+1):""}(i),l=this.fragments.find(({id:u})=>u===s);if(!l)throw new Error(`Style import not found: ${i}`);const d=Df(i);return l.style.getFragmentStyle(d)}{const s=this.fragments.find(({id:l})=>l===i);if(!s)throw new Error(`Style import not found: ${i}`);return s.style}}getConfigProperty(i,s){const l=this.getFragmentStyle(i);if(!l)return null;const d=l.options.get(s),u=d?d.value||d.default:null;return u?u.serialize():null}setConfigProperty(i,s,l){const d=yc(l);if("success"!==d.result)return void vp(this,d.value);const u=d.value.expression,m=this.getFragmentStyle(i);if(!m)return;const p=m.options.get(s);p&&(m.options.set(s,{...p,value:u}),m.updateConfigDependencies())}setConfig(i,s){if(this._config=i,i||s)if(s){this.options.clear();for(const l in s){let d,u;const m=yc(s[l].default);if("success"===m.result&&(d=m.value.expression),i&&void 0!==i[l]){const w=yc(i[l]);"success"===w.result&&(u=w.value.expression)}const{minValue:p,maxValue:g,stepValue:_,type:y,values:v}=s[l];d?this.options.set(l,{default:d,value:u,minValue:p,maxValue:g,stepValue:_,type:y,values:v}):this.fire(new Yt(new Error(`No schema defined for config option "${l}".`)))}}else this.fire(new Yt(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const i of this._configDependentLayers){const s=this.getLayer(i);s&&(s.possiblyEvaluateVisibility(),this._updateLayer(s))}this.ambientLight&&this.ambientLight.scope===this.scope&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.scope===this.scope&&this.directionalLight.updateConfig(this.options),this._changes.setDirty()}addLayer(i,s,l={}){this._checkLoaded();const d=i.id;if(this._layers[d])return void this.fire(new Yt(new Error(`Layer with id "${d}" already exists on this map`)));let u;if("custom"===i.type){if(vp(this,function(y){const v=[],w=y.id;return void 0===w&&v.push({message:`layers.${w}: missing required property "id"`}),void 0===y.render&&v.push({message:`layers.${w}: missing required method "render"`}),y.renderingMode&&"2d"!==y.renderingMode&&"3d"!==y.renderingMode&&v.push({message:`layers.${w}: property "renderingMode" must be either "2d" or "3d"`}),v}(i)))return;u=Py(i,this.options)}else{if("object"==typeof i.source&&(this.addSource(d,i.source),i=se(i=Y(i),{source:d})),this._validate($R,`layers.${d}`,i,{arrayIndex:-1},l))return;u=Py(i,this.options),this._validateLayer(u),u.setEventedParent(this,{layer:{id:d}}),this._serializedLayers[u.id]=u.serialize()}u.isConfigDependent&&this._configDependentLayers.add(u.fqid),u.setScope(this.scope);let m=this._order.length;if(s){const y=this._order.indexOf(s);if(-1===y)return void this.fire(new Yt(new Error(`Layer with id "${s}" does not exist on this map.`)));u.slot===this._layers[s].slot?m=y:rt(`Layer with id "${s}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(m,0,d),this._layerOrderChanged=!0,this._layers[d]=u;const p=this.getOwnLayerSourceCache(u),g=!!this.directionalLight&&this.directionalLight.shadowsEnabled();p&&u.canCastShadows()&&g&&(p.castsShadows=!0);const _=this._changes.getRemovedLayer(u);if(_&&u.source&&p&&"custom"!==u.type){this._changes.discardLayerRemoval(u);const y=So(u.source,u.scope);_.type!==u.type?this._changes.updateSourceCache(y,"clear"):(this._changes.updateSourceCache(y,"reload"),p.pause())}this._updateLayer(u),u.onAdd&&u.onAdd(this.map),u.scope=this.scope,this.mergeLayers()}moveLayer(i,s){this._checkLoaded();const l=this._checkLayer(i);if(!l||i===s)return;const d=this._order.indexOf(i);this._order.splice(d,1);let u=this._order.length;if(s){const m=this._order.indexOf(s);if(-1===m)return void this.fire(new Yt(new Error(`Layer with id "${s}" does not exist on this map.`)));l.slot===this._layers[s].slot?u=m:rt(`Layer with id "${s}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(u,0,i),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(i){this._checkLoaded();const s=this._checkLayer(i);if(!s)return;s.setEventedParent(null);const l=this._order.indexOf(i);this._order.splice(l,1),delete this._layers[i],delete this._serializedLayers[i],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(s.fqid),this._changes.removeLayer(s);const d=this.getOwnLayerSourceCache(s);if(d&&d.castsShadows){let u=!1;for(const m in this._layers)if(this._layers[m].source===s.source&&this._layers[m].canCastShadows()){u=!0;break}d.castsShadows=u}s.onRemove&&s.onRemove(this.map),this.mergeLayers()}getOwnLayer(i){return this._layers[i]}hasLayer(i){return i in this._mergedLayers}hasLayerType(i){for(const s in this._layers)if(this._layers[s].type===i)return!0;return!1}setLayerZoomRange(i,s,l){this._checkLoaded();const d=this._checkLayer(i);d&&(d.minzoom===s&&d.maxzoom===l||(null!=s&&(d.minzoom=s),null!=l&&(d.maxzoom=l),this._updateLayer(d)))}setSlot(i,s){this._checkLoaded();const l=this._checkLayer(i);l&&l.slot!==s&&(l.slot=s,this._updateLayer(l))}setFilter(i,s,l={}){this._checkLoaded();const d=this._checkLayer(i);if(d&&!Ni(d.filter,s))return null==s?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(H0,`layers.${d.id}.filter`,s,{layerType:d.type},l)||(d.filter=Y(s),this._updateLayer(d)))}getFilter(i){const s=this._checkLayer(i);if(s)return Y(s.filter)}setLayoutProperty(i,s,l,d={}){this._checkLoaded();const u=this._checkLayer(i);u&&(Ni(u.getLayoutProperty(s),l)||(u.setLayoutProperty(s,l,d),u.isConfigDependent&&this._configDependentLayers.add(u.fqid),this._updateLayer(u)))}getLayoutProperty(i,s){const l=this._checkLayer(i);if(l)return l.getLayoutProperty(s)}setPaintProperty(i,s,l,d={}){this._checkLoaded();const u=this._checkLayer(i);if(!u||Ni(u.getPaintProperty(s),l))return;const m=u.setPaintProperty(s,l,d);u.isConfigDependent&&this._configDependentLayers.add(u.fqid),m&&this._updateLayer(u),this._changes.updatePaintProperties(u)}getPaintProperty(i,s){const l=this._checkLayer(i);if(l)return l.getPaintProperty(s)}setFeatureState(i,s){this._checkLoaded();const l=i.source,d=i.sourceLayer,u=this._checkSource(l);if(!u)return;const m=u.type;if("geojson"===m&&d)return void this.fire(new Yt(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===m&&!d)return void this.fire(new Yt(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===i.id&&this.fire(new Yt(new Error("The feature id parameter must be provided.")));const p=this.getOwnSourceCaches(l);for(const g of p)g.setFeatureState(d,i.id,s)}removeFeatureState(i,s){this._checkLoaded();const l=i.source,d=this._checkSource(l);if(!d)return;const u=d.type,m="vector"===u?i.sourceLayer:void 0;if("vector"===u&&!m)return void this.fire(new Yt(new Error("The sourceLayer parameter must be provided for vector source types.")));if(s&&"string"!=typeof i.id&&"number"!=typeof i.id)return void this.fire(new Yt(new Error("A feature id is required to remove its specific state property.")));const p=this.getOwnSourceCaches(l);for(const g of p)g.removeFeatureState(m,i.id,s)}getFeatureState(i){this._checkLoaded();const s=i.source,l=i.sourceLayer,d=this._checkSource(s);if(d){if("vector"!==d.type||l)return void 0===i.id&&this.fire(new Yt(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(s)[0].getFeatureState(l,i.id);this.fire(new Yt(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(i){return this.stylesheet.transition=se({},this.stylesheet.transition,i),this.transition=this.stylesheet.transition,this}getTransition(){return se({},this.stylesheet.transition)}serialize(){this._checkLoaded();const i=this.getTerrain(),s=i&&this.terrain&&this.terrain.scope===this.scope?i:this.stylesheet.terrain;return Ut({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:s,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},l=>void 0!==l)}_updateLayer(i){this._changes.updateLayer(i);const s=this.getLayerSourceCache(i),l=So(i.source,i.scope),d=this._changes.getUpdatedSourceCaches();i.source&&!d[l]&&s&&"raster"!==s.getSource().type&&(this._changes.updateSourceCache(l,"reload"),s.pause()),i.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(i){const s=p=>"fill-extrusion"===this._mergedLayers[p].type,l=this.order,d={},u=[];for(let p=l.length-1;p>=0;p--){const g=l[p];if(s(g)){d[g]=p;for(const _ of i){const y=_[g];if(y)for(const v of y)u.push(v)}}}u.sort((p,g)=>g.intersectionZ-p.intersectionZ);const m=[];for(let p=l.length-1;p>=0;p--){const g=l[p];if(s(g))for(let _=u.length-1;_>=0;_--){const y=u[_].feature;if(d[y.layer.id]<p)break;m.push(y),u.pop()}else for(const _ of i){const y=_[g];if(y)for(const v of y)m.push(v.feature)}}return m}queryRenderedFeatures(i,s,l){s&&s.filter&&this._validate(H0,"queryRenderedFeatures.filter",s.filter,null,s),s.scope=this.scope,s.availableImages=this._availableImages,s.serializedLayers=this._serializedLayers;const d={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new Yt(new Error("parameters.layers must be an Array."))),[];for(const _ of s.layers){const y=this._mergedLayers[_];if(!y)return this.fire(new Yt(new Error(`The layer '${_}' does not exist in the map's style and cannot be queried for features.`))),[];d[y.source]=!0}}const u=[],m=s.serializedLayers||{},p=s&&s.layers?s.layers.some(_=>{const y=this.getLayer(_);return y&&y.is3D()}):this.has3DLayers(),g=n1.createFromScreenPoints(i,l);for(const _ in this._mergedSourceCaches){const y=this._mergedSourceCaches[_].getSource();if(!y||y.scope!==s.scope)continue;const v=this._mergedSourceCaches[_].getSource().id;s.layers&&!d[v]||u.push(nF(this._mergedSourceCaches[_],this._mergedLayers,m,g,s,l,p,!!this.map._showQueryGeometry))}return this.placement&&u.push(function(_,y,v,w,C,D,k){const S={},E=D.queryRenderedSymbols(w),A=[];for(const P of Object.keys(E).map(Number))A.push(k[P]);A.sort(XT);for(const P of A){const O=P.featureIndex.lookupSymbolFeatures(E[P.bucketInstanceId],y,P.bucketIndex,P.sourceLayerIndex,C.filter,C.layers,C.availableImages,_);for(const R in O){const F=S[R]=S[R]||[],B=O[R];B.sort((j,U)=>{const H=P.featureSortOrder;if(H){const W=H.indexOf(j.featureIndex);return H.indexOf(U.featureIndex)-W}return U.featureIndex-j.featureIndex});for(const j of B)F.push(j)}}for(const P in S)S[P].forEach(O=>{const R=O.feature,F=v(_[P]);if(!F)return;const B=F.getFeatureState(R.layer["source-layer"],R.id);R.source=R.layer.source,R.layer["source-layer"]&&(R.sourceLayer=R.layer["source-layer"]),R.state=B});return S}(this._mergedLayers,m,this.getLayerSourceCache.bind(this),g.screenGeometry,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(u)}querySourceFeatures(i,s){s&&s.filter&&this._validate(H0,"querySourceFeatures.filter",s.filter,null,s);const l=this.getOwnSourceCaches(i);let d=[];for(const u of l)d=d.concat(ZT(u,s));return d}addSourceType(i,s,l){return fl.getSourceType(i)?l(new Error(`A source type called "${i}" already exists.`)):(fl.setSourceType(i,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:s.workerSourceURL},l):l(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(i,s,l={}){this._checkLoaded();const d=this.light.getLight();let u=!1;for(const p in i)if(!Ni(i[p],d[p])){u=!0;break}if(!u)return;const m=this._getTransitionParameters();this.light.setLight(i,s,l),this.light.updateTransitions(m)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(i,s=1){if(this._checkLoaded(),!i)return delete this.terrain,null===i?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let l=i;const d=null==i.source;if(1===s){if("object"==typeof l.source){const p="terrain-dem-src";this.addSource(p,l.source),l=Y(l),l=se(l,{source:p})}const u=se({},l),m={};if(this.terrain&&d){u.source=this.terrain.get().source;const p=this.terrain?this.getFragmentStyle(this.terrain.scope):null;p&&(m.style=p.serialize())}if(this._validate(lm,"terrain",u,m))return}if(!this.terrain||this.terrain.scope!==this.scope&&!d||this.terrain&&s!==this.terrain.drapeRenderMode){if(!l)return;this._createTerrain(l,s),this.fire(new Bt("data",{dataType:"style"}))}else{const u=this.terrain,m=u.get();for(const p of Object.keys(ct.terrain))!l.hasOwnProperty(p)&&ct.terrain[p].default&&(l[p]=ct.terrain[p].default);for(const p in i)if(!Ni(i[p],m[p])){u.set(i,this.options),this.stylesheet.terrain=i;const g=this._getTransitionParameters({duration:0});u.updateTransitions(g),this.fire(new Bt("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(i){const s=this.fog=new op(i,this.map.transform);this.stylesheet.fog=s.get();const l=this._getTransitionParameters({duration:0});s.updateTransitions(l)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const i of this.map._markers)i._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(i){if(this._checkLoaded(),!i)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const s=this.fog;if(!Ni(s.get(),i)){s.set(i),this.stylesheet.fog=s.get();const l=this._getTransitionParameters({duration:0});s.updateTransitions(l)}}else this._createFog(i);this._markersNeedUpdate=!0}_getTransitionParameters(i){return{now:Ze.now(),transition:se(this.transition,i)}}updateDrapeFirstLayers(){if(!this.terrain)return;const i=[],s=[];for(const l in this._mergedLayers)this.isLayerDraped(this._mergedLayers[l])?i.push(l):s.push(l);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...i),this._drapedFirstOrder.push(...s)}_createTerrain(i,s){const l=this.terrain=new VT(i,s,this.scope,this.options);1===s&&(this.stylesheet.terrain=i),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const d=this._getTransitionParameters({duration:0});l.updateTransitions(d)}_force3DLayerUpdate(){for(const i in this._layers){const s=this._layers[i];"fill-extrusion"===s.type&&this._updateLayer(s)}}_forceSymbolLayerUpdate(){for(const i in this._layers){const s=this._layers[i];"symbol"===s.type&&this._updateLayer(s)}}_validate(i,s,l,d,u={}){if(u&&!1===u.validate)return!1;const m=se({},this.serialize());return vp(this,i.call(wc,se({key:s,style:m,value:l,styleSpec:ct},d)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),HD.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._mergedLayers)this._mergedLayers[i].setEventedParent(null);for(const i in this._mergedSourceCaches)this._mergedSourceCaches[i].clearTiles(),this._mergedSourceCaches[i].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(i){const s=this.getSourceCaches(i);for(const l of s)l.clearTiles()}clearSources(){for(const i in this._mergedSourceCaches)this._mergedSourceCaches[i].clearTiles()}reloadSource(i){const s=this.getSourceCaches(i);for(const l of s)l.resume(),l.reload()}reloadSources(){for(const i of this.getSources())i.reload&&i.reload()}updateSources(i){let s;this.directionalLight&&(s=Xy(this.directionalLight));for(const l in this._mergedSourceCaches)this._mergedSourceCaches[l].update(i,void 0,void 0,s)}_generateCollisionBoxes(){for(const i in this._sourceCaches){const s=this._sourceCaches[i];s.resume(),s.reload()}}_updatePlacement(i,s,l,d,u=!1){let m=!1,p=!1;const g={},_={};for(const y of this._mergedOrder){const v=this._mergedLayers[y];if("symbol"!==v.type)continue;const w=So(v.source,v.scope);let C=g[w];if(!C){const k=this.getLayerSourceCache(v);if(!k)continue;const S=k.getRenderableIds(!0).map(E=>k.getTileByID(E));_[w]=S.slice(),C=g[w]=S.sort((E,A)=>A.tileID.overscaledZ-E.tileID.overscaledZ||(E.tileID.isLessThan(A.tileID)?-1:1))}const D=this.crossTileSymbolIndex.addLayer(v,C,i.center.lng,i.projection);m=m||D}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),u=u||this._layerOrderChanged||0===l,this._layerOrderChanged&&this.fire(new Bt("neworder")),(u||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Ze.now(),i.zoom))&&(this.pauseablePlacement=new C1(i,this._mergedOrder,u,s,l,d,this.placement,this.fog&&i.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,g,_),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Ze.now()),p=!0),m&&this.pauseablePlacement.placement.setStale()),p||m)for(const y of this._mergedOrder){const v=this._mergedLayers[y];"symbol"===v.type&&this.placement.updateLayerOpacities(v,g[So(v.source,v.scope)])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Ze.now())}_releaseSymbolFadeTiles(){for(const i in this._sourceCaches)this._sourceCaches[i].releaseSymbolFadeTiles()}addImport(i){this._checkLoaded();const s=this.stylesheet.imports=this.stylesheet.imports||[];return-1!==s.findIndex(({id:d})=>d===i.id)?this.fire(new Yt(new Error(`Import with id '${i.id}' already exists in the map's style.`))):(s.push(i),this._loadImports([i],!0),this)}setImportUrl(i,s){this._checkLoaded();const l=this.stylesheet.imports||[],d=this.getImportIndex(i);if(-1===d)return this;l[d].url=s;const u=this.fragments[d];return u.style=this._createFragmentStyle(l[d]),u.style.on("style.import.load",()=>this.mergeAll()),u.style.loadURL(s),this}setImportData(i,s){this._checkLoaded();const l=this.getImportIndex(i),d=this.stylesheet.imports||[];return-1===l?this:s?(this.fragments[l].style.setState(s),this._reloadImports(),this):(delete d[l].data,this.setImportUrl(i,d[l].url))}setImportConfig(i,s){this._checkLoaded();const l=this.getImportIndex(i),d=this.stylesheet.imports||[];if(-1===l)return this;s?d[l].config=s:delete d[l].config;const u=this.fragments[l],m=u.style.stylesheet&&u.style.stylesheet.schema;return u.config=s,u.style.setConfig(s,m),u.style.updateConfigDependencies(),this}removeImport(i){this._checkLoaded();const s=this.stylesheet.imports||[],l=this.getImportIndex(i);return-1===l||(s.splice(l,1),this.fragments[l].style._remove(),this.fragments.splice(l,1),this._reloadImports()),this}getImportIndex(i){const s=(this.stylesheet.imports||[]).findIndex(l=>l.id===i);return-1===s&&this.fire(new Yt(new Error(`Import '${i}' does not exist in the map's style and cannot be updated.`))),s}getLayer(i){return this._mergedLayers[i]}getSources(){const i=[];for(const s in this._mergedOtherSourceCaches){const l=this._mergedOtherSourceCaches[s];l&&i.push(l.getSource())}return i}getSource(i,s){const l=this.getSourceCache(i,s);return l&&l.getSource()}getLayerSource(i){const s=this.getLayerSourceCache(i);return s&&s.getSource()}getSourceCache(i,s){const l=So(i,s);return this._mergedOtherSourceCaches[l]}getLayerSourceCache(i){const s=So(i.source,i.scope);return"symbol"===i.type?this._mergedSymbolSourceCaches[s]:this._mergedOtherSourceCaches[s]}getSourceCaches(i){const s=[];return this._mergedOtherSourceCaches[i]&&s.push(this._mergedOtherSourceCaches[i]),this._mergedSymbolSourceCaches[i]&&s.push(this._mergedSymbolSourceCaches[i]),s}updateSourceCaches(){const i=this._changes.getUpdatedSourceCaches();for(const s in i){const l=i[s];"reload"===l?this.reloadSource(s):"clear"===l&&this.clearSource(s)}}updateLayers(i){const s=this._changes.getUpdatedPaintProperties();for(const l of s){const d=this.getLayer(l);d&&d.updateTransitions(i)}}getImages(i,s,l){this.imageManager.getImages(s.icons,s.scope,l),this._updateTilesForChangedImages();const d=u=>{u&&u.setDependencies(s.tileID.key,s.type,s.icons)};d(this._otherSourceCaches[s.source]),d(this._symbolSourceCaches[s.source])}getGlyphs(i,s,l){this.glyphManager.getGlyphs(s.stacks,s.scope,l)}getResource(i,s,l){return Ht(s,l)}getOwnSourceCache(i){return this._otherSourceCaches[i]}getOwnLayerSourceCache(i){return"symbol"===i.type?this._symbolSourceCaches[i.source]:this._otherSourceCaches[i.source]}getOwnSourceCaches(i){const s=[];return this._otherSourceCaches[i]&&s.push(this._otherSourceCaches[i]),this._symbolSourceCaches[i]&&s.push(this._symbolSourceCaches[i]),s}_isSourceCacheLoaded(i){const s=this.getOwnSourceCaches(i);return 0===s.length?(this.fire(new Yt(new Error(`There is no source with ID '${i}'`))),!1):s.every(l=>l.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function XF(o,i){let s=!1,l=null;const d=()=>{l=null,s&&(o(),l=setTimeout(d,i),s=!1)};return()=>(s=!0,l||d(),l)}fl.getSourceType=function(o){return _1[o]},fl.setSourceType=function(o,i){_1[o]=i},fl.registerForPluginStateChange=function(o){return o({pluginStatus:Ir,pluginURL:zl}),HD.on("pluginStateChange",o),o};class KF{constructor(i){this._hashName=i&&encodeURIComponent(i),qr(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=XF(this._updateHashUnthrottled.bind(this),300)}addTo(i){return this._map=i,lt.addEventListener("hashchange",this._onHashChange,!1),i.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),lt.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const i=this._map;if(!i)return"";const s=UE(i);if(this._hashName){const l=this._hashName;let d=!1;const u=lt.location.hash.slice(1).split("&").map(m=>{const p=m.split("=")[0];return p===l?(d=!0,`${p}=${s}`):m}).filter(m=>m);return d||u.push(`${l}=${s}`),`#${u.join("&")}`}return`#${s}`}_getCurrentHash(){const i=lt.location.hash.replace("#","");if(this._hashName){let s;return i.split("&").map(l=>l.split("=")).forEach(l=>{l[0]===this._hashName&&(s=l)}),(s&&s[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._map;if(!i)return!1;const s=this._getCurrentHash();if(s.length>=3&&!s.some(l=>isNaN(l))){const l=i.dragRotate.isEnabled()&&i.touchZoomRotate.isEnabled()?+(s[3]||0):i.getBearing();return i.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:l,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){const i=lt.location.href.replace(/(#.+)?$/,this.getHashString());lt.history.replaceState(lt.history.state,null,i)}}function UE(o,i){const s=o.getCenter(),l=Math.round(100*o.getZoom())/100,d=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),u=Math.pow(10,d),m=Math.round(s.lng*u)/u,p=Math.round(s.lat*u)/u,g=o.getBearing(),_=o.getPitch();let y=i?`/${m}/${p}/${l}`:`${l}/${p}/${m}`;return(g||_)&&(y+="/"+Math.round(10*g)/10),_&&(y+=`/${Math.round(_)}`),y}const Qy={linearity:.3,easing:id(0,0,.3,1)},HE=se({deceleration:2500,maxSpeed:1400},Qy),$E=se({deceleration:20,maxSpeed:1400},Qy),QF=se({deceleration:1e3,maxSpeed:360},Qy),GE=se({deceleration:1e3,maxSpeed:90},Qy);class WE{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Ze.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,s=Ze.now();for(;i.length>0&&s-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const s={zoom:0,bearing:0,pitch:0,pan:new ot(0,0),pinchAround:void 0,around:void 0};for(const{settings:u}of this._inertiaBuffer)s.zoom+=u.zoomDelta||0,s.bearing+=u.bearingDelta||0,s.pitch+=u.pitchDelta||0,u.panDelta&&s.pan._add(u.panDelta),u.around&&(s.around=u.around),u.pinchAround&&(s.pinchAround=u.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(s.pan.mag()){const u=tv(s.pan.mag(),l,se({},HE,i||{}));d.offset=s.pan.mult(u.amount/s.pan.mag()),d.center=this._map.transform.center,Jy(d,u)}if(s.zoom){const u=tv(s.zoom,l,$E);d.zoom=this._map.transform.zoom+u.amount,Jy(d,u)}if(s.bearing){const u=tv(s.bearing,l,QF);d.bearing=this._map.transform.bearing+he(u.amount,-179,179),Jy(d,u)}if(s.pitch){const u=tv(s.pitch,l,GE);d.pitch=this._map.transform.pitch+u.amount,Jy(d,u)}if(d.zoom||d.bearing){const u=void 0===s.pinchAround?s.around:s.pinchAround;d.around=u?this._map.unproject(u):this._map.getCenter()}return this.clear(),d.noMoveStart=!0,d}}function Jy(o,i){(!o.duration||o.duration<i.duration)&&(o.duration=i.duration,o.easing=i.easing)}function tv(o,i,s){const{maxSpeed:l,linearity:d,deceleration:u}=s,m=he(o*d/(i/1e3),-l,l),p=Math.abs(m)/(u*d);return{easing:s.easing,duration:1e3*p,amount:m*(p/2)}}class Hs extends Bt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,s,l,d={}){const u=Mi(s.getCanvasContainer(),l);super(i,se({point:u,lngLat:s.unproject(u),originalEvent:l},d)),this._defaultPrevented=!1,this.target=s}}class ev extends Bt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,s,l){const d="touchend"===i?l.changedTouches:l.touches,u=Hh(s.getCanvasContainer(),d),m=u.map(g=>s.unproject(g)),p=u.reduce((g,_,y,v)=>g.add(_.div(v.length)),new ot(0,0));super(i,{points:u,point:p,lngLats:m,lngLat:s.unproject(p),originalEvent:l}),this._defaultPrevented=!1}}class qE extends Bt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,s,l){super(i,{originalEvent:l}),this._defaultPrevented=!1}}class YE{constructor(i,s){this._map=i,this._clickTolerance=s.clickTolerance}reset(){this._mousedownPos=void 0}wheel(i){return this._firePreventable(new qE(i.type,this._map,i))}mousedown(i,s){return this._mousedownPos=s,this._firePreventable(new Hs(i.type,this._map,i))}mouseup(i){this._map.fire(new Hs(i.type,this._map,i))}preclick(i){const s=se({},i);s.type="preclick",this._map.fire(new Hs(s.type,this._map,s))}click(i,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||(this.preclick(i),this._map.fire(new Hs(i.type,this._map,i)))}dblclick(i){return this._firePreventable(new Hs(i.type,this._map,i))}mouseover(i){this._map.fire(new Hs(i.type,this._map,i))}mouseout(i){this._map.fire(new Hs(i.type,this._map,i))}touchstart(i){return this._firePreventable(new ev(i.type,this._map,i))}touchmove(i){this._map.fire(new ev(i.type,this._map,i))}touchend(i){this._map.fire(new ev(i.type,this._map,i))}touchcancel(i){this._map.fire(new ev(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ZE{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(i){this._map.fire(new Hs(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Hs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new Hs(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class XE{constructor(i,s){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,s){this.isEnabled()&&i.shiftKey&&0===i.button&&(io(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(i,s){if(!this._active)return;const l=s,d=this._startPos,u=this._lastPos;if(!d||!u||u.equals(l)||!this._box&&l.dist(d)<this._clickTolerance)return;this._lastPos=l,this._box||(this._box=Ci("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const m=Math.min(d.x,l.x),p=Math.max(d.x,l.x),g=Math.min(d.y,l.y),_=Math.max(d.y,l.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${m}px,${g}px)`,this._box.style.width=p-m+"px",this._box.style.height=_-g+"px")})}mouseupWindow(i,s){if(!this._active)return;const l=this._startPos,d=s;if(l&&0===i.button){if(this.reset(),rn(),l.x!==d.x||l.y!==d.y)return this._map.fire(new Bt("boxzoomend",{originalEvent:i})),{cameraAnimation:u=>u.fitScreenCoordinates(l,d,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",i)}}keydown(i){this._active&&27===i.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",i))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),L_(),delete this._startPos,delete this._lastPos}_fireEvent(i,s){return this._map.fire(new Bt(i,{originalEvent:s}))}}function nC(o,i){const s={};for(let l=0;l<o.length;l++)s[o[l].identifier]=i[l];return s}class JF{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(i,s,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=i.timeStamp),l.length===this.numTouches&&(this.centroid=function(d){const u=new ot(0,0);for(const m of d)u._add(m);return u.div(d.length)}(s),this.touches=nC(l,s)))}touchmove(i,s,l){if(this.aborted||!this.centroid)return;const d=nC(l,s);for(const u in this.touches){const m=d[u];(!m||m.dist(this.touches[u])>30)&&(this.aborted=!0)}}touchend(i,s,l){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),0===l.length){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class KE{constructor(i){this.singleTap=new JF(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(i,s,l){this.singleTap.touchstart(i,s,l)}touchmove(i,s,l){this.singleTap.touchmove(i,s,l)}touchend(i,s,l){const d=this.singleTap.touchend(i,s,l);if(d){const u=i.timeStamp-this.lastTime<500,m=!this.lastTap||this.lastTap.dist(d)<30;if(u&&m||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class QE{constructor(){this._zoomIn=new KE({numTouches:1,numTaps:2}),this._zoomOut=new KE({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,s,l){this._zoomIn.touchstart(i,s,l),this._zoomOut.touchstart(i,s,l)}touchmove(i,s,l){this._zoomIn.touchmove(i,s,l),this._zoomOut.touchmove(i,s,l)}touchend(i,s,l){const d=this._zoomIn.touchend(i,s,l),u=this._zoomOut.touchend(i,s,l);return d?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:m=>m.easeTo({duration:300,zoom:m.getZoom()+1,around:m.unproject(d)},{originalEvent:i})}):u?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:m=>m.easeTo({duration:300,zoom:m.getZoom()-1,around:m.unproject(u)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const uV={0:1,2:2};class JE{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(i,s){return!1}_move(i,s){return{}}mousedown(i,s){if(this._lastPoint)return;const l=B_(i);this._correctButton(i,l)&&(this._lastPoint=s,this._eventButton=l)}mousemoveWindow(i,s){const l=this._lastPoint;if(l)if(i.preventDefault(),null!=this._eventButton&&function(d,u){const m=uV[u];return void 0===d.buttons||(d.buttons&m)!==m}(i,this._eventButton))this.reset();else if(this._moved||!(s.dist(l)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(l,s)}mouseupWindow(i){this._lastPoint&&B_(i)===this._eventButton&&(this._moved&&rn(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hV extends JE{mousedown(i,s){super.mousedown(i,s),this._lastPoint&&(this._active=!0)}_correctButton(i,s){return 0===s&&!i.ctrlKey}_move(i,s){return{around:s,panDelta:s.sub(i)}}}class tL extends JE{_correctButton(i,s){return 0===s&&i.ctrlKey||2===s}_move(i,s){const l=.8*(s.x-i.x);if(l)return this._active=!0,{bearingDelta:l}}contextmenu(i){i.preventDefault()}}class eL extends JE{_correctButton(i,s){return 0===s&&i.ctrlKey||2===s}_move(i,s){const l=-.5*(s.y-i.y);if(l)return this._active=!0,{pitchDelta:l}}contextmenu(i){i.preventDefault()}}class mV{constructor(i,s){this._map=i,this._el=i.getCanvasContainer(),this._minTouches=1,this._clickTolerance=s.clickTolerance||1,this.reset(),qr(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new ot(0,0)}touchstart(i,s,l){return this._calculateTransform(i,s,l)}touchmove(i,s,l){if(this._active&&!(l.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===l.length&&!We())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return i.cancelable&&i.preventDefault(),this._calculateTransform(i,s,l)}}touchend(i,s,l){this._calculateTransform(i,s,l),this._active&&l.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,s,l){l.length>0&&(this._active=!0);const d=nC(l,s),u=new ot(0,0),m=new ot(0,0);let p=0;for(const _ in d){const y=d[_],v=this._touches[_];v&&(u._add(y),m._add(y.sub(v)),p++,d[_]=y)}if(this._touches=d,p<this._minTouches||!m.mag())return;const g=m.div(p);return this._sum._add(g),this._sum.mag()<this._clickTolerance?void 0:{around:u.div(p),panDelta:g}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ci("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class tA{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(i){}_move(i,s,l){return{}}touchstart(i,s,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([s[0],s[1]]))}touchmove(i,s,l){const d=this._firstTwoTouches;if(!d)return;i.preventDefault();const[u,m]=d,p=rC(l,s,u),g=rC(l,s,m);if(!p||!g)return;const _=this._aroundCenter?null:p.add(g).div(2);return this._move([p,g],_,i)}touchend(i,s,l){if(!this._firstTwoTouches)return;const[d,u]=this._firstTwoTouches,m=rC(l,s,d),p=rC(l,s,u);m&&p||(this._active&&rn(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function rC(o,i,s){for(let l=0;l<o.length;l++)if(o[l].identifier===s)return i[l]}function iL(o,i){return Math.log(o/i)/Math.LN2}class oC extends tA{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,s){const l=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(iL(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:iL(this._distance,l),pinchAround:s}}}function iv(o,i){return 180*o.angleWith(i)/Math.PI}class eA extends tA{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,s){const l=this._vector;if(this._vector=i[0].sub(i[1]),l&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:iv(this._vector,l),pinchAround:s}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const s=25/(Math.PI*this._minDiameter)*360,l=this._startVector;if(!l)return!1;const d=iv(i,l);return Math.abs(d)<s}}function sC(o){return Math.abs(o.y)>Math.abs(o.x)}class rc extends tA{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(i){this._lastPoints=i,sC(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,s,l){const d=this._lastPoints;if(!d)return;const u=i[0].sub(d[0]),m=i[1].sub(d[1]);return this._map._cooperativeGestures&&!We()&&l.touches.length<3||(this._valid=this.gestureBeginsVertically(u,m,l.timeStamp),!this._valid)?void 0:(this._lastPoints=i,this._active=!0,{pitchDelta:(u.y+m.y)/2*-.5})}gestureBeginsVertically(i,s,l){if(void 0!==this._valid)return this._valid;const d=i.mag()>=2,u=s.mag()>=2;if(!d&&!u)return;if(!d||!u)return null==this._firstMove&&(this._firstMove=l),l-this._firstMove<100&&void 0;const m=i.y>0==s.y>0;return sC(i)&&sC(s)&&m}}const nL={panStep:100,bearingStep:15,pitchStep:10};class pV{constructor(){const i=nL;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let s=0,l=0,d=0,u=0,m=0;switch(i.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:i.shiftKey?l=-1:(i.preventDefault(),u=-1);break;case 39:i.shiftKey?l=1:(i.preventDefault(),u=1);break;case 38:i.shiftKey?d=1:(i.preventDefault(),m=-1);break;case 40:i.shiftKey?d=-1:(i.preventDefault(),m=1);break;default:return}return this._rotationDisabled&&(l=0,d=0),{cameraAnimation:p=>{const g=p.getZoom();p.easeTo({duration:300,easeId:"keyboardHandler",easing:fV,zoom:s?Math.round(g)+s*(i.shiftKey?2:1):g,bearing:p.getBearing()+l*this._bearingStep,pitch:p.getPitch()+d*this._pitchStep,offset:[-u*this._panStep,-m*this._panStep],center:p.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function fV(o){return o*(2-o)}const iA=4.000244140625;class nv{constructor(i,s){this._map=i,this._el=i.getCanvasContainer(),this._handler=s,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,qr(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(i.ctrlKey||i.metaKey||this.isZooming()||We()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let s=i.deltaMode===lt.WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const l=Ze.now(),d=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,0!==s&&s%iA==0?this._type="wheel":0!==s&&Math.abs(s)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(d*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),i.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=i,this._delta-=s,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=Mi(this._el,i);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:s,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform;"wheel"===this._type&&i.projection.wrap&&(i._center.lng>=180||i._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const s=()=>i._terrainEnabled()&&this._aroundCoord?i.computeZoomRelativeTo(this._aroundCoord):i.zoom;if(0!==this._delta){const _="wheel"===this._type&&Math.abs(this._delta)>iA?this._wheelZoomRate:this._defaultZoomRate;let y=2/(1+Math.exp(-Math.abs(this._delta*_)));this._delta<0&&0!==y&&(y=1/y);const v=s(),w=Math.pow(2,v),C="number"==typeof this._targetZoom?i.zoomScale(this._targetZoom):w;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(C*y))),"wheel"===this._type&&(this._startZoom=v,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const l="number"==typeof this._targetZoom?this._targetZoom:s(),d=this._startZoom,u=this._easing;let m,p=!1;if("wheel"===this._type&&d&&u){const _=Math.min((Ze.now()-this._lastWheelEventTime)/200,1);m=_e(d,l,u(_)),_<1?this._frameId||(this._frameId=!0):p=!0}else m=l,p=!0;this._active=!0,p&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let g=m-s();return g*this._lastDelta<0&&(g=0),{noInertia:!0,needsRenderFrame:!p,zoomDelta:g,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let s=en;if(this._prevEase){const l=this._prevEase,d=(Ze.now()-l.start)/l.duration,u=l.easing(d+.01)-l.easing(d),m=.27/Math.sqrt(u*u+1e-4)*.01;s=id(m,Math.sqrt(.0729-m*m),.25,1)}return this._prevEase={start:Ze.now(),duration:i,easing:s},s}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ci("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(lt.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class rL{constructor(i,s){this._clickZoom=i,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class nA{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(i,s){return i.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:l.getZoom()+(i.shiftKey?-1:1),around:l.unproject(s)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class oL{constructor(){this._tap=new KE({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(i,s,l){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?l.length>0&&(this._swipePoint=s[0],this._swipeTouch=l[0].identifier):this._tap.touchstart(i,s,l))}touchmove(i,s,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const d=s[0],u=d.y-this._swipePoint.y;return this._swipePoint=d,i.preventDefault(),this._active=!0,{zoomDelta:u/128}}}else this._tap.touchmove(i,s,l)}touchend(i,s,l){this._tapTime?this._swipePoint&&0===l.length&&this.reset():this._tap.touchend(i,s,l)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gV{constructor(i,s,l){this._el=i,this._mousePan=s,this._touchPan=l}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class sL{constructor(i,s,l){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=s,this._mousePitch=l}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class qg{constructor(i,s,l,d){this._el=i,this._touchZoom=s,this._touchRotate=l,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const lh=o=>o.zoom||o.drag||o.pitch||o.rotate;class aL extends Bt{}class lL{constructor(){this.constants=[1,1,.01],this.radius=0}setup(i,s){const l=Z.sub([],s,i);this.radius=Z.length(l[2]<0?Z.div([],l,this.constants):[l[0],l[1],0])}projectRay(i){Z.div(i,i,this.constants),Z.normalize(i,i),Z.mul(i,i,this.constants);const s=Z.scale([],i,this.radius);if(s[2]>0){const l=Z.scale([],[0,0,1],Z.dot(s,[0,0,1])),d=Z.scale([],Z.normalize([],[s[0],s[1],0]),this.radius),u=Z.add([],s,Z.scale([],Z.sub([],Z.add([],d,l),s),2));s[0]=u[0],s[1]=u[1]}return s}}function rv(o){return o.panDelta&&o.panDelta.mag()||o.zoomDelta||o.bearingDelta||o.pitchDelta}class cL{constructor(i,s){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new WE(i),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new lL,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(s),qr(["handleEvent","handleWindowEvent"],this);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[lt.document,"mousemove",{capture:!0}],[lt.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[lt,"blur",void 0]];for(const[d,u,m]of this._listeners)d.addEventListener(u,d===lt.document?this.handleWindowEvent:this.handleEvent,m)}destroy(){for(const[i,s,l]of this._listeners)i.removeEventListener(s,i===lt.document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(i){const s=this._map,l=s.getCanvasContainer();this._add("mapEvent",new YE(s,i));const d=s.boxZoom=new XE(s,i);this._add("boxZoom",d);const u=new QE,m=new nA;s.doubleClickZoom=new rL(m,u),this._add("tapZoom",u),this._add("clickZoom",m);const p=new oL;this._add("tapDragZoom",p);const g=s.touchPitch=new rc(s);this._add("touchPitch",g);const _=new tL(i),y=new eL(i);s.dragRotate=new sL(i,_,y),this._add("mouseRotate",_,["mousePitch"]),this._add("mousePitch",y,["mouseRotate"]);const v=new hV(i),w=new mV(s,i);s.dragPan=new gV(l,v,w),this._add("mousePan",v),this._add("touchPan",w,["touchZoom","touchRotate"]);const C=new eA,D=new oC;s.touchZoomRotate=new qg(l,D,C,p),this._add("touchRotate",C,["touchPan","touchZoom"]),this._add("touchZoom",D,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ZE(s));const k=s.scrollZoom=new nv(s,this);this._add("scrollZoom",k,["mousePan"]);const S=s.keyboard=new pV;this._add("keyboard",S);for(const E of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[E]&&s[E].enable(i[E])}_add(i,s,l){this._handlers.push({handlerName:i,handler:s,allowed:l}),this._handlersById[i]=s}stop(i){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!lh(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(i,s,l){for(const d in i)if(d!==l&&(!s||s.indexOf(d)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const s=[];for(const l of i)this._el.contains(l.target)&&s.push(l);return s}handleEvent(i,s){this._updatingCamera=!0;const l="renderFrame"===i.type,d=l?void 0:i,u={needsRenderFrame:!1},m={},p={},g=i.touches?this._getMapTouches(i.touches):void 0,_=g?Hh(this._el,g):l?void 0:Mi(this._el,i);for(const{handlerName:w,handler:C,allowed:D}of this._handlers){if(!C.isEnabled())continue;let k;this._blockedByActive(p,D,w)?C.reset():C[s||i.type]&&(k=C[s||i.type](i,_,g),this.mergeHandlerResult(u,m,k,w,d),k&&k.needsRenderFrame&&this._triggerRenderFrame()),(k||C.isActive())&&(p[w]=C)}const y={};for(const w in this._previousActiveHandlers)p[w]||(y[w]=d);this._previousActiveHandlers=p,(Object.keys(y).length||rv(u))&&(this._changes.push([u,m,y]),this._triggerRenderFrame()),(Object.keys(p).length||rv(u))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:v}=u;v&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],v(this._map))}mergeHandlerResult(i,s,l,d,u){if(!l)return;se(i,l);const m={handlerName:d,originalEvent:l.originalEvent||u};void 0!==l.zoomDelta&&(s.zoom=m),void 0!==l.panDelta&&(s.drag=m),void 0!==l.pitchDelta&&(s.pitch=m),void 0!==l.bearingDelta&&(s.rotate=m)}_applyChanges(){const i={},s={},l={};for(const[d,u,m]of this._changes)d.panDelta&&(i.panDelta=(i.panDelta||new ot(0,0))._add(d.panDelta)),d.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+d.pitchDelta),void 0!==d.around&&(i.around=d.around),void 0!==d.aroundCoord&&(i.aroundCoord=d.aroundCoord),void 0!==d.pinchAround&&(i.pinchAround=d.pinchAround),d.noInertia&&(i.noInertia=d.noInertia),se(s,u),se(l,m);this._updateMapTransform(i,s,l),this._changes=[]}_updateMapTransform(i,s,l){const d=this._map,u=d.transform,m=A=>[A.x,A.y,A.z];if((A=>{const P=this._eventsInProgress.drag;return P&&!this._handlersById[P.handlerName].isActive()})()&&!rv(i)){const A=u.zoom;u.cameraElevationReference="sea",null!=this._originalZoom&&u._orthographicProjectionAtLowPitch&&"globe"!==u.projection.name&&0===u.pitch?(u.cameraElevationReference="ground",u.zoom=this._originalZoom):(u.recenterOnTerrain(),u.cameraElevationReference="ground"),A!==u.zoom&&this._map._update(!0)}if(u._isCameraConstrained&&d._stop(!0),!rv(i))return void this._fireEvents(s,l,!0);let{panDelta:p,zoomDelta:g,bearingDelta:_,pitchDelta:y,around:v,aroundCoord:w,pinchAround:C}=i;u._isCameraConstrained&&(g>0&&(g=0),u._isCameraConstrained=!1),void 0!==C&&(v=C),(g||(A=>s[A]&&!this._eventsInProgress[A])("drag"))&&v&&(this._dragOrigin=m(u.pointCoordinate3D(v)),this._originalZoom=u.zoom,this._trackingEllipsoid.setup(u._camera.position,this._dragOrigin)),u.cameraElevationReference="sea",d._stop(!0),v=v||d.transform.centerPoint,_&&(u.bearing+=_),y&&(u.pitch+=y),u._updateCameraState();const D=[0,0,0];if(p)if("mercator"===u.projection.name){const A=this._trackingEllipsoid.projectRay(u.screenPointToMercatorRay(v).dir),P=this._trackingEllipsoid.projectRay(u.screenPointToMercatorRay(v.sub(p)).dir);D[0]=P[0]-A[0],D[1]=P[1]-A[1]}else{const A=u.pointCoordinate(v);if("globe"===u.projection.name){p=p.rotate(-u.angle);const P=u._pixelsPerMercatorPixel/u.worldSize;D[0]=-p.x*Bx(an(A.y))*P,D[1]=-p.y*Bx(u.center.lat)*P}else{const P=u.pointCoordinate(v.sub(p));A&&P&&(D[0]=P.x-A.x,D[1]=P.y-A.y)}}const k=u.zoom,S=[0,0,0];if(g){const A=m(w||u.pointCoordinate3D(v)),P={dir:Z.normalize([],Z.sub([],A,u._camera.position))};if(P.dir[2]<0){const O=u.zoomDeltaToMovement(A,g);Z.scale(S,P.dir,O)}}const E=Z.add(D,D,S);u._translateCameraConstrained(E),g&&Math.abs(u.zoom-k)>1e-4&&u.recenterOnTerrain(),u.cameraElevationReference="ground",this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(s,l,!0)}_fireEvents(i,s,l){const d=lh(this._eventsInProgress),u=lh(i),m={};for(const y in i){const{originalEvent:v}=i[y];this._eventsInProgress[y]||(m[`${y}start`]=v),this._eventsInProgress[y]=i[y]}!d&&u&&this._fireEvent("movestart",u.originalEvent);for(const y in m)this._fireEvent(y,m[y]);u&&this._fireEvent("move",u.originalEvent);for(const y in i){const{originalEvent:v}=i[y];this._fireEvent(y,v)}const p={};let g;for(const y in this._eventsInProgress){const{handlerName:v,originalEvent:w}=this._eventsInProgress[y];this._handlersById[v].isActive()||(delete this._eventsInProgress[y],g=s[v]||w,p[`${y}end`]=g)}for(const y in p)this._fireEvent(y,p[y]);const _=lh(this._eventsInProgress);if(l&&(d||u)&&!_){this._updatingCamera=!0;const y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),v=w=>0!==w&&-this._bearingSnap<w&&w<this._bearingSnap;y?(v(y.bearing||this._map.getBearing())&&(y.bearing=0),this._map.easeTo(y,{originalEvent:g})):(this._map.fire(new Bt("moveend",{originalEvent:g})),v(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,s){this._map.fire(new Bt(i,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{this._frameId=void 0,this.handleEvent(new aL("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const rA="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class dL extends gi{constructor(i,s){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=s.bearingSnap,this._respectPrefersReducedMotion=!1!==s.respectPrefersReducedMotion,qr(["_renderFrameCallback"],this)}getCenter(){return new qe(this.transform.center.lng,this.transform.center.lat)}setCenter(i,s){return this.jumpTo({center:i},s)}panBy(i,s,l){return i=ot.convert(i).mult(-1),this.panTo(this.transform.center,se({offset:i},s),l)}panTo(i,s,l){return this.easeTo(se({center:i},s),l)}getZoom(){return this.transform.zoom}setZoom(i,s){return this.jumpTo({zoom:i},s),this}zoomTo(i,s,l){return this.easeTo(se({zoom:i},s),l)}zoomIn(i,s){return this.zoomTo(this.getZoom()+1,i,s),this}zoomOut(i,s){return this.zoomTo(this.getZoom()-1,i,s),this}getBearing(){return this.transform.bearing}setBearing(i,s){return this.jumpTo({bearing:i},s),this}getPadding(){return this.transform.padding}setPadding(i,s){return this.jumpTo({padding:i},s),this}rotateTo(i,s,l){return this.easeTo(se({bearing:i},s),l)}resetNorth(i,s){return this.rotateTo(0,se({duration:1e3},i),s),this}resetNorthPitch(i,s){return this.easeTo(se({bearing:0,pitch:0,duration:1e3},i),s),this}snapToNorth(i,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,s):this}getPitch(){return this.transform.pitch}setPitch(i,s){return this.jumpTo({pitch:i},s),this}cameraForBounds(i,s){i=go.convert(i);const l=s&&s.bearing||0,d=s&&s.pitch||0,u=i.getNorthWest(),m=i.getSouthEast();return this._cameraForBounds(this.transform,u,m,l,d,s)}_extendCameraOptions(i){const s={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=se({padding:s,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const l=i.padding;i.padding={top:l,bottom:l,right:l,left:l}}return i.padding=se(s,i.padding),i}_minimumAABBFrustumDistance(i,s){const l=s.max[0]-s.min[0],d=s.max[1]-s.min[1];return l/d>i.aspect?l/(2*Math.tan(.5*i.fovX)*i.aspect):d/(2*Math.tan(.5*i.fovY)*i.aspect)}_cameraForBoundsOnGlobe(i,s,l,d,u,m){const p=i.clone(),g=this._extendCameraOptions(m);p.bearing=d,p.pitch=u;const _=qe.convert(s),y=qe.convert(l),v=.5*(_.lat+y.lat),w=.5*(_.lng+y.lng),C=fs(v,w),D=Z.normalize([],C),k=Z.normalize([],Z.cross([],D,[0,1,0])),S=Z.cross([],k,D),E=[k[0],k[1],k[2],0,S[0],S[1],S[2],0,D[0],D[1],D[2],0,0,0,0,1],A=[C,fs(_.lat,_.lng),fs(y.lat,_.lng),fs(y.lat,y.lng),fs(_.lat,y.lng),fs(v,_.lng),fs(v,y.lng),fs(_.lat,w),fs(y.lat,w)];let P=gn.fromPoints(A.map(et=>[Z.dot(k,et),Z.dot(S,et),Z.dot(D,et)]));const O=Z.transformMat4([],P.center,E);0===Z.squaredLength(O)&&Z.set(O,0,0,1),Z.normalize(O,O),Z.scale(O,O,ms),p.center=function([et,dt,mt]){const ut=Math.hypot(et,dt,mt),bt=Math.atan2(et,mt),yt=.5*Math.PI-Math.acos(-dt/ut);return new qe(jr(bt),jr(yt))}(O);const R=p.getWorldToCameraMatrix(),F=at.invert(new Float64Array(16),R);P=gn.applyTransform(P,at.multiply([],R,E)),Z.transformMat4(O,O,R);const B=.5*(P.max[2]-P.min[2]),j=this._minimumAABBFrustumDistance(p,P),U=Z.scale([],[0,0,1],B),H=Z.add(U,O,U),W=j+(0===p.pitch?0:Z.distance(O,H)),q=p.globeCenterInViewSpace,X=Z.sub([],O,[q[0],q[1],q[2]]);Z.normalize(X,X),Z.scale(X,X,W);const G=Z.add([],O,X);Z.transformMat4(G,G,F);const Q=Qf/ms,it=Z.length(G),st=sn(Math.max(it*Q-Qf,Number.EPSILON),0),J=Math.min(p.zoomFromMercatorZAdjusted(st),g.maxZoom);return J>.5*(Zf+Md)?(p.setProjection({name:"mercator"}),p.zoom=J,this._cameraForBounds(p,s,l,d,u,m)):{center:p.center,zoom:J,bearing:d,pitch:u}}queryTerrainElevation(i,s){const l=this.transform.elevation;return l?(s=se({},{exaggerated:!0},s),l.getAtPoint(Ei.fromLngLat(i),null,s.exaggerated)):null}_cameraForBounds(i,s,l,d,u,m){if("globe"===i.projection.name)return this._cameraForBoundsOnGlobe(i,s,l,d,u,m);const p=i.clone(),g=this._extendCameraOptions(m),_=p.padding;p.bearing=d,p.pitch=u;const y=qe.convert(s),v=qe.convert(l),w=new qe(y.lng,v.lat),C=new qe(v.lng,y.lat),D=p.project(y),k=p.project(v),S=this.queryTerrainElevation(y),E=this.queryTerrainElevation(v),A=this.queryTerrainElevation(w),P=this.queryTerrainElevation(C),O=[[D.x,D.y,Math.min(S||0,E||0,A||0,P||0)],[k.x,k.y,Math.max(S||0,E||0,A||0,P||0)]];let R=gn.fromPoints(O);const F=p.getWorldToCameraMatrix(),B=at.invert(new Float64Array(16),F);R=gn.applyTransform(R,F);const j=Z.sub([],R.max,R.min),U=_.left||0,H=_.right||0,W=_.bottom||0,q=_.top||0,{left:X,right:G,top:Q,bottom:it}=g.padding,st=.5*(U+H),J=.5*(q+W),et=Math.min(p.scaleZoom(p.scale*Math.min((p.width-(U+H+X+G))/j[0],(p.height-(W+q+it+Q))/j[1])),g.maxZoom),dt=p.scale/p.zoomScale(et);R=new gn([R.min[0]-(X+st)*dt,R.min[1]-(it+J)*dt,R.min[2]],[R.max[0]+(G+st)*dt,R.max[1]+(Q+J)*dt,R.max[2]]);const mt=.5*j[2],ut=this._minimumAABBFrustumDistance(p,R),bt=[0,0,1,0];Qi.transformMat4(bt,bt,F),Qi.normalize(bt,bt);const yt=Z.scale([],bt,ut+mt),Ct=Z.add([],R.center,yt),gt=("number"==typeof g.offset.x&&"number"==typeof g.offset.y?new ot(g.offset.x,g.offset.y):ot.convert(g.offset)).rotate(-ni(d));R.center[0]-=gt.x*dt,R.center[1]+=gt.y*dt,Z.transformMat4(R.center,R.center,B),Z.transformMat4(Ct,Ct,B);const At=[R.center[0],R.center[1],Ct[2]*p.pixelsPerMeter];Z.scale(At,At,1/p.worldSize);const Gt=Ls(At[0]),Et=an(At[1]),te=Math.min(p._zoomFromMercatorZ(At[2]),g.maxZoom),ie=new qe(Gt,Et);return p.mercatorFromTransition&&te<.5*(Zf+Md)?(p.setProjection({name:"globe"}),p.zoom=te,this._cameraForBounds(p,s,l,d,u,m)):{center:ie,zoom:te,bearing:d,pitch:u}}fitBounds(i,s,l){const d=this.cameraForBounds(i,s);return this._fitInternal(d,s,l)}fitScreenCoordinates(i,s,l,d,u){const m=ot.convert(i),p=ot.convert(s),g=new ot(Math.min(m.x,p.x),Math.min(m.y,p.y)),_=new ot(Math.max(m.x,p.x),Math.max(m.y,p.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(m,p))return this;const y=this.transform.pointLocation3D(g),v=this.transform.pointLocation3D(_),w=this.transform.pointLocation3D(new ot(g.x,_.y)),C=this.transform.pointLocation3D(new ot(_.x,g.y)),D=[Math.min(y.lng,v.lng,w.lng,C.lng),Math.min(y.lat,v.lat,w.lat,C.lat)],k=[Math.max(y.lng,v.lng,w.lng,C.lng),Math.max(y.lat,v.lat,w.lat,C.lat)],S=d&&d.pitch?d.pitch:this.getPitch(),E=this._cameraForBounds(this.transform,D,k,l,S,d);return this._fitInternal(E,d,u)}_fitInternal(i,s,l){return i?(delete(s=se(i,s)).padding,s.linear?this.easeTo(s,l):this.flyTo(s,l)):this}jumpTo(i,s){this.stop();const l=i.preloadOnly?this.transform.clone():this.transform;let d=!1,u=!1,m=!1;return"zoom"in i&&l.zoom!==+i.zoom&&(d=!0,l.zoom=+i.zoom),void 0!==i.center&&(l.center=qe.convert(i.center)),"bearing"in i&&l.bearing!==+i.bearing&&(u=!0,l.bearing=+i.bearing),"pitch"in i&&l.pitch!==+i.pitch&&(m=!0,l.pitch=+i.pitch),null==i.padding||l.isPaddingEqual(i.padding)||(l.padding=i.padding),i.preloadOnly?(this._preloadTiles(l),this):(this.fire(new Bt("movestart",s)).fire(new Bt("move",s)),d&&this.fire(new Bt("zoomstart",s)).fire(new Bt("zoom",s)).fire(new Bt("zoomend",s)),u&&this.fire(new Bt("rotatestart",s)).fire(new Bt("rotate",s)).fire(new Bt("rotateend",s)),m&&this.fire(new Bt("pitchstart",s)).fire(new Bt("pitch",s)).fire(new Bt("pitchend",s)),this.fire(new Bt("moveend",s)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||rt(rA),this.transform.getFreeCameraOptions()}setFreeCameraOptions(i,s){const l=this.transform;if(!l.projection.supportsFreeCamera)return rt(rA),this;this.stop();const d=l.zoom,u=l.pitch,m=l.bearing;l.setFreeCameraOptions(i);const p=d!==l.zoom,g=u!==l.pitch,_=m!==l.bearing;return this.fire(new Bt("movestart",s)).fire(new Bt("move",s)),p&&this.fire(new Bt("zoomstart",s)).fire(new Bt("zoom",s)).fire(new Bt("zoomend",s)),_&&this.fire(new Bt("rotatestart",s)).fire(new Bt("rotate",s)).fire(new Bt("rotateend",s)),g&&this.fire(new Bt("pitchstart",s)).fire(new Bt("pitch",s)).fire(new Bt("pitchend",s)),this.fire(new Bt("moveend",s)),this}easeTo(i,s){this._stop(!1,i.easeId),(!1===(i=se({offset:[0,0],duration:500,easing:en},i)).animate||this._prefersReducedMotion(i))&&(i.duration=0);const l=this.transform,d=this.getZoom(),u=this.getBearing(),m=this.getPitch(),p=this.getPadding(),g="zoom"in i?+i.zoom:d,_="bearing"in i?this._normalizeBearing(i.bearing,u):u,y="pitch"in i?+i.pitch:m,v="padding"in i?i.padding:l.padding,w=ot.convert(i.offset);let C,D,k;if("globe"===l.projection.name){const U=Ei.fromLngLat(l.center),H=w.rotate(-l.angle);U.x+=H.x/l.worldSize,U.y+=H.y/l.worldSize;const W=U.toLngLat(),q=qe.convert(i.center||W);this._normalizeCenter(q),C=l.centerPoint.add(H),D=new ot(U.x,U.y).mult(l.worldSize),k=new ot(dr(q.lng),Rr(q.lat)).mult(l.worldSize).sub(D)}else{C=l.centerPoint.add(w);const U=l.pointLocation(C),H=qe.convert(i.center||U);this._normalizeCenter(H),D=l.project(U),k=l.project(H).sub(D)}const S=l.zoomScale(g-d);let E,A;i.around&&(E=qe.convert(i.around),A=l.locationPoint(E));const P=this._zooming||g!==d,O=this._rotating||u!==_,R=this._pitching||y!==m,F=!l.isPaddingEqual(v),B=U=>H=>{if(P&&(U.zoom=_e(d,g,H)),O&&(U.bearing=_e(u,_,H)),R&&(U.pitch=_e(m,y,H)),F&&(U.interpolatePadding(p,v,H),C=U.centerPoint.add(w)),E)U.setLocationAtPoint(E,A);else{const W=U.zoomScale(U.zoom-d),q=g>d?Math.min(2,S):Math.max(.5,S),X=Math.pow(q,1-H),G=U.unproject(D.add(k.mult(H*X)).mult(W));U.setLocationAtPoint(U.renderWorldCopies?G.wrap():G,C)}return i.preloadOnly||this._fireMoveEvents(s),U};if(i.preloadOnly){const U=this._emulate(B,i.duration,l);return this._preloadTiles(U),this}const j={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=P,this._rotating=O,this._pitching=R,this._padding=F,this._easeId=i.easeId,this._prepareEase(s,i.noMoveStart,j),this._ease(B(l),U=>{"sea"===l.cameraElevationReference&&l.recenterOnTerrain(),this._afterEase(s,U)},i),this}_prepareEase(i,s,l={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&0===this.transform.pitch&&"globe"!==this.transform.projection.name&&(this.transform.cameraElevationReference="ground"),s||l.moving||this.fire(new Bt("movestart",i)),this._zooming&&!l.zooming&&this.fire(new Bt("zoomstart",i)),this._rotating&&!l.rotating&&this.fire(new Bt("rotatestart",i)),this._pitching&&!l.pitching&&this.fire(new Bt("pitchstart",i))}_fireMoveEvents(i){this.fire(new Bt("move",i)),this._zooming&&this.fire(new Bt("zoom",i)),this._rotating&&this.fire(new Bt("rotate",i)),this._pitching&&this.fire(new Bt("pitch",i))}_afterEase(i,s){if(this._easeId&&s&&this._easeId===s)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const l=this._zooming,d=this._rotating,u=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,l&&this.fire(new Bt("zoomend",i)),d&&this.fire(new Bt("rotateend",i)),u&&this.fire(new Bt("pitchend",i)),this.fire(new Bt("moveend",i))}flyTo(i,s){if(this._prefersReducedMotion(i)){const et=is(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(et,s)}this.stop(),i=se({offset:[0,0],speed:1.2,curve:1.42,easing:en},i);const l=this.transform,d=this.getZoom(),u=this.getBearing(),m=this.getPitch(),p=this.getPadding(),g="zoom"in i?he(+i.zoom,l.minZoom,l.maxZoom):d,_="bearing"in i?this._normalizeBearing(i.bearing,u):u,y="pitch"in i?+i.pitch:m,v="padding"in i?i.padding:l.padding,w=l.zoomScale(g-d),C=ot.convert(i.offset);let D=l.centerPoint.add(C);const k=l.pointLocation(D),S=qe.convert(i.center||k);this._normalizeCenter(S);const E=l.project(k),A=l.project(S).sub(E);let P=i.curve;const O=Math.max(l.width,l.height),R=O/w,F=A.mag();if("minZoom"in i){const et=he(Math.min(i.minZoom,d,g),l.minZoom,l.maxZoom),dt=O/l.zoomScale(et-d);P=Math.sqrt(dt/F*2)}const B=P*P;function j(et){const dt=(R*R-O*O+(et?-1:1)*B*B*F*F)/(2*(et?R:O)*B*F);return Math.log(Math.sqrt(dt*dt+1)-dt)}function U(et){return(Math.exp(et)-Math.exp(-et))/2}function H(et){return(Math.exp(et)+Math.exp(-et))/2}const W=j(0);let q=function(et){return H(W)/H(W+P*et)},X=function(et){return O*((H(W)*(U(dt=W+P*et)/H(dt))-U(W))/B)/F;var dt},G=(j(1)-W)/P;if(Math.abs(F)<1e-6||!isFinite(G)){if(Math.abs(O-R)<1e-6)return this.easeTo(i,s);const et=R<O?-1:1;G=Math.abs(Math.log(R/O))/P,X=function(){return 0},q=function(dt){return Math.exp(et*P*dt)}}i.duration="duration"in i?+i.duration:1e3*G/("screenSpeed"in i?+i.screenSpeed/P:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0);const Q=u!==_,it=y!==m,st=!l.isPaddingEqual(v),J=et=>dt=>{const mt=dt*G,ut=1/q(mt);et.zoom=1===dt?g:d+et.scaleZoom(ut),Q&&(et.bearing=_e(u,_,dt)),it&&(et.pitch=_e(m,y,dt)),st&&(et.interpolatePadding(p,v,dt),D=et.centerPoint.add(C));const bt=1===dt?S:et.unproject(E.add(A.mult(X(mt))).mult(ut));return et.setLocationAtPoint(et.renderWorldCopies?bt.wrap():bt,D),et._updateCameraOnTerrain(),i.preloadOnly||this._fireMoveEvents(s),et};if(i.preloadOnly){const et=this._emulate(J,i.duration,l);return this._preloadTiles(et),this}return this._zooming=!0,this._rotating=Q,this._pitching=it,this._padding=st,this._prepareEase(s,!1),this._ease(J(l),()=>this._afterEase(s),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const l=this._onEaseEnd;this._onEaseEnd=void 0,l.call(this,s)}if(!i){const l=this.handlers;l&&l.stop(!1)}return this}_ease(i,s,l){!1===l.animate||0===l.duration?(i(1),s()):(this._easeStart=Ze.now(),this._easeOptions=l,this._onEaseFrame=i,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((Ze.now()-this._easeStart)/this._easeOptions.duration,1),s=this._onEaseFrame;s&&s(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,s){i=Rl(i,-180,180);const l=Math.abs(i-s);return Math.abs(i-360-s)<l&&(i-=360),Math.abs(i+360-s)<l&&(i+=360),i}_normalizeCenter(i){const s=this.transform;if(s.maxBounds||"globe"!==s.projection.name&&!s.renderWorldCopies)return;const l=i.lng-s.center.lng;i.lng+=l>180?-360:l<-180?360:0}_prefersReducedMotion(i){return this._respectPrefersReducedMotion&&Ze.prefersReducedMotion&&!(i&&i.essential)}_emulate(i,s,l){const d=Math.ceil(15*s/1e3),u=[],m=i(l.clone());for(let p=0;p<=d;p++){const g=m(p/d);u.push(g.clone())}return u}}class ov{constructor(i={}){this.options=i,qr(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){const s=this.options&&this.options.compact;return this._map=i,this._container=Ci("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Ci("button","mapboxgl-ctrl-attrib-button",this._container),Ci("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Ci("div","mapboxgl-ctrl-attrib-inner",this._container),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===s&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(i,s){const l=this._map._getUIString(`AttributionControl.${s}`);i.removeAttribute("title"),i.firstElementChild&&i.firstElementChild.setAttribute("title",l)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));const s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||mi.ACCESS_TOKEN}];if(i){const l=s.reduce((d,u,m)=>(u.value&&(d+=`${u.key}=${u.value}${m<s.length-1?"&":""}`),d),"?");i.href=`${mi.FEEDBACK_URL}/${l}#${UE(this._map,!0)}`,i.rel="noopener nofollow",this._setElementTitle(i,"MapFeedback")}}_updateData(i){!i||"metadata"!==i.sourceDataType&&"visibility"!==i.sourceDataType&&"style"!==i.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let i=[];if(this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const s=this._map.style._mergedSourceCaches;for(const d in s){const u=s[d];if(u.used){const m=u.getSource();m.attribution&&i.indexOf(m.attribution)<0&&i.push(m.attribution)}}i.sort((d,u)=>d.length-u.length),i=i.filter((d,u)=>{for(let m=u+1;m<i.length;m++)if(i[m].indexOf(d)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=[...this.options.customAttribution,...i]:i.unshift(this.options.customAttribution));const l=i.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,i.length?(this._innerContainer.innerHTML=l,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class oA{constructor(){qr(["_updateLogo","_updateCompact"],this)}onAdd(i){this._map=i,this._container=Ci("div","mapboxgl-ctrl");const s=Ci("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(i){i&&"metadata"!==i.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const i=this._map.style._sourceCaches;if(0===Object.entries(i).length)return!0;for(const s in i){const l=i[s].getSource();if(l.hasOwnProperty("mapbox_logo")&&!l.mapbox_logo)return!1}return!0}_updateCompact(){const i=this._container.children;if(i.length){const s=i[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}}}class sA{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const s=++this._id;return this._queue.push({callback:i,id:s,cancelled:!1}),s}remove(i){const s=this._currentlyRunning,l=s?this._queue.concat(s):this._queue;for(const d of l)if(d.id===i)return void(d.cancelled=!0)}run(i=0){const s=this._currentlyRunning=this._queue;this._queue=[];for(const l of s)if(!l.cancelled&&(l.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function aA(o,i,s){if(o=new qe(o.lng,o.lat),i){const l=new qe(o.lng-360,o.lat),d=new qe(o.lng+360,o.lat),u=360*Math.ceil(Math.abs(o.lng-s.center.lng)/360),m=s.locationPoint(o).distSqr(i),p=i.x<0||i.y<0||i.x>s.width||i.y>s.height;s.locationPoint(l).distSqr(i)<m&&(p||Math.abs(l.lng-s.center.lng)<u)?o=l:s.locationPoint(d).distSqr(i)<m&&(p||Math.abs(d.lng-s.center.lng)<u)&&(o=d)}for(;Math.abs(o.lng-s.center.lng)>180;){const l=s.locationPoint(o);if(l.x>=0&&l.y>=0&&l.x<=s.width&&l.y<=s.height)break;o.lng>s.center.lng?o.lng-=360:o.lng+=360}return o}const aC={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class lC extends gi{constructor(i,s){if(super(),(i instanceof lt.HTMLElement||s)&&(i=se({element:i},s)),qr(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=i&&i.occludedOpacity||.2,i&&i.element)this._element=i.element,this._offset=ot.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ci("div");const u=41,m=27,p=wa("svg",{display:"block",height:u*this._scale+"px",width:m*this._scale+"px",viewBox:`0 0 ${m} ${u}`},this._element),g=wa("radialGradient",{id:"shadowGradient"},wa("defs",{},p));wa("stop",{offset:"10%","stop-opacity":.4},g),wa("stop",{offset:"100%","stop-opacity":.05},g),wa("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},p),wa("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},p),wa("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},p),wa("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},p),this._offset=ot.convert(i&&i.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()});const l=this._element.classList;for(const u in aC)l.remove(`mapboxgl-marker-anchor-${u}`);l.add(`mapboxgl-marker-anchor-${this._anchor}`);const d=i&&i.className?i.className.trim().split(/\s+/):[];l.add(...d),this._popup=null}addTo(i){return i===this._map||(this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._updateMoving),i.on("moveend",this._update),i.on("remove",this._clearFadeTimer),i._addMarker(this),this.setDraggable(this._draggable),this._update(),i.on("click",this._onMapClick)),this}remove(){const i=this._map;return i&&(i.off("click",this._onMapClick),i.off("move",this._updateMoving),i.off("moveend",this._update),i.off("mousedown",this._addDragHandler),i.off("touchstart",this._addDragHandler),i.off("mouseup",this._onUp),i.off("touchend",this._onUp),i.off("mousemove",this._onMove),i.off("touchmove",this._onMove),i.off("remove",this._clearFadeTimer),i._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=qe.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const d=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(24.6+d)],"bottom-right":[-d,-1*(24.6+d)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=i,i._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(i){const s=i.code,l=i.charCode||i.keyCode;"Space"!==s&&"Enter"!==s&&32!==l&&13!==l||this.togglePopup()}_onMapClick(i){const s=i.originalEvent.target,l=this._element;this._popup&&(s===l||l.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?(i.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(i.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const i=this._map,s=this._pos;if(!i||!s)return!1;const l=i.unproject(s),d=i.getFreeCameraOptions();if(!d.position)return!1;const u=d.position.toLngLat();return u.distanceTo(l)<.9*u.distanceTo(this._lngLat)}_evaluateOpacity(){const i=this._map;if(!i)return;const s=this._pos;if(!s||s.x<0||s.x>i.transform.width||s.y<0||s.y>i.transform.height)return void this._clearFadeTimer();const l=i.unproject(s);let d;i._showingGlobe()&&Px(i.transform,this._lngLat)?d=0:(d=1-i._queryFogOpacity(l),i.transform._terrainEnabled()&&i.getTerrain()&&this._behindTerrain()&&(d*=this._occludedOpacity)),this._element.style.opacity=`${d}`,this._element.style.pointerEvents=d>0?"auto":"none",this._popup&&this._popup._setOpacity(d),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const i=this._pos;if(!i||!this._map)return;const s=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${i.x}px,${i.y}px)\n            ${aC[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${s.x}px,${s.y}px)\n        `}_calculateXYTransform(){const i=this._pos,s=this._map,l=this.getPitchAlignment();if(!s||!i||"map"!==l)return"";if(!s._showingGlobe()){const g=s.getPitch();return g?`rotateX(${g}deg)`:""}const d=jr(fP(s.transform,this._lngLat)),u=i.sub(Rx(s.transform)),m=Math.abs(u.x)+Math.abs(u.y);if(0===m)return"";const p=d/m;return`rotateX(${-u.y*p}deg) rotateY(${u.x*p}deg)`}_calculateZTransform(){const i=this._pos,s=this._map;if(!s||!i)return"";let l=0;const d=this.getRotationAlignment();if("map"===d)if(s._showingGlobe()){const u=s.project(new qe(this._lngLat.lng,this._lngLat.lat+.001)),m=s.project(new qe(this._lngLat.lng,this._lngLat.lat-.001)).sub(u);l=jr(Math.atan2(m.y,m.x))-90}else l=-s.getBearing();else if("horizon"===d){const u=Il(4,6,s.getZoom()),m=Rx(s.transform);m.y+=u*s.transform.height;const p=i.sub(m),g=jr(Math.atan2(p.y,p.x));l=(g>90?g-270:g+90)*(1-u)}return l+=this._rotation,l?`rotateZ(${l}deg)`:""}_update(i){lt.cancelAnimationFrame(this._updateFrameId);const s=this._map;s&&(s.transform.renderWorldCopies&&(this._lngLat=aA(this._lngLat,this._pos,s.transform)),this._pos=s.project(this._lngLat),!0===i?this._updateFrameId=lt.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),s._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(s._showingGlobe()||s.getTerrain()||s.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(i){return this._offset=ot.convert(i),this._update(),this}addClassName(i){return this._element.classList.add(i),this}removeClassName(i){return this._element.classList.remove(i),this}toggleClassName(i){return this._element.classList.toggle(i)}_onMove(i){const s=this._map;if(!s)return;const l=this._pointerdownPos,d=this._positionDelta;if(l&&d){if(!this._isDragging){const u=this._clickTolerance||s._clickTolerance;if(i.point.dist(l)<u)return;this._isDragging=!0}this._pos=i.point.sub(d),this._lngLat=s.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new Bt("dragstart"))),this.fire(new Bt("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const i=this._map;i&&(i.off("mousemove",this._onMove),i.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new Bt("dragend")),this._state="inactive"}_addDragHandler(i){const s=this._map,l=this._pos;s&&l&&this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(l),this._pointerdownPos=i.point,this._state="pending",s.on("mousemove",this._onMove),s.on("touchmove",this._onMove),s.once("mouseup",this._onUp),s.once("touchend",this._onUp))}setDraggable(i){this._draggable=!!i;const s=this._map;return s&&(i?(s.on("mousedown",this._addDragHandler),s.on("touchstart",this._addDragHandler)):(s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(i){return this._occludedOpacity=i||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const uL={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},hL=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function lA(o=new ot(0,0),i="bottom"){if("number"==typeof o){const s=Math.round(Math.sqrt(.5*Math.pow(o,2)));switch(i){case"top":return new ot(0,o);case"top-left":return new ot(s,s);case"top-right":return new ot(-s,s);case"bottom":return new ot(0,-o);case"bottom-left":return new ot(s,-s);case"bottom-right":return new ot(-s,-s);case"left":return new ot(o,0);case"right":return new ot(-o,0)}return new ot(0,0)}return o instanceof ot||Array.isArray(o)?ot.convert(o):ot.convert(o[i]||[0,0])}class mL{constructor(i){this.jumpTo(i)}getValue(i){if(i<=this._startTime)return this._start;if(i>=this._endTime)return this._end;const s=ed((i-this._startTime)/(this._endTime-this._startTime));return this._start*(1-s)+this._end*s}isEasing(i){return i>=this._startTime&&i<=this._endTime}jumpTo(i){this._startTime=-1/0,this._endTime=-1/0,this._start=i,this._end=i}easeTo(i,s,l){this._start=this.getValue(s),this._end=i,this._startTime=s,this._endTime=s+l}}const pL={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},fL={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},cA={showCompass:!0,showZoom:!0,visualizePitch:!1};class cC{constructor(i,s,l=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new tL({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,l&&(this.mousePitch=new eL({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),qr(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),s.addEventListener("mousedown",this.mousedown),s.addEventListener("touchstart",this.touchstart,{passive:!1}),s.addEventListener("touchmove",this.touchmove),s.addEventListener("touchend",this.touchend),s.addEventListener("touchcancel",this.reset)}down(i,s){this.mouseRotate.mousedown(i,s),this.mousePitch&&this.mousePitch.mousedown(i,s),io()}move(i,s){const l=this.map,d=this.mouseRotate.mousemoveWindow(i,s),u=d&&d.bearingDelta;if(u&&l.setBearing(l.getBearing()+u),this.mousePitch){const m=this.mousePitch.mousemoveWindow(i,s),p=m&&m.pitchDelta;p&&l.setPitch(l.getPitch()+p)}}off(){const i=this.element;i.removeEventListener("mousedown",this.mousedown),i.removeEventListener("touchstart",this.touchstart,{passive:!1}),i.removeEventListener("touchmove",this.touchmove),i.removeEventListener("touchend",this.touchend),i.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){L_(),lt.removeEventListener("mousemove",this.mousemove),lt.removeEventListener("mouseup",this.mouseup)}mousedown(i){this.down(se({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),Mi(this.element,i)),lt.addEventListener("mousemove",this.mousemove),lt.addEventListener("mouseup",this.mouseup)}mousemove(i){this.move(i,Mi(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){1!==i.targetTouches.length?this.reset():(this._startPos=this._lastPos=Hh(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){1!==i.targetTouches.length?this.reset():(this._lastPos=Hh(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){0===i.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const gL={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},_L={maxWidth:100,unit:"metric"},dA={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Yg={version:Va,supported:sD,setRTLTextPlugin:function(o,i,s=!1){if(Ir===Nn||Ir===mo||Ir===ub)throw new Error("setRTLTextPlugin cannot be called multiple times.");zl=Ze.resolveURL(o),Ir=Nn,gu=i,W0(),s||$o()},getRTLTextPluginStatus:mb,Map:class extends dL{constructor(o){m0.mark(Jp.create);const i=o;if(null!=(o=se({},fL,o)).minZoom&&null!=o.maxZoom&&o.minZoom>o.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=o.minPitch&&null!=o.maxPitch&&o.minPitch>o.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=o.minPitch&&o.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=o.maxPitch&&o.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(o.antialias&&function(s){const l=s.navigator?s.navigator.userAgent:null;return!!function(d){if(null==Ge){const u=d.navigator?d.navigator.userAgent:null;Ge=!!d.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Ge}(s)&&l&&(l.match("Version/15.4")||l.match("Version/15.5")||l.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))}(lt)&&(o.antialias=!1,rt("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ty(o.minZoom,o.maxZoom,o.minPitch,o.maxPitch,o.renderWorldCopies),o),this._interactive=o.interactive,this._minTileCacheSize=o.minTileCacheSize,this._maxTileCacheSize=o.maxTileCacheSize,this._failIfMajorPerformanceCaveat=o.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=o.preserveDrawingBuffer,this._antialias=o.antialias,this._trackResize=o.trackResize,this._bearingSnap=o.bearingSnap,this._refreshExpiredTiles=o.refreshExpiredTiles,this._fadeDuration=o.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=o.crossSourceCollisions,this._collectResourceTiming=o.collectResourceTiming,this._language=this._parseLanguage(o.language),this._worldview=o.worldview,this._renderTaskQueue=new sA,this._domRenderTaskQueue=new sA,this._controls=[],this._markers=[],this._popups=[],this._mapId=jn(),this._locale=se({},pL,o.locale),this._clickTolerance=o.clickTolerance,this._cooperativeGestures=o.cooperativeGestures,this._performanceMetricsCollection=o.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new mL(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new Ae(o.transformRequest,o.accessToken,o.testMode),this._silenceAuthErrors=!!o.testMode,this._contextCreateOptions=o.contextCreateOptions?{...o.contextCreateOptions}:{},"string"==typeof o.container){if(this._container=lt.document.getElementById(o.container),!this._container)throw new Error(`Container '${o.container.toString()}' not found.`)}else{if(!(o.container instanceof lt.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=o.container}if(this._container.childNodes.length>0&&rt("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),o.maxBounds&&this.setMaxBounds(o.maxBounds),qr(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==lt&&(this._fullscreenchangeEvent="onfullscreenchange"in lt.document?"fullscreenchange":"webkitfullscreenchange",lt.addEventListener("online",this._onWindowOnline,!1),lt.addEventListener("resize",this._onWindowResize,!1),lt.addEventListener("orientationchange",this._onWindowResize,!1),lt.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),lt.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new cL(this,o),this._localFontFamily=o.localFontFamily,this._localIdeographFontFamily=o.localIdeographFontFamily,(o.style||!o.testMode)&&this.setStyle(o.style||mi.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),o.projection&&this.setProjection(o.projection),o.hash&&(this._hash=new KF("string"==typeof o.hash&&o.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){null==i.center&&null==i.zoom||(this.transform._unmodified=!1),this.jumpTo({center:o.center,zoom:o.zoom,bearing:o.bearing,pitch:o.pitch});const s=o.bounds;s&&(this.resize(),this.fitBounds(s,se({},o.fitBoundsOptions,{duration:0})))}this.resize(),o.attributionControl&&this.addControl(new ov({customAttribution:o.customAttribution})),this._logoControl=new oA,this.addControl(this._logoControl,o.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update("style"===s.dataType),this.fire(new Bt(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new Bt(`${s.dataType}dataloading`,s))})}_getMapId(){return this._mapId}addControl(o,i){if(void 0===i&&(i=o.getDefaultPosition?o.getDefaultPosition():"top-right"),!o||!o.onAdd)return this.fire(new Yt(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=o.onAdd(this);this._controls.push(o);const l=this._controlPositions[i];return-1!==i.indexOf("bottom")?l.insertBefore(s,l.firstChild):l.appendChild(s),this}removeControl(o){if(!o||!o.onRemove)return this.fire(new Yt(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(o);return i>-1&&this._controls.splice(i,1),o.onRemove(this),this}hasControl(o){return this._controls.indexOf(o)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(o){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new Bt("movestart",o)).fire(new Bt("move",o)),this.fire(new Bt("resize",o)),i&&this.fire(new Bt("moveend",o)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(o){return this.transform.setMaxBounds(go.convert(o)),this._update()}setMinZoom(o){if((o=o??-2)>=-2&&o<=this.transform.maxZoom)return this.transform.minZoom=o,this._update(),this.getZoom()<o?this.setZoom(o):this.fire(new Bt("zoomstart")).fire(new Bt("zoom")).fire(new Bt("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(o){if((o=o??22)>=this.transform.minZoom)return this.transform.maxZoom=o,this._update(),this.getZoom()>o?this.setZoom(o):this.fire(new Bt("zoomstart")).fire(new Bt("zoom")).fire(new Bt("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(o){if((o=o??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(o>=0&&o<=this.transform.maxPitch)return this.transform.minPitch=o,this._update(),this.getPitch()<o?this.setPitch(o):this.fire(new Bt("pitchstart")).fire(new Bt("pitch")).fire(new Bt("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(o){if((o=o??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(o>=this.transform.minPitch)return this.transform.maxPitch=o,this._update(),this.getPitch()>o?this.setPitch(o):this.fire(new Bt("pitchstart")).fire(new Bt("pitch")).fire(new Bt("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(o){return this.transform.renderWorldCopies=o,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(o){return"auto"===o?lt.navigator.language:Array.isArray(o)?0===o.length?void 0:o.map(i=>"auto"===i?lt.navigator.language:i):o}setLanguage(o){const i=this._parseLanguage(o);if(!this.style||i===this._language)return this;this._language=i,this.style.reloadSources();for(const s of this._controls)s._setLanguage&&s._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(o){return this.style&&o!==this._worldview?(this._worldview=o,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(o){return this._lazyInitEmptyStyle(),o?"string"==typeof o&&(o={name:o}):o=null,this._useExplicitProjection=!!o,this._prioritizeAndUpdateProjection(o,this.style.projection)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const o=this.transform,i=o.projection.name;let s;"globe"===i&&o.zoom>=Md?(o.setMercatorFromTransition(),s=!0):"mercator"===i&&o.zoom<Md&&(o.setProjection({name:"globe"}),s=!0),s&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(o,i){return this._updateProjection(o||i||{name:"mercator"})}_updateProjection(o){let i;return i="globe"===o.name&&this.transform.zoom>=Md?this.transform.setMercatorFromTransition():this.transform.setProjection(o),this.style.applyProjectionUpdate(),i&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(o){return this.transform.locationPoint3D(qe.convert(o))}unproject(o){return this.transform.pointLocation3D(ot.convert(o))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(o,i,s){if("mouseenter"===o||"mouseover"===o){let l=!1;const d=m=>{const p=i.filter(_=>this.getLayer(_)),g=p.length?this.queryRenderedFeatures(m.point,{layers:p}):[];g.length?l||(l=!0,s.call(this,new Hs(o,this,m.originalEvent,{features:g}))):l=!1},u=()=>{l=!1};return{layers:new Set(i),listener:s,delegates:{mousemove:d,mouseout:u}}}if("mouseleave"===o||"mouseout"===o){let l=!1;const d=m=>{const p=i.filter(g=>this.getLayer(g));(p.length?this.queryRenderedFeatures(m.point,{layers:p}):[]).length?l=!0:l&&(l=!1,s.call(this,new Hs(o,this,m.originalEvent)))},u=m=>{l&&(l=!1,s.call(this,new Hs(o,this,m.originalEvent)))};return{layers:new Set(i),listener:s,delegates:{mousemove:d,mouseout:u}}}{const l=d=>{const u=i.filter(p=>this.getLayer(p)),m=u.length?this.queryRenderedFeatures(d.point,{layers:u}):[];m.length&&(d.features=m,s.call(this,d),delete d.features)};return{layers:new Set(i),listener:s,delegates:{[o]:l}}}}on(o,i,s){if(void 0===s)return super.on(o,i);if(Array.isArray(i)||(i=[i]),i)for(const d of i)if(!this._isValidId(d))return this;const l=this._createDelegatedListener(o,i,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[o]=this._delegatedListeners[o]||[],this._delegatedListeners[o].push(l);for(const d in l.delegates)this.on(d,l.delegates[d]);return this}once(o,i,s){if(void 0===s)return super.once(o,i);if(Array.isArray(i)||(i=[i]),i)for(const d of i)if(!this._isValidId(d))return this;const l=this._createDelegatedListener(o,i,s);for(const d in l.delegates)this.once(d,l.delegates[d]);return this}off(o,i,s){if(void 0===s)return super.off(o,i);i=new Set(Array.isArray(i)?i:[i]);for(const u of i)if(!this._isValidId(u))return this;const l=(u,m)=>{if(u.size!==m.size)return!1;for(const p of u)if(!m.has(p))return!1;return!0},d=this._delegatedListeners?this._delegatedListeners[o]:void 0;return d&&(u=>{for(let m=0;m<u.length;m++){const p=u[m];if(p.listener===s&&l(p.layers,i)){for(const g in p.delegates)this.off(g,p.delegates[g]);return u.splice(m,1),this}}})(d),this}queryRenderedFeatures(o,i){if(!this.style)return[];if(void 0!==i||void 0===o||o instanceof ot||Array.isArray(o)||(i=o,o=void 0),o=o||[[0,0],[this.transform.width,this.transform.height]],(i=i||{}).layers&&Array.isArray(i.layers))for(const s of i.layers)if(!this._isValidId(s))return[];return this.style.queryRenderedFeatures(o,i,this.transform)}querySourceFeatures(o,i){return this._isValidId(o)?this.style.querySourceFeatures(o,i):[]}isPointOnSurface(o){const{name:i}=this.transform.projection;return"globe"!==i&&"mercator"!==i&&rt(`${i} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(ot.convert(o))}setStyle(o,i){return!1!==(i=se({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&o?(this._diffStyle(o,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(o,i))}_getUIString(o){const i=this._locale[o];if(null==i)throw new Error(`Missing UI string '${o}'`);return i}_updateStyle(o,i){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),o&&(this.style=new fl(this,i||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof o?this.style.loadURL(o):this.style.loadJSON(o)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new fl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(o,i){if("string"==typeof o){const s=this._requestManager.normalizeStyleURL(o),l=this._requestManager.transformRequest(s,xt.Style);jt(l,(d,u)=>{d?this.fire(new Yt(d)):u&&this._updateDiff(u,i)})}else"object"==typeof o&&this._updateDiff(o,i)}_updateDiff(o,i){try{this.style.setState(o)&&this._update(!0)}catch(s){rt(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(o,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(rt("There is no style added to the map."),!1)}_isValidId(o){return null==o?(this.fire(new Yt(new Error("IDs can't be empty."))),!1):!Y0(o)||(this.fire(new Yt(new Error(`IDs can't contain special symbols: "${o}".`))),!1)}addSource(o,i){return this._isValidId(o)?(this._lazyInitEmptyStyle(),this.style.addSource(o,i),this._update(!0)):this}isSourceLoaded(o){return!!this._isValidId(o)&&!!this.style&&this.style._isSourceCacheLoaded(o)}areTilesLoaded(){const o=this.style&&this.style._sourceCaches;for(const i in o){const s=o[i]._tiles;for(const l in s){const d=s[l];if("loaded"!==d.state&&"errored"!==d.state)return!1}}return!0}addSourceType(o,i,s){this._lazyInitEmptyStyle(),this.style.addSourceType(o,i,s)}removeSource(o){return this._isValidId(o)?(this.style.removeSource(o),this._updateTerrain(),this._update(!0)):this}getSource(o){return this._isValidId(o)?this.style.getOwnSource(o):null}addImage(o,i,{pixelRatio:s=1,sdf:l=!1,stretchX:d,stretchY:u,content:m}={}){if(this._lazyInitEmptyStyle(),i instanceof lt.HTMLImageElement||lt.ImageBitmap&&i instanceof lt.ImageBitmap){const{width:p,height:g,data:_}=Ze.getImageData(i);this.style.addImage(o,{data:new _r({width:p,height:g},_),pixelRatio:s,stretchX:d,stretchY:u,content:m,sdf:l,version:0})}else if(void 0===i.width||void 0===i.height)this.fire(new Yt(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:p,height:g}=i,_=i;this.style.addImage(o,{data:new _r({width:p,height:g},new Uint8Array(_.data)),pixelRatio:s,stretchX:d,stretchY:u,content:m,sdf:l,version:0,userImage:_}),_.onAdd&&_.onAdd(this,o)}}updateImage(o,i){this._lazyInitEmptyStyle();const s=this.style.getImage(o);if(!s)return void this.fire(new Yt(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=i instanceof lt.HTMLImageElement||lt.ImageBitmap&&i instanceof lt.ImageBitmap?Ze.getImageData(i):i,{width:d,height:u}=l;void 0!==d&&void 0!==u?d===s.data.width&&u===s.data.height?(s.data.replace(l.data,!(i instanceof lt.HTMLImageElement||lt.ImageBitmap&&i instanceof lt.ImageBitmap)),this.style.updateImage(o,s)):this.fire(new Yt(new Error(`The width and height of the updated image (${d}, ${u})\n                must be that same as the previous version of the image\n                (${s.data.width}, ${s.data.height})`))):this.fire(new Yt(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(o){return o?!!this.style&&!!this.style.getImage(o):(this.fire(new Yt(new Error("Missing required image id"))),!1)}removeImage(o){this.style.removeImage(o)}loadImage(o,i){ai(this._requestManager.transformRequest(o,xt.Image),(s,l)=>{i(s,l instanceof lt.HTMLImageElement?Ze.getImageData(l):l)})}listImages(){return this.style.listImages()}addModel(o,i){this._lazyInitEmptyStyle(),this.style.addModel(o,i)}hasModel(o){return o?this.style.hasModel(o):(this.fire(new Yt(new Error("Missing required model id"))),!1)}removeModel(o){this.style.removeModel(o)}listModels(){return this.style.listModels()}addLayer(o,i){return this._isValidId(o.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(o,i),this._update(!0)):this}moveLayer(o,i){return this._isValidId(o)?(this.style.moveLayer(o,i),this._update(!0)):this}removeLayer(o){return this._isValidId(o)?(this.style.removeLayer(o),this._update(!0)):this}getLayer(o){return this._isValidId(o)?this.style.getOwnLayer(o):null}setLayerZoomRange(o,i,s){return this._isValidId(o)?(this.style.setLayerZoomRange(o,i,s),this._update(!0)):this}setFilter(o,i,s={}){return this._isValidId(o)?(this.style.setFilter(o,i,s),this._update(!0)):this}getFilter(o){return this._isValidId(o)?this.style.getFilter(o):null}setPaintProperty(o,i,s,l={}){return this._isValidId(o)?(this.style.setPaintProperty(o,i,s,l),this._update(!0)):this}getPaintProperty(o,i){return this._isValidId(o)?this.style.getPaintProperty(o,i):null}setLayoutProperty(o,i,s,l={}){return this._isValidId(o)?(this.style.setLayoutProperty(o,i,s,l),this._update(!0)):this}getLayoutProperty(o,i){return this._isValidId(o)?this.style.getLayoutProperty(o,i):null}getConfigProperty(o,i){return this.style.getConfigProperty(o,i)}setConfigProperty(o,i,s){return this.style.setConfigProperty(o,i,s),this._update(!0)}setLights(o){if(this._lazyInitEmptyStyle(),o&&1===o.length&&"flat"===o[0].type){const i=o[0];i.properties?this.style.setFlatLight(i.properties,i.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(o),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const o=this.style.getLights()||[];return 0===o.length&&o.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),o}setLight(o,i={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:o}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(o){return this._lazyInitEmptyStyle(),!o&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(o),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(o){return this._lazyInitEmptyStyle(),this.style.setFog(o),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(o){return this.style.setCamera(o),this._triggerCameraUpdate(o)}_triggerCameraUpdate(o){return this._update(this.transform.setOrthographicProjectionAtLowPitch("orthographic"===o["camera-projection"]))}getCamera(){return this.style.camera}_queryFogOpacity(o){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(qe.convert(o),this.transform):0}setFeatureState(o,i){return this._isValidId(o.source)?(this.style.setFeatureState(o,i),this._update()):this}removeFeatureState(o,i){return this._isValidId(o.source)?(this.style.removeFeatureState(o,i),this._update()):this}getFeatureState(o){return this._isValidId(o.source)?this.style.getFeatureState(o):null}_updateContainerDimensions(){if(!this._container)return;const o=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let s,l,d,u=this._container;for(;u&&(!l||!d);){const m=lt.getComputedStyle(u).transform;m&&"none"!==m&&(s=m.match(/matrix.*\((.+)\)/)[1].split(", "),s[0]&&"0"!==s[0]&&"1"!==s[0]&&(l=s[0]),s[3]&&"0"!==s[3]&&"1"!==s[3]&&(d=s[3])),u=u.parentElement}this._containerWidth=l?Math.abs(o/l):o,this._containerHeight=d?Math.abs(i/d):i}_detectMissingCSS(){"rgb(250, 128, 114)"!==lt.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&rt("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const o=this._container;o.classList.add("mapboxgl-map"),(this._missingCSSCanary=Ci("div","mapboxgl-canary",o)).style.visibility="hidden",this._detectMissingCSS();const i=this._canvasContainer=Ci("div","mapboxgl-canvas-container",o);this._canvas=Ci("canvas","mapboxgl-canvas",i),this._interactive&&(i.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const s=this._controlContainer=Ci("div","mapboxgl-control-container",o),l=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(d=>{l[d]=Ci("div",`mapboxgl-ctrl-${d}`,s)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(o,i){const s=Ze.devicePixelRatio||1;this._canvas.width=s*Math.ceil(o),this._canvas.height=s*Math.ceil(i),this._canvas.style.width=`${o}px`,this._canvas.style.height=`${i}px`}_addMarker(o){this._markers.push(o)}_removeMarker(o){const i=this._markers.indexOf(o);-1!==i&&this._markers.splice(i,1)}_addPopup(o){this._popups.push(o)}_removePopup(o){const i=this._popups.indexOf(o);-1!==i&&this._popups.splice(i,1)}_setupPainter(){const o=se({},sD.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl2",o);i?(rD(i,!0),this.painter=new WF(i,this._contextCreateOptions,this.transform),this.on("data",s=>{"source"===s.dataType&&this.painter.setTileLoadedFlag(!0)}),Js.testSupport(i)):this.fire(new Yt(new Error("Failed to initialize WebGL")))}_contextLost(o){o.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new Bt("webglcontextlost",{originalEvent:o}))}_contextRestored(o){this._setupPainter(),this.resize(),this._update(),this.fire(new Bt("webglcontextrestored",{originalEvent:o}))}_onMapScroll(o){if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(o){return this.style?(this._styleDirty=this._styleDirty||o,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(o){return this._update(),this._renderTaskQueue.add(o)}_cancelRenderFrame(o){this._renderTaskQueue.remove(o)}_requestDomTask(o){!this.loaded()||this.loaded()&&!this.isMoving()?o():this._domRenderTaskQueue.add(o)}_render(o){let i;this.fire(new Bt("renderstart"));const s=this.painter.context.extTimerQuery,l=Ze.now(),d=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(i=d.createQuery(),d.beginQuery(s.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],lt.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],lt.performance.now())),this._renderTaskQueue.run(o),this._domRenderTaskQueue.run(o),this._removed)return;this._updateProjectionTransition();const u=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const g=this.transform.zoom,_=this.transform.pitch,y=Ze.now(),v=new zn(g,{now:y,fadeDuration:u,pitch:_,transition:this.style.transition});this.style.update(v)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let m=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),m=this._updateAverageElevation(l),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):m=this._updateAverageElevation(l),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,u,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:u,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new Bt("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new Bt("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),i){const g=Ze.now()-l;d.endQuery(s.TIME_ELAPSED_EXT),setTimeout(()=>{const _=d.getQueryParameter(i,d.QUERY_RESULT)/1e6;d.deleteQuery(i),this.fire(new Bt("gpu-timing-frame",{cpuTime:g,gpuTime:_})),lt.performance.mark("frame-gpu",{startTime:l,detail:{gpuTime:_}})},50)}if(this.listens("gpu-timing-layer")){const g=this.painter.collectGpuTimers();setTimeout(()=>{const _=this.painter.queryGpuTimers(g);this.fire(new Bt("gpu-timing-layer",{layerTimes:_}))},50)}if(this.listens("gpu-timing-deferred-render")){const g=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const _=this.painter.queryGpuTimeDeferredRender(g);this.fire(new Bt("gpu-timing-deferred-render",{gpuTime:_}))},50)}const p=this._sourcesDirty||this._styleDirty||this._placementDirty||m;if(p||this._repaint)this.triggerRepaint();else{const g=!this.isMoving()&&this.loaded();if(g&&(m=this._updateAverageElevation(l,!0)),m)this.triggerRepaint();else if(this._triggerFrame(!1),g&&(this.fire(new Bt("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const _=this._calculateSpeedIndex();this.fire(new Bt("speedindexcompleted",{speedIndex:_})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,m0.mark(Jp.fullLoad),this._performanceMetricsCollection&&iD(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(o){for(const i of this._markers)o&&!this.getRenderWorldCopies()&&(i._lngLat=i._lngLat.wrap()),i._update();for(const i of this._popups)!o||this.getRenderWorldCopies()||i._trackPointer||(i._lngLat=i._lngLat.wrap()),i._update()}_updateAverageElevation(o,i=!1){const s=d=>(this.transform.averageElevation=d,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&s(0);const l=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(l||(i||o-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(o)){const d=this.transform.averageElevation;let u=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(u)?u=0:this._averageElevationLastSampledAt=o;const m=Math.abs(d-u);if(m>1){if(this._isInitialLoad||l)return this._averageElevation.jumpTo(u),s(u);this._averageElevation.easeTo(u,o,300)}else if(m>1e-4)return this._averageElevation.jumpTo(u),s(u)}return!!this._averageElevation.isEasing(o)&&s(this._averageElevation.getValue(o))}_authenticate(){nD(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,o=>{if(o&&(o.message===un||401===o.status)){const i=this.painter.context.gl;rD(i,!1),this._logoControl instanceof oA&&this._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new Yt(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),P3(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const o=this._isDragging();this.painter.updateTerrain(this.style,o)}_calculateSpeedIndex(){const o=this.painter.canvasCopy(),i=this.painter.getCanvasCopiesAndTimestamps();i.timeStamps.push(performance.now());const s=this.painter.context.gl,l=s.createFramebuffer();function d(u){s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,u,0);const m=new Uint8Array(s.drawingBufferWidth*s.drawingBufferHeight*4);return s.readPixels(0,0,s.drawingBufferWidth,s.drawingBufferHeight,s.RGBA,s.UNSIGNED_BYTE,m),m}return s.bindFramebuffer(s.FRAMEBUFFER,l),this._canvasPixelComparison(d(o),i.canvasCopies.map(d),i.timeStamps)}_canvasPixelComparison(o,i,s){let l=s[1]-s[0];const d=o.length/4;for(let u=0;u<i.length;u++){const m=i[u];let p=0;for(let g=0;g<m.length;g+=4)m[g]===o[g]&&m[g+1]===o[g+1]&&m[g+2]===o[g+2]&&m[g+3]===o[g+3]&&(p+=1);l+=(s[u+2]-s[u+1])*(1-p/d)}return l}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==lt&&(lt.removeEventListener("resize",this._onWindowResize,!1),lt.removeEventListener("orientationchange",this._onWindowResize,!1),lt.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),lt.removeEventListener("online",this._onWindowOnline,!1),lt.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o&&o.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),ad.delete(this.painter.context.gl),this._removed=!0,this.fire(new Bt("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(o){this._renderNextFrame=this._renderNextFrame||o,this.style&&!this._frame&&(this._frame=Ze.frame(i=>{const s=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,s&&this._render(i)}))}_preloadTiles(o){return tu(this.style?Object.values(this.style._sourceCaches):[],(i,s)=>i._preloadTiles(o,s),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(o){this._trackResize&&this.resize({originalEvent:o})._update()}_onVisibilityChange(){"hidden"===lt.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(o){this._showTileBoundaries!==o&&(this._showTileBoundaries=o,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(o){this._showTerrainWireframe!==o&&(this._showTerrainWireframe=o,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(o){this._showLayers2DWireframe!==o&&(this._showLayers2DWireframe=o,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(o){this._showLayers3DWireframe!==o&&(this._showLayers3DWireframe=o,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(o){this._speedIndexTiming!==o&&(this._speedIndexTiming=o,this._update())}get showPadding(){return!!this._showPadding}set showPadding(o){this._showPadding!==o&&(this._showPadding=o,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(o){this._showCollisionBoxes!==o&&(this._showCollisionBoxes=o,o?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(o){this._showOverdrawInspector!==o&&(this._showOverdrawInspector=o,this._update())}get repaint(){return!!this._repaint}set repaint(o){this._repaint!==o&&(this._repaint=o,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(o){this._vertices=o,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(o){this._showTileAABBs!==o&&(this._showTileAABBs=o,o&&this._update())}_setCacheLimits(o,i){Fo=o,Ho=i}get version(){return Va}},NavigationControl:class{constructor(o){this.options=se({},cA,o),this._container=Ci("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(qr(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",i=>{this._map&&this._map.zoomIn({},{originalEvent:i})}),Ci("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",i=>{this._map&&this._map.zoomOut({},{originalEvent:i})}),Ci("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(qr(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",i=>{const s=this._map;s&&(this.options.visualizePitch?s.resetNorthPitch({},{originalEvent:i}):s.resetNorth({},{originalEvent:i}))}),this._compassIcon=Ci("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const o=this._map;if(!o)return;const i=o.getZoom(),s=i===o.getMaxZoom(),l=i===o.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())}_rotateCompassArrow(){const o=this._map;if(!o)return;const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(o.transform.pitch*(Math.PI/180)),.5)}) rotateX(${o.transform.pitch}deg) rotateZ(${o.transform.angle*(180/Math.PI)}deg)`:`rotate(${o.transform.angle*(180/Math.PI)}deg)`;o._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=i)})}onAdd(o){return this._map=o,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),o.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&o.on("pitch",this._rotateCompassArrow),o.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new cC(o,this._compass,this.options.visualizePitch)),this._container}onRemove(){const o=this._map;o&&(this._container.remove(),this.options.showZoom&&o.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&o.off("pitch",this._rotateCompassArrow),o.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(o,i){const s=Ci("button",o,this._container);return s.type="button",s.addEventListener("click",i),s}_setButtonTitle(o,i){if(!this._map)return;const s=this._map._getUIString(`NavigationControl.${i}`);o.setAttribute("aria-label",s),o.firstElementChild&&o.firstElementChild.setAttribute("title",s)}},GeolocateControl:class extends gi{constructor(o){super(),this.options=se({geolocation:lt.navigator.geolocation},gL,o),qr(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=XF(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(o){return this._map=o,this._container=Ci("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(o){const i=(s=!!this.options.geolocation)=>{this._supportsGeolocation=s,o(s)};void 0!==this._supportsGeolocation?o(this._supportsGeolocation):void 0!==lt.navigator.permissions?lt.navigator.permissions.query({name:"geolocation"}).then(s=>i("denied"!==s.state)).catch(()=>i()):i()}_isOutOfMapMaxBounds(o){const i=this._map.getMaxBounds(),s=o.coords;return!!i&&(s.longitude<i.getWest()||s.longitude>i.getEast()||s.latitude<i.getSouth()||s.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new Bt("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(o),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(o),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new Bt("geolocate",o)),this._finish()}}_updateCamera(o){const i=new qe(o.coords.longitude,o.coords.latitude),s=o.coords.accuracy,l=se({bearing:this._map.getBearing()},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(s),l,{geolocateSource:!0})}_updateMarker(o){if(o){const i=new qe(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const o=this._map.transform,i=sn(1,o._center.lat)*o.worldSize,s=Math.ceil(2*this._accuracy*i);this._circleElement.style.width=`${s}px`,this._circleElement.style.height=`${s}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(o){if(this._map){if(this.options.trackUserLocation)if(1===o.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===o.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new Bt("error",o)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(o){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=Ci("button","mapboxgl-ctrl-geolocate",this._container),Ci("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===o){rt("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ci("div","mapboxgl-user-location"),this._dotElement.appendChild(Ci("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Ci("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new lC({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Ci("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new lC({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||"ACTIVE_LOCK"!==this._watchState||i.originalEvent&&"resize"===i.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new Bt("trackuserlocationend")))})}}_onDeviceOrientation(o){this._userLocationDotMarker&&(o.webkitCompassHeading?this._heading=o.webkitCompassHeading:!0===o.absolute&&(this._heading=-1*o.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return rt("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new Bt("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new Bt("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new Bt("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(o={maximumAge:6e5,timeout:0},this._noTimeout=!0):(o=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,o),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const o=()=>{lt.addEventListener("ondeviceorientationabsolute"in lt?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==lt.DeviceMotionEvent&&"function"==typeof lt.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(i=>{"granted"===i&&o()}).catch(console.error):o()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),lt.removeEventListener("deviceorientation",this._onDeviceOrientation),lt.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ov,ScaleControl:class{constructor(o){this.options=se({},_L,o),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),qr(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const o=this.options.maxWidth||100,i=this._map,s=i._containerHeight/2,l=i._containerWidth/2-o/2,d=i.unproject([l,s]),u=i.unproject([l+o,s]),m=d.distanceTo(u);if("imperial"===this.options.unit){const p=3.2808*m;p>5280?this._setScale(o,p/5280,"mile"):this._setScale(o,p,"foot")}else"nautical"===this.options.unit?this._setScale(o,m/1852,"nautical-mile"):m>=1e3?this._setScale(o,m/1e3,"kilometer"):this._setScale(o,m,"meter")}_setScale(o,i,s){this._map._requestDomTask(()=>{const l=function(u){const m=Math.pow(10,`${Math.floor(u)}`.length-1);let p=u/m;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:p>=1?1:function(g){const _=Math.pow(10,Math.ceil(-Math.log(g)/Math.LN10));return Math.round(g*_)/_}(p),m*p}(i),d=l/i;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==s?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:s}).format(l):`${l}&nbsp;${dA[s]}`,this._container.style.width=o*d+"px"})}onAdd(o){return this._map=o,this._language=o.getLanguage(),this._container=Ci("div","mapboxgl-ctrl mapboxgl-ctrl-scale",o.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(o){this._language=o,this._update()}setUnit(o){this.options.unit=o,this._update()}},FullscreenControl:class{constructor(o){this._fullscreen=!1,o&&o.container&&(o.container instanceof lt.HTMLElement?this._container=o.container:rt("Full screen control 'container' must be a DOM element.")),qr(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in lt.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in lt.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(o){return this._map=o,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ci("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",rt("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,lt.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!lt.document.fullscreenEnabled&&!lt.document.webkitFullscreenEnabled)}_setupUI(){const o=this._fullscreenButton=Ci("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Ci("span","mapboxgl-ctrl-icon",o).setAttribute("aria-hidden","true"),o.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),lt.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const o=this._getTitle();this._fullscreenButton.setAttribute("aria-label",o),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",o)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(lt.document.fullscreenElement||lt.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?lt.document.exitFullscreen?lt.document.exitFullscreen():lt.document.webkitCancelFullScreen&&lt.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends gi{constructor(o){super(),this.options=se(Object.create(uL),o),qr(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(o&&o.className?o.className.trim().split(/\s+/):[])}addTo(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&o.on("preclick",this._onClose),this.options.closeOnMove&&o.on("move",this._onClose),o.on("remove",this.remove),this._update(),o._addPopup(this),this._focusFirstElement(),this._trackPointer?(o.on("mousemove",this._onMouseEvent),o.on("mouseup",this._onMouseEvent),o._canvasContainer.classList.add("mapboxgl-track-pointer")):o.on("move",this._update),this.fire(new Bt("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const o=this._map;return o&&(o.off("move",this._update),o.off("move",this._onClose),o.off("preclick",this._onClose),o.off("click",this._onClose),o.off("remove",this.remove),o.off("mousemove",this._onMouseEvent),o.off("mouseup",this._onMouseEvent),o.off("drag",this._onMouseEvent),o._canvasContainer&&o._canvasContainer.classList.remove("mapboxgl-track-pointer"),o._removePopup(this),this._map=void 0),this.fire(new Bt("close")),this}getLngLat(){return this._lngLat}setLngLat(o){this._lngLat=qe.convert(o),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const o=this._map;return o&&(o.off("move",this._update),o.on("mousemove",this._onMouseEvent),o.on("drag",this._onMouseEvent),o._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(o){return this.setDOMContent(lt.document.createTextNode(o))}setHTML(o){const i=lt.document.createDocumentFragment(),s=lt.document.createElement("body");let l;for(s.innerHTML=o;l=s.firstChild,l;)i.appendChild(l);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(o){return this.options.maxWidth=o,this._update(),this}setDOMContent(o){let i=this._content;if(i)for(;i.hasChildNodes();)i.firstChild&&i.removeChild(i.firstChild);else i=this._content=Ci("div","mapboxgl-popup-content",this._container||void 0);if(i.appendChild(o),this.options.closeButton){const s=this._closeButton=Ci("button","mapboxgl-popup-close-button",i);s.type="button",s.setAttribute("aria-label","Close popup"),s.setAttribute("aria-hidden","true"),s.innerHTML="&#215;",s.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(o){return this._classList.add(o),this._updateClassList(),this}removeClassName(o){return this._classList.delete(o),this._updateClassList(),this}setOffset(o){return this.options.offset=o,this._update(),this}toggleClassName(o){let i;return this._classList.delete(o)?i=!1:(this._classList.add(o),i=!0),this._updateClassList(),i}_onMouseEvent(o){this._update(o.point)}_getAnchor(o){if(this.options.anchor)return this.options.anchor;const i=this._map,s=this._container,l=this._pos;if(!i||!s||!l)return"bottom";const d=s.offsetWidth,u=s.offsetHeight,m=l.x<d/2,p=l.x>i.transform.width-d/2;if(l.y+o<u)return m?"top-left":p?"top-right":"top";if(l.y>i.transform.height-u){if(m)return"bottom-left";if(p)return"bottom-right"}return m?"left":p?"right":"bottom"}_updateClassList(){const o=this._container;if(!o)return;const i=[...this._classList];i.push("mapboxgl-popup"),this._anchor&&i.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&i.push("mapboxgl-popup-track-pointer"),o.className=i.join(" ")}_update(o){const i=this._map,s=this._content;if(!i||!this._lngLat&&!this._trackPointer||!s)return;let l=this._container;if(l||(l=this._container=Ci("div","mapboxgl-popup",i.getContainer()),this._tip=Ci("div","mapboxgl-popup-tip",l),l.appendChild(s)),this.options.maxWidth&&l.style.maxWidth!==this.options.maxWidth&&(l.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=aA(this._lngLat,this._pos,i.transform)),!this._trackPointer||o){const d=this._pos=this._trackPointer&&o?o:i.project(this._lngLat),u=lA(this.options.offset),m=this._anchor=this._getAnchor(u.y),p=lA(this.options.offset,m),g=d.add(p).round();i._requestDomTask(()=>{this._container&&m&&(this._container.style.transform=`${aC[m]} translate(${g.x}px,${g.y}px)`)})}if(!this._marker&&i._showingGlobe()){const d=Px(i.transform,this._lngLat)?0:1;this._setOpacity(d)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const o=this._container.querySelector(hL);o&&o.focus()}_onClose(){this.remove()}_setOpacity(o){this._container&&(this._container.style.opacity=`${o}`),this._content&&(this._content.style.pointerEvents=o?"auto":"none")}},Marker:lC,Style:fl,LngLat:qe,LngLatBounds:go,Point:ot,MercatorCoordinate:Ei,FreeCameraOptions:lT,Evented:gi,config:mi,prewarm:function(){Vc().acquire(l1)},clearPrewarmedResources:function(){const o=Lg;o&&(o.isPreloaded()&&1===o.numActive()?(o.release(l1),Lg=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return mi.ACCESS_TOKEN},set accessToken(o){mi.ACCESS_TOKEN=o},get baseApiUrl(){return mi.API_URL},set baseApiUrl(o){mi.API_URL=o},get workerCount(){return sp.workerCount},set workerCount(o){sp.workerCount=o},get maxParallelImageRequests(){return mi.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(o){mi.MAX_PARALLEL_IMAGE_REQUESTS=o},clearStorage(o){!function(i){if(!jh())return;const s=lt.caches.delete(An);i&&s.catch(i).then(()=>i())}(o)},workerUrl:"",workerClass:null,get dracoUrl(){return d1()},set dracoUrl(o){c1=Ze.resolveURL(o),ap||(ap=new Pg(Vc(),new gi)),ap.broadcast("setDracoUrl",c1)},setNow:Ze.setNow,restoreNow:Ze.restoreNow};ge.A=WO,ge.D=Od,ge.E=pt,ge.F=sy,ge.K=Uy,ge.O=Ri,ge.P=ot,ge.T=gT,ge.V=ow,ge.a=Yl,ge.b=aw,ge.c=Py,ge.d=class extends gi{constructor(o,i,s,l,d,u){super(),this.actor=o,this.layerIndex=i,this.availableImages=s,this.loadVectorData=d||s1,this.loading={},this.loaded={},this.deduped=new HT(o.scheduler),this.isSpriteLoaded=l,this.scheduler=o.scheduler,this.brightness=u}loadTile(o,i){const s=o.uid,l=o&&o.request,d=l&&l.collectResourceTiming,u=this.loading[s]=new UT(o);u.abort=this.loadVectorData(o,(m,p)=>{const g=!this.loading[s];if(delete this.loading[s],g||m||!p)return u.status="done",g||(this.loaded[s]=u),i(m);const _=p.rawData,y={};p.expires&&(y.expires=p.expires),p.cacheControl&&(y.cacheControl=p.cacheControl),u.vectorTile=p.vectorTile||new rw(new ry(_));const v=()=>{u.parse(u.vectorTile,this.layerIndex,this.availableImages,this.actor,(w,C)=>{if(w||!C)return i(w);const D={};if(d){const k=oD(l);k.length>0&&(D.resourceTiming=JSON.parse(JSON.stringify(k)))}i(null,se({rawTileData:_.slice(0)},C,y,D))})};this.isSpriteLoaded?v():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(v,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom}):v()}),this.loaded=this.loaded||{},this.loaded[s]=u})}reloadTile(o,i){const s=this.loaded,l=o.uid,d=this;if(s&&s[l]){const u=s[l];u.showCollisionBoxes=o.showCollisionBoxes,u.projection=o.projection,u.brightness=o.brightness,u.tileTransform=Hu(o.tileID.canonical,o.projection),u.extraShadowCaster=o.extraShadowCaster;const m=(p,g)=>{const _=u.reloadCallback;_&&(delete u.reloadCallback,u.parse(u.vectorTile,d.layerIndex,this.availableImages,d.actor,_)),i(p,g)};"parsing"===u.status?u.reloadCallback=m:"done"===u.status&&(u.vectorTile?u.parse(u.vectorTile,this.layerIndex,this.availableImages,this.actor,m):m())}else i(null,void 0)}abortTile(o,i){const s=o.uid,l=this.loading[s];l&&(l.abort&&l.abort(),delete this.loading[s]),i()}removeTile(o,i){const s=this.loaded,l=o.uid;s&&s[l]&&delete s[l],i()}},ge.e=yc,ge.f=oD,ge.g=Ds,ge.h=jt,ge.i=qt,ge.j=function(o,i){const s=rh(o);for(const l of s){for(const d of l.meshes)eF(d);l.lights&&(l.lightMeshIndex=l.meshes.length,l.meshes.push(iF(l.lights,i)))}return s},ge.k=zn,ge.l=function(o){let i=0;if(new Uint32Array(o,0,1)[0]!==m1){const s=new Uint32Array(o,0,7),[,,l,d,u,m]=s;i=s.byteLength+d+u+m+u,(l!==o.byteLength||i>=o.byteLength)&&rt("Invalid b3dm header information.")}return WT(o,i)},ge.m=_y,ge.n=ro,ge.o=Bt,ge.p=td,ge.q=function(o){ks(),ns&&ns.then(i=>{i.keys().then(s=>{for(let l=0;l<s.length-o;l++)i.delete(s[l])})})},ge.r=cp,ge.s=Yg,ge.t=tg,ge.v=we,ge.w=lt}),Kp(0,function(ge){function lt(Ut){if("number"==typeof Ut||"boolean"==typeof Ut||"string"==typeof Ut||null==Ut)return JSON.stringify(Ut);if(Array.isArray(Ut)){let K="[";for(const rt of Ut)K+=`${lt(rt)},`;return`${K}]`}let Y="{";for(const K of Object.keys(Ut).sort())Y+=`${K}:${lt(Ut[K])},`;return`${Y}}`}function Va(Ut){let Y="";for(const K of ge.r)Y+=`/${lt(Ut[K])}`;return Y}class Dl{constructor(Y){this.keyCache={},this._layers={},this._layerConfigs={},Y&&this.replace(Y)}replace(Y,K){this._layerConfigs={},this._layers={},this.update(Y,[],K)}update(Y,K,rt){this._options=rt;for(const Nt of Y){this._layerConfigs[Nt.id]=Nt;const ne=this._layers[Nt.id]=ge.c(Nt,this._options);ne.setScope(this.scope),ne.compileFilter(),this.keyCache[Nt.id]&&delete this.keyCache[Nt.id]}for(const Nt of K)delete this.keyCache[Nt],delete this._layerConfigs[Nt],delete this._layers[Nt];this.familiesBySource={};const Ot=function(Nt,ne){const ye={};for(let Ee=0;Ee<Nt.length;Ee++){const Ge=ne&&ne[Nt[Ee].id]||Va(Nt[Ee]);ne&&(ne[Nt[Ee].id]=Ge);let We=ye[Ge];We||(We=ye[Ge]=[]),We.push(Nt[Ee])}const Lt=[];for(const Ee in ye)Lt.push(ye[Ee]);return Lt}(ge.v(this._layerConfigs),this.keyCache);for(const Nt of Ot){const ne=Nt.map(wn=>this._layers[wn.id]),ye=ne[0];if("none"===ye.visibility)continue;const Lt=ye.source||"";let Ee=this.familiesBySource[Lt];Ee||(Ee=this.familiesBySource[Lt]={});const Ge=ye.sourceLayer||"_geojsonTileLayer";let We=Ee[Ge];We||(We=Ee[Ge]=[]),We.push(ne)}}}class mi{loadTile(Y,K){const{uid:rt,encoding:Ot,rawImageData:Nt,padding:ne}=Y,ye=ge.w.ImageBitmap&&Nt instanceof ge.w.ImageBitmap?this.getImageData(Nt,ne):Nt;K(null,new ge.D(rt,ye,Ot,ne<1))}getImageData(Y,K){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);const rt=this.offscreenCanvasContext.getImageData(-K,-K,Y.width+2*K,Y.height+2*K);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),rt}}function Js(Ut,Y){if(0!==Ut.length){ja(Ut[0],Y);for(var K=1;K<Ut.length;K++)ja(Ut[K],!Y)}}function ja(Ut,Y){for(var K=0,rt=0,Ot=0,Nt=Ut.length,ne=Nt-1;Ot<Nt;ne=Ot++){var ye=(Ut[Ot][0]-Ut[ne][0])*(Ut[ne][1]+Ut[Ot][1]),Lt=K+ye;rt+=Math.abs(K)>=Math.abs(ye)?K-Lt+ye:ye-Lt+K,K=Lt}K+rt>=0!=!!Y&&Ut.reverse()}var mc=ge.g(function Ut(Y,K){var rt,Ot=Y&&Y.type;if("FeatureCollection"===Ot)for(rt=0;rt<Y.features.length;rt++)Ut(Y.features[rt],K);else if("GeometryCollection"===Ot)for(rt=0;rt<Y.geometries.length;rt++)Ut(Y.geometries[rt],K);else if("Feature"===Ot)Ut(Y.geometry,K);else if("Polygon"===Ot)Js(Y.coordinates,K);else if("MultiPolygon"===Ot)for(rt=0;rt<Y.coordinates.length;rt++)Js(Y.coordinates[rt],K);return Y});const Qc=ge.V.prototype.toGeoJSON;var Jc={exports:{}},I_=ge.p,Qp=ge.a.VectorTileFeature,Ds=kl;function kl(Ut,Y){this.options=Y||{},this.features=Ut,this.length=Ut.length}function Sl(Ut,Y){this.id="number"==typeof Ut.id?Ut.id:void 0,this.type=Ut.type,this.rawGeometry=1===Ut.type?[Ut.geometry]:Ut.geometry,this.properties=Ut.tags,this.extent=Y||4096}kl.prototype.feature=function(Ut){return new Sl(this.features[Ut],this.options.extent)},Sl.prototype.loadGeometry=function(){var Ut=this.rawGeometry;this.geometry=[];for(var Y=0;Y<Ut.length;Y++){for(var K=Ut[Y],rt=[],Ot=0;Ot<K.length;Ot++)rt.push(new I_(K[Ot][0],K[Ot][1]));this.geometry.push(rt)}return this.geometry},Sl.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ut=this.geometry,Y=1/0,K=-1/0,rt=1/0,Ot=-1/0,Nt=0;Nt<Ut.length;Nt++)for(var ne=Ut[Nt],ye=0;ye<ne.length;ye++){var Lt=ne[ye];Y=Math.min(Y,Lt.x),K=Math.max(K,Lt.x),rt=Math.min(rt,Lt.y),Ot=Math.max(Ot,Lt.y)}return[Y,rt,K,Ot]},Sl.prototype.toGeoJSON=Qp.prototype.toGeoJSON;var R_=ge.b,td=Ds;function Tl(Ut){var Y=new R_;return function(K,rt){for(var Ot in K.layers)rt.writeMessage(3,ot,K.layers[Ot])}(Ut,Y),Y.finish()}function ot(Ut,Y){var K;Y.writeVarintField(15,Ut.version||1),Y.writeStringField(1,Ut.name||""),Y.writeVarintField(5,Ut.extent||4096);var rt={keys:[],values:[],keycache:{},valuecache:{}};for(K=0;K<Ut.length;K++)rt.feature=Ut.feature(K),Y.writeMessage(2,Ni,rt);var Ot=rt.keys;for(K=0;K<Ot.length;K++)Y.writeStringField(3,Ot[K]);var Nt=rt.values;for(K=0;K<Nt.length;K++)Y.writeMessage(4,h0,Nt[K])}function Ni(Ut,Y){var K=Ut.feature;void 0!==K.id&&Y.writeVarintField(1,K.id),Y.writeMessage(2,Qd,Ut),Y.writeVarintField(3,K.type),Y.writeMessage(4,jr,K)}function Qd(Ut,Y){var K=Ut.feature,rt=Ut.keys,Ot=Ut.values,Nt=Ut.keycache,ne=Ut.valuecache;for(var ye in K.properties){var Lt=K.properties[ye],Ee=Nt[ye];if(null!==Lt){void 0===Ee&&(rt.push(ye),Nt[ye]=Ee=rt.length-1),Y.writeVarint(Ee);var Ge=typeof Lt;"string"!==Ge&&"boolean"!==Ge&&"number"!==Ge&&(Lt=JSON.stringify(Lt));var We=Ge+":"+Lt,wn=ne[We];void 0===wn&&(Ot.push(Lt),ne[We]=wn=Ot.length-1),Y.writeVarint(wn)}}}function El(Ut,Y){return(Y<<3)+(7&Ut)}function ni(Ut){return Ut<<1^Ut>>31}function jr(Ut,Y){for(var K=Ut.loadGeometry(),rt=Ut.type,Ot=0,Nt=0,ne=K.length,ye=0;ye<ne;ye++){var Lt=K[ye],Ee=1;1===rt&&(Ee=Lt.length),Y.writeVarint(El(1,Ee));for(var Ge=3===rt?Lt.length-1:Lt.length,We=0;We<Ge;We++){1===We&&1!==rt&&Y.writeVarint(El(2,Ge-1));var wn=Lt[We].x-Ot,tr=Lt[We].y-Nt;Y.writeVarint(ni(wn)),Y.writeVarint(ni(tr)),Ot+=wn,Nt+=tr}3===rt&&Y.writeVarint(El(7,1))}}function h0(Ut,Y){var K=typeof Ut;"string"===K?Y.writeStringField(1,Ut):"boolean"===K?Y.writeBooleanField(7,Ut):"number"===K&&(Ut%1!=0?Y.writeDoubleField(3,Ut):Ut<0?Y.writeSVarintField(6,Ut):Y.writeVarintField(5,Ut))}Jc.exports=Tl,Jc.exports.fromVectorTileJs=Tl,Jc.exports.fromGeojsonVt=function(Ut,Y){Y=Y||{};var K={};for(var rt in Ut)K[rt]=new td(Ut[rt].features,Y),K[rt].name=rt,K[rt].version=Y.version,K[rt].extent=Y.extent;return Tl({layers:K})},Jc.exports.GeoJSONWrapper=td;var ed=ge.g(Jc.exports);const Al={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ut=>Ut},Jd=Math.fround||(id=new Float32Array(1),Ut=>(id[0]=+Ut,id[0]));var id;const en=3,he=5,Il=6;class Rl{constructor(Y){this.options=Object.assign(Object.create(Al),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){const{log:K,minZoom:rt,maxZoom:Ot}=this.options;K&&console.time("total time");const Nt=`prepare ${Y.length} points`;K&&console.time(Nt),this.points=Y;const ne=[];for(let Lt=0;Lt<Y.length;Lt++){const Ee=Y[Lt];if(!Ee.geometry)continue;const[Ge,We]=Ee.geometry.coordinates,wn=Jd(se(Ge)),tr=Jd(is(We));ne.push(wn,tr,1/0,Lt,-1,1),this.options.reduce&&ne.push(0)}let ye=this.trees[Ot+1]=this._createTree(ne);K&&console.timeEnd(Nt);for(let Lt=Ot;Lt>=rt;Lt--){const Ee=+Date.now();ye=this.trees[Lt]=this._createTree(this._cluster(ye,Lt)),K&&console.log("z%d: %d clusters in %dms",Lt,ye.numItems,+Date.now()-Ee)}return K&&console.timeEnd("total time"),this}getClusters(Y,K){let rt=((Y[0]+180)%360+360)%360-180;const Ot=Math.max(-90,Math.min(90,Y[1]));let Nt=180===Y[2]?180:((Y[2]+180)%360+360)%360-180;const ne=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)rt=-180,Nt=180;else if(rt>Nt){const We=this.getClusters([rt,Ot,180,ne],K),wn=this.getClusters([-180,Ot,Nt,ne],K);return We.concat(wn)}const ye=this.trees[this._limitZoom(K)],Lt=ye.range(se(rt),is(ne),se(Nt),is(Ot)),Ee=ye.data,Ge=[];for(const We of Lt){const wn=this.stride*We;Ge.push(Ee[wn+he]>1?tu(Ee,wn,this.clusterProps):this.points[Ee[wn+en]])}return Ge}getChildren(Y){const K=this._getOriginId(Y),rt=this._getOriginZoom(Y),Ot="No cluster with the specified id.",Nt=this.trees[rt];if(!Nt)throw new Error(Ot);const ne=Nt.data;if(K*this.stride>=ne.length)throw new Error(Ot);const ye=this.options.radius/(this.options.extent*Math.pow(2,rt-1)),Lt=Nt.within(ne[K*this.stride],ne[K*this.stride+1],ye),Ee=[];for(const Ge of Lt){const We=Ge*this.stride;ne[We+4]===Y&&Ee.push(ne[We+he]>1?tu(ne,We,this.clusterProps):this.points[ne[We+en]])}if(0===Ee.length)throw new Error(Ot);return Ee}getLeaves(Y,K,rt){const Ot=[];return this._appendLeaves(Ot,Y,K=K||10,rt=rt||0,0),Ot}getTile(Y,K,rt){const Ot=this.trees[this._limitZoom(Y)],Nt=Math.pow(2,Y),{extent:ne,radius:ye}=this.options,Lt=ye/ne,Ee=(rt-Lt)/Nt,Ge=(rt+1+Lt)/Nt,We={features:[]};return this._addTileFeatures(Ot.range((K-Lt)/Nt,Ee,(K+1+Lt)/Nt,Ge),Ot.data,K,rt,Nt,We),0===K&&this._addTileFeatures(Ot.range(1-Lt/Nt,Ee,1,Ge),Ot.data,Nt,rt,Nt,We),K===Nt-1&&this._addTileFeatures(Ot.range(0,Ee,Lt/Nt,Ge),Ot.data,-1,rt,Nt,We),We.features.length?We:null}getClusterExpansionZoom(Y){let K=this._getOriginZoom(Y)-1;for(;K<=this.options.maxZoom;){const rt=this.getChildren(Y);if(K++,1!==rt.length)break;Y=rt[0].properties.cluster_id}return K}_appendLeaves(Y,K,rt,Ot,Nt){const ne=this.getChildren(K);for(const ye of ne){const Lt=ye.properties;if(Lt&&Lt.cluster?Nt+Lt.point_count<=Ot?Nt+=Lt.point_count:Nt=this._appendLeaves(Y,Lt.cluster_id,rt,Ot,Nt):Nt<Ot?Nt++:Y.push(ye),Y.length===rt)break}return Nt}_createTree(Y){const K=new ge.K(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let rt=0;rt<Y.length;rt+=this.stride)K.add(Y[rt],Y[rt+1]);return K.finish(),K.data=Y,K}_addTileFeatures(Y,K,rt,Ot,Nt,ne){for(const ye of Y){const Lt=ye*this.stride,Ee=K[Lt+he]>1;let Ge,We,wn;if(Ee)Ge=we(K,Lt,this.clusterProps),We=K[Lt],wn=K[Lt+1];else{const er=this.points[K[Lt+en]];Ge=er.properties;const[En,An]=er.geometry.coordinates;We=se(En),wn=is(An)}const tr={type:1,geometry:[[Math.round(this.options.extent*(We*Nt-rt)),Math.round(this.options.extent*(wn*Nt-Ot))]],tags:Ge};let eo;eo=Ee||this.options.generateId?K[Lt+en]:this.points[K[Lt+en]].id,void 0!==eo&&(tr.id=eo),ne.features.push(tr)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,K){const{radius:rt,extent:Ot,reduce:Nt,minPoints:ne}=this.options,ye=rt/(Ot*Math.pow(2,K)),Lt=Y.data,Ee=[],Ge=this.stride;for(let We=0;We<Lt.length;We+=Ge){if(Lt[We+2]<=K)continue;Lt[We+2]=K;const wn=Lt[We],tr=Lt[We+1],eo=Y.within(Lt[We],Lt[We+1],ye),er=Lt[We+he];let En=er;for(const An of eo){const Fo=An*Ge;Lt[Fo+2]>K&&(En+=Lt[Fo+he])}if(En>er&&En>=ne){let An,Fo=wn*er,Ho=tr*er,ns=-1;const Ua=((We/Ge|0)<<5)+(K+1)+this.points.length;for(const jh of eo){const ks=jh*Ge;if(Lt[ks+2]<=K)continue;Lt[ks+2]=K;const pc=Lt[ks+he];Fo+=Lt[ks]*pc,Ho+=Lt[ks+1]*pc,Lt[ks+4]=Ua,Nt&&(An||(An=this._map(Lt,We,!0),ns=this.clusterProps.length,this.clusterProps.push(An)),Nt(An,this._map(Lt,ks)))}Lt[We+4]=Ua,Ee.push(Fo/En,Ho/En,1/0,Ua,-1,En),Nt&&Ee.push(ns)}else{for(let An=0;An<Ge;An++)Ee.push(Lt[We+An]);if(En>1)for(const An of eo){const Fo=An*Ge;if(!(Lt[Fo+2]<=K)){Lt[Fo+2]=K;for(let Ho=0;Ho<Ge;Ho++)Ee.push(Lt[Fo+Ho])}}}}return Ee}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,K,rt){if(Y[K+he]>1){const ne=this.clusterProps[Y[K+Il]];return rt?Object.assign({},ne):ne}const Ot=this.points[Y[K+en]].properties,Nt=this.options.map(Ot);return rt&&Nt===Ot?Object.assign({},Nt):Nt}}function tu(Ut,Y,K){return{type:"Feature",id:Ut[Y+en],properties:we(Ut,Y,K),geometry:{type:"Point",coordinates:[(rt=Ut[Y],360*(rt-.5)),pr(Ut[Y+1])]}};var rt}function we(Ut,Y,K){const rt=Ut[Y+he],Ot=rt>=1e4?`${Math.round(rt/1e3)}k`:rt>=1e3?Math.round(rt/100)/10+"k":rt,Nt=Ut[Y+Il],ne=-1===Nt?{}:Object.assign({},K[Nt]);return Object.assign(ne,{cluster:!0,cluster_id:Ut[Y+en],point_count:rt,point_count_abbreviated:Ot})}function se(Ut){return Ut/360+.5}function is(Ut){const Y=Math.sin(Ut*Math.PI/180),K=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return K<0?0:K>1?1:K}function pr(Ut){const Y=(180-360*Ut)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}var jn={exports:{}};jn.exports=function(){function Ut(xt,Tt,zt,Ht){for(var jt,qt=Ht,Qt=zt-Tt>>1,$t=zt-Tt,ce=xt[Tt],Zt=xt[Tt+1],ai=xt[zt],un=xt[zt+1],Ae=Tt+3;Ae<zt;Ae+=3){var nn=Y(xt[Ae],xt[Ae+1],ce,Zt,ai,un);if(nn>qt)jt=Ae,qt=nn;else if(nn===qt){var qi=Math.abs(Ae-Qt);qi<$t&&(jt=Ae,$t=qi)}}qt>Ht&&(jt-Tt>3&&Ut(xt,Tt,jt,Ht),xt[jt+2]=qt,zt-jt>3&&Ut(xt,jt,zt,Ht))}function Y(xt,Tt,zt,Ht,jt,qt){var Qt=jt-zt,$t=qt-Ht;if(0!==Qt||0!==$t){var ce=((xt-zt)*Qt+(Tt-Ht)*$t)/(Qt*Qt+$t*$t);ce>1?(zt=jt,Ht=qt):ce>0&&(zt+=Qt*ce,Ht+=$t*ce)}return(Qt=xt-zt)*Qt+($t=Tt-Ht)*$t}function K(xt,Tt,zt,Ht){var jt={id:void 0===xt?null:xt,type:Tt,geometry:zt,tags:Ht,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(qt){var Qt=qt.geometry,$t=qt.type;if("Point"===$t||"MultiPoint"===$t||"LineString"===$t)rt(qt,Qt);else if("Polygon"===$t||"MultiLineString"===$t)for(var ce=0;ce<Qt.length;ce++)rt(qt,Qt[ce]);else if("MultiPolygon"===$t)for(ce=0;ce<Qt.length;ce++)for(var Zt=0;Zt<Qt[ce].length;Zt++)rt(qt,Qt[ce][Zt])}(jt),jt}function rt(xt,Tt){for(var zt=0;zt<Tt.length;zt+=3)xt.minX=Math.min(xt.minX,Tt[zt]),xt.minY=Math.min(xt.minY,Tt[zt+1]),xt.maxX=Math.max(xt.maxX,Tt[zt]),xt.maxY=Math.max(xt.maxY,Tt[zt+1])}function Ot(xt,Tt,zt,Ht){if(Tt.geometry){var jt=Tt.geometry.coordinates,qt=Tt.geometry.type,Qt=Math.pow(zt.tolerance/((1<<zt.maxZoom)*zt.extent),2),$t=[],ce=Tt.id;if(zt.promoteId?ce=Tt.properties[zt.promoteId]:zt.generateId&&(ce=Ht||0),"Point"===qt)Nt(jt,$t);else if("MultiPoint"===qt)for(var Zt=0;Zt<jt.length;Zt++)Nt(jt[Zt],$t);else if("LineString"===qt)ne(jt,$t,Qt,!1);else if("MultiLineString"===qt){if(zt.lineMetrics){for(Zt=0;Zt<jt.length;Zt++)ne(jt[Zt],$t=[],Qt,!1),xt.push(K(ce,"LineString",$t,Tt.properties));return}ye(jt,$t,Qt,!1)}else if("Polygon"===qt)ye(jt,$t,Qt,!0);else{if("MultiPolygon"!==qt){if("GeometryCollection"===qt){for(Zt=0;Zt<Tt.geometry.geometries.length;Zt++)Ot(xt,{id:ce,geometry:Tt.geometry.geometries[Zt],properties:Tt.properties},zt,Ht);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Zt=0;Zt<jt.length;Zt++){var ai=[];ye(jt[Zt],ai,Qt,!0),$t.push(ai)}}xt.push(K(ce,qt,$t,Tt.properties))}}function Nt(xt,Tt){Tt.push(Lt(xt[0])),Tt.push(Ee(xt[1])),Tt.push(0)}function ne(xt,Tt,zt,Ht){for(var jt,qt,Qt=0,$t=0;$t<xt.length;$t++){var ce=Lt(xt[$t][0]),Zt=Ee(xt[$t][1]);Tt.push(ce),Tt.push(Zt),Tt.push(0),$t>0&&(Qt+=Ht?(jt*Zt-ce*qt)/2:Math.sqrt(Math.pow(ce-jt,2)+Math.pow(Zt-qt,2))),jt=ce,qt=Zt}var ai=Tt.length-3;Tt[2]=1,Ut(Tt,0,ai,zt),Tt[ai+2]=1,Tt.size=Math.abs(Qt),Tt.start=0,Tt.end=Tt.size}function ye(xt,Tt,zt,Ht){for(var jt=0;jt<xt.length;jt++){var qt=[];ne(xt[jt],qt,zt,Ht),Tt.push(qt)}}function Lt(xt){return xt/360+.5}function Ee(xt){var Tt=Math.sin(xt*Math.PI/180),zt=.5-.25*Math.log((1+Tt)/(1-Tt))/Math.PI;return zt<0?0:zt>1?1:zt}function Ge(xt,Tt,zt,Ht,jt,qt,Qt,$t){if(Ht/=Tt,qt>=(zt/=Tt)&&Qt<Ht)return xt;if(Qt<zt||qt>=Ht)return null;for(var ce=[],Zt=0;Zt<xt.length;Zt++){var ai=xt[Zt],un=ai.geometry,Ae=ai.type,nn=0===jt?ai.minX:ai.minY,qi=0===jt?ai.maxX:ai.maxY;if(nn>=zt&&qi<Ht)ce.push(ai);else if(!(qi<zt||nn>=Ht)){var lr=[];if("Point"===Ae||"MultiPoint"===Ae)We(un,lr,zt,Ht,jt);else if("LineString"===Ae)wn(un,lr,zt,Ht,jt,!1,$t.lineMetrics);else if("MultiLineString"===Ae)eo(un,lr,zt,Ht,jt,!1);else if("Polygon"===Ae)eo(un,lr,zt,Ht,jt,!0);else if("MultiPolygon"===Ae)for(var Tr=0;Tr<un.length;Tr++){var Lo=[];eo(un[Tr],Lo,zt,Ht,jt,!0),Lo.length&&lr.push(Lo)}if(lr.length){if($t.lineMetrics&&"LineString"===Ae){for(Tr=0;Tr<lr.length;Tr++)ce.push(K(ai.id,Ae,lr[Tr],ai.tags));continue}"LineString"!==Ae&&"MultiLineString"!==Ae||(1===lr.length?(Ae="LineString",lr=lr[0]):Ae="MultiLineString"),"Point"!==Ae&&"MultiPoint"!==Ae||(Ae=3===lr.length?"Point":"MultiPoint"),ce.push(K(ai.id,Ae,lr,ai.tags))}}}return ce.length?ce:null}function We(xt,Tt,zt,Ht,jt){for(var qt=0;qt<xt.length;qt+=3){var Qt=xt[qt+jt];Qt>=zt&&Qt<=Ht&&(Tt.push(xt[qt]),Tt.push(xt[qt+1]),Tt.push(xt[qt+2]))}}function wn(xt,Tt,zt,Ht,jt,qt,Qt){for(var $t,ce,Zt=tr(xt),ai=0===jt?En:An,un=xt.start,Ae=0;Ae<xt.length-3;Ae+=3){var nn=xt[Ae],qi=xt[Ae+1],lr=xt[Ae+2],Tr=xt[Ae+3],Lo=xt[Ae+4],va=0===jt?nn:qi,Ur=0===jt?Tr:Lo,rs=!1;Qt&&($t=Math.sqrt(Math.pow(nn-Tr,2)+Math.pow(qi-Lo,2))),va<zt?Ur>zt&&(ce=ai(Zt,nn,qi,Tr,Lo,zt),Qt&&(Zt.start=un+$t*ce)):va>Ht?Ur<Ht&&(ce=ai(Zt,nn,qi,Tr,Lo,Ht),Qt&&(Zt.start=un+$t*ce)):er(Zt,nn,qi,lr),Ur<zt&&va>=zt&&(ce=ai(Zt,nn,qi,Tr,Lo,zt),rs=!0),Ur>Ht&&va<=Ht&&(ce=ai(Zt,nn,qi,Tr,Lo,Ht),rs=!0),!qt&&rs&&(Qt&&(Zt.end=un+$t*ce),Tt.push(Zt),Zt=tr(xt)),Qt&&(un+=$t)}var Bo=xt.length-3;nn=xt[Bo],qi=xt[Bo+1],lr=xt[Bo+2],(va=0===jt?nn:qi)>=zt&&va<=Ht&&er(Zt,nn,qi,lr),Bo=Zt.length-3,qt&&Bo>=3&&(Zt[Bo]!==Zt[0]||Zt[Bo+1]!==Zt[1])&&er(Zt,Zt[0],Zt[1],Zt[2]),Zt.length&&Tt.push(Zt)}function tr(xt){var Tt=[];return Tt.size=xt.size,Tt.start=xt.start,Tt.end=xt.end,Tt}function eo(xt,Tt,zt,Ht,jt,qt){for(var Qt=0;Qt<xt.length;Qt++)wn(xt[Qt],Tt,zt,Ht,jt,qt,!1)}function er(xt,Tt,zt,Ht){xt.push(Tt),xt.push(zt),xt.push(Ht)}function En(xt,Tt,zt,Ht,jt,qt){var Qt=(qt-Tt)/(Ht-Tt);return xt.push(qt),xt.push(zt+(jt-zt)*Qt),xt.push(1),Qt}function An(xt,Tt,zt,Ht,jt,qt){var Qt=(qt-zt)/(jt-zt);return xt.push(Tt+(Ht-Tt)*Qt),xt.push(qt),xt.push(1),Qt}function Fo(xt,Tt){for(var zt=[],Ht=0;Ht<xt.length;Ht++){var jt,qt=xt[Ht],Qt=qt.type;if("Point"===Qt||"MultiPoint"===Qt||"LineString"===Qt)jt=Ho(qt.geometry,Tt);else if("MultiLineString"===Qt||"Polygon"===Qt){jt=[];for(var $t=0;$t<qt.geometry.length;$t++)jt.push(Ho(qt.geometry[$t],Tt))}else if("MultiPolygon"===Qt)for(jt=[],$t=0;$t<qt.geometry.length;$t++){for(var ce=[],Zt=0;Zt<qt.geometry[$t].length;Zt++)ce.push(Ho(qt.geometry[$t][Zt],Tt));jt.push(ce)}zt.push(K(qt.id,Qt,jt,qt.tags))}return zt}function Ho(xt,Tt){var zt=[];zt.size=xt.size,void 0!==xt.start&&(zt.start=xt.start,zt.end=xt.end);for(var Ht=0;Ht<xt.length;Ht+=3)zt.push(xt[Ht]+Tt,xt[Ht+1],xt[Ht+2]);return zt}function ns(xt,Tt){if(xt.transformed)return xt;var zt,Ht,jt,qt=1<<xt.z,Qt=xt.x,$t=xt.y;for(zt=0;zt<xt.features.length;zt++){var ce=xt.features[zt],Zt=ce.geometry,ai=ce.type;if(ce.geometry=[],1===ai)for(Ht=0;Ht<Zt.length;Ht+=2)ce.geometry.push(Ua(Zt[Ht],Zt[Ht+1],Tt,qt,Qt,$t));else for(Ht=0;Ht<Zt.length;Ht++){var un=[];for(jt=0;jt<Zt[Ht].length;jt+=2)un.push(Ua(Zt[Ht][jt],Zt[Ht][jt+1],Tt,qt,Qt,$t));ce.geometry.push(un)}}return xt.transformed=!0,xt}function Ua(xt,Tt,zt,Ht,jt,qt){return[Math.round(zt*(xt*Ht-jt)),Math.round(zt*(Tt*Ht-qt))]}function jh(xt,Tt,zt,Ht,jt){for(var qt=Tt===jt.maxZoom?0:jt.tolerance/((1<<Tt)*jt.extent),Qt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:zt,y:Ht,z:Tt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},$t=0;$t<xt.length;$t++){Qt.numFeatures++,ks(Qt,xt[$t],qt,jt);var ce=xt[$t].minX,Zt=xt[$t].minY,ai=xt[$t].maxX,un=xt[$t].maxY;ce<Qt.minX&&(Qt.minX=ce),Zt<Qt.minY&&(Qt.minY=Zt),ai>Qt.maxX&&(Qt.maxX=ai),un>Qt.maxY&&(Qt.maxY=un)}return Qt}function ks(xt,Tt,zt,Ht){var jt=Tt.geometry,qt=Tt.type,Qt=[];if("Point"===qt||"MultiPoint"===qt)for(var $t=0;$t<jt.length;$t+=3)Qt.push(jt[$t]),Qt.push(jt[$t+1]),xt.numPoints++,xt.numSimplified++;else if("LineString"===qt)pc(Qt,jt,xt,zt,!1,!1);else if("MultiLineString"===qt||"Polygon"===qt)for($t=0;$t<jt.length;$t++)pc(Qt,jt[$t],xt,zt,"Polygon"===qt,0===$t);else if("MultiPolygon"===qt)for(var ce=0;ce<jt.length;ce++){var Zt=jt[ce];for($t=0;$t<Zt.length;$t++)pc(Qt,Zt[$t],xt,zt,!0,0===$t)}if(Qt.length){var ai=Tt.tags||null;if("LineString"===qt&&Ht.lineMetrics){for(var un in ai={},Tt.tags)ai[un]=Tt.tags[un];ai.mapbox_clip_start=jt.start/jt.size,ai.mapbox_clip_end=jt.end/jt.size}var Ae={geometry:Qt,type:"Polygon"===qt||"MultiPolygon"===qt?3:"LineString"===qt||"MultiLineString"===qt?2:1,tags:ai};null!==Tt.id&&(Ae.id=Tt.id),xt.features.push(Ae)}}function pc(xt,Tt,zt,Ht,jt,qt){var Qt=Ht*Ht;if(Ht>0&&Tt.size<(jt?Qt:Ht))zt.numPoints+=Tt.length/3;else{for(var $t=[],ce=0;ce<Tt.length;ce+=3)(0===Ht||Tt[ce+2]>Qt)&&(zt.numSimplified++,$t.push(Tt[ce]),$t.push(Tt[ce+1])),zt.numPoints++;jt&&function(Zt,ai){for(var un=0,Ae=0,nn=Zt.length,qi=nn-2;Ae<nn;qi=Ae,Ae+=2)un+=(Zt[Ae]-Zt[qi])*(Zt[Ae+1]+Zt[qi+1]);if(un>0===ai)for(Ae=0,nn=Zt.length;Ae<nn/2;Ae+=2){var lr=Zt[Ae],Tr=Zt[Ae+1];Zt[Ae]=Zt[nn-2-Ae],Zt[Ae+1]=Zt[nn-1-Ae],Zt[nn-2-Ae]=lr,Zt[nn-1-Ae]=Tr}}($t,qt),xt.push($t)}}function rd(xt,Tt){var zt=(Tt=this.options=function(jt,qt){for(var Qt in qt)jt[Qt]=qt[Qt];return jt}(Object.create(this.options),Tt)).debug;if(zt&&console.time("preprocess data"),Tt.maxZoom<0||Tt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Tt.promoteId&&Tt.generateId)throw new Error("promoteId and generateId cannot be used together.");var jt,qt,Qt,$t,ce,Zt,Ht=function(jt,qt){var Qt=[];if("FeatureCollection"===jt.type)for(var $t=0;$t<jt.features.length;$t++)Ot(Qt,jt.features[$t],qt,$t);else Ot(Qt,"Feature"===jt.type?jt:{geometry:jt},qt);return Qt}(xt,Tt);this.tiles={},this.tileCoords=[],zt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Tt.indexMaxZoom,Tt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(jt=Ht,qt=Tt,Qt=qt.buffer/qt.extent,$t=jt,ce=Ge(jt,1,-1-Qt,Qt,0,-1,2,qt),Zt=Ge(jt,1,1-Qt,2+Qt,0,-1,2,qt),(ce||Zt)&&($t=Ge(jt,1,-Qt,1+Qt,0,-1,2,qt)||[],ce&&($t=Fo(ce,1).concat($t)),Zt&&($t=$t.concat(Fo(Zt,-1)))),Ht=$t).length&&this.splitTile(Ht,0,0,0),zt&&(Ht.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Uh(xt,Tt,zt){return 32*((1<<xt)*zt+Tt)+xt}return rd.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},rd.prototype.splitTile=function(xt,Tt,zt,Ht,jt,qt,Qt){for(var $t=[xt,Tt,zt,Ht],ce=this.options,Zt=ce.debug;$t.length;){Ht=$t.pop(),zt=$t.pop(),Tt=$t.pop(),xt=$t.pop();var ai=1<<Tt,un=Uh(Tt,zt,Ht),Ae=this.tiles[un];if(!Ae&&(Zt>1&&console.time("creation"),Ae=this.tiles[un]=jh(xt,Tt,zt,Ht,ce),this.tileCoords.push({z:Tt,x:zt,y:Ht}),Zt)){Zt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Tt,zt,Ht,Ae.numFeatures,Ae.numPoints,Ae.numSimplified),console.timeEnd("creation"));var nn="z"+Tt;this.stats[nn]=(this.stats[nn]||0)+1,this.total++}if(Ae.source=xt,jt){if(Tt===ce.maxZoom||Tt===jt)continue;var qi=1<<jt-Tt;if(zt!==Math.floor(qt/qi)||Ht!==Math.floor(Qt/qi))continue}else if(Tt===ce.indexMaxZoom||Ae.numPoints<=ce.indexMaxPoints)continue;if(Ae.source=null,0!==xt.length){Zt>1&&console.time("clipping");var lr,Tr,Lo,va,Ur,rs,Bo=.5*ce.buffer/ce.extent,Ss=.5-Bo,od=.5+Bo,xr=1+Bo;lr=Tr=Lo=va=null,Ur=Ge(xt,ai,zt-Bo,zt+od,0,Ae.minX,Ae.maxX,ce),rs=Ge(xt,ai,zt+Ss,zt+xr,0,Ae.minX,Ae.maxX,ce),xt=null,Ur&&(lr=Ge(Ur,ai,Ht-Bo,Ht+od,1,Ae.minY,Ae.maxY,ce),Tr=Ge(Ur,ai,Ht+Ss,Ht+xr,1,Ae.minY,Ae.maxY,ce),Ur=null),rs&&(Lo=Ge(rs,ai,Ht-Bo,Ht+od,1,Ae.minY,Ae.maxY,ce),va=Ge(rs,ai,Ht+Ss,Ht+xr,1,Ae.minY,Ae.maxY,ce),rs=null),Zt>1&&console.timeEnd("clipping"),$t.push(lr||[],Tt+1,2*zt,2*Ht),$t.push(Tr||[],Tt+1,2*zt,2*Ht+1),$t.push(Lo||[],Tt+1,2*zt+1,2*Ht),$t.push(va||[],Tt+1,2*zt+1,2*Ht+1)}}},rd.prototype.getTile=function(xt,Tt,zt){var Ht=this.options,jt=Ht.extent,qt=Ht.debug;if(xt<0||xt>24)return null;var Qt=1<<xt,$t=Uh(xt,Tt=(Tt%Qt+Qt)%Qt,zt);if(this.tiles[$t])return ns(this.tiles[$t],jt);qt>1&&console.log("drilling down to z%d-%d-%d",xt,Tt,zt);for(var ce,Zt=xt,ai=Tt,un=zt;!ce&&Zt>0;)Zt--,ai=Math.floor(ai/2),un=Math.floor(un/2),ce=this.tiles[Uh(Zt,ai,un)];return ce&&ce.source?(qt>1&&console.log("found parent tile z%d-%d-%d",Zt,ai,un),qt>1&&console.time("drilling down"),this.splitTile(ce.source,Zt,ai,un,xt,Tt,zt),qt>1&&console.timeEnd("drilling down"),this.tiles[$t]?ns(this.tiles[$t],jt):null):null},function(xt,Tt){return new rd(xt,Tt)}}();var P_=ge.g(jn.exports);function Ti(Ut,Y){const K=Ut.tileID.canonical;if(!this._geoJSONIndex)return Y(null,null);const rt=this._geoJSONIndex.getTile(K.z,K.x,K.y);if(!rt)return Y(null,null);const Ot=new class{constructor(ne){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=ge.E,this.length=ne.length,this._features=ne}feature(ne){return new class{constructor(ye){this._feature=ye,this.extent=ge.E,this.type=ye.type,this.properties=ye.tags,"id"in ye&&!isNaN(ye.id)&&(this.id=parseInt(ye.id,10))}loadGeometry(){if(1===this._feature.type){const ye=[];for(const Lt of this._feature.geometry)ye.push([new ge.P(Lt[0],Lt[1])]);return ye}{const ye=[];for(const Lt of this._feature.geometry){const Ee=[];for(const Ge of Lt)Ee.push(new ge.P(Ge[0],Ge[1]));ye.push(Ee)}return ye}}toGeoJSON(ye,Lt,Ee){return Qc.call(this,ye,Lt,Ee)}}(this._features[ne])}}(rt.features);let Nt=ed(Ot);0===Nt.byteOffset&&Nt.byteLength===Nt.buffer.byteLength||(Nt=new Uint8Array(Nt)),Y(null,{vectorTile:Ot,rawData:Nt.buffer})}class zh extends ge.d{constructor(Y,K,rt,Ot,Nt,ne){super(Y,K,rt,Ot,Ti,ne),Nt&&(this.loadGeoJSON=Nt)}loadData(Y,K){const rt=Y&&Y.request,Ot=rt&&rt.collectResourceTiming;this.loadGeoJSON(Y,(Nt,ne)=>{if(Nt||!ne)return K(Nt);if("object"!=typeof ne)return K(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));{mc(ne,!0);try{if(Y.filter){const Lt=ge.e(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Lt.result)throw new Error(Lt.value.map(Ge=>`${Ge.key}: ${Ge.message}`).join(", "));ne={type:"FeatureCollection",features:ne.features.filter(Ge=>Lt.value.evaluate({zoom:0},Ge))}}this._geoJSONIndex=Y.cluster?new Rl(function({superclusterOptions:Lt,clusterProperties:Ee}){if(!Ee||!Lt)return Lt;const Ge={},We={},wn={accumulated:null,zoom:0},tr={properties:null},eo=Object.keys(Ee);for(const er of eo){const[En,An]=Ee[er],Fo=ge.e(An),Ho=ge.e("string"==typeof En?[En,["accumulated"],["get",er]]:En);Ge[er]=Fo.value,We[er]=Ho.value}return Lt.map=er=>{tr.properties=er;const En={};for(const An of eo)En[An]=Ge[An].evaluate(wn,tr);return En},Lt.reduce=(er,En)=>{tr.properties=En;for(const An of eo)wn.accumulated=er[An],er[An]=We[An].evaluate(wn,tr)},Lt}(Y)).load(ne.features):P_(ne,Y.geojsonVtOptions)}catch(Lt){return K(Lt)}this.loaded={};const ye={};if(Ot){const Lt=ge.f(rt);Lt&&(ye.resourceTiming={},ye.resourceTiming[Y.source]=JSON.parse(JSON.stringify(Lt)))}K(null,ye)}})}reloadTile(Y,K){const rt=this.loaded;return rt&&rt[Y.uid]?super.reloadTile(Y,K):this.loadTile(Y,K)}loadGeoJSON(Y,K){if(Y.request)ge.h(Y.request,K);else{if("string"!=typeof Y.data)return K(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));try{return K(null,JSON.parse(Y.data))}catch{return K(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Y,K){try{K(null,this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId))}catch(rt){K(rt)}}getClusterChildren(Y,K){try{K(null,this._geoJSONIndex.getChildren(Y.clusterId))}catch(rt){K(rt)}}getClusterLeaves(Y,K){try{K(null,this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset))}catch(rt){K(rt)}}}class qr{constructor(Y,K){this.tileID=new ge.O(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.tileZoom=Y.tileZoom,this.uid=Y.uid,this.zoom=Y.zoom,this.canonical=Y.tileID.canonical,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Y.projection,this.brightness=K}parse(Y,K,rt,Ot){this.status="parsing";const Nt=new ge.O(rt.tileID.overscaledZ,rt.tileID.wrap,rt.tileID.canonical.z,rt.tileID.canonical.x,rt.tileID.canonical.y),ne={},ye=K.familiesBySource[rt.source],Lt=new ge.F(Nt,rt.promoteId);return Lt.bucketLayerIDs=[],ge.l(Y).then(Ee=>{if(!Ee)return Ot(new Error("Could not parse tile"));const Ge=ge.j(Ee,1/ge.t(rt.tileID.canonical)),We=Ee.json.extensionsUsed&&Ee.json.extensionsUsed.includes("MAPBOX_mesh_features"),wn=new ge.k(this.zoom,{brightness:this.brightness});for(const tr in ye)for(const eo of ye[tr]){const er=eo[0],En=Ee.json.extensionsUsed;er.recalculate(wn,[]);const An=new ge.T(Ge,Nt,En&&En.includes("MAPBOX_mesh_features"),this.brightness);We||(An.needsUpload=!0),ne[er.fqid]=An,An.evaluate(er)}this.status="done",Ot(null,{buckets:ne,featureIndex:Lt})}).catch(Ee=>Ot(new Error(Ee.message)))}}class nd{constructor(Y,K,rt,Ot,Nt,ne){this.actor=Y,this.layerIndex=K,this.brightness=ne,this.loading={},this.loaded={}}loadTile(Y,K){const rt=Y.uid,Ot=this.loading[rt]=new qr(Y,this.brightness);ge.i(Y.request,(Nt,ne)=>{const ye=!this.loading[rt];return delete this.loading[rt],ye||Nt?(Ot.status="done",ye||(this.loaded[rt]=Ot),K(Nt)):ne&&0!==ne.byteLength?void Ot.parse(ne,this.layerIndex,Y,(Lt,Ee)=>{Ot.status="done",this.loaded=this.loaded||{},this.loaded[rt]=Ot,Lt||!Ee?K(Lt):K(null,Ee)}):(Ot.status="done",this.loaded[rt]=Ot,K())})}reloadTile(Y,K){const rt=this.loaded,Ot=Y.uid;if(rt&&rt[Ot]){const Nt=rt[Ot];Nt.projection=Y.projection,Nt.brightness=Y.brightness;const ne=(ye,Lt)=>{Nt.reloadCallback&&(delete Nt.reloadCallback,this.loadTile(Y,K)),K(ye,Lt)};"parsing"===Nt.status?Nt.reloadCallback=ne:"done"===Nt.status&&this.loadTile(Y,K)}}abortTile(Y,K){const rt=Y.uid;this.loading[rt]&&delete this.loading[rt],K()}removeTile(Y,K){const rt=this.loaded,Ot=Y.uid;rt&&rt[Ot]&&delete rt[Ot],K()}}class Vh{constructor(Y){this.self=Y,this.actor=new ge.A(Y,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=ge.m({name:"mercator"}),this.workerSourceTypes={vector:ge.d,geojson:zh,"batched-model":nd},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(K,rt)=>{if(this.workerSourceTypes[K])throw new Error(`Worker source with name "${K}" already registered.`);this.workerSourceTypes[K]=rt},this.self.registerRTLTextPlugin=K=>{if(ge.n.isParsed())throw new Error("RTL text plugin already registered.");ge.n.applyArabicShaping=K.applyArabicShaping,ge.n.processBidirectionalText=K.processBidirectionalText,ge.n.processStyledBidirectionalText=K.processStyledBidirectionalText}}clearCaches(Y,K,rt){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.workerSources[Y],delete this.demWorkerSources[Y],rt()}checkIfReady(Y,K,rt){rt()}setReferrer(Y,K){this.referrer=K}spriteLoaded(Y,{scope:K,isLoaded:rt}){if(this.isSpriteLoaded[Y]||(this.isSpriteLoaded[Y]={}),this.isSpriteLoaded[Y][K]=rt,this.workerSources[Y]&&this.workerSources[Y][K])for(const Ot in this.workerSources[Y][K]){const Nt=this.workerSources[Y][K][Ot];for(const ne in Nt)Nt[ne]instanceof ge.d&&(Nt[ne].isSpriteLoaded=rt,Nt[ne].fire(new ge.o("isSpriteLoaded")))}}setImages(Y,{scope:K,images:rt},Ot){if(this.availableImages[Y]||(this.availableImages[Y]={}),this.availableImages[Y][K]=rt,this.workerSources[Y]&&this.workerSources[Y][K]){for(const Nt in this.workerSources[Y][K]){const ne=this.workerSources[Y][K][Nt];for(const ye in ne)ne[ye].availableImages=rt}Ot()}else Ot()}setProjection(Y,K){this.projections[Y]=ge.m(K)}setBrightness(Y,K,rt){this.brightness=K,rt()}setLayers(Y,K,rt){this.getLayerIndex(Y,K.scope).replace(K.layers,K.options),rt()}updateLayers(Y,K,rt){this.getLayerIndex(Y,K.scope).update(K.layers,K.removedIds,K.options),rt()}loadTile(Y,K,rt){K.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,K.type,K.source,K.scope).loadTile(K,rt)}loadDEMTile(Y,K,rt){this.getDEMWorkerSource(Y,K.source,K.scope).loadTile(K,rt)}reloadTile(Y,K,rt){K.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,K.type,K.source,K.scope).reloadTile(K,rt)}abortTile(Y,K,rt){this.getWorkerSource(Y,K.type,K.source,K.scope).abortTile(K,rt)}removeTile(Y,K,rt){this.getWorkerSource(Y,K.type,K.source,K.scope).removeTile(K,rt)}removeSource(Y,K,rt){if(!(this.workerSources[Y]&&this.workerSources[Y][K.scope]&&this.workerSources[Y][K.scope][K.type]&&this.workerSources[Y][K.scope][K.type][K.source]))return;const Ot=this.workerSources[Y][K.scope][K.type][K.source];delete this.workerSources[Y][K.scope][K.type][K.source],void 0!==Ot.removeSource?Ot.removeSource(K,rt):rt()}loadWorkerSource(Y,K,rt){try{this.self.importScripts(K.url),rt()}catch(Ot){rt(Ot.toString())}}syncRTLPluginState(Y,K,rt){try{ge.n.setState(K);const Ot=ge.n.getPluginURL();if(ge.n.isLoaded()&&!ge.n.isParsed()&&null!=Ot){this.self.importScripts(Ot);const Nt=ge.n.isParsed();rt(Nt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ot}`),Nt)}}catch(Ot){rt(Ot.toString())}}setDracoUrl(Y,K){this.dracoUrl=K}getAvailableImages(Y,K){this.availableImages[Y]||(this.availableImages[Y]={});let rt=this.availableImages[Y][K];return rt||(rt=[]),rt}getLayerIndex(Y,K){this.layerIndexes[Y]||(this.layerIndexes[Y]={});let rt=this.layerIndexes[Y][K];return rt||(rt=this.layerIndexes[Y][K]=new Dl,rt.scope=K),rt}getWorkerSource(Y,K,rt,Ot){return this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][Ot]||(this.workerSources[Y][Ot]={}),this.workerSources[Y][Ot][K]||(this.workerSources[Y][Ot][K]={}),this.isSpriteLoaded[Y]||(this.isSpriteLoaded[Y]={}),this.workerSources[Y][Ot][K][rt]||(this.workerSources[Y][Ot][K][rt]=new this.workerSourceTypes[K]({send:(ne,ye,Lt,Ee,Ge,We)=>{this.actor.send(ne,ye,Lt,Y,Ge,We)},scheduler:this.actor.scheduler},this.getLayerIndex(Y,Ot),this.getAvailableImages(Y,Ot),this.isSpriteLoaded[Y][Ot],void 0,this.brightness)),this.workerSources[Y][Ot][K][rt]}getDEMWorkerSource(Y,K,rt){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][rt]||(this.demWorkerSources[Y][rt]={}),this.demWorkerSources[Y][rt][K]||(this.demWorkerSources[Y][rt][K]=new mi),this.demWorkerSources[Y][rt][K]}enforceCacheSizeLimit(Y,K){ge.q(K)}getWorkerPerformanceMetrics(Y,K,rt){rt(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Vh(self)),Vh}),Kp(0,function(ge){return ge.s}),bn}()}},d0=>{d0(d0.s=562)}]);